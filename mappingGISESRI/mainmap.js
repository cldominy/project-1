b(f, c) && this.Gf(this.Fq(f)) && this.cK(f, b, c, -1, a), f = this.i.qc(this.i.Aa(f));
while (f != e)
}
this.i.ni(c);
return b
};
b.prototype.WY = function(a) {
    for (var b = this.i.a, c = b.bh(1607), d = b.bh(550), e = this.i.xh(), f = this.i.wq(), g = -1, h = this.i.rf; - 1 != h; h = this.i.og(h)) {
        var m = this.i.kf(h),
            n = m;
        do {
            var p = this.i.Kb(n, e);
            1 != p && (p = this.Fq(n), this.Gf(p) && this.cK(n, c, e, f, a));
            n = this.i.qc(this.i.Aa(n))
        } while (n !=
            m)
    }
    for (h = this.i.rf; - 1 != h; h = this.i.og(h)) p = this.i.Hg(h, f), 1 != p && (p = this.i.Md(h), this.Gf(p) && (-1 == g && (g = b.Yf(d, -1)), m = this.i.Ym(h), -1 != m && (m = this.i.Uj(m), m = this.gn(m, a), b.Kj(g, m))));
    this.i.ni(e);
    this.i.xq(f);
    a = [];
    a[0] = d;
    a[1] = c;
    return a
};
b.prototype.Qp = function() {
    for (var a = this.i.a, b = a.bh(550), c = a.Yf(b, -1), d = this.i.rf; - 1 != d; d = this.i.og(d))
        if (this.Gf(this.i.Md(d))) {
            for (var e = -1, f = this.i.Ym(d); - 1 != f; f = this.i.gt(f)) { var g = this.i.Uj(f); - 1 == e && (e = g); var h = this.i.Ia(a.ng(a.ld(g))); if (this.Gf(h)) { e = g; break } }
            a.Kj(c,
                e)
        }
    return b
};
b.prototype.Do = function(a) { this.Mh = []; for (var b = 0; b < a; b++) this.Mh[b] = !1 };
b.wD = function(b, c, d, e) {
    var f = b.Ka(),
        g = Array(1E3);
    a.J.Nv(g, null);
    var h = a.J.gf(1E3, 0),
        m = b.D(),
        q = !0,
        n = 2 == c.tb();
    if (1 != c.tb() && 2 != c.tb()) throw a.g.za();
    for (var p = 0; p < m;) {
        var u = a.J.truncate(b.fX(g, p) - p);
        n ? a.gd.fL(c, g, u, d, h) : a.gd.gL(c, g, u, d, h);
        for (var r = 0, t = 0; t < u; t++) {
            var v = 0 == h[t];
            e || (v = !v);
            v && (q && (q = !1, f.Id(b, 0, p)), r != t && f.Id(b, p + r, p + t), r = t + 1)
        }
        q || r == u || f.Id(b, p + r, p + u);
        p += u
    }
    return q ? b : f
};
b.MH = function(c, d, e) {
    return c instanceof
    a.Ed ? b.wD(c, d, e, !0) : d instanceof a.Wa ? c.u() || d.u() ? c.Ka() : a.sk.yJ(e, c, d) ? a.sk.GQ(c, d) : c.Ka() : b.yD(c, d, e, !0)
};
b.nw = function(c, d, e, f) {
    var g = new a.h;
    c.s(g);
    var h = new a.h;
    d.s(h);
    var m = new a.h;
    m.I(g);
    m.Nb(h);
    e = a.na.be(e, m, !0);
    m = new a.h;
    m.I(h);
    h = a.na.Cs(e);
    m.O(h, h);
    if (!g.Yb(m)) { if (c.tb() <= d.tb()) return b.bd(b.Bb(c.Ka()), c, "\x26"); if (c.tb() > d.tb()) return b.bd(b.Bb(d.Ka()), c, "\x26") }
    h = new b;
    g = new a.fd;
    m = g.Jb(b.Bb(c));
    d = g.Jb(b.Bb(d));
    h.Xr(g, e, f);
    f = h.nw(m, d);
    c = b.bd(g.Se(f), c, "\x26");
    a.T.Ic(c.G()) && (c.Zg(2,
        e), 1736 == c.G() && c.Al());
    return c
};
b.yD = function(b, c, d, e) {
    if (b.u()) return b.Ka();
    if (c.u()) return e ? b.Ka() : null;
    var f = [null],
        g = [0],
        h = 2 == c.tb();
    if (1 != c.tb() && 2 != c.tb()) throw a.g.za();
    f[0] = b.w();
    h ? a.gd.fL(c, f, 1, d, g) : a.gd.gL(c, f, 1, d, g);
    c = 0 == g[0];
    e || (c = !c);
    return c ? b.Ka() : b
};
b.TZ = function(c, d, e) { return c instanceof a.Ed ? b.wD(c, d, e, !1) : d instanceof a.Wa ? c.u() ? c.Ka() : d.u() ? c : a.sk.yJ(e, c, d) ? c.Ka() : c : b.yD(c, d, e, !1) };
b.prototype.DJ = function(b, c, d, e, f) {
    if (b.u()) return b;
    var g = new a.fd;
    b = g.Jb(b);
    return this.nl(g,
        b, c, d, e, f)
};
b.prototype.AW = function(b, c, d, e, f, g) {
    if (f && 550 != b.hc(c)) {
        var h = new a.XD;
        h.NY(b, d);
        h.ih ? (a.sk.V(b, d, g, !0), f = !1) : this.i.ez(d)
    } else a.sk.V(b, d, g, !0), f = !1;
    e && 550 != b.hc(c) ? this.i.nK(b, c) : this.i.mK(b, c);
    if (this.i.YA) return this.i.qh(), this.i = null, this.nl(b, c, d, e, !1, g);
    this.i.ez(NaN);
    g = this.i.Ia(c);
    this.Do(g + 1);
    this.Mh[g] = !0;
    if (1736 == b.hc(c) || e && 550 != b.hc(c)) return b.Hp(c, 0), c = this.es(c, -1, -1), b = b.Se(c), b.Hp(0), f ? b.Zg(1, 0) : (b.Zg(2, d), b.Al()), b;
    if (1607 == b.hc(c)) return c = this.fs(-1), b = b.Se(c),
        f || b.Zg(2, d), b;
    if (550 == b.hc(c)) return c = this.Qp(), b = b.Se(c), f || b.Zg(2, d), b;
    throw a.g.za();
};
b.prototype.nl = function(b, c, d, e, f, g) { this.i = new a.Qu; try { return this.AW(b, c, d, e, f, g) } finally { this.i.qh() } };
b.nl = function(a, c, d, e, f) { return (new b).DJ(a, c, d, e, f) };
b.prototype.zW = function(b, c, d) {
    this.pt = b;
    this.i = new a.Qu;
    b = c.xo(d);
    var e = c.hc(d);
    1 != b || 550 == e ? this.i.mK(c, d) : this.i.nK(c, d);
    if (!this.i.YA)
        if (this.i.ez(NaN), e = this.i.Ia(d), this.Do(e + 1), this.Mh[e] = !0, 1736 == c.hc(d) || 1 == b && 550 != c.hc(d)) c.Hp(d, 0), b = this.es(d, -1, -1), c.FC(b, d), c.bC(b);
        else if (1607 == c.hc(d)) b = this.fs(-1), c.FC(b, d), c.bC(b);
    else if (550 == c.hc(d)) b = this.Qp(), c.FC(b, d), c.bC(b);
    else throw a.g.X("internal error");
};
b.EC = function(a, c, d, e) {
    var f = new b;
    f.pt = !0;
    return f.DJ(a, c, !1, d, e)
};
b.prototype.Vm = function(b, c) {
    var d = a.T.lf(this.i.a.hc(b)),
        e = a.T.lf(this.i.a.hc(c));
    if (d > e) return b;
    var f = this.i.Ia(b),
        g = this.i.Ia(c);
    this.Do((f | g) + 1);
    this.Mh[this.i.Ia(b)] = !0;
    if (2 == d && 2 == e) return this.es(b, c, -1);
    if (1 == d && 2 == e || 1 == d && 1 == e) return this.fs(-1);
    if (0 == d) return this.Qp();
    throw a.g.za();
};
b.prototype.nG = function(b, c) {
    var d = a.T.lf(this.i.a.hc(b)),
        e = a.T.lf(this.i.a.hc(c));
    if (d > e) return b;
    if (d < e) return c;
    var f = this.i.Ia(b),
        g = this.i.Ia(c);
    this.Do((f | g) + 1);
    this.Mh[this.i.Ia(b)] = !0;
    this.Mh[this.i.Ia(c)] = !0;
    this.Mh[this.i.Ia(b) | this.i.Ia(c)] = !0;
    if (2 == d && 2 == e) return this.es(b, c, -1);
    if (1 == d && 1 == e) return this.fs(-1);
    if (0 == d && 0 == e) return this.Qp();
    throw a.g.za();
};
b.prototype.nw = function(b, c) {
    var d = a.T.lf(this.i.a.hc(b)),
        e = a.T.lf(this.i.a.hc(c)),
        f = this.i.Ia(b),
        g = this.i.Ia(c);
    this.Do((f | g) + 1);
    this.Mh[this.i.Ia(b) | this.i.Ia(c)] = !0;
    f = -1;
    1 < this.i.a.Hr.Ga && (f = b);
    if (2 == d && 2 == e) return this.es(b, c, f);
    if (1 == d && 0 < e || 1 == e && 0 < d) return this.fs(f);
    if (0 == d || 0 == e) return this.Qp();
    throw a.g.za();
};
b.prototype.wA = function(b, c) {
    var d = a.T.lf(this.i.a.hc(b)),
        e = a.T.lf(this.i.a.hc(c)),
        f = this.i.Ia(b),
        g = this.i.Ia(c);
    this.Do((f | g) + 1);
    this.Mh[this.i.Ia(b) | this.i.Ia(c)] = !0;
    f = -1;
    1 < this.i.a.Hr.Ga && (f = b);
    if (2 == d && 2 == e) return this.VY(b, c, f);
    if (1 == d && 0 < e || 1 == e && 0 < d) return this.WY(f);
    if (0 == d || 0 == e) return d = [], d[0] = this.Qp(), d;
    throw a.g.za();
};
b.prototype.Pp = function(b, c) {
    var d = a.T.lf(this.i.a.hc(b)),
        e = a.T.lf(this.i.a.hc(c)),
        f = this.i.Ia(b),
        g = this.i.Ia(c);
    this.Do((f | g) + 1);
    this.Mh[this.i.Ia(b)] = !0;
    this.Mh[this.i.Ia(c)] = !0;
    if (2 == d && 2 == e) return this.es(b, c, -1);
    if (1 == d && 1 == e) return this.fs(-1);
    if (0 == d && 0 == e) return this.Qp();
    throw a.g.za();
};
b.Bb = function(b) {
    var c = b.G();
    return 197 == c ? (c = new a.Ja(b.description), b.u() || c.jd(b, !1), c) : 33 == c ? (c = new a.Ed(b.description), b.u() || c.add(b), c) : 322 == c ? (c = new a.Ua(b.description),
        b.u() || c.dc(b, !0), c) : b
};
b.bd = function(b, c, d) { var e = b.G(); return 197 == e ? (c = new a.Ja(b.description), b.u() || c.jd(b, !1), c) : 33 != e || "|" != d && "^" != d ? 322 == e ? (c = new a.Ua(b.description), b.u() || c.dc(b, !0), c) : 33 == e && "-" == d && 33 == c.G() || 550 == e && "\x26" == d && 33 == c.G() ? (c = new a.Wa(b.description), b.u() || b.Ae(0, c), c) : b : (c = new a.Ed(b.description), b.u() || c.add(b), c) };
b.Vm = function(c, d, e, f) {
    if (c.u() || d.u() || c.tb() > d.tb()) return b.bd(b.Bb(c), c, "-");
    var g = new a.h;
    c.s(g);
    var h = new a.h;
    d.s(h);
    if (!g.Yb(h)) return b.bd(b.Bb(c),
        c, "-");
    var m = new a.h;
    m.I(g);
    m.Nb(h);
    e = a.na.be(e, m, !0);
    h = new b;
    g = new a.fd;
    m = g.Jb(b.Bb(c));
    d = g.Jb(b.Bb(d));
    h.Xr(g, e, f);
    f = h.Vm(m, d);
    f = g.Se(f);
    c = b.bd(f, c, "-");
    a.T.Ic(c.G()) && (c.Zg(2, e), 1736 == c.G() && c.Al());
    return c
};
b.nG = function(c, d, e, f) {
    if (c.tb() > d.tb()) return b.bd(b.Bb(c), c, "|");
    if (c.tb() < d.tb() || c.u()) return b.bd(b.Bb(d), c, "|");
    if (d.u()) return b.bd(b.Bb(c), c, "|");
    var g = new a.h;
    c.s(g);
    var h = new a.h;
    d.s(h);
    var m = new a.h;
    m.I(g);
    m.Nb(h);
    e = a.na.be(e, m, !0);
    if (!g.Yb(h.oT(e, e))) switch (c = b.Bb(c), d = b.Bb(d),
        c.G()) {
        case 550:
            return c = a.T.oe(c), c.Id(d, 0, -1), c;
        case 1607:
            return c = a.T.oe(c), c.add(d, !1), c;
        case 1736:
            return c = a.T.oe(c), c.add(d, !1), c;
        default:
            throw a.g.za();
    }
    h = new b;
    g = new a.fd;
    m = g.Jb(b.Bb(c));
    d = g.Jb(b.Bb(d));
    h.Xr(g, e, f);
    d = h.nG(m, d);
    c = b.bd(g.Se(d), c, "|");
    a.T.Ic(c.G()) && (c.Zg(2, e), 1736 == c.G() && c.Al());
    return c
};
b.SR = function(c, d, e) {
    if (2 > c.length) throw a.g.F("not enough geometries to dissolve");
    for (var f = 0, g = 0, h = c.length; g < h; g++) f = Math.max(c[g].tb(), f);
    var m = new a.h;
    m.Oa();
    for (var n = new a.fd, q = -1,
            p = 0, u = -1, g = 0, h = c.length; g < h; g++)
        if (c[g].tb() == f)
            if (c[g].u()) - 1 == u && (u = g);
            else {
                u = g; - 1 == q ? q = n.Jb(b.Bb(c[g])) : n.xP(q, b.Bb(c[g]));
                var r = new a.h;
                c[g].ac(r);
                m.Nb(r);
                p++
            }
    if (2 > p) return b.Bb(c[u]);
    c = 2 == f;
    d = a.na.be(0 == f ? d : null, m, !0);
    return (new b).nl(n, q, d, c, !0, e)
};
b.wA = function(c, d, e, f) {
    var g = [null, null, null],
        h = new a.h;
    c.s(h);
    var m = new a.h;
    d.s(m);
    var n = new a.h;
    n.I(h);
    n.Nb(m);
    e = a.na.be(e, n, !0);
    n = new a.h;
    n.I(m);
    m = a.na.Cs(e);
    n.O(m, m);
    if (!h.Yb(n)) {
        if (c.tb() <= d.tb()) return c = b.bd(b.Bb(c.Ka()), c, "\x26"), g[c.tb()] =
            c, g;
        if (c.tb() > d.tb()) return c = b.bd(b.Bb(d.Ka()), c, "\x26"), g[c.tb()] = c, g
    }
    m = new b;
    h = new a.fd;
    n = h.Jb(b.Bb(c));
    d = h.Jb(b.Bb(d));
    m.Xr(h, e, f);
    f = m.wA(n, d);
    for (d = 0; d < f.length; d++) m = b.bd(h.Se(f[d]), c, "\x26"), a.T.Ic(m.G()) && (m.Zg(2, e), 1736 == m.G() && m.Al()), g[m.tb()] = m;
    return g
};
b.Pp = function(c, d, e, f) {
    if (c.tb() > d.tb()) return b.bd(b.Bb(c), c, "^");
    if (c.tb() < d.tb() || c.u()) return b.bd(b.Bb(d), c, "^");
    if (d.u()) return b.bd(b.Bb(c), c, "^");
    var g = new a.h;
    c.s(g);
    var h = new a.h;
    d.s(h);
    var m = new a.h;
    m.I(g);
    m.Nb(h);
    e = a.na.be(e,
        m, !0);
    h = new b;
    g = new a.fd;
    m = g.Jb(b.Bb(c));
    d = g.Jb(b.Bb(d));
    h.Xr(g, e, f);
    f = h.Pp(m, d);
    c = b.bd(g.Se(f), c, "^");
    a.T.Ic(c.G()) && (c.Zg(2, e), 1736 == c.G() && c.Al());
    return c
};
b.M_ = function(b, c, d) {
    c = c.G();
    d = d.G();
    return 550 == b.G() && (33 == c || 33 == d) && 1 >= b.D() ? (d = new a.Wa(b.description), b.u() || b.Ae(0, d), d) : b
};
b.prototype.BS = function(a, b) {
    var c = this.i.a;
    a = c.Yf(a, -1);
    for (var d = b.size, e = 0; e < d; e++) {
        var f = b.get(e);
        c.Kj(a, f)
    }
    c.$n(a, !0)
};
b.prototype.XX = function(a, b) {
    for (var c = this.i.a, d = c.rd; - 1 != d; d = c.Ue(d))
        if (d == b)
            for (var e =
                    c.Pb(d); - 1 != e; e = c.Sb(e)) {
                var f = c.cb(e);
                if (-1 != f)
                    for (var g = c.U(f); - 1 != g;) {
                        var f = this.i.jf(f),
                            h = this.i.jf(g),
                            f = this.i.lT(f, h); - 1 != f && (h = this.i.Aa(f), this.i.Ob(f, a, 1), this.i.Ob(h, a, 2));
                        f = g;
                        g = c.U(f)
                    }
            }
};
b.prototype.UW = function(b, c, d, e) {
    d = this.i.Ia(d);
    e = this.i.Ia(e);
    var f = new a.ia(0);
    f.yb(256);
    for (var g = this.i.a, h = this.i.xh(), m = this.i.rf; - 1 != m; m = this.i.og(m)) {
        var n = this.i.kf(m);
        if (-1 != n) {
            var q = n;
            do {
                if (1 != this.i.Kb(q, h)) {
                    var p = q,
                        u = q,
                        r = !1,
                        t = 0;
                    do {
                        this.i.Ob(p, h, 1);
                        if (!r) {
                            var v = this.i.Ah(p);
                            0 != (v & e) && 0 != (this.i.Ff(p) &
                                d) && (u = p, r = !0)
                        }
                        r && (f.add(this.i.Uj(this.i.Ym(this.i.Jk(p)))), -1 != b && (v = this.i.Ah(p), 0 != (v & e) && (v = this.i.Kb(p, b), t |= v)));
                        p = this.i.qc(p)
                    } while (p != u);
                    r && 0 < this.i.Dq(this.i.Ef(u)) && (p = g.bh(1736), this.BS(p, f), -1 != c && g.xK(p, c, t));
                    f.clear(!1)
                }
                q = this.i.qc(this.i.Aa(q))
            } while (q != n)
        }
    }
    this.i.ni(h)
};
b.prototype.AR = function(a, b, c, d) {
    this.i.wX();
    var e = -1; - 1 != a && (e = this.i.xh(), this.XX(e, c));
    this.UW(e, a, b, c);
    var f = this.i.a;
    a = 0;
    for (e = f.rd; - 1 != e; e = f.Ue(e)) e != b && e != c && (d.add(e), a++);
    d.Gd(0, a, function(a, b) {
        a = f.hA(f.Pb(a));
        b = f.hA(f.Pb(b));
        return a < b ? -1 : a == b ? 0 : 1
    })
};
b.prototype.qh = function() { null != this.i && (this.i.qh(), this.i = null) };
return b
}();
a.Dg = b
})(A || (A = {}));
(function(a) {
    var b = function() {
        function b(a) { void 0 !== a ? this.Op(a) : this.qC() }
        b.prototype.Vx = function() { this.bc = this.Wb = this.zb = this.sb = this.gb = this.lb = 0 };
        b.prototype.Eb = function(a) { return this == a ? !0 : a instanceof b ? this.lb == a.lb && this.sb == a.sb && this.Wb == a.Wb && this.zb == a.zb && this.gb == a.gb && this.bc == a.bc : !1 };
        b.prototype.jc = function() {
            a.J.Zi();
            a.J.Zi();
            a.J.Zi();
            a.J.Zi();
            a.J.Zi();
            return a.J.Zi()
        };
        b.prototype.$h = function(a, b) {
            var c = this.zb * a.x + this.gb * a.y + this.bc;
            b.x = this.lb * a.x + this.sb * a.y + this.Wb;
            b.y = c
        };
        b.prototype.YY = function(a, b, c, d, e) {
            var f = 2 * b;
            d *= 2;
            for (b = 2 * (b + e); f < b; f += 2, d += 2) {
                e = a[f];
                var g = a[f + 1];
                c[d] = this.lb * e + this.sb * g + this.Wb;
                c[d + 1] = this.zb * e + this.gb * g + this.bc
            }
        };
        b.prototype.$Y = function(b, c, d) {
            for (var e = 0; e < c; e++) {
                var f = b[e].x,
                    g = b[e].y,
                    h = this.lb * f + this.sb * g + this.Wb,
                    f = this.zb * f + this.gb * g + this.bc;
                null != d[e] ? d[e].ka(h, f) : d[e] = a.b.pa(h, f)
            }
        };
        b.prototype.multiply =
            function(a) { b.multiply(this, a, this) };
        b.multiply = function(a, b, c) {
            var d, e, f, g, h;
            d = a.lb * b.lb + a.zb * b.sb;
            e = a.sb * b.lb + a.gb * b.sb;
            f = a.Wb * b.lb + a.bc * b.sb + b.Wb;
            g = a.lb * b.zb + a.zb * b.gb;
            h = a.sb * b.zb + a.gb * b.gb;
            a = a.Wb * b.zb + a.bc * b.gb + b.bc;
            c.lb = d;
            c.sb = e;
            c.Wb = f;
            c.zb = g;
            c.gb = h;
            c.bc = a
        };
        b.prototype.Vf = function() {
            var a = new b;
            a.lb = this.lb;
            a.sb = this.sb;
            a.Wb = this.Wb;
            a.zb = this.zb;
            a.gb = this.gb;
            a.bc = this.bc;
            return a
        };
        b.prototype.LC = function(b) {
            if (!b.u()) {
                for (var c = [], d = 0; 4 > d; d++) c[d] = new a.b;
                b.QB(c);
                this.aZ(c, c);
                b.Mx(c, 4)
            }
        };
        b.prototype.aZ =
            function(b, c) {
                for (var d = 0; d < b.length; d++) {
                    var e = new a.b,
                        f = b[d];
                    e.x = this.lb * f.x + this.sb * f.y + this.Wb;
                    e.y = this.zb * f.x + this.gb * f.y + this.bc;
                    c[d] = e
                }
            };
        b.prototype.lU = function(a, b) { a.u() || b.u() || 0 == a.N() || 0 == a.fa() ? this.Vx() : (this.sb = this.zb = 0, this.lb = b.N() / a.N(), this.gb = b.fa() / a.fa(), this.Wb = b.o - a.o * this.lb, this.bc = b.A - a.A * this.gb) };
        b.prototype.ZY = function(b) {
            var c = new a.b,
                d = new a.b;
            c.ka(this.lb, this.zb);
            d.ka(this.sb, this.gb);
            c.sub(c);
            var e = .5 * c.qk();
            c.ka(this.lb, this.zb);
            d.ka(this.sb, this.gb);
            c.add(d);
            c = .5 * c.qk();
            return b * (e > c ? Math.sqrt(e) : Math.sqrt(c))
        };
        b.prototype.qC = function() {
            this.lb = 1;
            this.zb = this.Wb = this.sb = 0;
            this.gb = 1;
            this.bc = 0
        };
        b.prototype.Ho = function(b) {
            if (void 0 !== b) {
                var c = a.b.pa(0, 1);
                this.$h(c, c);
                c.sub(a.b.pa(0, 1));
                if (c.qk() > b * b) return !1;
                c.ka(0, 0);
                this.$h(c, c);
                if (c.qk() > b * b) return !1;
                c.ka(1, 0);
                this.$h(c, c);
                c.sub(a.b.pa(1, 0));
                return c.qk() <= b * b
            }
            return 1 == this.lb && 1 == this.gb && 0 == this.sb && 0 == this.Wb && 0 == this.zb && 0 == this.bc
        };
        b.prototype.fh = function(a) {
            return Math.abs(this.lb * this.gb - this.zb *
                this.sb) <= 2 * a * (Math.abs(this.lb * this.gb) + Math.abs(this.zb * this.sb))
        };
        b.prototype.Ag = function(a, b) {
            this.lb = 1;
            this.sb = 0;
            this.Wb = a;
            this.zb = 0;
            this.gb = 1;
            this.bc = b
        };
        b.prototype.Op = function(a, b) { void 0 !== b ? (this.lb = a, this.zb = this.Wb = this.sb = 0, this.gb = b, this.bc = 0) : this.Op(a, a) };
        b.prototype.yC = function() {
            this.lb = 0;
            this.sb = 1;
            this.Wb = 0;
            this.zb = 1;
            this.bc = this.gb = 0
        };
        b.prototype.kY = function(a) { this.lY(Math.cos(a), Math.sin(a)) };
        b.prototype.lY = function(a, b) {
            this.lb = a;
            this.sb = -b;
            this.Wb = 0;
            this.zb = b;
            this.gb = a;
            this.bc =
                0
        };
        b.prototype.shift = function(a, b) {
            this.Wb += a;
            this.bc += b
        };
        b.prototype.scale = function(a, b) {
            this.lb *= a;
            this.sb *= a;
            this.Wb *= a;
            this.zb *= b;
            this.gb *= b;
            this.bc *= b
        };
        b.prototype.rotate = function(a) {
            var c = new b;
            c.kY(a);
            this.multiply(c)
        };
        b.prototype.inverse = function(a) {
            if (void 0 !== a) {
                var b = this.lb * this.gb - this.sb * this.zb;
                0 == b ? a.Vx() : (b = 1 / b, a.Wb = (this.sb * this.bc - this.Wb * this.gb) * b, a.bc = (this.Wb * this.zb - this.lb * this.bc) * b, a.lb = this.gb * b, a.sb = -this.sb * b, a.zb = -this.zb * b, a.gb = this.lb * b)
            } else this.inverse(this)
        };
        return b
    }();
    a.Hd = b
})(A || (A = {}));
(function(a) {
    var b = function() {
        function b() {}
        b.prototype.Vx = function() { this.bi = this.bc = this.Wb = this.Df = this.Af = this.zf = this.Cf = this.gb = this.sb = this.Sf = this.zb = this.lb = 0 };
        b.prototype.Op = function(a, b, c) {
            this.lb = a;
            this.sb = this.Sf = this.zb = 0;
            this.gb = b;
            this.Af = this.zf = this.Cf = 0;
            this.Df = c;
            this.bi = this.bc = this.Wb = 0
        };
        b.prototype.LC = function(b) {
            if (b.u()) return b;
            for (var c = new a.pd[8], d = 0; 8 > d; d++) c[d] = new a.pd;
            b.QB(c);
            this.transform(c, 8, c);
            b.Mx(c);
            return b
        };
        b.prototype.transform = function(b,
            c, d) {
            for (var e = 0; e < c; e++) {
                var f = new a.pd,
                    g = b[e];
                f.x = this.lb * g.x + this.sb * g.y + this.zf * g.z + this.Wb;
                f.y = this.zb * g.x + this.gb * g.y + this.Af * g.z + this.bc;
                f.z = this.Sf * g.x + this.Cf * g.y + this.Df * g.z + this.bi;
                d[e] = f
            }
        };
        b.prototype.Rp = function(b) {
            var c = new a.pd;
            c.x = this.lb * b.x + this.sb * b.y + this.zf * b.z + this.Wb;
            c.y = this.zb * b.x + this.gb * b.y + this.Af * b.z + this.bc;
            c.z = this.Sf * b.x + this.Cf * b.y + this.Df * b.z + this.bi;
            return c
        };
        b.prototype.Vg = function(a) { b.multiply(this, a, this) };
        b.multiply = function(a, b, c) {
            var d, e, f, g, h, m, n, q, p, u, r;
            d = a.lb * b.lb + a.zb * b.sb + a.Sf * b.zf;
            e = a.lb * b.zb + a.zb * b.gb + a.Sf * b.Af;
            f = a.lb * b.Sf + a.zb * b.Cf + a.Sf * b.Df;
            g = a.sb * b.lb + a.gb * b.sb + a.Cf * b.zf;
            h = a.sb * b.zb + a.gb * b.gb + a.Cf * b.Af;
            m = a.sb * b.Sf + a.gb * b.Cf + a.Cf * b.Df;
            n = a.zf * b.lb + a.Af * b.sb + a.Df * b.zf;
            q = a.zf * b.zb + a.Af * b.gb + a.Df * b.Af;
            p = a.zf * b.Sf + a.Af * b.Cf + a.Df * b.Df;
            u = a.Wb * b.lb + a.bc * b.sb + a.bi * b.zf + b.Wb;
            r = a.Wb * b.zb + a.bc * b.gb + a.bi * b.Af + b.bc;
            a = a.Wb * b.Sf + a.bc * b.Cf + a.bi * b.Df + b.bi;
            c.lb = d;
            c.zb = e;
            c.Sf = f;
            c.sb = g;
            c.gb = h;
            c.Cf = m;
            c.zf = n;
            c.Af = q;
            c.Df = p;
            c.Wb = u;
            c.bc = r;
            c.bi = a
        };
        b.inverse = function(b,
            c) {
            var d = b.lb * (b.gb * b.Df - b.Cf * b.Af) - b.zb * (b.sb * b.Df - b.Cf * b.zf) + b.Sf * (b.sb * b.Af - b.gb * b.zf);
            if (0 != d) {
                var e, f, g, h, m, n, q, p, r, t;
                p = 1 / d;
                d = (b.gb * b.Df - b.Cf * b.Af) * p;
                g = -(b.sb * b.Df - b.Cf * b.zf) * p;
                n = (b.sb * b.Af - b.gb * b.zf) * p;
                e = -(b.zb * b.Df - b.Af * b.Sf) * p;
                h = (b.lb * b.Df - b.Sf * b.zf) * p;
                q = -(b.lb * b.Af - b.zb * b.zf) * p;
                f = (b.zb * b.Cf - b.Sf * b.gb) * p;
                m = -(b.lb * b.Cf - b.Sf * b.sb) * p;
                p *= b.lb * b.gb - b.zb * b.sb;
                r = -(b.Wb * d + b.bc * g + b.bi * n);
                t = -(b.Wb * e + b.bc * h + b.bi * q);
                b = -(b.Wb * f + b.bc * m + b.bi * p);
                c.lb = d;
                c.zb = e;
                c.Sf = f;
                c.sb = g;
                c.gb = h;
                c.Cf = m;
                c.zf = n;
                c.Af = q;
                c.Df =
                    p;
                c.Wb = r;
                c.bc = t;
                c.bi = b
            } else throw a.g.X("math singularity");
        };
        b.prototype.Vf = function() {
            var a = new b;
            a.lb = this.lb;
            a.zb = this.zb;
            a.Sf = this.Sf;
            a.sb = this.sb;
            a.gb = this.gb;
            a.Cf = this.Cf;
            a.zf = this.zf;
            a.Af = this.Af;
            a.Df = this.Df;
            a.Wb = this.Wb;
            a.bc = this.bc;
            a.bi = this.bi;
            return a
        };
        return b
    }();
    a.fO = b
})(A || (A = {}));
(function(a) {
    var b = function(b) {
        function d(a) {
            if (void 0 !== a) b.call(this, a.jc(), a);
            else {
                b.call(this);
                this.wg = [];
                this.wg[0] = 0;
                this.Ga = 1;
                this.Sh = [];
                for (a = 0; 10 > a; a++) this.Sh[a] = -1;
                this.Sh[this.wg[0]] = 0
            }
            this.Zq = !0
        }
        D(d, b);
        d.prototype.Td = function(a) { this.hasAttribute(a) || (this.Sh[a] = 0, this.DE()) };
        d.prototype.removeAttribute = function(b) {
            if (0 == b) throw a.g.F("Position attribue cannot be removed");
            this.hasAttribute(b) && (this.Sh[b] = -1, this.DE())
        };
        d.prototype.reset = function() {
            this.wg[0] = 0;
            this.Ga = 1;
            for (var a = 0; a < this.Sh.length; a++) this.Sh[a] = -1;
            this.Sh[this.wg[0]] = 0;
            this.Zq = !0
        };
        d.prototype.Pz = function() { return c.zo().add(this) };
        d.Ig = function() { return c.zo().UT() };
        d.eq = function() { return c.zo().VT() };
        d.prototype.KO =
            function() { var b = this.jc(); return new a.ma(b, this) };
        d.prototype.DE = function() {
            for (var a = this.Ga = 0, b = 0; 10 > a; a++) 0 <= this.Sh[a] && (this.wg[b] = a, this.Sh[a] = b, b++, this.Ga++);
            this.Zq = !0
        };
        d.prototype.jc = function() { this.Zq && (this.bm = this.zk(), this.Zq = !1); return this.bm };
        d.prototype.Eb = function(a) {
            if (null == a) return !1;
            if (a == this) return !0;
            if (!(a instanceof d) || a.Ga != this.Ga) return !1;
            for (var b = 0; b < this.Ga; b++)
                if (this.wg[b] != a.wg[b]) return !1;
            return this.Zq != a.Zq ? !1 : !0
        };
        d.prototype.SH = function(a) {
            if (a.Ga != this.Ga) return !1;
            for (var b = 0; b < this.Ga; b++)
                if (this.wg[b] != a.wg[b]) return !1;
            return !0
        };
        d.vx = function(a, b) { for (var c = [], d = 0; d < a.Ga; d++) c[d] = -1; for (var d = 0, e = a.Ga; d < e; d++) c[d] = b.mg(a.qd(d)); return c };
        d.vT = function(a, b) {
            a = new d(a);
            a.Td(b);
            return a.Pz()
        };
        d.wT = function(a, b) { for (var c = null, e = 0; 10 > e; e++) !a.hasAttribute(e) && b.hasAttribute(e) && (null == c && (c = new d(a)), c.Td(e)); return null != c ? c.Pz() : a };
        d.ss = function(a, b) {
            a = new d(a);
            a.removeAttribute(b);
            return a.Pz()
        };
        return d
    }(a.ma);
    a.ze = b;
    var c = function() {
        function a() {
            this.map = [];
            var a = new b;
            this.add(a);
            a = new b;
            a.Td(1);
            this.add(a)
        }
        a.zo = function() { return a.jV };
        a.prototype.UT = function() { return a.aq };
        a.prototype.VT = function() { return a.bq };
        a.prototype.add = function(b) {
            var c = b.jc();
            if (null != a.aq && a.aq.jc() == c && b.SH(a.aq)) return a.aq;
            if (null != a.bq && a.bq.jc() == c && b.SH(a.bq)) return a.bq;
            var d = null;
            void 0 !== this.map[c] && (d = this.map[c]);
            null == d && (d = b.KO(), 1 == d.Ga ? a.aq = d : 2 == d.Ga && 1 == d.qd(1) ? a.bq = d : this.map[c] = d);
            return d
        };
        a.jV = new a;
        return a
    }()
})(A || (A = {}));
var P = 0 == n.version.indexOf("4."),
    O;
(function(a) {
    a[a.Linear = 0] = "Linear";
    a[a.Angular = 1] = "Angular";
    a[a.Area = 2] = "Area";
    a[a.LinearOrAngular = 3] = "LinearOrAngular"
})(O || (O = {}));
var R = { feet: 9002, kilometers: 9036, meters: 9001, miles: 9035, "nautical-miles": 9030, yards: 9096 },
    S = { acres: 109402, ares: 109463, hectares: 109401, "square-feet": 109405, "square-kilometers": 109414, "square-meters": 109404, "square-miles": 109413, "square-yards": 109442 },
    W = { degrees: 9102, radians: 9101 },
    U = A.Rd.create(4326),
    V = A.Rd.create(102100);
return function() {
function b() {}
b.extendedSpatialReferenceInfo =
    function(a) {
        if (null === a) return null;
        a = x(a);
        var b = a.Vd();
        return { tolerance: a.Bo(), unitType: null == b ? -1 : b.td, unitID: null == b ? -1 : b.Cc(), unitBaseFactor: null == b ? 0 : b.Ai, unitSquareDerivative: null == b ? 0 : A.kc.lH(b).Cc() }
    };
b.clip = function(a, b) {
    if (null === a) return null;
    b = A.cc.clip(B(a), B(b), E(a));
    return w(b, a.spatialReference)
};
b.cut = function(a, b) {
    b = B(b);
    b = A.cc.Hl(B(a), b, E(a));
    for (var c = [], d = 0; d < b.length; d++) c.push(w(b[d], a.spatialReference));
    return c
};
b.contains = function(a, b) {
    if (null === a || null === b) throw Error("Illegal Argument Exception");
    return A.cc.contains(B(a), B(b), E(a))
};
b.crosses = function(a, b) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.zR(B(a), B(b), E(a)) };
b.distance = function(a, b, c) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.Cb(B(a), B(b), E(a), A.kc.pe(r(c, 3))) };
b.equals = function(a, b) { return null === a && null !== b || null === b && null !== a ? !1 : A.cc.Eb(B(a), B(b), E(a)) };
b.intersects = function(a, b) {
    if (null === a || null === b) throw Error("Illegal Argument Exception");
    return A.cc.OU(B(a),
        B(b), E(a))
};
b.touches = function(a, b) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.touches(B(a), B(b), E(a)) };
b.within = function(a, b) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.sZ(B(a), B(b), E(a)) };
b.disjoint = function(a, b) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.RR(B(a), B(b), E(a)) };
b.overlaps = function(a, b) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.pW(B(a), B(b), E(a)) };
b.relate =
    function(a, b, c) { if (null === a || null === b) throw Error("Illegal Argument Exception"); return A.cc.ZB(B(a), B(b), E(a), c) };
b.isSimple = function(a) { if (null === a) throw Error("Illegal Argument Exception"); return A.cc.ZU(B(a), E(a)) };
b.simplify = function(a) { if (null === a) throw Error("Illegal Argument Exception"); var b = A.cc.DC(B(a), E(a)); return w(b, a.spatialReference) };
b.convexHull = function(a, c) {
    void 0 === c && (c = !1);
    if (null === a) throw Error("Illegal Argument Exception");
    return !1 === G(a) ? (c = A.cc.iR(B(a), E(a)), w(c, a.spatialReference)) :
        b.lZ(a, c)
};
b.lZ = function(a, b) {
    for (var c = [], d = 0; d < a.length; d++) c.push(B(a[d]));
    c = A.cc.jR(c, b);
    for (d = 0; d < c.length; d++) c[d] = w(c[d], a[0].spatialReference);
    return c
};
b.difference = function(a, c) { if (null === a || null === c) throw Error("Illegal Argument Exception"); return !1 === G(a) ? (c = A.cc.Vm(B(a), B(c), E(a)), w(c, a.spatialReference)) : b.iM(a, c) };
b.iM = function(a, b) {
    for (var c = [], d = 0; d < a.length; d++) c.push(B(a[d]));
    c = A.cc.OR(c, B(b), E(b));
    for (d = 0; d < c.length; d++) c[d] = w(c[d], b.spatialReference);
    return c
};
b.symmetricDifference =
    function(a, c) { if (null === a || null === c) throw Error("Illegal Argument Exception"); return !1 === G(a) ? (c = A.cc.Pp(B(a), B(c), E(a)), w(c, a.spatialReference)) : b.LM(a, c) };
b.LM = function(a, b) {
    for (var c = [], d = 0; d < a.length; d++) c.push(B(a[d]));
    c = A.cc.PY(c, B(b), E(b));
    for (d = 0; d < c.length; d++) c[d] = w(c[d], b.spatialReference);
    return c
};
b.intersect = function(a, c) { if (null === a || null === c) throw Error("Illegal Argument Exception"); return !1 === G(a) ? (c = A.cc.Ma(B(a), B(c), E(a)), w(c, a.spatialReference)) : b.xM(a, c) };
b.xM = function(a, b) {
    for (var c = [], d = 0; d < a.length; d++) c.push(B(a[d]));
    c = A.cc.MU(c, B(b), E(b));
    for (d = 0; d < c.length; d++) c[d] = w(c[d], b.spatialReference);
    return c
};
b.union = function(a, b) {
    void 0 === b && (b = null);
    if (null === a) return null;
    !1 === G(a) && (a = [a], null !== b && a.push(b));
    if (0 === a.length) return null;
    b = [];
    for (var c = 0; c < a.length; c++) b.push(B(a[c]));
    return w(A.cc.hZ(b, E(a[0])), a[0].spatialReference)
};
b.offset = function(a, c, d, e, f, g) {
    var h = 0;
    if (null != e && void 0 != e) switch (e) {
        case "round":
            h = 0;
            break;
        case "bevel":
            h = 1;
            break;
        case "miter":
            h = 2;
            break;
        case "square":
            h =
                3
    }
    return !1 === G(a) ? (c = A.cc.offset(B(a), E(a), c, h, f, g, A.kc.pe(r(d, 3))), w(c, a.spatialReference)) : b.HM(a, c, d, h, f, g)
};
b.HM = function(a, b, c, d, e, f) {
    if (null === a) return null;
    if (0 === a.length) return [];
    for (var g = [], h = 0; h < a.length; h++) g.push(B(a[h]));
    b = A.cc.nW(g, E(a[0]), b, d, e, f, A.kc.pe(r(c, 3)));
    for (h = 0; h < b.length; h++) b[h] = w(b[h], a[0].spatialReference);
    return b
};
b.buffer = function(a, c, d, e) {
    void 0 === e && (e = !1);
    if (!1 === G(a)) return c = A.cc.buffer(B(a), E(a), c, A.kc.pe(r(d, 3)), !1, 0, NaN), w(c, a.spatialReference);
    if ("[object Array]" !==
        Object.prototype.toString.call(c)) {
        for (var f = [], g = 0; g < a.length; g++) f.push(c);
        c = f
    }
    if (c.length != a.length) {
        if (0 == c.length) throw Error("Illegal Argument Exception");
        for (var f = [], h = 0, g = 0; g < a.length; g++) void 0 === c[g] ? f.push(h) : (f.push(c[g]), h = c[g]);
        c = f
    }
    return b.rD(a, c, d, !1, e, "geodesic", NaN)
};
b.geodesicBuffer = function(a, c, d, e, f, g) {
    if (!1 === G(a)) return void 0 === f && (f = NaN), c = A.cc.buffer(B(a), E(a), c, A.kc.pe(r(d, 0)), !0, v(e), f), w(c, a.spatialReference);
    if ("[object Array]" !== Object.prototype.toString.call(c)) {
        for (var h = [], m = 0; m < a.length; m++) h.push(c);
        c = h
    }
    if (c.length != a.length) {
        if (0 == c.length) throw Error("Illegal Argument Exception");
        for (var h = [], n = 0, m = 0; m < a.length; m++) void 0 === c[m] ? h.push(n) : (h.push(c[m]), n = c[m]);
        c = h
    }
    return b.rD(a, c, d, !0, e, f, g)
};
b.rD = function(a, b, c, d, e, f, g) {
    if (null === a) return null;
    if (0 === a.length) return [];
    void 0 === g && (g = NaN);
    for (var h = [], m = 0; m < a.length; m++) h.push(B(a[m]));
    b = A.cc.RP(h, E(a[0]), b, A.kc.pe(r(c, 0)), d, e, v(f), g);
    for (m = 0; m < b.length; m++) b[m] = w(b[m], a[0].spatialReference);
    return b
};
b.nearestCoordinate =
    function(a, b, c) {
        void 0 === c && (c = !0);
        b = A.cc.$z(B(a), B(b), c);
        return { coordinate: w(b.Oz(), a.spatialReference), distance: b.Rz(), isRightSide: b.AA(), vertexIndex: b.Za(), isEmpty: b.u() }
    };
b.nearestVertex = function(a, b) { b = A.cc.aA(B(a), B(b)); return { coordinate: w(b.Oz(), a.spatialReference), distance: b.Rz(), isRightSide: b.AA(), vertexIndex: b.Za(), isEmpty: b.u() } };
b.nearestVertices = function(a, b, c, d) {
    b = B(b);
    c = A.cc.bA(B(a), b, c, d);
    d = [];
    for (b = 0; b < c.length; b++) !1 === c[b].u() && d.push({
        coordinate: w(c[b].Oz(), a.spatialReference),
        distance: c[b].Rz(),
        isRightSide: c[b].AA(),
        vertexIndex: c[b].Za(),
        isEmpty: c[b].u()
    });
    return d
};
b.generalize = function(a, b, c, d) { b = A.cc.HS(B(a), E(a), b, c, A.kc.pe(r(d, 3))); return w(b, a.spatialReference) };
b.densify = function(a, b, c) { b = A.cc.Ls(B(a), E(a), b, A.kc.pe(r(c, 3))); return w(b, a.spatialReference) };
b.geodesicDensify = function(a, b, c, d) {
    void 0 === d && (d = 0);
    b = A.cc.Fz(B(a), E(a), b, A.kc.pe(r(c, 3)), d);
    return w(b, a.spatialReference)
};
b.rotate = function(b, c, d) {
    if (void 0 === d || null === d) void 0 !== b.x ? d = b : void 0 !== b.xmin ?
        (!1 === b instanceof a && (b = P ? p(b) : m(b)), d = P ? b.get("center") : b.getCenter()) : (!1 === b instanceof a && (b = P ? p(b) : m(b)), d = P ? b.get("extent").get("center") : b.getExtent().getCenter());
    c = P ? A.Wp.rotate(b.toJSON ? b.toJSON() : b, c, d.toJSON ? d.toJSON() : d) : A.Wp.rotate(b.toJson ? b.toJson() : b, c, d.toJson ? d.toJson() : d);
    P ? (c = p(c), c.set("spatialReference", b.spatialReference)) : (c = m(c), c.setSpatialReference(b.spatialReference));
    return c
};
b.flipHorizontal = function(b, c) {
    if (void 0 === c || null === c) void 0 !== b.x ? c = b : void 0 !== b.xmin ? (!1 ===
        b instanceof a && (b = P ? p(b) : m(b)), c = P ? b.get("center") : b.getCenter()) : (!1 === b instanceof a && (b = P ? p(b) : m(b)), c = P ? b.get("extent").get("center") : b.getExtent().getCenter());
    c = P ? A.Wp.zG(b.toJSON ? b.toJSON() : b, c.toJSON ? c.toJSON() : c) : A.Wp.zG(b.toJson ? b.toJson() : b, c.toJson ? c.toJson() : c);
    P ? (c = p(c), c.set("spatialReference", b.spatialReference)) : (c = m(c), c.setSpatialReference(b.spatialReference));
    return c
};
b.flipVertical = function(b, c) {
    if (void 0 === c || null === c) void 0 !== b.x ? c = b : void 0 !== b.xmin ? (!1 === b instanceof a &&
        (b = P ? p(b) : m(b)), c = P ? b.get("center") : b.getCenter()) : (!1 === b instanceof a && (b = P ? p(b) : m(b)), c = P ? b.get("extent").get("center") : b.getExtent().getCenter());
    c = P ? A.Wp.AG(b.toJSON ? b.toJSON() : b, c.toJSON ? c.toJSON() : c) : A.Wp.AG(b.toJson ? b.toJson() : b, c.toJson ? c.toJson() : c);
    P ? (c = p(c), c.set("spatialReference", b.spatialReference)) : (c = m(c), c.setSpatialReference(b.spatialReference));
    return c
};
b.planarArea = function(a, b) { if (null === a) throw Error("Illegal Argument Exception"); return A.cc.xW(B(a), E(a), A.kc.pe(r(b, 2))) };
b.planarLength = function(a, b) { if (null === a) throw Error("Illegal Argument Exception"); return A.cc.yW(B(a), E(a), A.kc.pe(r(b, 3))) };
b.geodesicArea = function(a, b, c) { if (null === a) throw Error("Illegal Argument Exception"); return A.cc.NS(B(a), E(a), A.kc.pe(r(b, 2)), v(c)) };
b.geodesicLength = function(a, b, c) { if (null === a) throw Error("Illegal Argument Exception"); return A.cc.RS(B(a), E(a), A.kc.pe(r(b, 0)), v(c)) };
b._enableProjection = function(a) {
    b.GE = !0;
    A.BN.bind(a)
};
b.Mg = function(a) { return x(a).Ao() };
b._getTransformation =
    function(a, b, c) {
        void 0 === c && (c = null);
        var d = null,
            e = null;
        if (c) {
            if (!c.spatialReference) throw A.g.F("AOI missing Spatial Reference");
            d = B(c);
            e = x(c.spatialReference).Ao()
        }
        a = A.Ou.RT(x(a).Ao(), x(b).Ao(), d, e);
        return null !== a ? a : null
    };
b._getTransformationBySuitability = function(a, b, c) {
    void 0 === c && (c = null);
    var d = null,
        e = null;
    if (c) {
        if (!c.spatialReference) throw A.g.F("AOI missing Spatial Reference");
        d = B(c);
        e = x(c.spatialReference).Ao()
    }
    return A.Ou.ST(x(a).Ao(), x(b).Ao(), d, e)
};
b.dZ = function(a, c, d) {
    var e = null;
    if (d) {
        var f =
            d.getGTListEntry();
        if (null !== f) {
            for (var e = new A.ny(null), g = 0, h = f.steps; g < h.length; g++) {
                var f = h[g],
                    m = new A.io(f.geogtran);
                f.isInverse && m.kt();
                e.add(m)
            }
            e = A.rs.Is(b.Mg(a), b.Mg(c), e);
            d.assignCachedGe(a, c, e);
            return e
        }
    }
    if (null === e && d && d.steps && 0 < d.steps.length) {
        e = new A.ny(null);
        g = 0;
        for (h = d.steps; g < h.length; g++) f = h[g], -1 != f.wkid && null !== f.wkid && void 0 !== f.wkid ? e.add(A.io.create(f.wkid, f.isInverse)) : e.add(A.io.gG(f.wkt, f.isInverse));
        e = A.rs.Is(b.Mg(a), b.Mg(c), e);
        d.assignCachedGe(a, c, e);
        return e
    }
    return A.rs.Is(b.Mg(a),
        b.Mg(c), e)
};
b._project = function(a, c, d, e, f) {
    void 0 === e && (e = null);
    void 0 === f && (f = !1);
    if (!1 === this.GE) throw Error("Projection Engine must be enabled using enableProjection");
    if (0 === a.length) return [];
    if (e) {
        var g = e.getCachedGeTransformation(c, d);
        g || (g = b.dZ(c, d, e));
        c = [];
        var h = 0
    } else g = A.rs.Is(b.Mg(c), b.Mg(d), null), c = [], h = 0;
    for (; h < a.length; h++) e = a[h], c.push(b.nD(e, d, g, f));
    return c
};
b.nD = function(a, b, c, d) { a = A.cc.Xg(B(a), c); return d ? F(a) : w(a, b) };
b.GE = !1;
return b
}()
})
}, "esri/dijit/ImageFilter/ImageFilterSettingsDialog": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/on dojo/string dojo/query dojo/json dojo/dom-class dojo/text!./templates/ImageFilterSettingsDialog.html dojo/i18n!../../nls/jsapi dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../../domUtils".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v) {
            return b([m, p, r], {
                templateString: e,
                widgetsInTemplate: !0,
                _supportsTime: { shortDate: !0, shortDateLE: !0 },
                constructor: function(a, c) {
                    b.safeMixin(this, a);
                    this._i18n = h.widgets.imageFilter.imageFilterSettings;
                    this._i18n = g.mixin(this._i18n, h.common);
                    this._i18n = g.mixin(this._i18n, h.widgets.visibleScaleRangeSlider)
                },
                show: function() {
                    this._loadSettings();
                    this.dialog.show()
                },
                _getFormatter: function() {
                    var a = this.fieldValue,
                        b = a.type;
                    c(".formatTime").addClass("hide");
                    c(".esriImageFilterFieldFormat, .legendTitle, .format").forEach(function(a) { v.hide(a) });
                    if (a = a.format)(a = d.parse(a)) && (b in this.imageFilter.esriDataType.decimal || b in this.imageFilter.esriDataType.integer) ? (b in this.imageFilter.esriDataType.decimal && this._formatNumberSelect.set("value", a.places, !1), this._formatNumberCheck.set("value", a.digitSeparator, !1), b in this.imageFilter.esriDataType.decimal ? c(".esriImageFilterFieldFormat, .legendTitle, .formatNumber").forEach(function(a) { v.show(a) }) : c(".esriImageFilterFieldFormat, .legendTitle, .formatInteger").forEach(function(a) { v.show(a) })) :
                        a && b in this.imageFilter.esriDataType.date ? (c(".formatTime").removeClass("hide"), c(".esriImageFilterFieldFormat, .legendTitle, .esriImageFilterFormatDate").forEach(function(a) { v.show(a) }), -1 < a.dateFormat.indexOf("LETime") || -1 < a.dateFormat.indexOf("LEShortTime") || -1 < a.dateFormat.indexOf("LELongTime") ? (this._formatDateSelect.set("value", "shortDateLE", !1), this._formatTimeCheck.set("checked", !0), this._formatTimeSelect.set("value", a.dateFormat.split("shortDateLE")[1], !1), this._enableUpdateTime(!0)) : -1 <
                            a.dateFormat.indexOf("Time") ? (this._formatDateSelect.set("value", "shortDate", !1), this._formatTimeCheck.set("checked", !0), this._formatTimeSelect.set("value", a.dateFormat.split("shortDate")[1], !1), this._enableUpdateTime(!0)) : (this._formatDateSelect.set("value", a.dateFormat, !1), this._enableUpdateTime(a.dateFormat in this._supportsTime))) : c(".esriImageFilterFieldFormat, .legendTitle").forEach(function(a) { v.hide(a) })
                },
                _setFormatter: function(a, b) {
                    var e = d.parse(this.fieldValue.format);
                    c(".formatTime").addClass("hide");
                    if ("dateFormat" === a) {
                        b = b || this._formatDateSelect.get("value");
                        var f = b in this._supportsTime,
                            g = f && this._formatTimeCheck.get("checked") ? this._formatTimeSelect.get("value") : "";
                        c(".formatTime").removeClass("hide");
                        this._enableUpdateTime(f);
                        e[a] = b + g
                    } else e[a] = "places" === a ? parseInt(b, 10) : b;
                    this.fieldValue.format = d.stringify(e)
                },
                _enableUpdateTime: function(a) {
                    this._formatTimeCheck.set("disabled", !a);
                    f[a ? "remove" : "add"](this.timeCheckboxLbl, "disabled");
                    a || this._formatTimeCheck.set("checked", !1)
                },
                _setFormatHandles: function() {
                    this._formatDateSelect.on("change",
                        g.hitch(this, "_setFormatter", "dateFormat"));
                    this._formatTimeSelect.on("change", g.hitch(this, "_setFormatter", "dateFormat", null));
                    this._formatNumberSelect.on("change", g.hitch(this, "_setFormatter", "places"));
                    this._formatNumberCheck.on("change", g.hitch(this, "_setFormatter", "digitSeparator"));
                    this._formatTimeCheck.on("change", g.hitch(this, function() {
                        var a = this._formatTimeCheck.get("checked");
                        f[a ? "remove" : "add"](this._formatTimeSelect.domNode, "hide");
                        this._setFormatter("dateFormat")
                    }))
                },
                _loadSettings: function() {
                    this.imageFilter &&
                        (this.fieldValue = g.clone(this.imageFilter.field), this._getFormatter(), this._setFormatHandles())
                },
                _saveSettings: function() {
                    var a = { field: g.clone(this.fieldValue) };
                    this.imageFilter.updateFilterFeatureFormat(a)
                },
                _handleOKButtonClick: function() {
                    this._saveSettings();
                    this.dialog.hide()
                },
                hide: function() {
                    this.dialog.hide();
                    this.imageFilter.refresh()
                }
            })
        })
}, "esri/dijit/ImageFilter/ImageFilterSelectFieldsDialog": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/on dojo/string dojo/i18n!../../nls/jsapi dojo/dom-construct dojo/dom-class dijit/form/CheckBox dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dgrid/OnDemandList dgrid/extensions/DijitRegistry dgrid/Selection".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x) {
            return b([p, r, v], {
                templateString: '\x3cdiv\x3e\x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${_i18n.filterResult}"\x3e\x3cdiv\x3e${_i18n.selectFieldDescription}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"fieldList" class\x3d"imageFilterFieldSelect"\x3e \x3c/div\x3e\x3clabel\x3e\x3cdiv data-dojo-attach-point\x3d"thumbNailCheck" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\x3c/div\x3e${_i18n.thumbnails}\x3c/label\x3e\x3cdiv\x3e\x3cdiv class\x3d"esriImageFilterConfirm"\x3e\x3cbutton class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_handleOKButtonClick"\x3e${_i18n.ok}\x3c/button\x3e\x3cbutton class\x3d"jevent cancel" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:hide"\x3e${_i18n.cancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
                widgetsInTemplate: !0,
                constructor: function(a, c) {
                    b.safeMixin(this, a);
                    this._i18n = f.widgets.imageFilter.imageCardSettings;
                    this._i18n = g.mixin(this._i18n, f.common)
                },
                show: function() {
                    this._visibleFields = g.clone(this.imageFilter.selectedFields);
                    this._fieldList.set("store", this.imageFilter._fieldStore);
                    this.thumbNailCheck.set("checked", this.imageFilter.showThumbnail);
                    this.dialog.show()
                },
                _handleOKButtonClick: function() {
                    this.dialog.hide();
                    0 === this._visibleFields.length && this._visibleFields.push(this.imageFilter.field.name);
                    this.imageFilter._updateRasterListFields({ fields: this._visibleFields, showThumbnail: this.thumbNailCheck.checked })
                },
                startup: function() {
                    this._visibleFields = g.clone(this.imageFilter.selectedFields);
                    this._fieldList = new(b([w, t, x]))({ store: this.store, bufferRows: 3, selectionMode: "single", sort: "alias", renderRow: g.hitch(this, this._createFieldGrid) }, this.fieldList);
                    this._fieldList.startup();
                    this.thumbNailCheck.set("checked", this.imageFilter.showThumbnail);
                    this._fieldList.on(".dgrid-row:click", g.hitch(this, this._onRowClick))
                },
                _createFieldGrid: function(a) {
                    var b = e.create("div");
                    h.add(b, "esriImageFilterFieldSelectRow");
                    var c = new m({ checked: -1 < this._visibleFields.indexOf(a.name) ? !0 : !1, onChange: g.hitch(this, this._updateSelectedField, a) });
                    e.place(c.domNode, b);
                    c = e.create("label");
                    h.add(c, "esriImageFilterResultFieldLabel");
                    c.innerHTML = a.alias;
                    e.place(c, b);
                    return b
                },
                _onRowClick: function(a) { a.target.type && "checkbox" === a.target.type || (a = this._fieldList.row(a).data, this._updateSelectedField(a)) },
                _updateSelectedField: function(a) {
                    -1 ===
                        this._visibleFields.indexOf(a.name) ? 4 != this._visibleFields.length && this._visibleFields.push(a.name) : (a = this._visibleFields.indexOf(a.name), this._visibleFields.splice(a, 1));
                    this._fieldList.refresh({ keepScrollPosition: !0 })
                },
                hide: function() { this.dialog.hide() }
            })
        })
}, "esri/dijit/RasterList": function() {
    define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/CheckBox dojo/_base/array dgrid/OnDemandGrid dgrid/extensions/DijitRegistry dgrid/Selection dojo/_base/lang dojo/dom-class dojo/dom-construct ../lang".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v) {
            var w = b([f, e, h], { selectionMode: "single", selection: !0, maxRowsPerPage: 2, minRowsPerPage: 2, farOffRemoval: 500 });
            return b([g, n, a], {
                templateString: '\x3cdiv class\x3d"esriRasterListDiv"\x3e \x3cdiv data-dojo-attach-point \x3d "listDiv" style\x3d"height: 100%; width: 100%;" class\x3d"obliqueRasterList"\x3e\x3c/div\x3e\x3c/div\x3e',
                showThumbnail: !1,
                setData: function(a) { this.rasterList.set("store", a) },
                clearSelection: function() { this.rasterList.clearSelection() },
                refresh: function(a) { this.rasterList.refresh({ keepScrollPosition: a }) },
                startup: function() {
                    this.inherited(arguments);
                    var a = this;
                    this.rasterList = new w({
                        store: this.store,
                        minRowsPerPage: 5,
                        maxRowsPerPage: 6,
                        bufferRows: 3,
                        selectionMode: this.selectionMode ? this.selectionMode : "single",
                        renderRow: function(b) {
                            b = b.attributes || b;
                            var e, f = r.create("div");
                            a.showThumbnail ? p.add(f, "esriRasterListThumbnailRow") : p.add(f, "esriRasterListNoThumbnailRow");
                            var g = r.create("div");
                            p.add(g, "esriRasterListInfoTag");
                            d.forEach(a.fields, function(a) {
                                v.isDefined(b[a.name]) && a.display && (e = b[a.name].toFixed &&
                                    0 < b[a.name].toString().indexOf(".") ? b[a.name].toFixed(2) : b[a.name], g.innerHTML += "\x3cstrong\x3e" + a.alias + ": \x3c/strong\x3e" + e + "\x3cbr/\x3e")
                            });
                            var h = r.create("table"),
                                m = r.create("tr");
                            p.add(h, "esriRasterListRowTable");
                            if (a.showThumbnail) {
                                var n = r.create("img", { className: "esriRasterListThumbnail", src: b.thumbnailUrl }),
                                    t = r.create("td");
                                p.add(t, "esriRasterListThumbnailCol");
                                r.place(n, t);
                                r.place(t, m)
                            }
                            n = r.create("td");
                            r.place(g, n);
                            r.place(n, m);
                            a.showCheckbox && (n = r.create("td"), p.add(n, "esriRasterListCheckboxCol"),
                                t = new c({ checked: b.selected }), r.place(t.domNode, n), r.place(n, m));
                            r.place(m, h);
                            r.place(h, f);
                            b.selected && a.rasterList.select(a.rasterList.row(b));
                            return f
                        }
                    }, this.listDiv);
                    this.rasterList.startup();
                    this.own(this.rasterList.on(".dgrid-row:click", function(b) {
                            b = a.rasterList.row(b).data;
                            a.emit("raster-select", b)
                        }), this.rasterList.on(".dgrid-row:mouseover", function(b) {
                            b = a.rasterList.row(b).data;
                            a.emit("raster-mouseover", b)
                        }), this.rasterList.on(".dgrid-row:mouseout", function(b) { a.emit("raster-mouseout") }),
                        this.rasterList.on("dgrid-select", function(b) { a.emit("raster-row-select", { rasters: b.rows }) }))
                }
            })
        })
}, "arcgisonline/map/dijit/PopupBuilder": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/LayerAttributesGrid,dijit/form/Select,dijit/form/MultiSelect,dijit/form/CheckBox,dojo/dnd/Source,arcgisonline/map/dijit/DropDownButton,dojox/data/AndOrWriteStore,arcgisonline/map/dijit/AddFieldPlugin,arcgisonline/sharing/dijit/LinkDialog,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/dijit/renderer/ExpressionEditor,esri/arcadeProfiles/popupProfile,esri/ArcadeExpression,dijit/Menu,dijit/MenuItem,dijit/Tooltip,dijit/Editor,dijit/_editor/plugins/FontChoice,dijit/_editor/plugins/TextColor,dijit/_editor/plugins/ViewSource,dijit/_editor/plugins/EnterKeyHandling,dojo/Deferred,dojo/promise/all,dojo/when,dojo/store/Observable,dojo/store/Memory,dojo/store/DataStore,dgrid/Grid,dgrid/OnDemandGrid,dgrid/extensions/DijitRegistry"],
        function(b, g, n) {
            b.provide("arcgisonline.map.dijit.PopupBuilder");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("arcgisonline.sharing.dijit.LayerAttributesGrid");
            b.require("dijit.form.Select");
            b.require("dijit.form.MultiSelect");
            b.require("dijit.form.CheckBox");
            b.require("dojo.dnd.Source");
            b.require("arcgisonline.map.dijit.DropDownButton");
            b.require("dojox.data.AndOrWriteStore");
            b.require("arcgisonline.map.dijit.AddFieldPlugin");
            b.require("arcgisonline.sharing.dijit.LinkDialog");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.require("arcgisonline.map.dijit.renderer.ExpressionEditor");
            b.require("esri/arcadeProfiles/popupProfile");
            b.require("esri/ArcadeExpression");
            b.require("dijit.Menu");
            b.require("dijit.MenuItem");
            b.require("dijit.Tooltip");
            b.require("dijit.Editor");
            b.require("dijit._editor.plugins.FontChoice");
            b.require("dijit._editor.plugins.TextColor");
            b.require("dijit._editor.plugins.ViewSource");
            b.require("dijit._editor.plugins.EnterKeyHandling");
            b.require("dojo.Deferred");
            b.require("dojo.promise.all");
            b.require("dojo.when");
            b.require("dojo.store.Observable");
            b.require("dojo.store.Memory");
            b.require("dojo.store.DataStore");
            b.require("dgrid.Grid");
            b.require("dgrid.OnDemandGrid");
            b.require("dgrid.extensions.DijitRegistry");
            b.declare("arcgisonline.map.dijit.PopupBuilder", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e\r\n\r\n    \x3cdiv id\x3d"popupBuilderContentHeader" class\x3d"panel panel_left" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"display:none;"\x3e\r\n      \x3cdiv id\x3d"popupBuilderHeaderButtons" class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"popupBuilderContentTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n          ${i18n.popupBuilderTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_popupBuilderLayerName" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both; display:none;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; border-bottom: #aeaeae thin solid; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"popupBuilderContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;"\x3e\r\n      \x3cdiv style\x3d"padding: 10px 0;" class\x3d"showPopup esriFloatLeading"\x3e\r\n        \x3cinput dojoAttachPoint\x3d"_popupShowCheck" dojotype\x3d"dijit.form.CheckBox"  dojoAttachEvent\x3d"onChange:_onChangeShowPopup" value\x3d"on" type\x3d"checkbox" /\x3e\r\n        \x3clabel\x3e\r\n          ${i18n.showPopups}\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_clusteringHelpIcon" class\x3d"esriFloatTrailing" style\x3d"display:none;padding-top: 9px;"\x3e\r\n        \x3cspan class\x3d"helpIcon"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"popupBuilderOptions" style\x3d"clear:both;"\x3e\r\n        \x3cdiv\x3e\r\n          \x3c!--\r\n            \x3cp id\x3d"popupBuilderDescription" style\x3d"margin:4px 0px 10px 0px;"\x3e\r\n                ${i18n.titleMessage}\r\n            \x3c/p\x3e\r\n          --\x3e\r\n            \x3clabel for\x3d"_title" class\x3d"title"\x3e\r\n                ${i18n.title}\r\n            \x3c/label\x3e\r\n            \x3ctable style\x3d"width:100%;"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:165px;"\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_title" name\x3d"title" dojotype\x3d"dijit.form.Textarea" style\x3d"padding:2px;"/\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_titleButton" class\x3d"calcite transparent tiny"\x3e\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-bottom:10px;"\x3e\r\n            \x3cp style\x3d"margin-bottom:3px;" class\x3d"title"\x3e\r\n                ${i18n.content}\r\n            \x3c/p\x3e\r\n            \x3clabel dojoAttachPoint\x3d"_descriptionTypeLabel" for\x3d"popupbuilderContentSelect"\x3e\r\n                ${i18n.displayLabel}\r\n            \x3c/label\x3e\r\n            \x3cselect dojoAttachPoint\x3d"_descriptionType" name\x3d"popupbuilderContentSelect" dojoAttachEvent\x3d"onChange:_onChangePopupContent" dojoType\x3d"dijit.form.Select" style\x3d"margin:10px 0px 10px 0px;"\x3e\r\n                \x3coption value\x3d"_fieldAttributes" selected\x3d"selected"\x3e${i18n.fieldAttributes}\x3c/option\x3e\r\n                \x3coption value\x3d"_oneField" \x3e${i18n.oneField}\x3c/option\x3e\r\n                \x3coption value\x3d"_customField"\x3e${i18n.customField}\x3c/option\x3e\r\n                \x3coption value\x3d"_none"\x3e${i18n.noField}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n            \x3cbr /\x3e\r\n            \x3cdiv class\x3d"_popContentPane" dojoAttachPoint\x3d"_fieldAttributes" style\x3d"margin-bottom:0.7em;"\x3e\r\n                \x3cdiv style\x3d"margin-bottom:0.7em;"\x3e\r\n                    ${i18n.fieldDisplay}\r\n                \x3c/div\x3e\r\n                \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                        \x3cselect dojoType\x3d"dijit.form.MultiSelect" style\x3d"width: 180px;" dojoAttachPoint\x3d"_attributesSelect"\x3e\r\n                        \x3c/select\x3e\x3c/td\x3e\r\n                        \x3ctd width\x3d"18"\x3e\r\n                        \x3cbutton  class\x3d"button calcite transparent tiny" dojoAttachPoint\x3d"_attributesSelectUp" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupUpIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveUp}\x3c/button\x3e\r\n                        \x3cbutton  class\x3d"button calcite transparent tiny" dojoAttachPoint\x3d"_attributesSelectDown" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupDownIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveDown}\x3c/button\x3e\r\n                        \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                \x3c/table\x3e\r\n                \x3c!--\x3cbutton  dojoAttachPoint\x3d"_changeFieldsBtn" dojoAttachEvent\x3d"onClick:_onShowFieldsDlg" dojoType\x3d"dijit.form.Button" type\x3d"button"\x3e--\x3e\r\n                    \x3c!--${i18n.configureFields}--\x3e\r\n                \x3c!--\x3c/button\x3e--\x3e\r\n                \x3c!--\x3cp style\x3d"margin:0px;"\x3e\x3ca href\x3d\'\' dojoAttachEvent\x3d"onclick:_onShowFieldsDlg" style\x3d"color:blue;margin:0.2em;"\x3e${i18n.configureFields}\x3c/a\x3e\x3c/p\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"_popContentPane" dojoAttachPoint\x3d"_oneField" style\x3d"margin-bottom:0.7em;display:none;"\x3e\r\n                \x3c!--\x3cdiv style\x3d"margin-bottom:5px;"\x3e--\x3e\r\n                    \x3c!--${i18n.selectDescriptionField}--\x3e\r\n                \x3c!--\x3c/div\x3e--\x3e\r\n                \x3cselect dojoAttachPoint\x3d"_singleFieldSelect" dojoType\x3d"dijit.form.Select" minSize\x3d\'150\'  maxSize\x3d\'180\'  maxHeight\x3d\'150\' style\x3d"width: 200px;" size\x3d"4"\x3e\r\n                \x3c/select\x3e\r\n                \x3cbr /\x3e\r\n                \x3c!--\x3ca class\x3d"_requireNumericDateFld" href\x3d\'\' dojoAttachEvent\x3d"onclick:_onShowFieldsDlg" style\x3d"color:blue;"\x3e${i18n.configureFields}\x3c/a\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"_popContentPane" dojoAttachPoint\x3d"_customField" style\x3d"margin-bottom:0.7em;display:none;"\x3e\r\n                \x3cbutton class\x3d"calcite green small" style\x3d"margin-top:-5px;" dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_customFieldBtn" type\x3d"button"\x3e\r\n                    ${i18n.configure}\r\n                \x3c/button\x3e\r\n                \x3cbr /\x3e\r\n                \x3c!--\x3ca class\x3d"_requireNumericDateFld" href\x3d\'\' dojoAttachEvent\x3d"onclick:_onShowFieldsDlg" style\x3d"margin:0.2em;color:blue;"\x3e${i18n.configureFields}\x3c/a\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"_popContentPane" style\x3d"margin-bottom:0.7em;display:none;" dojoAttachPoint\x3d"_none"\x3e\r\n                \x3cspan\x3e\r\n                  ${i18n.noAttributeInfo}\r\n                \x3c/span\x3e\r\n                \x3cbr /\x3e\r\n                \x3c!--\x3ca class\x3d"_requireNumericDateFld" href\x3d\'\' dojoAttachEvent\x3d"onclick:_onShowFieldsDlg" style\x3d"margin:0.2em;color:blue;"\x3e${i18n.configureFields}\x3c/a\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3ca href\x3d\'\' dojoAttachEvent\x3d"onclick:_onShowFieldsDlg" style\x3d"color: #21759b;"\x3e${i18n.configureFields}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_noDataHandlerDiv"\x3e\r\n        \x3c/div\x3e\x3cspan dojoAttachPoint\x3d"_noDataHandlerText"\x3e\x3c/span\x3e\r\n        \x3cdiv\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_returnTopmostRasterHandlerDiv"\x3e\x3c/div\x3e\r\n            \x3cspan dojoAttachPoint\x3d"_returnTopmostRasterHandlerText"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_showAttachmentsDiv"\x3e\r\n            \x3cinput id\x3d"_showAttachments" dojoAttachPoint\x3d"_showAttachments" dojotype\x3d"dijit.form.CheckBox" value\x3d"true" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n            \x3clabel id\x3d"_showAttachmentsLabel" dojoAttachPoint\x3d"_showAttachmentsLabel" for\x3d"_showAttachments"\x3e\r\n                ${i18n.showAttachmentAsLinks}\r\n            \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_showEditTrackingDiv"\x3e\r\n          \x3cinput id\x3d"_showEditTracking" dojoAttachPoint\x3d"_showEditTracking" dojotype\x3d"dijit.form.CheckBox" value\x3d"true" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n          \x3clabel id\x3d"_showEditTrackingLabel" dojoAttachPoint\x3d"_showEditTrackingLabel" for\x3d"_showEditTracking"\x3e\r\n            ${i18n.showEditTracking}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_expressionDiv" style\x3d"display:none;"\x3e\r\n          \x3cp style\x3d"margin-bottom:3px;" class\x3d"title"\x3e\r\n              ${i18n.attributeExpressions}\r\n          \x3c/p\x3e\r\n          \x3cdiv style\x3d"margin-bottom:5px;"\x3e\r\n              ${i18n.expressionsText}\r\n          \x3c/div\x3e\r\n          \x3cbutton dojoAttachPoint\x3d"_addExpression" class\x3d"calcite light tiny" \x3e\x3c/button\x3e\r\n          \x3ctable\x3e\r\n              \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                      \x3cselect dojoType\x3d"dijit.form.MultiSelect" name\x3d"_expressionSelect" style\x3d"width:180px;height:130px;" dojoAttachPoint\x3d"_expressionSelect"\x3e\r\n                          \x3coption value\x3d"-1" selected\x3d"false"\x3e${i18n.noExpressions}\x3c/option\x3e\r\n                          \x3coption value\x3d"1" selected\x3d"false"\x3e${i18n.clickAdd}\x3c/option\x3e\r\n                      \x3c/select\x3e\x3c/td\x3e\r\n                  \x3ctd width\x3d"18"\x3e\r\n                      \x3cbutton dojoAttachPoint\x3d"_expressionProperties" dojoType\x3d"dijit.form.Button" class\x3d"button calcite transparent tiny" iconClass\x3d"popupButton popupConfigureIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.configureExpression}\x3c/button\x3e\r\n                      \x3cbutton  dojoAttachPoint\x3d"_expressionDelete" class\x3d"button calcite transparent tiny" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupRemoveIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.removeExpression}\x3c/button\x3e\r\n                  \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_mediaDiv"\x3e\r\n            \x3cp style\x3d"margin-bottom:3px;" class\x3d"title"\x3e\r\n                ${i18n.media}\r\n            \x3c/p\x3e\r\n            \x3cdiv style\x3d"margin-bottom:5px;"\x3e\r\n                ${i18n.imagesAndCharts}\r\n            \x3c/div\x3e\r\n            \x3cbutton dojoAttachPoint\x3d"_addMedia" class\x3d"calcite light tiny" \x3e\x3c/button\x3e\r\n            \x3ctable\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                    \x3cselect dojoType\x3d"dijit.form.MultiSelect" name\x3d"_mediaSelect" style\x3d"width:180px;height:130px;" dojoAttachPoint\x3d"_mediaSelect"\x3e\r\n                        \x3coption value\x3d"-1" selected\x3d"false"\x3e${i18n.noImagesOrCharts}\x3c/option\x3e\r\n                        \x3coption value\x3d"1" selected\x3d"false"\x3e${i18n.clickAdd}\x3c/option\x3e\r\n                        \x3coption value\x3d"2" selected\x3d"false"\x3e${i18n.useArrows}\x3c/option\x3e\r\n                    \x3c/select\x3e\x3c/td\x3e\r\n                    \x3ctd width\x3d"18"\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_mediaProperties" dojoType\x3d"dijit.form.Button" class\x3d"button calcite transparent tiny" iconClass\x3d"popupButton popupConfigureIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.configureMedia}\x3c/button\x3e\r\n                    \x3cbutton  dojoAttachPoint\x3d"_mediaDelete" class\x3d"button calcite transparent tiny" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupRemoveIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.removeMedia}\x3c/button\x3e\r\n                    \x3cbutton  dojoAttachPoint\x3d"_mediaSelectUp" class\x3d"button calcite transparent tiny" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupUpIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveUp}\x3c/button\x3e\r\n                    \x3cbutton  dojoAttachPoint\x3d"_mediaSelectDown" class\x3d"button calcite transparent tiny" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupDownIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveDown}\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n            \x3cbr /\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"relatedData" class\x3d"hide"\x3e\r\n            \x3cp style\x3d"margin-bottom:3px;" class\x3d"title"\x3e\r\n                ${i18n.relatedDataTitle}\r\n            \x3c/p\x3e\r\n            \x3clabel class\x3d"showRelatedDataNode" for\x3d"_showRelatedData" style\x3d"vertical-align: middle;"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_showRelatedData" dojotype\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox"/\x3e\r\n                ${i18n.showRelatedData}\x3cbr /\x3e\x3cbr /\x3e\r\n            \x3c/label\x3e\r\n            \x3cbutton dojoAttachPoint\x3d"_sortOptionsBtn" dojoType\x3d"dijit.form.Button" class\x3d"calcite light small"  type\x3d"button"\x3e${i18n.sortOptions}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"popupBuilderContentBottom" dojoType\x3d"dijit.layout.BorderContainer" region\x3d"bottom" gutters\x3d"false" design\x3d"headline" style\x3d"height:80px;padding:0; margin:0px;"\x3e\r\n\r\n      \x3cdiv id\x3d"popupBuilderContentButtons" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"padding:9px 5px 1px 5px;margin-top:5px;"\x3e\r\n        \x3cdiv align\x3d"center" id\x3d"popupBuilderContentButtonsCenter"\x3e\r\n          \x3cbutton dojoType\x3d"dijit.form.Button" class\x3d"calcite blue" type\x3d"submit" dojoAttachPoint\x3d"_savePopup"\x3e\r\n              ${i18n.ok}\r\n          \x3c/button\x3e\r\n          \x3cbutton dojoType\x3d"dijit.form.Button" class\x3d"calcite transparent" type\x3d"submit" dojoAttachPoint\x3d"_cancelPopup"\x3e\r\n              ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv id\x3d"popupBuilderContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"padding: 0 5px 0 5px; display:none;"\x3e\r\n          \x3cdiv class\x3d"footer" id\x3d"popupBuilderSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojoAttachPoint\x3d"_changeFieldsDlg" class\x3d"esriChangeFieldsDialog" title\x3d"${i18n.configureAttributes}" dojoType\x3d"dijit.Dialog"\x3e\r\n        \x3cdiv id\x3d"_changeFieldsTitle" style\x3d"margin-bottom:10px;max-width:720px;min-width:400px;width:600px;"\x3e${i18n.checkFields}\x3c/div\x3e\r\n        \x3cdiv style\x3d"height:250px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd valign\x3d"top"\x3e\r\n                  \x3cdiv class\x3d"_popupGrid" style\x3d"height:250px;" dojoAttachPoint\x3d"_changeFieldsGridDiv"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd valign\x3d"top"\x3e\r\n                  \x3cdiv class\x3d"_popupSettings esriLeadingMargin1"\x3e\r\n                    \x3cdiv\x3e\r\n                      \x3cbutton class\x3d"button calcite transparent tiny" dojoAttachPoint\x3d"_fieldsSelectUp" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupUpIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveUp}\x3c/button\x3e\r\n                      \x3cbr /\x3e\r\n                      \x3cbutton  class\x3d"button calcite transparent tiny" dojoAttachPoint\x3d"_fieldsSelectDown" dojoType\x3d"dijit.form.Button" iconClass\x3d"popupButton popupDownIcon" showLabel\x3d"false" type\x3d"button"\x3e${i18n.moveDown}\x3c/button\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cfieldset class\x3d"statisticType" dojoAttachPoint\x3d"_statsFieldSet" style\x3d"display:none; width:200px;"\x3e\r\n                      \x3clegend dojoAttachPoint\x3d"_statsTitle" class\x3d"legendTitle"\x3e${i18n.statsType}\x3c/legend\x3e\r\n                      \x3cdiv style\x3d"display:block;"\x3e\r\n                        \x3cselect style\x3d"width:150px;" dojoAttachPoint\x3d"_statsTypeSelect" dojoType\x3d"dijit.form.Select"\x3e\r\n                          \x3coption value\x3d\'count\' selected\x3d"selected"\x3e${i18n.count}\x3c/option\x3e\r\n                          \x3coption value\x3d\'sum\'\x3e${i18n.sum}\x3c/option\x3e\r\n                          \x3coption value\x3d\'min\'\x3e${i18n.min}\x3c/option\x3e\r\n                          \x3coption value\x3d\'max\'\x3e${i18n.max}\x3c/option\x3e\r\n                          \x3coption value\x3d\'avg\'\x3e${i18n.avg}\x3c/option\x3e\r\n                          \x3coption value\x3d\'stddev\'\x3e${i18n.stddev}\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                        \x3cbr/\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/fieldset\x3e\r\n                    \x3cfieldset class\x3d"attributeType" dojoAttachPoint\x3d"_attributeTypeSet" style\x3d"display:none; width:200px;"\x3e\r\n                      \x3clegend dojoAttachPoint\x3d"_attributeTypeTitle" class\x3d"legendTitle"\x3e${i18n.attributeType}\x3c/legend\x3e\r\n                      \x3cdiv style\x3d"display:block;"\x3e\r\n                        \x3cselect style\x3d"width:150px;" dojoAttachPoint\x3d"_attributeTypeSelect" dojoType\x3d"dijit.form.Select"\x3e\r\n                          \x3coption value\x3d\'number\'\x3e${i18n.number}\x3c/option\x3e\r\n                          \x3coption value\x3d\'string\'\x3e${i18n.string}\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                        \x3cbr/\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/fieldset\x3e\r\n                    \x3cfieldset class\x3d"popupFormat" style\x3d"display:none; width:180px;"\x3e\r\n                      \x3clegend dojoAttachPoint\x3d"_legendTitle" class\x3d"legendTitle"\x3e${i18n.formatFields}\x3c/legend\x3e\r\n                      \x3cdiv class\x3d"format formatNumber" style\x3d"display:none;"\x3e\r\n                        \x3cselect style\x3d"width:170px;" dojoAttachPoint\x3d"_formatNumberSelect" class\x3d"formatNumber formatter format" dojoType\x3d"dijit.form.Select"\x3e\r\n                          \x3coption value\x3d\'0\' selected\x3d"selected"\x3e0 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'1\'\x3e1 ${i18n.decimalPlace}\x3c/option\x3e\r\n                          \x3coption value\x3d\'2\'\x3e2 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'3\'\x3e3 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'4\'\x3e4 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'5\'\x3e5 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'6\'\x3e6 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'7\'\x3e7 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                          \x3coption value\x3d\'8\'\x3e8 ${i18n.decimalPlaces}\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                        \x3cbr /\x3e\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"formatNumber formatter formatInteger format" style\x3d"display:none;"\x3e\r\n                          \x3clabel class\x3d"checkbox"\x3e\x3cinput dojoAttachPoint\x3d"_formatNumberCheck" dojoType\x3d"dijit.form.CheckBox"/\x3e\x26nbsp;${i18n.separator}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n                      \x3cdiv class\x3d"formatDate format"\x3e\r\n                        \x3cselect dojoAttachPoint\x3d"_formatDateSelect" class\x3d"formatter" style\x3d"width:150px;" dojoType\x3d"dijit.form.Select"\x3e\r\n                          \x3coption value\x3d"shortDate" selected\x3d"selected"\x3e12/21/1997\x3c/option\x3e\r\n                          \x3coption value\x3d"shortDateLE" selected\x3d"selected"\x3e21/12/1997\x3c/option\x3e\r\n                          \x3coption value\x3d"longMonthDayYear"\x3eDecember 21, 1997\x3c/option\x3e\r\n                          \x3coption value\x3d"dayShortMonthYear"\x3e21 Dec 1997\x3c/option\x3e\r\n                          \x3coption value\x3d"longDate"\x3eSunday, December 21, 1997\x3c/option\x3e\r\n                          \x3coption value\x3d"longMonthYear"\x3eDecember 1997\x3c/option\x3e\r\n                          \x3coption value\x3d"shortMonthYear"\x3eDec 1997\x3c/option\x3e\r\n                          \x3coption value\x3d"year"\x3e1997\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                        \x3cdiv class\x3d"formatTime hide"\x3e\r\n                          \x3clabel dojoAttachPoint\x3d"timeCheckboxLbl" class\x3d"timeCheckbox disabled"\x3e\x3cinput dojoAttachPoint\x3d"_formatTimeCheck" dojoType\x3d"dijit.form.CheckBox"/\x3e\x26nbsp;${i18n.showTime}\x3c/label\x3e\r\n                          \x3cbr /\x3e\r\n                          \x3cselect dojoAttachPoint\x3d"_formatTimeSelect" class\x3d"formatter hide" style\x3d"width:150px;" dojoType\x3d"dijit.form.Select"\x3e\r\n                            \x3coption value\x3d"ShortTime" selected\x3d"selected"\x3e6:00 PM\x3c/option\x3e\r\n                            \x3coption value\x3d"LongTime"\x3e6:00:00 PM\x3c/option\x3e\r\n                            \x3coption value\x3d"ShortTime24"\x3e18:00\x3c/option\x3e\r\n                            \x3coption value\x3d"LongTime24"\x3e18:00:00\x3c/option\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/div\x3e\r\n                        \x3c!--\x3cinput dojoAttachPoint\x3d"_formatDateCheck" dojoType\x3d"dijit.form.CheckBox"/\x3e--\x3e\r\n                        \x3c!--\x3clabel class\x3d"checkbox"\x3e${i18n.localTime}\x3c/label\x3e--\x3e\r\n                      \x3c/div\x3e\r\n                      \x3cdiv class\x3d"formatString format"\x3e\r\n                        \x3clabel\x3e${i18n.textboxType}\x3c/label\x3e\r\n                        \x3cselect dojoAttachPoint\x3d"_formatStringSelect" dojoType\x3d"dijit.form.Select"\x3e\r\n                          \x3coption value\x3d\'textbox\' selected\x3d"selected"\x3e${i18n.singleLine}\x3c/option\x3e\r\n                          \x3coption value\x3d\'textarea\'\x3e${i18n.multipleLine}\x3c/option\x3e\r\n                          \x3coption value\x3d\'richtext\'\x3e${i18n.richText}\x3c/option\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/div\x3e\r\n                      \x3cdiv class\x3d"formatHint format"\x3e\r\n                        \x3cbr /\x3e\r\n                        \x3clabel\x3e${i18n.editHint}\x3c/label\x3e\r\n                        \x3cinput dojoAttachPoint\x3d"_formatTooltip" dojoType\x3d"dijit.form.TextBox"/\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/fieldset\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n             \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin:40px 0 10px 0;" class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" dojoAttachEvent\x3d"onClick:_onSaveFields" class\x3d"calcite blue"\x3e${i18n.ok}\x3c/button\x3e\r\n          \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachEvent\x3d"onClick:_onCancelSaveFields" class\x3d"calcite transparent"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_customFieldDlg" id\x3d"_customFieldDlg" title\x3d"${i18n.customAttributeDisplay}" dojoType\x3d"dijit.Dialog" style\x3d"height:auto;width:575px;overflow-y:hidden;"\x3e\r\n        \x3cdiv style\x3d"margin-bottom:10px;"\x3e\r\n            ${i18n.defineInfo}\r\n        \x3c/div\x3e\r\n        \x3c!--\x3cdiv dojoType\x3d"dijit.Editor" plugins\x3d"[\'bold\',\'italic\',\'underline\',\'|\', \'justifyLeft\', \'justifyCenter\', \'justifyRight\',\'|\', \'insertOrderedList\', \'insertUnorderedList\', \'|\', \'createEsriLink\', \'unlink\', \'|\', \'undo\', \'redo\']" extraPlugins\x3d"[\'foreColor\',\'hiliteColor\']" dojoAttachPoint\x3d"_customAttributeEditor" trim\x3d"true" style\x3d"border:1px solid #CCCCCC;height:160px;"\x3e\x3c/div\x3e--\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_customFieldEditor"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"margin:10px 0px 10px 0px" class\x3d"esriFloatTrailing"\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" class\x3d"calcite blue" dojoAttachEvent\x3d"onClick:_customFieldsDlgOk"\x3e\r\n                ${i18n.ok}\r\n            \x3c/button\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" dojoAttachEvent\x3d"onClick:_customFieldsDlgCancel"\x3e\r\n                ${i18n.cancel}\r\n            \x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n     \x3cdiv dojoAttachPoint\x3d"_mediaConfigDlg" id\x3d"_mediaConfigDlg" style\x3d"width:420px;height:auto;overflow-y:auto;" title\x3d"" dojoType\x3d"dijit.Dialog" \x3e\r\n        \x3cdiv style\x3d"margin-bottom:10px;" dojoAttachPoint\x3d"_mediaConfigDescription"\x3e\x3c/div\x3e\r\n            \x3clabel for\x3d"_mediaTitle" style\x3d"margin:3px 0px 3px 0px"\x3e${i18n.titleLabel}\x3c/label\x3e\r\n            \x3ctable style\x3d"width:100%;margin-top:5px;" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd width\x3d"300"\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_mediaTitle" name\x3d"_mediaTitle" dojotype\x3d"dijit.form.TextBox" style\x3d"width:315px;padding:4px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_mediaTitleButton" class\x3d"calcite light tiny"\x3e\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n            \x3cbr/\x3e\r\n            \x3clabel for\x3d"_mediaCaption" style\x3d"margin:3px 0px 3px 0px;"\x3e${i18n.caption}\x3c/label\x3e\r\n            \x3ctable style\x3d"width:100%;margin-top:5px;" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd width\x3d"300"\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_mediaCaption" name\x3d"_mediaCaption" dojotype\x3d"dijit.form.SimpleTextarea" style\x3d"width:315px;padding:4px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"vertical-align:top;"\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_mediaCaptionButton" class\x3d"calcite light tiny"\x3e\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n            \x3cbr/\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_imageConfigDiv"\x3e\r\n            \x3clabel for\x3d"_imageUrl" style\x3d"margin:3px 0px 3px 0px;"\x3e${i18n.URL}\x3c/label\x3e\r\n            \x3ctable style\x3d"width:100%;margin-top:5px;" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd width\x3d"300"\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_imageUrl" name\x3d"_imageUrl"  invalidMessage\x3d"Invalid URL." dojotype\x3d"dijit.form.TextBox" style\x3d"width:315px;padding:4px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_imageUrlButton" class\x3d"calcite light tiny"\x3e\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n            \x3cbr/\x3e\r\n            \x3clabel for\x3d"_imageLink" style\x3d"margin:3px 0px 3px 0px;"\x3e${i18n.link}\x3c/label\x3e\r\n            \x3ctable style\x3d"width:100%;margin-top:5px;" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd width\x3d"300"\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_imageLink" name\x3d"_imageLink" dojotype\x3d"dijit.form.TextBox" style\x3d"width:315px;padding:4px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                    \x3cbutton dojoAttachPoint\x3d"_imageLinkButton" class\x3d"calcite light tiny"\x3e\x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n            \x3c/br\x3e\r\n            \x3clabel for\x3d"_refreshCheck" style\x3d"margin:3px 0px 3px 0px;"\x3e${i18n.refreshInterval}\x3c/label\x3e\r\n                \x3ctable style\x3d"width:100%;margin-top:5px;" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctr\x3e\r\n                        \x3ctd width\x3d"20"\x3e\r\n                            \x3cinput dojoAttachPoint\x3d"_refreshCheck" dojotype\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"_refreshCheckText"\x3e\r\n                                \x3clabel dojoAttachPoint\x3d"_refreshCheckTextStart"\x3e\r\n                                \x3c/label\x3e\r\n                                \x3cdiv dojoAttachPoint\x3d"_refreshTime" dojotype\x3d"dijit.form.NumberTextBox" data-dojo-attach-event\x3d"onChange:_handleRefreshTimeChange" constraints\x3d\'{min:0,max:9999,pattern:"#0.#"}\' intermediateChanges\x3d"true" value\x3d"0" style\x3d"width:50px;"\x3e\x3c/div\x3e\r\n                                \x3clabel dojoAttachPoint\x3d"_refreshCheckTextEnd"\x3e\r\n                                \x3c/label\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                \x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_mediaFieldSelectDiv" style\x3d"padding:2px 0px 5px 0px"\x3e\r\n              \x3clabel\x3e${i18n.chartSelectLabel}\x3c/label\x3e\r\n              \x3cdiv class\x3d"esriLeadingMargin2" style\x3d"width:100%;padding-top:5px;padding-bottom:5px;"\x3e\r\n                \x3clabel class\x3d"esriSelectLabel"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_sameFieldsBtn" data-dojo-attach-event\x3d"onChange:_handleSameFieldBtnChange" data-dojo-props\x3d"\'class\':\'esriSelectLabel\',checked:true" name\x3d"chartFields"/\x3e\r\n                  ${i18n.thisLayer}\r\n                \x3c/label\x3e\r\n                \x3cdiv style\x3d"padding:2px;"\x3e\x3c/div\x3e\r\n                \x3clabel class\x3d"esriSelectLabel"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_relatedFieldsBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"chartFields"/\x3e\r\n                  ${i18n.relLayer}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_mediaFieldsDiv" style\x3d"width:400px;"\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_mediaFieldsDivTitle" style\x3d"margin-top:5px;"\x3e${i18n.chartFields}\x3c/div\x3e\r\n            \x3cdiv style\x3d"margin-top:5px;"\x3e\r\n              \x3cdiv class\x3d"popupGrid _popupGrid" style\x3d"height:175px;width:378px;" dojoAttachPoint\x3d"_mediaFieldsGridDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!--\r\n            \x3ctable dojoType\x3d"dojox.grid.DataGrid" class\x3d\'popupGrid\' singleClickEdit\x3d\'true\' selectionMode\x3d"none" sortInfo\x3d\'1\' style\x3d"margin-top:5px;border:1px solid #CCCCCC;height:175px;" dojoAttachPoint\x3d"_mediaFieldsGrid"\x3e\r\n            \x3cthead\x3e\r\n                \x3ctr\x3e\r\n                    \x3cth editable\x3d"false" hidden\x3d\'true\' field\x3d"_pos" width\x3d\'0px\'\x3e\x3c/th\x3e\r\n                    \x3cth editable\x3d"false" width\x3d"22px" field\x3d"_item" formatter\x3d"_getInChartCheckbox"\x3e\x3cinput id\x3d\'_mediaFieldsGrid_checkAll\' type\x3d"checkbox" /\x3e\x3c/th\x3e\r\n                    \x3cth editable\x3d"true" field\x3d"label" width\x3d\'185px\'\x3e${i18n.fieldAlias}\x3c/th\x3e\r\n                    \x3cth editable\x3d"false" field\x3d"fieldName" width\x3d\'120px\' formatter\x3d"_formatToken"\x3e${i18n.fieldName}\x3c/th\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/thead\x3e\r\n            \x3c/table\x3e\r\n            --\x3e\r\n            \x3cspan\x3e${i18n.normalizeByLabel}\x26nbsp;\x3c/span\x3e\x3cselect dojoAttachPoint\x3d"_mediaNormalizeSelect" dojoType\x3d"dijit.form.Select" minSize\x3d\'150\'  maxSize\x3d\'180\'  maxHeight\x3d\'150\'  style\x3d"margin:10px 0px 10px 0px;width: 150px;"\x3e\x3c/select\x3e\r\n            \x3cdiv\x3e\r\n            \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_mediaRelatedFieldsDiv"\x3e\r\n              \x3ctable class\x3d"esriFormTable"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"esriLeadingMargin1"\x3e\r\n                      \x3clabel\x3e${i18n.layerTable}\x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput class\x3d"longInput" dojoAttachPoint\x3d"_relatedLayerInput" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"onChange:_handleRelatedLayerInputChange" minSize\x3d\'150\'  maxSize\x3d\'180\'  maxHeight\x3d\'150\'  style\x3d"margin:10px 0px 10px 0px;width: 150px;"\x3e\x3c/input\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"esriLeadingMargin1"\x3e\r\n                      \x3clabel\x3e${i18n.chartField}\x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput class\x3d"longInput" dojoAttachPoint\x3d"_relatedChartFieldInput" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"onChange:_handleRelatedChartValueChange" minSize\x3d\'150\'  maxSize\x3d\'180\'  maxHeight\x3d\'150\'  style\x3d"margin:10px 0px 10px 0px;width: 150px;"\x3e\x3c/input\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"esriLeadingMargin1"\x3e\r\n                      \x3clabel\x3e${i18n.labelField}\x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput dojoAttachPoint\x3d"_mediaTooltipSelect" data-dojo-type\x3d"dijit/form/Select" minSize\x3d\'150\'  maxSize\x3d\'180\'  maxHeight\x3d\'150\'  style\x3d"margin:10px 0px 10px 0px;width: 150px;"\x3e\x3c/input\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv style\x3d"margin:10px 0px 10px 0px" class\x3d"esriFloatTrailing"\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" class\x3d"calcite blue"\x3e\r\n                ${i18n.ok}\r\n            \x3c/button\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" onClick\x3d"dijit.byId(\'_mediaConfigDlg\').hide();"\x3e\r\n                ${i18n.cancel}\r\n            \x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"_sortOptionsDlg" dojoAttachPoint\x3d"_sortOptionsDlg" title\x3d"${i18n.sortOptions}" dojoType\x3d"dijit.Dialog" style\x3d"height:auto;width:575px;overflow-y:hidden;"\x3e\r\n        \x3cdiv style\x3d"margin-bottom:10px;"\x3e\r\n            ${i18n.sortOptionsMsg}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"_sortOptionsGrid" id\x3d"_sortOptionsGridDiv" dojoAttachPoint\x3d"_sortOptionsGridDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"margin:10px 0px 10px 0px" class\x3d"esriFloatTrailing"\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" class\x3d"calcite blue" onClick\x3d"dijit.byId(\'_sortOptionsDlg\').hide(\'ok\');"\x3e\r\n                ${i18n.ok}\r\n            \x3c/button\x3e\r\n            \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" onClick\x3d"dijit.byId(\'_sortOptionsDlg\').hide(\'cancel\');"\x3e\r\n                ${i18n.cancel}\r\n            \x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                hideTargetHandler: null,
                i18n: null,
                _relatedFieldPrefix: "relationships/",
                _expressionPrefix: "expression/",
                _fieldInfosStoreMax: 0,
                _expressionInfoStoreMax: 0,
                _expressionNameCountMax: 0,
                _supportsTime: { shortDate: !0, shortDateLE: !0 },
                _dateFormats: [{ value: '{"dateFormat":"shortDate", "timezone":"utc"}', label: "12/21/1997" }, { value: '{"dateFormat":"longMonthDayYear", "timezone":"utc"}', label: "December 21, 1997" }, { value: '{"dateFormat":"dayShortMonthYear", "timezone":"utc"}', label: "21 Dec 1997" }, {
                        value: '{"dateFormat":"longDate", "timezone":"utc"}',
                        label: "Sunday, December 21, 1997"
                    }, { value: '{"dateFormat":"shortDateShortTime", "timezone":"utc"}', label: "12/21/1997 6:00 PM" }, { value: '{"dateFormat":"shortDateShortTime24", "timezone":"utc"}', label: "12/21/1997 18:00" }, { value: '{"dateFormat":"longMonthYear", "timezone\':"utc"}', label: "December 1997" }, { value: '{"dateFormat":"shortMonthYear", "timezone":"utc"}', label: "Dec 1997" }, { value: '{"dateFormat":"year", "timezone":"utc"}', label: "1997" }, { value: '{"dateFormat":"shortDateLE", "timezone":"utc"}', label: "21/12/1997" },
                    { value: '{"dateFormat":"shortDateLEShortTime", "timezone":"utc"}', label: "21/12/1997 6:00 PM" }, { value: '{"dateFormat":"shortDateLEShortTime24", "timezone":"utc"}', label: "21/12/1997 18:00" }, { value: '{"dateFormat":"shortDateLongTime", "timezone":"utc"}', label: "12/21/1997 6:00:00 PM" }, { value: '{"dateFormat":"shortDateLongTime24", "timezone":"utc"}', label: "12/21/1997 18:00:00" }, { value: '{"dateFormat":"shortDateLELongTime", "timezone":"utc"}', label: "21/12/1997 6:00 PM" }, {
                        value: '{"dateFormat":"shortDateLELongTime24", "timezone":"utc"}',
                        label: "21/12/1997 18:00:00"
                    }
                ],
                _timeFormats: [{ value: '{"timeFormat":"ShortTime"}', label: "6:00 PM" }, { value: '{"timeFormat":"LongTime"}', label: "6:00:00 PM" }, { value: '{"timeFormat":"ShortTime24"}', label: "18:00" }, { value: '{"timeFormat":"LongTime24"}', label: "18:00:00" }],
                _numberFormats: [{ value: '{"places":0, "digitSeparator":true}', label: "0 decimal places" }, { value: '{"places":1, "digitSeparator":true}', label: "1 decimal place" }, { value: '{"places":2, "digitSeparator":true}', label: "2 decimal places" }, {
                    value: '{"places":3, "digitSeparator":true}',
                    label: "3 decimal places"
                }, { value: '{"places":4, "digitSeparator":true}', label: "4 decimal places" }, { value: '{"places":5, "digitSeparator":true}', label: "5 decimal places" }, { value: '{"places":6, "digitSeparator":true}', label: "6 decimal places" }, { value: '{"places":7, "digitSeparator":true}', label: "7 decimal places" }, { value: '{"places":8, "digitSeparator":true}', label: "8 decimal places" }],
                _editorTrackingFields: "creationdate, creator, editdate, editor",
                constructor: function(a, b) {
                    a = a || {};
                    this.container = a.containerNode;
                    this.layerId = a.layerId;
                    this.subLayerId = a.subLayerId;
                    this.mapLayer = a.mapLayer;
                    this.mapLayerFS = null;
                    this.type = a.type;
                    this._layer = a.layerInfo;
                    this._thematicGroupLayerIds = a.thematicGroupLayerIds;
                    this._pbConnects = [];
                    this._relatedInfo = []
                },
                destroy: function() {
                    b.forEach(this._pbConnects, b.disconnect);
                    delete this._pbConnects;
                    this._changeFieldsDlg && this._changeFieldsDlg.destroy();
                    this._customFieldDlg && this._customFieldDlg.destroy();
                    this._mediaConfigDlg && this._mediaConfigDlg.destroy();
                    this._changeFieldsGrid &&
                        this._changeFieldsGrid.destroy();
                    this._sortOptionsDlg && this._sortOptionsDlg.destroy();
                    this._fieldInfosStore && this._fieldInfosStore.close();
                    this._mediaInfoStore && this._mediaInfoStore.close();
                    this._expressionInfoStore && this._expressionInfoStore.close();
                    this._fieldsGridStore = this._title = this._sortOptionsDlg = this.changeFieldsGrid = this._formatFieldsGrid = this._fieldInfosStore = this._mediaInfoStore = this._expressionInfoStore = this._customFieldDlg = this._changeFieldsDlg = this._formatFieldsDlg = this._mediaConfigDlg =
                        null;
                    this._curLayer && this._curLayer.__url && delete this._curLayer.__url;
                    this._curLayer && this._curLayer.__version && delete this._curLayer.__version;
                    this._customAttributeEditor && (this._customAttributeEditor.destroyRecursive(), this._customAttributeEditor = null);
                    this.clusterTooltip && this.clusterTooltip.destroy();
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline",
                        "arcgisonline").rendererCommon);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").popupBuilder)
                },
                postCreate: function() { this.container.addChild(g.byId(this.id)) },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded ? isEmbedded.isItemDetail || (b.style(b.byId("popupBuilderContentHeader"), "display", ""), b.style(this._popupBuilderLayerName, "display", "")) : (b.style(b.byId("popupBuilderContentFooter"), "display", ""), b.style(b.byId("popupBuilderContentHeader"), "display", ""), b.style(this._popupBuilderLayerName,
                        "display", ""));
                    "clustering" === this.type ? (b.byId("popupBuilderContentTitle").innerHTML = this.i18n.popupBuilderClusteringTitle, b.style(this._clusteringHelpIcon, "display", ""), this.clusterTooltip = new g.Tooltip({ connectId: this._clusteringHelpIcon, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.clusterMessage + "\x3c/div\x3e" })) : (b.byId("popupBuilderContentTitle").innerHTML = this.i18n.popupBuilderTitle, b.style(this._clusteringHelpIcon, "display", "none"));
                    this._isImageServiceLayer(this.mapLayer.layer) ||
                        b.style(this._expressionDiv, "display", "");
                    this.mapLayer.thematicGroup && arcgisonline.map.main.hasDynamicLayers(this.mapLayer) && b.style(b.query(".showPopup")[0], "display", "none");
                    this._createDropDownButtons();
                    this._init();
                    !1 === this._hasNumericField && (b.query("._requireNumericFld").forEach(esri.hide), !1 === this._hasDateField && b.query("._requireNumericDateFld").forEach(esri.hide))
                },
                _createDropDownButtons: function() {
                    this._titleFieldsSelect = new g.form.MultiSelect({ style: "width:250px;" });
                    var a = new arcgisonline.map.dijit.DropDownButton({
                        showLabel: !1,
                        dropDown: this._titleFieldsSelect,
                        "class": "calcite transparent tiny noArrow",
                        label: this.i18n.addFieldNameOrExpression
                    }, this._titleButton);
                    this._mediaTitleSelect = new g.form.MultiSelect({ style: "width:250px;" });
                    a = new arcgisonline.map.dijit.DropDownButton({ showLabel: !1, dropDown: this._mediaTitleSelect, "class": "calcite transparent tiny noArrow", label: this.i18n.addFieldNameOrExpression }, this._mediaTitleButton);
                    this._mediaCaptionSelect = new g.form.MultiSelect({ style: "width:250px;" });
                    a = new arcgisonline.map.dijit.DropDownButton({
                        showLabel: !1,
                        dropDown: this._mediaCaptionSelect,
                        "class": "calcite transparent tiny noArrow",
                        label: this.i18n.addFieldNameOrExpression
                    }, this._mediaCaptionButton);
                    this._imageUrlSelect = new g.form.MultiSelect({ style: "width:250px;" });
                    a = new arcgisonline.map.dijit.DropDownButton({ showLabel: !1, dropDown: this._imageUrlSelect, "class": "calcite transparent tiny noArrow", label: this.i18n.addFieldNameOrExpression }, this._imageUrlButton);
                    this._imageLinkSelect = new g.form.MultiSelect({ style: "width:250px;" });
                    a = new arcgisonline.map.dijit.DropDownButton({
                        showLabel: !1,
                        dropDown: this._imageLinkSelect,
                        "class": "calcite transparent tiny noArrow",
                        label: this.i18n.addFieldNameOrExpression
                    }, this._imageLinkButton);
                    a = new g.form.Button({ title: this.i18n.addExpression, label: this.i18n.add, "class": "calcite light small" }, this._addExpression);
                    this._connect(a, "onClick", b.hitch(this, "_onAddExpression"));
                    a = new g.Menu;
                    a.addChild(this._addMediaImage = new g.MenuItem({ tooltip: this.i18n.image, label: this.i18n.image }));
                    a.addChild(this._addMediaPieChart = new g.MenuItem({
                        "class": "_requireNumericFld",
                        tooltip: this.i18n.pieChart,
                        label: this.i18n.pieChart
                    }));
                    a.addChild(this._addMediaBarChart = new g.MenuItem({ "class": "_requireNumericFld", tooltip: this.i18n.barChart, label: this.i18n.barChart }));
                    a.addChild(this._addMediaColumnChart = new g.MenuItem({ "class": "_requireNumericFld", tooltip: this.i18n.columnChart, label: this.i18n.columnChart }));
                    a.addChild(this._addMediaLineChart = new g.MenuItem({ "class": "_requireNumericFld", tooltip: this.i18n.lineChart, label: this.i18n.lineChart }));
                    a = new g.form.DropDownButton({
                        title: this.i18n.addMediaInfo,
                        label: this.i18n.add,
                        dropDown: a,
                        "class": "calcite light small"
                    }, this._addMedia)
                },
                getPopupInfo: function() {
                    var a = {};
                    a.title = b.trim(this._title.get("value"));
                    a.fieldInfos = [];
                    var c = this._fieldInfosStore;
                    c.fetch({
                        sort: [{ attribute: "_pos", descending: !1 }],
                        onItem: b.hitch(this, function(d) {
                            var e = {},
                                f = c.getAttributes(d);
                            b.forEach(f, function(a) {
                                if ("_" !== a.charAt(0)) {
                                    var b = c.getValue(d, a);
                                    esri.isDefined(b) && (e[a] = b)
                                }
                            }, this);
                            e.format && (e.format = b.json.parse(e.format));
                            e.fieldName.startsWith(this._expressionPrefix) &&
                                delete e.label;
                            a.fieldInfos.push(e)
                        })
                    });
                    var d = this._descriptionType.get("value");
                    "_oneField" === d ? this._getItemFromStore(this._fieldInfosStore, this._singleFieldSelect.get("value"), b.hitch(this, function(b) { a.description = this._formatToken(this._fieldInfosStore.getValue(b, "fieldName")) })) : "_customField" === d ? a.description = this._customAttributeEditor.get("value") : "_none" === d ? (a.description = null, b.forEach(a.fieldInfos, "item.visible \x3d false;")) : a.description = null;
                    a.showAttachments = this._showAttachments.checked ?
                        !0 : !1;
                    arcgisonline.map.editTracking.hasEditTracking(this.mapLayer) && !this._showEditTracking.get("checked") && (a.showLastEditInfo = !1);
                    this._showNoDataRecordsCheckbox && (a.layerOptions || (a.layerOptions = {}), a.layerOptions.showNoDataRecords = this._showNoDataRecordsCheckbox.checked ? !1 : !0);
                    this._returnTopmostRasterCheckbox && (a.layerOptions || (a.layerOptions = {}), a.layerOptions.returnTopmostRaster = this._returnTopmostRasterCheckbox.checked ? !0 : !1);
                    if (a.relatedRecordsInfo || this._relatedInfo && this._relatedInfo.length) d = { showRelatedRecords: this._showRelatedData.get("checked") }, this._orderByFields && this._orderByFields.length && (d.orderByFields = this._orderByFields), a = b.mixin(a, { relatedRecordsInfo: d });
                    c = this._expressionInfoStore;
                    c.fetch({
                        sort: [{ attribute: "_pos", descending: !1 }],
                        onItem: b.hitch(this, function(b) {
                            b = { name: c.getValue(b, "name"), title: c.getValue(b, "title"), expression: c.getValue(b, "expression"), returnType: c.getValue(b, "returnType") };
                            a.expressionInfos = a.expressionInfos || [];
                            a.expressionInfos.push(b)
                        })
                    });
                    "clustering" !==
                    this.type && (a.mediaInfos = [], c = this._mediaInfoStore, c.fetch({
                        sort: [{ attribute: "_pos", descending: !1 }],
                        onItem: b.hitch(this, function(d) {
                            var e = {},
                                f = c.getAttributes(d);
                            b.forEach(f, function(a) {
                                    if ("_" !== a.charAt(0)) {
                                        e[a] = c.getValue(d, a);
                                        if ("value" === a && e[a].fields) {
                                            var f = e[a].fields,
                                                g = [],
                                                h = this._fieldInfosStore;
                                            h.fetch({ sort: [{ attribute: "_pos", descending: !1 }], onItem: b.hitch(this, function(a) { a = h.getValue(a, "fieldName"); - 1 < b.indexOf(f, a) && g.push(a) }) });
                                            e[a].fields = g
                                        }
                                        "refreshInterval" === a && 0 >= e[a] && delete e[a]
                                    }
                                },
                                this);
                            a.mediaInfos.push(e)
                        })
                    }));
                    return a
                },
                save: function() {
                    var a = this.getPopupInfo();
                    if (a.description && -1 < a.description.indexOf("\x3ca href\x3d"))
                        for (var c = a.description.indexOf("\x3ca href\x3d"); - 1 < c;) {
                            var d = a.description.substring(c + 1, a.description.indexOf('"', c + 10));
                            if (-1 < d.indexOf("$")) {
                                var f = d.replace(/\$/g, "%24");
                                a.description = a.description.replace(d, f)
                            }
                            c = a.description.indexOf("\x3ca href\x3d", c + 10)
                        }
                    if (this.popupInfo && this._origPopupInfoJson !== b.json.stringify(a))
                        if ("clustering" === this.type) c =
                            this.mapLayer.layer, this.mapLayer.layers && (c = this.mapLayer.layers[this.subLayerId]), d = c.getFeatureReduction(), d.infoTemplate = new esri.dijit.PopupTemplate(a), c.setFeatureReduction(d), this.mapLayer.featureReductionChanged = !0;
                        else {
                            if (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.mapLayer.layer instanceof esri.layers.CSVLayer)
                                if (this.mapLayer.layers || this.mapLayer.tables)
                                    for (f = this.mapLayer.layers, this.mapLayer.tables && (f = f.concat(this.mapLayer.tables)), c = 0; c < f.length; c++) c === this.subLayerId &&
                                        ((d = f[c].getFeatureReduction && f[c].getFeatureReduction()) && d.infoTemplate && (f[c].clusterInfoTemplate = d.infoTemplate), arcgisonline.map.popup.removePopup(this.mapLayer, c), f[c].__popupInfo = a);
                                else(d = this.mapLayer.layer && this.mapLayer.layer.getFeatureReduction && this.mapLayer.layer.getFeatureReduction()) && d.infoTemplate && (this.mapLayer.clusterInfoTemplate = d.infoTemplate), arcgisonline.map.popup.removePopup(this.mapLayer), this.mapLayer.popupInfo = a;
                            else if (this.mapLayer.layer instanceof esri.layers.GeoRSSLayer) c =
                                this.mapLayer.layer.getFeatureLayers()[this.subLayerId], arcgisonline.map.popup.removePopup(this.mapLayer, this.subLayerId), c.__popupInfo = a;
                            else if (this.mapLayer.layer instanceof esri.layers.WFSLayer) arcgisonline.map.popup.removePopup(this.mapLayer), this.mapLayer.popupInfo = a;
                            else if (this.subLayerId || 0 === this.subLayerId)
                                if (this._thematicGroupLayerIds) b.forEach(this._thematicGroupLayerIds, function(c) {
                                    for (var d = 0; d < this.mapLayer.itemLayers.length; d++) {
                                        var e = this.mapLayer.itemLayers[d];
                                        if (e.id === c) {
                                            e.popupInfo &&
                                                arcgisonline.map.popup.removePopup(this.mapLayer, c);
                                            e.popupInfo = b.clone(a);
                                            arcgisonline.map.popup.addPopupLayer(this.mapLayer, c);
                                            break
                                        }
                                    }
                                }, this);
                                else if (this.mapLayerFS) arcgisonline.map.popup.removePopup(this.mapLayerFS), this.mapLayerFS.popupInfo = a, delete this.mapLayerFS.__createDefaultPopup, this.mapLayer.layer.infoTemplates = this.mapLayer.layer.infoTemplates || {}, this.mapLayer.layer.infoTemplates[this.subLayerId] = { infoTemplate: new esri.dijit.PopupTemplate(a), layerUrl: this.mapLayerFS.url, resourceInfo: this.mapLayerFS.serviceInfo };
                            else {
                                var e = f = d = null;
                                if (this.mapLayer.itemLayers) {
                                    for (c = 0; c < this.mapLayer.itemLayers.length; c++)
                                        if (this.mapLayer.itemLayers[c].id === this.subLayerId) {
                                            d = this.mapLayer.itemLayers[c].layerUrl;
                                            f = this.mapLayer.itemLayers[c].layerItemId;
                                            e = this.mapLayer.itemLayers[c]._layerInfo;
                                            break
                                        }
                                    arcgisonline.map.popup.removePopup(this.mapLayer, this.subLayerId)
                                } else this.mapLayer.itemLayers = [], b.forEach(this.mapLayer.layer.layerInfos, function(a) { this.mapLayer.itemLayers.push({ id: a.id }) }, this);
                                for (var g = !1, c = 0; c < this.mapLayer.itemLayers.length; c++)
                                    if (this.mapLayer.itemLayers[c].id ===
                                        this.subLayerId) {
                                        this.mapLayer.itemLayers[c].popupInfo = a;
                                        d && (this.mapLayer.itemLayers[c].layerUrl = d, this.mapLayer.itemLayers[c]._layerInfo = e, f && (this.mapLayer.itemLayers[c].layerItemId = f));
                                        g = !0;
                                        break
                                    }
                                g || (c = { id: this.subLayerId, popupInfo: a }, d && (c.layerUrl = d, c.layerItemId = f, c._layerInfo = this._layer), this.mapLayer.queryServiceUrl && (c.layerUrl = this.mapLayer.queryServiceUrl + "/" + this.subLayerId, c._layerInfo = this._layer, this.mapLayer.queryServiceItemId && (c.layerItemId = this.mapLayer.queryServiceItemId)), this.mapLayer.itemLayers.push(c))
                            } else(d =
                                this.mapLayer.layer && this.mapLayer.layer.getFeatureReduction && this.mapLayer.layer.getFeatureReduction()) && d.infoTemplate && (this.mapLayer.clusterInfoTemplate = d.infoTemplate), arcgisonline.map.popup.removePopup(this.mapLayer), this.mapLayer.popupInfo = a;
                            this.popupInfo = a;
                            this._origPopupInfoJson = b.json.stringify(esri._sanitize(this.popupInfo));
                            if (this.mapLayerFS) this.mapLayerFS.popupChanged = !0, delete this.mapLayerFS.disablePopup, arcgisonline.map.popup.addPopupLayer(this.mapLayerFS);
                            else if (this.mapLayer.popupChanged = !0, delete this.mapLayer.disablePopup, arcgisonline.map.popup.addPopupLayer(this.mapLayer, this.subLayerId), this.mapLayer.layers)
                                for (c = 0; c < this.mapLayer.layers; c++) {
                                    if (c === this.subLayerId && this.mapLayer.layers[c].clusterInfoTemplate) {
                                        if (d = this.mapLayer.layers[c].getFeatureReduction && this.mapLayer.layers[c].getFeatureReduction()) d.infoTemplate = this.mapLayer.clusterInfoTemplate, this.mapLayer.layers[c].setFeatureReduction(d);
                                        delete this.mapLayer.layers[c].clusterInfoTemplate
                                    }
                                } else if (this.mapLayer.clusterInfoTemplate) {
                                    if (d =
                                        this.mapLayer.layer && this.mapLayer.layer.getFeatureReduction && this.mapLayer.layer.getFeatureReduction()) d.infoTemplate = this.mapLayer.clusterInfoTemplate, this.mapLayer.layer.setFeatureReduction(d);
                                    delete this.mapLayer.clusterInfoTemplate
                                }
                            arcgisonline.map.main.markMapAsChanged("popupBuilder");
                            this.mapLayer.layer && "esri.layers.WFSLayer" === this.mapLayer.layer.declaredClass || this._thematicGroupLayerIds || arcgisonline.map.table.refreshTablePrep(this.mapLayer, this.subLayerId, "popup");
                            b.publish("_onRendererUpdate", []);
                            isEmbedded && isEmbedded.isItemDetail && arcgisonline.map.leftPanel.openLeftLegendPanel()
                        }
                },
                _onChangeShowPopup: function() { this._popupShowCheck.get("checked") ? b.style(b.byId("popupBuilderOptions"), "display", "") : b.style(b.byId("popupBuilderOptions"), "display", "none") },
                _onChangeFieldsGridCheckAll: function(a, c, d, f) {
                    if (!1 !== esri.isDefined(f.target.checked)) {
                        var e = f.target.checked;
                        a.fetch({ query: c, onItem: b.hitch(this, function(b) { a.setValue(b, d || f.cell.field, e) }) });
                        this._popupShowCheck.set("checked", !0)
                    }
                },
                _onTitleSelectChange: function(a, c, d) {
                    this._getItemFromStore(this._fieldInfosStore, c.get("value"), b.hitch(this, function(b) {
                        esriGeowConfig.isRightToLeft ? a.set("value", this._formatToken(this._fieldInfosStore.getValue(b, "fieldName")) + a.get("value")) : a.set("value", a.get("value") + this._formatToken(this._fieldInfosStore.getValue(b, "fieldName")));
                        c.set("value", -1, !1)
                    }));
                    this._popupShowCheck.set("checked", !0)
                },
                _onShowFieldsDlg: function(a) {
                    a.preventDefault();
                    this._changeFieldsDlg.show();
                    this._changeFieldsGrid.selection.clear();
                    this._changeFieldsGrid.selection.setSelected(0, !0);
                    this._changeFieldsGrid.setSortIndex(0, !0);
                    this._changeFieldsGrid.resize();
                    this._popupShowCheck.set("checked", !0)
                },
                _onSaveFields: function(a) {
                    this._changeFieldsGrid.edit.apply();
                    this._fieldInfosStore.save({ onComplete: b.hitch(this, function() { this._loadFieldSelects(); "clustering" !== this.type && this._mediaFieldsGrid.setStore(this._fieldInfosStore, "(_cardinality:'esriRelCardinalityOneToOne' OR _cardinality:'') AND (_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger')") }) });
                    this._fieldInfosStore.fetch({
                        onItem: b.hitch(this, function(a) {
                            var c = this._fieldInfosStore.getValue(a, "fieldName");
                            c.startsWith(this._expressionPrefix) && (c = c.substring(this._expressionPrefix.length), this._getItemFromStore(this._expressionInfoStore, c, b.hitch(this, function(b) {
                                var c = this._fieldInfosStore.getValue(a, "label");
                                b && this._expressionInfoStore.setValue(b, "title", c)
                            })))
                        })
                    });
                    this._expressionInfoStore.save({ onComplete: b.hitch(this, function() { this._loadSelect(this._expressionInfoStore, null, !1, this._expressionSelect) }) });
                    this._popupShowCheck.set("checked", !0)
                },
                _onCancelSaveFields: function() {
                    this._changeFieldsDlg.hide();
                    this._fieldInfosStore.revert();
                    this._expressionInfoStore && this._expressionInfoStore.revert()
                },
                _onSaveFieldFormatter: function(a) {
                    this._fieldInfosStore.save();
                    this._popupShowCheck.set("checked", !0)
                },
                _onFormatChange: function(a, b, d) {
                    this._fieldInfosStore.setValue(a, b, d);
                    this._fieldInfosStore.save();
                    this._popupShowCheck.set("checked", !0)
                },
                _onChangePopupContent: function(a) {
                    b.query("._popContentPane").forEach(esri.hide);
                    this.hasOwnProperty(a) && (esri.show(this[a]), this._popupShowCheck.set("checked", !0))
                },
                _onMoveSelectItem: function(a, c, d) {
                    var f = c.getSelected(),
                        f = f.length ? f[0].index : 0,
                        e = c.domNode.options,
                        g = c.containerNode.options.length - 1;
                    if (!(-1 === f || 1 === d && f === g || -1 === d && 0 === f)) {
                        var m = -1,
                            n;
                        this._getItemFromStore(a, e[f].value, b.hitch(this, function(b) { b && (n = b, m = a.getValue(b, "_pos"), a.setValue(b, "_pos", m + d), c.domNode.scrollTop = 15 * (m + d - 2)) }));
                        this._getItemFromStore(a, e[f + d].value, b.hitch(this, function(d) {
                            d && (a.setValue(d,
                                "_pos", m), a.save({ onComplete: b.hitch(this._loadSelect(a, a.getIdentity(n), !1, c)) }))
                        }))
                    }
                },
                _onMoveGridItem: function(a, b, d) {
                    var c = b.selection.getSelected(),
                        e = b.selection.selected.length - 1,
                        g = b.selection.selectedIndex,
                        m = c && c.length && a.getValue(c[0], "_pos") || 0,
                        n = b.getItem(g + d);
                    !(n && c && c.length) || 1 === d && g === e || -1 === d && 0 === g || (a.setValue(c[0], "_pos", m + d), a.setValue(n, "_pos", m), b.setSortIndex(0, !0), b.selection.selectedIndex += d, b.scrollToRow(b.selection.selectedIndex))
                },
                _onAddExpression: function() {
                    this.onClickExpressionEditor().then(b.hitch(this,
                        function(a) {
                            var c = { _pos: this._expressionInfoStoreMax++, name: "expr" + this._expressionNameCountMax++, title: a.title, expression: a.expression, returnType: "esriFieldTypeDouble" === a.returnType ? "number" : "string", _visible: !0 };
                            this._expressionInfoStore.newItem(c);
                            this._expressionInfoStore.save({ onComplete: b.hitch(this, function() { this._loadSelect(this._expressionInfoStore, c.name, !1, this._expressionSelect) }) });
                            a = {
                                fieldName: this._expressionPrefix + c.name,
                                label: c.title || this.i18n.custom,
                                visible: !0,
                                format: "number" ===
                                    c.returnType ? this._numberFormats[2].value : null,
                                _pos: this._fieldInfosStoreMax++,
                                _inChart: !1,
                                _hasDomain: !1,
                                _fieldType: a.returnType,
                                _cardinality: "",
                                _editable: !1
                            };
                            this._fieldInfosStore.newItem(a);
                            this._fieldInfosStore.save({
                                onComplete: b.hitch(this, function() {
                                    this._loadFieldSelects();
                                    this._mediaFieldsGrid.setStore(this._fieldInfosStore, "(_cardinality:'esriRelCardinalityOneToOne' OR _cardinality:'') AND (_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger')");
                                    this._mediaFieldsGrid.edit.apply();
                                    this._mediaFieldsGrid.update()
                                })
                            });
                            this._popupShowCheck.set("checked", !0)
                        }), b.hitch(this, function() {}))
                },
                _onShowExpression: function() {
                    this._getItemFromStore(this._expressionInfoStore, this._expressionSelect.get("value"), b.hitch(this, function(a) {
                        a && this.onClickExpressionEditor({ expression: this._expressionInfoStore.getValue(a, "expression"), title: this._expressionInfoStore.getValue(a, "title") }).then(b.hitch(this, function(c) {
                            this._expressionInfoStore.setValue(a, "title",
                                c.title);
                            this._expressionInfoStore.setValue(a, "expression", c.expression);
                            this._expressionInfoStore.setValue(a, "returnType", "esriFieldTypeDouble" === c.returnType ? "number" : "string");
                            this._expressionInfoStore.save({ onComplete: b.hitch(this, function() { this._loadSelect(this._expressionInfoStore, this._expressionInfoStore.getIdentity(a), !1, this._expressionSelect) }) });
                            this._fieldInfosStore.fetch({
                                query: { fieldName: this._expressionPrefix + this._expressionInfoStore.getValue(a, "name") },
                                onComplete: b.hitch(this, function(a) {
                                    a &&
                                        a.length && (a = a[0], this._fieldInfosStore.setValue(a, "label", c.title), this._fieldInfosStore.setValue(a, "_fieldType", c.returnType), this._fieldInfosStore.setValue(a, "format", "esriFieldTypeDouble" === c.returnType ? this._numberFormats[2].value : null), this._fieldInfosStore.save({
                                            onComplete: b.hitch(this, function() {
                                                this._loadFieldSelects();
                                                this._mediaFieldsGrid.setStore(this._fieldInfosStore, "(_cardinality:'esriRelCardinalityOneToOne' OR _cardinality:'') AND (_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger')");
                                                this._mediaFieldsGrid.edit.apply();
                                                this._mediaFieldsGrid.update()
                                            })
                                        }))
                                })
                            });
                            this._popupShowCheck.set("checked", !0)
                        }), b.hitch(this, function() {}))
                    }))
                },
                _onDeleteExpression: function() {
                    var a = this._expressionSelect.get("value");
                    a.length && (b.forEach(a, b.hitch(this, function(a) {
                            this._getItemFromStore(this._expressionInfoStore, a, b.hitch(this, function(c) {
                                c && (this._expressionInfoStore.deleteItem(c), this._expressionInfoStore.save({
                                    onComplete: b.hitch(this, function(a) {
                                        this._loadSelect(this._expressionInfoStore, this._expressionInfoStore.getIdentity(c), !1, this._expressionSelect);
                                        this._expressionSelect.domNode.options.length || b.forEach([this.i18n.noExpressions, this.i18n.clickAdd], b.hitch(this, function(a, c) {
                                            var d = b.create("option");
                                            d.innerHTML = a;
                                            d.value = c - 1 + "";
                                            this._expressionSelect.containerNode.appendChild(d)
                                        }))
                                    })
                                }), this._fieldInfosStore.fetch({ query: { fieldName: this._expressionPrefix + a }, onComplete: b.hitch(this, function(a) { a && a.length && (this._fieldInfosStore.deleteItem(a[0]), this._fieldInfosStore.save({ onComplete: b.hitch(this, function() { this._loadFieldSelects() }) })) }) }))
                            }))
                        })),
                        this._popupShowCheck.set("checked", !0))
                },
                onClickExpressionEditor: function(a) {
                    var c = new b.Deferred;
                    b.byId("expressionEditorDlg") ? this.destroyExpressionEditorDlg() : b.create("div", { id: "expressionEditorDlg" }, document.body);
                    this.expressionEditorCommitHandler = b.subscribe("expression-commit", b.hitch(this, function(a) {
                        var d = new esri.ArcadeExpression({ expression: a.expression, returnType: a.returnType, profile: esri.arcadeProfiles.popupProfile });
                        esri.arcadeProfiles.popupProfile.initialize([d]).then(b.hitch(this,
                            function() {
                                this.destroyExpressionEditorDlg();
                                c.resolve(a)
                            }), b.hitch(this, function() {
                            this.destroyExpressionEditorDlg();
                            c.resolve(a)
                        }))
                    }));
                    this.expressionEditorCancelHandler = b.subscribe("expression-cancel", b.hitch(this, function() {
                        this.destroyExpressionEditorDlg();
                        c.reject()
                    }));
                    var d = this.mapLayer.layer;
                    if (this.mapLayer.layers) d = this.mapLayer.layers[this.subLayerId];
                    else if (this.mapLayer.layersInfo)
                        if (this.mapLayer.layer.dynamicLayerInfos) {
                            var f = arcgisonline.map.main.getItemWithId(this.mapLayer.layer.dynamicLayerInfos,
                                    this.subLayerId),
                                d = b.clone(arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, f.source.mapLayerId));
                            d.drawingInfo = f.drawingInfo || d.drawingInfo;
                            d.id = f.id;
                            d.url = this.mapLayer.layer.url + "/" + d.id
                        } else this.mapLayer.queryLayersInfo && this.mapLayer.queryServiceUrl ? (d = arcgisonline.map.main.getItemWithId(this.mapLayer.queryLayersInfo.layers, this.subLayerId), d.url = this.mapLayer.queryServiceUrl + "/" + d.id) : "esri.layers.ArcGISTiledMapServiceLayer" === this.mapLayer.layer.declaredClass ? this.mapLayer.itemLayers ?
                            (f = arcgisonline.map.main.getItemWithId(this.mapLayer.itemLayers, this.subLayerId), f.layerUrl && f._layerInfo ? (d = f._layerInfo, d.url = f.layerUrl) : d = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, this.subLayerId)) : d = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, this.subLayerId) : (d = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, this.subLayerId), d.url = this.mapLayer.layer.url + "/" + d.id);
                    this.expressionEditor = new arcgisonline.map.dijit.renderer.ExpressionEditor({
                        mapLayer: this.mapLayer,
                        layer: d,
                        subLayerId: this.subLayerId,
                        expression: a && a.expression,
                        expressionTitle: a && a.title,
                        defaultExpressionScript: "// " + this.i18n.defaultExpressionScript_line1 + "\n// " + this.i18n.defaultExpressionScript_line2 + "\n// Average($feature.SalesQ1, $feature.SalesQ2, $feature.SalesQ3, $feature.SalesQ4)\n\n",
                        latestPopupInfo: this.getPopupInfo(),
                        showViewScale: !1,
                        type: "popup"
                    }, "expressionEditorDlg");
                    this.expressionEditor.startup();
                    return c
                },
                destroyExpressionEditorDlg: function() {
                    this.expressionEditorCommitHandler &&
                        this.expressionEditorCommitHandler.remove();
                    this.expressionEditorCommitHandler = null;
                    this.expressionEditorCancelHandler && this.expressionEditorCancelHandler.remove();
                    this.expressionEditorCancelHandler = null;
                    this.expressionEditor && this.expressionEditor.destroy();
                    this.expressionEditor = null;
                    b.byId("expressionEditorDlg") && document.body.removeChild(b.byId("expressionEditorDlg"))
                },
                _onAddMedia: function(a) {
                    this._mediaInfoStore.fetch({
                        query: { type: a.type },
                        onComplete: b.hitch(this, function(c) {
                            var d = this._mediaSelect.domNode.options || [],
                                d = d.length && "-1" === d[0].value ? 0 : d.length;
                            c = b.mixin(b.mixin({}, a), { _pos: d, title: a.title + " " + (c.length + 1), _visible: !0 });
                            this._onShowMediaConfigDlg(c, !1)
                        })
                    });
                    this._popupShowCheck.set("checked", !0)
                },
                _onDeleteMedia: function() {
                    var a = this._mediaSelect,
                        c = a.get("value");
                    if (c.length) {
                        var d = this._mediaInfoStore;
                        b.forEach(c, b.hitch(this, function(c) {
                            this._getItemFromStore(d, c, b.hitch(this, function(c) {
                                c && (d.deleteItem(c), d.save({
                                    onComplete: b.hitch(this, function(e) {
                                        this._loadSelect(d, d.getIdentity(c), !1, a);
                                        a.domNode.options.length ||
                                            b.forEach([this.i18n.noImagesOrCharts, this.i18n.clickAdd, this.i18n.useArrows], b.hitch(this, function(c, d) {
                                                var e = b.create("option");
                                                e.innerHTML = c;
                                                e.value = d - 1 + "";
                                                a.containerNode.appendChild(e)
                                            }))
                                    })
                                }))
                            }))
                        }));
                        this._popupShowCheck.set("checked", !0)
                    }
                },
                _onShowMediaSettingsDlg: function(a) {
                    this._getItemFromStore(this._mediaInfoStore, this._mediaSelect.get("value"), b.hitch(this, function(a) { a && this._onShowMediaConfigDlg(a, !0) }));
                    this._popupShowCheck.set("checked", !0)
                },
                _onShowMediaConfigDlg: function(a, c) {
                    var d =
                        this._mediaInfoStore,
                        f = c ? d.getValue(a, "type") : a.type;
                    this._mediaConfig = a;
                    this._mediaTitle.set("value", c ? d.getValue(a, "title") : a.title);
                    this._mediaCaption.set("value", c ? d.getValue(a, "caption") : a.caption);
                    var e = c ? d.getValue(a, "value") : a.value,
                        g = this.i18n.refreshIntervalText,
                        m = g.indexOf("${"),
                        n = g.indexOf("}");
                    this._refreshCheckTextStart.innerHTML = g.substring(0, m);
                    this._refreshCheckTextEnd.innerHTML = g.substring(n + 1);
                    if ("image" === f) esri.show(this._imageConfigDiv), esri.hide(this._mediaFieldsDiv), esri.hide(this._mediaFieldSelectDiv),
                        esri.hide(this._mediaRelatedFieldsDiv), this._mediaConfigDescription.innerHTML = this.i18n.specifyImageInfo, this._mediaConfigDlg.set("title", this.i18n.configureImage), this._imageUrl.set("value", e.sourceURL), this._imageLink.set("value", e.linkURL), a = c ? d.getValue(a, "refreshInterval") : a.refreshInterval, this._refreshCheck.set("checked", a ? !0 : !1), this._refreshTime.set("value", a);
                    else {
                        esri.hide(this._imageConfigDiv);
                        if (this._relatedInfo && 0 === this._relatedInfo.length) esri.hide(this._mediaFieldSelectDiv), esri.show(this._mediaFieldsDiv);
                        else {
                            var r = !1;
                            b.forEach(this._relatedInfo, function(a) {!a || "esriRelCardinalityOneToMany" !== a.relation.cardinality && "esriRelCardinalityManyToMany" !== a.relation.cardinality && "esriRelCardinalityManyToOne" !== a.relation.cardinality || (r = !0) });
                            r ? esri.show(this._mediaFieldSelectDiv) : esri.hide(this._mediaFieldSelectDiv)
                        }
                        this._mediaConfigDescription.innerHTML = this.i18n.specifyChartInfo;
                        "piechart" === f ? b.style(this._mediaNormalizeSelect, "display", "none") : b.style(this._mediaNormalizeSelect, "display", "");
                        switch (f) {
                            case "piechart":
                                this._mediaConfigDlg.set("title",
                                    this.i18n.configurePieChart);
                                break;
                            case "barchart":
                                this._mediaConfigDlg.set("title", this.i18n.configureBarChart);
                                break;
                            case "linechart":
                                this._mediaConfigDlg.set("title", this.i18n.configureLineChart);
                                break;
                            case "columnchart":
                                this._mediaConfigDlg.set("title", this.i18n.configureColumnChart);
                                break;
                            default:
                                this._mediaConfigDlg.set("title", this.i18n.configureChart)
                        }
                        var v = this._fieldInfosStore,
                            w = !1,
                            t, x = -1;
                        b.forEach(e.fields, function(a) {
                            this._getItemFromStore(v, a, b.hitch(this, function(b) {
                                var c = this._fromRelatedFieldName(a),
                                    d;
                                0 < c.length && (this._relatedInfo && this._relatedInfo[c[0]] && (d = this._relatedInfo[c[0]].relation), !d || "esriRelCardinalityOneToMany" !== d.cardinality && "esriRelCardinalityManyToMany" !== d.cardinality || (w || -1 !== x || (x = b._relatedId), w = !0, t = b));
                                v.setValue(b, "_inChart", !0)
                            }))
                        }, this);
                        this._relatedFieldsBtn.set("value", w);
                        this._sameFieldsBtn.set("value", !w);
                        this._handleSameFieldBtnChange(!w);
                        this._mediaNormalizeSelect.setStore(this._fieldInfosStore, null, { query: "_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger'" });
                        this._mediaNormalizeSelect.addOption([{ value: "_none", label: this.i18n.none }]);
                        this._mediaNormalizeSelect.set("value", e.normalizeField || "_none");
                        this._mediaTooltipSelect.setStore(this._fieldInfosStore, null, { query: "(_cardinality:'esriRelCardinalityOneToMany' OR _cardinality:'esriRelCardinalityManyToMany') AND (NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry')" }); - 1 === x ? (this._relatedChartFieldInput.setStore(this._fieldInfosStore, null, { query: "(_cardinality:'esriRelCardinalityOneToMany' OR _cardinality:'esriRelCardinalityManyToMany') AND (NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry')" }),
                            this._mediaTooltipSelect.setStore(this._fieldInfosStore, null, { query: "(_cardinality:'esriRelCardinalityOneToMany' OR _cardinality:'esriRelCardinalityManyToMany') AND (NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry')" })) : this._relatedLayerInput.set("value", x);
                        setTimeout(b.hitch(this, function() {
                            this._mediaTooltipSelect.addOption([{ value: "_none", label: this.i18n.none }]);
                            this._mediaTooltipSelect.set("value", e.tooltipField || "_none");
                            t && (this._relatedChartFieldInput.set("value",
                                this._fieldInfosStore.getIdentity(t)), this._relatedChartCurrentField = this._relatedChartFieldInput.get("value"))
                        }), 50)
                    }
                    this._mediaConfigDlg.show();
                    this._mediaFieldsGrid.resize();
                    this._popupShowCheck.set("checked", !0)
                },
                _onSaveMediaConfig: function() {
                    this._mediaFieldsGrid.edit.apply();
                    var a = this._mediaInfoStore,
                        c = this._mediaConfig;
                    a.isItem(c) || (this._mediaConfig = c = a.newItem(c));
                    var d = b.trim(this._mediaTitle.get("value"));
                    if (!(this._mediaInfoStore.getValue(c, "_displayTitle") || d && d.length)) {
                        for (var d = null,
                                f = this._mediaSelect.containerNode.options, e = !0, g = 0; e;) g++, e = b.filter(f, function(a) { return a.text === this.i18n.untitled + " " + g }, this).length;
                        a.setValue(c, "_displayTitle", g)
                    }
                    a.setValue(c, "title", d);
                    a.setValue(c, "caption", b.trim(this._mediaCaption.get("value")));
                    d = b.mixin({}, a.getValue(c, "value"));
                    if ("image" === a.getValue(c, "type")) d = b.mixin(d, { sourceURL: b.trim(this._imageUrl.get("value")), linkURL: b.trim(this._imageLink.get("value")) }), this._refreshCheck.get("checked") && this._refreshTime.get("value") ? a.setValue(c,
                        "refreshInterval", this._refreshTime.get("value")) : a.setValue(c, "refreshInterval", 0);
                    else {
                        var m = this._fieldInfosStore,
                            n = [];
                        m.fetch({ sort: [{ attribute: "_pos", descending: !1 }], onItem: b.hitch(this, function(a) {!0 === m.getValue(a, "_inChart") && (n.push(m.getValue(a, "fieldName")), m.setValue(a, "_inChart", !1)) }) });
                        d = b.mixin(d, { fields: n });
                        f = this._mediaNormalizeSelect.get("value");
                        d = b.mixin(d, { normalizeField: "_none" !== f ? f : null });
                        f = this._mediaTooltipSelect.get("value");
                        d = b.mixin(d, { tooltipField: "_none" !== f ? f : null })
                    }
                    a.setValue(c,
                        "value", d);
                    a.save({
                        onComplete: b.hitch(this, function() {
                            this._loadSelect(a, a.getIdentity(c), !1, this._mediaSelect);
                            this._loadFieldSelects()
                        })
                    });
                    this._popupShowCheck.set("checked", !0)
                },
                _onShowSortOptions: function(a) {
                    var c = [];
                    a.preventDefault();
                    this._createSortFieldsGrid();
                    this._sortOptionsDlg.show();
                    var d = b.connect(this._sortOptionsDlg, "hide", b.hitch(this, function(a) {
                        d.remove();
                        this._fieldsGridStore.query(b.hitch(this, function(a) { "none" !== a.sortField && "none" !== a.sortOrder && c.push({ field: a.sortField, order: a.sortOrder }) }));
                        this._orderByFields = c;
                        this._fieldsGrid.destroyRecursive();
                        this._fieldsGrid = null
                    }))
                },
                _createSortFieldsGrid: function() {
                    if (!this._fieldsGrid) {
                        var a = this._relatedInfo || [],
                            c = [],
                            d, f, e, h = this.popupInfo.relatedRecordsInfo && this.popupInfo.relatedRecordsInfo.orderByFields || [],
                            m = b.hitch(this, function(a, b) { a.sortField = b }),
                            n = [{ field: "name", label: this.i18n.relatedData, renderCell: b.hitch(this, function(a, c, d, e) { a = b.create("span", { title: a.name, innerHTML: a.name }); return b.place(a, d) }) }, {
                                field: "sortField",
                                label: this.i18n.field,
                                autoSave: !0,
                                renderCell: b.hitch(this, function(a, c, d, e) {
                                    a = new g.form.Select({ onChange: b.hitch(this, m, a), maxHeight: 150, style: "width:150px;max-width:150px;text-overflow:ellipsis;", options: a.fieldOptions });
                                    d.widget = a;
                                    return b.place(a.domNode, d)
                                })
                            }, dgrid.editor({ autoSave: !0, field: "sortOrder", label: this.i18n.order, editorArgs: { options: [{ label: this.i18n.none, value: "none" }, { label: this.i18n.asc, value: "asc" }, { label: this.i18n.desc, value: "desc" }], maxHeight: 150, style: "width:150px;max-width:150px;overflow:hidden;" } },
                                g.form.Select)];
                        this._fieldsGridStore || (b.forEach(a, b.hitch(this, function(a, g) {
                            d = f = null;
                            a && (e = b.map(a.relatedFields, function(a) { return { label: a.alias, value: a.name, selected: b.some(h, function(b) { return b.field === a.name ? (d = b.order, f = a.name, !0) : !1 }) } }), c.push({ id: g, name: a.layerInfo && a.layerInfo.name, fieldOptions: e, sortField: f || e[0].value || null, sortOrder: d || "none" }))
                        })), this._fieldsGridStore = new b.store.Observable(new b.store.Memory({ idProperty: "id", data: c })));
                        this._fieldsGrid = new(b.declare([dgrid.Grid,
                            dgrid.OnDemandGrid, dgrid.extensions.DijitRegistry
                        ]))({ columns: n, store: this._fieldsGridStore, highlightDuration: 0, maintainOddEven: !1, id: "_sortOptionsGrid", showLoadingMessage: !1, showHeader: !0, selectionMode: "none", className: ".dgrid-autoheight" }, b.create("div", {}, this._sortOptionsGridDiv));
                        this._fieldsGrid.startup();
                        b.aspect.before(this._fieldsGrid, "removeRow", b.hitch(this, function(a) {
                            (a = (a = this._fieldsGrid.cell(a).element) && (a.contents || a).widget) && a.destroyRecursive()
                        }))
                    }
                },
                _onClose: function(a, c) {
                    c.preventDefault();
                    b.byId("popupBuilderContentPane").scrollTop = 0;
                    a && this._popupShowCheck.get("checked") ? (arcgisonline.map.main.map.infoWindow.hide(), this.save()) : a && !this._popupShowCheck.get("checked") && arcgisonline.map.popup.hasPopup(this.mapLayer, this.subLayerId) && (this.mapLayer.popupChanged = !0, this.mapLayer.layers || this.mapLayer.tables ? (a = this.mapLayer.layers, this.mapLayer.tables && (a = a.concat(this.mapLayer.tables)), arcgisonline.map.popup.removePopup(this.mapLayer, a[this.subLayerId].id), this.mapLayer.__disablePopup = !0) : this.mapLayer.layer instanceof esri.layers.FeatureLayer || this.mapLayer.layer instanceof esri.layers.CSVLayer ? (arcgisonline.map.popup.removePopup(this.mapLayer, this.subLayerId), this.mapLayer.disablePopup = !0) : arcgisonline.map.popup.removePopup(this.mapLayer, this.subLayerId));
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : "clustering" === this.type ? arcgisonline.map.leftPanel.openLeftClusteringPanel(this.mapLayer) : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _init: function() {
                    this.popupInfo = {};
                    this._customAttributeEditor = this._customAttributeEditor || new g.Editor({
                        id: "item-description-edit",
                        plugins: ["bold", "italic", "underline", "foreColor", "hiliteColor", "|", "justifyLeft", "justifyCenter", "justifyRight", "justifyFull", "|", "insertOrderedList", "insertUnorderedList", "indent", "outdent", "|", "createEsriLink", "unlink", "insertEsriImage", "removeFormat", "|", "undo", "redo", "|", "viewsource", { name: "dijit._editor.plugins.FontChoice", command: "fontName", custom: "Arial;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";") },
                            { name: "dijit._editor.plugins.FontChoice", command: "fontSize", custom: ["2", "3", "4", "5", "6"] }, { name: "dijit._editor.plugins.EnterKeyHandling", blockNodeForEnter: "br" }
                        ],
                        trim: "true",
                        style: "border:1px solid #CCCCCC;height:200px;"
                    }, this._customFieldEditor);
                    this._popupBuilderLayerName.innerHTML = arcgisonline.map.main.getLayerTitle(this.mapLayer, this.subLayerId);
                    !this._isImageServiceLayer(this.mapLayer.layer) || this.mapLayer.layer instanceof esri.layers.RasterXLayer || (this._showNoDataRecordsCheckbox = new g.form.CheckBox({ checked: !1 },
                        this._noDataHandlerDiv), b.html.set(this._noDataHandlerText, this.i18n.showNoDataRecordsText), this._returnTopmostRasterCheckbox = new g.form.CheckBox({ checked: !0 }, this._returnTopmostRasterHandlerDiv), b.html.set(this._returnTopmostRasterHandlerText, this.i18n.returnTopmostRasterText), this.mapLayer.serviceInfo && this.mapLayer.serviceInfo.currentVersion && 10.8 > this.mapLayer.serviceInfo.currentVersion && (this._returnTopmostRasterCheckbox.set("checked", !1), this._returnTopmostRasterCheckbox.set("disabled", !0),
                        b.addClass(this._returnTopmostRasterHandlerText, "disabledText"), this._returnTopmostRasterTooltip = new g.Tooltip({ connectId: this._returnTopmostRasterHandlerText, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.returnTopMostRasterTooltip + "\x3c/div\x3e" })));
                    if (this.layerInfo && this.layerInfo.editFieldsInfo) {
                        var a = [],
                            c;
                        for (c in this.layerInfo.editFieldsInfo) a.push(this.layerInfo.editFieldsInfo[c]);
                        this._editorTrackingFields = a.join(",")
                    }
                    if ("clustering" === this.type)
                        for (this.popupInfo = this.mapLayer.layers ?
                            this.mapLayer.layers[this.subLayerId].getFeatureReduction().infoTemplate.toJson() : this.mapLayer.layer.getFeatureReduction().infoTemplate.toJson(), b.style(this._showAttachmentsDiv, "display", "none"), b.style(this._expressionDiv, "display", "none"), b.style(this._mediaDiv, "display", "none"), c = this._descriptionType.options, a = c.length - 1; 0 <= a; a--) - 1 < b.indexOf(["_oneField", "_none"], c[a].value) && c.splice(a, 1);
                    else if (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.mapLayer.layer instanceof esri.layers.CSVLayer) {
                        if (this.mapLayer.layers ||
                            this.mapLayer.tables)
                            for (c = this.mapLayer.layers, this.mapLayer.tables && (c = c.concat(this.mapLayer.tables)), a = 0; a < c.length; a++) {
                                if (a === this.subLayerId) {
                                    this.popupInfo = c[a].__popupInfo ? c[a].__popupInfo : c[a].toJson().popupInfo;
                                    this._curLayer = c[a];
                                    break
                                }
                            } else this.popupInfo = this.mapLayer.popupInfo ? this.mapLayer.popupInfo : this.mapLayer.layer.toJson().popupInfo, this._curLayer = this.mapLayer.layer;
                        this.popupInfo || (this.popupInfo = {})
                    } else if (this.subLayerId || 0 === this.subLayerId)
                        if (this._thematicGroupLayerIds) {
                            c =
                                this._thematicGroupLayerIds[0];
                            for (a = 0; a < this.mapLayer.itemLayers.length; a++) { var d = this.mapLayer.itemLayers[a]; if (d.id === c) { this.popupInfo = d.popupInfo; break } }
                            this.popupInfo || (this.popupInfo = {})
                        } else if (this.mapLayerFS = arcgisonline.map.main.getFlForMSL(this.mapLayer, this.subLayerId)) this.popupInfo = this.mapLayerFS.popupInfo ? this.mapLayerFS.popupInfo : {}, this._curLayer = this.mapLayerFS.layer;
                    else {
                        if (this.mapLayer.itemLayers)
                            for (a = 0; a < this.mapLayer.itemLayers.length; a++) this.mapLayer.itemLayers[a].id ==
                                this.subLayerId && (this.popupInfo = this.mapLayer.itemLayers[a].popupInfo, this.mapLayer.itemLayers[a].layerUrl && (this._curLayer = this.mapLayer.itemLayers[a]._layerInfo, this._curLayer.__url = this.mapLayer.itemLayers[a].layerUrl));
                        !this._curLayer && this.mapLayer.layersInfo && !this.mapLayer.layer.dynamicLayerInfos && this.mapLayer.layer.version && 10.1 <= this.mapLayer.layer.version ? (this._curLayer = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, this.subLayerId), this._curLayer.__url = this.mapLayer.url +
                            "/" + this.subLayerId, this._curLayer.version || (this._curLayer.__version = this.mapLayer.layer.version)) : !this._curLayer && this.mapLayer.queryServiceUrl && this.mapLayer.queryLayersInfo && !this.mapLayer.layer.dynamicLayerInfos && this.mapLayer.layer.version && 10.1 <= this.mapLayer.layer.version && (this._curLayer = arcgisonline.map.main.getItemWithId(this.mapLayer.queryLayersInfo.layers, this.subLayerId), this._curLayer.__url = this.mapLayer.url + "/" + this.subLayerId, this._curLayer.version || (this._curLayer.__version = this.mapLayer.layer.version));
                        this.popupInfo || (this.popupInfo = {})
                    } else this.popupInfo = this.mapLayer.popupInfo ? this.mapLayer.popupInfo : {}, this._curLayer = this.mapLayer.layer;
                    this._origPopupInfoJson = this.popupInfo ? b.json.stringify(this.popupInfo) : "";
                    this._popupShowCheck.set("checked", 2 < this._origPopupInfoJson.length && !this.mapLayer.disablePopup);
                    b.connect(this._title, "onChange", b.hitch(this, function() { this._popupShowCheck.set("checked", !0) }));
                    var f;
                    this._curLayer && this._curLayer.relationships && 0 < this._curLayer.relationships.length &&
                        (this._curLayer.__version && 10.1 <= this._curLayer.__version || this._curLayer.version && 10.1 <= this._curLayer.version) && (this._relatedInfo = this._curLayer._relatedInfo || [], 0 === this._relatedInfo.length && (f = this._getRelatedFieldsInfo()));
                    syncAsyncObj = f && 0 < f.length ? new b.promise.all(f) : "sync";
                    b.when(syncAsyncObj, b.hitch(this, this._populatePopupBuilder))
                },
                _populatePopupBuilder: function() {
                    if (this.mapLayer.layer) this._isEditable = this.mapLayerFS ? this.mapLayerFS.layer.isEditable ? this.mapLayerFS.layer.isEditable() :
                        !1 : this.mapLayer.layer.isEditable ? this.mapLayer.layer.isEditable() : !1;
                    else {
                        var a = this.mapLayer.layers;
                        this.mapLayer.tables && (a = a.concat(this.mapLayer.tables));
                        this._isEditable = a[this.subLayerId].isEditable ? a[this.subLayerId].isEditable() : !1
                    }
                    this._displayField = this.getDisplayField();
                    if (esri.isDefined(this.popupInfo.title)) this._title.set("value", this.popupInfo.title, !1);
                    else if ("clustering" !== this.type) {
                        var a = this._layer.name ? this._layer.name : this.mapLayer.title,
                            c = this._displayField ? this._formatToken(this._displayField) :
                            "";
                        this._title.set("value", a + (c ? ":" : "") + c, !1)
                    } else this._title.set("value", "");
                    var d = b.clone(this._layer.fields),
                        f = !1,
                        e = !1,
                        h = !1;
                    this._isImageServiceLayer(this.mapLayer.layer) && (d = this.mapLayer.layer.getCustomRasterFields({ rasterAttributeTableFieldPrefix: "Raster." }), h = 0 > b.indexOf(["F32", "F64"], this.mapLayer.layer.pixelType), e = (f = this.mapLayer.layer.capabilities && -1 < this.mapLayer.layer.capabilities.toLowerCase().indexOf("catalog") || this.mapLayer.layer.fields && 0 < this.mapLayer.layer.fields.length) && ("esriImageServiceDataTypeVector-UV" ===
                        this.mapLayer.layer.serviceDataType || "esriImageServiceDataTypeVector-MagDir" === this.mapLayer.layer.serviceDataType));
                    "clustering" === this.type ? (d = [], b.forEach(this.popupInfo.fieldInfos, function(a) {
                        a = b.clone(a);
                        a.name = a.fieldName;
                        a.fieldName.startsWith(this._expressionPrefix) || (a.format && esri.isDefined(a.format.places) ? a.type = "esriFieldTypeDouble" : a.type = "esriFieldTypeString", d.push(a))
                    }, this)) : !d && this.mapLayer.layer.dynamicLayerInfos && this._layer.source && b.forEach(this.mapLayer.layersInfo.layers,
                        function(a) { a.id == this._layer.source.mapLayerId && (d = a.fields) }, this);
                    var m = this.popupInfo.fieldInfos;
                    this.mapLayer.thematicGroup && this.mapLayer.thematicGroup.fieldNames && this.mapLayer.thematicGroup.fieldNames.length && (d = b.filter(d, function(a) { return b.some(this.mapLayer.thematicGroup.fieldNames, function(b) { return b === a.name }, this) }, this));
                    var p = [],
                        r = 0,
                        v, w = { esriFieldTypeDouble: 1, esriFieldTypeSingle: 1 },
                        t = { esriFieldTypeInteger: 1, esriFieldTypeSmallInteger: 1 },
                        x = { esriFieldTypeDate: 1 };
                    this._curLayer && this._relatedInfo &&
                        (this._curLayer._relatedInfo = this._relatedInfo, b.forEach(this._relatedInfo, function(a) { a && (b.forEach(a.relatedFields, function(a) { d.push(a) }, this), "esriRelCardinalityOneToMany" !== a.relation.cardinality && "esriRelCardinalityManyToMany" !== a.relation.cardinality && "esriRelCardinalityManyToOne" !== a.relation.cardinality || this._relatedLayerInput.addOption({ value: a.relation.id, label: a.layerInfo.name })) }, this));
                    m && m.length ? b.forEach(d, b.hitch(this, function(a, c) {
                        var d, e, f;
                        c = "";
                        d = b.some(m, b.hitch(this, function(b,
                            c) { r = c; return a.name === b.fieldName })); - 1 !== a.name.indexOf(this._relatedFieldPrefix) && (e = this._fromRelatedFieldName(a.name), e = e[0]);
                        e && (f = this._relatedInfo[e].layerInfo.name, c = this._relatedInfo[e].relation.cardinality);
                        if (d) {
                            v = m[r];
                            var g = b.mixin({}, v),
                                g = b.mixin(g, { isEditable: !1 === a.editable ? !1 : esri._isDefined(v.isEditable) ? v.isEditable : a.editable });
                            g.isEditable = g.isEditable && !esri.isDefined(f);
                            g._isEditableOnLayer = a.editable;
                            if (esri.isDefined(v.format)) g = b.mixin(g, { format: b.json.stringify(v.format) });
                            else {
                                d = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1;
                                var h = null;
                                d || (a.type in t ? h = this._numberFormats[0].value : a.type in w ? h = this._numberFormats[2].value : a.type in x && 10 <= this.mapLayer.layer.version && (h = this._dateFormats[4].value));
                                h && (g = b.mixin(g, { format: h }))
                            }
                            g.label = g.label || a.alias || a.fieldName || a.name || "";
                            d = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1;
                            p.push(b.mixin({
                                _fieldType: a.type,
                                _hasDomain: d,
                                _pos: r,
                                _inChart: !1,
                                statisticType: a.statisticType,
                                _relateName: f,
                                _cardinality: c,
                                _relatedId: e ? e : "-1"
                            }, g))
                        } else d = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1, h = null, d || (a.type in t ? h = this._numberFormats[0].value : a.type in w ? h = this._numberFormats[2].value : a.type in x && 10 <= this.mapLayer.layer.version && (h = this._dateFormats[4].value)), g = "esriFieldTypeString" === a.type || d ? "textbox" : null, p.push({
                            fieldName: a.name,
                            label: a.alias,
                            isEditable: a.editable && !esri.isDefined(f) || !1,
                            _isEditableOnLayer: a.editable,
                            tooltip: null,
                            visible: !1,
                            format: h,
                            stringFieldOption: g,
                            _fieldType: a.type,
                            _hasDomain: d,
                            _pos: 9999,
                            _inChart: !1,
                            statisticType: a.statisticType,
                            _relateName: f,
                            _cardinality: c,
                            _relatedId: e ? e : "-1"
                        })
                    })) : p = b.map(d, b.hitch(this, function(a, c) {
                        var d = a.name.toLowerCase(),
                            g = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1,
                            m = { subclass: 0, rings_ok: 0, rings_nok: 0 },
                            n, p, r = ""; - 1 !== a.name.indexOf(this._relatedFieldPrefix) && (n = this._fromRelatedFieldName(a.name), n = n[0]);
                        n && (p = this._relatedInfo[n].layerInfo.name, r = this._relatedInfo[n].relation.cardinality);
                        f && (m["raster.itempixelvalue"] = 0, e && (m["raster.magnitude"] = 0, m["raster.direction"] = 0));
                        var v = "esriFieldTypeOID" !== a.type && "esriFieldTypeGlobalID" !== a.type && "esriFieldTypeGeometry" !== a.type,
                            v = (v = v && !(d in m) && !(-1 < d.indexOf("area") || -1 < d.indexOf("length") || -1 < d.indexOf("perimeter") || -1 < d.indexOf("raster.servicepixelvalue."))) && d.lastIndexOf("_i", d.length - 2) !== d.length - 2,
                            m = null;
                        g || (a.type in t ? m = this._numberFormats[0].value : a.type in w ? m = h && (-1 < d.indexOf("raster.servicepixelvalue") || -1 < d.indexOf("raster.itempixelvalue")) ?
                            this._numberFormats[0].value : this._numberFormats[2].value : a.type in x && 10 <= this.mapLayer.layer.version && (m = this._dateFormats[4].value));
                        d = "esriFieldTypeString" === a.type || g ? "textbox" : null;
                        return b.mixin({}, {
                            fieldName: a.name,
                            label: a.alias,
                            isEditable: a.editable && !esri.isDefined(p) || !1,
                            _isEditableOnLayer: a.editable,
                            tooltip: null,
                            visible: v,
                            format: m,
                            stringFieldOption: d,
                            _pos: c,
                            _inChart: !1,
                            _hasDomain: g,
                            _fieldType: a.type,
                            _editable: a.editable,
                            statisticType: a.statisticType,
                            _relateName: p,
                            _cardinality: r,
                            _relatedId: n ?
                                n : "-1"
                        })
                    }));
                    this._fieldInfosStoreMax = d.length;
                    this.fieldsCount = p.length;
                    this.maxFieldLabelLength = 0;
                    b.forEach(p, function(a) { this.maxFieldLabelLength = Math.max(this.maxFieldLabelLength, a.fieldName.length + a.label.length) }, this);
                    this.fieldSelectStyle = "width:250px;";
                    32 < this.maxFieldLabelLength && (a = Math.min(600, 250 + 7 * (this.maxFieldLabelLength - 32)), this.fieldSelectStyle = "width:" + a + "px;", b.style(this._titleFieldsSelect.domNode, "width", a + "px"), b.style(this._mediaTitleSelect.domNode, "width", a + "px"), b.style(this._mediaCaptionSelect.domNode,
                        "width", a + "px"), b.style(this._imageUrlSelect.domNode, "width", a + "px"), b.style(this._imageLinkSelect.domNode, "width", a + "px"));
                    10 < this.fieldsCount && (this.fieldSelectStyle += "height:150px;", b.style(this._titleFieldsSelect.domNode, "height", "150px"), b.style(this._mediaTitleSelect.domNode, "height", "150px"), b.style(this._mediaCaptionSelect.domNode, "height", "150px"), b.style(this._imageUrlSelect.domNode, "height", "150px"), b.style(this._imageLinkSelect.domNode, "height", "150px"));
                    this._fieldInfosStore = new n.data.AndOrWriteStore({
                        data: {
                            label: "fieldName",
                            identifier: "fieldName",
                            items: p
                        }
                    });
                    var B = { esriFieldTypeDouble: 1, esriFieldTypeSingle: 1, esriFieldTypeInteger: 1, esriFieldTypeSmallInteger: 1 };
                    this._hasNumericField = b.some(p, b.hitch(this, function(a) { return a.fieldName === this._layer.typeIdField ? !1 : a._fieldType in B ? !0 : !1 }));
                    this._hasDateField = b.some(p, b.hitch(this, function(a) { return a.fieldName === this._layer.typeIdField ? !1 : a._fieldType in B ? !0 : !1 }));
                    this._expressionInfoStore = new n.data.AndOrWriteStore({ data: { label: "title", identifier: "name", items: [] } });
                    this._expressionInfoStore.getLabel =
                        b.hitch(this, function(a) { return this._expressionInfoStore.getValue(a, "title") + " " + this._formatToken(this._expressionPrefix + this._expressionInfoStore.getValue(a, "name")) });
                    this._expressionSelect.set("value", []);
                    if (this.popupInfo.expressionInfos && this.popupInfo.expressionInfos.length) {
                        var E = 1;
                        b.forEach(this.popupInfo.expressionInfos, function(a, c) {
                            c = b.mixin(b.clone(a), { _visible: !0, _pos: c });
                            c.title && c.title.length || (c._displayTitle = this.i18n.custom + "-" + E, E++);
                            this._expressionInfoStore.newItem(c);
                            a.name.startsWith("expr") &&
                                (c = parseInt(a.name.substring(4)), isNaN(c) || (this._expressionNameCountMax = Math.max(this._expressionNameCountMax, c + 1)));
                            var d;
                            (c = b.filter(this.popupInfo.fieldInfos, function(b, c) { return b.fieldName === this._expressionPrefix + a.name ? (d = c, !0) : !1 }, this)) && c.length && (c = c[0], c = {
                                fieldName: c.fieldName,
                                label: a.title || this.i18n.Custom,
                                visible: c.visible,
                                format: c.format ? b.json.stringify(c.format) : null,
                                _pos: d,
                                _inChart: !1,
                                _hasDomain: !1,
                                _fieldType: "number" === a.returnType ? "esriFieldTypeDouble" : "esriFieldTypeString",
                                _cardinality: "",
                                _editable: !1
                            }, this._fieldInfosStore.newItem(c), this._fieldInfosStoreMax++)
                        }, this);
                        this._expressionInfoStore.save();
                        this._fieldInfosStore.save();
                        this._expressionInfoStoreMax = this.popupInfo.expressionInfos.length
                    }
                    var G = this.popupInfo.description,
                        F;
                    G && G.length ? (r = G.indexOf("}"), a = G.indexOf("{"), c = G.indexOf("{", 1), r === G.length - 1 && 0 === a && -1 === c ? (this._descriptionType.set("value", "_oneField", !1), this._fieldInfosStore.fetch({
                        query: { fieldName: G.substring(1, G.length) },
                        onComplete: b.hitch(this,
                            function(a) { a && a.length && (F = this._fieldInfosStore.getIdentity(a[0]), a = this._fieldInfosStore.getValue(a[0], "_fieldType"), "esriFieldTypeOID" === a || "esriFieldTypeGeometry" === a) && (this._descriptionType.set("value", "_customField", !1), this._customAttributeEditor.set("value", G, !0)) })
                    })) : (this._descriptionType.set("value", "_customField", !1), this._customAttributeEditor.set("value", G, !0))) : (F = this.getFirstDescriptionField(), a = m && m.length ? b.some(m, "return item.visible \x3d\x3d\x3d true") : !0, this._descriptionType.set("value",
                        a ? "_fieldAttributes" : "_none", !1));
                    if (this._relatedInfo && this._relatedInfo.length || this.popupInfo && this.popupInfo.relatedRecordsInfo) b.some(this._relatedInfo, function(a) { return (a = (a = a && a.relatedLayerUrl) && arcgisonline.map.popup._findRelatedTable(a)) && (a.selMapTable || a.tableId) }), this._showRelatedData.set("checked", this.popupInfo && this.popupInfo.relatedRecordsInfo ? this.popupInfo.relatedRecordsInfo.showRelatedRecords : !0), esri.show(this.relatedData);
                    "clustering" !== this.type && (this._showAttachments.set("checked",
                        this.popupInfo ? this.popupInfo.showAttachments : !1), this._layer.hasAttachments || (esri.hide(this._showAttachments.domNode), esri.hide(this._showAttachmentsLabel)));
                    arcgisonline.map.editTracking.hasEditTracking(this.mapLayer) ? this._showEditTracking.set("checked", this.popupInfo && !1 === this.popupInfo.showLastEditInfo ? !1 : !0) : (esri.hide(this._showEditTracking.domNode), esri.hide(this._showEditTrackingLabel));
                    this._showNoDataRecordsCheckbox && this._showNoDataRecordsCheckbox.set("checked", this.popupInfo.layerOptions &&
                        this.popupInfo.layerOptions.hasOwnProperty("showNoDataRecords") ? !this.popupInfo.layerOptions.showNoDataRecords : !1);
                    this._returnTopmostRasterCheckbox && (a = this.mapLayer.serviceInfo && this.mapLayer.serviceInfo.currentVersion ? 10.8 <= this.mapLayer.serviceInfo.currentVersion : !1, this._returnTopmostRasterCheckbox.set("checked", this.popupInfo.layerOptions && this.popupInfo.layerOptions.hasOwnProperty("returnTopmostRaster") ? this.popupInfo.layerOptions.returnTopmostRaster : a));
                    this._fieldInfosStore.getLabel = b.hitch(this,
                        "_getFieldSelectLabel");
                    this._createFieldAttributesGrid();
                    this._changeFieldsGrid.set("formatterScope", this);
                    this._changeFieldsGrid.setStore(this._fieldInfosStore, "NOT (_fieldType:'esriFieldTypeGeometry')");
                    "clustering" !== this.type && (this._singleFieldSelect.setStore(this._fieldInfosStore, F, { query: "NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry'" }), this._createMediaFieldsGrid(), this._mediaFieldsGrid.set("formatterScope", this), this._mediaFieldsGrid.setStore(this._fieldInfosStore,
                        "(_cardinality:'esriRelCardinalityOneToOne' OR _cardinality:'') AND (_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger')"), this._mediaInfoStore = new n.data.AndOrWriteStore({ data: { label: "title", items: [] } }), this._mediaInfoStore.getLabel = b.hitch(this, function(a) { return this._mediaInfoStore.getValue(a, "title") || this.i18n.untitled + " " + this._mediaInfoStore.getValue(a, "_displayTitle") }), this._mediaSelect.set("value", []), this.popupInfo.mediaInfos && this.popupInfo.mediaInfos.length && (E = 1, b.forEach(b.clone(this.popupInfo.mediaInfos), b.hitch(this, function(a, c) {
                        a = b.mixin(a, { _visible: !0, _pos: c });
                        a.title && a.title.length || (a._displayTitle = E, E++);
                        this._mediaInfoStore.newItem(a)
                    })), this._mediaInfoStore.save()));
                    this._customAttributeSelect = new g.form.MultiSelect({ style: this.fieldSelectStyle });
                    this._customAttributeEditor._started || this._customAttributeEditor.startup();
                    this._customAttributeEditor.addPlugin(new arcgisonline.map.dijit.AddFieldPlugin({
                        command: "addField",
                        select: this._customAttributeSelect,
                        store: this._fieldInfosStore
                    }));
                    this._loadFieldSelects();
                    this.popupInfo.expressionInfos && this.popupInfo.expressionInfos.length && this._loadSelect(this._expressionInfoStore, 0, !1, this._expressionSelect);
                    this.popupInfo.mediaInfos && this.popupInfo.mediaInfos.length && this._loadSelect(this._mediaInfoStore, 0, !1, this._mediaSelect);
                    this._loadConnections();
                    this._onChangePopupContent(this._descriptionType.get("value"));
                    this.adjustHeight()
                },
                _getRelatedFieldsInfo: function() {
                    var a = [],
                        c;
                    c = this._curLayer.url || this._curLayer.__url;
                    this.mapLayer.layersInfo && !this.mapLayer.layer.dynamicLayerInfos && this.mapLayer.layer.version && 10.1 <= this.mapLayer.layer.version ? c = this._curLayer.__url : this.mapLayer.queryLayersInfo && !this.mapLayer.layer.dynamicLayerInfos && this.mapLayer.layer.version && 10.1 <= this.mapLayer.layer.version && (c = this._curLayer.__url);
                    c && 0 < this._curLayer.relationships.length && (b.forEach(this._curLayer.relationships, function(a, b) {
                        a && (this._relatedInfo[a.id] || (this._relatedInfo[a.id] = { relation: a }))
                    }, this), b.forEach(this._relatedInfo, function(d, f) {
                        var e, g, m;
                        d && (e = d.relation, g = c.replace(/[0-9]+$/, e.relatedTableId), c.match(/[0-9]+$/g), m = new b.Deferred, a[f] = m, esri.request({ url: g, content: { f: "json" } }).then(b.hitch(this, function(a) {
                            var c = b.clone(a.fields);
                            b.forEach(c, function(a) {
                                a.name = this._toRelatedFieldName([f, a.name]);
                                a.alias = a.alias;
                                if ("esriRelCardinalityOneToMany" === e.cardinality || "esriRelCardinalityManyToMany" === e.cardinality) b.indexOf(["esriFieldTypeSmallInteger", "esriFieldTypeInteger",
                                    "esriFieldTypeSingle", "esriFieldTypeDouble"
                                ], a.type), a.statisticType = "count"
                            }, this);
                            d.relatedFields = c;
                            d.layerInfo = a;
                            d.relatedLayerUrl = g;
                            m.resolve(c)
                        }), b.hitch(this, function(a) { m.reject(a) })))
                    }, this));
                    return a
                },
                _fromRelatedFieldName: function(a) { var b = []; - 1 !== a.indexOf(this._relatedFieldPrefix) && (a = a.split("/"), b = a.slice(1)); return b },
                _toRelatedFieldName: function(a) {
                    var b = "";
                    a && 0 < a.length && (b = this._relatedFieldPrefix + a[0] + "/" + a[1]);
                    return b
                },
                _createFieldAttributesGrid: function() {
                    var a = [{
                            editable: !1,
                            hidden: !0,
                            field: "_pos",
                            width: "10px",
                            style: { display: "none" }
                        }, { field: "visible", name: "\x3cinput id\x3d'_changeFieldsGrid_checkAll' style\x3d'vertical-align:middle;' type\x3d'checkbox'/\x3e\x26nbsp;" + this.i18n.display, width: "120px", editable: !0, type: n.grid.cells.Bool }, { formatter: b.hitch(this, "_getIsEditableCheckbox"), hidden: !0, width: "120px", field: "isEditable", name: "\x3cinput id\x3d'_changeFieldsGrid_editAll' style\x3d'vertical-align:middle;' type\x3d'checkbox'/\x3e\x26nbsp;" + this.i18n.allowEdits }, {
                            editable: !1,
                            field: "fieldName",
                            width: "130px",
                            formatter: "_formatToken",
                            name: this.i18n.fieldName
                        }, { editable: !0, width: "150px", field: "label", name: this.i18n.fieldAlias }],
                        c = this._changeFieldsGrid = new n.grid.DataGrid({ sortInfo: 1, selectionMode: "single", singleClickEdit: !0, autoWidth: !0, "class": "_popupGrid", keepSelection: !0 }, this._changeFieldsGridDiv);
                    c.set("structure", a);
                    c.startup();
                    9 > b.isIE && b.style(this._changeFieldsDlg.domNode, { width: this._isEditable ? "760px" : "650px" });
                    b.query(".popupFormat, .format").forEach(esri.hide);
                    b.style(this._statsFieldSet, "display", "none");
                    this._isEditable && (c.layout.setColumnVisibility(2, this._isEditable), b.byId("_changeFieldsTitle").innerHTML = this.i18n.checkFieldsForEdit);
                    this._connect(c, "onSelectionChanged", b.hitch(this, function(a) { this._showIsEditable(c) }));
                    this._connect(c, "onRowClick", b.hitch(this, function(a) {
                        if ("isEditable" === a.cell.field && "INPUT" === a.target.tagName) {
                            var d = this._getFormatter(c.selection.getSelected()[0]);
                            this._fieldInfosStore.setValue(c.getItem(a.rowIndex), "isEditable",
                                a.target.checked);
                            a.target.checked ? (this._fieldInfosStore.setValue(c.getItem(a.rowIndex), "visible", a.target.checked), "formatString" !== d && "formatDomain" !== d || b.query("." + d + ",.popupFormat, .formatHint").forEach(esri.show)) : "formatString" !== d && "formatDomain" !== d || b.query("." + d + ",.popupFormat, .formatHint").forEach(esri.hide);
                            this._fieldInfosStore.save()
                        }
                    }));
                    this._connect(c, "onHeaderCellClick", b.hitch(this, function(a) {
                        "isEditable" === a.cell.field && "INPUT" === a.target.tagName ? this._fieldInfosStore.fetch({
                            onItem: b.hitch(this,
                                function(b) {
                                    var c = a.target.checked,
                                        d = this._fieldInfosStore.getValue(b, "_fieldType"),
                                        f = this._fieldInfosStore.getValue(b, "fieldName"),
                                        g = this._fieldInfosStore.getValue(b, "_editable"),
                                        n = this._fieldInfosStore.getValue(b, "_relateName"),
                                        d = (d = (d = esri.isDefined(g) && !g || "esriFieldTypeOID" === d || "esriFieldTypeGlobalID" === d || "esriFieldTypeGeometry" === d) || -1 !== this._editorTrackingFields.indexOf(f)) || esri.isDefined(n);
                                    d || (this._fieldInfosStore.setValue(b, a.cell.field, c), c && this._fieldInfosStore.setValue(b, "visible",
                                        c))
                                }),
                            onComplete: b.hitch(this, function() { this._showIsEditable(c) })
                        }) : this._onChangeFieldsGridCheckAll(this._fieldInfosStore, "{_fieldType:'*'}", null, a)
                    }));
                    this._changeFieldsGrid.canSort = b.hitch(this, function(a) { return 1 === a || -1 === a });
                    this._connect(this._formatDateSelect, "onChange", b.hitch(this, "_setFormatter", "dateFormat"));
                    this._connect(this._formatTimeSelect, "onChange", b.hitch(this, "_setFormatter", "dateFormat", null));
                    this._connect(this._formatNumberSelect, "onChange", b.hitch(this, "_setFormatter",
                        "places"));
                    this._connect(this._formatNumberCheck, "onChange", b.hitch(this, "_setFormatter", "digitSeparator"));
                    this._connect(this._formatStringSelect, "onChange", b.hitch(this, "_setAttribute", "stringFieldOption"));
                    this._connect(this._formatTooltip, "onChange", b.hitch(this, "_setAttribute", "tooltip"));
                    this._connect(this._statsTypeSelect, "onChange", b.hitch(this, "_setAttribute", "statisticType"));
                    this._connect(this._attributeTypeSelect, "onChange", b.hitch(this, "_setReturnType"));
                    this._connect(this._formatTimeCheck,
                        "onChange", b.hitch(this, function() {
                            var a = this._formatTimeCheck.get("checked");
                            b[a ? "removeClass" : "addClass"](this._formatTimeSelect.domNode, "hide");
                            this._setFormatter("dateFormat")
                        }))
                },
                _createMediaFieldsGrid: function() {
                    var a = [{ editable: !1, hidden: !0, field: "_pos", width: "0px", style: { display: "none" } }, { field: "_item", formatter: "_getInChartCheckbox", name: "\x3cinput id\x3d'_mediaFieldsGrid_checkAll' type\x3d'checkbox' /\x3e", width: "22px", editable: !1 }, { editable: !0, width: "185px", field: "label", name: this.i18n.fieldAlias },
                        { editable: !1, field: "fieldName", width: "120px", formatter: "_formatToken", name: this.i18n.fieldName }
                    ];
                    this._mediaFieldsGrid = new n.grid.DataGrid({ sortInfo: 1, selectionMode: "none", singleClickEdit: !0, "class": "_popupGrid", style: "height:175px;width:378px;" }, this._mediaFieldsGridDiv);
                    this._mediaFieldsGrid.set("structure", a);
                    this._mediaFieldsGrid.startup();
                    this._connect(this._mediaFieldsGrid, "onHeaderCellClick", b.hitch(this, "_onChangeFieldsGridCheckAll", this._fieldInfosStore, "_fieldType:'esriFieldTypeDouble' OR _fieldType:'esriFieldTypeSingle' OR _fieldType:'esriFieldTypeInteger' OR _fieldType:'esriFieldTypeSmallInteger'",
                        "_inChart"));
                    this._mediaFieldsGrid.canSort = b.hitch(this, function(a) { return 2 !== a && -2 !== a })
                },
                _showIsEditable: function(a) {
                    var c = a.selection.getSelected()[0],
                        d = !1,
                        f;
                    c && (f = this._getFormatter(a.selection.getSelected()[0]), b.query(".popupFormat, .format").forEach(esri.hide), f && (d = this._isEditable && this._fieldInfosStore.getValue(a.selection.getSelected()[0], "isEditable"), "formatString" === f || "formatDomain" === f ? d && (b.query("." + f + ",.popupFormat, .formatHint").forEach(esri.show), b.attr(this._legendTitle, "innerHTML",
                        this.i18n.editing)) : (b.query("." + f + ",.popupFormat").forEach(esri.show), b.attr(this._legendTitle, "innerHTML", this.i18n.formatFields), d && b.query(".formatHint").forEach(esri.show))), a = this._fieldInfosStore.getValue(c, "_cardinality"), "esriRelCardinalityOneToMany" === a || "esriRelCardinalityManyToMany" === a ? (b.style(this._statsFieldSet, "display", "block"), c._fieldType && 0 < c._fieldType.length && c._fieldType[0] && (a = -1 !== b.indexOf(["esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"],
                        c._fieldType[0]), this._updateStatsSelect(a)), c.statisticType && this._statsTypeSelect.set("value", c.statisticType)) : b.style(this._statsFieldSet, "display", "none"), b.style(this._attributeTypeSet, "display", "none"), this._fieldInfosStore.getValue(c, "fieldName").startsWith(this._expressionPrefix) && b.style(this._attributeTypeSet, "display", "block"))
                },
                _setFormatter: function(a, c) {
                    var d = this._changeFieldsGrid.selection.getSelected()[0],
                        f = b.json.parse(this._fieldInfosStore.getValue(d, "format"));
                    b.query(".formatTime").addClass("hide");
                    if ("dateFormat" === a) {
                        c = c || this._formatDateSelect.get("value");
                        var e = c in this._supportsTime,
                            g = e && this._formatTimeCheck.get("checked") ? this._formatTimeSelect.get("value") : "";
                        b.query(".formatTime").removeClass("hide");
                        this._enableUpdateTime(e);
                        f[a] = c + g
                    } else f[a] = "places" === a ? parseInt(c) : c;
                    this._onFormatChange(d, "format", b.json.stringify(f))
                },
                _setAttribute: function(a, b) {
                    var c = this._changeFieldsGrid.selection.getSelected()[0];
                    this._onFormatChange(c, a, b)
                },
                _setReturnType: function(a) {
                    var c = this._changeFieldsGrid.selection.getSelected()[0],
                        d = this._fieldInfosStore.getValue(c, "fieldName");
                    this._getItemFromStore(this._expressionInfoStore, d.substring(this._expressionPrefix.length), b.hitch(this, function(d) { d && (this._expressionInfoStore.setValue(d, "returnType", a), this._fieldInfosStore.setValue(c, "format", "number" === a ? this._numberFormats[2].value : null), this._fieldInfosStore.setValue(c, "_fieldType", "number" === a ? "esriFieldTypeDouble" : "esriFieldTypeString"), "number" === a ? b.query(".formatNumber, .popupFormat").forEach(esri.show) : b.query(".popupFormat, .format").forEach(esri.hide)) }))
                },
                _loadFieldSelects: function() {
                    this._loadSelect(this._fieldInfosStore, null, !1, this._attributesSelect);
                    b.forEach([this._imageLinkSelect, this._mediaCaptionSelect, this._imageUrlSelect, this._titleFieldsSelect, this._customAttributeSelect, this._mediaTitleSelect], b.hitch(this, "_loadSelect", this._fieldInfosStore, null, !0), this)
                },
                _getFieldSelectLabel: function(a) {
                    var b = arcgisonline.sharing.util.htmlEncode(this._fieldInfosStore.getValue(a, "label")) + " " + this._formatToken(this._fieldInfosStore.getValue(a, "fieldName"));
                    this._fieldInfosStore.getValue(a, "_relateName") && (b += " (" + this._fieldInfosStore.getValue(a, "_relateName") + ")");
                    return b
                },
                _loadSelect: function(a, c, d, f) {
                    f && a && (this._resetSelect(f), a.fetch({
                        sort: [{ attribute: "_pos", descending: !1 }],
                        onItem: b.hitch(this, function(c) {
                            var e = a.getValue(c, "visible") || a.getValue(c, "_visible"),
                                g = "esriFieldTypeGeometry" === a.getValue(c, "_fieldType");
                            a.getValue(c, "_relateName");
                            var n = a.getValue(c, "visible"),
                                r = a.getValue(c, "_cardinality");
                            g || !d && !0 !== e || !(!r || r && "esriRelCardinalityOneToOne" ===
                                r || r && ("esriRelCardinalityOneToMany" === r || "esriRelCardinalityManyToMany" === r) && !0 === n) || (e = b.create("option"), e.innerHTML = a.getLabel(c), e.value = a.getIdentity(c), b.place(e, f.containerNode))
                        }),
                        onComplete: b.hitch(this, function(a) { esri.isDefined(c) && f.set("value", [c]) })
                    }))
                },
                _loadConnections: function() {
                    this._connect(g.byId("leftContentPanel"), "resize", b.hitch(this, "adjustHeight"));
                    this._connect(this._customFieldBtn, "onClick", b.hitch(this, "_customFieldsDlgShow"));
                    this._connect(this._attributesSelectUp,
                        "onClick", b.hitch(this, "_onMoveSelectItem", this._fieldInfosStore, this._attributesSelect, -1, null));
                    this._connect(this._attributesSelectDown, "onClick", b.hitch(this, "_onMoveSelectItem", this._fieldInfosStore, this._attributesSelect, 1, null));
                    this._connect(this._fieldsSelectUp, "onClick", b.hitch(this, "_onMoveGridItem", this._fieldInfosStore, this._changeFieldsGrid, -1, null));
                    this._connect(this._fieldsSelectDown, "onClick", b.hitch(this, "_onMoveGridItem", this._fieldInfosStore, this._changeFieldsGrid, 1, null));
                    this._connect(this._mediaSelectUp,
                        "onClick", b.hitch(this, "_onMoveSelectItem", this._mediaInfoStore, this._mediaSelect, -1, null));
                    this._connect(this._mediaSelectDown, "onClick", b.hitch(this, "_onMoveSelectItem", this._mediaInfoStore, this._mediaSelect, 1, null));
                    this._connect(this._titleFieldsSelect, "onChange", b.hitch(this, "_onTitleSelectChange", this._title, this._titleFieldsSelect));
                    this._connect(this._imageUrlSelect, "onChange", b.hitch(this, "_onTitleSelectChange", this._imageUrl, this._imageUrlSelect));
                    this._connect(this._mediaCaptionSelect,
                        "onChange", b.hitch(this, "_onTitleSelectChange", this._mediaCaption, this._mediaCaptionSelect));
                    this._connect(this._imageLinkSelect, "onChange", b.hitch(this, "_onTitleSelectChange", this._imageLink, this._imageLinkSelect));
                    this._connect(this._expressionSelect, "onDblClick", b.hitch(this, "_onShowExpression"));
                    this._connect(this._expressionProperties, "onClick", b.hitch(this, "_onShowExpression"));
                    this._connect(this._expressionDelete, "onClick", b.hitch(this, "_onDeleteExpression"));
                    this._connect(this._addMediaImage,
                        "onClick", b.hitch(this, "_onAddMedia", { title: this.i18n.image, type: "image", caption: "", value: { sourceURL: null, linkURL: null }, refreshInterval: 0 }));
                    this._connect(this._addMediaPieChart, "onClick", b.hitch(this, "_onAddMedia", { title: this.i18n.pieChart, type: "piechart", caption: "", value: { fields: [] } }));
                    this._connect(this._addMediaBarChart, "onClick", b.hitch(this, "_onAddMedia", { title: this.i18n.barChart, type: "barchart", caption: "", value: { fields: [] } }));
                    this._connect(this._addMediaColumnChart, "onClick", b.hitch(this, "_onAddMedia", { title: this.i18n.columnChart, type: "columnchart", caption: "", value: { fields: [] } }));
                    this._connect(this._addMediaLineChart, "onClick", b.hitch(this, "_onAddMedia", { title: this.i18n.lineChart, type: "linechart", caption: "", value: { fields: [] } }));
                    this._connect(this._mediaDelete, "onClick", b.hitch(this, "_onDeleteMedia"));
                    this._connect(this._mediaProperties, "onClick", b.hitch(this, "_onShowMediaSettingsDlg"));
                    this._connect(this._mediaConfigDlg, "execute", b.hitch(this, "_onSaveMediaConfig"));
                    this._connect(this._mediaTitleSelect,
                        "onChange", b.hitch(this, "_onTitleSelectChange", this._mediaTitle, this._mediaTitleSelect));
                    this._connect(this._mediaSelect, "onDblClick", b.hitch(this, "_onShowMediaSettingsDlg"));
                    this._connect(this._savePopup, "onClick", b.hitch(this, "_onClose", !0));
                    this._connect(this._closeBtn, "onclick", b.hitch(this, "_onClose", !1));
                    this._connect(this._cancelPopup, "onClick", b.hitch(this, "_onClose", !1));
                    this._connect(this._sortOptionsBtn, "onClick", b.hitch(this, "_onShowSortOptions"))
                },
                _connect: function(a, c, d) {
                    this._pbConnects.push(b.connect(a,
                        c, d))
                },
                _resetSelect: function(a) { for (a = a.containerNode || a; a.hasChildNodes();) a.removeChild(a.lastChild) },
                _formatToken: function(a) { return a && a.length ? "{" + a + "}" : "" },
                _getItemFromStore: function(a, b, d) { a.fetchItemByIdentity({ identity: b, onItem: d }) },
                _getFormatter: function(a) {
                    if (!a) return "";
                    var c = { esriFieldTypeInteger: 1, esriFieldTypeSmallInteger: 1 },
                        d = { esriFieldTypeSingle: 1, esriFieldTypeDouble: 1 },
                        f = this._fieldInfosStore.getValue(a, "_fieldType");
                    b.query(".formatTime").addClass("hide");
                    if ("esriFieldTypeDate" ===
                        f && this.mapLayer && this.mapLayer.layer && this.mapLayer.layer.url && 10 > this.mapLayer.layer.version) return "";
                    var e = this._fieldInfosStore.getValue(a, "fieldName");
                    e.startsWith(this._expressionPrefix) && (e = e.substring(this._expressionPrefix.length), this._getItemFromStore(this._expressionInfoStore, e, b.hitch(this, function(a) { a && (a = this._expressionInfoStore.getValue(a, "returnType"), this._attributeTypeSelect.set("value", a)) })));
                    this._formatTooltip.set("value", this._fieldInfosStore.getValue(a, "tooltip"), !1);
                    if (this._fieldInfosStore.getValue(a,
                            "_hasDomain")) return "formatDomain";
                    if ("esriFieldTypeString" === f) return this._formatStringSelect.set("value", this._fieldInfosStore.getValue(a, "stringFieldOption"), !1), "formatString";
                    a = this._fieldInfosStore.getValue(a, "format");
                    var g;
                    a && (g = b.json.parse(a));
                    return g && (f in d || f in c) ? (f in d && this._formatNumberSelect.set("value", g.places, !1), this._formatNumberCheck.set("value", g.digitSeparator, !1), f in d ? "formatNumber" : "formatInteger") : g && "esriFieldTypeDate" === f ? (b.query(".formatTime").removeClass("hide"),
                        "string" === typeof g.dateFormat && (-1 < g.dateFormat.indexOf("LETime") || -1 < g.dateFormat.indexOf("LEShortTime") || -1 < g.dateFormat.indexOf("LELongTime")) ? (this._formatDateSelect.set("value", "shortDateLE", !1), this._formatTimeCheck.set("checked", !0), this._formatTimeSelect.set("value", g.dateFormat.split("shortDateLE")[1], !1), this._enableUpdateTime(!0)) : "string" === typeof g.dateFormat && -1 < g.dateFormat.indexOf("Time") ? (this._formatDateSelect.set("value", "shortDate", !1), this._formatTimeCheck.set("checked", !0),
                            this._formatTimeSelect.set("value", g.dateFormat.split("shortDate")[1], !1), this._enableUpdateTime(!0)) : (this._formatDateSelect.set("value", g.dateFormat, !1), this._enableUpdateTime(g.dateFormat in this._supportsTime)), "formatDate") : ""
                },
                _enableUpdateTime: function(a) {
                    this._formatTimeCheck.get("checked");
                    this._formatTimeCheck.set("disabled", !a);
                    b[a ? "removeClass" : "addClass"](this.timeCheckboxLbl, "disabled");
                    a || this._formatTimeCheck.set("checked", !1)
                },
                _getIsEditableCheckbox: function(a, b, d) {
                    var c = this._changeFieldsGrid.getItem(b);
                    d = this._fieldInfosStore.getValue(c, "_fieldType");
                    a = this._fieldInfosStore.getValue(c, "isEditable");
                    var e = this._fieldInfosStore.getValue(c, "_isEditableOnLayer"),
                        g = this._fieldInfosStore.getValue(c, "_editable");
                    b = this._fieldInfosStore.getValue(c, "fieldName");
                    c = this._fieldInfosStore.getValue(c, "_relateName");
                    d = (d = !1 === e || esri.isDefined(g) && !g || "esriFieldTypeOID" === d || "esriFieldTypeGlobalID" === d || "esriFieldTypeGeometry" === d || esri.isDefined(c)) || -1 !== this._editorTrackingFields.indexOf(b) || (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) ||
                        this.mapLayer.layer instanceof esri.layers.CSVLayer) && "fid" === b.toLowerCase();
                    return '\x3cinput class\x3d"dojoxGridInput" type\x3d"checkbox"' + (a ? ' checked\x3d"checked" ' : "") + (d ? 'disabled\x3d"true" ' : "") + 'style\x3d"width: auto" /\x3e'
                },
                _getIsVisibleCheckbox: function(a, b, d) { return this._getCheckbox(a, b, d, "visible", !1, !0) },
                _getInChartCheckbox: function(a, b, d) { d.customClasses.push("popupGridCenterCell"); return this._getCheckbox(a, b, d, "_inChart", !1, !1) },
                _getCheckbox: function(a, c, d, f, e, h) {
                    c = this._fieldInfosStore.getValue(a,
                        f);
                    h = esri.isDefined(c) ? c : h;
                    e = new g.form.CheckBox({ name: "checkBox", checked: h, disabled: e });
                    this._connect(e, "onChange", b.hitch(this, "_onFormatChange", a, f));
                    return e
                },
                _getRichTextSelect: function(a, c, d) {
                    if ("esriFieldTypeString" !== this._fieldInfosStore.getValue(a, "_fieldType")) return "";
                    c = this._fieldInfosStore.getValue(a, "stringFieldOption");
                    var f = this._fieldInfosStore.getValue(a, "_stringFieldSelect");
                    f || (f = new g.form.Select({ style: { width: "110px" } }), this._changeFieldsGrid.store.setValue(a, "_stringFieldSelect",
                        f), this._changeFieldsGrid.store.save(), this._connect(f, "onChange", b.hitch(this, "_onFormatChange", a, "stringFieldOption")));
                    f.options = [];
                    f.options.push({ label: this.i18n.singleLine, value: "textbox" });
                    f.options.push({ label: this.i18n.multipleLine, value: "textarea" });
                    f.options.push({ label: this.i18n.richText, value: "richtext" });
                    f.set("value", c || "textbox", !0);
                    d.customClasses.push("popupGridCenterCell");
                    return f
                },
                _customFieldsDlgShow: function() {
                    this.customFieldsDlgOldValue = this._customAttributeEditor.get("value");
                    g.byId("_customFieldDlg").show()
                },
                _customFieldsDlgOk: function() { esriGeowConfig.self && !esriGeowConfig.self.isPortal && -1 < this._customAttributeEditor.get("value").indexOf("http://") && arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.notice, message: '\x3cdiv class\x3d"input-error-inline-message"\x3e' + this.i18n.httpWarning + "\x3c/div\x3e" }) },
                _customFieldsDlgCancel: function() {
                    g.byId("_customFieldDlg").hide();
                    this._customAttributeEditor.set("value", this.customFieldsDlgOldValue, !0)
                },
                getChildren: function() { return this.containerNode ? this.myDijitFindWidgets(this.containerNode) : [] },
                myDijitFindWidgets: function(a) {
                    function c(a) {
                        if (9 > b.isIE && a.children || a.childNodes) {
                            a = 9 > b.isIE ? a.children : a.childNodes;
                            for (var e = 0, f; f = a[e++];)
                                if (1 === f.nodeType) {
                                    var m = f.getAttribute("widgetId");
                                    m ? (f = g.byId(m), d.push(f)) : c(f)
                                }
                        }
                    }
                    var d = [];
                    c(a);
                    return d
                },
                loadContent: function() { setTimeout(function() { g.byId("popupPanel").adjustHeight() }, 100) },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel &&
                        "popupStack" == leftPanel.visibleStack) {
                        g.byId("popupBuilderContentBottom").resize();
                        a = b.coords(b.byId("leftPanelDiv")).h;
                        var c = b.coords(b.byId("popupBuilderContentHeader")).h,
                            d = b.coords(b.byId("popupBuilderSiteFooter_links")).h + 9,
                            f = b.coords(b.byId("popupBuilderContentButtonsCenter")).h;
                        b.style(b.byId("popupBuilderContentFooter"), "height", d + "px");
                        b.style(b.byId("popupBuilderContentButtons"), "height", f + "px");
                        b.style(b.byId("popupBuilderContentBottom"), "height", f + d + 16 + "px");
                        b.style(b.byId("popupBuilderContentPane"),
                            "height", a - (c + d + f + 32) + "px");
                        a = b.coords(b.byId("leftContentStackContainer")).w - 8;
                        0 < a && (b.style(this._attributesSelect.domNode, "width", a - 50 + "px"), b.style(this._expressionSelect.domNode, "width", a - 50 + "px"), b.style(this._mediaSelect.domNode, "width", a - 50 + "px"), b.style(this._title.domNode, "width", a - 70 + "px"))
                    }
                },
                getDisplayField: function() {
                    var a = this._layer.displayField ? this._layer.displayField.trim() : null;
                    if (!a && this._layer.fields && (a = this.getFirstNameOrTitleField(), !a && (a = this.getFirstUniqueIdentifierField(), !a && (a = this.getFirstTypeOrCategoryField(), !a))))
                        for (var b = 0; b < this._layer.fields.length; b++) { var d = this._layer.fields[b]; if (-1 < d.name.toLowerCase().indexOf("name") || -1 < d.name.toLowerCase().indexOf("title")) a = d.name }
                    return a
                },
                getFirstNameOrTitleField: function() {
                    if (this._layer.fields)
                        for (var a = 0; a < this._layer.fields.length; a++) { var c = this._layer.fields[a]; if (c.description) { var d = b.json.parse(c.description); if (d && "nameOrTitle" === d.fieldValueType) return c.name } }
                    return null
                },
                getFirstUniqueIdentifierField: function() {
                    if (this._layer.fields)
                        for (var a =
                                0; a < this._layer.fields.length; a++) { var c = this._layer.fields[a]; if (c.description) { var d = b.json.parse(c.description); if (d && "uniqueIdentifier" === d.fieldValueType) return c.name } }
                    return null
                },
                getFirstTypeOrCategoryField: function() {
                    if (this._layer.fields)
                        for (var a = 0; a < this._layer.fields.length; a++) { var c = this._layer.fields[a]; if (c.description) { var d = b.json.parse(c.description); if (d && "typeOrCategory" === d.fieldValueType) return c.name } }
                    return null
                },
                getFirstDescriptionField: function() {
                    if (this._layer.fields)
                        for (var a =
                                0; a < this._layer.fields.length; a++) { var c = this._layer.fields[a]; if (c.description) { var d = b.json.parse(c.description); if (d && "description" === d.fieldValueType) return c.name } }
                    return null
                },
                _updateStatsSelect: function(a) {
                    this._statsTypeSelect.removeOption(this._statsTypeSelect.getOptions());
                    a ? this._statsTypeSelect.addOption([{ value: "count", label: this.i18n.count }, { value: "sum", label: this.i18n.sum }, { value: "min", label: this.i18n.min }, { value: "max", label: this.i18n.max }, { value: "avg", label: this.i18n.avg }, {
                        value: "stddev",
                        label: this.i18n.stddev
                    }]) : this._statsTypeSelect.addOption({ value: "count", label: this.i18n.count })
                },
                _handleRefreshTimeChange: function(a) { 0 === a ? this._refreshCheck.set("checked", !1) : this._refreshCheck.set("checked", !0) },
                _handleSameFieldBtnChange: function(a) {
                    a ? (esri.show(this._mediaFieldsDiv), this._mediaFieldsGrid.resize(), esri.hide(this._mediaRelatedFieldsDiv)) : (esri.show(this._mediaRelatedFieldsDiv), esri.hide(this._mediaFieldsDiv));
                    this._relatedChartFieldInput.get("value") && (this._updateRelatedChartField(this._relatedChartFieldInput.get("value"),
                        this._relatedFieldsBtn.get("checked")), this._relatedChartCurrentField = this._relatedChartFieldInput.get("value"))
                },
                _handleRelatedLayerInputChange: function(a) {
                    this._relatedInfo && this._relatedInfo[a] && (this._relatedChartFieldInput.setStore(this._fieldInfosStore, null, { query: "(_relatedId:'" + a + "') AND (_cardinality:'esriRelCardinalityOneToMany' OR _cardinality:'esriRelCardinalityManyToMany') AND (NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry')" }), this._mediaTooltipSelect.setStore(this._fieldInfosStore,
                        null, { query: "(_relatedId:'" + a + "') AND (_cardinality:'esriRelCardinalityOneToMany' OR _cardinality:'esriRelCardinalityManyToMany') AND (NOT _fieldType:'esriFieldTypeOID' AND NOT _fieldType:'esriFieldTypeGeometry')" }))
                },
                _updateRelatedChartField: function(a, c) { this._getItemFromStore(this._fieldInfosStore, a, b.hitch(this, function(a) { a && this._onFormatChange(a, "_inChart", c) })) },
                _handleRelatedChartValueChange: function(a) {
                    this._relatedChartCurrentField && this._updateRelatedChartField(this._relatedChartCurrentField, !1);
                    this._updateRelatedChartField(a, !0);
                    this._relatedChartCurrentField = a
                },
                _isImageServiceLayer: function(a) { return a instanceof esri.layers.ArcGISImageServiceLayer || a instanceof esri.layers.ArcGISImageServiceVectorLayer || a instanceof esri.layers.RasterXLayer },
                getMaxPos: function(a) { a.fetch({ sort: [{ attribute: "_pos", descending: !1 }], onItem: b.hitch(this, function(b) { a.getValue(b, "_pos") }) }) }
            });
            b.mixin(arcgisonline.map.dijit.PopupBuilder, {
                MEDIA_TYPE_IMAGE: "image",
                MEDIA_TYPE_PIE_CHART: "piechart",
                MEDIA_TYPE_BAR_CHART: "barchart",
                MEDIA_TYPE_COLUMN_CHART: "columnchart",
                MEDIA_TYPE_LINE_CHART: "linechart"
            })
        })
}, "arcgisonline/sharing/dijit/LayerAttributesGrid": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Dialog,dijit/TooltipDialog,dojox/grid/DataGrid"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.LayerAttributesGrid");
        b.require("dijit._Widget");
        b.require("dojox.rpc.Service");
        b.require("dojo.rpc.JsonService");
        b.require("dijit.Dialog");
        b.require("dijit.TooltipDialog");
        b.require("dojox.grid.DataGrid");
        b.declare("arcgisonline.sharing.dijit.LayerAttributesGrid", [g._Widget], {
            id: "",
            grid: null,
            ts: null,
            gridId: "layerAttributesNode",
            executeQueryOnStartup: !1,
            gridScrollBox: null,
            constructor: function(a, b) {},
            postCreate: function() { this.createGrid() },
            fillGrid: function(a) { this.getAttributes(a) },
            createGrid: function() {
                this.grid = new n.grid.DataGrid({
                    structure: [
                        [{
                            get: arcgisonline.sharing.dijit.LayerAttributesGrid.formatters.selectItem,
                            formatter: arcgisonline.sharing.util.fix,
                            name: "\x3cinput type\x3d'checkbox' id\x3d'selected' name\x3d'selected' onclick\x3d'arcgisonline.sharing.dijit.LayerAttributesGrid.util.check(this);' style\x3d'border:none; padding:0px; margin:0px;' /\x3e",
                            width: "15px"
                        }, { field: "alias", get: arcgisonline.sharing.dijit.LayerAttributesGrid.formatters.name, formatter: arcgisonline.sharing.util.fix, name: "Field", width: "auto" }, { get: arcgisonline.sharing.dijit.LayerAttributesGrid.formatters.value, formatter: arcgisonline.sharing.util.fix, name: "Display As", width: "auto" }, { get: arcgisonline.sharing.dijit.LayerAttributesGrid.formatters.blank, formatter: arcgisonline.sharing.util.fix, width: "10px" }]
                    ],
                    rowsPerPage: 10,
                    noDataMessage: "\x3cspan style\x3d'font-size:1em;color:#7a7979;'\x3eClick Go to start a search.\x3c/span\x3e",
                    loadingMessage: "\x3cspan style\x3d'font-size:1em;color:#7a7979;'\x3eSearching...Please wait...\x3c/span\x3e",
                    region: "center",
                    id: this.gridId,
                    selectionMode: "none",
                    style: "width:200px",
                    clientSort: !1,
                    canSort: arcgisonline.sharing.dijit.LayerAttributesGrid.util.noSort
                });
                container.addChild(this.grid);
                this.grid.startup()
            },
            buildStore: function(a) {
                var c = [],
                    d = "objectid;shape;shape_length;shape_area;perimeter;stretched value;fnode_;tnode_;lpoly_;rpoly_;poly_;subclass;subclass;rings_ok;rings_nok".split(";");
                b.forEach(a,
                    function(a, b) { arcgisonline.map.main.contains(d, a.name.toLowerCase()) || c.push({ name: a.name, alias: a.alias, type: a.type, selected: !1 }) }, this);
                return new b.data.ItemFileReadStore({ data: { identifier: "name", label: "alias", items: c } })
            },
            getAttributes: function(a) {
                this.emptyStore();
                this.url = a;
                var c = this.grid,
                    d = !1,
                    f = !1;
                setTimeout(function() { f || (d = !0, c.showMessage("\x3cspan style\x3d'font-size:1em;color:#7a7979;'\x3eNo attributes found.\x3c/span\x3e")) }, 1E4);
                this.grid.showMessage("\x3cspan style\x3d'font-size:1em;color:#7a7979;'\x3eLoading...Please wait...\x3c/span\x3e");
                this.getJson(a, b.hitch(this, function(a, b) {
                    f = !0;
                    d || (a = this.buildStore(a.fields), this.grid.setStore(a), this.grid.setSortIndex(1, !0))
                }), b.hitch(this, function(a, b) {
                    f = !0;
                    d || this.grid.showMessage("\x3cspan style\x3d'font-size:1em;color:#7a7979;'\x3eNo attributes found.\x3c/span\x3e")
                }))
            },
            emptyStore: function() {
                this.servicesItems = [];
                this.lastResultCount = -1;
                var a = new b.data.ItemFileReadStore({ data: { identifier: "name", label: "item", items: this.servicesItems } });
                this.grid.setStore(a)
            },
            getJson: function(a, c, d) {
                a =
                    0 <= a.indexOf("?") ? a + "\x26f\x3djson" : a + "?f\x3djson";
                b.io.script.get({ url: a, callbackParamName: "callback", load: function(b, e) { arcgisonline.sharing.util.handler(b, e, a, c, d) }, error: function(b, c) { arcgisonline.sharing.util.errorHandler(b, c, a, d) } })
            }
        });
        arcgisonline.sharing.dijit.LayerAttributesGrid.formatters = {
            selectItem: function(a, b) {
                return b ? '\x3cinput type\x3d"checkbox" id\x3d"chk_' + b.name + '" onclick\x3d"arcgisonline.sharing.dijit.LayerAttributesGrid.util.checkItem(\'' + b.name + "');\" " + (!0 === b.selected ? "checked" :
                    "") + ' style\x3d"width:auto;" class\x3d"dojoxGridInput" /\x3e' : this.defaultValue
            },
            name: function(a, b) { return b ? b.alias : this.defaultValue },
            value: function(a, b) {
                if (!b) return this.defaultValue;
                a = "";
                switch (b.type[0]) {
                    case "esriFieldTypeInteger":
                        a = "1234";
                        break;
                    case "esriFieldTypeString":
                        a = "abc";
                        break;
                    case "esriFieldTypeDouble":
                        a = "12.34";
                        break;
                    case "esriFieldTypeDate":
                        a = "12/01/10";
                        break;
                    default:
                        a = ""
                }
                return a
            },
            blank: function(a, b) { return "" }
        };
        arcgisonline.sharing.dijit.LayerAttributesGrid.util = {
            check: function(a) {
                var c =
                    g.byId("layerAttributesNode");
                b.forEach(c.store._arrayOfAllItems, function(c) {
                    c.selected = a.checked;
                    b.byId("chk_" + c.name) && (b.byId("chk_" + c.name).checked = a.checked)
                });
                c.store.save()
            },
            checkItem: function(a) {
                var c = g.byId("layerAttributesNode");
                b.forEach(c.store._arrayOfAllItems, function(b) { b.name == a && (1 == b.selected.length ? b.selected[0] = b.selected[0] ? !1 : !0 : b.selected = b.selected ? !1 : !0) });
                this.checkAllCheckbox()
            },
            checkAllCheckbox: function() {
                var a = !0,
                    c = g.byId("layerAttributesNode");
                b.forEach(c.store._arrayOfAllItems,
                    function(b) { 1 == b.selected.length ? b.selected[0] || (a = !1) : b.selected || (a = !1) });
                b.byId("selected").checked = a
            },
            noSort: function(a) { return 2 == a ? !0 : !1 }
        }
    })
}, "arcgisonline/map/dijit/DropDownButton": function() {
    define(["dojo", "dijit", "dojox"], function(b, g, n) {
        b.provide("arcgisonline.map.dijit.DropDownButton");
        b.declare("arcgisonline.map.dijit.DropDownButton", [g.form.DropDownButton], {
            iconClass: "popupButton popupAddFieldIcon",
            "class": "popupDropDownButton",
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").popupBuilder);
                this.label = this.label || this.i18n.addFieldName
            }
        })
    })
}, "dojox/data/AndOrWriteStore": function() { define(["dojo/_base/declare", "dojo/data/ItemFileWriteStore", "./AndOrReadStore"], function(b, g, n) { return b("dojox.data.AndOrWriteStore", [g, n], {}) }) }, "dojox/data/AndOrReadStore": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/data/ItemFileReadStore dojo/data/util/filter dojo/_base/array dojo/_base/json".split(" "),
        function(b, g, n, a, c, d) {
            return b("dojox.data.AndOrReadStore", [n], {
                _containsValue: function(a, b, d, m) { return c.some(this.getValues(a, b), function(a) { if (g.isString(m)) return eval(m); if (null !== a && !g.isObject(a) && m) { if (a.toString().match(m)) return !0 } else return d === a ? !0 : !1 }) },
                filter: function(b, c, h) {
                    var e = [];
                    if (b.query) {
                        var f = d.fromJson(d.toJson(b.query));
                        if ("object" == typeof f) {
                            var n = 0,
                                v;
                            for (v in f) n++;
                            if (1 < n && f.complexQuery) {
                                var n = f.complexQuery,
                                    w = !1;
                                for (v in f)
                                    if ("complexQuery" !== v) {
                                        w || (n = "( " + n + " )", w = !0);
                                        var t = b.query[v];
                                        g.isString(t) && (t = "'" + t + "'");
                                        n += " AND " + v + ":" + t;
                                        delete f[v]
                                    }
                                f.complexQuery = n
                            }
                        }
                        v = b.queryOptions ? b.queryOptions.ignoreCase : !1;
                        "string" != typeof f && (f = d.toJson(f), f = f.replace(/\\\\/g, "\\"));
                        var f = f.replace(/\\"/g, '"'),
                            n = g.trim(f.replace(/{|}/g, "")),
                            x;
                        if (n.match(/"? *complexQuery *"?:/)) {
                            for (var n = g.trim(n.replace(/"?\s*complexQuery\s*"?:/, "")), w = ["'", '"'], B, E = !1, f = 0; f < w.length; f++)
                                if (t = n.indexOf(w[f]), x = n.indexOf(w[f], 1), B = n.indexOf(":", 1), 0 === t && -1 != x && B < x) { E = !0; break }
                            E && (n = n.replace(/^\"|^\'|\"$|\'$/g,
                                ""))
                        }
                        w = n;
                        t = /^>=|^<=|^<|^>|^,|^NOT |^AND |^OR |^\(|^\)|^!|^&&|^\|\|/i;
                        x = B = "";
                        var G = -1,
                            E = !1,
                            F = "",
                            D = "";
                        x = "";
                        x = -1;
                        for (f = 0; f < c.length; ++f) {
                            var A = !0,
                                H = c[f];
                            if (null === H) A = !1;
                            else {
                                n = w;
                                for (B = ""; 0 < n.length && !E;) {
                                    for (x = n.match(t); x && !E;) n = g.trim(n.replace(x[0], "")), x = g.trim(x[0]).toUpperCase(), x = "NOT" == x ? "!" : "AND" == x || "," == x ? "\x26\x26" : "OR" == x ? "||" : x, x = " " + x + " ", B += x, x = n.match(t);
                                    if (0 < n.length)
                                        if (A = (x = n.match(/:|>=|<=|>|</g)) && x.shift(), G = n.indexOf(A), -1 == G) { E = !0; break } else {
                                            F = g.trim(n.substring(0, G).replace(/\"|\'/g,
                                                ""));
                                            n = g.trim(n.substring(G + A.length));
                                            if (x = n.match(/^\'|^\"/)) {
                                                x = x[0];
                                                G = n.indexOf(x);
                                                x = n.indexOf(x, G + 1);
                                                if (-1 == x) { E = !0; break }
                                                D = n.substring(G + A.length, x);
                                                n = x == n.length - 1 ? "" : g.trim(n.substring(x + 1))
                                            } else if (x = n.match(/\s|\)|,/)) {
                                                for (var D = Array(x.length), J = 0; J < x.length; J++) D[J] = n.indexOf(x[J]);
                                                G = D[0];
                                                if (1 < D.length)
                                                    for (J = 1; J < D.length; J++) G = Math.min(G, D[J]);
                                                D = g.trim(n.substring(0, G));
                                                n = g.trim(n.substring(G))
                                            } else D = g.trim(n), n = "";
                                            x = ":" != A ? this.getValue(H, F) + A + D : a.patternToRegExp(D, v);
                                            B += this._containsValue(H,
                                                F, D, x)
                                        }
                                }
                                A = eval(B)
                            }
                            A && e.push(H)
                        }
                        E && (e = [])
                    } else
                        for (f = 0; f < c.length; ++f) v = c[f], null !== v && e.push(v);
                    h(e, b)
                }
            })
        })
}, "arcgisonline/map/dijit/AddFieldPlugin": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_editor/_Plugin,arcgisonline/map/dijit/DropDownButton"], function(b, g, n) {
        b.provide("arcgisonline.map.dijit.AddFieldPlugin");
        b.require("dijit._editor._Plugin");
        b.require("arcgisonline.map.dijit.DropDownButton");
        b.declare("arcgisonline.map.dijit.AddFieldPlugin", g._editor._Plugin, {
            _initButton: function() {
                this.dropDown =
                    this.select;
                this.button = new arcgisonline.map.dijit.DropDownButton({ showLabel: !1, dropDown: this.dropDown, tabIndex: -1 });
                this.connect(this.dropDown, "onClick", function(a) {
                    this.button.closeDropDown();
                    this.editor.focus();
                    this.editor.execCommand("inserthtml", "{" + a.target.value + "}")
                })
            },
            setEditor: function(a) {
                this.editor = a;
                this._initButton()
            },
            updateState: function() { this.button.set("disabled", this.get("disabled")) }
        })
    })
}, "arcgisonline/sharing/dijit/LinkDialog": function() {
    define("require dojo/_base/declare dojo/dom dijit/_editor/_Plugin dijit/_editor/plugins/LinkDialog ../util ../../pages/utils/validation dojo/i18n!../../nls/arcgisonline".split(" "),
        function(b, g, n, a, c, d, f, e) {
            var h = g("arcgisonline.sharing.dijit.LinkDialog", c, {
                    linkDialogTemplate: "\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'hide'\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit/form/Select'\x3e\x3coption selected\x3d'selected' value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
                    _loadDropDown: function() {
                        this.inherited(arguments);
                        var a = 0,
                            b = setInterval(function() {
                                this._urlInput ? (clearInterval(b), this._urlInput.isValid = function() { return !0 }) : 15 < a && clearInterval(b);
                                a++
                            }.bind(this), 1E3)
                    },
                    _onOpenDialog: function() {
                        this.inherited(arguments);
                        var a = e.linkDialog;
                        this._urlInputError = n.byId(this._uniqueId + "_urlInputError");
                        this.dropDown.contentsNode.parentNode.classList.add("link-container");
                        var b = this.dropDown.containerNode;
                        b.classList.add("text-left");
                        b.title = a.linkTitle;
                        b.firstChild.textContent =
                            "";
                        b = b.children[0];
                        b.className += "link-container__title font-size-1";
                        b.style.cssText = "";
                        b.textContent = a.linkTitle;
                        if (b = n.byId(this._uniqueId + "_textInputLabel")) b.innerHTML = a.text;
                        if (b = n.byId(this._uniqueId + "_urlInputLabel")) b.innerHTML = a.url;
                        this._setButton.set("label", a.update)
                    },
                    _isValid: function() { var a = this._urlInput.get("value");!d.isPortal() && a.length && -1 < a.indexOf("http:") ? f.setInvalidState(null, this._urlInputError, e.common.httpWarning) : f.clearState([this._urlInputError]); return !0 },
                    _checkAndFixInput: function() {
                        var a =
                            this,
                            b = this._urlInput.get("value");
                        this._delayedCheck && (clearTimeout(this._delayedCheck), this._delayedCheck = null);
                        this._delayedCheck = setTimeout(function() {
                            var c = b,
                                d = !1,
                                e = !1;
                            c && 1 < c.length && (c = c.trim(), 0 !== c.indexOf("mailto:") && (0 < c.indexOf("/") ? -1 === c.indexOf("://") && "/" !== c.charAt(0) && c.indexOf("./") && 0 !== c.indexOf("../") && a._hostRxp.test(c) && (d = !0) : a._userAtRxp.test(c) && (e = !0)));
                            d && -1 === c.indexOf("{expression/") && -1 === c.indexOf("{relationships/") && a._urlInput.set("value", "http://" + c);
                            e && a._urlInput.set("value",
                                "mailto:" + c);
                            a._setButton.set("disabled", !a._isValid())
                        }, 250)
                    }
                }),
                m = g("arcgisonline.sharing.dijit.ImgLinkDialog", [c], {
                    linkDialogTemplate: "\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
                    htmlTemplate: '\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',
                    tag: "img",
                    _getCurrentValues: function(a) {
                        var b, c;
                        a && a.tagName.toLowerCase() === this.tag ? (b = a.getAttribute("_djrealurl") || a.getAttribute("src"), c = a.getAttribute("alt"), this.editor.selection.selectElement(a, !0)) : c = this.editor.selection.getSelectedText();
                        return { urlInput: b || "", textInput: c || "" }
                    },
                    _onOpenDialog: function() {
                        this.inherited(arguments);
                        var a = e.linkDialog;
                        this._urlInputError = n.byId(this._uniqueId +
                            "_urlInputError");
                        this.dropDown.contentsNode.parentNode.classList.add("link-container");
                        var b = this.dropDown.containerNode;
                        b.classList.add("text-left");
                        b.title = a.imageTitle;
                        b.firstChild.textContent = "";
                        b = b.children[0];
                        b.className += "link-container__title font-size-1";
                        b.style.cssText = "";
                        b.textContent = a.imageTitle;
                        if (b = n.byId(this._uniqueId + "_textInputLabel")) b.innerHTML = a.description;
                        if (b = n.byId(this._uniqueId + "_urlInputLabel")) b.innerHTML = a.url;
                        this._setButton.set("label", a.update)
                    },
                    _isValid: function() {
                        var a =
                            this._urlInput.get("value");
                        !d.isPortal() && a.length && -1 < a.indexOf("http:") ? f.setInvalidState(null, this._urlInputError, e.common.httpWarning) : f.clearState([this._urlInputError]);
                        return !0
                    },
                    _connectTagEvents: function() {
                        this.inherited(arguments);
                        this.editor.onLoadDeferred.then(function() { this.own(dojo.on(this.editor.editNode, "mousedown", this._selectTag.bind(this))) }.bind(this))
                    },
                    _selectTag: function(a) { a && a.target && (a = a.target, (a.tagName ? a.tagName.toLowerCase() : "") === this.tag && this.editor.selection.selectElement(a)) },
                    _checkValues: function(a) {
                        a && a.urlInput && (a.urlInput = a.urlInput.replace(/"/g, "\x26quot;"));
                        a && a.textInput && (a.textInput = a.textInput.replace(/"/g, "\x26quot;"));
                        return a
                    },
                    _onDblClick: function(a) {
                        if (a && a.target && (a = a.target, (a.tagName ? a.tagName.toLowerCase() : "") === this.tag && dojo.attr(a, "src"))) {
                            var b = this.editor;
                            this.editor.selection.selectElement(a);
                            b.onDisplayChanged();
                            b._updateTimer && (b._updateTimer.remove(), delete b._updateTimer);
                            b.onNormalizedDisplayChanged();
                            var c = this.button;
                            setTimeout(function() {
                                c.set("disabled", !1);
                                c.loadAndOpenDropDown().then(function() { c.dropDown.focus && c.dropDown.focus() })
                            }, 10)
                        }
                    }
                });
            a.registry.createEsriLink = function() { return new h({ command: "createLink" }) };
            a.registry.insertEsriImage = function() { return new m({ command: "insertImage" }) };
            h.ImgLinkDialog = m;
            return h
        })
}, "dijit/_editor/plugins/FontChoice": function() {
    define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t) {
            b = n("dijit._editor.plugins._FontDropDown", [m, p, r], {
                label: "",
                plainText: !1,
                templateString: "\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
                contextRequire: b,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.strings = c.getLocalization("dijit._editor", "FontChoice");
                    this.label = this.strings[this.command];
                    this.id = h.getUniqueId(this.declaredClass.replace(/\./g, "_"));
                    this.selectId = this.id + "_select";
                    this.inherited(arguments)
                },
                postCreate: function() {
                    this.select.set("store", new e({ idProperty: "value", data: g.map(this.values, function(a) { var b = this.strings[a] || a; return { label: this.getLabel(a, b), name: b, value: a } }, this) }));
                    this.select.set("value",
                        "", !1);
                    this.disabled = this.select.get("disabled")
                },
                _setValueAttr: function(a, b) {
                    b = !1 !== b;
                    this.select.set("value", 0 > g.indexOf(this.values, a) ? "" : a, b);
                    b || (this.select._lastValueReported = null)
                },
                _getValueAttr: function() { return this.select.get("value") },
                focus: function() { this.select.focus() },
                _setDisabledAttr: function(a) {
                    this._set("disabled", a);
                    this.select.set("disabled", a)
                }
            });
            var x = n("dijit._editor.plugins._FontNameDropDown", b, {
                    generic: !1,
                    command: "fontName",
                    comboClass: "dijitFontNameCombo",
                    postMixInProperties: function() {
                        this.values ||
                            (this.values = this.generic ? ["serif", "sans-serif", "monospace", "cursive", "fantasy"] : ["Arial", "Times New Roman", "Comic Sans MS", "Courier New"]);
                        this.inherited(arguments)
                    },
                    getLabel: function(a, b) { return this.plainText ? b : "\x3cdiv style\x3d'font-family: " + a + "'\x3e" + b + "\x3c/div\x3e" },
                    _normalizeFontName: function(a) {
                        var b = this.values;
                        if (!a || !b) return a;
                        var c = a.split(",");
                        if (1 < c.length)
                            for (var d = 0, e = c.length; d < e; d++) { var h = f.trim(c[d]); if (-1 < g.indexOf(b, h)) return h }
                        return a
                    },
                    _setValueAttr: function(a, b) {
                        b = !1 !==
                            b;
                        a = this._normalizeFontName(a);
                        this.generic && (a = { Arial: "sans-serif", Helvetica: "sans-serif", Myriad: "sans-serif", Times: "serif", "Times New Roman": "serif", "Comic Sans MS": "cursive", "Apple Chancery": "cursive", Courier: "monospace", "Courier New": "monospace", Papyrus: "fantasy", "Estrangelo Edessa": "cursive", Gabriola: "fantasy" }[a] || a);
                        this.inherited(arguments, [a, b])
                    }
                }),
                B = n("dijit._editor.plugins._FontSizeDropDown", b, {
                    command: "fontSize",
                    comboClass: "dijitFontSizeCombo",
                    values: [1, 2, 3, 4, 5, 6, 7],
                    getLabel: function(a,
                        b) { return this.plainText ? b : "\x3cfont size\x3d" + a + "'\x3e" + b + "\x3c/font\x3e" },
                    _setValueAttr: function(a, b) {
                        b = !1 !== b;
                        a.indexOf && -1 != a.indexOf("px") && (a = { 10: 1, 13: 2, 16: 3, 18: 4, 24: 5, 32: 6, 48: 7 }[parseInt(a, 10)] || a);
                        this.inherited(arguments, [a, b])
                    }
                }),
                E = n("dijit._editor.plugins._FormatBlockDropDown", b, {
                    command: "formatBlock",
                    comboClass: "dijitFormatBlockCombo",
                    values: "noFormat p h1 h2 h3 pre".split(" "),
                    postCreate: function() {
                        this.inherited(arguments);
                        this.set("value", "noFormat", !1)
                    },
                    getLabel: function(a, b) {
                        return this.plainText ||
                            "noFormat" == a ? b : "\x3c" + a + "\x3e" + b + "\x3c/" + a + "\x3e"
                    },
                    _execCommand: function(a, b, c) {
                        if ("noFormat" === c) {
                            var e;
                            if ((b = t.getSelection(a.window)) && 0 < b.rangeCount) {
                                c = b.getRangeAt(0);
                                var f;
                                if (c) {
                                    b = c.startContainer;
                                    for (e = c.endContainer; b && b !== a.editNode && b !== a.document.body && 1 !== b.nodeType;) b = b.parentNode;
                                    for (; e && e !== a.editNode && e !== a.document.body && 1 !== e.nodeType;) e = e.parentNode;
                                    var h = d.hitch(this, function(b, c) {
                                        if (b.childNodes && b.childNodes.length) {
                                            var d;
                                            for (d = 0; d < b.childNodes.length; d++) {
                                                var e = b.childNodes[d];
                                                if (1 == e.nodeType && a.selection.inSelection(e)) {
                                                    var f = e.tagName ? e.tagName.toLowerCase() : ""; - 1 !== g.indexOf(this.values, f) && c.push(e);
                                                    h(e, c)
                                                }
                                            }
                                        }
                                    });
                                    c = d.hitch(this, function(b) {
                                        if (b && b.length) {
                                            for (a.beginEditing(); b.length;) this._removeFormat(a, b.pop());
                                            a.endEditing()
                                        }
                                    });
                                    var m = [];
                                    if (b == e) {
                                        var n;
                                        for (e = b; e && e !== a.editNode && e !== a.document.body;) {
                                            if (1 == e.nodeType && (f = e.tagName ? e.tagName.toLowerCase() : "", -1 !== g.indexOf(this.values, f))) { n = e; break }
                                            e = e.parentNode
                                        }
                                        h(b, m);
                                        n && (m = [n].concat(m))
                                    } else
                                        for (e = b; a.selection.inSelection(e);) 1 ==
                                            e.nodeType && (f = e.tagName ? e.tagName.toLowerCase() : "", -1 !== g.indexOf(this.values, f) && m.push(e), h(e, m)), e = e.nextSibling;
                                    c(m);
                                    a.onDisplayChanged()
                                }
                            }
                        } else a.execCommand(b, c)
                    },
                    _removeFormat: function(b, c) {
                        if (b.customUndo) {
                            for (; c.firstChild;) a.place(c.firstChild, c, "before");
                            c.parentNode.removeChild(c)
                        } else {
                            b.selection.selectElementChildren(c);
                            var d = b.selection.getSelectedHtml();
                            b.selection.selectElement(c);
                            b.execCommand("inserthtml", d || "")
                        }
                    }
                }),
                G = n("dijit._editor.plugins.FontChoice", w, {
                    useDefaultCommand: !1,
                    _initButton: function() {
                        var a = { fontName: x, fontSize: B, formatBlock: E }[this.command],
                            b = this.params;
                        this.params.custom && (b.values = this.params.custom);
                        var c = this.editor;
                        this.button = new a(d.delegate({ dir: c.dir, lang: c.lang }, b));
                        this.own(this.button.select.on("change", d.hitch(this, function(a) {
                            this.editor.focused && this.editor.focus();
                            "fontName" == this.command && -1 != a.indexOf(" ") && (a = "'" + a + "'");
                            this.button._execCommand ? this.button._execCommand(this.editor, this.command, a) : this.editor.execCommand(this.command,
                                a)
                        })))
                    },
                    updateState: function() {
                        var a = this.editor,
                            b = this.command;
                        if (a && a.isLoaded && b.length && this.button) {
                            var c = this.get("disabled");
                            this.button.set("disabled", c);
                            if (!c) {
                                var e;
                                try { e = a.queryCommandValue(b) || "" } catch (L) { e = "" }(c = d.isString(e) && (e.match(/'([^']*)'/) || e.match(/"([^"]*)"/))) && (e = c[1]);
                                "fontSize" !== b || e || (e = 3);
                                if ("formatBlock" === b)
                                    if (e && "p" != e) 0 > g.indexOf(this.button.values, e) && (e = "noFormat");
                                    else {
                                        e = null;
                                        var f;
                                        (b = t.getSelection(this.editor.window)) && 0 < b.rangeCount && (b = b.getRangeAt(0)) && (f =
                                            b.endContainer);
                                        for (; f && f !== a.editNode && f !== a.document;) {
                                            if ((b = f.tagName ? f.tagName.toLowerCase() : "") && -1 < g.indexOf(this.button.values, b)) { e = b; break }
                                            f = f.parentNode
                                        }
                                        e || (e = "noFormat")
                                    }
                                e !== this.button.get("value") && this.button.set("value", e, !1)
                            }
                        }
                    }
                });
            g.forEach(["fontName", "fontSize", "formatBlock"], function(a) { w.registry[a] = function(b) { return new G({ command: a, plainText: b.plainText }) } });
            G._FontDropDown = b;
            G._FontNameDropDown = x;
            G._FontSizeDropDown = B;
            G._FormatBlockDropDown = E;
            return G
        })
}, "dijit/_editor/plugins/ViewSource": function() {
    define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            var G = n("dijit._editor.plugins.ViewSource", t, {
                stripScripts: !0,
                stripComments: !0,
                stripIFrames: !0,
                stripEventHandlers: !0,
                readOnly: !1,
                _fsPlugin: null,
                toggle: function() {
                    r("webkit") && (this._vsFocused = !0);
                    this.button.set("checked", !this.button.get("checked"))
                },
                _initButton: function() {
                    var a = e.getLocalization("dijit._editor", "commands"),
                        b = this.editor;
                    this.button = new x({
                        label: a.viewSource,
                        ownerDocument: b.ownerDocument,
                        dir: b.dir,
                        lang: b.lang,
                        showLabel: !1,
                        iconClass: this.iconClassPrefix +
                            " " + this.iconClassPrefix + "ViewSource",
                        tabIndex: "-1",
                        onChange: m.hitch(this, "_showSource")
                    });
                    this.button.set("readOnly", !1)
                },
                setEditor: function(a) {
                    this.editor = a;
                    this._initButton();
                    this.editor.addKeyHandler(h.F12, !0, !0, m.hitch(this, function(a) {
                        this.button.focus();
                        this.toggle();
                        a.stopPropagation();
                        a.preventDefault();
                        setTimeout(m.hitch(this, function() { this.editor.focused && this.editor.focus() }), 100)
                    }))
                },
                _showSource: function(a) {
                    var c = this.editor,
                        d = c._plugins,
                        e;
                    this._sourceShown = a;
                    var h = this;
                    try {
                        this.sourceArea ||
                            this._createSourceView();
                        if (a) c._sourceQueryCommandEnabled = c.queryCommandEnabled, c.queryCommandEnabled = function(a) { return "viewsource" === a.toLowerCase() }, this.editor.onDisplayChanged(), e = c.get("value"), e = this._filter(e), c.set("value", e), b.forEach(d, function(a) {!a || a instanceof G || !a.isInstanceOf(t) || a.set("disabled", !0) }), this._fsPlugin && (this._fsPlugin._getAltViewNode = function() { return h.sourceArea }), this.sourceArea.value = e, this.sourceArea.style.height = c.iframe.style.height, this.sourceArea.style.width =
                            c.iframe.style.width, c.iframe.parentNode.style.position = "relative", f.set(c.iframe, { position: "absolute", top: 0, visibility: "hidden" }), f.set(this.sourceArea, { display: "block" }), this._resizeHandle = p(window, "resize", m.hitch(this, function() {
                                var a = v.getBox(c.ownerDocument);
                                "_prevW" in this && "_prevH" in this && a.w === this._prevW && a.h === this._prevH || (this._prevW = a.w, this._prevH = a.h, this._resizer && (clearTimeout(this._resizer), delete this._resizer), this._resizer = setTimeout(m.hitch(this, function() {
                                    delete this._resizer;
                                    this._resize()
                                }), 10))
                            })), setTimeout(m.hitch(this, this._resize), 100), this.editor.onNormalizedDisplayChanged(), this.editor.__oldGetValue = this.editor.getValue, this.editor.getValue = m.hitch(this, function() { var a = this.sourceArea.value; return a = this._filter(a) }), this._setListener = g.after(this.editor, "setValue", m.hitch(this, function(a) {
                                a = this._filter(a || "");
                                this.sourceArea.value = a
                            }), !0);
                        else {
                            if (!c._sourceQueryCommandEnabled) return;
                            this._setListener.remove();
                            delete this._setListener;
                            this._resizeHandle.remove();
                            delete this._resizeHandle;
                            this.editor.__oldGetValue && (this.editor.getValue = this.editor.__oldGetValue, delete this.editor.__oldGetValue);
                            c.queryCommandEnabled = c._sourceQueryCommandEnabled;
                            this._readOnly || (e = this.sourceArea.value, e = this._filter(e), c.beginEditing(), c.set("value", e), c.endEditing());
                            b.forEach(d, function(a) { a && a.isInstanceOf(t) && a.set("disabled", !1) });
                            f.set(this.sourceArea, "display", "none");
                            f.set(c.iframe, { position: "relative", visibility: "visible" });
                            delete c._sourceQueryCommandEnabled;
                            this.editor.onDisplayChanged()
                        }
                        setTimeout(m.hitch(this,
                            function() {
                                var a = c.domNode.parentNode;
                                a && (a = E.getEnclosingWidget(a)) && a.resize && a.resize();
                                c.resize()
                            }), 300)
                    } catch (L) {}
                },
                updateState: function() { this.button.set("disabled", this.get("disabled")) },
                _resize: function() {
                    var a = this.editor,
                        b = a.getHeaderHeight(),
                        c = a.getFooterHeight(),
                        e = d.position(a.domNode),
                        f = d.getPadBorderExtents(a.iframe.parentNode),
                        g = d.getMarginExtents(a.iframe.parentNode),
                        h = d.getPadBorderExtents(a.domNode),
                        m = e.w - h.w,
                        e = e.h - (b + h.h + c);
                    this._fsPlugin && this._fsPlugin.isFullscreen && (a = v.getBox(a.ownerDocument),
                        m = a.w - h.w, e = a.h - (b + h.h + c));
                    d.setMarginBox(this.sourceArea, { w: Math.round(m - (f.w + g.w)), h: Math.round(e - (f.h + g.h)) })
                },
                _createSourceView: function() {
                    var b = this.editor,
                        d = b._plugins;
                    this.sourceArea = c.create("textarea");
                    this.readOnly && (a.set(this.sourceArea, "readOnly", !0), this._readOnly = !0);
                    f.set(this.sourceArea, { padding: "0px", margin: "0px", borderWidth: "0px", borderStyle: "none" });
                    a.set(this.sourceArea, "aria-label", this.editor.id);
                    c.place(this.sourceArea, b.iframe, "before");
                    r("ie") && b.iframe.parentNode.lastChild !==
                        b.iframe && f.set(b.iframe.parentNode.lastChild, { width: "0px", height: "0px", padding: "0px", margin: "0px", borderWidth: "0px", borderStyle: "none" });
                    b._viewsource_oldFocus = b.focus;
                    var e = this;
                    b.focus = function() {
                        if (e._sourceShown) e.setSourceAreaCaret();
                        else try { this._vsFocused ? (delete this._vsFocused, w.focus(b.editNode)) : b._viewsource_oldFocus() } catch (L) {}
                    };
                    var g, n;
                    for (g = 0; g < d.length; g++)
                        if ((n = d[g]) && ("dijit._editor.plugins.FullScreen" === n.declaredClass || n.declaredClass === B._scopeName + "._editor.plugins.FullScreen")) {
                            this._fsPlugin =
                                n;
                            break
                        }
                    this._fsPlugin && (this._fsPlugin._viewsource_getAltViewNode = this._fsPlugin._getAltViewNode, this._fsPlugin._getAltViewNode = function() { return e._sourceShown ? e.sourceArea : this._viewsource_getAltViewNode() });
                    this.own(p(this.sourceArea, "keydown", m.hitch(this, function(a) { this._sourceShown && a.keyCode == h.F12 && a.ctrlKey && a.shiftKey && (this.button.focus(), this.button.set("checked", !1), setTimeout(m.hitch(this, function() { b.focus() }), 100), a.stopPropagation(), a.preventDefault()) })))
                },
                _stripScripts: function(a) {
                    a &&
                        (a = a.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig, ""), a = a.replace(/<\s*script\b([^<>]|\s)*>?/ig, ""), a = a.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig, ""));
                    return a
                },
                _stripComments: function(a) { a && (a = a.replace(/\x3c!--(.|\s){1,}?--\x3e/g, "")); return a },
                _stripIFrames: function(a) { a && (a = a.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig, "")); return a },
                _stripEventHandlers: function(a) {
                    if (a) {
                        var b = a.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);
                        if (b)
                            for (var c =
                                    0, d = b.length; c < d; c++) {
                                var e = b[c],
                                    f = e.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm, "");
                                a = a.replace(e, f)
                            }
                    }
                    return a
                },
                _filter: function(a) { a && (this.stripScripts && (a = this._stripScripts(a)), this.stripComments && (a = this._stripComments(a)), this.stripIFrames && (a = this._stripIFrames(a)), this.stripEventHandlers && (a = this._stripEventHandlers(a))); return a },
                setSourceAreaCaret: function() {
                    var a = this.sourceArea;
                    w.focus(a);
                    this._sourceShown && !this.readOnly && (a.setSelectionRange ? a.setSelectionRange(0, 0) : this.sourceArea.createTextRange &&
                        (a = a.createTextRange(), a.collapse(!0), a.moveStart("character", -99999), a.moveStart("character", 0), a.moveEnd("character", 0), a.select()))
                },
                destroy: function() {
                    this._resizer && (clearTimeout(this._resizer), delete this._resizer);
                    this._resizeHandle && (this._resizeHandle.remove(), delete this._resizeHandle);
                    this._setListener && (this._setListener.remove(), delete this._setListener);
                    this.inherited(arguments)
                }
            });
            t.registry.viewSource = t.registry.viewsource = function(a) {
                return new G({
                    readOnly: "readOnly" in a ? a.readOnly :
                        !1,
                    stripComments: "stripComments" in a ? a.stripComments : !0,
                    stripScripts: "stripScripts" in a ? a.stripScripts : !0,
                    stripIFrames: "stripIFrames" in a ? a.stripIFrames : !0,
                    stripEventHandlers: "stripEventHandlers" in a ? a.stripEventHandlers : !0
                })
            };
            return G
        })
}, "dojo/store/DataStore": function() {
    define("../_base/lang ../_base/declare ../Deferred ../_base/array ./util/QueryResults ./util/SimpleQueryEngine".split(" "), function(b, g, n, a, c, d) {
        return g("dojo.store.DataStore", null, {
            target: "",
            constructor: function(a) {
                b.mixin(this,
                    a);
                if (!("idProperty" in a)) {
                    var c;
                    try { c = this.store.getIdentityAttributes() } catch (h) {}
                    this.idProperty = (b.isArray(c) ? c[0] : c) || this.idProperty
                }
                a = this.store.getFeatures();
                a["dojo.data.api.Read"] || (this.get = null);
                a["dojo.data.api.Identity"] || (this.getIdentity = null);
                a["dojo.data.api.Write"] || (this.put = this.add = null)
            },
            idProperty: "id",
            store: null,
            queryEngine: d,
            _objectConverter: function(a) {
                function b(a) {
                    for (var e = {}, f = c.getAttributes(a), g = 0; g < f.length; g++) {
                        var h = f[g],
                            m = c.getValues(a, h);
                        if (1 < m.length) {
                            for (h =
                                0; h < m.length; h++) { var n = m[h]; "object" == typeof n && c.isItem(n) && (m[h] = b(n)) }
                            n = m
                        } else n = c.getValue(a, h), "object" == typeof n && c.isItem(n) && (n = b(n));
                        e[f[g]] = n
                    }
                    d in e || !c.getIdentity || (e[d] = c.getIdentity(a));
                    return e
                }
                var c = this.store,
                    d = this.idProperty;
                return function(c) { return a(c && b(c)) }
            },
            get: function(a, b) {
                var c, d, e = new n;
                this.store.fetchItemByIdentity({ identity: a, onItem: this._objectConverter(function(a) { e.resolve(c = a) }), onError: function(a) { e.reject(d = a) } });
                if (void 0 !== c) return null == c ? void 0 : c;
                if (d) throw d;
                return e.promise
            },
            put: function(a, b) {
                b = b || {};
                var c = "undefined" != typeof b.id ? b.id : this.getIdentity(a),
                    d = this.store,
                    e = this.idProperty,
                    f = new n;
                if ("undefined" == typeof c) {
                    var g = d.newItem(a);
                    d.save({ onComplete: function() { f.resolve(g) }, onError: function(a) { f.reject(a) } })
                } else d.fetchItemByIdentity({
                    identity: c,
                    onItem: function(c) {
                        if (c) { if (!1 === b.overwrite) return f.reject(Error("Overwriting existing object not allowed")); for (var g in a) g != e && a.hasOwnProperty(g) && d.getValue(c, g) != a[g] && d.setValue(c, g, a[g]) } else {
                            if (!0 ===
                                b.overwrite) return f.reject(Error("Creating new object not allowed"));
                            c = d.newItem(a)
                        }
                        d.save({ onComplete: function() { f.resolve(c) }, onError: function(a) { f.reject(a) } })
                    },
                    onError: function(a) { f.reject(a) }
                });
                return f.promise
            },
            add: function(a, b) {
                (b = b || {}).overwrite = !1;
                return this.put(a, b)
            },
            remove: function(a) {
                var b = this.store,
                    c = new n;
                this.store.fetchItemByIdentity({ identity: a, onItem: function(a) { try { null == a ? c.resolve(!1) : (b.deleteItem(a), b.save(), c.resolve(!0)) } catch (p) { c.reject(p) } }, onError: function(a) { c.reject(a) } });
                return c.promise
            },
            query: function(d, e) {
                var f, g = new n(function() { f.abort && f.abort() });
                g.total = new n;
                var p = this._objectConverter(function(a) { return a });
                f = this.store.fetch(b.mixin({ query: d, onBegin: function(a) { g.total.resolve(a) }, onComplete: function(b) { g.resolve(a.map(b, p)) }, onError: function(a) { g.reject(a) } }, e));
                return c(g)
            },
            getIdentity: function(a) { return a[this.idProperty] }
        })
    })
}, "arcgisonline/map/dijit/Clustering": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/connect dojo/_base/array dojo/_base/window dojo/dom-style dojo/dom dojo/dom-construct dijit/registry dojo/has esri/dijit/util/busyIndicator dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/templates/Clustering.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x) {
            b = b([w, t], {
                declaredClass: "arcgisonline.map.dijit.Clustering",
                basePath: require.toUrl("arcgisonline/map/dijit"),
                widgetsInTemplate: !0,
                templateString: x,
                _rConnects: null,
                i18n: null,
                disableAllEvents: !0,
                container: null,
                mapLayer: null,
                layer: null,
                constructor: function(a, b) { a && (a.containerNode && (this.container = a.containerNode), a.subLayerId && 0 <= a.subLayerId ? this.subLayerId = a.subLayerId : a.subLayerId = void 0, this.mapLayer = a.mapLayer, this._rConnects = []) },
                destroy: function() {
                    dijit.popup.close(this.textColorTooltip);
                    c.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = v.common;
                    g.mixin(this.i18n, v.common);
                    g.mixin(this.i18n, v.generalDlg);
                    g.mixin(this.i18n, v.clusteringPanel)
                },
                postCreate: function() {
                    this.container.addChild(m.byId("clusteringPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(m.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    this._rConnects.push(a.connect(this._closeBtn,
                        "onclick", this, "_onCancel"))
                },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded ? isEmbedded.isItemDetail || f.set(e.byId("clusteringContentHeader"), "display", "") : (f.set(e.byId("clusteringContentFooter"), "display", ""), f.set(e.byId("clusteringContentHeader"), "display", ""));
                    this._init()
                },
                _init: function() {
                    this.disableAllEvents = !0;
                    esri.isDefined(this.subLayerId) && this.mapLayer.layers ? this.layer = this.mapLayer.layers[this.subLayerId] : this.layer = this.mapLayer.layer;
                    this._clusteringLayerName.innerHTML =
                        arcgisonline.map.main.getLayerTitle(this.mapLayer, this.subLayerId);
                    this.clusterSlider = this.createClusterSlider();
                    this.onUpdateStartHandler && a.disconnect(this.onUpdateStartHandler);
                    this.onUpdateStartHandler = a.connect(this.layer, "onUpdateStart", g.hitch(this, function() { this.showBusy("clusteringStack") }));
                    this.onUpdateEndHandler && a.disconnect(this.onUpdateEndHandler);
                    this.onUpdateEndHandler = a.connect(this.layer, "onUpdateEnd", g.hitch(this, function() { this.hideBusy() }));
                    this.updateUIWithFeatureReductionInfo()
                },
                updateUIWithFeatureReductionInfo: function() {
                    var a = this.layer.getFeatureReduction();
                    a && (this.clusterSlider.set("value", a.clusterRadius), this.layer.hasAllFeatures() && 5E4 !== this.layer.graphics.length || f.set(e.byId("tooManyFeaturesDiv"), "display", ""));
                    var b = null;
                    if (a) {
                        var b = g.mixin({}, a),
                            c = b.infoTemplate;
                        c && (b.infoTemplate = new c.constructor(c.toJson()))
                    }
                    this.savedInfo = { featureReduction: b, hasLayerPopup: !!this.layer.infoTemplate };
                    this.layer.renderer && "esri.renderer.UniqueValueRenderer" === this.layer.renderer.declaredClass &&
                        !this.layer.renderer.defaultSymbol && (this.savedInfo.noDefaultSymbol = !0);
                    this._clusteringCheck.set("checked", a ? !0 : !1);
                    f.set(e.byId("clusteringOptions"), "display", a ? "" : "none");
                    this._clusteringPopupLink.innerHTML = b && b.infoTemplate ? this.i18n.configurePopup : this.i18n.enablePopup;
                    !1 === this._clusteringCheck.get("checked") && (this.disableAllEvents = !1, this._clusteringCheck.set("checked", !0));
                    this.adjustHeight();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 500)
                },
                update: function() {
                    this._clusteringPopupLink.innerHTML =
                        this.layer.infoTemplate ? this.i18n.configurePopup : this.i18n.enablePopup
                },
                createClusterSlider: function(a) {
                    a = h.create("div", {}, e.byId("clusteringSlider"), "first");
                    a = new dijit.form.HorizontalRule({ container: "bottomDecoration", count: 0 }, a);
                    var b = this.layer.getFeatureReduction && this.layer.getFeatureReduction() || { type: "cluster" },
                        c = new esri.dijit.HorizontalSlider({
                            labels: [this.i18n.less, this.i18n.more],
                            minimum: 20,
                            maximum: 100,
                            value: b.clusterRadius || 80,
                            discreteValues: 20,
                            intermediateChanges: !0,
                            onChange: g.hitch(this,
                                function(a) { this.disableAllEvents || (arcgisonline.map.main.map.infoWindow.hide(), b.clusterRadius = a, this.layer.setFeatureReduction(b)) })
                        }, e.byId("clusteringSlider"));
                    c.startup();
                    a.startup();
                    return c
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    this.layer.setFeatureReduction(this.savedInfo.featureReduction);
                    this.savedInfo.hasLayerPopup || arcgisonline.map.popup.toc_removePopup(this.mapLayer);
                    this.savedInfo.noDefaultSymbol && (this.layer.renderer.defaultSymbol = null);
                    arcgisonline.map.main.map.infoWindow.hide();
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onOK: function(a) {
                    a.preventDefault();
                    this.mapLayer.featureReductionChanged = !0;
                    arcgisonline.map.main.markMapAsChanged("clustering");
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onChangeClusteringCheck: function(a) {
                    this.disableAllEvents || (this._clusteringCheck.get("checked") ? f.set(e.byId("clusteringOptions"),
                        "display", "") : f.set(e.byId("clusteringOptions"), "display", "none"), this.updateClusterInfo())
                },
                _onClickPopup: function() {
                    var a = this.layer.getFeatureReduction && this.layer.getFeatureReduction();
                    if (a.infoTemplate) arcgisonline.map.leftPanel.openLeftPopupPanel(this.mapLayer.id, this.subLayerId, "clustering");
                    else {
                        var b;
                        this.mapLayer.popupInfo && (b = this.mapLayer.popupInfo, arcgisonline.map.popup.toc_removePopup(this.mapLayer, -1));
                        delete a.disablePopup;
                        this.mapLayer.layer.setFeatureReduction(a);
                        arcgisonline.map.popup.toc_enablePopup(this.mapLayer);
                        b && (this.mapLayer.popupInfo = b, arcgisonline.map.mapUtil.setInfoTemplate(this.mapLayer.layer, null), arcgisonline.map.mapUtil.setInfoTemplate(this.mapLayer.layer, b));
                        this._clusteringPopupLink.innerHTML = this.i18n.configurePopup
                    }
                },
                updateClusterInfo: function() {
                    f.set(e.byId("tooManyFeaturesDiv"), "display", "none");
                    var a;
                    if (this._clusteringCheck.get("checked") && (a = { type: "cluster", clusterRadius: this.clusterSlider.get("value") }, this.layer.renderer && "esri.renderer.UniqueValueRenderer" === this.layer.renderer.declaredClass &&
                            !this.layer.renderer.defaultSymbol)) {
                        var b = esri.styles.type.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPoint" }).primaryScheme,
                            c = new esri.symbols.SimpleLineSymbol(esri.symbols.SimpleLineSymbol.STYLE_SOLID, new esri.Color(b.outline.color), b.outline.width);
                        this.layer.renderer.defaultSymbol = new esri.symbols.SimpleMarkerSymbol(esri.symbols.SimpleMarkerSymbol.STYLE_CIRCLE, b.size, c, b.noDataColor)
                    }
                    setTimeout(g.hitch(this, function() {
                        this.layer.setFeatureReduction(a);
                        if (a) var b = this.layer.on("update-end", g.hitch(this, function(a) {
                            b.remove();
                            a.hasAllFeatures() && 5E4 !== a.graphics.length || f.set(e.byId("tooManyFeaturesDiv"), "display", "")
                        }, this.layer))
                    }), 1)
                },
                getBasemapType: function() {
                    var a = arcgisonline.map.main.map.getLayer(arcgisonline.map.main.map.layerIds[0]);
                    if (!a.url) return "esri.layers.OpenStreetMapLayer" === arcgisonline.map.main.map.getLayer(arcgisonline.map.main.map.layerIds[0]).declaredClass ? "osm" : "topo";
                    a = a.url.toLowerCase();
                    if (-1 < a.indexOf("arcgis/rest/services/world_street_map")) return "streets";
                    if (-1 < a.indexOf("arcgis/rest/services/canvas/world_light_gray_base")) return "gray";
                    if (!(-1 < a.indexOf("arcgis/rest/services/world_topo_map") || -1 < a.indexOf("arcgis/rest/services/usgstopo"))) {
                        if (-1 < a.indexOf("arcgis/rest/services/world_terrain_base")) return "terrain";
                        if (-1 < a.indexOf("arcgis/rest/services/natgeo_world_map")) return "national-geographic";
                        if (-1 < a.indexOf("arcgis/rest/services/ocean/world_ocean_base")) return "oceans";
                        if (-1 < a.indexOf("arcgis/rest/services/world_imagery")) return "satellite";
                        if (-1 <
                            a.indexOf("arcgis/rest/services/reference/world_boundaries_and_places")) return "hybrid";
                        if (-1 < a.indexOf("arcgis/rest/services/canvas/world_dark_gray_base")) return "dark-gray"
                    }
                    return "topo"
                },
                showBusy: function(a, b, c) {
                    var d = "string" === typeof a ? a : a.id;
                    if (arcgisonline.map.leftPanel.getLeftContentPanelStack() === d || "ClusteringContent" === d) this._busyIndicator && this._busyIndicator.destroy(), b && b.set("disabled", !0), this._busyIndicatorShow = !0, this.busyTimeoutHandler && (clearTimeout(this.busyTimeoutHandler), delete this.busyTimeoutHandler,
                        clearTimeout(this._busyIndicatorTimeoutHandler), delete this._busyIndicatorTimeoutHandler), this.busyTimeoutHandler = setTimeout(g.hitch(this, function() { this._busyIndicatorShow && (this._busyIndicator = r.create({ target: a, backgroundColor: "#DDDDDD", zIndex: c || 5 }), this._busyIndicator.show()) }), 500), this._busyIndicatorTimeoutHandler = setTimeout(g.hitch(this, function() { this._busyIndicatorShow && this.hideBusy() }), 135E3)
                },
                hideBusy: function(a) {
                    this._busyIndicatorShow && (a && a.set("disabled", !1), this._busyIndicatorShow = !1, clearTimeout(this._busyIndicatorTimeoutHandler), this._busyIndicator && this._busyIndicator.hide())
                },
                destroyBusy: function(a) {
                    this.hideBusy(a);
                    this._busyIndicator && this._busyIndicator.destroy()
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel && "clusteringStack" == leftPanel.visibleStack) {
                        m.byId("clusteringContentBottom").resize();
                        a = n.coords(e.byId("leftPanelDiv")).h;
                        var b = n.coords(e.byId("clusteringContentHeader")).h,
                            c = n.coords(e.byId("clusteringSiteFooter_links")).h + 9,
                            d = n.coords(e.byId("clusteringContentButtonsCenter")).h;
                        f.set(e.byId("clusteringContentFooter"), "height", c + "px");
                        f.set(e.byId("clusteringContentButtons"), "height", d + "px");
                        f.set(e.byId("clusteringContentBottom"), "height", d + c + 16 + "px");
                        f.set(e.byId("clusteringContentPane"), "height", a - (b + c + d + 32) + "px");
                        a = n.coords(e.byId("leftContentStackContainer")).w;
                        0 < a - 35 && this.clusterSlider && f.set(this.clusterSlider.domNode, "width", a - 50 + "px")
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.Clustering", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/Gallery": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/json dojo/aspect dojo/string dojo/json dojo/dom dojo/has dojo/query dojo/on dojo/Deferred dojo/dom-style dojo/dom-class dojo/dom-construct dojox/data/AndOrWriteStore dojox/html/entities dijit/registry dijit/Tooltip dijit/form/MultiSelect dijit/form/Button esri/lang esri/symbols/jsonUtils esri/renderers/jsonUtils esri/layers/FeatureLayer esri/layers/CSVLayer esri/layers/StreamLayer esri/layers/GeoRSSLayer esri/layers/WFSLayer esri/layers/ArcGISDynamicMapServiceLayer esri/styles/choropleth esri/renderers/HeatmapRenderer esri/renderers/SimpleRenderer esri/renderers/smartMapping esri/symbols/SimpleMarkerSymbol dijit/layout/BorderContainer arcgisonline/map/dijit/renderer/MultiAttributes arcgisonline/map/dijit/renderer/Simple arcgisonline/map/dijit/renderer/HeatMap arcgisonline/map/dijit/renderer/Ratio arcgisonline/map/dijit/renderer/Relationship arcgisonline/map/dijit/renderer/Predominance arcgisonline/map/dijit/renderer/_GalleryMixin arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_SimpleMixin arcgisonline/map/dijit/renderer/_UniqueValuesMixin arcgisonline/map/dijit/renderer/_ColorMixin arcgisonline/map/dijit/renderer/_SizeMixin arcgisonline/map/dijit/renderer/_HeatMapMixin arcgisonline/map/dijit/renderer/_PredominanceMixin arcgisonline/map/dijit/renderer/_WatercolorMixin arcgisonline/map/dijit/renderer/_RatioMixin arcgisonline/map/dijit/renderer/_RelationshipMixin arcgisonline/map/dijit/renderer/_AgeColorMixin arcgisonline/map/dijit/renderer/_AgeSizeMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/ColorGrid arcgisonline/map/dijit/renderer/SizeGrid arcgisonline/map/dijit/renderer/GalleryList arcgisonline/map/dijit/renderer/ExpressionEditorDlg dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Gallery.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q, T, Y, Z, aa, fa, da, ca, ha, ia, ja, ba, ea, wa, ma, na, pa, ya, qa, ga, la, ua, ka, Ca, za) {
            b = b([ka, Ca], {
                declaredClass: "arcgisonline.map.dijit.renderer.Gallery",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererGallery",
                widgetsInTemplate: !0,
                templateString: za,
                _rConnects: null,
                tooltips: [],
                i18n: null,
                origRenderer: null,
                savedRenderers: {},
                rendererUniqueValuesStack: null,
                rendererUniqueValuesPanel: null,
                lastUniqueDefaultSymbol: null,
                lastUniqueDefaultLabel: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                features: null,
                renderer: null,
                symbol: null,
                streamPreviousSymbol: null,
                streamConnectLineSymbol: null,
                colorSetUniqueResult: null,
                onSymbolCancelHandler: null,
                onSymbolChangeHandler: null,
                onRotationChangeHandler: null,
                applyRendererEditsHandler: null,
                saveRendererHandler: null,
                colorSetGroupId: null,
                colorSetItems: null,
                rendererUniqueColorStore: null,
                attributesStore: null,
                attributesCount: null,
                datePattern: null,
                currentColorOrderIsDefault: !0,
                rendererHasUserColors: !1,
                hasNumericField: !1,
                hasDateField: !1,
                countDateFields: 0,
                showPredominance: !1,
                showDateFields: !1,
                expressionBasedTypes: !1,
                supportsSQLExpr: !1,
                numHistogramBins: 10,
                _tooltips: [],
                pattern: "#,###,###,##0.##",
                constructor: function(a, b) {
                    this._ColorGrid = ya;
                    this._SizeGrid = qa;
                    g.mixin(this, Z);
                    g.mixin(this, aa);
                    g.mixin(this, pa);
                    g.mixin(this, fa);
                    g.mixin(this, da);
                    g.mixin(this, ca);
                    g.mixin(this, ha);
                    g.mixin(this, ia);
                    g.mixin(this, ja);
                    g.mixin(this, ba);
                    g.mixin(this,
                        ma);
                    g.mixin(this, na);
                    g.mixin(this, ea);
                    g.mixin(this, wa);
                    a && (a.containerNode && (this.container = a.containerNode), this.subLayerId = a.subLayerId, this.mapLayer = a.mapLayer, this.noSimple = a.noSimple, this.showField = a.showField, this.style = a.style, this.mapLayers = a.mapLayers, this.isFeatColl = arcgisonline.map.featColl.isFeatureCollection(this.mapLayer), this.isCSV = this.mapLayer.layer instanceof O, this.isSL = this.mapLayer.layer instanceof R, this.isGeoRSS = this.mapLayer.layer instanceof esri.layers.GeoRSSLayer, this.isWFS =
                        this.mapLayer.layer instanceof esri.layers.WFSLayer, this.isDMS = this.mapLayer.layer instanceof U, this.cimVersion = 0, this.hasFeatureReduction = this.mapLayer.layer && this.mapLayer.layer.getFeatureReduction && this.mapLayer.layer.getFeatureReduction(), this.mapLayer.serviceInfo && this.mapLayer.serviceInfo.cimVersion && (b = this.mapLayer.serviceInfo.cimVersion.split("."), this.cimVersion = parseFloat(1 === b.length ? this.mapLayer.serviceInfo.cimVersion : b[0] + "." + b[1])), this.newDMS = this.isDMS && 10.51 <= this.mapLayer.layer.version &&
                        1.4 <= this.cimVersion, this.isDMS && (arcgisonline.map.main.hasDynamicLayers(this.mapLayer) ? this.hasDynamic = !0 : this.mapLayer.layer.supportsDynamicLayers && (arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer), arcgisonline.map.dynLayer.setupDynamicLayers(this.mapLayer), this.hasDynamic = !0)), this.isOwnerOfHostedFS = !1, arcgisonline.map.mapUtil.checkHostedFSAccess(this.mapLayer, g.hitch(this, function(a) { this.isOwnerOfHostedFS = !0 }, this.mapLayer)), this.showGallery = a.showGallery, this._rConnects = [])
                },
                destroy: function() {
                    this.properClose ||
                        (delete this.mapLayer._scaleChanged, delete this.mapLayer._opacityChanged, delete this.mapLayer._featureTemplatesChanged, this.hideBusy(), this.hideLegendPopup(), this.hideFieldDescriptionPopup(), this.dismissRendererChanges());
                    this.galleryList.destroy();
                    this.destroyBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.basemapSwitchHandler && a.unsubscribe(this.basemapSwitchHandler);
                    this.rendererSimplePanel && this.rendererSimplePanel.destroy();
                    this.rendererSimpleStack && this.rendererSimpleStack.destroy();
                    this.rendererUniqueValuesPanel && this.rendererUniqueValuesPanel.destroy();
                    this.rendererUniqueValuesStack && this.rendererUniqueValuesStack.destroy();
                    this.rendererColorPanel && this.rendererColorPanel.destroy();
                    this.rendererColorStack && this.rendererColorStack.destroy();
                    this.rendererSizePanel && this.rendererSizePanel.destroy();
                    this.rendererSizeStack && this.rendererSizeStack.destroy();
                    this.rendererHeatMapPanel && this.rendererHeatMapPanel.destroy();
                    this.rendererHeatMapStack && this.rendererHeatMapStack.destroy();
                    this.rendererRelationshipPanel && this.rendererRelationshipPanel.destroy();
                    this.rendererRelationshipStack && this.rendererRelationshipStack.destroy();
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    this.rendererMultiAttributesStack && this.rendererMultiAttributesStack.destroy();
                    c.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    c.forEach(this._tooltips, function(a) { a.destroy() });
                    this.openDropdownHandlers && (c.forEach(this.openDropdownHandlers, a.disconnect), delete this.openDropdownHandlers);
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = ua.common;
                    g.mixin(this.i18n, ua.generalDlg);
                    g.mixin(this.i18n, ua.viewer.time);
                    g.mixin(this.i18n, ua.rendererCommon);
                    g.mixin(this.i18n, ua.rendererGalleryPanel)
                },
                postCreate: function() {
                    this.container.addChild(D.byId("rendererPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rendererAttributes = [null, this._rendererAttribute, this._rendererAttribute2, this._rendererAttribute3, this._rendererAttribute4,
                        this._rendererAttribute5, this._rendererAttribute6, this._rendererAttribute7, this._rendererAttribute8, this._rendererAttribute9, this._rendererAttribute10
                    ];
                    this._rendererAttributeDivs = [null, null, this._rendererAttributeDiv2, this._rendererAttributeDiv3, this._rendererAttributeDiv4, this._rendererAttributeDiv5, this._rendererAttributeDiv6, this._rendererAttributeDiv7, this._rendererAttributeDiv8, this._rendererAttributeDiv9, this._rendererAttributeDiv10];
                    this._rendererRemoveAttributes = [null, null, this._rendererRemoveAttribute2,
                        this._rendererRemoveAttribute3, this._rendererRemoveAttribute4, this._rendererRemoveAttribute5, this._rendererRemoveAttribute6, this._rendererRemoveAttribute7, this._rendererRemoveAttribute8, this._rendererRemoveAttribute9, this._rendererRemoveAttribute10
                    ];
                    a.connect(this._rendererAddAttributeIcon, "click", g.hitch(this, "_onAddAttributeClick"));
                    a.connect(this._rendererAddAttributeText, "click", g.hitch(this, "_onAddAttributeClick"));
                    dojo.forEach(this._rendererRemoveAttributes, function(b, c) {
                        2 <= c && a.connect(b, "click",
                            g.hitch(this, "_onRemoveAttributeClick", c))
                    }, this);
                    a.connect(this._rendererSwitchAttribute12, "click", g.hitch(this, "_onSwitchAttributeClick"));
                    a.connect(this._rendererEditExpression, "click", g.hitch(this, "_onEditExpressionClick"));
                    a.connect(this._rendererEditExpression2, "click", g.hitch(this, "_onEditExpression2Click"));
                    a.connect(this._rendererEditExpression3, "click", g.hitch(this, "_onEditExpression3Click"));
                    a.connect(this._rendererFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute));
                    a.connect(this._rendererFieldDescription2, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute2));
                    a.connect(this._rendererFieldDescription3, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute3));
                    a.connect(this._rendererFieldDescription4, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute4));
                    a.connect(this._rendererFieldDescription5, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute5));
                    a.connect(this._rendererFieldDescription6,
                        "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute6));
                    a.connect(this._rendererFieldDescription7, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute7));
                    a.connect(this._rendererFieldDescription8, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute8));
                    a.connect(this._rendererFieldDescription9, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttribute9));
                    a.connect(this._rendererFieldDescription10, "click", g.hitch(this, "onFieldDescriptionClick",
                        this._rendererAttribute10));
                    a.connect(this._rendererDefaultStyle, "click", g.hitch(this, "_onLayerDefaultStyleClick"));
                    c.forEach(this._rendererAttributes, function(a) { a && e.after(a, "openDropDown", g.hitch(this, "_onOpenDropdown", a.id)) }, this);
                    this._rConnects.push(a.connect(D.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    this.galleryList = new ga({ selectHandler: g.hitch(this, "_onSelectListItem"), optionsHandler: g.hitch(this, "_onOptions") }, this._rendererTypesList)
                },
                _onDone: function(b) {
                    b.preventDefault();
                    this.hideBusy();
                    this.mapLayer._scaleChanged && (this.mapLayer.scaleChanged = !0);
                    delete this.mapLayer._scaleChanged;
                    this.mapLayer._opacityChanged && (this.mapLayer.opacityChanged = !0);
                    delete this.mapLayer._opacityChanged;
                    this.mapLayer._featureTemplatesChanged && (this.mapLayer.featureTemplatesChanged = !0);
                    delete this.mapLayer._featureTemplatesChanged;
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    if (f.toJson(this.origRenderer.renderer) !== f.toJson(this.renderer.toJson()) && (this.mapLayer.rendererChanged = !0, this.mapLayer.url && !this.canSwitchToDefaultStyle()))
                        if (this.hasDynamic) {
                            var d;
                            this.mapLayer.origItemLayers && (d = arcgisonline.map.main.getItemWithSourceMapLayerId(this.mapLayer.origItemLayers, this.fLayer.source.mapLayerId));
                            this.mapLayer.itemLayers && (b = arcgisonline.map.main.getItemWithSourceMapLayerId(this.mapLayer.itemLayers, this.fLayer.source.mapLayerId), b.layerDefinition && b.layerDefinition.drawingInfo && (d && d.layerDefinition && d.layerDefinition.drawingInfo ? b.layerDefinition.drawingInfo = g.clone(d.layerDefinition.drawingInfo) :
                                delete b.layerDefinition.drawingInfo));
                            if (this.mapLayer.itemLayers) {
                                var e = !1;
                                c.forEach(this.mapLayer.itemLayers, function(a) {
                                    if (a.layerDefinition.drawingInfo && a.layerDefinition.drawingInfo.renderer)
                                        if (this.mapLayer.origItemLayers) {
                                            var b = arcgisonline.map.main.getItemWithId(this.mapLayer.origItemLayers, a.id),
                                                c = b && b.layerDefinition && b.layerDefinition.drawingInfo && b.layerDefinition.drawingInfo.renderer;
                                            if (c && f.toJson(a.layerDefinition.drawingInfo.renderer) !== f.toJson(b.layerDefinition.drawingInfo.renderer) ||
                                                !c) e = !0
                                        } else e = !0
                                }, this);
                                this.mapLayer.rendererChanged = e
                            } else this.mapLayer.rendererChanged = !1
                        } else this.mapLayer.rendererChanged = !1;
                    this.layer.getFeatureReduction && f.toJson(this.origRenderer.featureReduction) !== f.toJson(this.layer.getFeatureReduction()) && (this.mapLayer.aggregationInfoChanged = !0);
                    this.properClose = !0;
                    a.publish("_onRendererUpdate", []);
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onCancel: function(b) {
                    b.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    delete this.mapLayer._featureTemplatesChanged;
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    this.properClose = !0;
                    a.publish("_onRendererUpdate", []);
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onClose: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    delete this.mapLayer._featureTemplatesChanged;
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    this.properClose = !0;
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                externalCancel: function() {
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    delete this.mapLayer._featureTemplatesChanged;
                    this.hideBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    this.properClose = !0
                },
                startup: function() {
                    this.inherited(arguments);
                    this.galleryList ? this._init() : setTimeout(g.hitch(this, function() { this.startup() }), 50)
                },
                _init: function() {
                    this.createTooltips();
                    isEmbedded ? isEmbedded.isItemDetail || (x.set(p.byId("rendererHeader"), "display", ""), x.set(this._rendererGalleryLayer, "display", "")) : (x.set(p.byId("rendererContentFooter"), "display", ""), x.set(p.byId("rendererHeader"), "display", ""), x.set(this._rendererGalleryLayer, "display", ""));
                    this.adjustHeight();
                    this.isHosted = !1;
                    if (this.isGeoRSS) - 1 !== this.subLayerId && L.isDefined(this.subLayerId) ||
                        (this.subLayerId = 0), this.layer = this.mapLayer.layer.getFeatureLayers()[this.subLayerId];
                    else if (this.isWFS) this.layer = this.mapLayer.layer;
                    else if (this.hasDynamic) c.forEach(this.mapLayer.layer.dynamicLayerInfos, function(a) { a.id === this.subLayerId && (this.layer = a) }, this), c.forEach(this.mapLayer.layersInfo.layers, function(a) {
                        a.id == this.layer.source.mapLayerId && (this.serviceLayerInfo = a, a = null, this.mapLayer.layer.layerDefinitions && (a = this.mapLayer.layer.layerDefinitions[this.subLayerId]), this.fLayer = new esri.layers.FeatureLayer(this.mapLayer.url +
                            "/dynamicLayer", { outFields: ["*"], resourceInfo: null, source: this.layer.source, opacity: this.mapLayer.layer.opacity, definitionExpression: a }))
                    }, this);
                    else if (this.mapLayer.layer instanceof U) this.layer = this.mapLayer.layersInfo.layers[this.subLayerId];
                    else if (this.isSL) this.layer = this.mapLayer.layer;
                    else if (this.mapLayer.layer) this.layer = this.mapLayer.layer, this.isHosted = arcgisonline.sharing.util.isHostedService(this.layer.url), this.supportsSQLExpr = this.layer.advancedQueryCapabilities && this.layer.advancedQueryCapabilities.supportsSqlExpression;
                    else {
                        var b = this.subLayerId;
                        c.forEach(this.mapLayer.layers, function(a, c) { this.subLayerId === a.id && (b = c, this.layer = this.mapLayer.layers[c]) }, this);
                        this.subLayerId = b
                    }
                    var d = arcgisonline.sharing.util.urlToObject(document.URL);
                    d.query = d.query || {};
                    this.newStyles = d.query.newStyles;
                    this.showPredominance = (this.expressionBasedTypes = this.isHosted || this.newStyles && !this.isDMS && this.mapLayer.layer && 10.51 <= this.mapLayer.layer.version) || this.isFeatColl || this.isCSV ? !0 : !1;
                    this.showDateFields = this.expressionBasedTypes ||
                        this.isFeatColl || this.isCSV ? !0 : !1;
                    this.numHistogramBins = this.expressionBasedTypes || this.isFeatColl || this.isCSV ? 20 : 10;
                    this._rendererGalleryLayer.innerHTML = F.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.layer.name && this.mapLayer.title !== this.layer.name && (this._rendererGalleryLayer.innerHTML += " - " + F.encode(this.layer.name.replace(/\_/g, " ")));
                    this.clearSavedRenderers();
                    this.geometryType = this.layer.geometryType;
                    this.hasDynamic && (this.geometryType = this.serviceLayerInfo.geometryType);
                    "esriGeometryMultiPatch" === this.geometryType && (this.geometryType = "esriGeometryPolygon");
                    this.renderer = this.layer.renderer;
                    this.layer.drawingInfo && this.layer.drawingInfo.renderer ? this.renderer = esri.renderer.fromJson(this.layer.drawingInfo.renderer) : this.layer.layerDefinition && this.layer.layerDefinition.drawingInfo ? this.renderer = esri.renderer.fromJson(this.layer.layerDefinition.drawingInfo.renderer) : this.serviceLayerInfo && (this.renderer = esri.renderer.fromJson(this.serviceLayerInfo.drawingInfo.renderer, { geometryType: this.layer.geometryType }));
                    if (9 > r("ie") && "heatMap" === this.getRendererStyle(this.renderer)) this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                        this.renderer = a;
                        this.setRenderer(a);
                        this._init()
                    }));
                    else {
                        this.origRenderer = this.buildCurrentRendererInfo();
                        this.renderer.visualVariables && this.renderer.visualVariables.length && (this.renderer.visualVariables = this.getVisualVariablesExceptType("sizeInfo", "auto", this.renderer.visualVariables));
                        this.hasDateField = this.hasNumericField = !1;
                        var d = this._getLayerFields(),
                            e;
                        for (e = 0; e < d.length; e++) { var f = d[e]; "esriFieldTypeSingle" !== f.type && "esriFieldTypeDouble" !== f.type && "esriFieldTypeInteger" !== f.type && "esriFieldTypeSmallInteger" !== f.type || this.layer.objectIdField === f.name || -1 !== c.indexOf(N.excludedFields, f.name.toLowerCase()) ? "esriFieldTypeDate" === f.type && (this.hasDateField = !0, this.countDateFields++) : this.hasNumericField = !0 }
                        if (!this.showGallery || this.isGeoRSS || this.isWFS || this.isSL) {
                            this.fillRendererAttribute();
                            this.isGeoRSS || this.isWFS || this.isSL || this.buildList();
                            if (this.isSL && -1 === c.indexOf(["simple", "heatMap"], this.getRendererStyle(this.layer.renderer))) {
                                this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                                    this.renderer = a;
                                    this.setRenderer(a);
                                    this._onOptions()
                                }));
                                return
                            }
                            this._onOptions()
                        } else this.newStyles && this.hasCopyStyleLayers() && this.galleryList.setCopyStyleLayers(this.loadCopyStyleLayers(), g.hitch(this, this._onChangeCopyStyleLayer)), this.fillRendererAttribute(), this.updateUIWithRenderer(), this.showLegendPopup();
                        setTimeout(g.hitch(this, function() {
                            this.disableAllEvents = !1;
                            (this.noSimple || this.showField) && this._onChangeAttribute();
                            a.publish("onRendererGalleryLoad", [])
                        }), 1E3);
                        this.basemapSwitchHandler && a.unsubscribe(this.basemapSwitchHandler);
                        this.basemapSwitchHandler = a.subscribe("basemapSwitch", g.hitch(this, function() {
                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && ("color" === this.getRendererType(this.renderer) || "colorsize" === this.getRendererType(this.renderer))) {
                                var a = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                                this.scheme = V.getSchemes({ theme: a && a.theme ? a.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                                a = this.updateSchemeOnColorRenderer({ scheme: this.scheme });
                                this.authoringInfo = g.clone(a.authoringInfo);
                                this.applyColorRenderer(a, null, !0)
                            }
                        }))
                    }
                },
                updateUIWithRenderer: function() {
                    delete this.attributeItem10;
                    delete this.attributeItem9;
                    delete this.attributeItem8;
                    delete this.attributeItem7;
                    delete this.attributeItem6;
                    delete this.attributeItem5;
                    delete this.attributeItem4;
                    delete this.attributeItem3;
                    delete this.attributeItem2;
                    delete this.attributeItem;
                    if (this.renderer.normalizationType && "field" !== this.renderer.normalizationType) this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                        this.renderer = a;
                        this.applySimpleRenderer(a)
                    }), g.hitch(this, function() { this.adjustHeight() })), this.buildList(), this.setTypeOptions(), this.selectTypeBox(), this.checkAddAndSwitchIcons();
                    else {
                        c.forEach(this._rendererAttributeDivs, function(a) { a && x.set(a, "display", "none") });
                        var a = this.getRendererStyle(this.renderer),
                            b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                            d = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                            e = this.renderer.attributeField || this.renderer.field || this.renderer.fields || b && b.field || d && d.field;
                        this._rendererAttribute.set("value", "showLocationOnly", !1);
                        if ("predominance" === a || "predominancesize" === a || "relationship" === a || "relationshipSize" === a) {
                            b = [];
                            if (this.renderer.authoringInfo)
                                if ("predominance" === a || "predominancesize" === a) b = this.renderer.authoringInfo.fields;
                                else if ("relationship" === a || "relationshipSize" === a) b = [this.renderer.authoringInfo.field1.field, this.renderer.authoringInfo.field2.field], "relationshipSize" === a && (d = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), d.field ? b.push(d.field) : d.valueExpression && b.push("customExpr3"));
                            d = this._getLayerFields();
                            if (!d && !d.length) {
                                this.buildList();
                                this.setTypeOptions();
                                this.selectTypeBox();
                                this.checkAddAndSwitchIcons();
                                return
                            }
                            var f;
                            for (f = 0; f < b.length; f++) {
                                var h = b[f];
                                if (!h.startsWith("customExpr")) {
                                    var m =
                                        c.some(d, g.hitch(this, function(a) { return a.name === h }));
                                    if (!m) {
                                        this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                                            this.renderer = a;
                                            this.applySimpleRenderer(a)
                                        }), g.hitch(this, function() { this.adjustHeight() }));
                                        this.buildList();
                                        this.setTypeOptions();
                                        this.selectTypeBox();
                                        this.checkAddAndSwitchIcons();
                                        return
                                    }
                                }
                            }
                            this.updateAttributeDropdownsFromRenderer(b);
                            this.checkAddAndSwitchIcons()
                        } else if ("ageColor" === a || "ageColorSize" === a || "ageSize" === a || "colorAgeSize" === a || "uniqueAgeSize" === a) {
                            var b = this.renderer.authoringInfo &&
                                this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables),
                                d = this.renderer.authoringInfo && this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables),
                                n = b && b.field ? b.field : d ? d.field : null;
                            f = null;
                            b && b.startTime && "string" === typeof b.startTime && "string" === typeof b.endTime && (f = h === b.startTime ? b.endTime : b.startTime);
                            d && d.startTime && "string" === typeof d.startTime && "string" === typeof d.endTime && (f = h === d.startTime ? d.endTime : d.startTime);
                            d = this._getLayerFields();
                            b = [n];
                            f && b.push(f);
                            e && b.push(e);
                            e || !this.hasRendererCustomExpression(null, "firstVar") && !this.hasRendererCustomExpression(null, "secondVar") || (e = "customExpr");
                            if (!n || !d && !d.length) {
                                this.buildList();
                                this.setTypeOptions();
                                this.selectTypeBox();
                                this.checkAddAndSwitchIcons();
                                return
                            }
                            for (f = 0; f < b.length; f++)
                                if (h = b[f], m = c.some(d, g.hitch(this, function(a) { return a.name === h })), !m) {
                                    this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                                        this.renderer = a;
                                        this.applySimpleRenderer(a)
                                    }), g.hitch(this, function() { this.adjustHeight() }));
                                    this.buildList();
                                    this.setTypeOptions();
                                    this.selectTypeBox();
                                    this.checkAddAndSwitchIcons();
                                    return
                                }
                            this.getAttributeItem(-1 < c.indexOf(["colorAgeSize", "uniqueAgeSize"], a) ? e : n).then(g.hitch(this, function(b) {
                                this.attributeItem = b;
                                this._rendererAttribute.set("value", b.name);
                                "ageColorSize" === a || "colorAgeSize" === a || "uniqueAgeSize" === a ? this.getAttributeItem(-1 < c.indexOf(["colorAgeSize", "uniqueAgeSize"], a) ? n : e).then(g.hitch(this, function(a) {
                                    this.attributeItem2 = a;
                                    this._rendererAttribute2.setStore(this.attributesStore,
                                        "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT name:'" + this.layer.objectIdField + "'" });
                                    this._rendererAttribute2.set("value", this.attributeItem2.name);
                                    x.set(this._rendererAttributeDiv2, "display", "");
                                    delete this.noSimple;
                                    this.buildList();
                                    this.setTypeOptions();
                                    this.selectTypeBox();
                                    this.checkAddAndSwitchIcons()
                                })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox(), this.checkAddAndSwitchIcons())
                            }))
                        } else if ("object" !==
                            typeof e || "watercolor" !== a)
                            if ("colorsize" === a || "uniquesize" === a || "ratio" === a) {
                                var e = b ? b.field : e,
                                    q = d ? d.field : b.normalizationField,
                                    d = this._getLayerFields(),
                                    b = c.some(d, g.hitch(this, function(a) { return a.name === e })),
                                    d = c.some(d, g.hitch(this, function(a) { return a.name === q }));
                                this.hasRendererCustomExpression(null, "firstVar") && (e = "customExpr", b = !0);
                                this.hasRendererCustomExpression(null, "secondVar") && (q = "customExpr2", d = !0);
                                b && d || (e = null, this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                                    this.renderer =
                                        a;
                                    this.applySimpleRenderer(a)
                                }), g.hitch(this, function() {})));
                                this.getAttributeItem(e).then(g.hitch(this, function(a) {
                                    this.attributeItem = a;
                                    this._rendererAttribute.set("value", a.name);
                                    this.getAttributeItem(q).then(g.hitch(this, function(a) {
                                        this.attributeItem2 = a;
                                        this.isTypeString(this.attributeItem) || this.attributeItem.codedValues ? (this._rendererAttribute2.setStore(this.attributesStore, "", {
                                            query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " +
                                                (this.showDateFields ? "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "'"
                                        }), this.isTypeString(this.attributeItem2) || this.attributeItem2.codedValues || this._rendererAttribute2.set("value", this.attributeItem2.name)) : (this._rendererAttribute2.setStore(this.attributesStore, "", {
                                            query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " + (this.showDateFields ?
                                                "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT name:'" + this.layer.objectIdField + "'"
                                        }), this._rendererAttribute2.set("value", this.attributeItem2.name));
                                        x.set(this._rendererAttributeDiv2, "display", "");
                                        delete this.noSimple;
                                        this.buildList();
                                        this.setTypeOptions();
                                        this.selectTypeBox();
                                        this.checkAddAndSwitchIcons()
                                    }))
                                }))
                            } else if (d = this._getLayerFields(), m = c.some(d, g.hitch(this, function(a) { return a.name === e })), !e && this.hasRendererCustomExpression(null, "firstVar") && (e = "customExpr", m = !0), e && !m && (e = null, this.buildSimpleRenderer().then(g.hitch(this,
                                function(a) {
                                    this.renderer = a;
                                    this.applySimpleRenderer(a)
                                }), g.hitch(this, function() {}))), this.showField) {
                            this.showField = this.showField.toLowerCase();
                            d = this._getLayerFields();
                            for (f = 0; f < d.length; f++)
                                if (d[f].name.toLowerCase() == this.showField) { e = d[f].name; break }
                            e ? this._rendererAttribute.set("value", e) : (delete this.noSimple, delete this.showField, this.buildList(), this.setTypeOptions(), this.selectTypeBox());
                            this.checkAddAndSwitchIcons()
                        } else e ? this.getAttributeItem(e).then(g.hitch(this, function(a) {
                            this.attributeItem =
                                a;
                            this._rendererAttribute.set("value", a.name);
                            delete this.noSimple;
                            this.buildList();
                            this.setTypeOptions();
                            this.selectTypeBox();
                            this.checkAddAndSwitchIcons()
                        })) : "simple" === a && this.noSimple ? N.getSuggestedField({ fields: this._getLayerFields(), objectIdField: this.layer.objectIdField }).then(g.hitch(this, function(a) {
                            a ? this._rendererAttribute.set("value", a) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox());
                            this.checkAddAndSwitchIcons()
                        }), g.hitch(this, function(a) {
                            delete this.noSimple;
                            this.buildList();
                            this.setTypeOptions();
                            this.selectTypeBox();
                            this.checkAddAndSwitchIcons()
                        })) : ("esri.renderer.SimpleRenderer" !== this.renderer.declaredClass && "esri.renderer.HeatmapRenderer" !== this.renderer.declaredClass && this.buildSimpleRenderer().then(g.hitch(this, function(a) {
                            this.renderer = a;
                            this.applySimpleRenderer(a)
                        }), g.hitch(this, function() { this.adjustHeight() })), delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox(), this.checkAddAndSwitchIcons());
                        this.canSwitchToDefaultStyle() ?
                            x.set(this._rendererDefaultStyle, "display", "") : x.set(this._rendererDefaultStyle, "display", "none")
                    }
                },
                createTooltips: function() {
                    this._tooltips.push(new A({ connectId: this._rendererSwitchAttribute12, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.switchAttributes + "\x3c/div\x3e" }));
                    dojo.forEach(this._rendererRemoveAttributes, function(a, b) { 2 <= b && this._tooltips.push(new A({ connectId: a, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.removeAttribute + "\x3c/div\x3e" })) }, this);
                    this._tooltips.push(new A({
                        connectId: this._rendererEditExpression,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e"
                    }));
                    this._tooltips.push(new A({ connectId: this._rendererEditExpression2, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({ connectId: this._rendererEditExpression3, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({
                        connectId: this._rendererFieldDescription,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" +
                            this.i18n.showDescription + "\x3c/div\x3e"
                    }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription2, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription3, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({
                        connectId: this._rendererFieldDescription4,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription +
                            "\x3c/div\x3e"
                    }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription5, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription6, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription7, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({
                        connectId: this._rendererFieldDescription8,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e"
                    }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription9, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this._tooltips.push(new A({ connectId: this._rendererFieldDescription10, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                selectTypeBox: function() {
                    var a = this.getRendererStyle(this.renderer);
                    switch (a) {
                        case "classedColor":
                            this.galleryList.selectItem("color");
                            break;
                        case "classedSize":
                            this.galleryList.selectItem("size");
                            break;
                        case "type":
                            this.galleryList.selectItem("unique");
                            break;
                        default:
                            this.galleryList.selectItem(a)
                    }
                    this.adjustHeight()
                },
                disableAllButtons: function() {
                    this.galleryList.disableAllButtons();
                    this._doneButton.set("disabled", !0);
                    setTimeout(g.hitch(this, function() { this._doneButton && this._doneButton.set("disabled", !1) }), 6E4)
                },
                updateListQueue: function() {
                    this.queueHandler && clearTimeout(this.queueHandler);
                    this.disableAllButtons();
                    this.queueHandler =
                        setTimeout(g.hitch(this, function() {
                            delete this.queueHandler;
                            this.updateList()
                        }), 2E3)
                },
                _onOpenDropdown: function(b) {
                    this.queueHandler && this.updateListQueue();
                    this.openDropdownHandlers = this.openDropdownHandlers || {};
                    this.openDropdownHandlers[b] || (this.openDropdownHandlers[b] = a.connect(p.byId(b + "_dropdown"), "onscroll", g.hitch(this, function() { this.queueHandler && this.updateListQueue() })))
                },
                updateList: function() {
                    var a = this.getRendererStyle(this.renderer),
                        b = dojo.map(this._rendererAttributeDivs, function(a) {
                            return a ?
                                "none" !== x.get(a, "display") : null
                        });
                    b[2] && !this.attributeItem2 || b[3] && !this.attributeItem3 || b[4] && !this.attributeItem4 || b[5] && !this.attributeItem5 || b[6] && !this.attributeItem6 || b[7] && !this.attributeItem7 || b[8] && !this.attributeItem8 || b[9] && !this.attributeItem9 || b[10] && !this.attributeItem10 || this.checkKeepPartsOfRenderer() || (this.attributeItem && "showLocationOnly" !== this.attributeItem.name ? this.attributeItem.codedValues || "esriFieldTypeString" === this.attributeItem.type || !this.attributeItem3 && this.isInFieldValueType(this.attributeItem,
                            "string") ? this.attributeItem2 ? (this.buildList("uniquesize"), this.setTypeOptions(), this._select_uniquesize()) : (this.buildList("type"), this.setTypeOptions(), this._select_unique()) : "esriFieldTypeInteger" !== this.attributeItem.type && "esriFieldTypeDouble" !== this.attributeItem.type && "esriFieldTypeSingle" !== this.attributeItem.type && "esriFieldTypeSmallInteger" !== this.attributeItem.type || this.layer.objectIdField === this.attributeItem.name ? "esriFieldTypeDate" === this.attributeItem.type ? this.attributeItem2 ? this.isTypeString(this.attributeItem2) ||
                        this.attributeItem2.codedValues || this.isInFieldValueType(this.attributeItem, "string") ? (this.buildList("uniquesize"), this.setTypeOptions(), this._select_uniquesize()) : (this.buildList("colorsize"), this.setTypeOptions(), this._select_colorsize()) : (this.buildList("color"), this.setTypeOptions(), this._select_color()) : "customExpr" === this.attributeItem.type && (this.attributeItem2 ? this.isNumber(this.attributeItem) && this.isNumber(this.attributeItem2) ? (this.buildList("colorsize"), this.setTypeOptions(), this._select_colorsize()) :
                            (this.buildList("uniquesize"), this.setTypeOptions(), this._select_uniquesize()) : "esriFieldTypeDouble" === this.attributeItem.valueExpressionReturnType ? (this.buildList("classedSize"), this.setTypeOptions(), this._select_size()) : (this.buildList("type"), this.setTypeOptions(), this._select_unique())) : this.attributeItem2 ? this.attributeItem3 ? this.showPredominance && (this.attributeItem4 || "relationship" !== a && "relationshipSize" !== a && "customExpr3" !== this.attributeItem3.type && this.attributeItem.name !== this.attributeItem3.name &&
                            this.attributeItem2.name !== this.attributeItem3.name) ? "predominancesize" === a ? (this.buildList("predominanceSize"), this.setTypeOptions(), this._select_predominancesize()) : (this.buildList("predominance"), this.setTypeOptions(), this._select_predominance()) : (this.buildList("relationshipSize"), this.setTypeOptions(), this._select_relationshipSize()) : this.isString(this.attributeItem2) || this.isInFieldValueType(this.attributeItem2, "string") && !this.isInFieldValueType(this.attributeItem, "string") ? (this.buildList("uniquesize"),
                            this.setTypeOptions(), this._select_uniquesize()) : this.isTypeDate(this.attributeItem) || this.isTypeDate(this.attributeItem2) ? (this.buildList("colorsize"), this.setTypeOptions(), this._select_colorsize()) : "customExpr" === this.attributeItem.type || "customExpr2" === this.attributeItem2.type ? (this.buildList("colorsize"), this.setTypeOptions(), this._select_colorsize()) : "predominance" === a && this.attributeItem.name !== this.attributeItem2.name ? (this.buildList("predominance"), this.setTypeOptions(), this._select_predominance()) :
                        "predominancesize" === a && this.attributeItem.name !== this.attributeItem2.name ? (this.buildList("predominancesize"), this.setTypeOptions(), this._select_predominancesize()) : "ratio" === a && this.attributeItem.name !== this.attributeItem2.name ? (this.buildList("ratio"), this.setTypeOptions(), this._select_ratio()) : "relationship" !== a && "relationshipSize" !== a || this.attributeItem.name === this.attributeItem2.name ? (this.buildList("colorsize"), this.setTypeOptions(), this._select_colorsize()) : (this.buildList("relationship"),
                            this.setTypeOptions(), this._select_relationship()) : (this.isMultiAttributesRenderer = !1, "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.layer.getFeatureReduction && this.layer.getFeatureReduction() ? (this.buildList("classedColor"), this.setTypeOptions(), this._select_color()) : (this.buildList("classedSize"), this.setTypeOptions(), this._select_size()) : "esriGeometryPolyline" == this.geometryType ? (this.buildList("classedSize"), this.setTypeOptions(), this._select_size()) :
                            "esriGeometryPolygon" == this.geometryType && ("esriFieldTypeInteger" != this.attributeItem.type && "esriFieldTypeSmallInteger" != this.attributeItem.type && !this.isInFieldValueType(this.attributeItem, "integer") || this.isInFieldValueType(this.attributeItem, "double") ? (this.buildList("classedColor"), this.setTypeOptions(), this._select_color()) : (this.buildList("classedSize"), this.setTypeOptions(), this._select_size()))) : (this.buildList("simple"), this.setTypeOptions(), this._select_simple()), this.adjustHeight())
                },
                checkKeepPartsOfRenderer: function() {
                    var a =
                        this.getRendererStyle(this.renderer),
                        b;
                    if (this.attributeItem && this.attributeItem2 && !this.attributeItem3 && -1 < c.indexOf("color size type colorsize uniquesize ageColor ageSize ageColorSize colorAgeSize uniqueAgeSize predominancesize relationshipSize".split(" "), a)) {
                        var d = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                            e = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                            f = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables),
                            h = this.renderer.attributeField || this.renderer.field,
                            m = d && d.field,
                            n = e && e.field,
                            q, p, u;
                        this.renderer.authoringInfo && (q = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables), p = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables), u = this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables));
                        var r = q && q.field,
                            t = p && p.field;
                        if ("predominancesize" === a && 2 === this.renderer.authoringInfo.fields.length &&
                            this.sameFieldAs(this.attributeItem, this.renderer.authoringInfo.fields[0]) && this.sameFieldAs(this.attributeItem2, this.renderer.authoringInfo.fields[1])) return b = { types: !0 }, this._select_predominance(b), !0;
                        if ("relationshipSize" === a && this.sameFieldAs(this.attributeItem, this.renderer.authoringInfo.field1.field) && this.sameFieldAs(this.attributeItem2, this.renderer.authoringInfo.field2.field)) return b = { types: !0 }, this._select_relationship(b), !0;
                        if ("type" === a && this.sameFieldAs(this.attributeItem, h, this.renderer.valueExpression,
                                this.renderer.valueExpressionTitle)) return b = { types: !0, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b), !0;
                        if ("color" === a && this.sameFieldAs(this.attributeItem, m, d.valueExpression, d.valueExpressionTitle) && this.isNumber(this.attributeItem2)) return b = { colorInfo: d, authColorInfo: q, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b), !0;
                        if ("size" === a && this.sameFieldAs(this.attributeItem, n, e.valueExpression, e.valueExpressionTitle) && this.isString(this.attributeItem2)) return b = {
                            sizeInfo: e,
                            authSizeInfo: p,
                            opacityInfo: f,
                            authOpacityInfo: u
                        }, this._select_uniquesize(b), !0;
                        if ("ageColor" === a && this.attributeItem.name === r) return b = { colorInfo: d, authColorInfo: q, opacityInfo: f, authOpacityInfo: u }, this._select_ageColorSize(b), !0;
                        if ("ageSize" === a && this.attributeItem.name === t && this.isString(this.attributeItem2)) return b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniqueAgeSize(b), !0;
                        if ("colorsize" === a && this.sameFieldAs(this.attributeItem, m, d.valueExpression, d.valueExpressionTitle)) {
                            if (!this.isString(this.attributeItem2)) return b = { colorInfo: d, authColorInfo: q, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b), !0
                        } else {
                            if ("colorsize" === a && this.sameFieldAs(this.attributeItem2, n, e.valueExpression, e.valueExpressionTitle)) return this.isString(this.attributeItem) ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b)) : (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b)), !0;
                            if ("ageColorSize" === a && this.attributeItem.name === r) {
                                if (!this.isString(this.attributeItem2)) return b = { colorInfo: d, authColorInfo: q, opacityInfo: f, authOpacityInfo: u }, this._select_ageColorSize(b), !0
                            } else {
                                if ("ageColorSize" === a && this.attributeItem2.name === n) return this.isString(this.attributeItem) ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b)) : (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b)), !0;
                                if ("colorAgeSize" === a && this.attributeItem.name === m) {
                                    if (!this.isString(this.attributeItem2)) return b = {
                                        colorInfo: d,
                                        authColorInfo: q,
                                        opacityInfo: f,
                                        authOpacityInfo: u
                                    }, this._select_colorsize(b), !0
                                } else {
                                    if ("colorAgeSize" === a && this.attributeItem2.name === t) return this.isString(this.attributeItem) ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniqueAgeSize(b)) : (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorAgeSize(b)), !0;
                                    if ("uniquesize" === a && this.sameFieldAs(this.attributeItem, n, e.valueExpression, e.valueExpressionTitle) && !this.sameFieldAs(this.attributeItem2, n, e.valueExpression,
                                            e.valueExpressionTitle)) return this.isString(this.attributeItem2) || this.attributeItem2.codedValues || this.isInFieldValueType(this.attributeItem2, "string") ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b)) : this.attributeItem.name === this.attributeItem2.name ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b)) : "customExpr" === this.attributeItem.name || "customExpr2" === this.attributeItem2.name ? this.attributesStore.fetchItemByIdentity({
                                        identity: "customExpr",
                                        onItem: g.hitch(this, function(a) {
                                            var c = this.clean(a);
                                            this.attributesStore.fetchItemByIdentity({
                                                identity: "customExpr2",
                                                onItem: g.hitch(this, function(d) {
                                                    var g = this.clean(d);
                                                    this.attributesStore.setValue(a, "valueExpression", g.valueExpression);
                                                    this.attributesStore.setValue(a, "valueExpressionReturnType", g.valueExpressionReturnType);
                                                    this.attributesStore.setValue(a, "valueExpressionTitle", g.valueExpressionTitle);
                                                    this.attributesStore.setValue(a, "displayName", g.displayName);
                                                    this.attributesStore.setValue(d, "valueExpression",
                                                        c.valueExpression);
                                                    this.attributesStore.setValue(d, "valueExpressionReturnType", c.valueExpressionReturnType);
                                                    this.attributesStore.setValue(d, "valueExpressionTitle", c.valueExpressionTitle);
                                                    this.attributesStore.setValue(d, "displayName", c.displayName);
                                                    this._rendererAttribute.set("value", "customExpr2" === this.attributeItem2.name ? "customExpr" : this.attributeItem2.name, !1);
                                                    "customExpr2" === this._rendererAttribute2.get("value") && "customExpr" === this.attributeItem.name ? this._rendererAttribute2.setStore(this.attributesStore,
                                                        this._rendererAttribute2.get("value"), { query: this._rendererAttribute2.query }, !1) : this._rendererAttribute2.set("value", "customExpr" === this.attributeItem.name ? "customExpr2" : this.attributeItem.name, !1);
                                                    d = this.attributeItem;
                                                    this.attributeItem = this.attributeItem2;
                                                    this.attributeItem2 = d;
                                                    "customExpr2" === this.attributeItem.type && (this.attributeItem.type = "customExpr", this.attributeItem.name = "customExpr", this.attributeItem.alias = "Custom Expression", this.attributeItem.valueExpression = g.valueExpression, this.attributeItem.valueExpressionReturnType =
                                                        g.valueExpressionReturnType, this.attributeItem.valueExpressionTitle = g.valueExpressionTitle, this.attributeItem.displayName = g.displayName);
                                                    "customExpr" === this.attributeItem2.type && (this.attributeItem2.type = "customExpr2", this.attributeItem2.name = "customExpr2", this.attributeItem2.alias = "Custom Expression2", this.attributeItem2.valueExpression = c.valueExpression, this.attributeItem2.valueExpressionReturnType = c.valueExpressionReturnType, this.attributeItem2.valueExpressionTitle = c.valueExpressionTitle, this.attributeItem2.displayName =
                                                        c.displayName);
                                                    b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u };
                                                    this._select_colorsize(b)
                                                })
                                            })
                                        })
                                    }) : (this._rendererAttribute.set("value", this.attributeItem2.name, !1), this._rendererAttribute2.set("value", this.attributeItem.name, !1), a = this.attributeItem, this.attributeItem = this.attributeItem2, this.attributeItem2 = a, b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b)), !0;
                                    if ("uniquesize" === a && this.sameFieldAs(this.attributeItem2, n, e.valueExpression, e.valueExpressionTitle)) return this.isString(this.attributeItem) ||
                                        this.attributeItem.codedValues || this.isInFieldValueType(this.attributeItem, "string") ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b)) : (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorsize(b)), !0;
                                    if ("uniquesize" === a && (this.sameFieldAs(this.attributeItem, h, this.renderer.valueExpression, this.renderer.valueExpressionTitle) && !this.isString(this.attributeItem2) || this.sameFieldAs(this.attributeItem2, h, this.renderer.valueExpression,
                                            this.renderer.valueExpressionTitle) && !this.isString(this.attributeItem))) return b = { types: !0, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b), !0;
                                    if ("uniqueAgeSize" === a && this.attributeItem.name === t) return this.isString(this.attributeItem2) ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniqueAgeSize(b)) : (this.attributeItem.name !== this.attributeItem2.name && (this._rendererAttribute.set("value", this.attributeItem2.name, !1), this._rendererAttribute2.set("value", this.attributeItem.name, !1), a = this.attributeItem, this.attributeItem = this.attributeItem2, this.attributeItem2 = a), b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorAgeSize(b)), !0;
                                    if ("uniqueAgeSize" === a && this.attributeItem2.name === t) return this.isString(this.attributeItem) ? (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_uniqueAgeSize(b)) : (b = { sizeInfo: e, authSizeInfo: p, opacityInfo: f, authOpacityInfo: u }, this._select_colorAgeSize(b)), !0;
                                    if ("uniqueAgeSize" === a && (this.sameFieldAs(this.attributeItem,
                                            h, this.renderer.valueExpression, this.renderer.valueExpressionTitle) && !this.isString(this.attributeItem2) || this.sameFieldAs(this.attributeItem2, h, this.renderer.valueExpression, this.renderer.valueExpressionTitle) && !this.isString(this.attributeItem))) return b = { types: !0, opacityInfo: f, authOpacityInfo: u }, this._select_uniquesize(b), !0
                                }
                            }
                        }
                    } else if (this.attributeItem && !this.attributeItem2 && -1 < c.indexOf(["colorsize", "uniquesize", "colorAgeSize", "uniqueAgeSize"], a)) {
                        if (f = this.getVisualVariableByType("opacityInfo",
                                null, this.renderer.visualVariables), h = this.renderer.attributeField || this.renderer.field, this.renderer.authoringInfo && (u = this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables)), "uniquesize" === a && this.sameFieldAs(this.attributeItem, h, this.renderer.valueExpression, this.renderer.valueExpressionTitle)) return b = { types: !0, opacityInfo: f, authOpacityInfo: u }, this._select_unique(b), !0
                    } else if (this.attributeItem && this.attributeItem2 && this.attributeItem3 && !this.attributeItem4 &&
                        -1 < c.indexOf(["relationship", "relationshipSize"], a) && this.sameFieldAs(this.attributeItem, this.renderer.authoringInfo.field1.field) && this.sameFieldAs(this.attributeItem2, this.renderer.authoringInfo.field2.field)) return b = { types: !0 }, this._select_relationshipSize(b), !0;
                    return !1
                },
                _onChangeAttribute: function(a) {
                    this.disableAllEvents || (this.hideFieldDescriptionPopup(), this.attributeItem && this.attributeItem.name === a || (this.checkLayerIndex(a), this.changeAttribute(a), "customExpr" === this._rendererAttribute.get("value") ?
                        this.attributesStore.fetchItemByIdentity({
                            identity: this._rendererAttribute.get("value"),
                            onItem: g.hitch(this, function(a) {
                                a = this.clean(a);
                                a.valueExpression && (this.updateListQueue(), this.adjustHeight())
                            })
                        }) : (this.updateListQueue(), this.adjustHeight())))
                },
                _onChangeAttribute2: function(a) {
                    this.disableAllEvents || (this.hideFieldDescriptionPopup(), this.attributeItem2 && this.attributeItem2.name === a || (this.checkLayerIndex(a), this.changeAttribute2(a), "customExpr2" === this._rendererAttribute2.get("value") ? this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererAttribute2.get("value"),
                        onItem: g.hitch(this, function(a) {
                            a = this.clean(a);
                            a.valueExpression && (this.updateListQueue(), this.adjustHeight())
                        })
                    }) : (this.updateListQueue(), this.adjustHeight())))
                },
                _onChangeAttribute3: function(a) {
                    this.disableAllEvents || (this.hideFieldDescriptionPopup(), this.attributeItem3 && this.attributeItem3.name === a || (this.checkLayerIndex(a), this.changeAttribute3(a), "customExpr3" === this._rendererAttribute3.get("value") ? this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererAttribute3.get("value"),
                        onItem: g.hitch(this,
                            function(a) {
                                a = this.clean(a);
                                a.valueExpression && (this.updateListQueue(), this.adjustHeight())
                            })
                    }) : (this.updateListQueue(), this.adjustHeight())))
                },
                _onChangeAttribute4: function(a) { this._onChangeAttributes(a, 4, this.attributeItem4) },
                _onChangeAttribute5: function(a) { this._onChangeAttributes(a, 5, this.attributeItem5) },
                _onChangeAttribute6: function(a) { this._onChangeAttributes(a, 6, this.attributeItem6) },
                _onChangeAttribute7: function(a) { this._onChangeAttributes(a, 7, this.attributeItem7) },
                _onChangeAttribute8: function(a) {
                    this._onChangeAttributes(a,
                        8, this.attributeItem8)
                },
                _onChangeAttribute9: function(a) { this._onChangeAttributes(a, 9, this.attributeItem9) },
                _onChangeAttribute10: function(a) { this._onChangeAttributes(a, 10, this.attributeItem10) },
                _onChangeAttributes: function(a, b, c) { this.disableAllEvents || (this.hideFieldDescriptionPopup(), c && c.name === a || (this.checkLayerIndex(a), this.changeAttributes(b), this.updateListQueue())) },
                _onAddAttributeClick: function(a) {
                    if (!this.disableAllEvents) {
                        var b = 1;
                        c.forEach(this._rendererAttributeDivs, function(a, c) {
                            a && "none" !==
                                x.get(a, "display") && (b = c)
                        });
                        9 === b ? (x.set(this._rendererAddAttribute, "display", "none"), x.set(this._rendererAttributeDiv10, "display", ""), x.set(this._rendererSwitchAttribute12, "display", "none")) : 3 <= b && 8 >= b ? (this.attributesCount.number > b + 1 ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"), x.set(this._rendererAttributeDivs[b + 1], "display", ""), x.set(this._rendererSwitchAttribute12, "display", "none")) : 2 === b ? (this.isTypeNumber(this.attributeItem) && this.isTypeNumber(this.attributeItem2) &&
                            3 < this.attributesCount.number ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"), x.set(this._rendererAttributeDiv3, "display", ""), x.set(this._rendererSwitchAttribute12, "display", "none")) : (this.showPredominance && 2 < this.attributesCount.number && this.isTypeNumber(this.attributeItem) || this.showDateFields && 2 < this.attributesCount.number + this.attributesCount.date ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"),
                            x.set(this._rendererAttributeDiv2, "display", ""));
                        this.adjustHeight();
                        this.updateAttributeDropdowns(a)
                    }
                },
                _onLayerDefaultStyleClick: function() {
                    var a, b = this.fLayer || this.layer,
                        b = this.hasDynamic ? this.fLayer.source.mapLayerId : parseInt(b.url.substring(b.url.lastIndexOf("/") + 1, b.url.length));
                    this.mapLayer.origItemLayers && (a = arcgisonline.map.main.getItemWithSourceMapLayerId(this.mapLayer.origItemLayers, b));
                    var c;
                    !this.hasDynamic && this.mapLayer.serviceInfo ? c = this.mapLayer.serviceInfo : this.hasDynamic && this.mapLayer.layersInfo &&
                        (c = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers, b));
                    a && a.layerDefinition && a.layerDefinition.drawingInfo && a.layerDefinition.drawingInfo.renderer ? this.renderer = esri.renderer.fromJson(g.clone(a.layerDefinition.drawingInfo.renderer)) : c && (this.renderer = esri.renderer.fromJson(g.clone(c.drawingInfo.renderer)), this.hasDynamic && (c.drawingInfo.renderer = this.renderer.toJson()));
                    this.scheme = null;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    delete this.mapLayer._featureTemplatesChanged;
                    this.applySimpleRenderer(this.renderer);
                    this.updateUIWithRenderer();
                    x.set(this._rendererDefaultStyle, "display", "none")
                },
                changeAttributes: function(a) { 1 === a ? this.changeAttribute() : 2 === a ? this.changeAttribute2() : 3 === a ? this.changeAttribute3() : this.changeAttributes4AndUp(a) },
                changeAttribute: function(a) {
                    if (!this.disableAllEvents)
                        if (delete this.allUniqueValues, delete this.attributeItem, this.clearSavedRenderers(), a = this._rendererAttribute.get("value"),
                            "showLocationOnly" === a) delete this.attributeItem10, delete this.attributeItem9, delete this.attributeItem8, delete this.attributeItem7, delete this.attributeItem6, delete this.attributeItem5, delete this.attributeItem4, delete this.attributeItem3, delete this.attributeItem2, c.forEach(this._rendererAttributeDivs, function(a) { a && x.set(a, "display", "none") }), x.set(this._rendererAddAttribute, "display", "none"), x.set(this._rendererSwitchAttribute12, "display", "none"), this.adjustHeight(), this.updateListQueue();
                        else {
                            var b =
                                dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                            this.attributesStore.fetchItemByIdentity({
                                identity: a,
                                onItem: g.hitch(this, function(a) {
                                    var d = a;
                                    this.attributeItem = a = this.clean(a);
                                    if (!this.style || !this.setupStyleFromURL())
                                        if ("multiple" === this.attributeItem.type.toString()) b[2] && this._onRemoveAttributeClick(2);
                                        else if (a.codedValues) 0 < this.attributesCount.number && (b[2] || this.hasDynamic && !this.newDMS ? this.updateAttributeDropdowns() : x.set(this._rendererAddAttribute,
                                        "display", ""));
                                    else if (("esriFieldTypeInteger" === this.attributeItem.type || "esriFieldTypeDouble" === this.attributeItem.type || "esriFieldTypeSingle" === this.attributeItem.type || "esriFieldTypeSmallInteger" === this.attributeItem.type) && this.layer.objectIdField !== this.attributeItem.name)
                                        if (b[2]) this.updateAttributeDropdowns();
                                        else { if (!this.hasDynamic || this.newDMS) x.set(this._rendererAddAttribute, "display", ""), this.adjustHeight() }
                                    else if ("esriFieldTypeDate" === a.type) {
                                        if (b[10] && this._onRemoveAttributeClick(10),
                                            b[9] && this._onRemoveAttributeClick(9), b[8] && this._onRemoveAttributeClick(8), b[7] && this._onRemoveAttributeClick(7), b[6] && this._onRemoveAttributeClick(6), b[5] && this._onRemoveAttributeClick(5), b[4] && this._onRemoveAttributeClick(4), b[3] && this._onRemoveAttributeClick(3), x.set(this._rendererAddAttribute, "display", "none"), 0 < this.attributesCount.number + this.attributesCount.date)
                                            if (b[2]) this.updateAttributeDropdowns();
                                            else if (!this.hasDynamic || this.newDMS) x.set(this._rendererAddAttribute, "display", ""), this.adjustHeight()
                                    } else if ("customExpr" ===
                                        a.type) this.attributeItem.valueExpression ? (x.set(this._rendererEditExpression, "display", ""), delete this.attributeItem3, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 3 <= b && a && x.set(a, "display", "none") }), b[2] ? (x.set(this._rendererAddAttribute, "display", "none"), this.updateListQueue(), this.updateAttributeDropdowns()) :
                                        x.set(this._rendererAddAttribute, "display", "")) : (this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                        "esriFieldTypeDouble" !== a.returnType && this.attributeItem2 && !this.isNumber(this.attributeItem2) ? this.updateUIWithRenderer() : (this.attributesStore.setValue(d, "valueExpression", a.expression), this.attributesStore.setValue(d, "valueExpressionReturnType", a.returnType), this.attributesStore.setValue(d, "valueExpressionTitle", a.title), this.attributesStore.setValue(d, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom })), this.attributeItem.valueExpression = a.expression, this.attributeItem.valueExpressionReturnType = a.returnType, this.attributeItem.valueExpressionTitle = a.title, delete this.attributeItem3, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 3 <= b && a && x.set(a, "display", "none") }), this.updateListQueue(),
                                            this.adjustHeight())
                                    }), g.hitch(this, function() { this.updateUIWithRenderer() })), this.queueHandler && clearTimeout(this.queueHandler), delete this.queueHandler);
                                    else if (0 < this.attributesCount.number)
                                        if (b[2]) "esriFieldTypeString" == this.attributeItem2.type ? (this._onRemoveAttributeClick(2), b[10] && this._onRemoveAttributeClick(10), b[9] && this._onRemoveAttributeClick(9), b[8] && this._onRemoveAttributeClick(8), b[7] && this._onRemoveAttributeClick(7), b[6] && this._onRemoveAttributeClick(6), b[5] && this._onRemoveAttributeClick(5),
                                            b[4] && this._onRemoveAttributeClick(4), b[3] && this._onRemoveAttributeClick(3)) : (b[10] && this._onRemoveAttributeClick(10), b[9] && this._onRemoveAttributeClick(9), b[8] && this._onRemoveAttributeClick(8), b[7] && this._onRemoveAttributeClick(7), b[6] && this._onRemoveAttributeClick(6), b[5] && this._onRemoveAttributeClick(5), b[4] && this._onRemoveAttributeClick(4), b[3] && this._onRemoveAttributeClick(3), x.set(this._rendererAddAttribute, "display", "none")), this.updateAttributeDropdowns();
                                        else if (!this.hasDynamic || this.newDMS) x.set(this._rendererAddAttribute,
                                        "display", ""), this.adjustHeight()
                                })
                            })
                        }
                },
                changeAttribute2: function(a) {
                    delete this.attributeItem2;
                    delete this.allUniqueValues;
                    this.clearSavedRenderers();
                    var b = dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererAttribute2.get("value"),
                        onItem: g.hitch(this, function(a) {
                            var d = a;
                            this.attributeItem2 = a = this.clean(a);
                            this.updateAttributeDropdowns();
                            "customExpr2" === this.attributeItem2.type ? this.attributeItem2.valueExpression ?
                                (x.set(this._rendererEditExpression2, "display", ""), delete this.attributeItem3, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 3 <= b && a && x.set(a, "display", "none") }), x.set(this._rendererAddAttribute, "display", "none"), this.updateListQueue()) : (this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    "esriFieldTypeDouble" !==
                                    a.returnType && this.attributeItem && !this.isNumber(this.attributeItem) ? this.updateUIWithRenderer() : (this.attributesStore.setValue(d, "valueExpression", a.expression), this.attributesStore.setValue(d, "valueExpressionReturnType", a.returnType), this.attributesStore.setValue(d, "valueExpressionTitle", a.title), this.attributesStore.setValue(d, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom })), this._rendererAttribute2.setStore(this.attributesStore, this._rendererAttribute2.get("value"), { query: this._rendererAttribute2.query }, !1), this.attributeItem2.valueExpression = a.expression, this.attributeItem2.valueExpressionReturnType = a.returnType, this.attributeItem2.valueExpressionTitle = a.title, delete this.attributeItem3, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 3 <= b && a && x.set(a, "display", "none") }),
                                        this.updateListQueue(), this.adjustHeight())
                                }), g.hitch(this, function() { this.updateUIWithRenderer() })), this.queueHandler && clearTimeout(this.queueHandler), delete this.queueHandler) : !this.attributeItem3 && (this.isTypeString(this.attributeItem) || this.isTypeString(this.attributeItem2) || this.attributeItem.codedValues || this.attributeItem2.codedValues) ? (x.set(this._rendererSwitchAttribute12, "display", "none"), x.set(this._rendererAddAttribute, "display", "none")) : this.attributeItem3 ? this.isTypeString(this.attributeItem) ||
                                this.isTypeString(this.attributeItem2) || this.attributeItem.codedValues || this.attributeItem2.codedValues || this.isTypeDate(this.attributeItem) || this.isTypeDate(this.attributeItem2) ? (b[10] && this._onRemoveAttributeClick(10), b[9] && this._onRemoveAttributeClick(9), b[8] && this._onRemoveAttributeClick(8), b[7] && this._onRemoveAttributeClick(7), b[6] && this._onRemoveAttributeClick(6), b[5] && this._onRemoveAttributeClick(5), b[4] && this._onRemoveAttributeClick(4), b[3] && this._onRemoveAttributeClick(3), x.set(this._rendererAddAttribute,
                                    "display", "none"), this.attributeItem.name !== this.attributeItem2.name ? x.set(this._rendererSwitchAttribute12, "display", "") : x.set(this._rendererSwitchAttribute12, "display", "none")) : x.set(this._rendererSwitchAttribute12, "display", "none") : (this.attributeItem.name !== this.attributeItem2.name ? x.set(this._rendererSwitchAttribute12, "display", "") : x.set(this._rendererSwitchAttribute12, "display", "none"), 2 < this.attributesCount.number && this.isTypeNumber(this.attributeItem) && this.isTypeNumber(this.attributeItem2) &&
                                    this.attributeItem.name !== this.attributeItem2.name && !b[3] ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"));
                            this.adjustHeight()
                        })
                    })
                },
                changeAttribute3: function(a) {
                    delete this.attributeItem3;
                    delete this.allUniqueValues;
                    this.clearSavedRenderers();
                    var b = dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererAttribute3.get("value"),
                        onItem: g.hitch(this,
                            function(a) {
                                var d = a;
                                this.attributeItem3 = a = this.clean(a);
                                this.updateAttributeDropdowns();
                                "customExpr3" === this.attributeItem3.type ? this.attributeItem3.valueExpression ? (x.set(this._rendererEditExpression3, "display", ""), delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 4 <= b && a && x.set(a, "display", "none") }), x.set(this._rendererAddAttribute,
                                    "display", "none"), this.updateListQueue()) : (this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    "esriFieldTypeDouble" !== a.returnType ? this.updateUIWithRenderer() : (this.attributesStore.setValue(d, "valueExpression", a.expression), this.attributesStore.setValue(d, "valueExpressionReturnType", a.returnType), this.attributesStore.setValue(d, "valueExpressionTitle", a.title), this.attributesStore.setValue(d, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom })), this._rendererAttribute3.setStore(this.attributesStore,
                                        this._rendererAttribute3.get("value"), { query: this._rendererAttribute3.query }, !1), this.attributeItem3.valueExpression = a.expression, this.attributeItem3.valueExpressionReturnType = a.returnType, this.attributeItem3.valueExpressionTitle = a.title, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) {
                                        4 <= b && a && x.set(a, "display",
                                            "none")
                                    }), this.updateListQueue(), this.adjustHeight())
                                }), g.hitch(this, function() { this.updateUIWithRenderer() })), this.queueHandler && clearTimeout(this.queueHandler), delete this.queueHandler) : this.attributeItem4 ? this.isTypeString(this.attributeItem) || this.isTypeString(this.attributeItem2) || this.attributeItem.codedValues || this.attributeItem2.codedValues || this.isTypeDate(this.attributeItem) || this.isTypeDate(this.attributeItem2) ? (b[10] && this._onRemoveAttributeClick(10), b[9] && this._onRemoveAttributeClick(9),
                                    b[8] && this._onRemoveAttributeClick(8), b[7] && this._onRemoveAttributeClick(7), b[6] && this._onRemoveAttributeClick(6), b[5] && this._onRemoveAttributeClick(5), b[4] && this._onRemoveAttributeClick(4), b[3] && this._onRemoveAttributeClick(3), x.set(this._rendererAddAttribute, "display", "none"), this.attributeItem.name !== this.attributeItem2.name ? x.set(this._rendererSwitchAttribute12, "display", "") : x.set(this._rendererSwitchAttribute12, "display", "none")) : x.set(this._rendererSwitchAttribute12, "display", "none") : (this.attributeItem.name !==
                                    this.attributeItem2.name ? x.set(this._rendererSwitchAttribute12, "display", "") : x.set(this._rendererSwitchAttribute12, "display", "none"), this.showPredominance && 3 < this.attributesCount.number && this.isTypeNumber(this.attributeItem) && this.isTypeNumber(this.attributeItem2) && this.isTypeNumber(this.attributeItem3) && this.attributeItem.name !== this.attributeItem2.name && !b[4] ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"));
                                this.adjustHeight()
                            })
                    })
                },
                changeAttributes4AndUp: function(a) {
                    switch (a) {
                        case 1:
                            delete this.attributeItem;
                            break;
                        case 2:
                            delete this.attributeItem2;
                            break;
                        case 3:
                            delete this.attributeItem3;
                            break;
                        case 4:
                            delete this.attributeItem4;
                            break;
                        case 5:
                            delete this.attributeItem5;
                            break;
                        case 6:
                            delete this.attributeItem6;
                            break;
                        case 7:
                            delete this.attributeItem7;
                            break;
                        case 8:
                            delete this.attributeItem8;
                            break;
                        case 9:
                            delete this.attributeItem9;
                            break;
                        case 10:
                            delete this.attributeItem10
                    }
                    delete this.allUniqueValues;
                    this.clearSavedRenderers();
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererAttributes[a].get("value"),
                        onItem: g.hitch(this, function(b) {
                            b = this.clean(b);
                            switch (a) {
                                case 1:
                                    this.attributeItem = b;
                                    break;
                                case 2:
                                    this.attributeItem2 = b;
                                    break;
                                case 3:
                                    this.attributeItem3 = b;
                                    break;
                                case 4:
                                    this.attributeItem4 = b;
                                    break;
                                case 5:
                                    this.attributeItem5 = b;
                                    break;
                                case 6:
                                    this.attributeItem6 = b;
                                    break;
                                case 7:
                                    this.attributeItem7 = b;
                                    break;
                                case 8:
                                    this.attributeItem8 = b;
                                    break;
                                case 9:
                                    this.attributeItem9 = b;
                                    break;
                                case 10:
                                    this.attributeItem10 = b
                            }
                            this.updateAttributeDropdowns()
                        })
                    })
                },
                updateAttributeDropdowns: function(b) {
                    if (this.attributeItem) {
                        b =
                            dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                        if (this.isString(this.attributeItem))
                            if (delete this.attributeItem3, delete this.attributeItem4, delete this.attributeItem5, delete this.attributeItem6, delete this.attributeItem7, delete this.attributeItem8, delete this.attributeItem9, delete this.attributeItem10, c.forEach(this._rendererAttributeDivs, function(a, b) { 3 <= b && a && x.set(a, "display", "none") }), x.set(this._rendererAddAttribute, "display", "none"), this.attributeItem2) this.isString(this.attributeItem2) ?
                                (delete this.attributeItem2, x.set(this._rendererAttributeDiv2, "display", "none"), x.set(this._rendererAddAttribute, "display", ""), this.adjustHeight()) : (this._rendererAttribute2.setStore(this.attributesStore, "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " + (this.showDateFields ? "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "'" }),
                                    this._rendererAttribute2.set("value", this.attributeItem2.name));
                            else if (b[2]) {
                            var d = this._rendererAttribute2.get("value");
                            this._rendererAttribute2.setStore(this.attributesStore, "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " + (this.showDateFields ? "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "'" });
                            this._rendererAttribute2.options[0].value ===
                                d && this._onChangeAttribute2(this._rendererAttribute2.get("value"))
                        } else x.set(this._rendererAddAttribute, "display", ""), this.adjustHeight();
                        else if (!this.attributeItem2 || this.attributeItem2 && !this.attributeItem3) this._rendererAttribute2.setStore(this.attributesStore, "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " + (this.showDateFields ? "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT name:'" + this.layer.objectIdField + "'" }), this.attributeItem2 ?
                            this._rendererAttribute2.set("value", this.attributeItem2.name) : this._rendererAttribute2.options[0].value === this.attributeItem.name && 1 < this._rendererAttribute2.options.length ? this._rendererAttribute2.set("value", this._rendererAttribute2.options[1].value) : this._onChangeAttribute2(this._rendererAttribute2.get("value")), this.attributeItem2 && !this.attributeItem3 && b[3] ? (d = this._rendererAttribute3.options.length ? this._rendererAttribute3.options[0].value : null, this._rendererAttribute3.setStore(this.attributesStore,
                                "", { query: this.notSpecialItemsQuery + this.thirdQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "'" }), d && this._rendererAttribute3.options[0].value === d && this._onChangeAttribute3(this._rendererAttribute3.get("value"))) : this.attributeItem && this.attributeItem2 && (this.attributeItem.name === this.attributeItem2.name || this.isString(this.attributeItem) ||
                                this.isString(this.attributeItem2) ? x.set(this._rendererSwitchAttribute12, "display", "none") : x.set(this._rendererSwitchAttribute12, "display", ""), "customExpr" !== this.attributeItem.name && "customExpr" !== this.attributeItem2.name && 2 < this.attributesCount.number && this.isTypeNumber(this.attributeItem) && this.isTypeNumber(this.attributeItem2) ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"));
                        else if (this._rendererAttribute2.setStore(this.attributesStore, "", {
                                query: this.notSpecialItemsQuery +
                                    this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'"
                            }), this.adjustHeight(), this.attributeItem2 ? this.isString(this.attributeItem2) && "customExpr2" !== this.attributeItem2.type ? (delete this.attributeItem2, this._onChangeAttribute2(this._rendererAttribute2.get("value"))) : this._rendererAttribute2.set("value",
                                this.attributeItem2.name) : this._onChangeAttribute2(this._rendererAttribute2.get("value")), b[3] && "customExpr" !== this.attributeItem.type && "customExpr2" !== this.attributeItem2.type) {
                            var e = this._rendererAttribute3.get("value"),
                                f = this.notSpecialItemsQuery + this.thirdQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "'";
                            b[4] && (f += " AND NOT name:'" +
                                this.attributeItem.name + "' AND NOT name:'" + this.attributeItem2.name + "'");
                            this._rendererAttribute3.setStore(this.attributesStore, "", { query: f });
                            this.adjustHeight();
                            this.attributeItem3 && (this._rendererAttribute3.set("value", this.attributeItem3.name), e && this._rendererAttribute3.options[0].value === e && this._onChangeAttribute3(this.attributeItem3.name));
                            if (b[4]) {
                                var f = this.notSpecialItemsQuery + this.notFirstToThirdQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" +
                                    this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "' AND NOT name:'" + this.attributeItem2.name + "'",
                                    d = this._rendererAttribute4.get("value"),
                                    g = this.attributeItem.name === d || this.attributeItem2.name === d || e === d ? "" : d,
                                    f = f + (" AND NOT name:'" + e + "'");
                                this._rendererAttribute4.setStore(this.attributesStore, g, { query: f });
                                this.adjustHeight();
                                g = g.length ? g : this._rendererAttribute4.options[0].value;
                                d && this._rendererAttribute4.options[0].value === d && this._onChangeAttribute4(this._rendererAttribute4.get("value"));
                                if (b[5]) {
                                    var d = this._rendererAttribute5.get("value"),
                                        h = this.attributeItem.name === d || this.attributeItem2.name === d || e === d || g === d ? "" : d,
                                        f = f + (" AND NOT name:'" + g + "'");
                                    this._rendererAttribute5.setStore(this.attributesStore, h, { query: f });
                                    this.adjustHeight();
                                    h = h.length ? h : this._rendererAttribute5.options[0].value;
                                    d && this._rendererAttribute5.options[0].value === d && this._onChangeAttribute5(this._rendererAttribute5.get("value"));
                                    if (b[6]) {
                                        var d = this._rendererAttribute6.get("value"),
                                            m = this.attributeItem.name === d ||
                                            this.attributeItem2.name === d || e === d || g === d || h === d ? "" : d,
                                            f = f + (" AND NOT name:'" + h + "'");
                                        this._rendererAttribute6.setStore(this.attributesStore, m, { query: f });
                                        this.adjustHeight();
                                        m = m.length ? m : this._rendererAttribute6.options[0].value;
                                        d && this._rendererAttribute6.options[0].value === d && this._onChangeAttribute6(this._rendererAttribute6.get("value"));
                                        if (b[7]) {
                                            var d = this._rendererAttribute7.get("value"),
                                                n = this.attributeItem.name === d || this.attributeItem2.name === d || e === d || g === d || h === d || m === d ? "" : d,
                                                f = f + (" AND NOT name:'" +
                                                    m + "'");
                                            this._rendererAttribute7.setStore(this.attributesStore, n, { query: f });
                                            this.adjustHeight();
                                            n = n.length ? n : this._rendererAttribute7.options[0].value;
                                            d && this._rendererAttribute7.options[0].value === d && this._onChangeAttribute7(this._rendererAttribute7.get("value"));
                                            if (b[8]) {
                                                var d = this._rendererAttribute8.get("value"),
                                                    q = this.attributeItem.name === d || this.attributeItem2.name === d || e === d || g === d || h === d || m === d || n === d ? "" : d,
                                                    f = f + (" AND NOT name:'" + n + "'");
                                                this._rendererAttribute8.setStore(this.attributesStore,
                                                    q, { query: f });
                                                this.adjustHeight();
                                                q = q.length ? q : this._rendererAttribute8.options[0].value;
                                                d && this._rendererAttribute8.options[0].value === d && this._onChangeAttribute8(this._rendererAttribute8.get("value"));
                                                if (b[9]) {
                                                    var d = this._rendererAttribute9.get("value"),
                                                        p = this.attributeItem.name === d || this.attributeItem2.name === d || e === d || g === d || h === d || m === d || n === d || q === d ? "" : d,
                                                        f = f + (" AND NOT name:'" + q + "'");
                                                    this._rendererAttribute9.setStore(this.attributesStore, p, { query: f });
                                                    this.adjustHeight();
                                                    p = p.length ? p : this._rendererAttribute9.options[0].value;
                                                    d && this._rendererAttribute9.options[0].value === d && this._onChangeAttribute9(this._rendererAttribute9.get("value"));
                                                    b[10] && (d = this._rendererAttribute10.get("value"), this._rendererAttribute10.setStore(this.attributesStore, this.attributeItem.name === d || this.attributeItem2.name === d || e === d || g === d || h === d || m === d || n === d || q === d || p === d ? "" : d, { query: f + (" AND NOT name:'" + p + "'") }), this.adjustHeight(), d && this._rendererAttribute10.options[0].value === d && this._onChangeAttribute10(this._rendererAttribute10.get("value")))
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        a.publish("updateAttributeDropdownsFinished")
                    }
                },
                _onRemoveAttributeClick: function(a) {
                    this.clearSavedRenderers();
                    delete this.allUniqueValues;
                    3 > a && this.attributeItem3 && (this.attributeItem2 = this.attributeItem3, "customExpr3" === this.attributeItem2.name && this.attributesStore.fetchItemByIdentity({
                        identity: "customExpr2",
                        onItem: g.hitch(this, function(a) {
                            this.attributesStore.setValue(a, "valueExpression", this.attributeItem3.valueExpression);
                            this.attributesStore.setValue(a, "valueExpressionReturnType", this.attributeItem3.valueExpressionReturnType);
                            this.attributesStore.setValue(a,
                                "valueExpressionTitle", this.attributeItem3.valueExpressionTitle);
                            this.attributesStore.setValue(a, "displayName", this.attributeItem3.displayName);
                            this.attributeItem2 = this.clean(a);
                            this._rendererAttribute2.set("value", this.attributeItem2.name)
                        })
                    }));
                    4 > a && this.attributeItem4 && (this.attributeItem3 = this.attributeItem4, this._rendererAttribute3.set("value", this.attributeItem3.name));
                    5 > a && this.attributeItem5 && (this.attributeItem4 = this.attributeItem5, this._rendererAttribute4.set("value", this.attributeItem4.name));
                    6 > a && this.attributeItem6 && (this.attributeItem5 = this.attributeItem6, this._rendererAttribute5.set("value", this.attributeItem5.name));
                    7 > a && this.attributeItem7 && (this.attributeItem6 = this.attributeItem7, this._rendererAttribute6.set("value", this.attributeItem6.name));
                    8 > a && this.attributeItem8 && (this.attributeItem7 = this.attributeItem8, this._rendererAttribute7.set("value", this.attributeItem7.name));
                    9 > a && this.attributeItem9 && (this.attributeItem8 = this.attributeItem9, this._rendererAttribute8.set("value", this.attributeItem8.name));
                    10 > a && this.attributeItem10 && (this.attributeItem9 = this.attributeItem10, this._rendererAttribute9.set("value", this.attributeItem9.name));
                    this.attributeItem10 ? (delete this.attributeItem10, x.set(this._rendererAttributeDiv10, "display", "none")) : this.attributeItem9 ? (delete this.attributeItem9, x.set(this._rendererAttributeDiv9, "display", "none")) : this.attributeItem8 ? (delete this.attributeItem8, x.set(this._rendererAttributeDiv8, "display", "none")) : this.attributeItem7 ? (delete this.attributeItem7, x.set(this._rendererAttributeDiv7,
                        "display", "none")) : this.attributeItem6 ? (delete this.attributeItem6, x.set(this._rendererAttributeDiv6, "display", "none")) : this.attributeItem5 ? (delete this.attributeItem5, x.set(this._rendererAttributeDiv5, "display", "none")) : this.attributeItem4 ? (delete this.attributeItem4, x.set(this._rendererAttributeDiv4, "display", "none")) : this.attributeItem3 ? (delete this.attributeItem3, x.set(this._rendererAttributeDiv3, "display", "none"), this.attributeItem.name !== this.attributeItem2.name ? x.set(this._rendererSwitchAttribute12,
                        "display", "") : x.set(this._rendererSwitchAttribute12, "display", "none")) : this.attributeItem2 && (delete this.attributeItem2, x.set(this._rendererAttributeDiv2, "display", "none"), x.set(this._rendererSwitchAttribute12, "display", "none"));
                    x.set(this._rendererAddAttribute, "display", "");
                    this.changeAttributes(a - 1);
                    this.adjustHeight();
                    this.updateListQueue()
                },
                _onSwitchAttributeClick: function() {
                    this.clearSavedRenderers();
                    delete this.allUniqueValues;
                    if ("customExpr" === this.attributeItem.name || "customExpr2" === this.attributeItem2.name) this.attributesStore.fetchItemByIdentity({
                        identity: "customExpr",
                        onItem: g.hitch(this, function(b) {
                            var c = this.clean(b);
                            this.attributesStore.fetchItemByIdentity({
                                identity: "customExpr2",
                                onItem: g.hitch(this, function(d) {
                                    var e = this.clean(d);
                                    this.attributesStore.setValue(b, "valueExpression", e.valueExpression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", e.valueExpressionReturnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", e.valueExpressionTitle);
                                    this.attributesStore.setValue(b, "displayName", e.displayName);
                                    this.attributesStore.setValue(d, "valueExpression",
                                        c.valueExpression);
                                    this.attributesStore.setValue(d, "valueExpressionReturnType", c.valueExpressionReturnType);
                                    this.attributesStore.setValue(d, "valueExpressionTitle", c.valueExpressionTitle);
                                    this.attributesStore.setValue(d, "displayName", c.displayName);
                                    delete this.attributeItem;
                                    delete this.attributeItem2;
                                    var f = this._rendererAttribute.get("value");
                                    d = this._rendererAttribute2.get("value");
                                    var h = a.subscribe("updateAttributeDropdownsFinished", g.hitch(this, function() {
                                        a.unsubscribe(h);
                                        var b = "customExpr" === f ?
                                            "customExpr2" : f;
                                        this._rendererAttribute2.get("value") === b ? this.changeAttribute2(b) : this._rendererAttribute2.set("value", b)
                                    }));
                                    d = "customExpr2" === d ? "customExpr" : d;
                                    this._rendererAttribute.get("value") === d ? this.changeAttribute(d) : this._rendererAttribute.set("value", d)
                                })
                            })
                        })
                    });
                    else {
                        delete this.attributeItem;
                        delete this.attributeItem2;
                        var b = this._rendererAttribute.get("value"),
                            c = this._rendererAttribute2.get("value");
                        this._rendererAttribute.set("value", c);
                        var d = a.subscribe("updateAttributeDropdownsFinished",
                            g.hitch(this, function() {
                                a.unsubscribe(d);
                                this.attributeItem3 && (this.disableAllEvents = !0);
                                this._rendererAttribute2.set("value", b)
                            }));
                        this.attributeItem3 && setTimeout(g.hitch(this, function() {
                            this.disableAllEvents = !1;
                            this._onChangeAttribute2(this._rendererAttribute2.get("value"));
                            this._rendererAttribute3.set("value", this.attributeItem3.name)
                        }), 100)
                    }
                },
                _onEditExpressionClick: function() {
                    this.onClickExpressionEditor({ expression: this.attributeItem.valueExpression, title: this.attributeItem.valueExpressionTitle }).then(g.hitch(this,
                        function(a) {
                            "esriFieldTypeDouble" !== a.returnType && this.attributeItem2 && !this.isNumber(this.attributeItem2) ? this.updateUIWithRenderer() : this.attributesStore.fetchItemByIdentity({
                                identity: "customExpr",
                                onItem: g.hitch(this, function(b) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    if (this.attributeItem.valueExpression !== a.expression) this.savedRenderers = {}, this.attributeItem.valueExpression = a.expression, this.attributeItem.valueExpressionReturnType = a.returnType, this.attributeItem.valueExpressionTitle = a.title, this.updateListQueue();
                                    else {
                                        this.updateExpressionTitle(this.renderer, a.expression, this.attributeItem.valueExpressionTitle, a.title);
                                        this.setRenderer(this.renderer);
                                        for (key in this.savedRenderers) b = K.fromJson(g.clone(this.savedRenderers[key].renderer)),
                                            this.updateExpressionTitle(b, a.expression, this.attributeItem.valueExpressionTitle, a.title), this.savedRenderers[key].renderer = b.toJson();
                                        this.attributeItem.valueExpression = a.expression;
                                        this.attributeItem.valueExpressionReturnType = a.returnType;
                                        this.attributeItem.valueExpressionTitle = a.title
                                    }
                                    this.adjustHeight()
                                })
                            })
                        }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                },
                _onEditExpression2Click: function() {
                    this.onClickExpressionEditor({ expression: this.attributeItem2.valueExpression, title: this.attributeItem2.valueExpressionTitle }).then(g.hitch(this,
                        function(a) {
                            "esriFieldTypeDouble" !== a.returnType && this.attributeItem && !this.isNumber(this.attributeItem) ? this.updateUIWithRenderer() : this.attributesStore.fetchItemByIdentity({
                                identity: "customExpr2",
                                onItem: g.hitch(this, function(b) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this._rendererAttribute2.setStore(this.attributesStore, this._rendererAttribute2.get("value"), { query: this._rendererAttribute2.query }, !1);
                                    if (this.attributeItem2.valueExpression !== a.expression) this.savedRenderers = {}, this.attributeItem2.valueExpression = a.expression, this.attributeItem2.valueExpressionReturnType = a.returnType, this.attributeItem2.valueExpressionTitle = a.title, this.updateListQueue();
                                    else {
                                        this.updateExpressionTitle(this.renderer, a.expression, this.attributeItem2.valueExpressionTitle,
                                            a.title);
                                        for (key in this.savedRenderers) b = K.fromJson(g.clone(this.savedRenderers[key].renderer)), this.updateExpressionTitle(b, a.expression, this.attributeItem2.valueExpressionTitle, a.title), this.savedRenderers[key].renderer = b.toJson();
                                        this.attributeItem2.valueExpression = a.expression;
                                        this.attributeItem2.valueExpressionReturnType = a.returnType;
                                        this.attributeItem2.valueExpressionTitle = a.title
                                    }
                                    this.adjustHeight()
                                })
                            })
                        }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                },
                _onEditExpression3Click: function() {
                    this.onClickExpressionEditor({
                        expression: this.attributeItem3.valueExpression,
                        title: this.attributeItem3.valueExpressionTitle
                    }).then(g.hitch(this, function(a) {
                        "esriFieldTypeDouble" !== a.returnType ? this.updateUIWithRenderer() : this.attributesStore.fetchItemByIdentity({
                            identity: "customExpr3",
                            onItem: g.hitch(this, function(b) {
                                this.attributesStore.setValue(b, "valueExpression", a.expression);
                                this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                this.attributesStore.setValue(b, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                this._rendererAttribute3.setStore(this.attributesStore, this._rendererAttribute3.get("value"), { query: this._rendererAttribute3.query }, !1);
                                if (this.attributeItem3.valueExpression !== a.expression) this.savedRenderers = {}, this.attributeItem3.valueExpression = a.expression, this.attributeItem3.valueExpressionReturnType = a.returnType, this.attributeItem3.valueExpressionTitle = a.title, this.updateListQueue();
                                else {
                                    this.updateExpressionTitle(this.renderer, a.expression, this.attributeItem3.valueExpressionTitle,
                                        a.title);
                                    for (key in this.savedRenderers) b = K.fromJson(g.clone(this.savedRenderers[key].renderer)), this.updateExpressionTitle(b, a.expression, this.attributeItem3.valueExpressionTitle, a.title), this.savedRenderers[key].renderer = b.toJson();
                                    this.attributeItem3.valueExpression = a.expression;
                                    this.attributeItem3.valueExpressionReturnType = a.returnType;
                                    this.attributeItem3.valueExpressionTitle = a.title
                                }
                                this.adjustHeight()
                            })
                        })
                    }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                },
                updateAttributeDropdownsFromRenderer: function(a) {
                    this.getAttributeItem(a[0]).then(g.hitch(this,
                        function(b) {
                            this.attributeItem = b;
                            this._rendererAttribute.set("value", b.name);
                            this.getAttributeItem(a[1]).then(g.hitch(this, function(b) {
                                this.attributeItem2 = b;
                                2 === a.length ? this._rendererAttribute2.setStore(this.attributesStore, "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' " + (this.showDateFields ? "" : "AND NOT type:'esriFieldTypeDate' ") + "AND NOT name:'" + this.layer.objectIdField + "'" }) : this._rendererAttribute2.setStore(this.attributesStore,
                                    "", { query: this.notSpecialItemsQuery + this.secondQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" });
                                this._rendererAttribute2.set("value", this.attributeItem2.name);
                                x.set(this._rendererAttributeDiv2, "display", "");
                                2 === a.length ? (x.set(this._rendererSwitchAttribute12, "display", ""), 2 < this.attributesCount.number && this.isTypeNumber(this.attributeItem) &&
                                    this.isTypeNumber(this.attributeItem2) && x.set(this._rendererAddAttribute, "display", ""), delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox()) : (x.set(this._rendererSwitchAttribute12, "display", "none"), this.attributesCount.number <= a.length ? x.set(this._rendererAddAttribute, "display", "none") : x.set(this._rendererAddAttribute, "display", ""), this.getAttributeItem(a[2]).then(g.hitch(this, function(b) {
                                    this.attributeItem3 = b;
                                    var c = this.notSpecialItemsQuery + this.thirdQuery + "AND NOT type:'oid' AND NOT type:'geometry' AND NOT type:'date' AND NOT type:'string' AND NOT name:'" +
                                        this.layer.objectIdField + "'";
                                    this._rendererAttribute3.setStore(this.attributesStore, "", { query: c });
                                    this._rendererAttribute3.set("value", this.attributeItem3.name);
                                    x.set(this._rendererAttributeDiv3, "display", "");
                                    3 < a.length ? (c = this.notSpecialItemsQuery + this.notFirstToThirdQuery + "AND NOT type:'oid' AND NOT type:'geometry' AND NOT type:'date' AND NOT type:'string' AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "' AND NOT name:'" + this.attributeItem2.name + "'", this.getAttributeItem(a[3]).then(g.hitch(this,
                                        function(b) {
                                            this.attributeItem4 = b;
                                            c += " AND NOT name:'" + this.attributeItem3.name + "'";
                                            this._rendererAttribute4.setStore(this.attributesStore, "", { query: c });
                                            this._rendererAttribute4.set("value", this.attributeItem4.name);
                                            x.set(this._rendererAttributeDiv4, "display", "");
                                            4 < a.length ? this.getAttributeItem(a[4]).then(g.hitch(this, function(b) {
                                                this.attributeItem5 = b;
                                                c += " AND NOT name:'" + this.attributeItem4.name + "'";
                                                this._rendererAttribute5.setStore(this.attributesStore, "", { query: c });
                                                this._rendererAttribute5.set("value",
                                                    this.attributeItem5.name);
                                                x.set(this._rendererAttributeDiv5, "display", "");
                                                5 < a.length ? this.getAttributeItem(a[5]).then(g.hitch(this, function(b) {
                                                    this.attributeItem6 = b;
                                                    c += " AND NOT name:'" + this.attributeItem5.name + "'";
                                                    this._rendererAttribute6.setStore(this.attributesStore, "", { query: c });
                                                    this._rendererAttribute6.set("value", this.attributeItem6.name);
                                                    x.set(this._rendererAttributeDiv6, "display", "");
                                                    6 < a.length ? this.getAttributeItem(a[6]).then(g.hitch(this, function(b) {
                                                        this.attributeItem7 = b;
                                                        c += " AND NOT name:'" +
                                                            this.attributeItem6.name + "'";
                                                        this._rendererAttribute7.setStore(this.attributesStore, "", { query: c });
                                                        this._rendererAttribute7.set("value", this.attributeItem7.name);
                                                        x.set(this._rendererAttributeDiv7, "display", "");
                                                        7 < a.length ? this.getAttributeItem(a[7]).then(g.hitch(this, function(b) {
                                                            this.attributeItem8 = b;
                                                            c += " AND NOT name:'" + this.attributeItem7.name + "'";
                                                            this._rendererAttribute8.setStore(this.attributesStore, "", { query: c });
                                                            this._rendererAttribute8.set("value", this.attributeItem8.name);
                                                            x.set(this._rendererAttributeDiv8,
                                                                "display", "");
                                                            8 < a.length ? this.getAttributeItem(a[8]).then(g.hitch(this, function(b) {
                                                                this.attributeItem9 = b;
                                                                c += " AND NOT name:'" + this.attributeItem8.name + "'";
                                                                this._rendererAttribute9.setStore(this.attributesStore, "", { query: c });
                                                                this._rendererAttribute9.set("value", this.attributeItem9.name);
                                                                x.set(this._rendererAttributeDiv9, "display", "");
                                                                9 < a.length ? (x.set(this._rendererAddAttribute, "display", "none"), this.getAttributeItem(a[9]).then(g.hitch(this, function(a) {
                                                                    this.attributeItem10 = a;
                                                                    c += " AND NOT name:'" + this.attributeItem9.name +
                                                                        "'";
                                                                    this._rendererAttribute10.setStore(this.attributesStore, "", { query: c });
                                                                    this._rendererAttribute10.set("value", this.attributeItem10.name);
                                                                    x.set(this._rendererAttributeDiv10, "display", "");
                                                                    delete this.noSimple;
                                                                    this.buildList();
                                                                    this.setTypeOptions();
                                                                    this.selectTypeBox()
                                                                }))) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                                            })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                                        })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(),
                                                            this.selectTypeBox())
                                                    })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                                })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                            })) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                        }))) : (delete this.noSimple, this.buildList(), this.setTypeOptions(), this.selectTypeBox())
                                })))
                            }))
                        }))
                },
                setupStyleFromURL: function() {
                    this.buildList(this.style);
                    this.setTypeOptions();
                    if ("simple" === this.style) return this._select_simple(),
                        delete this.style, !0;
                    if ("type" === this.style && this.galleryList.isItemVisible("unique")) return this._select_unique(), delete this.style, !0;
                    if ("color" === this.style && this.galleryList.isItemVisible("color")) return this._select_color(), delete this.style, !0;
                    if ("size" === this.style && this.galleryList.isItemVisible("size")) return this._select_size(), delete this.style, !0;
                    if ("heatMap" === this.style && this.galleryList.isItemVisible("heatMap")) return this._select_heatMap(), delete this.style, !0;
                    delete this.style;
                    return !1
                },
                _select_simple: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("simple"), this.saveCurrentRenderer(), this.savedRenderers.simple ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.simple.renderer)), this.scheme = this.savedRenderers.simple.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applySimpleRenderer(this.renderer), this.setOpacity(this.savedRenderers.simple.opacity), this.checkAddAndSwitchIcons()) :
                        (this.scheme = null, this.buildSimpleRenderer().then(g.hitch(this, function(a) { "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.renderer = a, this.applySimpleRenderer(a), this.savedRenderers.simple = { renderer: a.toJson(), scheme: this.scheme }, this.checkAddAndSwitchIcons()) }), g.hitch(this, function() {
                            this.updateUIWithRenderer();
                            this.adjustHeight()
                        }))))
                },
                _select_unique: function(a) {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this,
                        function(b) {
                            this.attributeItem = b;
                            if (a) {
                                if (this.setTypeOptions(), this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("unique"), this.galleryList.disableOptionsButton("unique"), b = { rotationInfo: this.renderer.rotationInfo, rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, b = g.hitch(this, function(a) {
                                        if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                        else if (a.rotationInfoVisVar) {
                                            var b =
                                                this.renderer.visualVariables || [];
                                            b.push(a.rotationInfoVisVar);
                                            this.renderer.setVisualVariables(b)
                                        }
                                        a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                    }, b), a.types) {
                                    var d = this.renderer;
                                    "esriGeometryPolygon" === this.geometryType && c.forEach(this.renderer.infos, function(a) { a.symbol = this.convertMarkerToFillSymbol(a.symbol) }, this);
                                    var e = this.getVisualVariablesExceptType("sizeInfo", null, d.visualVariables);
                                    d.setVisualVariables(e);
                                    (e = this.getVisualVariablesExceptType("sizeInfo",
                                        null, d.authoringInfo.visualVariables)) && e.length ? d.authoringInfo.visualVariables = e : delete d.authoringInfo.visualVariables;
                                    this.authoringInfo = g.clone(d.authoringInfo);
                                    this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null;
                                    this.renderer = d;
                                    this.savedRenderers.unique = { renderer: d.toJson(), scheme: this.scheme };
                                    b();
                                    this.applyUniqueRenderer(d);
                                    this.galleryList.enableOptionsButton("unique");
                                    this.checkAddAndSwitchIcons()
                                }
                            } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("unique"), this.saveCurrentRenderer(),
                                this.savedRenderers.type ? (this.renderer = K.fromJson(g.clone(g.clone(this.savedRenderers.type.renderer))), this.scheme = this.savedRenderers.type.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyUniqueRenderer(this.renderer), this.setOpacity(this.savedRenderers.type.opacity), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildUniqueRenderer().then(g.hitch(this, function(a) {
                                    this.hideBusy();
                                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.lastUniqueDefaultLabel =
                                        this.lastUniqueDefaultSymbol = null, this.renderer = a, this.savedRenderers.type = { renderer: a.toJson(), scheme: this.scheme }, this.applyUniqueRenderer(a), this.checkAddAndSwitchIcons())
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    delete this.noSimple;
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        }))
                },
                _select_color: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(a) {
                        this.attributeItem =
                            a;
                        this.resetTypeOptionsClearCheck();
                        this.galleryList.selectItem("color");
                        this.saveCurrentRenderer();
                        if (this.savedRenderers.color) {
                            a = K.fromJson(g.clone(this.savedRenderers.color.renderer));
                            var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                            this.scheme = V.getSchemes({ theme: b && b.theme ? b.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                            this.renderer = this.updateSchemeOnColorRenderer({ scheme: this.scheme, renderer: a });
                            this.authoringInfo =
                                g.clone(this.renderer.authoringInfo);
                            this.applyColorRenderer(this.renderer);
                            (this.savedRenderers.color.scheme && this.savedRenderers.color.scheme.id === this.scheme.id || !this.savedRenderers.color.scheme) && this.setOpacity(this.savedRenderers.color.opacity);
                            this.checkAddAndSwitchIcons()
                        } else this.galleryList.disableOptionsButton("color"), this.scheme = null, this.buildColorRenderer({ classificationMethod: "natural-breaks" }).then(g.hitch(this, function(a) {
                            this.hideBusy();
                            "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                                (this.renderer = a = a.renderer, a.authoringInfo = this.authoringInfo ? g.clone(this.authoringInfo) : a.authoringInfo, this.savedRenderers.color = { renderer: a.toJson(), scheme: this.scheme }, this.applyColorRenderer(a), this.galleryList.enableOptionsButton("color"), this.checkAddAndSwitchIcons())
                        }), g.hitch(this, function() {
                            this.hideBusy();
                            delete this.noSimple;
                            this.updateUIWithRenderer();
                            this.adjustHeight()
                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                    }))
                },
                _select_size: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                        this.getAttributeItem().then(g.hitch(this, function(a) {
                            this.attributeItem = a;
                            this.resetTypeOptionsClearCheck();
                            this.galleryList.selectItem("size");
                            this.saveCurrentRenderer();
                            this.savedRenderers.size ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.size.renderer)), this.scheme = this.savedRenderers.size.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applySizeRenderer(this.renderer), this.setOpacity(this.savedRenderers.size.opacity), this.checkAddAndSwitchIcons()) : (this.scheme = null,
                                this.buildSizeRenderer({ classificationMethod: "natural-breaks" }).then(g.hitch(this, function(a) { this.hideBusy(); "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.renderer = a = a.renderer, a.authoringInfo = this.authoringInfo ? g.clone(this.authoringInfo) : a.authoringInfo, this.savedRenderers.size = { renderer: a.toJson(), scheme: this.scheme }, this.applySizeRenderer(a), this.checkAddAndSwitchIcons()) }), g.hitch(this, function() {
                                    this.hideBusy();
                                    delete this.noSimple;
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        }))
                },
                _select_heatMap: function() {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var a = g.hitch(this, function(a) {
                            this.resetTypeOptionsClearCheck();
                            this.layer.getFeatureReduction && this.layer.getFeatureReduction() && this.layer.setFeatureReduction(null);
                            this.galleryList.selectItem("heatMap");
                            this.saveCurrentRenderer();
                            this.savedRenderers.heatMap ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.heatMap.renderer)),
                                this.scheme = this.savedRenderers.heatMap.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyHeatMapRenderer(this.renderer), this.setOpacity(this.savedRenderers.heatMap.opacity), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildHeatMapRenderer(a).then(g.hitch(this, function(a) {
                                this.hideBusy();
                                "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.renderer = a, this.savedRenderers.heatMap = { renderer: a.toJson(), scheme: this.scheme }, this.applyHeatMapRenderer(a),
                                    this.checkAddAndSwitchIcons())
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        });
                        this.getAttributeItem().then(g.hitch(this, function(b) {
                            var c = {};
                            this.renderer instanceof C ? (this.attributeItem = b, c.field = this.attributeItem.name, a(c)) : "esriFieldTypeInteger" == b.type || "esriFieldTypeDouble" == b.type || "esriFieldTypeSingle" == b.type || "esriFieldTypeSmallInteger" == b.type ? this.hasDataNegativeValues(this.layer,
                                b).then(g.hitch(this, function(d) {
                                d || (this.attributeItem = b, c.field = this.attributeItem.name);
                                a(c)
                            })) : a(c)
                        }))
                    }
                },
                _select_predominance: function(a) {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var b = g.hitch(this, function() {
                                if (a) {
                                    this.setTypeOptions();
                                    this.resetTypeOptionsClearCheck();
                                    this.galleryList.selectItem("predominance");
                                    this.galleryList.disableOptionsButton("predominance");
                                    var b = {
                                            rotationInfo: this.renderer.rotationInfo,
                                            rotationInfoVisVar: this.getVisualVariableByType("rotationInfo",
                                                null, this.renderer.visualVariables),
                                            defaultSymbol: this.renderer.defaultSymbol,
                                            defaultLabel: this.renderer.defaultLabel
                                        },
                                        d = g.hitch(this, function(a) {
                                            if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                            else if (a.rotationInfoVisVar) {
                                                var b = this.renderer.visualVariables || [];
                                                b.push(a.rotationInfoVisVar);
                                                this.renderer.setVisualVariables(b)
                                            }
                                            a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                        }, b);
                                    if (a.types) {
                                        var e = this.renderer;
                                        this.buildPredominanceRenderer().then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                var b = [];
                                                c.forEach(e.infos, function(d) { c.forEach(a.renderer.infos, function(a) { a.value === d.value && (a.symbol = "esriGeometryPolygon" === this.geometryType ? this.switchSymbolKeepColor(a.symbol, d.symbol) : d.symbol, b.push(a)) }, this) }, this);
                                                var f = [];
                                                c.forEach(a.renderer.infos, function(a) { f.push(g.clone(a)) });
                                                c.forEach(f, function(b) { a.renderer.removeValue(b.value) },
                                                    this);
                                                c.forEach(b, function(b) { a.renderer.addValue({ value: b.value, symbol: b.symbol, label: b.label }) }, this);
                                                this.authoringInfo = g.clone(e.authoringInfo);
                                                e = a.renderer;
                                                e.authoringInfo = g.clone(this.authoringInfo);
                                                this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null;
                                                this.renderer = e;
                                                this.savedRenderers.predominance = { renderer: e.toJson(), scheme: this.scheme };
                                                d();
                                                this.applyPredominanceRenderer(e);
                                                this.galleryList.enableOptionsButton("predominance");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }
                                } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("predominance"), this.saveCurrentRenderer(), this.savedRenderers.predominance ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.predominance.renderer)), this.scheme = this.savedRenderers.predominance.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyPredominanceRenderer(this.renderer), this.setOpacity(this.savedRenderers.predominance.opacity),
                                    this.checkAddAndSwitchIcons()) : (this.galleryList.disableOptionsButton("predominance"), this.scheme = null, this.buildPredominanceRenderer().then(g.hitch(this, function(a) {
                                    this.hideBusy();
                                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && c.map(this.getPredominanceFieldList(), function(a) { return a.name }).toString() === this.authoringInfo.fields.toString() && (a = a.renderer, this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null, a.authoringInfo = g.clone(this.authoringInfo), this.renderer =
                                        a, this.savedRenderers.predominance = { renderer: a.toJson(), scheme: this.scheme }, this.applyPredominanceRenderer(a), this.galleryList.enableOptionsButton("predominance"), this.checkAddAndSwitchIcons())
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                            }),
                            d = dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                        this.getAttributeItem().then(g.hitch(this, function(a) {
                            this.attributeItem =
                                a;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(a) {
                                this.attributeItem2 = a;
                                d[3] ? this.getAttributeItem(null, 3).then(g.hitch(this, function(a) {
                                    this.attributeItem3 = a;
                                    d[4] ? this.getAttributeItem(null, 4).then(g.hitch(this, function(a) {
                                        this.attributeItem4 = a;
                                        d[5] ? this.getAttributeItem(null, 5).then(g.hitch(this, function(a) {
                                            this.attributeItem5 = a;
                                            d[6] ? this.getAttributeItem(null, 6).then(g.hitch(this, function(a) {
                                                this.attributeItem6 = a;
                                                d[7] ? this.getAttributeItem(null, 7).then(g.hitch(this, function(a) {
                                                    this.attributeItem7 =
                                                        a;
                                                    d[8] ? this.getAttributeItem(null, 8).then(g.hitch(this, function(a) {
                                                        this.attributeItem8 = a;
                                                        d[9] ? this.getAttributeItem(null, 9).then(g.hitch(this, function(a) {
                                                            this.attributeItem9 = a;
                                                            d[10] ? this.getAttributeItem(null, 10).then(g.hitch(this, function(a) {
                                                                this.attributeItem10 = a;
                                                                b()
                                                            })) : b()
                                                        })) : b()
                                                    })) : b()
                                                })) : b()
                                            })) : b()
                                        })) : b()
                                    })) : b()
                                })) : b()
                            }))
                        }))
                    }
                },
                _select_predominancesize: function(a) {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var b = g.hitch(this, function() {
                                if (a) {
                                    this.setTypeOptions();
                                    this.resetTypeOptionsClearCheck();
                                    this.galleryList.selectItem("predominancesize");
                                    this.galleryList.disableOptionsButton("predominancesize");
                                    var b = { rotationInfo: this.renderer.rotationInfo, rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel },
                                        d = g.hitch(this, function(a) {
                                            if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                            else if (a.rotationInfoVisVar) {
                                                var b = this.renderer.visualVariables || [];
                                                b.push(a.rotationInfoVisVar);
                                                this.renderer.setVisualVariables(b)
                                            }
                                            a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                        }, b);
                                    if (a.types) {
                                        var e = this.renderer;
                                        this.buildPredominanceRenderer({ includeSizeInfo: !0 }).then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                var b = [];
                                                c.forEach(e.infos, function(d) {
                                                    c.forEach(a.renderer.infos, function(a) {
                                                        a.value === d.value && (a.symbol =
                                                            "esriGeometryPolygon" === this.geometryType ? this.switchSymbolKeepColor(a.symbol, d.symbol) : d.symbol, b.push(a))
                                                    }, this)
                                                }, this);
                                                var f = [];
                                                c.forEach(a.renderer.infos, function(a) { f.push(g.clone(a)) });
                                                c.forEach(f, function(b) { a.renderer.removeValue(b.value) }, this);
                                                c.forEach(b, function(b) { a.renderer.addValue({ value: b.value, symbol: b.symbol, label: b.label }) }, this);
                                                this.authoringInfo = g.clone(e.authoringInfo);
                                                e = a.renderer;
                                                e.authoringInfo = g.clone(this.authoringInfo);
                                                this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol =
                                                    null;
                                                this.renderer = e;
                                                this.savedRenderers.predominancesize = { renderer: e.toJson(), scheme: this.scheme };
                                                d();
                                                this.applyPredominanceRenderer(e);
                                                this.galleryList.enableOptionsButton("predominancesize");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }
                                } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("predominancesize"), this.saveCurrentRenderer(), this.savedRenderers.predominancesize ?
                                    (this.renderer = K.fromJson(g.clone(this.savedRenderers.predominancesize.renderer)), this.scheme = this.savedRenderers.predominancesize.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyPredominanceRenderer(this.renderer), this.setOpacity(this.savedRenderers.predominancesize.opacity), this.checkAddAndSwitchIcons()) : (this.galleryList.disableOptionsButton("predominancesize"), this.scheme = null, this.buildPredominanceRenderer({ includeSizeInfo: !0 }).then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (a = a.renderer, this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null, a.authoringInfo = g.clone(this.authoringInfo), this.renderer = a, this.savedRenderers.predominancesize = { renderer: a.toJson(), scheme: this.scheme }, this.applyPredominanceRenderer(a), this.galleryList.enableOptionsButton("predominancesize"), this.checkAddAndSwitchIcons())
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }),
                                        g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                            }),
                            d = dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                        this.getAttributeItem().then(g.hitch(this, function(a) {
                            this.attributeItem = a;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(a) {
                                this.attributeItem2 = a;
                                d[3] ? this.getAttributeItem(null, 3).then(g.hitch(this, function(a) {
                                    this.attributeItem3 = a;
                                    d[4] ? this.getAttributeItem(null, 4).then(g.hitch(this, function(a) {
                                        this.attributeItem4 = a;
                                        d[5] ? this.getAttributeItem(null,
                                            5).then(g.hitch(this, function(a) {
                                            this.attributeItem5 = a;
                                            d[6] ? this.getAttributeItem(null, 6).then(g.hitch(this, function(a) {
                                                this.attributeItem6 = a;
                                                d[7] ? this.getAttributeItem(null, 7).then(g.hitch(this, function(a) {
                                                    this.attributeItem7 = a;
                                                    d[8] ? this.getAttributeItem(null, 8).then(g.hitch(this, function(a) {
                                                        this.attributeItem8 = a;
                                                        d[9] ? this.getAttributeItem(null, 9).then(g.hitch(this, function(a) {
                                                                this.attributeItem9 = a;
                                                                d[10] ? this.getAttributeItem(null, 10).then(g.hitch(this, function(a) {
                                                                    this.attributeItem10 = a;
                                                                    b()
                                                                })) : b()
                                                            })) :
                                                            b()
                                                    })) : b()
                                                })) : b()
                                            })) : b()
                                        })) : b()
                                    })) : b()
                                })) : b()
                            }))
                        }))
                    }
                },
                _select_colorsize: function(a) {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(b) {
                        this.attributeItem = b;
                        this.getAttributeItem(null, 2).then(g.hitch(this, function(b) {
                            this.attributeItem2 = b;
                            if (a) {
                                this.setTypeOptions();
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("colorsize");
                                this.galleryList.disableOptionsButton("colorsize");
                                b = {
                                    rotationInfo: this.renderer.rotationInfo,
                                    rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables),
                                    defaultSymbol: this.renderer.defaultSymbol,
                                    defaultLabel: this.renderer.defaultLabel
                                };
                                var d = g.hitch(this, function(a) {
                                    if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                    else if (a.rotationInfoVisVar) {
                                        var b = this.renderer.visualVariables || [];
                                        b.push(a.rotationInfoVisVar);
                                        this.renderer.setVisualVariables(b)
                                    }
                                    a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel =
                                        a.defaultLabel)
                                }, b);
                                if (a.colorInfo) this.isMultiAttributesRenderer = !0, this.scheme = null, this.buildSizeRenderer({ classificationMethod: "natural-breaks", attributeItem: this.isTypeString(this.attributeItem2) || this.attributeItem2.codedValues ? this.attributeItem : this.attributeItem2 }).then(g.hitch(this, function(b) {
                                    this.hideBusy();
                                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                        var e = b.renderer;
                                        this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                        a.authColorInfo && (e.authoringInfo =
                                            e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("colorInfo", null, a.authColorInfo, e.authoringInfo));
                                        a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, e.authoringInfo));
                                        if (b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) {
                                            var f =
                                                this.getVisualVariableByType("sizeInfo", null, e.visualVariables);
                                            f.minSize = b.minSize;
                                            f.maxSize = b.maxSize;
                                            this.replaceVisualVariable("sizeInfo", null, f, e)
                                        }
                                        this.authoringInfo = g.clone(e.authoringInfo);
                                        e.attributeField = "customExpr" !== this.attributeItem.name ? this.attributeItem.name : void 0;
                                        e.setValueExpression(this.attributeItem.valueExpression);
                                        e.normalizationField = a.colorInfo.normalizationField;
                                        e.normalizationType = a.colorInfo.normalizationType;
                                        f = this.renderer.infos[0].symbol;
                                        b = e.infos[0];
                                        "esriGeometryPolygon" ===
                                        this.geometryType ? (b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline), e.backgroundFillSymbol = e.backgroundFillSymbol || b.backgroundFillSymbol) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                        e.clearBreaks();
                                        e.addBreak(b);
                                        this.renderer = e;
                                        this.savedRenderers.colorsize = {
                                            renderer: e.toJson(),
                                            scheme: this.scheme
                                        };
                                        d();
                                        this.applySizeRenderer(e);
                                        this.galleryList.enableOptionsButton("colorsize");
                                        this.checkAddAndSwitchIcons()
                                    }
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }));
                                else {
                                    var e = this.renderer;
                                    "colorsize" === this.getRendererStyle(this.renderer) ? this.buildColorInfo({ classificationMethod: "natural-breaks", attributeItem: this.attributeItem, statistics: null, scheme: this.findColorScheme(this.renderer) }).then(g.hitch(this,
                                        function(a) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                                a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null;
                                                this.replaceVisualVariable("colorInfo", null, a, e.authoringInfo);
                                                this.authoringInfo = g.clone(e.authoringInfo);
                                                e.attributeField = "customExpr" !== this.attributeItem.name ? this.attributeItem.name : void 0;
                                                e.setValueExpression(this.attributeItem.valueExpression);
                                                e.normalizationField = null;
                                                e.normalizationType = null;
                                                a = this.renderer.infos[0].symbol;
                                                var b = e.infos[0];
                                                "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, a.style, a.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(a.style) : (b.symbol = b.symbol.setStyle(a.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], a.style) && b.symbol.setOutline(a.outline));
                                                e.clearBreaks();
                                                e.addBreak(b);
                                                this.renderer = e;
                                                this.savedRenderers.colorsize = { renderer: e.toJson(), scheme: this.scheme };
                                                d();
                                                this.applySizeRenderer(e);
                                                this.galleryList.enableOptionsButton("colorsize");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })) : (this.isMultiAttributesRenderer = !0, this.scheme = null, this.buildColorRenderer({
                                        classificationMethod: "natural-breaks",
                                        attributeItem: this.attributeItem,
                                        statistics: null,
                                        scheme: this.findColorScheme(this.renderer)
                                    }).then(g.hitch(this, function(b) {
                                        this.hideBusy();
                                        if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                            var e = b.renderer;
                                            this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, e);
                                            a.authSizeInfo && (e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a.authSizeInfo, e.authoringInfo));
                                            a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo,
                                                e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, e.authoringInfo));
                                            if (this.renderer.infos && this.renderer.infos.length) {
                                                var f = this.renderer.infos[0].symbol;
                                                b = e.infos[0];
                                                "esriGeometryPolygon" === this.geometryType ? (b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline), e.backgroundFillSymbol = this.renderer.backgroundFillSymbol || M.fromJson(this.transparentPolygonSymbolJson)) :
                                                    "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                                e.clearBreaks();
                                                e.addBreak(b)
                                            }
                                            this.authoringInfo = g.clone(e.authoringInfo);
                                            e.attributeField = "customExpr" !== this.attributeItem.name ? this.attributeItem.name : void 0;
                                            e.setValueExpression(this.attributeItem.valueExpression);
                                            this.renderer = e;
                                            this.savedRenderers.colorsize = { renderer: e.toJson(), scheme: this.scheme };
                                            d();
                                            this.applySizeRenderer(e);
                                            this.galleryList.enableOptionsButton("colorsize");
                                            this.checkAddAndSwitchIcons()
                                        }
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                                }
                            } else if (this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("colorsize"), this.galleryList.disableOptionsButton("colorsize"), this.saveCurrentRenderer(), this.savedRenderers.colorsize) {
                                b =
                                    K.fromJson(g.clone(this.savedRenderers.colorsize.renderer));
                                var f = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                                this.scheme = V.getSchemes({ theme: f && f.theme ? f.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                                this.renderer = e = this.updateSchemeOnColorRenderer({ scheme: this.scheme, renderer: b });
                                this.authoringInfo = g.clone(this.renderer.authoringInfo);
                                this.applyColorRenderer(this.renderer);
                                (this.savedRenderers.colorsize.scheme &&
                                    this.savedRenderers.colorsize.scheme.id === this.scheme.id || !this.savedRenderers.colorsize.scheme) && this.setOpacity(this.savedRenderers.colorsize.opacity);
                                this.galleryList.enableOptionsButton("colorsize");
                                this.checkAddAndSwitchIcons()
                            } else this.scheme = null, this.buildSizeRenderer({ classificationMethod: "natural-breaks", attributeItem: this.attributeItem2 }).then(g.hitch(this, function(a) {
                                var b = a.renderer;
                                this.buildColorInfo({
                                    classificationMethod: "natural-breaks",
                                    attributeItem: this.attributeItem,
                                    statistics: this.attributeItem2.name ===
                                        this.attributeItem.name ? a.statistics : null,
                                    scheme: null
                                }).then(g.hitch(this, function(a) {
                                    this.hideBusy();
                                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("colorInfo", null, a.colorInfo, b), a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null, this.replaceVisualVariable("colorInfo", null, a, this.authoringInfo), b.authoringInfo = g.clone(this.authoringInfo), b.attributeField = "customExpr" !== this.attributeItem.name ?
                                        this.attributeItem.name : void 0, b.setValueExpression(this.attributeItem.valueExpression), this.renderer = b, this.savedRenderers.colorsize = { renderer: b.toJson(), scheme: this.scheme }, this.applySizeRenderer(b), this.galleryList.enableOptionsButton("colorsize"), this.checkAddAndSwitchIcons())
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                        }))
                    }))
                },
                _select_uniquesize: function(a) {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(b) {
                        this.attributeItem = b;
                        this.getAttributeItem(null, 2).then(g.hitch(this, function(b) {
                            this.attributeItem2 = b;
                            if (a) {
                                this.setTypeOptions();
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("uniquesize");
                                this.galleryList.disableOptionsButton("uniquesize");
                                b = { rotationInfo: this.renderer.rotationInfo, rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel };
                                var d = g.hitch(this, function(a) {
                                    if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                    else if (a.rotationInfoVisVar) {
                                        var b = this.renderer.visualVariables || [];
                                        b.push(a.rotationInfoVisVar);
                                        this.renderer.setVisualVariables(b)
                                    }
                                    a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol =
                                        a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                }, b);
                                if (a.types) {
                                    var e = this.renderer;
                                    this.buildSizeInfo({ classificationMethod: "natural-breaks", attributeItem: this.getFieldForSizeRenderer(), statistics: null, scheme: null }).then(g.hitch(this, function(a) {
                                        this.hideBusy();
                                        if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                            if ("esriGeometryPolygon" === this.geometryType) {
                                                var b = e.infos.length && e.infos[0].symbol;
                                                b instanceof y || (b = null);
                                                c.forEach(e.infos, function(a) {
                                                    var c = b && M.fromJson(b.toJson());
                                                    a.symbol = this.convertFillToMarkerSymbol(a.symbol, b && c.style, b && c.outline)
                                                }, this);
                                                e.backgroundFillSymbol = e.backgroundFillSymbol || a.backgroundFillSymbol
                                            }
                                            this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, e);
                                            a = this.getVisualVariableByType("sizeInfo", null, a.authoringInfo.visualVariables);
                                            e.authoringInfo = e.authoringInfo || {};
                                            e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [];
                                            this.replaceVisualVariable("sizeInfo", null, a, e.authoringInfo);
                                            this.authoringInfo = g.clone(e.authoringInfo);
                                            this.lastUniqueDefaultLabel =
                                                this.lastUniqueDefaultSymbol = null;
                                            this.renderer = e;
                                            this.savedRenderers.uniquesize = { renderer: e.toJson(), scheme: this.scheme };
                                            d();
                                            this.applyUniqueRenderer(e);
                                            this.galleryList.enableOptionsButton("uniquesize");
                                            this.checkAddAndSwitchIcons()
                                        }
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                } else "colorsize" === this.getRendererStyle(this.renderer) ? (this.setTypeOptions(), this.resetTypeOptionsClearCheck(),
                                    this.galleryList.selectItem("uniquesize"), this.galleryList.disableOptionsButton("uniquesize"), this.scheme = null) : -1 < c.indexOf(["ageColorSize", "size"], this.getRendererStyle(this.renderer)) && (this.scheme = null), this.buildUniqueRenderer({ attributeItem: this.getFieldForUniqueRenderer() }).then(g.hitch(this, function(b) {
                                    this.buildSizeInfo({ classificationMethod: "natural-breaks", attributeItem: this.getFieldForSizeRenderer(), statistics: null, scheme: null }).then(g.hitch(this, function(e) {
                                        this.hideBusy();
                                        if ("rendererStack" ===
                                            arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                            this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, b);
                                            a.authSizeInfo && (b.authoringInfo = b.authoringInfo || {}, b.authoringInfo.visualVariables = b.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a.authSizeInfo, b.authoringInfo));
                                            var f = this.renderer.infos[0].symbol,
                                                h = [];
                                            c.forEach(b.infos, function(a) { h.push(g.clone(a)) });
                                            c.forEach(h, function(a) { b.removeValue(a.value) });
                                            c.forEach(h, function(a) {
                                                "esriGeometryPolygon" === this.geometryType ?
                                                    a.symbol = this.convertFillToMarkerSymbol(a.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? a.symbol = a.symbol.setStyle(f.style) : (a.symbol = a.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], a.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && a.symbol.setOutline(f.outline));
                                                b.addValue(a)
                                            }, this);
                                            a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, b), b.authoringInfo = b.authoringInfo || {}, b.authoringInfo.visualVariables = b.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, b.authoringInfo));
                                            this.authoringInfo = g.clone(b.authoringInfo);
                                            "esriGeometryPolygon" === this.geometryType && (c.forEach(b.infos, function(a) { a.symbol = this.convertFillToMarkerSymbol(a.symbol, f.style, f.outline) }, this), b.backgroundFillSymbol = e.backgroundFillSymbol);
                                            this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null;
                                            this.renderer = b;
                                            this.savedRenderers.uniquesize = { renderer: b.toJson(), scheme: this.scheme };
                                            d();
                                            this.applyUniqueRenderer(b);
                                            this.galleryList.enableOptionsButton("uniquesize");
                                            this.checkAddAndSwitchIcons()
                                        }
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                            } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("uniquesize"), this.galleryList.disableOptionsButton("uniquesize"),
                                this.saveCurrentRenderer(), this.savedRenderers.uniquesize ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.uniquesize.renderer)), this.scheme = this.savedRenderers.uniquesize.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyUniqueRenderer(this.renderer), this.setOpacity(this.savedRenderers.uniquesize.opacity), this.galleryList.enableOptionsButton("uniquesize"), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildUniqueRenderer({ attributeItem: this.getFieldForUniqueRenderer() }).then(g.hitch(this,
                                    function(a) {
                                        this.buildSizeInfo({ classificationMethod: "natural-breaks", attributeItem: this.getFieldForSizeRenderer(), statistics: null, scheme: null }).then(g.hitch(this, function(b) {
                                            this.hideBusy();
                                            "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("sizeInfo", null, b.sizeInfo, a), this.authoringInfo = b.authoringInfo, a.authoringInfo = g.clone(this.authoringInfo), "esriGeometryPolygon" === this.geometryType && (c.forEach(a.infos, function(a) { a.symbol = this.convertFillToMarkerSymbol(a.symbol) },
                                                this), a.backgroundFillSymbol = b.backgroundFillSymbol), this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null, this.renderer = a, this.savedRenderers.uniquesize = { renderer: a.toJson(), scheme: this.scheme }, this.applyUniqueRenderer(a), this.galleryList.enableOptionsButton("uniquesize"), this.checkAddAndSwitchIcons())
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        }))
                    }))
                },
                _select_relationship: function(a) {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var b = g.hitch(this, function() {
                            this.isMultiAttributesRenderer = !1;
                            if (a) {
                                this.setTypeOptions();
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("relationship");
                                this.galleryList.disableOptionsButton("relationship");
                                var b = {
                                        rotationInfo: this.renderer.rotationInfo,
                                        rotationInfoVisVar: this.getVisualVariableByType("rotationInfo",
                                            null, this.renderer.visualVariables),
                                        defaultSymbol: this.renderer.defaultSymbol,
                                        defaultLabel: this.renderer.defaultLabel
                                    },
                                    b = g.hitch(this, function(a) {
                                        if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                        else if (a.rotationInfoVisVar) {
                                            var b = this.renderer.visualVariables || [];
                                            b.push(a.rotationInfoVisVar);
                                            this.renderer.setVisualVariables(b)
                                        }
                                        a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                    }, b);
                                if (a.types) {
                                    var d = this.renderer,
                                        e = this.getVisualVariablesExceptType("sizeInfo", null, d.visualVariables);
                                    d.setVisualVariables(e);
                                    (e = this.getVisualVariablesExceptType("sizeInfo", null, d.authoringInfo.visualVariables)) && e.length ? d.authoringInfo.visualVariables = e : delete d.authoringInfo.visualVariables;
                                    this.authoringInfo = d.authoringInfo;
                                    if ("esriGeometryPolygon" === this.geometryType) {
                                        var f = [];
                                        c.forEach(d.infos, function(a) { f.push(g.clone(a)) });
                                        c.forEach(f, function(a) { d.removeValue(a.value) });
                                        c.forEach(f, function(a) {
                                            a.symbol = this.convertMarkerToFillSymbol(a.symbol);
                                            d.addValue(a)
                                        }, this)
                                    }
                                    this.renderer = d;
                                    this.savedRenderers.relationship = { renderer: d.toJson(), scheme: this.scheme };
                                    b();
                                    this.applyRelationshipRenderer(d);
                                    this.galleryList.enableOptionsButton("relationship");
                                    this.checkAddAndSwitchIcons()
                                }
                            } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("relationship"), this.saveCurrentRenderer(), this.savedRenderers.relationship ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.relationship.renderer)), this.scheme = this.savedRenderers.relationship.scheme,
                                this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyRelationshipRenderer(this.renderer), this.setOpacity(this.savedRenderers.relationship.opacity), this.checkAddAndSwitchIcons()) : (this.galleryList.disableOptionsButton("relationship"), this.scheme = null, this.buildRelationshipRenderer().then(g.hitch(this, function(a) {
                                this.hideBusy();
                                if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                    var b = this.getVisualVariableByType("sizeInfo", null, a.renderer.visualVariables);
                                    this.attributeItem.name !==
                                        this.authoringInfo.field1.field || this.attributeItem2.name !== this.authoringInfo.field2.field || this.attributeItem3 && !b || !this.attributeItem3 && b || this.attributeItem3 && b && "customExpr" === this.attributeItem3.type && !b.field || this.attributeItem3 && b && this.attributeItem3.name !== b.field || (a = a.renderer, this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null, a.authoringInfo = g.clone(this.authoringInfo), this.renderer = a, this.savedRenderers.relationship = { renderer: a.toJson(), scheme: this.scheme }, this.applyRelationshipRenderer(a),
                                            this.galleryList.enableOptionsButton("relationship"), this.checkAddAndSwitchIcons())
                                }
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        });
                        this.getAttributeItem().then(g.hitch(this, function(a) {
                            this.attributeItem = a;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(a) {
                                this.attributeItem2 = a;
                                b()
                            }))
                        }))
                    }
                },
                _select_relationshipSize: function(a) {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var b =
                            g.hitch(this, function() {
                                if (a) {
                                    this.setTypeOptions();
                                    this.resetTypeOptionsClearCheck();
                                    this.galleryList.selectItem("relationshipSize");
                                    this.galleryList.disableOptionsButton("relationshipSize");
                                    var b = { rotationInfo: this.renderer.rotationInfo, rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel },
                                        d = g.hitch(this, function(a) {
                                            if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                            else if (a.rotationInfoVisVar) {
                                                var b = this.renderer.visualVariables || [];
                                                b.push(a.rotationInfoVisVar);
                                                this.renderer.setVisualVariables(b)
                                            }
                                            a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                        }, b);
                                    if (a.types) {
                                        var e = this.renderer;
                                        this.scheme = null;
                                        this.buildSizeRenderer({ classificationMethod: "natural-breaks", attributeItem: this.attributeItem3 }).then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                var b =
                                                    this.getVisualVariableByType("sizeInfo", null, a.renderer.visualVariables),
                                                    f = this.getVisualVariableByType("sizeInfo", null, this.authoringInfo.visualVariables);
                                                this.replaceVisualVariable("sizeInfo", null, b, e);
                                                this.replaceVisualVariable("sizeInfo", null, f, e.authoringInfo);
                                                this.authoringInfo = g.clone(e.authoringInfo);
                                                if ("esriGeometryPolygon" === this.geometryType) {
                                                    var h = a.renderer.infos[0].symbol,
                                                        m = [];
                                                    c.forEach(e.infos, function(a) { m.push(g.clone(a)) });
                                                    c.forEach(m, function(a) { e.removeValue(a.value) });
                                                    c.forEach(m,
                                                        function(a) {
                                                            a.symbol = this.convertFillToMarkerSymbol(a.symbol, h.style, h.outline);
                                                            e.addValue(a)
                                                        }, this)
                                                }
                                                this.renderer = e;
                                                this.savedRenderers.relationshipSize = { renderer: this.renderer.toJson(), scheme: this.scheme };
                                                d();
                                                this.applyRelationshipRenderer(e);
                                                this.galleryList.enableOptionsButton("relationshipSize");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }
                                } else this.resetTypeOptionsClearCheck(),
                                    this.galleryList.selectItem("relationshipSize"), this.saveCurrentRenderer(), this.savedRenderers.relationshipSize ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.relationshipSize.renderer)), this.scheme = this.savedRenderers.relationshipSize.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyRelationshipRenderer(this.renderer), this.setOpacity(this.savedRenderers.relationshipSize.opacity), this.checkAddAndSwitchIcons()) : (this.galleryList.disableOptionsButton("relationshipSize"),
                                        this.scheme = null, this.buildSizeRenderer({ classificationMethod: "natural-breaks", attributeItem: this.attributeItem3 }).then(g.hitch(this, function(a) {
                                            var b = this.getVisualVariableByType("sizeInfo", null, a.renderer.visualVariables),
                                                d = this.getVisualVariableByType("sizeInfo", null, this.authoringInfo.visualVariables);
                                            this.scheme = null;
                                            this.buildRelationshipRenderer().then(g.hitch(this, function(e) {
                                                this.hideBusy();
                                                if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                    var f = e.renderer;
                                                    this.replaceVisualVariable("sizeInfo",
                                                        null, b, f);
                                                    this.replaceVisualVariable("sizeInfo", null, d, this.authoringInfo);
                                                    f.authoringInfo = g.clone(this.authoringInfo);
                                                    if ("esriGeometryPolygon" === this.geometryType) {
                                                        var h = a.renderer.infos[0].symbol,
                                                            m = [];
                                                        c.forEach(f.infos, function(a) { m.push(g.clone(a)) });
                                                        c.forEach(m, function(a) { f.removeValue(a.value) });
                                                        c.forEach(m, function(a) {
                                                            a.symbol = this.convertFillToMarkerSymbol(a.symbol, h.style, h.outline);
                                                            f.addValue(a)
                                                        }, this)
                                                    }
                                                    this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null;
                                                    this.renderer = f;
                                                    this.savedRenderers.relationshipSize = { renderer: f.toJson(), scheme: this.scheme };
                                                    this.applyRelationshipRenderer(f);
                                                    this.galleryList.enableOptionsButton("relationshipSize");
                                                    this.checkAddAndSwitchIcons()
                                                }
                                            }), g.hitch(this, function() {
                                                this.hideBusy();
                                                this.showPredominance && -1 === c.indexOf(["relationshipSize", "predominance", "predominancesize"], this.getRendererStyle(this.renderer)) ? this.attributeItem.name !== this.attributeItem3.name && this.attributeItem2.name !== this.attributeItem3.name || this._rendererAttribute3.setStore(this.attributesStore, "", {
                                                    query: this.notSpecialItemsQuery +
                                                        this.thirdQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT type:'esriFieldTypeString' AND NOT hasCodedValues:'true' AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "' AND NOT name:'" + this.attributeItem2.name + "'"
                                                }) : this.updateUIWithRenderer();
                                                this.adjustHeight()
                                            }), g.hitch(this, function(a) {}))
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this,
                                            function(a) { this.showBusy("rendererStack", a) })))
                            });
                        this.getAttributeItem().then(g.hitch(this, function(a) {
                            this.attributeItem = a;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(a) {
                                this.attributeItem2 = a;
                                this.getAttributeItem(null, 3).then(g.hitch(this, function(a) {
                                    this.attributeItem3 = a;
                                    b()
                                }))
                            }))
                        }))
                    }
                },
                _select_watercolor: function() {
                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                        var a = g.hitch(this, function() {
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("watercolor");
                                this.saveCurrentRenderer();
                                this.savedRenderers.watercolor ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.watercolor.renderer)), this.scheme = this.savedRenderers.watercolor.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applWatercolorRenderer(this.renderer), this.setOpacity(this.savedRenderers.watercolor.opacity)) : (this.scheme = null, this.buildWatercolorRenderer().then(g.hitch(this, function(a) {
                                    this.hideBusy();
                                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                                        (this.renderer = a, this.applyWatercolorRenderer(a))
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                            }),
                            b = dojo.map(this._rendererAttributeDivs, function(a) { return a ? "none" !== x.get(a, "display") : null });
                        this.getAttributeItem().then(g.hitch(this, function(c) {
                            this.attributeItem = c;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(c) {
                                this.attributeItem2 = c;
                                b[3] ? this.getAttributeItem(null, 3).then(g.hitch(this,
                                    function(c) {
                                        this.attributeItem3 = c;
                                        b[4] ? this.getAttributeItem(null, 4).then(g.hitch(this, function(c) {
                                            this.attributeItem4 = c;
                                            b[5] ? this.getAttributeItem(null, 5).then(g.hitch(this, function(c) {
                                                this.attributeItem5 = c;
                                                b[6] ? this.getAttributeItem(null, 6).then(g.hitch(this, function(c) {
                                                    this.attributeItem6 = c;
                                                    b[7] ? this.getAttributeItem(null, 7).then(g.hitch(this, function(c) {
                                                        this.attributeItem7 = c;
                                                        b[8] ? this.getAttributeItem(null, 8).then(g.hitch(this, function(c) {
                                                            this.attributeItem8 = c;
                                                            b[9] ? this.getAttributeItem(null,
                                                                9).then(g.hitch(this, function(c) {
                                                                this.attributeItem9 = c;
                                                                b[10] ? this.getAttributeItem(null, 10).then(g.hitch(this, function(b) {
                                                                    this.attributeItem10 = b;
                                                                    a()
                                                                })) : a()
                                                            })) : a()
                                                        })) : a()
                                                    })) : a()
                                                })) : a()
                                            })) : a()
                                        })) : a()
                                    })) : a()
                            }))
                        }))
                    }
                },
                _select_ratio: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(a) {
                        this.attributeItem = a;
                        this.resetTypeOptionsClearCheck();
                        this.galleryList.selectItem("ratio");
                        this.saveCurrentRenderer();
                        this.savedRenderers.ratio ?
                            (this.renderer = K.fromJson(g.clone(this.savedRenderers.ratio.renderer)), this.scheme = this.savedRenderers.ratio.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyRatioRenderer(this.renderer), this.setOpacity(this.savedRenderers.ratio.opacity), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildRatioRenderer().then(g.hitch(this, function(a) {
                                this.hideBusy();
                                if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                    var b = a.renderer;
                                    this.renderer = a.renderer;
                                    b.authoringInfo = this.authoringInfo ? g.clone(this.authoringInfo) : b.authoringInfo;
                                    this.savedRenderers.ratio = { renderer: b.toJson(), scheme: this.scheme };
                                    this.applyRatioRenderer(b);
                                    this.checkAddAndSwitchIcons()
                                }
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                    }))
                },
                _select_ageColor: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this,
                        function(a) {
                            this.attributeItem = a;
                            this.resetTypeOptionsClearCheck();
                            this.galleryList.selectItem("ageColor");
                            this.saveCurrentRenderer();
                            if (this.savedRenderers.ageColor) {
                                a = K.fromJson(g.clone(this.savedRenderers.ageColor.renderer));
                                var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                                this.scheme = V.getSchemes({ theme: b && b.theme ? b.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                                this.renderer = this.updateSchemeOnColorRenderer({
                                    scheme: this.scheme,
                                    renderer: a
                                });
                                this.authoringInfo = g.clone(this.renderer.authoringInfo);
                                this.applyAgeColorRenderer(this.renderer);
                                (this.savedRenderers.ageColor.scheme && this.savedRenderers.ageColor.scheme.id === this.scheme.id || !this.savedRenderers.ageColor.scheme) && this.setOpacity(this.savedRenderers.ageColor.opacity);
                                this.checkAddAndSwitchIcons()
                            } else this.scheme = null, this.buildAgeColorRenderer().then(g.hitch(this, function(a) {
                                this.hideBusy();
                                "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.renderer =
                                    a = a.renderer, a.authoringInfo = this.authoringInfo ? g.clone(this.authoringInfo) : a.authoringInfo, this.savedRenderers.ageColor = { renderer: a.toJson(), scheme: this.scheme }, this.applyAgeColorRenderer(a), this.checkAddAndSwitchIcons())
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                        }))
                },
                _select_ageSize: function() {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this,
                        function(a) {
                            this.attributeItem = a;
                            this.resetTypeOptionsClearCheck();
                            this.galleryList.selectItem("ageSize");
                            this.saveCurrentRenderer();
                            this.savedRenderers.ageSize ? (this.renderer = K.fromJson(g.clone(this.savedRenderers.ageSize.renderer)), this.scheme = this.savedRenderers.ageSize.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyAgeSizeRenderer(this.renderer), this.setOpacity(this.savedRenderers.ageSize.opacity), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildAgeSizeRenderer().then(g.hitch(this,
                                function(a) { this.hideBusy(); "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.renderer = a = a.renderer, a.authoringInfo = this.authoringInfo ? g.clone(this.authoringInfo) : a.authoringInfo, this.savedRenderers.ageSize = { renderer: a.toJson(), scheme: this.scheme }, this.applyAgeSizeRenderer(a), this.checkAddAndSwitchIcons()) }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                        }))
                },
                _select_ageColorSize: function(a) {
                    "rendererStack" ===
                    arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(b) {
                        this.attributeItem = b;
                        this.getAttributeItem(null, 2).then(g.hitch(this, function(b) {
                            this.attributeItem2 = b;
                            if (a) {
                                this.setTypeOptions();
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("ageColorSize");
                                this.galleryList.disableOptionsButton("ageColorSize");
                                b = {
                                    rotationInfo: this.renderer.rotationInfo,
                                    rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables),
                                    defaultSymbol: this.renderer.defaultSymbol,
                                    defaultLabel: this.renderer.defaultLabel
                                };
                                var d = g.hitch(this, function(a) {
                                    if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                    else if (a.rotationInfoVisVar) {
                                        var b = this.renderer.visualVariables || [];
                                        b.push(a.rotationInfoVisVar);
                                        this.renderer.setVisualVariables(b)
                                    }
                                    a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                }, b);
                                if (a.colorInfo) this.scheme = null, this.buildSizeRenderer({
                                    classificationMethod: "natural-breaks",
                                    attributeItem: this.isTypeString(this.attributeItem2) || this.attributeItem2.codedValues ? this.attributeItem : this.attributeItem2
                                }).then(g.hitch(this, function(b) {
                                    this.hideBusy();
                                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                        var e = b.renderer;
                                        this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                        a.authColorInfo && (e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("colorInfo", null, a.authColorInfo,
                                            e.authoringInfo));
                                        a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, e.authoringInfo));
                                        if (b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) {
                                            var f = this.getVisualVariableByType("sizeInfo", null, e.visualVariables);
                                            f.minSize = b.minSize;
                                            f.maxSize = b.maxSize;
                                            this.replaceVisualVariable("sizeInfo",
                                                null, f, e)
                                        }
                                        this.authoringInfo = g.clone(e.authoringInfo);
                                        delete e.attributeField;
                                        delete e.normalizationField;
                                        delete e.normalizationType;
                                        e.setValueExpression(a.colorInfo.valueExpression);
                                        f = this.renderer.infos[0].symbol;
                                        b = e.infos[0];
                                        "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) &&
                                            -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                        e.clearBreaks();
                                        e.addBreak(b);
                                        this.renderer = K.fromJson(g.clone(e.toJson()));
                                        this.savedRenderers.ageColorSize = { renderer: this.renderer.toJson(), scheme: this.scheme };
                                        d();
                                        this.applyColorRenderer(this.renderer);
                                        this.galleryList.enableOptionsButton("ageColorSize");
                                        this.checkAddAndSwitchIcons()
                                    }
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) {
                                    this.showBusy("rendererStack",
                                        a)
                                }));
                                else {
                                    var e = this.renderer;
                                    "ageColorSize" === this.getRendererStyle(this.renderer) ? this.buildAgeColorInfo({ attributeItem: this.attributeItem, statistics: null, scheme: this.findColorScheme(this.renderer) }).then(g.hitch(this, function(b) {
                                        this.hideBusy();
                                        if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                            this.replaceVisualVariable("colorInfo", null, b.colorInfo, e);
                                            b = b.authoringInfo ? this.getVisualVariableByType("colorInfo", null, b.authoringInfo.visualVariables) : null;
                                            this.replaceVisualVariable("colorInfo",
                                                null, b, e.authoringInfo);
                                            this.authoringInfo = g.clone(e.authoringInfo);
                                            e.setValueExpression(a.colorInfo.valueExpression);
                                            b = this.renderer.infos[0].symbol;
                                            var f = e.infos[0];
                                            "esriGeometryPolygon" === this.geometryType ? f.symbol = this.convertFillToMarkerSymbol(f.symbol, b.style, b.outline) : "esriGeometryPolyline" === this.geometryType ? f.symbol = f.symbol.setStyle(b.style) : (f.symbol = f.symbol.setStyle(b.style), -1 < c.indexOf(["circle", "diamond", "square"], f.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], b.style) &&
                                                f.symbol.setOutline(b.outline));
                                            e.clearBreaks();
                                            e.addBreak(f);
                                            this.renderer = K.fromJson(g.clone(e.toJson()));
                                            this.savedRenderers.ageColorSize = { renderer: this.renderer.toJson(), scheme: this.scheme };
                                            d();
                                            this.applyColorRenderer(this.renderer);
                                            this.galleryList.enableOptionsButton("ageColorSize");
                                            this.checkAddAndSwitchIcons()
                                        }
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })) : (this.scheme = null, this.buildSizeRenderer({
                                        classificationMethod: "natural-breaks",
                                        attributeItem: this.attributeItem2
                                    }).then(g.hitch(this, function(b) {
                                        var e = b.renderer;
                                        this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, e);
                                        a.authSizeInfo && (e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a.authSizeInfo, e.authoringInfo));
                                        a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, e.authoringInfo));
                                        var f = this.renderer.infos[0].symbol;
                                        b = e.infos[0];
                                        "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                        e.clearBreaks();
                                        e.addBreak(b);
                                        this.buildAgeColorInfo({ attributeItem: this.attributeItem, statistics: this.attributeItem2.name === this.attributeItem.name ? b.statistics : null, scheme: this.findColorScheme(this.renderer) }).then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                                var b = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null;
                                                e.authoringInfo =
                                                    e.authoringInfo || {};
                                                e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [];
                                                this.replaceVisualVariable("colorInfo", null, b, e.authoringInfo);
                                                this.authoringInfo = g.clone(e.authoringInfo);
                                                delete e.attributeField;
                                                delete e.normalizationField;
                                                delete e.normalizationType;
                                                e.setValueExpression(a.colorInfo.valueExpression);
                                                this.renderer = K.fromJson(g.clone(e.toJson()));
                                                this.savedRenderers.ageColorSize = { renderer: this.renderer.toJson(), scheme: this.scheme };
                                                d();
                                                this.applyAgeColorRenderer(this.renderer);
                                                this.galleryList.enableOptionsButton("ageColorSize");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                                }
                            } else if (this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("ageColorSize"), this.galleryList.disableOptionsButton("ageColorSize"),
                                this.saveCurrentRenderer(), this.savedRenderers.ageColorSize) {
                                b = K.fromJson(g.clone(this.savedRenderers.ageColorSize.renderer));
                                var f = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                                this.scheme = V.getSchemes({ theme: f && f.theme ? f.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                                this.renderer = e = this.updateSchemeOnColorRenderer({ scheme: this.scheme, renderer: b });
                                this.authoringInfo = g.clone(this.renderer.authoringInfo);
                                this.applyColorRenderer(this.renderer);
                                (this.savedRenderers.ageColorSize.scheme && this.savedRenderers.ageColorSize.scheme.id === this.scheme.id || !this.savedRenderers.ageColorSize.scheme) && this.setOpacity(this.savedRenderers.ageColorSize.opacity);
                                this.galleryList.enableOptionsButton("ageColorSize");
                                this.checkAddAndSwitchIcons()
                            } else this.scheme = null, this.buildSizeRenderer({ attributeItem: this.attributeItem2 }).then(g.hitch(this, function(a) {
                                var b = a.renderer;
                                this.buildAgeColorInfo({ attributeItem: this.attributeItem, statistics: null, scheme: null }).then(g.hitch(this,
                                    function(a) {
                                        this.hideBusy();
                                        "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("colorInfo", null, a.colorInfo, b), a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null, this.replaceVisualVariable("colorInfo", null, a, this.authoringInfo), b.authoringInfo = g.clone(this.authoringInfo), this.renderer = b, this.savedRenderers.ageColorSize = { renderer: b.toJson(), scheme: this.scheme }, this.applyColorRenderer(b), this.galleryList.enableOptionsButton("ageColorSize"),
                                            this.checkAddAndSwitchIcons())
                                    }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                        }))
                    }))
                },
                _select_colorAgeSize: function(a) {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && this.getAttributeItem().then(g.hitch(this, function(b) {
                        this.attributeItem =
                            b;
                        this.getAttributeItem(null, 2).then(g.hitch(this, function(b) {
                            this.attributeItem2 = b;
                            if (a) {
                                this.setTypeOptions();
                                this.resetTypeOptionsClearCheck();
                                this.galleryList.selectItem("colorAgeSize");
                                this.galleryList.disableOptionsButton("colorAgeSize");
                                b = { rotationInfo: this.renderer.rotationInfo, rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel };
                                var d = g.hitch(this, function(a) {
                                    if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                    else if (a.rotationInfoVisVar) {
                                        var b = this.renderer.visualVariables || [];
                                        b.push(a.rotationInfoVisVar);
                                        this.renderer.setVisualVariables(b)
                                    }
                                    a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                }, b);
                                if (a.colorInfo) this.isMultiAttributesRenderer = !0, this.scheme = null, this.buildAgeSizeRenderer({ attributeItem: this.isTypeString(this.attributeItem2) || this.attributeItem2.codedValues ? this.attributeItem : this.attributeItem2 }).then(g.hitch(this, function(b) {
                                    this.hideBusy();
                                    if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                        var e = b.renderer;
                                        this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                        a.authColorInfo && (e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("colorInfo", null, a.authColorInfo, e.authoringInfo));
                                        a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, e.authoringInfo));
                                        if (b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) {
                                            var f = this.getVisualVariableByType("sizeInfo", null, e.visualVariables);
                                            f.minSize = b.minSize;
                                            f.maxSize = b.maxSize;
                                            this.replaceVisualVariable("sizeInfo", null, f, e)
                                        }
                                        this.authoringInfo = g.clone(e.authoringInfo);
                                        delete e.attributeField;
                                        delete e.normalizationField;
                                        delete e.normalizationType;
                                        e.setValueExpression(this.getVisualVariableByType("sizeInfo",
                                            null, e.visualVariables).valueExpression);
                                        f = this.renderer.infos[0].symbol;
                                        b = e.infos[0];
                                        "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                        e.clearBreaks();
                                        e.addBreak(b);
                                        this.renderer =
                                            e;
                                        this.savedRenderers.colorAgeSize = { renderer: e.toJson(), scheme: this.scheme };
                                        d();
                                        this.applySizeRenderer(e);
                                        this.galleryList.enableOptionsButton("colorAgeSize");
                                        this.checkAddAndSwitchIcons()
                                    }
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }));
                                else {
                                    var e = this.renderer;
                                    "colorAgeSize" === this.getRendererStyle(this.renderer) ? this.buildColorInfo({
                                        classificationMethod: "natural-breaks",
                                        attributeItem: this.attributeItem,
                                        statistics: null,
                                        scheme: this.findColorScheme(this.renderer)
                                    }).then(g.hitch(this, function(a) {
                                        this.hideBusy();
                                        if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                            this.replaceVisualVariable("colorInfo", null, a.colorInfo, e);
                                            a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null;
                                            this.replaceVisualVariable("colorInfo", null, a, e.authoringInfo);
                                            this.authoringInfo = g.clone(e.authoringInfo);
                                            delete e.attributeField;
                                            delete e.normalizationField;
                                            delete e.normalizationType;
                                            e.setValueExpression(this.getVisualVariableByType("sizeInfo", null, e.visualVariables).valueExpression);
                                            a = this.renderer.infos[0].symbol;
                                            var b = e.infos[0];
                                            "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, a.style, a.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(a.style) : (b.symbol = b.symbol.setStyle(a.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"],
                                                a.style) && b.symbol.setOutline(a.outline));
                                            e.clearBreaks();
                                            e.addBreak(b);
                                            this.renderer = e;
                                            this.savedRenderers.colorAgeSize = { renderer: e.toJson(), scheme: this.scheme };
                                            d();
                                            this.applySizeRenderer(e);
                                            this.galleryList.enableOptionsButton("colorAgeSize");
                                            this.checkAddAndSwitchIcons()
                                        }
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })) : (this.scheme = null, this.buildAgeSizeRenderer({ attributeItem: this.attributeItem2 }).then(g.hitch(this,
                                        function(b) {
                                            var e = b.renderer;
                                            this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, e);
                                            a.authSizeInfo && (e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a.authSizeInfo, e.authoringInfo));
                                            a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, e), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo",
                                                null, a.authOpacityInfo, e.authoringInfo));
                                            var f = this.renderer.infos[0].symbol;
                                            b = e.infos[0];
                                            "esriGeometryPolygon" === this.geometryType ? b.symbol = this.convertFillToMarkerSymbol(b.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? b.symbol = b.symbol.setStyle(f.style) : (b.symbol = b.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], b.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && b.symbol.setOutline(f.outline));
                                            e.clearBreaks();
                                            e.addBreak(b);
                                            this.buildColorInfo({
                                                classificationMethod: "natural-breaks",
                                                attributeItem: this.attributeItem,
                                                statistics: this.attributeItem2.name === this.attributeItem.name ? b.statistics : null,
                                                scheme: null
                                            }).then(g.hitch(this, function(a) {
                                                this.hideBusy();
                                                "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("colorInfo", null, a.colorInfo, e), a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null, e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("colorInfo", null, a, e.authoringInfo), this.authoringInfo = g.clone(e.authoringInfo), delete e.attributeField, delete e.normalizationField, delete e.normalizationType, e.setValueExpression(this.getVisualVariableByType("sizeInfo", null, e.visualVariables).valueExpression), this.renderer = e, this.savedRenderers.colorAgeSize = { renderer: e.toJson(), scheme: this.scheme }, d(), this.applySizeRenderer(e), this.galleryList.enableOptionsButton("colorAgeSize"), this.checkAddAndSwitchIcons())
                                            }), g.hitch(this,
                                                function() {
                                                    this.hideBusy();
                                                    this.updateUIWithRenderer();
                                                    this.adjustHeight()
                                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                        }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                                }
                            } else if (this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("colorAgeSize"), this.galleryList.disableOptionsButton("colorAgeSize"), this.saveCurrentRenderer(), this.savedRenderers.colorAgeSize) {
                                b = K.fromJson(g.clone(this.savedRenderers.colorAgeSize.renderer));
                                var f = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                                this.scheme = V.getSchemes({ theme: f && f.theme ? f.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                                this.renderer = e = this.updateSchemeOnColorRenderer({ scheme: this.scheme, renderer: b });
                                this.authoringInfo = g.clone(this.renderer.authoringInfo);
                                this.applyColorRenderer(this.renderer);
                                (this.savedRenderers.colorAgeSize.scheme && this.savedRenderers.colorAgeSize.scheme.id === this.scheme.id ||
                                    !this.savedRenderers.colorAgeSize.scheme) && this.setOpacity(this.savedRenderers.colorAgeSize.opacity);
                                this.galleryList.enableOptionsButton("colorAgeSize");
                                this.checkAddAndSwitchIcons()
                            } else this.scheme = null, this.buildAgeSizeRenderer({ attributeItem: this.attributeItem2 }).then(g.hitch(this, function(a) {
                                var b = a.renderer;
                                this.buildColorInfo({ attributeItem: this.attributeItem, statistics: null, scheme: null }).then(g.hitch(this, function(a) {
                                    this.hideBusy();
                                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                                        (this.replaceVisualVariable("colorInfo", null, a.colorInfo, b), a = a.authoringInfo ? this.getVisualVariableByType("colorInfo", null, a.authoringInfo.visualVariables) : null, this.replaceVisualVariable("colorInfo", null, a, this.authoringInfo), b.authoringInfo = g.clone(this.authoringInfo), b.attributeField = "customExpr" !== this.attributeItem.name ? this.attributeItem.name : void 0, b.setValueExpression(this.attributeItem.valueExpression), this.renderer = b, this.savedRenderers.colorAgeSize = { renderer: b.toJson(), scheme: this.scheme },
                                            this.applySizeRenderer(b), this.galleryList.enableOptionsButton("colorAgeSize"), this.checkAddAndSwitchIcons())
                                }), g.hitch(this, function() {
                                    this.hideBusy();
                                    this.updateUIWithRenderer();
                                    this.adjustHeight()
                                }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer();
                                this.adjustHeight()
                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                        }))
                    }))
                },
                _select_uniqueAgeSize: function(a) {
                    "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                        this.getAttributeItem().then(g.hitch(this, function(b) {
                            this.attributeItem = b;
                            this.getAttributeItem(null, 2).then(g.hitch(this, function(b) {
                                this.attributeItem2 = b;
                                if (a) {
                                    this.setTypeOptions();
                                    this.resetTypeOptionsClearCheck();
                                    this.galleryList.selectItem("uniqueAgeSize");
                                    this.galleryList.disableOptionsButton("uniqueAgeSize");
                                    b = {
                                        rotationInfo: this.renderer.rotationInfo,
                                        rotationInfoVisVar: this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables),
                                        defaultSymbol: this.renderer.defaultSymbol,
                                        defaultLabel: this.renderer.defaultLabel
                                    };
                                    var d = g.hitch(this, function(a) {
                                        if (a.rotationInfo) this.renderer.setRotationInfo(a.rotationInfo);
                                        else if (a.rotationInfoVisVar) {
                                            var b = this.renderer.visualVariables || [];
                                            b.push(a.rotationInfoVisVar);
                                            this.renderer.setVisualVariables(b)
                                        }
                                        a.defaultSymbol && a.defaultLabel && (this.renderer.defaultSymbol = a.defaultSymbol, this.renderer.defaultLabel = a.defaultLabel)
                                    }, b);
                                    if (a.types) {
                                        var e = this.renderer;
                                        this.buildAgeSizeInfo({
                                            attributeItem: this.getFieldForSizeRenderer(),
                                            statistics: null,
                                            scheme: null
                                        }).then(g.hitch(this, function(a) {
                                            this.hideBusy();
                                            "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, e), a = this.getVisualVariableByType("sizeInfo", null, a.authoringInfo.visualVariables), e.authoringInfo = e.authoringInfo || {}, e.authoringInfo.visualVariables = e.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a, e.authoringInfo), this.authoringInfo = g.clone(e.authoringInfo), this.lastUniqueDefaultLabel =
                                                this.lastUniqueDefaultSymbol = null, this.renderer = e, this.savedRenderers.uniqueAgeSize = { renderer: e.toJson(), scheme: this.scheme }, d(), this.applyUniqueRenderer(e), this.galleryList.enableOptionsButton("uniqueAgeSize"), this.checkAddAndSwitchIcons())
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    } else "colorAgeSize" === this.getRendererStyle(this.renderer) && (this.setTypeOptions(), this.resetTypeOptionsClearCheck(),
                                        this.galleryList.selectItem("uniqueAgeSize"), this.galleryList.disableOptionsButton("uniqueAgeSize"), this.scheme = null), this.buildUniqueRenderer({ attributeItem: this.getFieldForUniqueRenderer() }).then(g.hitch(this, function(b) {
                                        this.buildAgeSizeInfo({ attributeItem: this.getFieldForSizeRenderer(), statistics: null, scheme: null }).then(g.hitch(this, function(e) {
                                            this.hideBusy();
                                            if ("rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack()) {
                                                this.replaceVisualVariable("sizeInfo", null, a.sizeInfo, b);
                                                a.authSizeInfo &&
                                                    (b.authoringInfo = b.authoringInfo || {}, b.authoringInfo.visualVariables = b.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, a.authSizeInfo, b.authoringInfo));
                                                var f = this.renderer.infos[0].symbol,
                                                    h = [];
                                                c.forEach(b.infos, function(a) { h.push(g.clone(a)) });
                                                c.forEach(h, function(a) { b.removeValue(a.value) });
                                                c.forEach(h, function(a) {
                                                    "esriGeometryPolygon" === this.geometryType ? a.symbol = this.convertFillToMarkerSymbol(a.symbol, f.style, f.outline) : "esriGeometryPolyline" === this.geometryType ? a.symbol =
                                                        a.symbol.setStyle(f.style) : (a.symbol = a.symbol.setStyle(f.style), -1 < c.indexOf(["circle", "diamond", "square"], a.symbol.style) && -1 < c.indexOf(["circle", "diamond", "square"], f.style) && a.symbol.setOutline(f.outline));
                                                    b.addValue(a)
                                                }, this);
                                                a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, b), b.authoringInfo = b.authoringInfo || {}, b.authoringInfo.visualVariables = b.authoringInfo.visualVariables || [], this.replaceVisualVariable("transparencyInfo", null, a.authOpacityInfo, b.authoringInfo));
                                                this.authoringInfo =
                                                    g.clone(b.authoringInfo);
                                                "esriGeometryPolygon" === this.geometryType && (c.forEach(b.infos, function(a) { a.symbol = this.convertFillToMarkerSymbol(a.symbol, f.style, f.outline) }, this), b.backgroundFillSymbol = e.backgroundFillSymbol);
                                                this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null;
                                                this.renderer = b;
                                                this.savedRenderers.uniqueAgeSize = { renderer: b.toJson(), scheme: this.scheme };
                                                d();
                                                this.applyUniqueRenderer(b);
                                                this.galleryList.enableOptionsButton("uniqueAgeSize");
                                                this.checkAddAndSwitchIcons()
                                            }
                                        }), g.hitch(this,
                                            function() {
                                                this.hideBusy();
                                                this.updateUIWithRenderer();
                                                this.adjustHeight()
                                            }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                } else this.resetTypeOptionsClearCheck(), this.galleryList.selectItem("uniqueAgeSize"), this.galleryList.disableOptionsButton("uniqueAgeSize"), this.saveCurrentRenderer(), this.savedRenderers.uniqueAgeSize ? (this.renderer =
                                    K.fromJson(g.clone(this.savedRenderers.uniqueAgeSize.renderer)), this.scheme = this.savedRenderers.uniqueAgeSize.scheme, this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyUniqueRenderer(this.renderer), this.setOpacity(this.savedRenderers.uniqueAgeSize.opacity), this.galleryList.enableOptionsButton("uniqueAgeSize"), this.checkAddAndSwitchIcons()) : (this.scheme = null, this.buildUniqueRenderer({ attributeItem: this.getFieldForUniqueRenderer() }).then(g.hitch(this, function(a) {
                                        this.buildAgeSizeInfo({
                                            classificationMethod: "natural-breaks",
                                            attributeItem: this.getFieldForSizeRenderer(),
                                            statistics: null,
                                            scheme: null
                                        }).then(g.hitch(this, function(b) {
                                            this.hideBusy();
                                            "rendererStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && (this.replaceVisualVariable("sizeInfo", null, b.sizeInfo, a), this.authoringInfo = b.authoringInfo, a.authoringInfo = g.clone(this.authoringInfo), "esriGeometryPolygon" === this.geometryType && (c.forEach(a.infos, function(a) { a.symbol = this.convertFillToMarkerSymbol(a.symbol) }, this), a.backgroundFillSymbol = b.backgroundFillSymbol),
                                                this.lastUniqueDefaultLabel = this.lastUniqueDefaultSymbol = null, this.renderer = a, this.savedRenderers.uniqueAgeSize = { renderer: a.toJson(), scheme: this.scheme }, this.applyUniqueRenderer(a), this.galleryList.enableOptionsButton("uniqueAgeSize"), this.checkAddAndSwitchIcons())
                                        }), g.hitch(this, function() {
                                            this.hideBusy();
                                            this.updateUIWithRenderer();
                                            this.adjustHeight()
                                        }), g.hitch(this, function(a) { this.showBusy("rendererStack", a) }))
                                    }), g.hitch(this, function() {
                                        this.hideBusy();
                                        this.updateUIWithRenderer();
                                        this.adjustHeight()
                                    }),
                                    g.hitch(this, function(a) { this.showBusy("rendererStack", a) })))
                            }))
                        }))
                },
                _goToSimplePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererSimpleStack || (this.rendererSimpleStack = new q({ id: "rendererSimpleStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 }));
                    this.rendererSimplePanel && this.rendererSimplePanel.destroy();
                    var a = function() {
                        this.rendererSimplePanel = new z({
                            id: "rendererSimplePanel",
                            params: {
                                portalPanel: this,
                                subLayerId: this.subLayerId,
                                mapLayer: this.mapLayer,
                                layer: this.layer,
                                fLayer: this.fLayer,
                                renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                geometryType: this.geometryType,
                                origRenderer: this.origRenderer,
                                isHosted: this.isHosted,
                                isFeatColl: this.isFeatColl,
                                isCSV: this.isCSV,
                                isSL: this.isSL,
                                isGeoRSS: this.isGeoRSS,
                                isWFS: this.isWFS,
                                isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                hasDynamic: this.hasDynamic,
                                newDMS: this.newDMS,
                                hasFeatureReduction: this.hasFeatureReduction,
                                attributesStore: this.attributesStore,
                                hasNumericField: this.hasNumericField,
                                showDateFields: this.showDateFields,
                                numHistogramBins: this.numHistogramBins
                            },
                            containerNode: this.rendererSimpleStack,
                            region: "top"
                        });
                        leftPanel.sc.addChild(this.rendererSimpleStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererSimpleStack);
                        leftPanel.visibleStack = "rendererSimpleStack";
                        D.byId("rendererSimplePanel").adjustHeight()
                    };
                    if (this.isGeoRSS || this.isWFS || this.isSL) g.hitch(this, a)();
                    else {
                        var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                            c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                        this.getAttributeItem(this.renderer.attributeField || this.renderer.field || b && b.field || c && c.field).then(g.hitch(this, function(b) {
                            "showLocationOnly" === b.name ? b = null : this._rendererAttribute.set("value", b.name);
                            this.isGeoRSS || this.isWFS || this.isSL || (this.setTypeOptions(b), this.galleryList.selectItem("simple"));
                            g.hitch(this, a)()
                        }))
                    }
                },
                _goToHeatMapPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererHeatMapStack || (this.rendererHeatMapStack = new q({
                        id: "rendererHeatMapStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    }));
                    this.rendererHeatMapPanel && this.rendererHeatMapPanel.destroy();
                    this.getAttributeItem(this.renderer.field).then(g.hitch(this, function(a) {
                        "showLocationOnly" === a.name ? a = null : this._rendererAttribute.set("value", a.name);
                        this.setTypeOptions(a);
                        this.galleryList.selectItem("heatMap");
                        this.rendererHeatMapPanel = new I({
                            id: "rendererHeatMapPanel",
                            params: {
                                portalPanel: this,
                                subLayerId: this.subLayerId,
                                mapLayer: this.mapLayer,
                                layer: this.layer,
                                renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                geometryType: this.geometryType,
                                origRenderer: this.origRenderer,
                                isHosted: this.isHosted,
                                isFeatColl: this.isFeatColl,
                                isCSV: this.isCSV,
                                isSL: this.isSL,
                                isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                hasDynamic: this.hasDynamic,
                                newDMS: this.newDMS,
                                hasFeatureReduction: this.hasFeatureReduction,
                                attributeItem: a,
                                attributesStore: this.attributesStore,
                                hasNumericField: this.hasNumericField,
                                numHistogramBins: this.numHistogramBins
                            },
                            containerNode: this.rendererHeatMapStack,
                            region: "top"
                        });
                        leftPanel.sc.addChild(this.rendererHeatMapStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererHeatMapStack);
                        leftPanel.visibleStack = "rendererHeatMapStack";
                        D.byId("rendererHeatMapPanel").adjustHeight()
                    }))
                },
                _goToColorSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({ id: "rendererMultiAttributesStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                        b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(a ? a.field || "customExpr" : this.renderer.attributeField || this.renderer.field, a && a.valueExpression, a && a.valueExpressionTitle).then(g.hitch(this, function(a) {
                        this._rendererAttribute.set("value", a.name);
                        this.getAttributeItem(b ? b.field || "customExpr2" : this.renderer.attributeField || this.renderer.field, b && b.valueExpression, b && b.valueExpressionTitle).then(g.hitch(this,
                            function(b) {
                                this._rendererAttribute2.set("value", b.name);
                                this.setTypeOptions(a, b);
                                this.galleryList.selectItem("colorsize");
                                this.rendererMultiAttributesPanel = new u({
                                    id: "rendererMultiAttributesPanel",
                                    params: {
                                        portalPanel: this,
                                        subLayerId: this.subLayerId,
                                        mapLayer: this.mapLayer,
                                        layer: this.layer,
                                        fLayer: this.fLayer,
                                        renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                        geometryType: this.geometryType,
                                        origRenderer: this.origRenderer,
                                        isHosted: this.isHosted,
                                        isFeatColl: this.isFeatColl,
                                        isCSV: this.isCSV,
                                        isSL: this.isSL,
                                        isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                        hasDynamic: this.hasDynamic,
                                        newDMS: this.newDMS,
                                        hasFeatureReduction: this.hasFeatureReduction,
                                        attributeItem: a,
                                        attributeItem2: b,
                                        attributesStore: this.attributesStore,
                                        hasNumericField: this.hasNumericField,
                                        hasDateField: this.hasDateField,
                                        countDateFields: this.countDateFields,
                                        showDateFields: this.showDateFields,
                                        numHistogramBins: this.numHistogramBins
                                    },
                                    containerNode: this.rendererMultiAttributesStack,
                                    region: "top"
                                });
                                leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                                leftPanel.sc.startup();
                                leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                                leftPanel.visibleStack = "rendererMultiAttributesStack";
                                D.byId("rendererMultiAttributesPanel").adjustHeight()
                            }))
                    }))
                },
                _goToUniqueSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({ id: "rendererMultiAttributesStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(this.renderer.valueExpression ? "customExpr" : this.renderer.attributeField || this.renderer.field, this.renderer.valueExpression, this.renderer.valueExpressionTitle).then(g.hitch(this, function(b) {
                        this.getAttributeItem(a ? a.field || "customExpr2" : this.renderer.attributeField || this.renderer.field, a && a.valueExpression, a && a.valueExpressionTitle).then(g.hitch(this, function(a) {
                            this.setTypeOptions(b, a);
                            this.galleryList.selectItem("uniquesize");
                            this.rendererMultiAttributesPanel = new u({
                                id: "rendererMultiAttributesPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: b,
                                    attributeItem2: a,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    hasDateField: this.hasDateField,
                                    countDateFields: this.countDateFields,
                                    showDateFields: this.showDateFields,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererMultiAttributesStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                            leftPanel.visibleStack = "rendererMultiAttributesStack";
                            D.byId("rendererMultiAttributesPanel").adjustHeight()
                        }))
                    }))
                },
                _goToRatioPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = D.byId("rendererRatioStack");
                    this.rendererRatioStack = a ? a : new q({ id: "rendererRatioStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = D.byId("rendererRatioPanel")) && a.destroy();
                    var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(b && b.field || this.renderer.attributeField || this.renderer.field).then(g.hitch(this,
                        function(a) {
                            this._rendererAttribute.set("value", a.name);
                            this.getAttributeItem(b.normalizationField).then(g.hitch(this, function(b) {
                                this._rendererAttribute2.set("value", b.name);
                                this.setTypeOptions(a, b);
                                this.galleryList.selectItem("ratio");
                                this.rendererRatioPanel = new Q({
                                    id: "rendererRatioPanel",
                                    params: {
                                        portalPanel: this,
                                        subLayerId: this.subLayerId,
                                        mapLayer: this.mapLayer,
                                        layer: this.layer,
                                        fLayer: this.fLayer,
                                        renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                        geometryType: this.geometryType,
                                        origRenderer: this.origRenderer,
                                        isHosted: this.isHosted,
                                        isFeatColl: this.isFeatColl,
                                        isCSV: this.isCSV,
                                        isSL: this.isSL,
                                        isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                        hasDynamic: this.hasDynamic,
                                        newDMS: this.newDMS,
                                        hasFeatureReduction: this.hasFeatureReduction,
                                        attributeItem: a,
                                        attributeItem2: b,
                                        attributesStore: this.attributesStore,
                                        hasNumericField: this.hasNumericField,
                                        showDateFields: this.showDateFields,
                                        numHistogramBins: this.numHistogramBins
                                    },
                                    containerNode: this.rendererRatioStack,
                                    region: "top"
                                });
                                leftPanel.sc.addChild(this.rendererRatioStack);
                                leftPanel.sc.startup();
                                leftPanel.sc.selectChild(this.rendererRatioStack);
                                leftPanel.visibleStack = "rendererRatioStack";
                                D.byId("rendererRatioPanel").adjustHeight()
                            }))
                        }))
                },
                _goToPredominanceSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({ id: "rendererMultiAttributesStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    this.getVisualVariableByType("sizeInfo",
                        null, this.renderer.visualVariables);
                    var a = this.renderer.infos,
                        b = a[1].value;
                    this.getAttributeItem(a[0].value).then(g.hitch(this, function(c) {
                        this.getAttributeItem(b).then(g.hitch(this, function(b) {
                            2 < a.length ? this.getAttributeItem(a[2].value).then(g.hitch(this, function(a) {
                                this.setTypeOptions(c, b, a);
                                this.galleryList.selectItem("predominancesize")
                            })) : (this.setTypeOptions(c, b), this.galleryList.selectItem("predominancesize"));
                            this.rendererMultiAttributesPanel = new u({
                                id: "rendererMultiAttributesPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: c,
                                    attributeItem2: b,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererMultiAttributesStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                            leftPanel.visibleStack = "rendererMultiAttributesStack";
                            D.byId("rendererMultiAttributesPanel").adjustHeight()
                        }))
                    }))
                },
                _goToRelationshipSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack =
                        new q({ id: "rendererMultiAttributesStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.renderer.authoringInfo.field1.field,
                        b = this.renderer.authoringInfo.field2.field,
                        c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                        d = c.field || "customExpr3";
                    this.getAttributeItem(a).then(g.hitch(this, function(a) {
                        this._rendererAttribute.set("value", a.name);
                        this.getAttributeItem(b).then(g.hitch(this,
                            function(b) {
                                this._rendererAttribute2.set("value", b.name);
                                this.getAttributeItem(d, c.valueExpression, c.valueExpressionTitle).then(g.hitch(this, function(c) {
                                    this._rendererAttribute3.set("value", c.name);
                                    this.setTypeOptions(a, b);
                                    this.galleryList.selectItem("relationshipSize");
                                    this.rendererMultiAttributesPanel = new u({
                                        id: "rendererMultiAttributesPanel",
                                        params: {
                                            portalPanel: this,
                                            subLayerId: this.subLayerId,
                                            mapLayer: this.mapLayer,
                                            layer: this.layer,
                                            fLayer: this.fLayer,
                                            renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                            geometryType: this.geometryType,
                                            origRenderer: this.origRenderer,
                                            isHosted: this.isHosted,
                                            isFeatColl: this.isFeatColl,
                                            isCSV: this.isCSV,
                                            isSL: this.isSL,
                                            isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                            hasDynamic: this.hasDynamic,
                                            newDMS: this.newDMS,
                                            hasFeatureReduction: this.hasFeatureReduction,
                                            attributeItem: a,
                                            attributeItem2: b,
                                            attributeItem3: c,
                                            attributesStore: this.attributesStore,
                                            hasNumericField: this.hasNumericField,
                                            numHistogramBins: this.numHistogramBins
                                        },
                                        containerNode: this.rendererMultiAttributesStack,
                                        region: "top"
                                    });
                                    leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                                    leftPanel.sc.startup();
                                    leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                                    leftPanel.visibleStack = "rendererMultiAttributesStack";
                                    D.byId("rendererMultiAttributesPanel").adjustHeight()
                                }))
                            }))
                    }))
                },
                _goToAgeColorSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({
                        id: "rendererMultiAttributesStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.renderer.authoringInfo && this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables),
                        a = a && a.field;
                    this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    var b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(a).then(g.hitch(this, function(a) {
                        this._rendererAttribute.set("value", a.name);
                        this.getAttributeItem(b ? b.field || "customExpr2" : this.renderer.attributeField || this.renderer.field, b && b.valueExpression, b && b.valueExpressionTitle).then(g.hitch(this, function(b) {
                            this._rendererAttribute2.set("value", b.name);
                            this.setTypeOptions(a, b);
                            this.galleryList.selectItem("ageColorSize");
                            this.rendererMultiAttributesPanel = new u({
                                id: "rendererMultiAttributesPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: b,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    hasDateField: this.hasDateField,
                                    countDateFields: this.countDateFields,
                                    showDateFields: this.showDateFields,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererMultiAttributesStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                            leftPanel.visibleStack = "rendererMultiAttributesStack";
                            D.byId("rendererMultiAttributesPanel").adjustHeight()
                        }))
                    }))
                },
                _goToColorAgeSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({
                        id: "rendererMultiAttributesStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                        b = this.renderer.authoringInfo && this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables),
                        c = b && b.field;
                    this.getAttributeItem(a ? a.field || "customExpr" : this.renderer.attributeField || this.renderer.field, a && a.valueExpression, a && a.valueExpressionTitle).then(g.hitch(this,
                        function(a) {
                            this._rendererAttribute.set("value", a.name);
                            this.getAttributeItem(c).then(g.hitch(this, function(b) {
                                this._rendererAttribute2.set("value", b.name);
                                this.setTypeOptions(a, b);
                                this.galleryList.selectItem("colorAgeSize");
                                this.rendererMultiAttributesPanel = new u({
                                    id: "rendererMultiAttributesPanel",
                                    params: {
                                        portalPanel: this,
                                        subLayerId: this.subLayerId,
                                        mapLayer: this.mapLayer,
                                        layer: this.layer,
                                        fLayer: this.fLayer,
                                        renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                        geometryType: this.geometryType,
                                        origRenderer: this.origRenderer,
                                        isHosted: this.isHosted,
                                        isFeatColl: this.isFeatColl,
                                        isCSV: this.isCSV,
                                        isSL: this.isSL,
                                        isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                        hasDynamic: this.hasDynamic,
                                        newDMS: this.newDMS,
                                        hasFeatureReduction: this.hasFeatureReduction,
                                        attributeItem: a,
                                        attributeItem2: b,
                                        attributesStore: this.attributesStore,
                                        hasNumericField: this.hasNumericField,
                                        hasDateField: this.hasDateField,
                                        countDateFields: this.countDateFields,
                                        showDateFields: this.showDateFields,
                                        numHistogramBins: this.numHistogramBins
                                    },
                                    containerNode: this.rendererMultiAttributesStack,
                                    region: "top"
                                });
                                leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                                leftPanel.sc.startup();
                                leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                                leftPanel.visibleStack = "rendererMultiAttributesStack";
                                D.byId("rendererMultiAttributesPanel").adjustHeight()
                            }))
                        }))
                },
                _goToUniqueAgeSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.rendererMultiAttributesStack || (this.rendererMultiAttributesStack = new q({
                        id: "rendererMultiAttributesStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    }));
                    this.rendererMultiAttributesPanel && this.rendererMultiAttributesPanel.destroy();
                    var a = this.renderer.authoringInfo && this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables),
                        b = a && a.field;
                    this.getAttributeItem(this.renderer.valueExpression ? "customExpr" : this.renderer.attributeField || this.renderer.field, this.renderer.valueExpression, this.renderer.valueExpressionTitle).then(g.hitch(this, function(a) {
                        this.getAttributeItem(b).then(g.hitch(this, function(b) {
                            this.setTypeOptions(a,
                                b);
                            this.galleryList.selectItem("uniqueAgeSize");
                            this.rendererMultiAttributesPanel = new u({
                                id: "rendererMultiAttributesPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: K.fromJson(g.clone(this.renderer.toJson())),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: b,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    hasDateField: this.hasDateField,
                                    countDateFields: this.countDateFields,
                                    showDateFields: this.showDateFields,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererMultiAttributesStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererMultiAttributesStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererMultiAttributesStack);
                            leftPanel.visibleStack =
                                "rendererMultiAttributesStack";
                            D.byId("rendererMultiAttributesPanel").adjustHeight()
                        }))
                    }))
                },
                resetTypeOptions: function() { this.galleryList.resetTypeOptions() },
                resetTypeOptionsClearCheck: function() { this.galleryList.resetTypeOptionsClearCheck() },
                setTypeOptions: function(a, b, d) {
                    this.resetTypeOptions();
                    a = a || this.attributeItem;
                    b = b || this.attributeItem2;
                    d = d || this.attributeItem3;
                    if (a && b && d) {
                        if (this.attributeItem4) e = ["predominance", "predominancesize"];
                        else {
                            var e = ["relationshipSize"];
                            this.showPredominance && "customExpr3" !==
                                d.type && a.name !== d.name && b.name !== d.name && (e = ["predominance", "predominancesize", "relationshipSize"])
                        }
                        this.newStyles && "esriGeometryPolygon" == this.geometryType && e.push("watercolor");
                        "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(e, "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(e, "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(e, "polygon");
                        this.galleryList.setVisible(e)
                    } else if (a &&
                        b) {
                        if (this.isString(a) || this.isString(b)) e = ["uniquesize"], (this.isTypeDate(a) || this.isTypeDate(b)) && e.push("uniqueAgeSize");
                        else if (e = ["colorsize"], this.isTypeDate(a) && this.isTypeDate(b) || e.push("uniquesize"), a.name == b.name || this.isTypeDate(a) || this.isTypeDate(b) || a.valueExpression || b.valueExpression || (e.push("ratio"), e.push("relationship"), this.showPredominance && (e.push("predominance"), e.push("predominancesize")), this.newStyles && "esriGeometryPolygon" == this.geometryType && e.push("watercolor")), this.isTypeDate(a) ||
                            this.isTypeDate(b)) this.isTypeDate(a) && e.push("ageColorSize"), this.isTypeDate(b) && e.push("colorAgeSize"), this.isTypeDate(a) || e.push("uniqueAgeSize");
                        "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(e, "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(e, "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(e, "polygon");
                        this.galleryList.setVisible(e)
                    } else a && "none" !== this._rendererAttribute.get("value") ?
                        "multiple" === a.type.toString() ? ("esriGeometryPoint" == this.geometryType ? (this.galleryList.setGeometryType(["simple", "predominance", "watercolor", "heatMap"], "point"), this.hasFeatureReduction || this.hasDynamic || r("ie") && !(9 <= r("ie")) || this.galleryList.setVisible(["heatMap"])) : "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["simple", "predominance", "watercolor"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["simple", "predominance", "watercolor"],
                            "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["simple", "predominance", "watercolor"], "polygon"), this.galleryList.setVisible(["simple", "predominance", "watercolor"])) : "customExpr" === a.type ? (e = [], e = "esriFieldTypeDouble" === a.valueExpressionReturnType ? ["simple", "color", "size", "unique"] : "esriFieldTypeString" === a.valueExpressionReturnType ? ["simple", "unique"] : ["simple", "color", "size", "unique"], "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ?
                            this.galleryList.setGeometryType(e, "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(e, "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(e, "polygon"), this.galleryList.setVisible(e)) : -1 < c.indexOf(["esriFieldTypeInteger", "esriFieldTypeSmallInteger"], a.type) ? ("esriGeometryPoint" == this.geometryType ? (this.galleryList.setGeometryType(["simple", "unique", "color", "size", "heatMap"], "point"), this.hasFeatureReduction || this.hasDynamic || r("ie") &&
                            !(9 <= r("ie")) || this.galleryList.setVisible(["heatMap"])) : "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["simple", "unique", "color", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["simple", "unique", "color", "size"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["simple", "unique", "color", "size"], "polygon"), this.galleryList.setVisible(["simple", "unique", "color", "size"])) : -1 < c.indexOf(["esriFieldTypeDouble",
                            "esriFieldTypeSingle"
                        ], a.type) ? ("esriGeometryPoint" == this.geometryType ? (this.galleryList.setGeometryType(["simple", "color", "size", "heatMap", "unique"], "point"), this.hasFeatureReduction || this.hasDynamic || r("ie") && !(9 <= r("ie")) || this.galleryList.setVisible(["heatMap"])) : "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["simple", "color", "size", "unique"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["simple", "color", "size", "unique"], "line") :
                            "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["simple", "color", "size", "unique"], "polygon"), this.galleryList.setVisible(["simple", "color", "size", "unique"])) : "esriFieldTypeDate" == a.type.toString() ? (e = "color size unique simple ageColor ageSize".split(" "), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(e, "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(e, "line") : "esriGeometryPolygon" ==
                            this.geometryType && this.galleryList.setGeometryType(e, "polygon"), this.galleryList.setVisible(e)) : ("esriGeometryPoint" == this.geometryType ? this.galleryList.setGeometryType(["simple", "unique"], "point") : "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["simple", "unique"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["simple", "unique"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["simple", "unique"],
                            "polygon"), this.galleryList.setVisible(["simple", "unique"])) : this.hasRendererCustomExpression(null, "firstVar") && "customExpr" === this._rendererAttribute.get("value") ? (e = [], a = this.getRendererStyle(this.renderer), "type" === a ? e.push("unique") : "classedColor" === a ? e.push("color") : "classedSize" === a ? e.push("size") : e.push(a), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(e, "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(e,
                            "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(e, "polygon"), this.galleryList.setVisible(e)) : ("esriGeometryPoint" == this.geometryType ? (this.galleryList.setGeometryType(["simple", "heatMap"], "point"), this.hasFeatureReduction || this.hasDynamic || r("ie") && !(9 <= r("ie")) || this.galleryList.setVisible(["heatMap"])) : "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["simple"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["simple"],
                            "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["simple"], "polygon"), this.galleryList.setVisible(["simple"]));
                    this.newStyles && this.hasCopyStyleLayers() && (this.galleryList.setVisible(["copyStyle"]), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["copyStyle"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["copyStyle"], "line") : "esriGeometryPolygon" == this.geometryType &&
                        this.galleryList.setGeometryType(["copyStyle"], "polygon"))
                },
                getAttributeStore: function() {
                    if (!this.attributesStore) {
                        var a = arcgisonline.map.table.getPopupInfo(this.mapLayer, this.mapLayer.layer instanceof P ? null : this.subLayerId),
                            b = function(b) { if (a && a.fieldInfos) { var c; for (c = 0; c < a.fieldInfos.length; c++) { var d = a.fieldInfos[c]; if (d.fieldName == b) return d.label } } return null };
                        this.attributesCount = { number: 0, string: 0, date: 0 };
                        var d = this.getRendererType(this.renderer),
                            e = this.getVisualVariableByType("colorInfo",
                                null, this.renderer.visualVariables),
                            f = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                        (e = this.renderer.attributeField || this.renderer.field || this.renderer.fields || e && e.field || f && f.field) && "string" === typeof e && -1 < c.indexOf(N.excludedFields, e.toLowerCase()) && N.excludedFields.splice(c.indexOf(N.excludedFields, e.toLowerCase()), 1);
                        this.layer.objectIdField && N.excludedFields.push(this.layer.objectIdField.toLowerCase());
                        var e = this._getLayerFields(),
                            n = [];
                        c.forEach(e, g.hitch(this,
                            function(a, d) {
                                if (-1 === c.indexOf(N.excludedFields, a.name.toLowerCase()) && -1 < c.indexOf("esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID".split(" "), a.type)) {
                                    var e = d = arcgisonline.sharing.util.htmlEncode(b(a.name) || a.alias || a.name);
                                    "esriFieldTypeDate" === a.type && (e = this.newStyles ? '\x3cspan class\x3d"rendererAttributeDropdownTypeDate"\x3e' + d + "\x3c/span\x3e" : "\x3cspan\x3e" + d + "\x3c/span\x3e");
                                    d = {
                                        name: a.name,
                                        alias: d,
                                        displayName: e,
                                        type: a.type,
                                        hasCodedValues: a.domain && a.domain.codedValues ? "true" : "false"
                                    };
                                    a.domain && a.domain.codedValues && (d.codedValues = m.stringify(a.domain.codedValues));
                                    if (d.codedValues) this.attributesCount.string++;
                                    else switch (a.type) {
                                        case "esriFieldTypeSingle":
                                            this.attributesCount.number++;
                                            break;
                                        case "esriFieldTypeDouble":
                                            this.attributesCount.number++;
                                            break;
                                        case "esriFieldTypeInteger":
                                            this.attributesCount.number++;
                                            break;
                                        case "esriFieldTypeSmallInteger":
                                            this.attributesCount.number++;
                                            break;
                                        case "esriFieldTypeString":
                                            this.attributesCount.string++;
                                            break;
                                        case "esriFieldTypeDate":
                                            this.attributesCount.date++
                                    }
                                    a.description && (a.description.value || a.description.fieldValueType) && (a.description.value && (d.descriptionValue = a.description.value), -1 < dojo.indexOf(["esriFieldTypeSingle", "esriFieldTypeDouble", "esriFieldTypeInteger", "esriFieldTypeSmallInteger"], a.type) && a.description.fieldValueType && (d.descriptionFieldValueType = a.description.fieldValueType));
                                    n.push(d)
                                }
                            }));
                        n = n.sort(function(a, c) {
                            a = (b(a.name) || a.alias || a.name).toLowerCase();
                            c = (b(c.name) || c.alias ||
                                c.name).toLowerCase();
                            return a == c ? 0 : a < c ? -1 : 1
                        });
                        n.splice(0, 0, { name: " ", alias: " ", displayName: " ", type: "blank" });
                        n.splice(0, 0, { name: "_total_", alias: h.substitute(this.i18n.total, { field: " " }), displayName: h.substitute(this.i18n.total, { field: " " }), type: "total" });
                        n.splice(0, 0, { name: "_" + this.i18n.none + "_", alias: this.i18n.none, displayName: this.i18n.none, type: "none" });
                        n.splice(0, 0, { name: "showLocationOnly", alias: this.i18n.showLocationOnly, displayName: this.i18n.showLocationOnly, type: "showLocationOnly" });
                        n.splice(0,
                            0, { name: "separator", type: "separator" });
                        n.splice(0, 0, { name: "fixedDate", alias: this.i18n.fixedDate, displayName: "\x26lt;" + this.i18n.fixedDate + "\x26gt;", type: "fixedDate" });
                        if (!this.hasDynamic || this.newDMS) {
                            n.push({ name: "expressionSeparator", type: "separator" });
                            var q; - 1 === c.indexOf(["ageColor", "ageSize", "ageColorSize"], d) && (q = this.getRendererCustomExpression(null, "firstVar"));
                            n.push({
                                name: "customExpr",
                                alias: "Custom Expression",
                                displayName: q && q.title ? h.substitute(this.i18n.customExpression, { name: q.title }) : this.i18n.newExpression,
                                valueExpression: q && q.valueExpression,
                                valueExpressionReturnType: q && q.returnType,
                                valueExpressionTitle: q && q.title,
                                type: "customExpr"
                            });
                            q = null; - 1 === c.indexOf(["colorAgeSize", "uniqueAgeSize"], d) && (q = this.getRendererCustomExpression(null, "secondVar"));
                            n.push({
                                name: "customExpr2",
                                alias: "Custom Expression2",
                                displayName: q && q.title ? h.substitute(this.i18n.customExpression, { name: q.title }) : this.i18n.newExpression,
                                valueExpression: q && q.valueExpression,
                                valueExpressionReturnType: q && q.returnType,
                                valueExpressionTitle: q && q.title,
                                type: "customExpr2"
                            });
                            q = null; - 1 < c.indexOf(["relationshipSize"], d) && (q = this.getRendererCustomExpression(null, "thirdVar"));
                            n.push({ name: "customExpr3", alias: "Custom Expression3", displayName: q && q.title ? h.substitute(this.i18n.customExpression, { name: q.title }) : this.i18n.newExpression, valueExpression: q && q.valueExpression, valueExpressionReturnType: q && q.returnType, valueExpressionTitle: q && q.title, type: "customExpr3" });
                            q = this.getRendererCustomExpression(null, "transparency");
                            n.push({
                                name: "customExprTrans",
                                alias: "Transparency Expression",
                                displayName: q && q.title ? h.substitute(this.i18n.customExpression, { name: q.title }) : this.i18n.newExpression,
                                valueExpression: q && q.valueExpression,
                                valueExpressionReturnType: q && q.returnType,
                                valueExpressionTitle: q && q.title,
                                type: "transExpr"
                            });
                            q = this.getRendererCustomExpression(null, "rotation");
                            n.push({
                                name: "customExprRotation",
                                alias: "Rotation Expression",
                                displayName: q && q.title ? h.substitute(this.i18n.customExpression, { name: q.title }) : this.i18n.newExpression,
                                valueExpression: q &&
                                    q.valueExpression,
                                valueExpressionReturnType: q && q.returnType,
                                valueExpressionTitle: q && q.title,
                                type: "rotationExpr"
                            })
                        }
                        this.attributesStore = new G({ data: { label: "displayName", identifier: "name", items: n } });
                        this.notSpecialItemsQuery = "NOT type:'none' AND NOT type:'total' AND NOT type:'blank' AND NOT (type:'separator' AND name:'separator') AND NOT type:'percent' AND NOT type:'fixedDate' ";
                        this.firstQuery = "AND NOT type:'customExpr2' AND NOT type:'customExpr3' AND NOT type:'transExpr' AND NOT type:'rotationExpr' ";
                        this.secondQuery = "AND NOT type:'showLocationOnly' AND NOT type:'customExpr' AND NOT type:'customExpr3' AND NOT type:'transExpr' AND NOT type:'rotationExpr' ";
                        this.thirdQuery = "AND NOT type:'showLocationOnly' AND NOT type:'customExpr' AND NOT type:'customExpr2' AND NOT type:'transExpr' AND NOT type:'rotationExpr' ";
                        this.notFirstToThirdQuery = "AND NOT type:'showLocationOnly' AND NOT (type:'separator' AND name:'expressionSeparator') AND NOT type:'customExpr' AND NOT type:'customExpr2' AND NOT type:'customExpr3' AND NOT type:'transExpr' AND NOT type:'rotationExpr' "
                    }
                },
                fillRendererAttribute: function() {
                    this.attributesStore || (this.getAttributeStore(), this.hasRendererCustomExpression(null, "firstVar") ? this.showDateFields ? this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry'" }) : this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate'" }) :
                        (this.renderer.attributeField || this.renderer.field || this.renderer.fields) === this.layer.objectIdField ? this.showDateFields ? this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry'" }) : this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate'" }) :
                        this.showDateFields ? this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT name:'" + this.layer.objectIdField + "'" }) : this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, {
                            query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT name:'" +
                                this.layer.objectIdField + "'"
                        }), this._rendererAttribute.dropDown.on("itemClick", g.hitch(this, function(a) { "customExpr" === a.params.option.value && this.adjustHeight() })), this._rendererAttribute2.dropDown.on("itemClick", g.hitch(this, function(a) { "customExpr2" === a.params.option.value && this.adjustHeight() })))
                },
                removeCustomExpr: function() {
                    var a = this._rendererAttribute.get("value");
                    this.showDateFields ? this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, {
                        query: this.notSpecialItemsQuery +
                            this.firstQuery + "AND NOT type:'esriFieldTypeOID' ND NOT type:'esriFieldTypeGeometry' AND NOT name:'" + this.layer.objectIdField + "'"
                    }) : this._rendererAttribute.setStore(this.attributesStore, this.i18n.showLocationOnly, { query: this.notSpecialItemsQuery + this.firstQuery + "AND NOT type:'esriFieldTypeOID' AND NOT type:'esriFieldTypeGeometry' AND NOT type:'esriFieldTypeDate' AND NOT name:'" + this.layer.objectIdField + "'" });
                    this._rendererAttribute.set("value", a, !1)
                },
                hasCopyStyleLayers: function() {
                    return this.hasDynamic ?
                        c.some(this.mapLayers, function(a) { if (a.url === this.mapLayer.url && this.mapLayer.id !== a.id) return a.layer.dynamicLayerInfos ? c.some(a.layer.dynamicLayerInfos, function(a) { return a.source.mapLayerId === this.fLayer.source.mapLayerId }, this) : !0 }, this) : c.some(this.mapLayers, function(a) { return a.url === this.layer.url && this.layer.id !== a.id }, this)
                },
                loadCopyStyleLayers: function() {
                    var a = [];
                    this.hasDynamic ? c.forEach(this.mapLayers, function(b) {
                        b.url === this.mapLayer.url && this.mapLayer.id !== b.id && (b.layer.dynamicLayerInfos ?
                            c.forEach(b.layer.dynamicLayerInfos, function(c) { c.source.mapLayerId === this.fLayer.source.mapLayerId && a.push({ id: b.id, title: b.title + " - " + this.layer.name }) }, this) : c.forEach(b.layersInfo.layers, function(c) { c.id === this.fLayer.source.mapLayerId && a.push({ id: b.id, title: b.title + " - " + c.name }) }, this))
                    }, this) : c.forEach(this.mapLayers, function(b) { b.url === this.layer.url && this.layer.id !== b.id && a.push({ id: b.id, title: b.title }) }, this);
                    return a = a.sort(function(a, b) {
                        a = a.title.toLowerCase();
                        b = b.title.toLowerCase();
                        return a == b ? 0 : a < b ? -1 : 1
                    })
                },
                _onChangeCopyStyleLayer: function(a) {
                    -1 !== a && (this.hasDynamic ? c.forEach(this.mapLayers, function(b) {
                        b.id === a && (b.layer.dynamicLayerInfos ? c.forEach(b.layer.dynamicLayerInfos, function(a) {
                            a.source.mapLayerId === this.fLayer.source.mapLayerId && (a.drawingInfo ? (this.renderer = esri.renderer.fromJson(g.clone(a.drawingInfo.renderer)), this.setRenderer(this.renderer), this.updateUIWithRenderer()) : c.forEach(b.layerInfos.layers, function(a) {
                                a.id === this.fLayer.source.mapLayerId && (this.renderer =
                                    esri.renderer.fromJson(g.clone(a.drawingInfo.renderer)), this.setRenderer(this.renderer), this.updateUIWithRenderer())
                            }, this))
                        }, this) : c.forEach(b.layersInfo.layers, function(a) { a.id === this.fLayer.source.mapLayerId && (this.renderer = esri.renderer.fromJson(g.clone(a.drawingInfo.renderer)), this.setRenderer(this.renderer), this.updateUIWithRenderer()) }, this))
                    }, this) : c.forEach(this.mapLayers, function(b) {
                        b.id === a && (this.renderer = esri.renderer.fromJson(b.layer.renderer.toJson()), this.setRenderer(this.renderer),
                            this.updateUIWithRenderer())
                    }, this))
                },
                _showLoading: function(a) {},
                _hideLoading: function() { this._hideError() },
                _showError: function(a) { n.coords(a) },
                _hideError: function() {},
                _isLoading: function() {},
                _getLayerFields: function() {
                    if (this.hasDynamic) {
                        c.forEach(this.mapLayer.layer.dynamicLayerInfos, function(a) { a.id === this.subLayerId && (layerInfo = a) }, this);
                        var a = this.serviceLayerInfo.fields;
                        return this.mapLayer.thematicGroup && this.mapLayer.thematicGroup.fieldNames && this.mapLayer.thematicGroup.fieldNames.length ?
                            c.filter(a, function(a) { return c.some(this.mapLayer.thematicGroup.fieldNames, function(b) { return b === a.name }, this) }, this) : a
                    }
                    return this.layer.fields
                },
                saveCurrentRenderer: function() {
                    var a = this.getRendererStyle(this.renderer),
                        b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                        c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                        d = this.renderer.attributeField || this.renderer.field,
                        e = this.renderer.authoringInfo && this.renderer.authoringInfo.fields,
                        f = b &&
                        b.field,
                        c = c && c.field;
                    this.renderer.authoringInfo && this.renderer.authoringInfo.visualVariables && (f || (f = (f = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables)) && f.field), c || (c = (c = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables)) && c.field));
                    var g = e && 1 < e.length && this.attributeItem && this.attributeItem2 && e[0] === this.attributeItem.name && e[1] === this.attributeItem2.name;
                    g && (2 < e.length || this.attributeItem3) && (g = 2 < e.length && this.attributeItem3 ?
                        e[2] === this.attributeItem3.name : !1) && (3 < e.length || this.attributeItem4) && (g = 3 < e.length && this.attributeItem4 ? e[3] === this.attributeItem4.name : !1) && (4 < e.length || this.attributeItem5) && (g = 4 < e.length && this.attributeItem5 ? e[4] === this.attributeItem5.name : !1) && (5 < e.length || this.attributeItem6) && (g = 5 < e.length && this.attributeItem6 ? e[5] === this.attributeItem6.name : !1) && (6 < e.length || this.attributeItem7) && (g = 6 < e.length && this.attributeItem7 ? e[6] === this.attributeItem7.name : !1) && (7 < e.length || this.attributeItem8) && (g =
                        7 < e.length && this.attributeItem8 ? e[7] === this.attributeItem8.name : !1) && (8 < e.length || this.attributeItem9) && (g = 8 < e.length && this.attributeItem9 ? e[8] === this.attributeItem9.name : !1) && (9 < e.length || this.attributeItem10) && (g = 9 < e.length && this.attributeItem10 ? e[9] === this.attributeItem10.name : !1);
                    if (g || !(this.attributeItem || d || e || f || c) || this.attributeItem && !this.attributeItem2 && (d === this.attributeItem.name || "ageColor" === a && this.attributeItem.name === f || "ageSize" === a && this.attributeItem.name === c) || this.attributeItem &&
                        this.attributeItem2 && ("ratio" === a && this.attributeItem.name === f && this.attributeItem2.name === b.normalizationField || "colorsize" === a && this.attributeItem.name === f && this.attributeItem2.name === c || "uniquesize" === a && this.attributeItem.name === d && this.attributeItem2.name === c || "ageColorSize" === a && this.attributeItem.name === f && this.attributeItem2.name === c || "colorAgeSize" === a && this.attributeItem.name === f && this.attributeItem2.name === c || "uniqueAgeSize" === a && this.attributeItem.name === d && this.attributeItem2.name ===
                            c)) a = { renderer: this.renderer.toJson() }, a.renderer && !arcgisonline.isEmpty(a.renderer) && (this.scheme && (a.scheme = this.scheme), a.opacity = (this.fLayer || this.layer).opacity, this.savedRenderers[this.getRendererType(this.renderer)] = a)
                },
                clearSavedRenderers: function() {
                    var a = this.savedRenderers.customExpr;
                    this.savedRenderers = {};
                    a && (this.savedRenderers.customExpr = a)
                },
                checkAddAndSwitchIcons: function() {
                    x.set(this._rendererEditExpression, "display", "none");
                    x.set(this._rendererEditExpression2, "display", "none");
                    x.set(this._rendererEditExpression3,
                        "display", "none");
                    x.set(this._rendererFieldDescription, "display", "none");
                    x.set(this._rendererFieldDescription2, "display", "none");
                    x.set(this._rendererFieldDescription3, "display", "none");
                    x.set(this._rendererFieldDescription4, "display", "none");
                    x.set(this._rendererFieldDescription5, "display", "none");
                    x.set(this._rendererFieldDescription6, "display", "none");
                    x.set(this._rendererFieldDescription7, "display", "none");
                    x.set(this._rendererFieldDescription8, "display", "none");
                    x.set(this._rendererFieldDescription9,
                        "display", "none");
                    x.set(this._rendererFieldDescription10, "display", "none");
                    this.attributeItem ? this.attributeItem2 ? this.attributeItem3 ? this.attributeItem4 ? (x.set(this._rendererSwitchAttribute12, "display", "none"), !this.attributeItem10 && this.attributeItem9 && 9 < this.attributesCount.number || !this.attributeItem9 && 8 < this.attributesCount.number || !this.attributeItem8 && 7 < this.attributesCount.number || !this.attributeItem7 && 6 < this.attributesCount.number || !this.attributeItem6 && 5 < this.attributesCount.number || !this.attributeItem5 &&
                        4 < this.attributesCount.number || !this.attributeItem4 && 3 < this.attributesCount.number ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none")) : "customExpr3" === this.attributeItem3.type && this.attributeItem3.valueExpression ? (x.set(this._rendererEditExpression3, "display", ""), x.set(this._rendererSwitchAttribute12, "display", ""), x.set(this._rendererAddAttribute, "display", "none")) : -1 < c.indexOf(["relationshipSize"], this.getRendererStyle(this.renderer)) ? (x.set(this._rendererSwitchAttribute12,
                        "display", ""), 3 < this.attributesCount.number && this.showPredominance && this.attributeItem.name !== this.attributeItem3.name && this.attributeItem2.name !== this.attributeItem3.name ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none")) : (x.set(this._rendererSwitchAttribute12, "display", "none"), 3 < this.attributesCount.number ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none")) : (this.isNumber(this.attributeItem) && this.isNumber(this.attributeItem2) ?
                        this.attributeItem.name !== this.attributeItem2.name ? (-1 < c.indexOf(["predominance", "predominancesize"], this.getRendererStyle(this.renderer)) ? x.set(this._rendererSwitchAttribute12, "display", "none") : -1 < c.indexOf(["uniquesize"], this.getRendererStyle(this.renderer)) && (this.isInFieldValueType(this.attributeItem, "string") || this.isInFieldValueType(this.attributeItem2, "string")) ? x.set(this._rendererSwitchAttribute12, "display", "none") : x.set(this._rendererSwitchAttribute12, "display", ""), 2 < this.attributesCount.number &&
                            this.isTypeNumber(this.attributeItem) && this.isTypeNumber(this.attributeItem2) ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none")) : (x.set(this._rendererSwitchAttribute12, "display", "none"), x.set(this._rendererAddAttribute, "display", "none")) : (x.set(this._rendererSwitchAttribute12, "display", "none"), x.set(this._rendererAddAttribute, "display", "none")), "customExpr" === this.attributeItem.type && this.attributeItem.valueExpression && x.set(this._rendererEditExpression,
                            "display", ""), "customExpr2" === this.attributeItem2.type && this.attributeItem2.valueExpression && x.set(this._rendererEditExpression2, "display", "")) : (x.set(this._rendererSwitchAttribute12, "display", "none"), (!this.hasDynamic || this.newDMS) && 1 < this.attributesCount.number + this.attributesCount.string + this.attributesCount.date && 0 < this.attributesCount.number + this.attributesCount.date ? x.set(this._rendererAddAttribute, "display", "") : x.set(this._rendererAddAttribute, "display", "none"), "customExpr" === this.attributeItem.type &&
                        this.attributeItem.valueExpression && x.set(this._rendererEditExpression, "display", "")) : (x.set(this._rendererSwitchAttribute12, "display", "none"), x.set(this._rendererAddAttribute, "display", "none"));
                    this.attributeItem && this.attributeItem.descriptionValue && x.set(this._rendererFieldDescription, "display", "");
                    this.attributeItem2 && this.attributeItem2.descriptionValue && x.set(this._rendererFieldDescription2, "display", "");
                    this.attributeItem3 && this.attributeItem3.descriptionValue && x.set(this._rendererFieldDescription3,
                        "display", "");
                    this.attributeItem4 && this.attributeItem4.descriptionValue && x.set(this._rendererFieldDescription4, "display", "");
                    this.attributeItem5 && this.attributeItem5.descriptionValue && x.set(this._rendererFieldDescription5, "display", "");
                    this.attributeItem6 && this.attributeItem6.descriptionValue && x.set(this._rendererFieldDescription6, "display", "");
                    this.attributeItem7 && this.attributeItem7.descriptionValue && x.set(this._rendererFieldDescription7, "display", "");
                    this.attributeItem8 && this.attributeItem8.descriptionValue &&
                        x.set(this._rendererFieldDescription8, "display", "");
                    this.attributeItem9 && this.attributeItem9.descriptionValue && x.set(this._rendererFieldDescription9, "display", "");
                    this.attributeItem10 && this.attributeItem10.descriptionValue && x.set(this._rendererFieldDescription10, "display", "");
                    this._doneButton && this._doneButton.set("disabled", !1);
                    this.adjustHeight()
                },
                canSwitchToDefaultStyle: function() {
                    var a, b, c = this.fLayer || this.layer,
                        d;
                    if (!c.url) return !1;
                    d = this.hasDynamic ? this.fLayer.source.mapLayerId : parseInt(c.url.substring(c.url.lastIndexOf("/") +
                        1, c.url.length));
                    this.mapLayer.origItemLayers && (a = arcgisonline.map.main.getItemWithSourceMapLayerId(this.mapLayer.origItemLayers, d));
                    this.mapLayer.itemLayers && (b = arcgisonline.map.main.getItemWithSourceMapLayerId(this.mapLayer.itemLayers, d));
                    var c = a && a.layerDefinition && a.layerDefinition.drawingInfo && a.layerDefinition.drawingInfo.renderer,
                        e;
                    !this.hasDynamic && this.mapLayer.serviceInfo ? e = this.mapLayer.serviceInfo : this.hasDynamic && this.mapLayer.layersInfo && (e = arcgisonline.map.main.getItemWithId(this.mapLayer.layersInfo.layers,
                        d));
                    if (!this.hasDynamic && this.mapLayer.rendererChanged && (c || e && e.drawingInfo && e.drawingInfo.renderer)) { if (b = this.renderer.toJson(), c && f.toJson(a.layerDefinition.drawingInfo.renderer) !== f.toJson(b) || !c && f.toJson(e.drawingInfo.renderer) !== f.toJson(b)) return !0 } else if (this.hasDynamic && b && b.layerDefinition && b.layerDefinition.drawingInfo && b.layerDefinition.drawingInfo.renderer && (c || e && e.drawingInfo && e.drawingInfo.renderer) && (c && f.toJson(b.layerDefinition.drawingInfo.renderer) !== f.toJson(a.layerDefinition.drawingInfo.renderer) ||
                            !c && f.toJson(b.layerDefinition.drawingInfo.renderer) !== f.toJson(e.drawingInfo.renderer))) return !0;
                    return !1
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel && "rendererStack" == leftPanel.visibleStack) {
                        a = n.coords(p.byId("leftContentStackContainer")).w - 10;
                        if (0 < a) {
                            x.set(p.byId("rendererGalleryPane"), "width", a + "px");
                            a -= 20;
                            var b = 0;
                            if ("none" !== x.get(this._rendererEditExpression, "display") || "none" !== x.get(this._rendererEditExpression2, "display") || "none" !== x.get(this._rendererEditExpression3, "display") ||
                                "none" !== x.get(this._rendererFieldDescription, "display") || "none" !== x.get(this._rendererFieldDescription2, "display") || "none" !== x.get(this._rendererFieldDescription3, "display") || "none" !== x.get(this._rendererFieldDescription4, "display") || "none" !== x.get(this._rendererFieldDescription5, "display") || "none" !== x.get(this._rendererFieldDescription6, "display") || "none" !== x.get(this._rendererFieldDescription7, "display") || "none" !== x.get(this._rendererFieldDescription8, "display") || "none" !== x.get(this._rendererFieldDescription9,
                                    "display") || "none" !== x.get(this._rendererFieldDescription10, "display")) b = 30;
                            var d = a - b - 75;
                            c.forEach(this._rendererAttributes, function(a) { a && (x.set(a.domNode, "width", d + "px"), v(".dijitSelectLabel", a.domNode).style("maxWidth", d - 31 + "px")) });
                            x.set(this._rendererTypes, "width", a + "px");
                            a = Math.min(a - 15, 500);
                            v(".rendererType").style("width", a + "px");
                            v(".rendererTypeThumb").style("width", a - 20 + "px");
                            v(".rendererCopyStyleDropDownMenu").style("width", a - 30 + "px");
                            b = 300 < a ? 150 : Math.min(a / 2, 150);
                            v(".rendererTypeThumb").style("height",
                                b + "px");
                            300 > a ? v(".rendererTypeThumb").style("backgroundSize", "cover") : v(".rendererTypeThumb").style("backgroundSize", "500px 150px");
                            var e = 0;
                            v(".rendererTitleText").forEach(function(a) { e = Math.max(e, n.coords(a).h) });
                            a = (b - e) / 2 - 17;
                            v(".rendererSelect").style("top", a + "px");
                            v(".rendererOptions").style("top", a + "px")
                        }
                        a = n.coords(p.byId("leftContentStackContainer")).h;
                        var e = n.coords(p.byId("rendererHeader")).h,
                            b = n.coords(this._doneButton.domNode).h,
                            f = n.coords(p.byId("rendererFooter_links")).h + 10;
                        x.set(p.byId("rendererContentFooter"),
                            "height", f + "px");
                        a = a - e - b - f - 24;
                        x.set(p.byId("rendererGalleryPane"), "height", a + "px")
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Gallery", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/MultiAttributes": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/connect dojo/_base/array dojo/dom dojo/has dojo/query dojo/dom-style dojo/dom-class dojox/html/entities dijit/registry esri/symbols/jsonUtils esri/renderers/jsonUtils esri/styles/choropleth arcgisonline/map/dijit/renderer/_GalleryMixin arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_ColorMixin arcgisonline/map/dijit/renderer/GalleryList dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/MultiAttributes.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J) {
            b = b([A, H], {
                declaredClass: "arcgisonline.map.dijit.renderer.MultiAttributes",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererMultiAttributes",
                widgetsInTemplate: !0,
                templateString: J,
                _rConnects: null,
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                constructor: function(a, b) {
                    g.mixin(this, x);
                    g.mixin(this, B);
                    g.mixin(this, E);
                    g.mixin(this, G);
                    a && (a.containerNode &&
                        (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.galleryList.destroy();
                    this.destroyBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    c.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = D.common;
                    g.mixin(this.i18n, D.generalDlg);
                    g.mixin(this.i18n, D.viewer.time);
                    g.mixin(this.i18n, D.rendererCommon);
                    g.mixin(this.i18n,
                        D.rendererGalleryPanel);
                    g.mixin(this.i18n, D.rendererMultiAttributesPanel)
                },
                postCreate: function() {
                    this.container.addChild(r.byId("rendererMultiAttributesPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(r.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    this.galleryList = new F({ selectHandler: g.hitch(this, "_onSelectListItem"), optionsHandler: g.hitch(this, "_onOptions") }, this._rendererTypesList)
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup(); - 1 < dojo.indexOf(["predominance", "predominancesize"], this.getRendererStyle(this.renderer)) && this.portalPanel.updateAttributeDropdownsFromRenderer(this.renderer.authoringInfo.fields);
                    leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    leftPanel.switchToRendererStack(this.renderer)
                },
                _onClose: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    leftPanel.switchToRendererStack(this.renderer)
                },
                externalCancel: function() {
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    this.hideBusy();
                    this.destroyMultipleFieldsPopup();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    this.properClose = !0
                },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererMultiAttributesFooterDiv"),
                        "display", "");
                    this.galleryList ? this._init() : setTimeout(g.hitch(this, function() { this.startup() }), 1)
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererMultiAttributesHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this._rendererMultiAttributesLayer.innerHTML = p.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.layer.name && this.mapLayer.title !== this.layer.name && (this._rendererMultiAttributesLayer.innerHTML +=
                        " - " + p.encode(this.layer.name.replace(/\_/g, " ")));
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                    this.showLegendPopup();
                    this.basemapSwitchHandler && a.unsubscribe(this.basemapSwitchHandler);
                    this.basemapSwitchHandler = a.subscribe("basemapSwitch", g.hitch(this, function() {
                        if ("rendererMultiAttributesStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack() && "colorsize" === this.getRendererType(this.renderer)) {
                            var a = this.getVisualVariableByType("colorInfo",
                                null, this.renderer.authoringInfo.visualVariables);
                            this.scheme = t.getSchemes({ theme: a && a.theme ? a.theme : "high-to-low", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme;
                            a = this.updateSchemeOnColorRenderer({ scheme: this.scheme });
                            this.applyColorRenderer(a, null, !0)
                        }
                    }))
                },
                updateUIWithRenderer: function() {
                    -1 < dojo.indexOf("colorsize ageColorSize colorAgeSize uniquesize uniqueAgeSize predominancesize relationshipSize".split(" "), this.getRendererStyle(this.renderer)) && (this.buildList(),
                        this.setTypeOptions(this.attributeItem, this.attributeItem2, this.attributeItem3), this.selectTypeBox())
                },
                selectTypeBox: function() {
                    switch (this.getRendererStyle(this.renderer)) {
                        case "colorsize":
                            this.galleryList.selectItem("color", !0);
                            this.galleryList.selectItem("size", !0);
                            break;
                        case "ageColorSize":
                            this.galleryList.selectItem("ageColor", !0);
                            this.galleryList.selectItem("size", !0);
                            break;
                        case "colorAgeSize":
                            this.galleryList.selectItem("color", !0);
                            this.galleryList.selectItem("ageSize", !0);
                            break;
                        case "uniquesize":
                            this.galleryList.selectItem("unique", !0);
                            this.galleryList.selectItem("size", !0);
                            break;
                        case "uniqueAgeSize":
                            this.galleryList.selectItem("unique", !0);
                            this.galleryList.selectItem("ageSize", !0);
                            break;
                        case "predominancesize":
                            this.galleryList.selectItem("predominance", !0);
                            this.galleryList.selectItem("size", !0);
                            break;
                        case "relationshipSize":
                            this.galleryList.selectItem("relationship", !0), this.galleryList.selectItem("size", !0)
                    }
                    this.adjustHeight()
                },
                resetTypeOptions: function() { this.galleryList.resetTypeOptions() },
                setTypeOptions: function(a, b, c) {
                    this.resetTypeOptions();
                    if ("colorsize" === this.getRendererStyle(this.renderer)) this.galleryList.setFieldInfo("color", a.valueExpression ? a.valueExpressionTitle : a.alias), this.galleryList.setFieldInfo("size", b.valueExpression ? b.valueExpressionTitle : b.alias), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["color", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["color", "size"], "line") : "esriGeometryPolygon" == this.geometryType &&
                        this.galleryList.setGeometryType(["color", "size"], "polygon"), this.galleryList.setVisible(["color", "size"]);
                    else if ("ageColorSize" === this.getRendererStyle(this.renderer)) this.galleryList.setFieldInfo("ageColor", a.alias), this.galleryList.setFieldInfo("size", b.valueExpression ? b.valueExpressionTitle : b.alias), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["ageColor", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["ageColor",
                        "size"
                    ], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["ageColor", "size"], "polygon"), this.galleryList.setVisible(["ageColor", "size"]);
                    else if ("colorAgeSize" === this.getRendererStyle(this.renderer)) this.galleryList.setFieldInfo("color", a.valueExpression ? a.valueExpressionTitle : a.alias), this.galleryList.setFieldInfo("ageSize", b.alias), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["color", "ageSize"],
                        "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["color", "ageSize"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["color", "ageSize"], "polygon"), this.galleryList.setVisible(["color", "ageSize"]);
                    else if ("uniquesize" === this.getRendererStyle(this.renderer)) c = this.getFieldForUniqueRenderer(a, b), a = this.getFieldForSizeRenderer(a, b), this.galleryList.setFieldInfo("unique", c.valueExpression ? c.valueExpressionTitle : c.alias), this.galleryList.setFieldInfo("size",
                        a.valueExpression ? a.valueExpressionTitle : a.alias), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["unique", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["unique", "size"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["unique", "size"], "polygon"), this.galleryList.setVisible(["unique", "size"]);
                    else if ("uniqueAgeSize" === this.getRendererStyle(this.renderer)) c =
                        this.getFieldForUniqueRenderer(a, b), this.galleryList.setFieldInfo("unique", c.valueExpression ? c.valueExpressionTitle : c.alias), this.galleryList.setFieldInfo("ageSize", this.getFieldForSizeRenderer(a, b).alias), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["unique", "ageSize"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["unique", "ageSize"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["unique",
                            "ageSize"
                        ], "polygon"), this.galleryList.setVisible(["unique", "ageSize"]);
                    else if ("predominancesize" === this.getRendererStyle(this.renderer)) this.galleryList.setFieldInfo("predominance", ""), this.galleryList.setFieldInfo("size", this.i18n.sumOfCategories), "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["predominance", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["predominance", "size"], "line") :
                        "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["predominance", "size"], "polygon"), this.galleryList.setVisible(["predominance", "size"]);
                    else if ("relationshipSize" === this.getRendererStyle(this.renderer)) {
                        var d = this.i18n.relationshipBetween,
                            d = d + "\x3cul\x3e" + ("\x3cli\x3e" + a.alias + "\x3c/li\x3e"),
                            d = d + ("\x3cli\x3e" + b.alias + "\x3c/li\x3e");
                        this.galleryList.setFieldInfo("relationship", d + "\x3c/ul\x3e");
                        this.galleryList.setFieldInfo("size", c.valueExpression ? c.valueExpressionTitle :
                            c.alias);
                        "esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType ? this.galleryList.setGeometryType(["relationship", "size"], "point") : "esriGeometryPolyline" == this.geometryType ? this.galleryList.setGeometryType(["relationship", "size"], "line") : "esriGeometryPolygon" == this.geometryType && this.galleryList.setGeometryType(["relationship", "size"], "polygon");
                        this.galleryList.setVisible(["relationship", "size"])
                    }
                },
                updateAttributeDropdownsFromRenderer: function(a) {
                    this.galleryList.setFieldInfo("predominance",
                        "")
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel && "rendererMultiAttributesStack" == leftPanel.visibleStack) {
                        a = n.coords(d.byId("leftContentStackContainer")).h;
                        var b = n.coords(d.byId("rendererMultiAttributesHeader")).h,
                            c = n.coords(this._rendererTitle1).h,
                            f = n.coords(this._doneButton.domNode).h,
                            g = n.coords(d.byId("rendererMultiAttributesFooter_links")).h + 10;
                        h.set(d.byId("rendererMultiAttributesFooterDiv"), "height", g + "px");
                        a = a - b - c - f - g - 53;
                        0 < a && h.set(this._rendererTypes, "height", a + "px");
                        a = n.coords(d.byId("leftContentStackContainer")).w -
                            10;
                        0 < a && (h.set(d.byId("rendererMultiAttributesPane"), "width", a + "px"), h.set(this._rendererTypes, "width", a + "px"), a = Math.min(a - 15, 500), e(".rendererType").style("width", a + "px"), e(".rendererTypeThumb").style("width", a - 20 + "px"), c = 300 < a ? 150 : Math.min(a / 2, 150), e(".rendererTypeThumb").style("height", c + "px"), 300 > a ? e(".rendererTypeThumb").style("backgroundSize", "cover") : e(".rendererTypeThumb").style("backgroundSize", "500px 150px"), b = 0, e(".rendererTitleText").forEach(function(a) { b = Math.max(b, n.coords(a).h) }),
                            a = (c - b) / 2 - 17, e(".rendererSelect").style("top", a + "px"), e(".rendererOptions").style("top", a + "px"))
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.MultiAttributes", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_GalleryMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/string dojo/Deferred dijit/registry esri/renderers/jsonUtils dijit/layout/BorderContainer arcgisonline/map/dijit/renderer/UniqueValues arcgisonline/map/dijit/renderer/Color arcgisonline/map/dijit/renderer/Size arcgisonline/map/dijit/renderer/AgeColor arcgisonline/map/dijit/renderer/AgeSize arcgisonline/map/dijit/renderer/Predominance arcgisonline/map/dijit/renderer/Relationship".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w) {
            return {
                _onOptions: function(a) {
                    switch (a) {
                        case "simple":
                            this._goToSimplePanel();
                            break;
                        case "type":
                        case "unique":
                            this._goToUniqueValuesPanel();
                            break;
                        case "color":
                            this._goToColorPanel();
                            break;
                        case "classedColor":
                            this._goToColorPanel();
                            break;
                        case "ageColor":
                            this._goToAgeColorPanel();
                            break;
                        case "size":
                            this._goToSizePanel();
                            break;
                        case "classedSize":
                            this._goToSizePanel();
                            break;
                        case "ageSize":
                            this._goToAgeSizePanel();
                            break;
                        case "heatMap":
                            this._goToHeatMapPanel();
                            break;
                        case "predominance":
                            this._goToPredominancePanel();
                            break;
                        case "predominancesize":
                            this._goToPredominanceSizePanel();
                            break;
                        case "colorsize":
                            this._goToColorSizePanel();
                            break;
                        case "ageColorSize":
                            this._goToAgeColorSizePanel();
                            break;
                        case "colorAgeSize":
                            this._goToColorAgeSizePanel();
                            break;
                        case "uniquesize":
                            this._goToUniqueSizePanel();
                            break;
                        case "uniqueAgeSize":
                            this._goToUniqueAgeSizePanel();
                            break;
                        case "watercolor":
                            break;
                        case "ratio":
                            this._goToRatioPanel();
                            break;
                        case "relationship":
                            this._goToRelationshipPanel();
                            break;
                        case "relationshipSize":
                            this._goToRelationshipSizePanel();
                            break;
                        default:
                            this._goToSimplePanel()
                    }
                },
                _onSelectListItem: function(a) {
                    switch (a) {
                        case "simple":
                            this._select_simple();
                            break;
                        case "type":
                        case "unique":
                            this._select_unique();
                            break;
                        case "color":
                            this._select_color();
                            break;
                        case "classedColor":
                            this._select_color();
                            break;
                        case "ageColor":
                            this._select_ageColor();
                            break;
                        case "size":
                            this._select_size();
                            break;
                        case "classedSize":
                            this._select_size();
                            break;
                        case "ageSize":
                            this._select_ageSize();
                            break;
                        case "heatMap":
                            this._select_heatMap();
                            break;
                        case "predominance":
                            a = this.getRendererStyle(this.renderer);
                            if ("predominancesize" === a) {
                                var b = { types: !0 };
                                this._select_predominance(b)
                            } else this._select_predominance();
                            break;
                        case "predominancesize":
                            a = this.getRendererStyle(this.renderer);
                            "predominance" === a ? (b = { types: !0 }, this._select_predominancesize(b)) : this._select_predominancesize();
                            break;
                        case "colorsize":
                            a = this.getRendererStyle(this.renderer);
                            if ("ageColorSize" === a || "uniquesize" === a) {
                                var c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                                    d = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables);
                                a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                                var e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables);
                                c.field === this.attributeItem2.name && (b = { sizeInfo: c, authSizeInfo: d, opacityInfo: a, authOpacityInfo: e });
                                this._select_colorsize(b)
                            } else "colorAgeSize" === a ? (b = this.getVisualVariableByType("colorInfo", null,
                                this.renderer.visualVariables), c = this.renderer.authoringInfo && this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { colorInfo: b, authColorInfo: c, opacityInfo: a, authOpacityInfo: e }, this._select_colorsize(b)) : this._select_colorsize();
                            break;
                        case "ageColorSize":
                            a =
                                this.getRendererStyle(this.renderer);
                            "colorsize" === a || "uniquesize" === a ? (c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), d = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { sizeInfo: c, authSizeInfo: d, opacityInfo: a, authOpacityInfo: e },
                                this._select_ageColorSize(b)) : this._select_ageColorSize();
                            break;
                        case "colorAgeSize":
                            a = this.getRendererStyle(this.renderer);
                            "colorsize" === a ? (b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables), c = this.renderer.authoringInfo && this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo",
                                null, this.renderer.authoringInfo.visualVariables), b = { colorInfo: b, authColorInfo: c, opacityInfo: a, authOpacityInfo: e }, this._select_colorAgeSize(b)) : "uniqueAgeSize" === a ? (c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), d = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables),
                                b = { sizeInfo: c, authSizeInfo: d, opacityInfo: a, authOpacityInfo: e }, this._select_colorAgeSize(b)) : this._select_colorAgeSize();
                            break;
                        case "uniquesize":
                            a = this.getRendererStyle(this.renderer);
                            "uniqueAgeSize" === a ? (a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { types: !0, opacityInfo: a, authOpacityInfo: e }, this._select_uniquesize(b)) : "colorsize" ===
                                a || "ageColorSize" === a ? (c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), d = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { sizeInfo: c, authSizeInfo: d, opacityInfo: a, authOpacityInfo: e }, this.isString(this.attributeItem) || this.isString(this.attributeItem2) ||
                                    this.isInFieldValueType(this.attributeItem, "string") || !this.isInFieldValueType(this.attributeItem2, "string") || (b = null), this._select_uniquesize(b)) : this._select_uniquesize();
                            break;
                        case "uniqueAgeSize":
                            a = this.getRendererStyle(this.renderer);
                            "uniquesize" === a ? (a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { types: !0, opacityInfo: a, authOpacityInfo: e },
                                    this._select_uniqueAgeSize(b)) : "colorAgeSize" === a ? (c = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), d = this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables), a = this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariableByType("transparencyInfo", null, this.renderer.authoringInfo.visualVariables), b = { sizeInfo: c, authSizeInfo: d, opacityInfo: a, authOpacityInfo: e }, this._select_uniqueAgeSize(b)) :
                                this._select_uniqueAgeSize();
                            break;
                        case "watercolor":
                            this._select_watercolor();
                            break;
                        case "ratio":
                            this._select_ratio();
                            break;
                        case "relationship":
                            a = this.getRendererStyle(this.renderer);
                            "relationshipSize" === a ? (b = { types: !0 }, this._select_relationship(b)) : this._select_relationship();
                            break;
                        case "relationshipSize":
                            a = this.getRendererStyle(this.renderer);
                            "relationship" === a ? (b = { types: !0 }, this._select_relationshipSize(b)) : this._select_relationshipSize();
                            break;
                        default:
                            this._select_simple()
                    }
                },
                _goToUniqueValuesPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererUniqueValuesStack");
                    this.rendererUniqueValuesStack = a ? a : new f({ id: "rendererUniqueValuesStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = c.byId("rendererUniqueValuesPanel")) && a.destroy();
                    this.getAttributeItem(this.renderer.valueExpression ? "customExpr" : this.renderer.attributeField || this.renderer.field, 1, this.renderer.valueExpression, this.renderer.valueExpressionTitle).then(g.hitch(this, function(a) {
                        "rendererPanel" === this.id &&
                            ("showLocationOnly" === a.name ? a = null : this._rendererAttribute.set("value", a.name), this.setTypeOptions(a), this.galleryList.selectItem("unique"));
                        this.rendererUniqueValuesPanel = new e({
                            id: "rendererUniqueValuesPanel",
                            params: {
                                portalPanel: this,
                                subLayerId: this.subLayerId,
                                mapLayer: this.mapLayer,
                                layer: this.layer,
                                fLayer: this.fLayer,
                                renderer: d.fromJson(this.renderer.toJson()),
                                geometryType: this.geometryType,
                                origRenderer: this.origRenderer,
                                isHosted: this.isHosted,
                                isFeatColl: this.isFeatColl,
                                isCSV: this.isCSV,
                                isSL: this.isSL,
                                isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                hasDynamic: this.hasDynamic,
                                newDMS: this.newDMS,
                                hasFeatureReduction: this.hasFeatureReduction,
                                attributeItem: a,
                                attributesStore: this.attributesStore,
                                hasNumericField: this.hasNumericField,
                                hasDateField: this.hasDateField,
                                showDateFields: this.showDateFields,
                                defaultInfo: this.defaultInfo,
                                allUniqueValues: this.allUniqueValues,
                                allUniqueValuesPartialData: this.allUniqueValuesPartialData,
                                numHistogramBins: this.numHistogramBins
                            },
                            containerNode: this.rendererUniqueValuesStack,
                            region: "top"
                        });
                        leftPanel.sc.addChild(this.rendererUniqueValuesStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererUniqueValuesStack);
                        leftPanel.visibleStack = "rendererUniqueValuesStack";
                        c.byId("rendererUniqueValuesPanel").adjustHeight()
                    }))
                },
                _goToColorPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererColorStack");
                    this.rendererColorStack = a ? a : new f({ id: "rendererColorStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = c.byId("rendererColorPanel")) &&
                    a.destroy();
                    var b = function(a, b) {
                            "rendererPanel" === this.id && ("showLocationOnly" === a.name ? a = null : this._rendererAttribute.set("value", a.name), "color" === this.getRendererStyle(this.renderer) ? (this.setTypeOptions(a), this.galleryList.selectItem("color")) : "ratio" === this.getRendererStyle(this.renderer) && (this.setTypeOptions(a, b), this.galleryList.selectItem("ratio")));
                            this.rendererColorPanel = new h({
                                id: "rendererColorPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: d.fromJson(this.renderer.toJson()),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: b,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    hasDateField: this.hasDateField,
                                    showDateFields: this.showDateFields,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererColorStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererColorStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererColorStack);
                            leftPanel.visibleStack = "rendererColorStack";
                            c.byId("rendererColorPanel").adjustHeight()
                        },
                        e = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(e ? e.field || "customExpr" : this.renderer.attributeField || this.renderer.field, 1, e && e.valueExpression, e &&
                        e.valueExpressionTitle).then(g.hitch(this, function(a) { "ratio" === this.getRendererStyle(this.renderer) ? this.getAttributeItem(e.normalizationField, 1).then(g.hitch(this, function(c) { g.hitch(this, b, a, c)() })) : g.hitch(this, b, a)() }))
                },
                _goToSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererSizeStack");
                    this.rendererSizeStack = a ? a : new f({ id: "rendererSizeStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = c.byId("rendererSizePanel")) && a.destroy();
                    a = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    this.getAttributeItem(a ? a.field || "customExpr" : this.renderer.attributeField || this.renderer.field, 1, a && a.valueExpression, a && a.valueExpressionTitle).then(g.hitch(this, function(a) {
                        "rendererPanel" === this.id && (a && "showLocationOnly" === a.name ? a = null : a && this._rendererAttribute.set("value", a.name), a && this.setTypeOptions(a), this.galleryList.selectItem("size"));
                        this.rendererSizePanel = new m({
                            id: "rendererSizePanel",
                            params: {
                                portalPanel: this,
                                subLayerId: this.subLayerId,
                                mapLayer: this.mapLayer,
                                layer: this.layer,
                                fLayer: this.fLayer,
                                renderer: d.fromJson(this.renderer.toJson()),
                                geometryType: this.geometryType,
                                origRenderer: this.origRenderer,
                                isHosted: this.isHosted,
                                isFeatColl: this.isFeatColl,
                                isCSV: this.isCSV,
                                isSL: this.isSL,
                                isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                hasDynamic: this.hasDynamic,
                                newDMS: this.newDMS,
                                hasFeatureReduction: this.hasFeatureReduction,
                                attributeItem: a,
                                attributesStore: this.attributesStore,
                                hasNumericField: this.hasNumericField,
                                hasDateField: this.hasDateField,
                                showDateFields: this.showDateFields,
                                numHistogramBins: this.numHistogramBins
                            },
                            containerNode: this.rendererSizeStack,
                            region: "top"
                        });
                        leftPanel.sc.addChild(this.rendererSizeStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererSizeStack);
                        leftPanel.visibleStack = "rendererSizeStack";
                        c.byId("rendererSizePanel").adjustHeight()
                    }))
                },
                _goToAgeColorPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererColorStack");
                    this.rendererColorStack = a ? a : new f({
                        id: "rendererColorStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    });
                    (a = c.byId("rendererColorPanel")) && a.destroy();
                    var b = function(a, b) {
                        "rendererPanel" === this.id && ("showLocationOnly" === a.name ? a = null : this._rendererAttribute.set("value", a.name), "color" === this.getRendererStyle(this.renderer) ? (this.setTypeOptions(a), this.galleryList.selectItem("color", !this.attributeItem2)) : "ratio" === this.getRendererStyle(this.renderer) && (this.setTypeOptions(a, b), this.galleryList.selectItem("ratio")));
                        this.rendererColorPanel =
                            new p({
                                id: "rendererColorPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: d.fromJson(this.renderer.toJson()),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: b,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    hasDateField: this.hasDateField,
                                    countDateFields: this.countDateFields,
                                    showDateFields: this.showDateFields,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererColorStack,
                                region: "top"
                            });
                        leftPanel.sc.addChild(this.rendererColorStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererColorStack);
                        leftPanel.visibleStack = "rendererColorStack";
                        c.byId("rendererColorPanel").adjustHeight()
                    };
                    this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    a = this.renderer.authoringInfo && this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                    this.getAttributeItem(a && a.field).then(g.hitch(this, function(a) { g.hitch(this, b, a)() }))
                },
                _goToAgeSizePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererSizeStack");
                    this.rendererSizeStack = a ? a : new f({ id: "rendererSizeStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = c.byId("rendererSizePanel")) && a.destroy();
                    this.getVisualVariableByType("sizeInfo",
                        null, this.renderer.visualVariables);
                    a = this.renderer.authoringInfo && this.getVisualVariableByType("sizeInfo", null, this.renderer.authoringInfo.visualVariables);
                    this.getAttributeItem(a && a.field).then(g.hitch(this, function(a) {
                        "rendererPanel" === this.id && (a && "showLocationOnly" === a.name ? a = null : a && this._rendererAttribute.set("value", a.name), "size" === this.getRendererStyle(this.renderer) && (this.setTypeOptions(a), this.galleryList.selectItem("size", !this.attributeItem2)));
                        this.rendererSizePanel = new r({
                            id: "rendererSizePanel",
                            params: {
                                portalPanel: this,
                                subLayerId: this.subLayerId,
                                mapLayer: this.mapLayer,
                                layer: this.layer,
                                fLayer: this.fLayer,
                                renderer: d.fromJson(this.renderer.toJson()),
                                geometryType: this.geometryType,
                                origRenderer: this.origRenderer,
                                isHosted: this.isHosted,
                                isFeatColl: this.isFeatColl,
                                isCSV: this.isCSV,
                                isSL: this.isSL,
                                isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                hasDynamic: this.hasDynamic,
                                newDMS: this.newDMS,
                                hasFeatureReduction: this.hasFeatureReduction,
                                attributeItem: a,
                                attributesStore: this.attributesStore,
                                hasNumericField: this.hasNumericField,
                                hasDateField: this.hasDateField,
                                countDateFields: this.countDateFields,
                                showDateFields: this.showDateFields,
                                numHistogramBins: this.numHistogramBins
                            },
                            containerNode: this.rendererSizeStack,
                            region: "top"
                        });
                        leftPanel.sc.addChild(this.rendererSizeStack);
                        leftPanel.sc.startup();
                        leftPanel.sc.selectChild(this.rendererSizeStack);
                        leftPanel.visibleStack = "rendererSizeStack";
                        c.byId("rendererSizePanel").adjustHeight()
                    }))
                },
                _goToPredominancePanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererPredominanceStack");
                    this.rendererPredominanceStack = a ? a : new f({ id: "rendererPredominanceStack", region: "top", style: "margin:0; padding:0;", splitter: !1, gutters: !1 });
                    (a = c.byId("rendererPredominancePanel")) && a.destroy();
                    var b = this.renderer.infos,
                        e = b[1].value;
                    this.getAttributeItem(b[0].value).then(g.hitch(this, function(a) {
                        this.getAttributeItem(e).then(g.hitch(this, function(e) {
                            2 < b.length ? this.getAttributeItem(b[2].value).then(g.hitch(this, function(b) {
                                this.setTypeOptions(a, e, b);
                                "rendererPanel" !== this.id ? (this.galleryList.selectItem("predominance", !0), this.galleryList.selectItem("size", !0)) : this.galleryList.selectItem("predominance")
                            })) : (this.setTypeOptions(a, e), "rendererPanel" !== this.id ? (this.galleryList.selectItem("predominance", !0), this.galleryList.selectItem("size", !0)) : this.galleryList.selectItem("predominance"));
                            this.rendererPredominancePanel = new v({
                                id: "rendererPredominancePanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: d.fromJson(this.renderer.toJson()),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: e,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    predominantCategoryInfos: this.predominantCategoryInfos,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererPredominanceStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererPredominanceStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererPredominanceStack);
                            leftPanel.visibleStack = "rendererPredominanceStack";
                            c.byId("rendererPredominancePanel").adjustHeight()
                        }))
                    }))
                },
                _goToRelationshipPanel: function() {
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    var a = c.byId("rendererRelationshipStack");
                    this.rendererRelationshipStack = a ? a : new f({
                        id: "rendererRelationshipStack",
                        region: "top",
                        style: "margin:0; padding:0;",
                        splitter: !1,
                        gutters: !1
                    });
                    (a = c.byId("rendererRelationshipPanel")) && a.destroy();
                    var b = this.renderer.authoringInfo.field2.field;
                    this.getAttributeItem(this.renderer.authoringInfo.field1.field).then(g.hitch(this, function(a) {
                        "rendererPanel" === this.id && this._rendererAttribute.set("value", a.name);
                        this.getAttributeItem(b).then(g.hitch(this, function(b) {
                            "rendererPanel" === this.id && this._rendererAttribute2.set("value", b.name);
                            if ("rendererPanel" !== this.id) {
                                var e = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables).field ||
                                    "customExpr3";
                                this.getAttributeItem(e).then(g.hitch(this, function(c) {
                                    this.setTypeOptions(a, b, c);
                                    this.galleryList.selectItem("relationship", !0);
                                    this.galleryList.selectItem("size", !0)
                                }))
                            } else this.setTypeOptions(a, b), this.galleryList.selectItem("relationship");
                            this.rendererRelationshipPanel = new w({
                                id: "rendererRelationshipPanel",
                                params: {
                                    portalPanel: this,
                                    subLayerId: this.subLayerId,
                                    mapLayer: this.mapLayer,
                                    layer: this.layer,
                                    fLayer: this.fLayer,
                                    renderer: d.fromJson(this.renderer.toJson()),
                                    geometryType: this.geometryType,
                                    origRenderer: this.origRenderer,
                                    isHosted: this.isHosted,
                                    isFeatColl: this.isFeatColl,
                                    isCSV: this.isCSV,
                                    isSL: this.isSL,
                                    isOwnerOfHostedFS: this.isOwnerOfHostedFS,
                                    hasDynamic: this.hasDynamic,
                                    newDMS: this.newDMS,
                                    hasFeatureReduction: this.hasFeatureReduction,
                                    attributeItem: a,
                                    attributeItem2: b,
                                    attributeItem3: this.attributeItem3,
                                    attributesStore: this.attributesStore,
                                    hasNumericField: this.hasNumericField,
                                    numHistogramBins: this.numHistogramBins
                                },
                                containerNode: this.rendererRelationshipStack,
                                region: "top"
                            });
                            leftPanel.sc.addChild(this.rendererRelationshipStack);
                            leftPanel.sc.startup();
                            leftPanel.sc.selectChild(this.rendererRelationshipStack);
                            leftPanel.visibleStack = "rendererRelationshipStack";
                            c.byId("rendererRelationshipPanel").adjustHeight()
                        }))
                    }))
                },
                buildList: function(a, b) {
                    a = a || this.getRendererStyle(this.renderer);
                    this.galleryList.buildNewList(a, b, this.attributeItem && this.attributeItem.type, this.attributeItem2 && this.attributeItem2.type);
                    this.adjustHeight()
                },
                getAttributeItem: function(b, c, d, e) {
                    var f = new a;
                    esri.isDefined(c) && 1 !== c ? (b = b || this._rendererAttributes[c].get("value"),
                        this.attributesStore.fetchItemByIdentity({
                            identity: b,
                            onItem: g.hitch(this, function(a) {
                                a = this.clean(a);
                                f.resolve(a)
                            })
                        })) : b || this._rendererAttribute ? d && e ? this.attributesStore.fetch({
                        query: 'name:"customExpr" OR name:"customExpr2" OR name:"customExpr3"',
                        onComplete: g.hitch(this, function(a, b) {
                            b = this.clean(a[0]);
                            var c = this.clean(a[1]);
                            a = this.clean(a[2]);
                            b.valueExpression === d && b.valueExpressionTitle === e ? f.resolve(b) : c.valueExpression === d && c.valueExpressionTitle === e ? f.resolve(c) : f.resolve(a)
                        })
                    }) : (b = b || this._rendererAttribute.get("value"),
                        this.attributesStore.fetchItemByIdentity({
                            identity: b,
                            onItem: g.hitch(this, function(a) {
                                a = this.clean(a);
                                f.resolve(a)
                            })
                        })) : f.resolve(null);
                    return f.promise
                },
                isTypeNumber: function(a) { return "esriFieldTypeInteger" === a.type || "esriFieldTypeDouble" === a.type || "esriFieldTypeSingle" === a.type || "esriFieldTypeSmallInteger" === a.type ? !0 : !1 },
                isTypeString: function(a) { return "esriFieldTypeString" === a.type ? !0 : !1 },
                isTypeDate: function(a) { return "esriFieldTypeDate" === a.type ? !0 : !1 }
            }
        })
}, "arcgisonline/map/dijit/renderer/UniqueValues": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/Evented dojo/on dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/dom-style dojo/dom-construct dojo/dom-class dojox/html/entities dijit/TooltipDialog dijit/Tooltip dijit/Dialog dijit/registry esri/lang esri/symbols/jsonUtils esri/renderers/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_UniqueValuesMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/UniqueValuesGrid arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency esri/tasks/GenerateRendererTask dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/UniqueValues.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C) {
            b = b([U, V], {
                declaredClass: "arcgisonline.map.dijit.renderer.UniqueValues",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererUniqueValues",
                widgetsInTemplate: !0,
                templateString: C,
                _rConnects: [],
                _rSubscriptions: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                attributesStore: null,
                datePattern: null,
                uniqueValueRendererGrid: null,
                transparencySlider: null,
                origGalleryRenderer: null,
                isMultiAttributesRenderer: !1,
                constructor: function(a, b) {
                    g.mixin(this, J);
                    g.mixin(this, L);
                    g.mixin(this, M);
                    g.mixin(this, K);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [], this._rSubscriptions = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyUniqueValueRendererGrid();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    n.forEach(this._rSubscriptions, a.unsubscribe);
                    delete this._rSubscriptions;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(W.common);
                    g.mixin(this.i18n, W.generalDlg);
                    g.mixin(this.i18n, W.viewer.time);
                    g.mixin(this.i18n, W.rendererCommon);
                    g.mixin(this.i18n, W.rendererAttributeTransparencyDlg);
                    g.mixin(this.i18n,
                        W.rendererUniqueValuesPanel)
                },
                postCreate: function() {
                    this.container.addChild(dijit.byId("rendererUniqueValuesPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(dijit.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    a.connect(this._rendererUniqueRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererUniqueRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererUniqueRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyUniqueValueRendererGrid();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyUniqueValueRendererGrid();
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack(this.renderer) :
                        leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyUniqueValueRendererGrid();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererUniqueFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererUniqueHeader"), "display", "none");
                    v.set(this._estimatedValuesMsg, "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = -1 < dojo.indexOf(["uniquesize", "uniqueAgeSize"], this.getRendererStyle(this.renderer));
                    this._rendererUniqueLayer.innerHTML = x.encode(this.mapLayer.title.replace(/\_/g,
                        " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererUniqueLayer.innerHTML += " - " + x.encode(this.layer.name.replace(/\_/g, " ")));
                    this.attributeItem.valueExpressionTitle ? this._rendererUniqueField.innerHTML = this.attributeItem.valueExpressionTitle : this.renderer.attributeField2 ? this.attributesStore.fetchItemByIdentity({
                        identity: this.renderer.attributeField2,
                        onItem: g.hitch(this, function(a) {
                            this.multiAttributeItem = a;
                            this._rendererUniqueField.innerHTML = this.attributeItem.alias +
                                " - " + this.multiAttributeItem.alias
                        })
                    }) : this._rendererUniqueField.innerHTML = this.attributeItem.alias;
                    this.scheme = null;
                    this.transparencySlider = this.createTransparencySlider("rendererUniqueTransparencySlider");
                    this.createScaleSlider("rendererUniqueScaleSlider").then(dojo.hitch(this, function(a) { this.scaleSlider = a }));
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this._buildUniqueValuesList() }), 1);
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    v.set(this._rendererUniqueRotationEditExpression, "display", "none");
                    v.set(this._rendererUniqueRotationFieldDescription, "display", "none");
                    if (this.hasNumericField && (-1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint"], this.geometryType) || "esriGeometryPolygon" === this.geometryType && "uniquesize" === this.getRendererType(this.renderer))) {
                        var a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(a, this._rendererUniqueRotateRightSymbol,
                            this._rendererUniqueRotateLeftSymbol);
                        this._rendererUniqueRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                        a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables);
                        this._rendererUniqueRotationCheck.set("checked",
                            a ? !0 : !1);
                        a && (this._rendererUniqueRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererUniqueRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererUniqueRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && v.set(this._rendererUniqueRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererUniqueRotationAttribute.set("value",
                            "customExprRotation"), v.set(this._rendererUniqueRotationEditExpression, "display", "")));
                        v.set(this._rendererUniqueRotation, "display", "");
                        v.set(this._rendererUniqueRotationContent, "display", a ? "" : "none")
                    } else v.set(this._rendererUniqueRotation, "display", "none");
                    if (!this.hasDynamic && this.hasNumericField) {
                        var a = this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererUniqueAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererUniqueAttributeTransparencyLabel_part3.innerHTML = a.substring(b +
                            8);
                        var c = this.getOpacityInfo();
                        c && c.field ? this.attributesStore.fetchItemByIdentity({ identity: c.field, onItem: g.hitch(this, function(a) { c.normalizationField ? this.attributesStore.fetchItemByIdentity({ identity: c.normalizationField, onItem: g.hitch(this, function(b) { this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = e.substitute(this.i18n.setFromFieldDividedBy, { field1: a.alias || a.name, field2: b.alias || b.name }) }) }) : this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name }) }) :
                            this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = c && c.valueExpression ? this.getRendererCustomExpression(null, "transparency").title : this.i18n.attributeValues
                    } else r(".rendererUniqueHasAttributeTransparency").forEach(function(a) { v.set(a, "display", "none") }), t.remove(h.byId("rendererUniqueTransparencySliderDiv"), "esriLeadingPadding1");
                    this.adjustHeight();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                createTooltips: function() {
                    var a = function(a) {
                        return "\x3cdiv class\x3d'rendererTooltip'\x3e" +
                            a + "\x3c/div\x3e"
                    };
                    this.tooltips.push(new E({ connectId: this._rendererUniqueTransparencyTitle, label: a(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueTransparencyOverallTitle, label: a(this.i18n.overallTransparencyTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueTransparencyPerFeatureTitle, label: a(this.i18n.perFeaturesTransparencyTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueScaleTitle, label: a(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueScaleSuggest, label: a(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueRotationTitle, label: a(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueRotationAttribute.domNode, label: a(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueRotationEditExpression, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this.tooltips.push(new E({ connectId: this._rendererUniqueRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                onUngroup: function() {
                    if (this.mapLayer._featureTemplatesChanged || (this.mapLayer.featureTemplatesChanged || this.isOwnerOfHostedFS) && arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer)) arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0;
                    var a = this.renderer.rotationInfo,
                        b = this.renderer.visualVariables,
                        c = this.ungroupUniqueValues();
                    c.setRotationInfo(a);
                    this.removeRotationInfoVisualVariable(c);
                    b && b.length && c.setVisualVariables(b);
                    this.applyUniqueRenderer(c);
                    this._updateUniqueValueRendererGrid(c)
                },
                onReorder: function(a, b) {
                    if (this.mapLayer._featureTemplatesChanged || (this.mapLayer.featureTemplatesChanged || this.isOwnerOfHostedFS) && arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer)) arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0;
                    var c = this.renderer.rotationInfo,
                        d = this.renderer.visualVariables;
                    a = this.reorderUniqueValues(a, b);
                    a.setRotationInfo(c);
                    this.removeRotationInfoVisualVariable(a);
                    d && d.length && a.setVisualVariables(d);
                    this.applyUniqueRenderer(a);
                    this._updateUniqueValueRendererGrid(a)
                },
                onUpdateInfo: function(a, b) {
                    if (!D.isDefined(a.value) && this.renderer.defaultSymbol) this.renderer.defaultLabel = a.label;
                    else if (D.isDefined(a.value)) {
                        var c = [];
                        n.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                        n.forEach(c, function(a) { this.renderer.removeValue(a.value) },
                            this);
                        n.forEach(c, function(c) { a.value === c.value ? this.renderer.addValue({ value: c.value, symbol: a.symbol, label: a.label }) : this.renderer.addValue({ value: c.value, symbol: b ? this.setOutlineWidthOfSymbol(c.symbol, 1) : c.symbol, label: c.label }) }, this)
                    }
                    if (this.hasNumericField && -1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolygon"], this.geometryType)) {
                        var d = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(d,
                            this._rendererUniqueRotateRightSymbol, this._rendererUniqueRotateLeftSymbol)
                    }
                    this.updateUniqueRenderer(b);
                    this._updateUniqueValueRendererGrid(this.renderer)
                },
                onUpdateDefault: function(a, b) {
                    a ? (this.renderer.defaultSymbol = a.symbol, this.renderer.defaultLabel = a.label) : (delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel);
                    this.updateUniqueRenderer(b);
                    this._updateUniqueValueRendererGrid(this.renderer)
                },
                onUpdateSymbols: function(a, b, c) {
                    this.scheme = b || this.scheme;
                    this.updateUniqueRenderer(c);
                    this.getAllUniqueValues(a).then(g.hitch(this, function() {
                        this.hideBusy();
                        this._updateUniqueValueRendererGrid(this.renderer)
                    }), g.hitch(this, function(a) {}), g.hitch(this, function(a, b) { this.showBusy("rendererUniqueValuesStack", b) }, c));
                    this.hasNumericField && -1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolygon"], this.geometryType) && (a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType), this.drawRotationSymbol(a,
                        this._rendererUniqueRotateRightSymbol, this._rendererUniqueRotateLeftSymbol))
                },
                _onChangeRotation: function(a) { this.disableAllEvents || (v.set(this._rendererUniqueRotationContent, "display", a ? "" : "none"), this.adjustHeight(), this.updateRotationInfo()) },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererUniqueRotationCheck.get("checked"))
                        if ("customExprRotation" ===
                            this._rendererUniqueRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b = a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererUniqueRotationAttribute.setStore(this.attributesStore, "", {
                                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                                            this.layer.objectIdField + "'"
                                    });
                                    this._rendererUniqueRotationAttribute.set("value", "customExprRotation", !1);
                                    a = { valueExpression: a.valueExpression, valueExpressionTitle: a.valueExpressionTitle, rotationType: this._rendererUniqueRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                    this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.setVisualVariables(c);
                                    this.applyUniqueRenderer(this.renderer);
                                    this.updateUIWithRenderer()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", e.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo();
                                    this.updateUIWithRenderer()
                                }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                            })
                        });
                        else {
                            v.set(this._rendererUniqueRotationEditExpression, "display", "none");
                            this.getAttributeItemFromStore(this._rendererUniqueRotationAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? v.set(this._rendererUniqueRotationFieldDescription, "display", "") : v.set(this._rendererUniqueRotationFieldDescription, "display", "none") }));
                            if (this.hasDynamic && !this.newDMS) this.renderer.rotationType = this._rendererUniqueRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", this.renderer.rotationExpression =
                                "[" + this._rendererUniqueRotationAttribute.get("value") + "]";
                            else {
                                var a = { field: this._rendererUniqueRotationAttribute.get("value"), rotationType: this._rendererUniqueRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                this.renderer.setRotationInfo(null);
                                var b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                b.push(a);
                                this.renderer.setVisualVariables(b)
                            }
                            this.applyUniqueRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null),
                        this.removeRotationInfoVisualVariable(), this.applyUniqueRenderer(this.renderer), this.adjustHeight()
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                _buildUniqueValuesList: function() {
                    this.allUniqueValues ? (this.onCalculationsSource({ partialData: this.allUniqueValuesPartialData }), this._updateUniqueValueRendererGrid()) : this.getAllUniqueValues().then(g.hitch(this, function() {
                        this.hideBusy();
                        this._updateUniqueValueRendererGrid()
                    }), g.hitch(this, function(a) {}), g.hitch(this, function(a) {
                        this.showBusy("rendererUniqueValuesStack",
                            a)
                    }))
                },
                _updateUniqueValueRendererGrid: function(b) {
                    b = b || this.renderer;
                    this.uniqueValueRendererGrid ? this.uniqueValueRendererGrid.updateGrid(b) : (this.uniqueValueRendererGrid = new P({ id: "uniqueValueGrid", renderer: b, allUniqueValues: this.allUniqueValues, defaultInfo: this.defaultInfo, style: "position: relative; width: 100%; height:100%; overflow-y:hidden; overflow-x:hidden; padding:0;", params: this.params }, "uniqueValuesGrid"), n.forEach(this._rSubscriptions, a.unsubscribe), this._rSubscriptions = [], this._rSubscriptions.push(a.subscribe("onUngroupUniqueValues",
                        g.hitch(this, "onUngroup"))), this._rSubscriptions.push(a.subscribe("onReorderUniqueValues", g.hitch(this, "onReorder"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValue", g.hitch(this, "onUpdateInfo"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValueDefault", g.hitch(this, "onUpdateDefault"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValueSymbols", g.hitch(this, "onUpdateSymbols"))));
                    this.adjustHeight()
                },
                _destroyUniqueValueRendererGrid: function() {
                    this.uniqueValueRendererGrid &&
                        (n.forEach(this._rSubscriptions, a.unsubscribe), this._rSubscriptions = [], this.uniqueValueRendererGrid.destroy(), this.uniqueValueRendererGrid = null, h.byId("uniqueValuesGrid") || w.create("div", { id: "uniqueValuesGrid" }, h.byId("uniqueValuesGridDiv")))
                },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg = (new G({ id: "attributeTransparencyDlg", style: "visibility:hidden;" })).placeAt(document.body);
                    this.attributeTransparencyDlgContent =
                        new O({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler = a.connect(this.attributeTransparencyDlg, "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new R({ attributesStore: this.attributesStore, layer: this.fLayer || this.layer, mapLayer: this.mapLayer, showDateFields: this.showDateFields, numHistogramBins: this.numHistogramBins, savedRenderers: this.savedRenderers }, "attributeTransparencyDlgContent");
                    this.attributeTransparencyDlg.set({ title: this.i18n.attributeTransparencyDlgTitle, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler = a.subscribe("attribute-transparency-commit", g.hitch(this, function(a) {
                        this.hideAttributeTransparencyDlg();
                        if (a.opacityInfo) this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo = a.authoringInfo, this.applyUniqueRenderer(this.renderer), this.attributesStore.fetchItemByIdentity({
                            identity: a.opacityInfo.field ||
                                "customExprTrans",
                            onItem: g.hitch(this, function(b) { a.opacityInfo.normalizationField ? this.attributesStore.fetchItemByIdentity({ identity: a.opacityInfo.normalizationField, onItem: g.hitch(this, function(a) { this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = e.substitute(this.i18n.setFromFieldDividedBy, { field1: b.alias || b.name, field2: a.alias || a.name }) }) }) : this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = a.opacityInfo.field ? b.alias || b.name : this.getRendererCustomExpression(null, "transparency").title })
                        });
                        else {
                            var b = this.getVisualVariablesExceptType("opacityInfo", null, this.renderer.visualVariables);
                            this.renderer.setVisualVariables(b);
                            this.applyUniqueRenderer(this.renderer);
                            this._rendererUniqueAttributeTransparencyLabel_part2.innerHTML = this.i18n.attributeValues
                        }
                    }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() {
                        v.set(this.attributeTransparencyDlg.domNode,
                            "visibility", "visible")
                    }))
                },
                hideAttributeTransparencyDlg: function() { this.attributeTransparencyDlg && this.attributeTransparencyDlg.hide() },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler && a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency && this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    F.byId("attributeTransparencyDlg") && F.byId("attributeTransparencyDlg").destroy()
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel &&
                        "rendererUniqueValuesStack" == leftPanel.visibleStack) {
                        v.set(h.byId("renderer-unique-bottom"), "overflowY", "none");
                        a = c.coords(h.byId("leftContentStackContainer")).h;
                        var b = c.coords(h.byId("rendererUniqueHeader")).h,
                            d = c.coords(this._rendererUniqueTop.domNode).h,
                            e = c.coords(h.byId("uniqueValuesGriText")).h;
                        v.set(h.byId("uniqueValuesGridDiv"), "height", "0px");
                        var f = h.byId("renderer-unique-bottom").scrollHeight,
                            g = c.coords(h.byId("rendererUniqueContentClose")).h,
                            m = c.coords(h.byId("rendererUniqueFooter_links")).h +
                            10;
                        v.set(h.byId("rendererUniqueFooterDiv"), "height", m + "px");
                        f = a - b - d - e - f - g - m - 13;
                        250 < f ? (v.set(h.byId("uniqueValuesGridDiv"), "height", f + "px"), a = a - b - d - e - f - g - m - 27) : (v.set(h.byId("uniqueValuesGridDiv"), "height", "250px"), a = a - b - d - e - 250 - g - m - 27);
                        v.set(h.byId("renderer-unique-bottom"), "height", a + "px");
                        newWidth = c.coords(h.byId("leftContentStackContainer")).w - 16;
                        if (0 < newWidth) {
                            v.set(h.byId("uniqueValuesGridDiv"), "width", newWidth + "px");
                            this.uniqueValueRendererGrid && this.uniqueValueRendererGrid.resize();
                            60 >= f &&
                                (newWidth -= 30);
                            a = 0;
                            if ("none" !== v.get(this._rendererUniqueRotationEditExpression, "display") || "none" !== v.get(this._rendererUniqueRotationFieldDescription, "display")) a = 30;
                            v.set(this._rendererUniqueRotationAttribute.domNode, "width", newWidth - a - 40 + "px");
                            r(".dijitSelectLabel", this._rendererUniqueRotationAttribute.domNode).style("maxWidth", newWidth - a - 70 + "px");
                            this.transparencySlider && v.set(this.transparencySlider.domNode, "width", newWidth - (esriGeowConfig.isRightToLeft ? 62 : 52) + "px");
                            this.scaleSlider && v.set(this.scaleSlider.domNode,
                                "width", newWidth - (esriGeowConfig.isRightToLeft ? 40 : 35) + "px");
                            this.hasNumericField && (v.set(h.byId("rendererUniqueTransparencySliderInnerDiv"), "width", newWidth - 40 + "px"), v.set(h.byId("rendererUniqueTransparencySliderDiv"), "width", newWidth - 18 + "px"))
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.UniqueValues", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_SymbolsMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/has dojo/dom dojo/query dojo/Deferred dojo/_base/Color dijit/registry dijit/TooltipDialog dijit/popup dijit/Dialog esri/symbols/jsonUtils dojox/gfx dojo/dom-style dojo/dom-class dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/type esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color arcgisonline/map/dijit/renderer/SymbolStylerDlg".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K) {
            return {
                pointJson: { type: "esriSMS", style: "esriSMSCircle", color: [34, 114, 162, 128], size: 6, outline: { color: [34, 114, 162, 255], width: 1 } },
                pointStreamJson: { type: "esriSMS", style: "esriSMSCircle", color: [77, 77, 77, 255], size: 4, outline: { color: [255, 255, 255, 255], width: 1 } },
                lineJson: { type: "esriSLS", style: "esriSLSSolid", color: [77, 77, 77, 255], width: 2 },
                lineStreamJson: { type: "esriSLS", style: "esriSLSSolid", color: [77, 77, 77, 255], width: 2 },
                polygonJson: {
                    type: "esriSFS",
                    style: "esriSFSSolid",
                    color: [227, 139, 79, 204],
                    outline: { type: "esriSLS", style: "esriSLSSolid", color: [255, 255, 255, 255], width: .75 }
                },
                backgroundPolygonJson: { type: "esriSFS", style: "esriSFSSolid", color: [0, 0, 0, 0], outline: { type: "esriSLS", style: "esriSLSSolid", color: [128, 128, 128, 255], width: .75 } },
                markerJson: { type: "esriSMS", style: "esriSMSCircle", color: [77, 77, 77, 255], size: 6, outline: { color: [255, 255, 255, 255], width: 1 } },
                transparentPolygonSymbolJson: {
                    color: null,
                    outline: { color: null, width: .75, type: "esriSLS", style: "esriSLSNull" },
                    type: "esriSFS",
                    style: "esriSFSSolid"
                },
                getMarkerJson: function() {
                    var a = this.markerJson;
                    a.url = arcgisonline.sharing.util.getRedSphereUrl();
                    return a
                },
                _getSymbol: function(a, b) {
                    var c;
                    if ("esriGeometryPoint" == a || "esriGeometryMultipoint" == a) c = this.getDefaultSymbol(a), b && ("cross" === c.style || "x" === c.style ? "string" === typeof b ? (a = new m(b), a.a = c.color.toRgba()[3], c.outline.setColor(a)) : c.outline.setColor(new m([b[0], b[1], b[2], c.color.toRgba()[3]])) : "string" === typeof b ? (a = new m(b), a.a = c.color.toRgba()[3], c.setColor(a)) :
                        c.setColor(new m([b[0], b[1], b[2], c.color.toRgba()[3]])));
                    else if ("esriGeometryPolyline" == a || "esriGeometryPolygon" == a) c = D.fromJson(this.symbol.toJson()), b && (this.symbol.color && .1 < this.symbol.color.toRgba()[3] ? "string" === typeof b ? (a = new m(b), a.a = this.symbol.color.toRgba()[3], c.setColor(a)) : c.setColor(new m([b[0], b[1], b[2], this.symbol.color.toRgba()[3]])) : "string" === typeof b ? (a = new m(b), c.setColor(a)) : c.setColor(new m(b)));
                    return c
                },
                getDefaultSymbol: function(a) {
                    var b = A.getSchemes({
                        theme: "default",
                        basemap: this.getBasemapType(),
                        geometryType: a
                    }).primaryScheme;
                    return "esriGeometryPoint" == a || "esriGeometryMultipoint" == a ? (a = new J(J.STYLE_SOLID, new M(b.outline.color), b.outline.width), new H(H.STYLE_CIRCLE, b.size, a, b.noDataColor)) : "esriGeometryPolyline" == a ? new J(J.STYLE_SOLID, new M(b.noDataColor), b.width) : "esriGeometryPolygon" == a ? (a = new J(J.STYLE_SOLID, new M(b.outline.color), b.outline.width), new L(L.STYLE_SOLID, a, b.noDataColor)) : null
                },
                switchSymbolKeepSize: function(a, b) {
                    var c = D.fromJson(a.toJson());
                    switch (b.type) {
                        case "simplemarkersymbol":
                            return "simplemarkersymbol" ===
                                a.type ? c.size = b.size : (c.width = b.size, c.height = a.height / a.width * c.width), c;
                        case "picturemarkersymbol":
                            return "simplemarkersymbol" === a.type ? c.size = (b.width + b.height) / 2 : (c.width = b.width, c.height = a.height / a.width * c.width), c;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return c.width = b.width, c
                    }
                },
                switchSizeKeepSymbol: function(a, b) {
                    var c = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return c.size = b, c;
                        case "picturemarkersymbol":
                            return c.width = b, c.height = a.height / a.width * c.width,
                                c;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return c.width = b, c
                    }
                },
                switchSymbolKeepColor: function(a, b) {
                    a = D.fromJson(a.toJson());
                    switch (b.type) {
                        case "simplemarkersymbol":
                            return "cross" !== a.style && "x" !== a.style || "cross" !== b.style && "x" !== b.style ? "cross" === a.style || "x" === a.style ? a.outline.setColor(b.color) : "cross" === b.style || "x" === b.style ? (a.setColor(b.outline.color), a.outline.setColor(new m([153, 153, 153, 255]))) : a.setColor(b.color) : a.outline.setColor(b.outline.color), a;
                        case "picturemarkersymbol":
                            return a;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a.setColor(b.color), a;
                        case "simplefillsymbol":
                            return a.setColor(b.color), a
                    }
                },
                applyColorToSymbol: function(a, b) {
                    a = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return "cross" === a.style || "x" === a.style ? a.outline.setColor(b) : a.setColor(b), a;
                        case "picturemarkersymbol":
                            return a;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a.setColor(b), a;
                        case "simplefillsymbol":
                            return a.setColor(b), a
                    }
                },
                setOutlineWidthOfSymbol: function(a,
                    b) {
                    if (!a) return null;
                    a = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return "cross" !== a.style && "x" !== a.style && a.outline.setWidth(b), a;
                        case "picturemarkersymbol":
                            return a;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a;
                        case "simplefillsymbol":
                            return a.outline.setWidth(b), a
                    }
                },
                setOutlineOpacityOfSymbol: function(a, b) {
                    if (!a) return null;
                    a = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            if ("cross" !== a.style && "x" !== a.style && a.outline.color) {
                                var c = a.outline.color.toRgba();
                                a.outline.setColor(new m([c[0], c[1], c[2], b]))
                            }
                            return a;
                        case "picturemarkersymbol":
                            return a;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a;
                        case "simplefillsymbol":
                            return a.outline.color && (c = a.outline.color.toRgba(), a.outline.setColor(new m([c[0], c[1], c[2], b]))), a
                    }
                },
                convertFillToMarkerSymbol: function(a, b, c) {
                    if ("esri.symbol.SimpleMarkerSymbol" === a.declaredClass || "esri.symbol.PictureMarkerSymbol" === a.declaredClass) return a;
                    a = D.fromJson(a.toJson());
                    return new H(b || H.STYLE_CIRCLE, 12, c ||
                        a.outline, a.color)
                },
                convertMarkerToFillSymbol: function(a) {
                    if ("esri.symbol.SimpleFillSymbol" === a.declaredClass) return a;
                    a = D.fromJson(a.toJson());
                    return new L(L.STYLE_SOLID, a.outline, a.color)
                },
                applySchemeToSymbol: function(a, b) {
                    var c = !1;
                    a && "picturemarkersymbol" !== a.type || (c = !0, "esriGeometryPoint" === this.geometryType || "esriGeometryMultipoint" === this.geometryType ? a = D.fromJson(this.getMarkerJson()) : "esriGeometryPolyline" === this.geometryType ? a = D.fromJson(this.lineJson) : "esriGeometryPolygon" === this.geometryType &&
                        (a = D.fromJson(this.polygonJson)));
                    a = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return "cross" === a.style || "x" === a.style ? a.outline.setColor(b.color) : a.setColor(b.color), c && (a.size = b.size, a.outline.setColor(b.outline.color), a.outline.width = b.outline.width), a;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a.setColor(b.color), c && (a.width = b.width), a;
                        case "simplefillsymbol":
                            return a.setColor(b.color), c && (a.outline.setColor(b.outline.color), a.outline.width = b.outline.width),
                                a
                    }
                },
                getSymbolColor: function(a) {
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return "cross" === a.style || "x" === a.style ? a.outline.color : a.color;
                        case "picturemarkersymbol":
                            return new m([0, 0, 0, 1]);
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return a.color;
                        case "simplefillsymbol":
                            return a.color
                    }
                },
                getSymbolSize: function(a) {
                    var b = D.fromJson(a.toJson());
                    switch (a.type) {
                        case "simplemarkersymbol":
                            return b.size;
                        case "picturemarkersymbol":
                            return b.width;
                        case "simplelinesymbol":
                        case "cartographiclinesymbol":
                            return b.width
                    }
                },
                _checkSymbol: function(a, b) {
                    if ("simplemarkersymbol" !== a.type && "simplelinesymbol" !== a.type && "cartographiclinesymbol" !== a.type && "simplefillsymbol" !== a.type || !a.color) return a;
                    var c = a.color.toRgba();
                    0 === c[3] && (!a.outline || a.outline && (0 === a.outline.width || a.outline.color && 0 === a.outline.color.toRgba()[3])) && (b ? 0 === b.color.toRgba()[3] && (!b.outline || b.outline && (0 === b.outline.width || b.outline.color && 0 === b.outline.color.toRgba()[3])) ? a.setColor(new m([c[0], c[1], c[2], 1])) : a = b : a.setColor(new m([c[0], c[1], c[2],
                        1
                    ])));
                    return a
                },
                drawSymbol: function(a, b, c, e, f, h) {
                    F.isDefined(c) && F.isDefined(e) || (e = this._calcSymbolWidthHeight(b), c = e.width, e = e.height);
                    a.innerHTML = "";
                    b = t.fromJson(b.toJson());
                    b.color && (-1 < JSON.stringify(b.color).indexOf("null") || -1 < JSON.stringify(b.color).indexOf("undefined")) && b.setColor(new m([0, 0, 0, 0]));
                    b.outline && b.outline.color && (-1 < JSON.stringify(b.outline.color).indexOf("null") || -1 < JSON.stringify(b.outline.color).indexOf("undefined")) && b.outline.setColor(new m([0, 0, 0, 0]));
                    "simplelinesymbol" ===
                    b.type || "cartographiclinesymbol" === b.type || "textsymbol" === b.type ? b.color && (f = b.color.toRgba(), f[3] *= h, b.color.setColor(f)) : "simplemarkersymbol" === b.type || "simplefillsymbol" === b.type ? (b.color && (f = b.color.toRgba(), f[3] *= h, b.color.setColor(f)), b.outline && b.outline.color && (f = b.outline.color.toRgba(), f[3] *= h, b.outline.color.setColor(f))) : "picturemarkersymbol" === b.type && (a.style.opacity = h, a.style.filter = "alpha(opacity\x3d(" + 100 * h + "))");
                    a = x.createSurface(a, c, e);
                    d("ie") && (h = a.getEventSource(), B.set(h, "position",
                        "relative"), B.set(h.parentNode, "position", "relative"));
                    h = t.getShapeDescriptors(b);
                    "esri.symbol.SimpleFillSymbol" === b.declaredClass && (h.defaultShape = { type: "path", path: "M -8,-8 L 8,-8 L 8,8 L -8,8 L -8,-8 E" });
                    var n;
                    try { n = a.createShape(h.defaultShape).setFill(h.fill).setStroke(h.stroke) } catch (N) {
                        a.clear();
                        a.destroy();
                        return
                    }
                    var p = n.getBoundingBox();
                    h = p.width;
                    b = p.height;
                    f = -(p.x + h / 2);
                    var p = -(p.y + b / 2),
                        r = a.getDimensions();
                    f = { dx: f + r.width / 2, dy: p + r.height / 2 };
                    if (h > c || b > e) c = ((c < e ? c : e) - 5) / (h > b ? h : b), g.mixin(f, { xx: c, yy: c });
                    n.applyTransform(f);
                    return a
                },
                _calcSymbolWidthHeight: function(a) {
                    var b = 30,
                        c = 30;
                    if (a && "simplemarkersymbol" == a.type) var d = a.outline && a.outline.width ? a.outline.width : 0,
                        b = Math.min(Math.max(b, a.size + 2 * d), 125),
                        c = Math.min(Math.max(c, a.size + 2 * d), 125);
                    else a && "picturemarkersymbol" == a.type && (b = Math.min(Math.max(b, a.width), 125), c = Math.min(a.height ? a.height : c, 125));
                    return { width: b, height: c }
                },
                _calcTotalSymbolWidthHeight: function() {
                    var a = 30,
                        b = 30;
                    n.forEach(this.data, function(c) {
                        c.symbol && (c = this._calcSymbolWidthHeight(c.symbol),
                            a = Math.max(a, c.width), b = Math.max(b, c.height))
                    }, this);
                    return { width: a, height: b }
                },
                isSymbolAlmostWhite: function(a) { return a && this.isColorAlmostWhite(a.color) && (!a.outline || this.isColorAlmostWhite(a.outline.color)) },
                isColorAlmostWhite: function(a) { return !a || 246 < a.r && 246 < a.g && 246 < a.b },
                updateBackgroundForAlmostWhite: function(a, b) {
                    E.remove(b, "esriSwatchEmptyContainer");
                    this.isSymbolAlmostWhite(a) ? E.add(b, "almostWhiteSymbol") : E.remove(b, "almostWhiteSymbol")
                },
                isSymbolTransparent: function(a) {
                    return a && this.isColorTransparent(a.color) &&
                        (!a.outline || this.isColorTransparent(a.outline.color))
                },
                isColorTransparent: function(a) { return !a || 0 === a.a },
                drawTransparentSymbol: function(a) {
                    a.innerHTML = "";
                    E.remove(a, "almostWhiteSymbol");
                    G.create("div", { "class": "esriSwatchEmpty" }, a);
                    E.add(a, "esriSwatchEmptyContainer")
                },
                drawRotationSymbol: function(a, b, c) {
                    this.isSymbolTransparent(a) ? (this.drawTransparentSymbol(b), this.drawTransparentSymbol(c)) : (a = "simplemarkersymbol" === a.type || "picturemarkersymbol" === a.type ? this.switchSizeKeepSymbol(a, 20) : a, this.drawSymbol(b,
                        a, 30, 30, null, 1), this.drawSymbol(c, a, 30, 30, null, 1), this.updateBackgroundForAlmostWhite(a, b), this.updateBackgroundForAlmostWhite(a, c));
                    0 === this.i18n.rotateZeroDegrees.indexOf("\u00b0") && e(".rotate").forEach(function(a) { E.add(a, "leadingDegree") })
                },
                getSuggestedOutline: function() {
                    var a = new h;
                    if ("esriGeometryPolygon" !== this.geometryType || this.hasDynamic) return a.reject(), a;
                    this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        this.layer.statisticsPlugin.getSuggestedOutline({ allowZeroWidth: !0 }).then(g.hitch(this,
                            function(b) { a.resolve(b) }), g.hitch(this, function(b) { a.reject() }))
                    }));
                    return a
                },
                showSymbolStyler: function(b, d, h) {
                    this.symbolStylerDlg = (new w({ id: "symbolStylerDlg", style: "visibility: hidden; overflow-y: auto;" })).placeAt(document.body);
                    this.symbolStylerDlgContent = new K({ id: "symbolStylerDlgContent" });
                    this.symbolStylerDlg.set({ title: "", content: this.symbolStylerDlgContent });
                    this.symbolStylerDlgHideHandler = c.connect(this.symbolStylerDlg, "onHide", g.hitch(this, function() { this.destroySymbolStylerDlg() }));
                    this.symbolStylerDlgOkHandler = c.subscribe("symbolStylerOk", g.hitch(this, function(a, b) {
                        this.activeTab = b;
                        this.symbolStylerDlg.hide();
                        h(a.symbol, a.colors, a.scheme, a.optimizeOutline)
                    }));
                    this.symbolStylerDlgCancelHandler = c.subscribe("symbolStylerCancel", g.hitch(this, function(a) { this.symbolStylerDlg.hide() }));
                    this.symbolStylerDlg.show().then(g.hitch(this, function() {
                        var c = a.coords(f.byId("rightDiv")),
                            g, h;
                        esriGeowConfig.isRightToLeft ? g = arcgisonline.map.leftPanel.leftPanelWidth + 18 : h = arcgisonline.map.leftPanel.leftPanelWidth +
                            18;
                        B.set(this.symbolStylerDlg.domNode, "top", c.y + "px");
                        esriGeowConfig.isRightToLeft ? B.set(this.symbolStylerDlg.domNode, "right", g + "px") : B.set(this.symbolStylerDlg.domNode, "left", h + "px");
                        B.set(this.symbolStylerDlg.domNode, "visibility", "visible");
                        d.activeTab = this.activeTab || d.activeTab;
                        this.symbolStylerDlgContent.show(b, d, { topPos: c.y + 5, rightPos: g, leftPos: h }, this.hasDynamic);
                        b && "simplelinesymbol" === b.type && d && d.tabOptions && d.tabOptions.excluded && d.tabOptions.excluded.length && "fill" === d.tabOptions.excluded[0] &&
                            (e(".esriMiddle", this.symbolStylerDlgContent.picker.domNode).forEach(function(a) { B.set(a, "display", "none") }), e(".esriFooter", this.symbolStylerDlgContent.picker.domNode).forEach(function(a) { B.set(a, "display", "none") }))
                    }))
                },
                hideSymbolStyler: function() { this.symbolStylerDlg && this.symbolStylerDlg.hide() },
                destroySymbolStylerDlg: function() {
                    this.symbolStylerDlgOkHandler && c.unsubscribe(this.symbolStylerDlgOkHandler);
                    this.symbolStylerDlgOkHandler = null;
                    this.symbolStylerDlgCancelHandler && c.unsubscribe(this.symbolStylerDlgCancelHandler);
                    this.symbolStylerDlgCancelHandler = null;
                    this.symbolStylerDlgHideHandler && c.disconnect(this.symbolStylerDlgHideHandler);
                    this.symbolStylerDlgHideHandler = null;
                    this.symbolStylerDlgContent && this.symbolStylerDlgContent.destroy();
                    this.symbolStylerDlgContent = null;
                    this.symbolStylerDlg && this.symbolStylerDlg.destroy();
                    this.symbolStylerDlg = null;
                    p.byId("symbolStylerDlg") && p.byId("symbolStylerDlg").destroy()
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/SymbolStylerDlg": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/aspect dojo/dom dojo/dom-style dojo/query dijit/registry esri/lang esri/dijit/SymbolStyler esri/dijit/SymbolStyler/ColorRampPicker dijit/_Widget dijit/_Templated dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/map/dijit/renderer/templates/SymbolStylerDlg.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            b = g([t, x], {
                declaredClass: "arcgisonline.map.dijit.renderer.SymbolStylerDlg",
                baseClass: "esriSymbolStylerDlg",
                basePath: b.toUrl("arcgisonline/map/renderer"),
                widgetsInTemplate: !0,
                templateString: E,
                posParams: null,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = B.common
                },
                destroy: function() {
                    this.picker && this.picker.destroy();
                    this.picker = null;
                    this.inherited(arguments)
                },
                _onClose: function(a) { a.preventDefault() },
                _onOK: function(a) {
                    a.preventDefault();
                    this.picker instanceof v ? (this.picker.storeColors(), c.publish("symbolStylerOk", [this.picker.getStyle(), this.picker.get("activeTab")])) : c.publish("symbolStylerOk", [this.picker.getStyle()])
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    c.publish("symbolStylerCancel")
                },
                show: function(b, d, e, g) {
                    this.posParams = e || {};
                    b ? (this.picker = new v({ portalUrl: esriGeowConfig.restBaseUrl }, "symbolStylerDiv"), this.picker.startup(), g && (f.before(this.picker._symbolPicker, "_updateSymbolOptions", n.hitch(this, function(b) {
                            var c = [];
                            a.forEach(b, function(a) {
                                ("simplemarkersymbol" !== a.symbol.type || "cross" !== a.symbol.style && "x" !== a.symbol.style) && c.push(a)
                            });
                            return [c]
                        })), "esri.symbol.SimpleMarkerSymbol" === b.declaredClass && (e = m(".esriSwatchEmpty", this.picker.dap_fillContainer.domNode)) && e.length && h.set(e[0], "display", "none")), this.picker.edit(b, d), g && "esri.symbol.SimpleLineSymbol" === b.declaredClass && (h.set(this.picker.dap_arrowPatternSelectLabel, "display", "none"), h.set(this.picker._arrowPatternSelect.domNode, "display", "none")),
                        this.adjustDlg(), a.forEach(this.picker.dap_stackContainer.getChildren(), function(a) { c.connect(a, "onShow", n.hitch(this, function() { this.adjustDlg() })) }, this)) : (this.picker = new w({ "class": "esriSymbolStyler" }, "symbolStylerDiv"), this.picker.startup(), this.picker.set(d))
                },
                adjustDlg: function() {
                    p.byId("symbolStylerDlg").resize();
                    if (r.isDefined(this.posParams.topPos)) {
                        var a = dijit.byId("symbolStylerDlg").domNode;
                        a.clientHeight < a.scrollHeight && (this.posParams.topPos = Math.min(10, this.posParams.topPos));
                        h.set(e.byId("symbolStylerDlg"),
                            "top", this.posParams.topPos + "px");
                        r.isDefined(this.posParams.rightPos) && h.set(a, "right", this.posParams.rightPos + "px");
                        r.isDefined(this.posParams.leftPos) && h.set(a, "left", this.posParams.leftPos + "px")
                    }
                }
            });
            n.setObject("arcgisonline.map.dijit.renderer.SymbolStylerDlg", b);
            return b
        })
}, "esri/dijit/SymbolStyler": function() {
    define("../dijit/ColorPicker ../domUtils ../kernel ../symbol ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./SymbolStyler/_DelayedUpdate ./SymbolStyler/IconSelect ./SymbolStyler/MarkerSymbolPicker ./SymbolStyler/schemeUtil ./SymbolStyler/stylerUtil ./SymbolStyler/symbolUtil dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dijit/form/CheckBox dijit/form/ComboBoxMixin dijit/form/NumberTextBox dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/has dojo/keys dojo/number dojo/on dojo/string dojo/i18n!../nls/jsapi dojo/text!./SymbolStyler/templates/SymbolStyler.html ../dijit/HorizontalSlider ./SymbolStyler/MarkerSymbolPicker ./SymbolStyler/ColorRampPicker dijit/form/Button dijit/form/ComboBox dijit/form/NumberSpinner dijit/form/Select dijit/form/TextBox dijit/layout/BorderContainer dijit/layout/ContentPane dijit/layout/StackController dijit/layout/StackContainer".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S) {
            c = D([c, w, t, e, d], {
                _RECENT_FILL_COLORS_ITEM_KEY: "symbolStyler/recent/fill/colors",
                _RECENT_OUTLINE_COLORS_ITEM_KEY: "symbolStyler/recent/outline/colors",
                _defaultMinLineWidthInPx: 0,
                _defaultMinShapeSizeInPx: 1,
                _defaultMaxLineWidthInPx: 18,
                _defaultMaxShapeSizeInPx: 120,
                declaredClass: "esri.dijit.SymbolStyler",
                baseClass: "esriSymbolStyler",
                templateString: S,
                labels: null,
                css: {
                    symbolPreviewContainer: "esriSymbolPreviewContainer",
                    symbolPreview: "esriSymbolPreview",
                    tabBar: "esriTabBar",
                    content: "esriContent",
                    link: "esriLink",
                    label: "esriLabel",
                    shapeImageUrlContainer: "esriShapeImageUrlContainer",
                    urlInput: "esriUrlInput",
                    addIcon: "esriAddIcon",
                    errorDisplay: "esriErrorDisplay",
                    symbolSizeInput: "esriSymbolSizeInput",
                    inlineInput: "esriInlineInput",
                    text: "esriText",
                    hidden: "esriHidden",
                    lineWidthInput: "esriLineWidthInput",
                    arrowPattern: "esriArrowPattern",
                    arrowPatternInput: "esriArrowPatternInput",
                    linePattern: "esriLinePattern",
                    linePatternInput: "esriLinePatternInput",
                    alt: "esriAlt",
                    disabled: "esriDisabled"
                },
                declaredClass: "esri.dijit.SymbolStyler",
                _originalSymbol: null,
                _editedSymbol: null,
                _activeTabName: null,
                _externalSizing: !1,
                _delayedCommitPropsTrigger: null,
                _symbolPreviewSurface: null,
                _arrowPatternSelect: null,
                _linePatternSelect: null,
                _symbolPicker: null,
                _customImageSymbol: null,
                _optimizationSection: null,
                _optimizationCheckBox: null,
                _optimizationLabel: null,
                _alphaBeforeOutlineColorCleared: null,
                _outlinePropModified: !1,
                _isPreppingEdit: null,
                constructor: function(a) {
                    this._delayedCommitPropsTrigger =
                        this.createUpdateTrigger(this._commitProperties, this);
                    this._initOptimizationControls()
                },
                _initOptimizationControls: function() {
                    var a = new B,
                        c = J.create("div", { className: b.prototype.css.section });
                    this._optimizationLabel = J.create("label", { "for": a.id, className: this.css.label, innerHTML: R.widgets.symbolEditor.autoAdjustOutline }, c);
                    a.on("change", A.hitch(this, function(a) {
                        var b = this.dap_outlineColorPicker.get("color");
                        b.a = a ? .75 : b.a;
                        this.dap_outlineColorPicker.set("color", b);
                        this._delayedCommitPropsTrigger()
                    }));
                    a.placeAt(c, "first");
                    this._optimizationSection = c;
                    this._optimizationCheckBox = a
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.labels = A.mixin({}, R.common, R.widgets.symbolEditor)
                },
                _toggleOutlineColorControls: function(a) {
                    var b = this.dap_outlineColorRampPicker,
                        c = this.dap_outlineColorPicker;
                    this._shouldShowOutlineColorRamp(a) ? (this._show(b), this._hide(c)) : (this._show(c), this._hide(b))
                },
                _shouldShowOutlineColorRamp: function(a) { return this._hasColorRamp() && (v.isLine(a) || v.isPoint(a) && v.hasPureOutlineStyle(a)) },
                _setUpColorControls: function(a, b) {
                    var c = this.dap_outlineColorRampPicker,
                        d = this.dap_outlineColorPicker,
                        e = this.dap_fillColorRampPicker,
                        f = this.dap_fillColorPicker,
                        g;
                    b ? (g = { colors: b.colors }, b.scheme && (g.scheme = b.scheme), this._isLine() ? (c.set({ schemes: a, selected: g, numStops: b.numStops }), this._hide(d), this._show(c)) : (this._isPoint() && c.set({ schemes: a, selected: g, numStops: b.numStops }), e.set({ schemes: a, selected: g, numStops: b.numStops }), this._show(e), this._show(d), this._hide(f), this._hide(c))) : (this._show(f),
                        this._show(d), this._hide(e), this._hide(c), this._updateSuggestedColors(f, p.getFillColors(a)));
                    this._updateSuggestedColors(d, p.getOutlineColors(a))
                },
                edit: function(a, b) {
                    var c = v.cloneSymbol(a),
                        d;
                    b = b || {};
                    d = b.colorRamp;
                    this._isPreppingEdit = !0;
                    this._colorRamp = d;
                    this._originalSymbol = a;
                    this._editedSymbol = c;
                    this._activeTabName = b.activeTab;
                    this._externalSizing = b.externalSizing;
                    this._tabOptions = b.tabOptions || {};
                    this._optimizationOptions = "boolean" === typeof b.optimizeOutline ? { value: b.optimizeOutline } : void 0;
                    this._setUpColorControls(b.schemes,
                        d);
                    this._assimilateSymbol(c);
                    this._toggleSizingControls(this._externalSizing);
                    this._updateSymbolPicker();
                    this._toggleOutlineColorControls(c);
                    this._toggleOptimizationOptions()
                },
                _toggleOptimizationOptions: function() {
                    var a = this._optimizationOptions,
                        b = this._optimizationSection;
                    v.isPolygon(this._editedSymbol) && a ? (this._optimizationCheckBox.set("value", a.value, !1), J.place(b, this.dap_outlineColorPicker.dap_recentColorSection)) : b.parentNode && J.empty(b.parentNode)
                },
                _importRecentColors: function() {
                    this.dap_fillColorPicker.loadRecentColors(this._RECENT_FILL_COLORS_ITEM_KEY);
                    this.dap_outlineColorPicker.loadRecentColors(this._RECENT_OUTLINE_COLORS_ITEM_KEY)
                },
                _hasColorRamp: function() { return !!this._colorRamp },
                _toggleSizingControls: function(a) {
                    var b = !1,
                        c = !1;
                    a && (this._isLine() ? c = !0 : b = !0);
                    this._toggleLabeledControls({ labels: this.dap_lineWidthLabel, controls: [this._lineWidthTextBox, this.dap_lineWidthSlider], disabled: c });
                    this._toggleLabeledControls({ labels: this.dap_shapeSizeLabel, controls: [this.dap_shapeSizeTextBox, this.dap_shapeSizeSlider], disabled: b })
                },
                _toggleLabeledControls: function(a) {
                    var b =
                        a.labels,
                        c = a.controls,
                        d = a.disabled;
                    A.isArray(b) ? F.forEach(b, function(a) { H.toggle(a, this.css.disabled, d) }, this) : H.toggle(b, this.css.disabled, d);
                    A.isArray(c) ? F.forEach(c, function(a) { a.set("disabled", d) }) : c.set("disabled", d)
                },
                _updateSymbolPicker: function() {
                    var a = this._tabOptions.symbolDisplayMode ? this._tabOptions.symbolDisplayMode : this._isPoint() && this._hasColorRamp() ? "default" : "portal";
                    "portal" === a ? g.show(this.dap_useImageContent) : g.hide(this.dap_useImageContent);
                    this._symbolPicker.set("displayMode",
                        a);
                    this._symbolPicker.clearSelection()
                },
                shapeSymbol: null,
                _setShapeSymbolAttr: function(a) {
                    this._adjustOutlineProperties(this._editedSymbol, a);
                    this._set("shapeSymbol", a);
                    this._editedSymbol = a;
                    this._toggleTabs(a);
                    this._toggleOutlineColorControls(a);
                    this._delayedCommitPropsTrigger()
                },
                _adjustOutlineProperties: function(b, c) {
                    var d = this.dap_fillColorPicker,
                        e = this.dap_outlineColorPicker,
                        g = this.dap_fillColorRampPicker,
                        h = this.dap_outlineColorRampPicker;
                    this._switchedFromPmsToSms(b, c) ? (d.set("color", c.color),
                        d = v.getOutline(c), g = a.SimpleLineSymbol.defaultProps, b = d ? d.color : g.color, c = d ? d.width : g.width, g = d ? d.style : g.style, d = d ? d.marker : null, e.set("color", b), this.dap_lineWidthSlider.set("value", c), this._linePatternSelect.set("value", g), this._arrowPatternSelect.set("value", d)) : this._switchedPureOutlineToSmsStyle(b, c) && this._hasColorRamp() ? g.set("selected", h.get("selected")) : this._switchedSmsStyleToPureOutline(b, c) && (this._hasColorRamp() ? h.set("selected", g.get("selected")) : (d = v.getOutline(b), b = e.get("color"),
                        d && d.color ? (c = f.isBright(d.color)) && .2 > d.color.a ? (b.a = .2, e.set("color", b)) : !c && .1 > d.color.a && (b.a = .1, e.set("color", b)) : e.set("color", c.color)))
                },
                _switchedFromPmsToSms: function(a, b) { return v.isType(a, "picturemarker") && v.isType(b, "simplemarker") },
                _switchedSmsStyleToPureOutline: function(a, b) { return v.isType(a, "simplemarker") && v.isType(b, "simplemarker") && v.hasPureOutlineStyle(a) && v.hasPureOutlineStyle(b) },
                _switchedPureOutlineToSmsStyle: function(a, b) { return this._switchedSmsStyleToPureOutline(b, a) },
                shapeSize: null,
                _setShapeSizeAttr: function(a) {
                    this._set("shapeSize", a);
                    this._delayedCommitPropsTrigger()
                },
                _shapeImageUrl: null,
                _setShapeImageUrlAttr: function(a) {
                    this._set("shapeImageUrl", a);
                    this._delayedCommitPropsTrigger()
                },
                fillColor: null,
                _setFillColorAttr: function(a) {
                    a = a === b.NO_COLOR ? null : a;
                    this._set("fillColor", a);
                    this._delayedCommitPropsTrigger()
                },
                fillColorRamp: null,
                _setFillColorRampAttr: function(a) {
                    this._set("fillColorRamp", a);
                    this._delayedCommitPropsTrigger()
                },
                outlineColorRamp: null,
                _setOutlineColorRampAttr: function(a) {
                    this._set("outlineColorRamp",
                        a);
                    this._outlinePropModified = !0;
                    this._delayedCommitPropsTrigger()
                },
                outlineWidth: null,
                _setOutlineWidthAttr: function(a) {
                    this._set("outlineWidth", a);
                    this._outlinePropModified = !0;
                    this._delayedCommitPropsTrigger()
                },
                outlineColor: null,
                _setOutlineColorAttr: function(a) {
                    a = a === b.NO_COLOR ? null : a;
                    var c = !!this._optimizationOptions && this._optimizationCheckBox.checked;
                    !this._get("outlineColor") && a && c && (a.a = this._alphaBeforeOutlineColorCleared, this.dap_outlineColorPicker.set("color", a, !1), this._alphaBeforeOutlineColorCleared =
                        null);
                    this._set("outlineColor", a);
                    this._outlinePropModified = !0;
                    this._delayedCommitPropsTrigger()
                },
                outlinePattern: null,
                _setOutlinePatternAttr: function(a) {
                    this._set("outlinePattern", a);
                    this._outlinePropModified = !0;
                    this._delayedCommitPropsTrigger()
                },
                arrowPattern: null,
                _setArrowPatternAttr: function(a) {
                    this._set("arrowPattern", a);
                    this._outlinePropModified = !0;
                    this._delayedCommitPropsTrigger()
                },
                _getTabContainer: function(a) { return "fill" === a ? this.dap_fillContainer : "outline" === a ? this.dap_outlineContainer : this.dap_shapeContainer },
                _storeRecentFillColors: function() { this._storeRecentColors(this.dap_fillColorPicker, this._RECENT_FILL_COLORS_ITEM_KEY) },
                _storeRecentOutlineColors: function() { this._storeRecentColors(this.dap_outlineColorPicker, this._RECENT_OUTLINE_COLORS_ITEM_KEY) },
                _storeRecentColors: function(a, b) {
                    a.addRecentColor(a.get("color"));
                    a.saveRecentColors(b)
                },
                _isPoint: function() { return v.isPoint(this._editedSymbol) },
                _isLine: function() { return v.isLine(this._editedSymbol) },
                _isPolygon: function() { return v.isPolygon(this._editedSymbol) },
                _addHandlers: function() {
                    this.own(this.dap_shapeContainer.on("show", A.hitch(this, function() { this._symbolPicker._updateTemplatePickerIfHeightless() })));
                    this._linePatternSelect.on("change", A.hitch(this, function(a) { this.set("outlinePattern", a) }));
                    this._arrowPatternSelect.on("change", A.hitch(this, function(a) { this.set("arrowPattern", a) }));
                    this.own(P(this.dap_loadShapeImageUrl, x, A.hitch(this, function() { this._loadImage(this.dap_shapeImageUrlInput.get("value")) })));
                    this.own(P(this.dap_addImage, x, A.hitch(this,
                        function() {
                            g.show(this.dap_shapeImageUrlContainer);
                            this.dap_shapeImageUrlInput.focus()
                        })));
                    this.dap_shapeImageUrlInput.on("input", A.hitch(this, function(a) { a.keyCode === M.ENTER && this._loadImage(this.dap_shapeImageUrlInput.get("value")) }));
                    this.dap_shapeImageUrlInput.on("change", A.hitch(this, function(a) { this.set("shapeImageUrl", a) }));
                    this.dap_shapeSizeSlider.on("change", A.hitch(this, function(a) { this.set("shapeSize", a) }));
                    this.dap_fillColorPicker.on("color-change", A.hitch(this, function(a) {
                        this.set("fillColor",
                            a.color)
                    }));
                    this.dap_fillColorRampPicker.on("color-ramp-change", A.hitch(this, function(a) { this.set("fillColorRamp", a.colors) }));
                    this.dap_outlineColorRampPicker.on("color-ramp-change", A.hitch(this, function(a) { this.set("outlineColorRamp", a.colors) }));
                    this.dap_lineWidthSlider.on("change", A.hitch(this, function(a) { this.set("outlineWidth", a) }));
                    this.dap_outlineColorPicker.on("color-change", A.hitch(this, function(a) { this.set("outlineColor", a.color) }));
                    r.bindSliderAndTextBox(this.dap_lineWidthSlider, this._lineWidthTextBox);
                    r.bindSliderAndTextBox(this.dap_shapeSizeSlider, this.dap_shapeSizeTextBox);
                    this._symbolPicker.on("symbol-select", A.hitch(this, function(a) {
                        this._hideImageUrlInput();
                        this.set("shapeSymbol", a.selection)
                    }));
                    this.dap_shapeSizeSlider.on("change", A.hitch(this, this._onSizeChange));
                    this.dap_fillColorPicker.on("color-change", A.hitch(this, this._onFillColorChange));
                    this.dap_outlineColorPicker.on("color-change", A.hitch(this, this._onOutlineColorChange));
                    this.dap_lineWidthSlider.on("change", A.hitch(this, this._onWidthChange))
                },
                getStyle: function() {
                    var a = v.cloneSymbol(this._editedSymbol),
                        b = { symbol: a };
                    this._hasColorRamp() && (a = (a = v.isLine(a) || v.isPoint(a) && v.hasPureOutlineStyle(a)) ? this.dap_outlineColorRampPicker : this.dap_fillColorRampPicker, A.mixin(b, a.getStyle()));
                    this._optimizationOptions && (b.optimizeOutline = this._optimizationCheckBox.checked);
                    return b
                },
                storeColors: function() {
                    this._storeRecentFillColors();
                    this._storeRecentOutlineColors()
                },
                postCreate: function() {
                    this.inherited(arguments);
                    this._setUpComboBox();
                    var a = new h({},
                            this.dap_linePatternSelect),
                        b = new h({}, this.dap_arrowPatternSelect);
                    this._linePatternSelect = a;
                    this._arrowPatternSelect = b;
                    g.hide(this.dap_shapeImageUrlContainer);
                    this.dap_shapeImageUrlInput.set("placeholder", this.labels.imageUrlInputPlaceholder);
                    this._lineWidthTextBox.selectOnClick = !0;
                    this.dap_shapeSizeTextBox.selectOnClick = !0;
                    this.dap_lineWidthSlider.intermediateChanges = !0;
                    this._lineWidthTextBox.intermediateChanges = !0;
                    this.dap_shapeSizeSlider.intermediateChanges = !0;
                    this.dap_shapeSizeTextBox.intermediateChanges = !0;
                    this.dap_fillColorPicker.trackColors = !1;
                    this.dap_outlineColorPicker.trackColors = !1;
                    this._linePatternSelect.addIconOptions("solid dot dash dashdot longdashdotdot longdash longdashdot shortdash shortdot shortdashdot shortdashdotdot".split(" "), this.css.linePattern);
                    this._arrowPatternSelect.addIconOptions(["none", "begin", "end", "begin-end"], this.css.arrowPattern);
                    this._importRecentColors();
                    this.createTooltips([{ node: this.dap_shapeImageUrlContainer, label: this.labels.imageUrlInputTooltip }, {
                        node: this.dap_addImage,
                        label: this.labels.useImageTooltip
                    }, { node: this.dap_symbolSizeOptions }, { node: this.dap_lineWidthOptions }]);
                    this.dap_outlineColorPicker._enableTransparencySlider = function() {};
                    this.dap_outlineColorPicker._disableTransparencySlider = function() {}
                },
                _setUpComboBox: function() {
                    var a = G.createSubclass([E]),
                        b = document.createDocumentFragment();
                    F.forEach([1, 1.2, 1.5, 2, 3, 4, 5, 6, 7, 8, 9, 10], function(a) { b.appendChild(J.create("option", { innerHTML: K.format(a) })) });
                    this.dap_lineWidthTextBox.appendChild(b);
                    this._lineWidthTextBox =
                        new a({}, this.dap_lineWidthTextBox)
                },
                _updateSliderAndTextBoxConstraints: function(a) {
                    var b = a.minimum,
                        c = a.maximum;
                    a.textBox.set("constraints", { min: b, max: c, places: "0,2" });
                    a.slider.set({ minimum: b, maximum: c, discreteValues: Math.round(c) - Math.round(b) + 1 })
                },
                _loadImage: function(b) {
                    this._clearUrlImageErrorDisplay();
                    v.testImageUrl(b).then(A.hitch(this, function(c) {
                        var d = this._customImageSymbol;
                        c = v.preserveAspectRatio({ dimensions: c, targetDimension: "width", targetSize: this.shapeSize });
                        d ? (d.url = b, d.height = c.height,
                            d.width = c.width) : this._customImageSymbol = d = new a.PictureMarkerSymbol(b, c.width, c.height);
                        this._symbolPicker.addCustomImageSymbol(d);
                        this.set("shapeSymbol", d)
                    }), A.hitch(this, function() { this._showUrlImageErrorDisplay(this.labels.imageLoadError) }))
                },
                _showUrlImageErrorDisplay: function(a) { this.dap_shapeImageUrlErrorDisplay.innerHTML = a },
                _clearUrlImageErrorDisplay: function() { this.dap_shapeImageUrlErrorDisplay.innerHTML = "" },
                _getActiveTabAttr: function() {
                    var a = this.dap_stackContainer.selectedChildWidget;
                    return a ===
                        this.dap_outlineContainer ? "outline" : a === this.dap_fillContainer ? "fill" : "shape"
                },
                _updateTabs: function(a) {
                    this._toggleTabs(a);
                    this._showRelevantTabs(a);
                    this._selectActiveTab();
                    r.ensureEnabledChildSelection(this.dap_stackContainer)
                },
                _supportsPattern: function(a) { return v.isLine(a) || v.isPolygon(a) },
                _toggleTabs: function(a) {
                    this._shouldShowShapeTab(a) ? this._enableTab("shape") : this._disableTab("shape");
                    this._shouldShowFillTab(a) ? this._enableTab("fill") : this._disableTab("fill");
                    if (this._shouldShowOutlineTab(a)) {
                        this._enableTab("outline");
                        var b = [this._arrowPatternSelect, this.dap_arrowPatternSelectLabel];
                        F.forEach([this._linePatternSelect, this.dap_linePatternSelectLabel], g[v.isLine(a) || v.isPolygon(a) ? "show" : "hide"]);
                        F.forEach(b, g[v.isLine(a) ? "show" : "hide"])
                    } else this._disableTab("outline")
                },
                _shouldShowShapeTab: function(a) { return "simplemarkersymbol" === a.type || "picturemarkersymbol" === a.type },
                _enableTab: function(a) { r.enable(this._getTabContainer(a)) },
                _disableTab: function(a) { r.disable(this._getTabContainer(a)) },
                _shouldShowFillTab: function(b) {
                    return "simplemarkersymbol" ===
                        b.type && b.style === a.SimpleMarkerSymbol.STYLE_CIRCLE || "simplemarkersymbol" === b.type && b.style === a.SimpleMarkerSymbol.STYLE_SQUARE || "simplemarkersymbol" === b.type && b.style === a.SimpleMarkerSymbol.STYLE_DIAMOND || "simplefillsymbol" === b.type
                },
                _shouldShowOutlineTab: function(a) { return "simplemarkersymbol" === a.type || "simplefillsymbol" === a.type || "cartographiclinesymbol" === a.type || "simplelinesymbol" === a.type },
                _syncControls: function(b) {
                    var c, d;
                    this._hideImageUrlInput();
                    this._updateSizingConstraints();
                    this._shouldShowShapeTab(b) &&
                        (c = v.getMarkerLength(b), this.set("shapeSize", c), r.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeSlider, c), r.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeTextBox, c));
                    this._shouldShowFillTab(b) && (this.set("fillColor", b.color), this.dap_fillColorPicker.set("color", b.color, !1));
                    if (this._shouldShowOutlineTab(b)) {
                        d = v.getOutline(b);
                        var e = a.SimpleLineSymbol.defaultProps;
                        b = d ? d.color : null;
                        c = d ? d.width : e.width;
                        e = d && "none" !== d.style ? d.style : e.style;
                        d = d && d.marker ? d.marker.placement :
                            "none";
                        this.set("outlineColor", b);
                        this.set("outlineWidth", c);
                        this.set("outlinePattern", e);
                        this.set("arrowPattern", d);
                        this.dap_outlineColorPicker.set("color", b, !1);
                        r.silentlyUpdateIntermediateChangingValueWidget(this.dap_lineWidthSlider, c);
                        r.silentlyUpdateIntermediateChangingValueWidget(this._lineWidthTextBox, c);
                        this._linePatternSelect.set("value", e, !1);
                        this._arrowPatternSelect.set("value", d, !1)
                    }
                },
                _updateSizingConstraints: function() {
                    var a = v.getOutline(this._editedSymbol),
                        a = a && a.width > this._defaultMaxLineWidthInPx ?
                        Math.ceil(a.width) : this._defaultMaxLineWidthInPx,
                        b = v.getMarkerLength(this._editedSymbol),
                        b = b > this._defaultMaxShapeSizeInPx ? Math.ceil(b) : this._defaultMaxShapeSizeInPx;
                    this._updateSliderAndTextBoxConstraints({ textBox: this._lineWidthTextBox, slider: this.dap_lineWidthSlider, minimum: this._defaultMinLineWidthInPx, maximum: a });
                    this.findTooltip(this.dap_lineWidthOptions).set("label", O.substitute(this.labels.lineWidthTooltip, { min: this._defaultMinLineWidthInPx, max: a }));
                    this._updateSliderAndTextBoxConstraints({
                        textBox: this.dap_shapeSizeTextBox,
                        slider: this.dap_shapeSizeSlider,
                        minimum: this._defaultMinShapeSizeInPx,
                        maximum: b
                    });
                    this.findTooltip(this.dap_symbolSizeOptions).set("label", O.substitute(this.labels.symbolSizeTooltip, { min: this._defaultMinShapeSizeInPx, max: b }))
                },
                _assimilateSymbol: function(a) {
                    this._updateTabs(a);
                    this._syncControls(a)
                },
                startup: function() {
                    this.inherited(arguments);
                    var a = new m(this._getSymbolPickerParams(), this.dap_symbolPicker);
                    a.startup();
                    this._symbolPicker = a;
                    this._addHandlers()
                },
                _getSymbolPickerParams: function() {
                    return {
                        portal: this.portal ||
                            this.portalSelf || this.portalUrl
                    }
                },
                _hideImageUrlInput: function() {
                    this._clearUrlImageErrorDisplay();
                    g.hide(this.dap_shapeImageUrlContainer);
                    this.dap_shapeImageUrlInput.set("value", "")
                },
                _showRelevantTabs: function() {
                    var a = this.dap_stackContainer,
                        b = this.dap_shapeContainer,
                        c = this.dap_fillContainer,
                        d = this.dap_outlineContainer,
                        e, f, h;
                    F.forEach(a.getChildren(), function(b) { a.removeChild(b) });
                    this._isPoint() && (h = f = e = !0);
                    this._isLine() && (h = !0);
                    this._isPolygon() && (h = f = !0);
                    var m = this._tabOptions.excluded || []; - 1 <
                        F.indexOf(m, "shape") && (e = !1); - 1 < F.indexOf(m, "outline") && (h = !1); - 1 < F.indexOf(m, "fill") && (f = !1);
                    e && a.addChild(b);
                    f && a.addChild(c);
                    h && a.addChild(d);
                    1 === a.getChildren().length ? g.hide(this.dap_stackController.domNode) : g.show(this.dap_stackController.domNode)
                },
                _selectActiveTab: function() { var a = this._getTabContainer(this._activeTabName); - 1 < this.dap_stackContainer.getIndexOfChild(a) && this.dap_stackContainer.selectChild(a) },
                _onFillColorChange: function(a) { this.set("fillColor", a.color) },
                _onOutlineColorChange: function(a) {
                    this.set("outlineColor",
                        a.color)
                },
                _getFillColor: function() { return !this._isLine() && this._hasColorRamp() ? this._getMiddleItem(this.fillColorRamp) : this.fillColor },
                _getMiddleItem: function(a) { return a[Math.floor(.5 * (a.length - 1))] },
                _getOutlineColor: function() { return this._shouldShowOutlineColorRamp(this._editedSymbol) ? this._getMiddleItem(this.outlineColorRamp) : this.outlineColor },
                _commitProperties: function() {
                    var b = this._editedSymbol;
                    this._shouldShowShapeTab(b) && this._updateShapeSize();
                    this._shouldShowFillTab(b) && (v.setFillColor(b,
                        this._getFillColor()), this._isPreppingEdit || this._ensureSupportedSfsStyle(b));
                    if (this._shouldShowOutlineTab(b)) {
                        var c = v.getOutline(b);
                        this._isPreppingEdit || c || !this._outlinePropModified || (b.outline = new a.SimpleLineSymbol);
                        v.setOutlineColor(b, this._getOutlineColor());
                        this._updateArrowPattern();
                        this._updateOutlinePattern();
                        this._updateOutlineWidth()
                    }
                    this._updatePreviewSymbol();
                    this._toggleOutlineOptions();
                    this._isPreppingEdit = !1;
                    this.emit("style-update")
                },
                _ensureSupportedSfsStyle: function(a) {
                    "simplefillsymbol" !==
                    a.type || "none" === a.style && "solid" === a.style || (a.style = "solid")
                },
                _toggleOutlineOptions: function() {
                    var a = !!this._optimizationOptions && this._optimizationCheckBox.checked,
                        b = this.outlineColor,
                        c = this._isLine(),
                        d = !b,
                        e = !b;
                    this._toggleLabeledControls({ labels: this.dap_lineWidthLabel, controls: [this._lineWidthTextBox, this.dap_lineWidthSlider], disabled: this._externalSizing && c || !b || a });
                    this._toggleLabeledControls({ labels: this._optimizationLabel, controls: [this._optimizationCheckBox], disabled: !b });
                    b || (this._alphaBeforeOutlineColorCleared =
                        1 - this.dap_outlineColorPicker.dap_transparencySlider.get("value"));
                    this._toggleLabeledControls({ labels: this.dap_linePatternSelectLabel, controls: [this._linePatternSelect, this._arrowPatternSelect], disabled: e });
                    this._toggleLabeledControls({ labels: [this.dap_outlineColorPicker.dap_transparencyLabel], controls: [this.dap_outlineColorPicker.dap_transparencySlider], disabled: d })
                },
                _updatePreviewSymbol: function() {
                    var a = this._editedSymbol,
                        b = this.css.alt,
                        c = this.dap_symbolPreview;
                    this._symbolPreviewSurface && this._symbolPreviewSurface.destroy();
                    H.toggle(c, b, this._blendsIntoBackground(a));
                    this._symbolPreviewSurface = v.renderOnSurface(a, c)
                },
                _blendsIntoBackground: function(a) { return v.hasColor(a.outline) ? this._isWhitish(a.outline.color) : this._isWhitish(a.color) },
                _isWhitish: function(a) { return a && 246 < a.r && 246 < a.g && 246 < a.b },
                destroy: function() {
                    this._symbolPreviewSurface && this._symbolPreviewSurface.destroy();
                    J.destroy(this._optimizationSection);
                    this._optimizationCheckBox.destroy();
                    this.dap_shapeContainer.destroy();
                    this.dap_fillContainer.destroy();
                    this.dap_outlineContainer.destroy();
                    this.inherited(arguments)
                },
                _updateSuggestedColors: function(a, b) { a.set("suggestedColors", b) },
                _updateOutlineWidth: function() { v.setOutlineWidth(this._editedSymbol, this.outlineWidth) },
                _onWidthChange: function(a) { this.set("outlineWidth", a) },
                _onSizeChange: function(a) { this.set("shapeSize", a) },
                _updateShapeSize: function() { v.setSize(this._editedSymbol, this.shapeSize) },
                _updateOutlinePattern: function() {
                    this._shouldShowOutlineTab(this._editedSymbol) && v.setOutlineStyle(this._editedSymbol,
                        this.outlinePattern)
                },
                _updateArrowPattern: function() { this._shouldShowOutlineTab(this._editedSymbol) && v.setLineMarker(this._editedSymbol, v.toLineMarker(this.arrowPattern)) },
                _show: function(a) { H.remove(g.getNode(a), this.css.hidden) },
                _hide: function(a) { H.add(g.getNode(a), this.css.hidden) },
                popUp: function(a) { r.popUp(this, a) }
            });
            A.setObject("dijit.SymbolStyler", c, n);
            return c
        })
}, "esri/symbol": function() {
    define("./symbols/Symbol ./symbols/MarkerSymbol ./symbols/SimpleMarkerSymbol ./symbols/PictureMarkerSymbol ./symbols/LineSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/FillSymbol ./symbols/SimpleFillSymbol ./symbols/PictureFillSymbol ./symbols/Font ./symbols/TextSymbol ./symbols/jsonUtils".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v) { return { Symbol: b, MarkerSymbol: g, SimpleMarkerSymbol: n, PictureMarkerSymbol: a, LineSymbol: c, SimpleLineSymbol: d, CartographicLineSymbol: f, FillSymbol: e, SimpleFillSymbol: h, PictureFillSymbol: m, Font: p, TextSymbol: r, jsonUtils: v } })
}, "esri/dijit/SymbolStyler/_DelayedUpdate": function() {
    define(["dojo/_base/declare"], function(b) {
        return b(null, {
            declaredClass: "esri.dijit._DelayedUpdate",
            createUpdateTrigger: function(b, n) {
                var a = -1;
                return function() {
                    -1 < a || (a = setTimeout(function() {
                        a = -1;
                        b.call(n)
                    }, 0))
                }
            }
        })
    })
}, "esri/dijit/SymbolStyler/IconSelect": function() {
    define("../../kernel dijit/form/Select dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/has".split(" "), function(b, g, n, a, c, d, f) {
        g = a("esri.dijit.SymbolStyler.IconSelect", [g], {
            baseClass: "esriIconSelect dijitSelect dijitValidationTextBox",
            _extraIconClass: null,
            addIconOptions: function(a, b) {
                b = b || "";
                a = n.map(a, function(a) { return { value: a, iconClass: b + " " + a } });
                this.addOption(a)
            },
            _getMenuItemForOption: function(a) {
                var b =
                    this.inherited(arguments);
                b.set("iconClass", a.iconClass);
                return b
            },
            _setValueAttr: function(a) {
                this.inherited(arguments);
                var b = this.containerNode;
                d.remove(b, this._getAllIconClasses());
                d.add(b, this.get("selectedOptions").iconClass)
            },
            _getAllIconClasses: function() { return n.map(this.options, function(a) { return a.iconClass }) }
        });
        c.setObject("dijit.SymbolStyler.IconSelect", g, b);
        return g
    })
}, "esri/dijit/SymbolStyler/MarkerSymbolPicker": function() {
    define("../../arcgis/Portal ../../domUtils ../../kernel ../../promiseList ../../request ../../symbols/jsonUtils ../_EventedWidget ../_Tooltip ../editing/TemplatePicker ../util/busyIndicator ./symbolUtil dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/Deferred dojo/dom-class dojo/dom-construct dojo/dom-style dojo/promise/all dojo/sniff dojo/store/Memory dojo/store/Observable dojox/gfx dojo/i18n!../../nls/jsapi dojo/text!./templates/MarkerSymbolPicker.html dijit/form/Select".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P) {
            var O = { dataUrl: null, id: "customTypes", keywords: "custom symbols", name: K.widgets.symbolEditor.customImages, title: K.widgets.symbolEditor.customImages };
            f = t("esri.dijit.SymbolStyler.MarkerSymbolPicker", [f, r, v, e], {
                baseClass: "esriMarkerSymbolPicker",
                templateString: P,
                labels: K.widgets.symbolEditor,
                css: {
                    noSymbols: "esriNoSymbols",
                    defaultSymbols: "esriDefaultSymbols",
                    loadingIndicator: "esriLoadingIndicator",
                    loading: "esriLoading",
                    typeInput: "esriTypeInput",
                    container: "esriContainer",
                    overlay: "esriOverlay",
                    content: "esriContent",
                    centerContainer: "esriCenterContainer",
                    table: "esriTable",
                    tableCell: "esriTableCell",
                    centerBlock: "esriCenterBlock",
                    customSelected: "esriMarkerSymbolPicker--custom-selected"
                },
                portal: "http://arcgis.com/",
                displayMode: "portal",
                _symbolTypesStore: null,
                _symbolItemStore: null,
                _noSymbolsOverlay: null,
                _templatePicker: null,
                _portal: null,
                _portalLoadTimeoutInMs: 3E3,
                _loadingIndicator: null,
                _storageItemKeyBase: "markerSymbolPicker/symbol",
                _defaultSimpleMarkerSymbols: [{
                    name: "Circle",
                    type: "esriSMS",
                    style: "esriSMSCircle",
                    color: [0, 0, 128, 128],
                    size: 18,
                    outline: { color: [0, 0, 128, 255], width: 1 }
                }, { name: "Square", type: "esriSMS", style: "esriSMSSquare", color: [0, 0, 128, 128], size: 18, outline: { color: [0, 0, 128, 255], width: 1 } }, { name: "Diamond", type: "esriSMS", style: "esriSMSDiamond", color: [0, 0, 128, 128], size: 18, outline: { color: [0, 0, 128, 255], width: 1 } }, { name: "Cross", type: "esriSMS", style: "esriSMSCross", color: [0, 0, 128, 128], size: 18, outline: { color: [0, 0, 128, 255], width: 1 } }, {
                    name: "X",
                    type: "esriSMS",
                    style: "esriSMSX",
                    color: [0, 0, 128, 128],
                    size: 18,
                    outline: { color: [0, 0, 128, 255], width: 1 }
                }],
                postCreate: function() {
                    this.inherited(arguments);
                    this._symbolTypesStore = new L(new J);
                    this._symbolItemStore = new J;
                    this.dap_markerCategoryInput.set({ labelAttr: "name", sortByLabel: !1 });
                    this.createTooltip(this.dap_markerCategoryInput, this.labels.selectCategoryTooltip)
                },
                _toggleCustomItemCss: function() { G.toggle(this.domNode, this.css.customSelected, this.dap_markerCategoryInput.get("value") === O.id) },
                addCustomImageSymbol: function(a) {
                    var b = d.fromJson(a.toJson());
                    a = JSON.parse(localStorage.getItem(this._getCustomItemKey())) || [];
                    var c = b.url.split("/").pop();
                    w.some(a, function(a) { return a.url === b.url }) || (b.type = "esriPMS", b.name = c, a.push(b), localStorage.setItem(this._getCustomItemKey(), JSON.stringify(a)), this.dap_markerCategoryInput.set("value", O.id), this.clearSelection(), this._fetchSymbols(O.id))
                },
                _updateTemplatePickerIfHeightless: function() { 0 === D.get(this._templatePicker.domNode, "height") && this._templatePicker.update() },
                startup: function() {
                    this.inherited(arguments);
                    var a = new h({ rows: "auto", columns: 6, items: [], emptyMessage: "" }, this.dap_templatePicker);
                    a.startup();
                    this._templatePicker = a;
                    a.on("selection-change", B.hitch(this, function() {
                        var b = a.getSelected();
                        b && (b = p.cloneSymbol(b.item.symbol), this.emit("symbol-select", { selection: b }))
                    }));
                    this._loadingIndicator = m.create(this.dap_symbolViewport);
                    this.own(this._loadingIndicator);
                    this.dap_markerCategoryInput.on("change", B.hitch(this, function(a) {
                        this.clearSelection();
                        this._toggleCustomItemCss();
                        this._fetchSymbols(a)
                    }));
                    this._normalizeSymbolStorage();
                    this._loadStoredSymbolItems();
                    this._setUpSymbolCategories().then(B.hitch(this, this.updateDisplay))
                },
                _fetchSymbols: function(a) {
                    var b;
                    this._templatePicker.items = [];
                    if (b = this._symbolItemStore.query({ id: a })[0])
                        if (this._saveRecentItem(b), this._updateSymbolOptions(b.items), b.id !== O.id) return;
                    b = this._symbolTypesStore.query({ id: a });
                    this._showLoadingIndicator();
                    this._getSymbolListData(b).then(B.hitch(this, this._symbolItemsFromJson)).then(B.hitch(this, function(b) {
                        var c = {
                                id: a,
                                items: b
                            },
                            d;
                        this._symbolItemStore.put(c);
                        this._saveRecentItem(c);
                        (d = this._symbolTypesStore.query({ defaultType: !0 })[0]) && d.id === a && this._saveDefaultItem(c);
                        return b
                    })).then(B.hitch(this, this._updateSymbolOptions))
                },
                _saveRecentItem: function(a) {
                    a = { id: a.id, items: this._symbolItemsToJson(a.items) };
                    sessionStorage.setItem(this._getRecentItemKey(), JSON.stringify(a))
                },
                _getRecentItemKey: function() { return this._toItemKey("/recent") },
                _toItemKey: function(a) { return this._storageItemKeyBase + a },
                _getCustomItemKey: function() { return this._toItemKey("/custom") },
                _getDefaultItemKey: function() { return this._toItemKey("/default") },
                _getTypesItemKey: function() { return this._toItemKey("/types") },
                _getVersionItemKey: function() { return this._toItemKey("/version") },
                _saveDefaultItem: function(a) {
                    a = { id: a.id, items: this._symbolItemsToJson(a.items) };
                    localStorage.setItem(this._getDefaultItemKey(), JSON.stringify(a))
                },
                _showNoSymbolsMessage: function() {
                    this._hideLoadingIndicator();
                    G.add(this.domNode, this.css.noSymbols);
                    this._placeNoSymbolsOverlay()
                },
                _placeNoSymbolsOverlay: function() {
                    var a,
                        b, c;
                    this._noSymbolsOverlay || (c = this.css, a = F.create("div", { "class": c.overlay }), b = F.create("div", { "class": c.centerContainer + " " + c.table }, a), b = F.create("div", { "class": c.tableCell }, b), b = F.create("div", { "class": c.centerBlock }, b), F.create("div", { "class": c.content, innerHTML: this.labels.symbolLoadError }, b), F.place(a, this.domNode), this._noSymbolsOverlay = a)
                },
                _getStorageVersionKey: function() { return n.version + "|" + x.locale },
                _normalizeSymbolStorage: function() {
                    var a = localStorage.getItem(this._getVersionItemKey()),
                        b = this._getStorageVersionKey();
                    a !== b && (localStorage.setItem(this._getVersionItemKey(), b), localStorage.removeItem(this._getTypesItemKey()), localStorage.removeItem(this._getDefaultItemKey()), sessionStorage.removeItem(this._getRecentItemKey()))
                },
                _loadStoredSymbolItems: function() {
                    var a = this._loadDefaultSymbolItem(),
                        b = this._loadRecentSymbolItem();
                    a && this._symbolItemStore.put(this._symbolItemsFromSymbolItemJson(a));
                    b && this._symbolItemStore.put(this._symbolItemsFromSymbolItemJson(b))
                },
                _loadDefaultSymbolItem: function() {
                    var a =
                        localStorage.getItem(this._getDefaultItemKey());
                    if (a) return JSON.parse(a)
                },
                _loadRecentSymbolItem: function() { var a = sessionStorage.getItem(this._getRecentItemKey()); if (a) return JSON.parse(a) },
                _loadSymbolTypes: function() { var a = localStorage.getItem(this._getTypesItemKey()); if (a) return JSON.parse(a) },
                _saveSymbolTypes: function(a) { localStorage.setItem(this._getTypesItemKey(), JSON.stringify(a)) },
                _symbolItemsFromSymbolItemJson: function(a) {
                    a.items = w.map(a.items, function(a) { return { symbol: d.fromJson(a.symbol) } });
                    return a
                },
                _fetchSymbolTypes: function() {
                    var a = new E,
                        b = this._loadSymbolTypes();
                    return b ? (a.resolve(b), a.promise) : this._getSymbolListGroupId().then(B.hitch(this, this._getSymbolListItems)).then(B.hitch(this, function(a) { this._saveSymbolTypes(a); return a }))
                },
                _setUpSymbolCategories: function() { this._showLoadingIndicator(); return this._initPortal().then(B.hitch(this, this._fetchSymbolTypes)).then(B.hitch(this, this._injectCustomSymbolType)).then(B.hitch(this, this._setUpSymbolSelect), B.hitch(this, function() { this._showNoSymbolsMessage() })) },
                _setUpSymbolSelect: function(a) {
                    var b = this._symbolTypesStore,
                        c, d;
                    b.setData(a);
                    w.forEach(a, function(a) { a.defaultType && (c = a.id) });
                    if (a = this._loadRecentSymbolItem())
                        if (d = b.query({ id: a.id })[0]) c = a.id;
                    this.dap_markerCategoryInput.set("store", b);
                    this.dap_markerCategoryInput.set("value", c, !1);
                    this._toggleCustomItemCss()
                },
                _injectCustomSymbolType: function(a) { a.push(O); return a },
                _showLoadingIndicator: function() { 8 >= H("ie") ? G.add(this.domNode, this.css.loading) : this._loadingIndicator.show() },
                _hideLoadingIndicator: function() {
                    8 >=
                        H("ie") ? G.remove(this.domNode, this.css.loading) : this._loadingIndicator.hide()
                },
                _initPortal: function() {
                    var a = new E,
                        c = this.portal || "http://arcgis.com/",
                        d;
                    d = "string" === typeof c ? new b.Portal(c) : c.declaredClass ? c : new b.Portal({ self: c });
                    if (d.loaded) return this._portal = d, a.resolve(), a.promise;
                    this.own(d.on("load", B.hitch(this, function() {
                        this._portal = d;
                        a.resolve()
                    })));
                    setTimeout(function() { a.reject() }, this._portalLoadTimeoutInMs);
                    return a.promise
                },
                _getSymbolListGroupId: function() {
                    var a = new E;
                    this._portal.queryGroups({ q: this._portal.symbolSetsGroupQuery }).then(function(b) { a.resolve(b.results[0].id) },
                        function() { a.reject() });
                    return a.promise
                },
                _getSymbolListItems: function(a) {
                    var b = new E,
                        c = this._portal;
                    a = "group:" + a + ' AND type:"Symbol Set"';
                    var d = [];
                    a = "vml" === M.renderer ? a + ' AND -typekeywords:"by value"' : a + ' AND (typekeywords:"by value" AND typekeywords:"marker")';
                    c.queryItems({ q: a, num: 50, sortField: "title" }).then(B.hitch(this, function(a) {
                        var c, e, f, g;
                        w.forEach(a.results, function(a) {
                            c = a.typeKeywords.join(" "); - 1 < c.indexOf("marker") && (e = a.title, f = { name: e, id: a.id, title: a.title, keywords: c, dataUrl: a.itemDataUrl },
                                (g = -1 < c.indexOf("default")) ? (f.defaultType = !0, d.unshift(f)) : d.push(f))
                        }, this);
                        0 < d.length ? b.resolve(d) : b.reject()
                    }), function() { b.reject() });
                    return b.promise
                },
                _getSymbolListData: function(b) {
                    var d = w.filter(b, function(a) { return a.dataUrl });
                    b = w.filter(b, function(a) { return a.id === O.id })[0];
                    var d = A(w.map(d, function(a) { return c({ url: a.dataUrl }).promise })).then(function(a) { return a[0] || [] }),
                        e = this._getCustomItemKey(),
                        f = b && JSON.parse(localStorage.getItem(e)) || [];
                    b = a(f.map(function(a) { return p.testImageUrl(a.url) })).then(function(a) {
                        var b =
                            f.filter(function(b, c) { return !(a[c] instanceof Error) });
                        b.length !== f.length && localStorage.setItem(e, JSON.stringify(b));
                        return b
                    });
                    return A([d, b]).then(function(a) { return [].concat(a[0], a[1]) })
                },
                _symbolItemsFromJson: function(a) { return w.map(a, function(a) { return { symbol: d.fromJson(a) } }) },
                _symbolItemsToJson: function(a) { return w.map(a, function(a) { return { symbol: a.symbol.toJson() } }) },
                _updateSymbolOptions: function(a) {
                    var b = this._templatePicker;
                    b.items = a;
                    b.update();
                    b.domNode.parentNode.scrollTop = 0;
                    this._hideLoadingIndicator()
                },
                _setDisplayModeAttr: function(a) { this.displayMode !== a && (this._set("displayMode", a), this.updateDisplay(a)) },
                updateDisplay: function() {
                    var a = this.dap_markerCategoryInput;
                    this.clearSelection();
                    "portal" === this.displayMode ? (this._fetchSymbols(a.value), g.show(a.domNode), G.remove(this.domNode, this.css.defaultSymbols)) : "default" === this.displayMode && (this._updateSymbolOptions(this._symbolItemsFromJson(this._defaultSimpleMarkerSymbols)), g.hide(a.domNode), G.add(this.domNode, this.css.defaultSymbols))
                },
                clearSelection: function() { this._templatePicker.clearSelection() },
                resetSelection: function() {
                    var a = this.dap_markerCategoryInput,
                        b = a.get("options");
                    a.set("value", b[0]);
                    this.clearSelection()
                }
            });
            B.setObject("dijit.SymbolStyler.MarkerSymbolPicker", f, n);
            return f
        })
}, "esri/dijit/editing/TemplatePicker": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/_Widget dijit/_Templated dojo/data/ItemFileReadStore dojox/grid/DataGrid dojox/gfx ../../layers/FeatureLayer ../../symbols/SimpleMarkerSymbol ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ./TemplatePickerItem ../../kernel ../../lang ../../request ../_EventedWidget dojo/i18n!../../nls/jsapi dojo/text!./templates/TemplatePicker.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S) {
            var W = b([O, t, x], {
                declaredClass: "esri.dijit.editing.TemplatePicker",
                widgetsInTemplate: !0,
                templateString: S,
                featureLayers: null,
                items: null,
                grouping: !0,
                showTooltip: !1,
                maxLabelLength: 0,
                rows: 4,
                _rows: 0,
                columns: 3,
                surfaceWidth: 30,
                surfaceHeight: 30,
                emptyMessage: "",
                useLegend: !0,
                legendCache: {},
                _uniqueId: { id: 0 },
                _assumedCellWidth: 90,
                _initialAutoWidth: 300,
                _initialAutoHeight: 200,
                _ieTimer: 150,
                constructor: function(a, b) {
                    a = a || {};
                    this._dojo14x = 4 <= f.version.minor;
                    this._itemWidgets = {};
                    a.featureLayers && a.featureLayers.length && (this._flChanged = 1);
                    this._nls = R.widgets.templatePicker;
                    this.emptyMessage = a.emptyMessage || this._nls && this._nls.creationDisabled || ""
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this._preprocess()
                },
                startup: function() {
                    this.inherited(arguments);
                    if ("auto" === this.rows && "auto" === this.columns) {
                        var a = v.getContentBox(this.domNode);
                        a.w || (this.domNode.style.width = this._initialAutoWidth + "px");
                        if (!a.h || 1 >= a.h) this.domNode.style.height = this._initialAutoHeight +
                            "px";
                        a = v.getContentBox(this.domNode);
                        this._columns = Math.floor(a.w / this._assumedCellWidth) || 1
                    }
                    this._applyGridPatches();
                    this._setGridLayout();
                    n.connect(this.grid, "onRowClick", this, this._rowClicked);
                    this._setGridData();
                    this._toggleTooltip();
                    9 > e("ie") && (this._repaintItems = g.hitch(this, this._repaintItems), setTimeout(this._repaintItems, this._ieTimer))
                },
                destroy: function() {
                    this.showTooltip = !1;
                    this._toggleTooltip();
                    this._clearLegendInfo();
                    this.featureLayers = this.items = this.grid = this._flItems = this._itItems =
                        this._groupRowIndices = this._selectedCell = this._selectedInfo = this._selectedItem = null;
                    this.inherited(arguments)
                },
                getSelected: function() { return this._selectedCell ? this._selectedItem : null },
                clearSelection: function() {
                    var a = this._selectedCell,
                        b = this._selectedInfo;
                    a && this._rowClicked({ cellNode: a, rowIndex: b.selRow, cellIndex: b.selCol })
                },
                update: function(b) {
                    b = "auto" === this.rows && "auto" === this.columns && b ? !0 : !1;
                    var c = this.grid,
                        d;
                    if (b) {
                        d = this.domNode;
                        var g;
                        g = f.query("#" + d.id + ".templatePicker div.item")[0];
                        d = v.getContentBox(d);
                        g = (g = g && g.parentNode) ? a.coords(g).w : this._assumedCellWidth;
                        this._columns = (this._columns = Math.floor((d.w - c.views.views[0].getScrollbarWidth()) / g)) || 1
                    }
                    g = this._rows;
                    this._preprocess();
                    var h = this._rows;
                    this._setGridLayout();
                    this._setGridData();
                    h !== g && c.set("autoHeight", this._rows, !1);
                    b ? (c._resize({ w: d.w, h: d.h }), c.viewsHeaderNode.style.display = "none") : c.update();
                    this._toggleTooltip();
                    var m = this,
                        n = this.getSelected();
                    n && c.store.fetch({
                        onComplete: function(a) {
                            var b = (a = m._locate(n, m._selectedInfo, a)) && c.views.views[0].getCellNode(a[0],
                                a[1]);
                            b && m._rowClicked({ cellNode: b, rowIndex: a[0], cellIndex: a[1] }, !0)
                        }
                    });
                    9 > e("ie") && setTimeout(this._repaintItems, this._ieTimer);
                    b = this.featureLayers;
                    d = this.items;
                    b && b.length || d && d.length || !c || !this.emptyMessage || c.showMessage(this.emptyMessage)
                },
                _eventMap: { "selection-change": !0 },
                onSelectionChange: function() {},
                _setUseLegendAttr: function(a) {
                    var b = this.useLegend;
                    this._started && b === a || (a ? this._flChanged = 1 : this._clearLegendInfo());
                    this.useLegend = a
                },
                _setFeatureLayersAttr: function(a) {
                    var b = this.featureLayers;
                    this._started && b === a || (this._flChanged = 1);
                    this.featureLayers = a
                },
                _adjustRowsCols: function(a) {
                    if ("auto" === this.rows && "auto" === this.columns) this._started || (this._rows = !1, this._columns = null, this._autoWidth = !1);
                    else {
                        var b = 0;
                        this._rows = this.rows;
                        this._columns = this.columns;
                        "auto" === this.rows ? (this.featureLayers ? this.grouping ? (b = a.length, c.forEach(a, function(a) { b += Math.ceil(a.length / this.columns) }, this)) : (c.forEach(a, function(a) { b += a.length }, this), b = Math.ceil(b / this.columns)) : b = Math.ceil(a.length / this.columns),
                            this._rows = b) : "auto" === this.columns && (this.featureLayers ? this.grouping ? b = 3 : (c.forEach(a, function(a) { b += a.length }, this), b = Math.ceil(b / this.rows)) : b = Math.ceil(a.length / this.rows), this._columns = b)
                    }
                },
                _preprocess: function() {
                    this.items && (this.grouping = !1);
                    this._autoWidth = !1;
                    if ("auto" === this.rows || "auto" === this.columns) this._autoWidth = !0;
                    var a;
                    if (this.featureLayers)
                        if (this.useLegend && this._flChanged && (this._legendIndices = [], this._loadingIndices = [], this._legendSymbols = {}, this._ignoreLegends(), this._loadingLegends = [], clearTimeout(this._legendTimer), this._legendTimer = null, this._processSelectionLayers(), this._flChanged = 0), c.every(this.featureLayers, function(a) { return a.loaded })) this.featureLayers = c.filter(this.featureLayers, function(a) { return !(a.hasZ && !a.enableZDefaults) }), a = this._flItems = this._getItemsFromLayers(this.featureLayers), this._adjustRowsCols(a);
                        else {
                            var b = this.featureLayers.length;
                            c.forEach(this.featureLayers, function(a) {
                                if (a.loaded) b--;
                                else var c = n.connect(a, "onLoad", this, function() {
                                    n.disconnect(c);
                                    c = null;
                                    b--;
                                    b || this.update()
                                })
                            }, this)
                        }
                    else a = this._itItems = this._getItemsFromItems(this.items), this._adjustRowsCols(a)
                },
                _processSelectionLayers: function() {
                    var a, b, d, e, f, h, m, n = {};
                    c.forEach(this.featureLayers, function(c, f) {
                        c.mode === F.MODE_SELECTION && c._map && c.url && c._params.drawMode && !c.source && (b = g.trim(c._url.path).replace(/\/(MapServer|FeatureServer).*/ig, "/MapServer").replace(/^https?:\/\//ig, "").toLowerCase(), d = n[b] = n[b] || {}, e = d.featureLayers = d.featureLayers || {}, h = d.indices = d.indices || [], e[f] = c,
                            h.push(f), a = c._map)
                    });
                    a && c.forEach(a.layerIds, function(c) {
                        (c = a.getLayer(c)) && c.url && (c.getImageUrl || c.getTileUrl) && c.loaded && 10.1 <= c.version && (b = g.trim(c._url.path).replace(/(\/MapServer).*/ig, "$1"), f = b.replace(/^https?:\/\//ig, "").toLowerCase(), n[f] && !n[f].mapServiceUrl && (d = n[f], d.mapServiceUrl = b, d.mapServiceLayer = c, this._legendIndices = this._legendIndices.concat(d.indices), m = this._fetchLegend({ pickerInstance: this, info: d }, f), m.then ? (this._loadingIndices = this._loadingIndices.concat(d.indices), this._loadingLegends.push(m)) :
                            this._processLegendResponse(m, d)))
                    }, this)
                },
                _fetchLegend: function(a, b) {
                    var d = W.prototype,
                        e = d.legendCache[b];
                    e ? e.then && e._contexts.push(a) : (e = d.legendCache[b] = P({ url: a.info.mapServiceUrl + "/legend", content: { f: "json" }, callbackParamName: "callback" }), e._contexts = [a], e.addBoth(function(a) {
                        if (!e.canceled) {
                            d.legendCache[b] = a;
                            var f = e._contexts;
                            e._contexts = null;
                            c.forEach(f, function(b) {
                                var d = b.pickerInstance;
                                b = b.info;
                                var f;
                                d._destroyed || (c.forEach(b.indices, function(a) {
                                    f = c.indexOf(d._loadingIndices, a); - 1 < f &&
                                        d._loadingIndices.splice(f, 1)
                                }), f = c.indexOf(d._loadingLegends, e), -1 < f && d._loadingLegends.splice(f, 1), d._processLegendResponse(a, b))
                            })
                        }
                    }));
                    return e
                },
                _clearLegendInfo: function() {
                    clearTimeout(this._legendTimer);
                    this._ignoreLegends();
                    this._legendIndices = this._loadingIndices = this._legendSymbols = this._loadingLegends = this._legendTimer = null
                },
                _ignoreLegends: function() {
                    this._loadingLegends && c.forEach(this._loadingLegends, function(a) {
                        var b = -1;
                        c.some(a._contexts, function(a, c) {
                            a.pickerInstance === this && (b = c);
                            return -1 <
                                b
                        }, this); - 1 < b && a._contexts.splice(b, 1)
                    }, this)
                },
                _processLegendResponse: function(a, b) {
                    if (!a || a instanceof Error) {
                        var d;
                        c.forEach(b.indices, function(a) { d = c.indexOf(this._legendIndices, a); - 1 < d && this._legendIndices.splice(d, 1) }, this)
                    } else c.forEach(b.indices, function(d) {
                        var e = b.featureLayers[d].layerId,
                            f, g = b.mapServiceUrl + "/" + e + "/images/",
                            h = b.mapServiceLayer._getToken(),
                            m, n, p, r;
                        this._legendSymbols[d] || (m = null, c.some(a.layers, function(a) { a.layerId == e && (m = a); return !!m }), m && (n = this._legendSymbols[d] = {}, c.forEach(m.legend,
                            function(a) {
                                if ((p = a.values) && p.length)
                                    for (f = 0; f < p.length; f++) n[p[f]] = a;
                                else n.defaultSymbol = a;
                                (r = a.url) && !a._fixed && (a._fixed = 1, -1 === r.search(/https?\:/) && (a.url = g + r), h && -1 !== a.url.search(/https?\:/) && (a.url += (-1 < a.url.indexOf("?") ? "\x26" : "?") + "token\x3d" + h))
                            })))
                    }, this);
                    var e = this;
                    e._started && !e._legendTimer && (e._legendTimer = setTimeout(function() {
                        clearTimeout(e._legendTimer);
                        e._legendTimer = null;
                        e._destroyed || e.update()
                    }, 0))
                },
                _applyGridPatches: function() {
                    var a = this.grid,
                        b = a.adaptWidth,
                        c, d, e;
                    a.adaptWidth =
                        function() {
                            c = this.views.views;
                            for (d = 0; e = c[d]; d++) w.set(e.headerNode, "display", "block");
                            b.apply(this, arguments);
                            for (d = 0; e = c[d]; d++) w.set(e.headerNode, "display", "none")
                        };
                    if (this._dojo14x) {
                        if ("auto" !== this.rows && "auto" !== this.columns) var f = n.connect(a, "_onFetchComplete", this, function() {
                            n.disconnect(f);
                            this.grid.set("autoHeight", this._rows)
                        });
                        n.connect(a, "_onDelete", this, this._destroyItems);
                        n.connect(a, "_clearData", this, this._destroyItems);
                        n.connect(a, "destroy", this, this._destroyItems);
                        (a = a.focus) && a.findAndFocusGridCell &&
                            (a.findAndFocusGridCell = function() { return !1 })
                    }
                },
                _setGridLayout: function() {
                    var a = function(a) { return function(b, c) { return this._cellGet(a, b, c) } },
                        b = g.hitch(this, this._cellFormatter),
                        c = [],
                        d = this._columns,
                        e;
                    for (e = 0; e < d; e++) c.push({ field: "cell" + e, get: g.hitch(this, a(e)), formatter: b });
                    a = { cells: [c] };
                    this.grouping && (d = { field: "groupName", colSpan: d, get: g.hitch(this, this._cellGetGroup), formatter: g.hitch(this, this._cellGroupFormatter) }, a.cells.push([d]));
                    d = this.grid;
                    b = E.prototype.rowsPerPage;
                    d.set("rowsPerPage",
                        this._rows > b ? this._rows : b);
                    d.set("structure", a)
                },
                _setGridData: function() {
                    var a = [];
                    if (this.grouping) {
                        this._groupRowIndices = [];
                        var b, d, e = this._columns;
                        c.forEach(this._flItems, function(c, f) {
                            a.push({});
                            f = 0 === f ? 0 : b + d + 1;
                            this._groupRowIndices.push(f);
                            b = f;
                            d = Math.ceil(c.length / e);
                            a = a.concat(this._getStoreItems(c))
                        }, this)
                    } else this.featureLayers ? (c.forEach(this._flItems, function(b) { a = a.concat(b) }), a = this._getStoreItems(a)) : a = this._getStoreItems(this._itItems);
                    var f = new B({ data: { items: a } });
                    this.grid.setStore(f)
                },
                _toggleTooltip: function() {
                    if (this.showTooltip) {
                        if (!this.tooltip) {
                            this.tooltip = r.create("div", { "class": "esriMapTooltip" }, this.domNode);
                            this.tooltip.style.display = "none";
                            this.tooltip.style.position = "fixed";
                            var a = this.grid;
                            this._mouseOverConnect = n.connect(a, "onCellMouseOver", this, this._cellMouseOver);
                            this._mouseOutConnect = n.connect(a, "onCellMouseOut", this, this._cellMouseOut)
                        }
                    } else this.tooltip && (n.disconnect(this._mouseOverConnect), n.disconnect(this._mouseOutConnect), r.destroy(this.tooltip), this.tooltip =
                        null)
                },
                _rowClicked: function(a, b) {
                    var c = a.cellNode,
                        d = a.rowIndex;
                    a = a.cellIndex;
                    var e = this._getCellInfo(c, d, a);
                    if (e) {
                        var f = this.grid.store;
                        if (!f.getValue(e, "loadingCell") && (this._selectedCell && p.remove(this._selectedCell, "selectedItem"), c !== this._selectedCell ? (p.add(c, "selectedItem"), this._selectedCell = c, this._selectedItem = { featureLayer: f.getValue(e, "layer"), type: f.getValue(e, "type"), template: f.getValue(e, "template"), symbolInfo: f.getValue(e, "symbolInfo"), item: this._getItem(e) }, this._selectedInfo = {
                                selRow: d,
                                selCol: a,
                                index1: f.getValue(e, "index1"),
                                index2: f.getValue(e, "index2"),
                                index: f.getValue(e, "index")
                            }) : this._selectedCell = this._selectedInfo = this._selectedItem = null, !b)) this.onSelectionChange()
                    }
                },
                _locate: function(a, b, d) {
                    var e = this.grid.store,
                        f = Array(this._columns),
                        g, h = b.index1,
                        m = b.index2,
                        n = b.index,
                        p = a.item;
                    c.some(d, function(a, b) { return c.some(f, function(c, d) { return (c = e.getValue(a, "cell" + d)) && (p ? n === e.getValue(c, "index") : h === e.getValue(c, "index1") && m === e.getValue(c, "index2")) ? (g = [b, d], !0) : !1 }) });
                    return g
                },
                _getCellInfo: function(a, b, c) { if (a) return a = this.grid, b = a.getItem(b), a.store.getValue(b, "cell" + c) },
                _getItem: function(a) { var b = this.items; if (b) return b[this.grid.store.getValue(a, "index")] },
                _cellMouseOver: function(b) {
                    var c = this.tooltip,
                        d = b.cellNode,
                        e = this._getCellInfo(d, b.rowIndex, b.cellIndex);
                    if (c && e) {
                        var f = this.grid.store;
                        b = f.getValue(e, "template");
                        var g = f.getValue(e, "type"),
                            h = f.getValue(e, "symbolInfo"),
                            f = f.getValue(e, "layer");
                        b = (e = this._getItem(e)) && e.label + (e.description ? ": " + e.description : "") ||
                            b && b.name + (b.description ? ": " + b.description : "") || g && g.name || h && h.label + (h.description ? ": " + h.description : "") || (f && f.name + ": ") + "Default";
                        c.style.display = "none";
                        c.innerHTML = b;
                        d = a.coords(d.firstChild);
                        w.set(c, { left: d.x + "px", top: d.y + d.h + 5 + "px" });
                        c.style.display = ""
                    }
                },
                _cellMouseOut: function() {
                    var a = this.tooltip;
                    a && (a.style.display = "none")
                },
                _destroyItems: function() {
                    var a = this._itemWidgets,
                        b;
                    for (b in a) a[b] && (a[b].destroy(), delete a[b])
                },
                _repaintItems: function() {
                    var a = this._itemWidgets,
                        b;
                    for (b in a) {
                        var c =
                            a[b];
                        c && c._repaint(c._surface)
                    }
                },
                _getStoreItems: function(a) {
                    var b = this._uniqueId;
                    a = c.map(a, function(a) { return g.mixin({ surfaceId: "tpick-surface-" + b.id++ }, a) });
                    for (var d = a.length, e = 0, f = {}, h = 0, m, n = [], p = !0, r = this._columns; e < d;) p = !0, m = "cell" + h, f[m] = a[e], e++, h++, 0 === h % r && (p = !1, n.push(f), f = {}, h = 0);
                    p && d && n.push(f);
                    return n
                },
                _getItemsFromLayers: function(a) {
                    var b = [];
                    c.forEach(a, function(a, c) { b.push(this._getItemsFromLayer(a, c)) }, this);
                    return b
                },
                _getItemsFromLayer: function(a, b) {
                    var e = [];
                    if (this.useLegend &&
                        -1 < c.indexOf(this._loadingIndices, b)) return [{ label: this._nls && this._nls.loading || "", symbol: null, layer: a, type: null, template: null, index1: b, index2: 0, loadingCell: 1 }];
                    var f = [],
                        f = f.concat(a.templates);
                    c.forEach(a.types, function(a) {
                        var b = a.templates;
                        c.forEach(b, function(b) { b._type_ = a });
                        f = f.concat(b)
                    });
                    var f = c.filter(f, K.isDefined),
                        h = a.renderer;
                    if (h) {
                        var n = h.declaredClass.replace("esri.renderer.", "");
                        if (0 < f.length) c.forEach(f, function(f) {
                            var g = f.prototype;
                            if (g) {
                                var q;
                                if (q = this._isUnclassedRenderer(h) ? h.infos[0].symbol :
                                    h.valueExpression ? this._createSimpleSymbol(a) : h.getSymbol(g) || this._createSimpleSymbol(a)) {
                                    var p = null,
                                        u;
                                    if (!(9 > m("ie")) && f.thumbnail && f.thumbnail.imageData) p = new A(f.thumbnail);
                                    else if (this.useLegend && -1 < c.indexOf(this._legendIndices, b)) {
                                        if (u = this._legendSymbols && this._legendSymbols[b]) switch (n) {
                                            case "SimpleRenderer":
                                                p = u.defaultSymbol;
                                                break;
                                            case "UniqueValueRenderer":
                                                c.some(h.infos, function(a) { a.symbol === q && (p = u[a.value]); return !!p });
                                                break;
                                            case "ClassBreaksRenderer":
                                                c.some(h.infos, function(a) {
                                                    a.symbol ===
                                                        q && (p = u[a.maxValue]);
                                                    return !!p
                                                })
                                        }
                                        p && (g = d.fromJson(d.toJson(A.defaultProps)), g.url = p.url, g.imageData = p.imageData, g.contentType = p.contentType, g.width = p.width, g.height = p.height, K.isDefined(g.width) && K.isDefined(g.height) || (g.width = 15, g.height = 15), p = new A(g))
                                    }
                                    e.push({ label: this._trimLabel(f.name), symbol: p || q, legendOverride: !!p, layer: a, type: f._type_, template: f, index1: b, index2: e.length })
                                } else switch (n) {
                                    case "HeatmapRenderer":
                                        e.push({
                                            label: this._trimLabel(f.name),
                                            symbol: new D,
                                            legendOverride: !!p,
                                            layer: a,
                                            type: f._type_,
                                            template: f,
                                            index1: b,
                                            index2: e.length
                                        })
                                }
                            }
                            delete f._type_
                        }, this);
                        else {
                            var q = [];
                            "TemporalRenderer" === n && (h = h.observationRenderer) && (n = h.declaredClass.replace("esri.renderer.", ""));
                            switch (n) {
                                case "SimpleRenderer":
                                    q = [{ symbol: h.symbol, label: h.label, description: h.description }];
                                    break;
                                case "UniqueValueRenderer":
                                case "ClassBreaksRenderer":
                                    q = h.infos
                            }
                            e = c.map(q, function(c, d) {
                                return {
                                    label: this._trimLabel(c.label),
                                    description: c.description,
                                    symbolInfo: g.mixin({ constructor: function() {} }, c),
                                    symbol: c.symbol,
                                    layer: a,
                                    index1: b,
                                    index2: d
                                }
                            }, this)
                        }
                    }
                    return e
                },
                _isUnclassedRenderer: function(a) { return !!((a.hasVisualVariables("sizeInfo", !1) || a.hasVisualVariables("colorInfo", !1) || a.hasVisualVariables("opacityInfo", !1)) && a.addBreak && a.infos && 1 === a.infos.length) },
                _createSimpleSymbol: function(a) {
                    var b;
                    switch (a.geometryType) {
                        case "esriGeometryPoint":
                        case "esriGeometryMultipoint":
                            b = new D;
                            break;
                        case "esriGeometryPolyline":
                            b = new J;
                            break;
                        case "esriGeometryPolygon":
                            b = new H;
                            break;
                        default:
                            a.hasXYFootprint && a.hasXYFootprint() &&
                                (b = new H)
                    }
                    return b
                },
                _getItemsFromItems: function(a) {
                    return c.map(a, function(a, b) {
                        a = g.mixin({ index: b }, a);
                        a.label = this._trimLabel(a.label);
                        return a
                    }, this)
                },
                _trimLabel: function(a) {
                    var b = this.maxLabelLength;
                    b && a && a.length > b && (a = a.substr(0, b) + "...");
                    return a || ""
                },
                _cellGet: function(a, b, c) { return c ? this.grid.store.getValue(c, "cell" + a) : "" },
                _cellFormatter: function(a) {
                    if (a) {
                        var b = this._itemWidgets,
                            c = this.grid.store,
                            d = c.getValue(a, "surfaceId"),
                            e = b[d];
                        e || (e = b[d] = new L({
                            id: d,
                            label: c.getValue(a, "label"),
                            symbol: c.getValue(a,
                                "symbol"),
                            legendOverride: c.getValue(a, "legendOverride"),
                            surfaceWidth: this.surfaceWidth,
                            surfaceHeight: this.surfaceHeight,
                            template: c.getValue(a, "template")
                        }));
                        return e || ""
                    }
                    return ""
                },
                _cellGetGroup: function(a, b) {
                    if (!this._groupRowIndices) return "";
                    a = c.indexOf(this._groupRowIndices, a);
                    return b && -1 !== a ? (b = this.featureLayers[a]) && (this.groupLabelFunction ? this.groupLabelFunction(b) : b.name) || "" : ""
                },
                _cellGroupFormatter: function(a) { return a ? "\x3cdiv class\x3d'groupLabel'\x3e" + a + "\x3c/div\x3e" : "" }
            });
            g.setObject("dijit.editing.TemplatePicker",
                W, M);
            return W
        })
}, "esri/dijit/editing/TemplatePickerItem": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/sniff dojo/dom-style dijit/_Widget dijit/_Templated dojox/gfx ../../symbols/jsonUtils ../../kernel".split(" "), function(b, g, n, a, c, d, f, e, h, m, p) {
        b = b([f, e], {
            declaredClass: "esri.dijit.editing.TemplatePickerItem",
            templateString: "\x3cdiv class\x3d'item' style\x3d'text-align: center;'\x3e\x3cdiv class\x3d'itemSymbol' dojoAttachPoint\x3d'_surfaceNode'\x3e\x3c/div\x3e\x3cdiv class\x3d'itemLabel'\x3e${label}\x3c/div\x3e\x3c/div\x3e",
            startup: function() { this._started || (this.inherited(arguments), this._surface = this._draw(this._surfaceNode, this.symbol, this.surfaceWidth, this.surfaceHeight, this.template)) },
            _draw: function(b, c, e, f, n) {
                if (c && "textsymbol" !== c.type) {
                    b = h.createSurface(b, e, f);
                    if (9 > a("ie")) {
                        var p = b.getEventSource();
                        d.set(p, "position", "relative");
                        d.set(p.parentNode, "position", "relative")
                    }
                    c = !this.legendOverride && this._getDrawingToolShape(c, n) || m.getShapeDescriptors(c);
                    var r;
                    try { r = b.createShape(c.defaultShape).setFill(c.fill).setStroke(c.stroke) } catch (D) {
                        b.clear();
                        b.destroy();
                        return
                    }
                    var t = r.getBoundingBox();
                    c = t.width;
                    n = t.height;
                    var p = -(t.x + c / 2),
                        t = -(t.y + n / 2),
                        v = b.getDimensions(),
                        p = { dx: p + v.width / 2, dy: t + v.height / 2 };
                    if (c > e || n > f) t = c / e > n / f, e = ((t ? e : f) - 5) / (t ? c : n), g.mixin(p, { xx: e, yy: e });
                    r.applyTransform(p);
                    return b
                }
            },
            _getDrawingToolShape: function(a, b) {
                switch (b ? b.drawingTool || null : null) {
                    case "esriFeatureEditToolArrow":
                        b = { type: "path", path: "M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E" };
                        break;
                    case "esriFeatureEditToolLeftArrow":
                        b = { type: "path", path: "M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E" };
                        break;
                    case "esriFeatureEditToolRightArrow":
                        b = { type: "path", path: "M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E" };
                        break;
                    case "esriFeatureEditToolUpArrow":
                        b = { type: "path", path: "M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E" };
                        break;
                    case "esriFeatureEditToolDownArrow":
                        b = { type: "path", path: "M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E" };
                        break;
                    case "esriFeatureEditToolTriangle":
                        b = { type: "path", path: "M -10,14 L 2,-10 L 14,14 L -10,14 E" };
                        break;
                    case "esriFeatureEditToolRectangle":
                        b = { type: "path", path: "M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E" };
                        break;
                    case "esriFeatureEditToolCircle":
                        b = { type: "circle", cx: 0, cy: 0, r: 10 };
                        break;
                    case "esriFeatureEditToolEllipse":
                        b = { type: "ellipse", cx: 0, cy: 0, rx: 10, ry: 5 };
                        break;
                    case "esriFeatureEditToolFreehand":
                        b = "simplelinesymbol" === a.type || "cartographiclinesymbol" === a.type ? { type: "path", path: "m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5" } : { type: "path", path: "M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z" };
                        break;
                    default:
                        return null
                }
                return { defaultShape: b, fill: a.getFill(), stroke: a.getStroke() }
            },
            _repaint: function(a) { a ? (a.getStroke && a.setStroke && a.setStroke(a.getStroke()), a.getFill && a.setFill && a.setFill(a.getFill()), a.children && g.isArray(a.children) && n.forEach(a.children, this._repaint, this)) : this._surface = this._draw(this._surfaceNode, this.symbol, this.surfaceWidth, this.surfaceHeight, this.template) },
            destroy: function() {
                this._surface && (this._surface.destroy(), delete this._surface);
                this.inherited(arguments)
            }
        });
        g.setObject("dijit.editing.TemplatePickerItem", b, p);
        return b
    })
}, "esri/dijit/SymbolStyler/symbolUtil": function() {
    define("../../symbol ../../symbols/utils dojo/Deferred dojo/dom-construct dojo/on dojox/gfx".split(" "), function(b, g, n, a, c, d) {
        var f = {
            _pureOutlineStyles: "x,cross",
            isPoint: function(a) { return f.isType(a, "marker") },
            isType: function(a, b) { return a && -1 < a.type.indexOf(b + "symbol") },
            isLine: function(a) { return f.isType(a, "line") },
            isPolygon: function(a) { return f.isType(a, "fill") },
            hasPureOutlineStyle: function(a) {
                return a &&
                    -1 < f._pureOutlineStyles.indexOf(a.style)
            },
            getOutline: function(a) { return "simplelinesymbol" === a.type || "cartographiclinesymbol" === a.type ? a : a.outline },
            cloneSymbol: function(a) { return b.jsonUtils.fromJson(a.toJson()) },
            setOutlineWidth: function(a, b) { a = a && f.getOutline(a);!isNaN(b) && a && a.setWidth(b) },
            setOutlineStyle: function(a, c) {
                a = a && f.getOutline(a);
                c && a && (c = a.color ? c : b.SimpleLineSymbol.STYLE_NULL, a.setStyle(c))
            },
            setLineMarker: function(a, b) {
                (a = f.getOutline(a)) && a.setMarker(b)
            },
            setSize: function(a, b) {
                if (a &&
                    !isNaN(b)) {
                    var c = a.width,
                        d;
                    c != b && ("picturemarkersymbol" === a.type ? (d = a.url, b = f.preserveAspectRatio({ dimensions: a, targetDimension: "width", targetSize: b }), a.setHeight(b.height), a.setWidth(b.width), !d || "http://" === d || -1 === d.indexOf("http://") && -1 === d.indexOf("data:") || !a.xoffset && !a.yoffset || (b = a.width, c = b / c, a.setOffset(Math.round(a.xoffset * c), Math.round(a.yoffset * c)))) : a.setSize(b))
                }
            },
            getMarkerLength: function(a) { return isNaN(a.width) ? a.size : a.width },
            hasColor: function(a) { return a && a.color },
            setFillColor: function(a,
                b) { a.setColor(b) },
            setOutlineColor: function(a, b) {
                (a = f.getOutline(a)) && a.setColor(b)
            },
            renderOnSurface: function(a, c) {
                if (a) {
                    var e = 80,
                        h = 30,
                        n = f.isLine(a),
                        v = a.outline ? 1.5 * a.outline.width : 1;
                    if (n) e = 250, h = a.marker ? 5.5 * a.width : a.width;
                    else if ("simplemarkersymbol" === a.type) h = e = a.size;
                    else if ("picturemarkersymbol" === a.type) {
                        if (!a.url || "http://" === a.url || -1 === a.url.indexOf("http://") && -1 === a.url.indexOf("https://") && -1 === a.url.indexOf("data:")) return;
                        e = a.width;
                        h = a.height
                    }
                    e += v;
                    h += v;
                    c = d.createSurface(c, e, h);
                    v = b.jsonUtils.getShapeDescriptors(a);
                    n && (v.defaultShape.path = "M -90,0 L 90,0 E");
                    v = c.createShape(v.defaultShape).setFill(v.fill).setStroke(v.stroke);
                    n && g.applyLineMarker(v, a, null, this._acquireSVGMarker);
                    v.applyTransform({ dx: .5 * e, dy: .5 * h });
                    return c
                }
            },
            _acquireSVGMarker: function(a, b, c, d) {
                b = g.createSVGMarker(b, "symbol-util__marker--" + d, c, d);
                a.getParent().defNode.appendChild(b);
                return b
            },
            preserveAspectRatio: function(a) {
                var b = a.dimensions,
                    c = a.targetSize;
                return "height" === ("height" === a.targetDimension ? "height" : "width") ? {
                    height: c,
                    width: b.width /
                        b.height * c
                } : { height: b.height / b.width * c, width: c }
            },
            toLineMarker: function(a) { return a && "none" !== a ? { style: "arrow", placement: a } : null },
            testImageUrl: function(b) {
                var d = new n,
                    e = a.create("img"),
                    f, g;
                f = c(e, "load", function() { 0 === e.width && 0 === e.height ? d.reject(Error("image has both width and height of 0")) : d.resolve({ width: e.width, height: e.height }) });
                g = c(e, "error", function() { d.reject(Error("could not load image")) });
                e.src = b;
                d.promise.always(function() {
                    f.remove();
                    g.remove();
                    a.destroy(e)
                });
                return d.promise
            }
        };
        return f
    })
},
"esri/dijit/SymbolStyler/schemeUtil": function() {
    define(["../../Color", "../../styles/relationship", "dojo/_base/array", "dojo/_base/lang"], function(b, g, n, a) {
        var c = {
            getColorRamps: function(a, b) { a = c.getColorRampsWithSchemes(a, b); return n.map(a, function(a) { return a.colors }) },
            getColorRampsWithSchemes: function(a, b) {
                a = c._unify(a);
                var d = [];
                n.forEach(a, function(a) {
                    var e = !!a.colorsForClassBreaks,
                        e = 0 < b && e ? c._getClassBreaksColors(a, b) : a.colors;
                    d.push({ colors: c._createColors(e), scheme: a })
                });
                return d
            },
            _getClassBreaksColors: function(a,
                b) { return c.is2DScheme(a) ? g.getColors(a, b) : c._maxSupportedClassBreakColors(a.colorsForClassBreaks, b) },
            _unify: function(a) { return [a.primaryScheme].concat(a.secondarySchemes) },
            is2DScheme: function(a) { return !!(a && a.colorsForClassBreaks && a.colorsForClassBreaks[0] && a.colorsForClassBreaks[0].colors && Array.isArray(a.colorsForClassBreaks[0].colors[0])) },
            _maxSupportedClassBreakColors: function(a, b) {
                for (var c, d = a.length, f, g = 0; g < d; g++) {
                    f = a[g];
                    if (b < f.numClasses) break;
                    c = f.colors
                }
                return c
            },
            getColorsForClassBreaks: function(a,
                b) { var d = a.colorsForClassBreaks; return d && c.is2DScheme(a) ? g.getColors(a, b) : c._maxSupportedClassBreakColors(d, b) },
            getFillColors: function(a) {
                a = c._unify(a);
                var b = [],
                    d;
                n.forEach(a, function(a) {
                    d = a.marker || a;
                    d.colors ? b = b.concat(d.colors) : b.push(d.color)
                });
                return c._removeDuplicates(b)
            },
            _removeDuplicates: function(a) {
                var b = {},
                    c;
                return n.filter(a, function(a) {
                    (c = !b[a.toHex()]) && (b[a.toHex()] = 1);
                    return c
                })
            },
            getOutlineColors: function(a) {
                a = c._unify(a);
                var b = [],
                    d;
                n.forEach(a, function(a) {
                    d = a.marker || a;
                    d.outline ?
                        b.push(d.outline.color) : d.colors ? b = b.concat(d.colors) : d.color && b.push(d.color)
                });
                return c._removeDuplicates(b)
            },
            flipColors: function(a) { a && (a.colors && a.colors.reverse(), c.is2DScheme(a) ? g.flipColors(a, !0) : a.colorsForClassBreaks && n.forEach(a.colorsForClassBreaks, function(a) { 1 < a.numClasses && a.colors.reverse() })) },
            cloneScheme: function(d) {
                var f, e;
                d && (f = a.mixin({}, d), e = c.is2DScheme(d), f.colors && (f.colors = c._createColors(f.colors)), f.colorsForClassBreaks && (f.colorsForClassBreaks = n.map(f.colorsForClassBreaks,
                    function(a) { return { numClasses: a.numClasses, colors: e ? a.colors.map(function(a) { return c._createColors(a) }) : c._createColors(a.colors) } })), f.noDataColor && (f.noDataColor = new b(f.noDataColor)), f.outline && (f.outline = { color: f.outline.color && new b(f.outline.color), width: f.outline.width }));
                return f
            },
            _createColors: function(a, c) {
                return n.map(a, function(a) {
                    a = new b(a);
                    null != c && (a.a = c);
                    return a
                })
            }
        };
        return c
    })
}, "esri/dijit/SymbolStyler/stylerUtil": function() {
    define(["dijit/popup", "dojo/number"], function(b, g) {
        return {
            bindSliderAndTextBox: function(b,
                a) {
                b.on("change", function(b) { a.set("value", b, !1) });
                a.on("change", function(a) {
                    var c, f;
                    "string" === typeof a && (a = g.parse(a));
                    isNaN(a) ? this.set("value", b.get("value"), !1) : (c = this.get("constraints"), f = c.min, c = c.max, a = a > c ? c : a < f ? f : a, this.set("value", a, !1), b.set("value", a, !1))
                })
            },
            silentlyUpdateIntermediateChangingValueWidget: function(b, a) {
                b.intermediateChanges = !1;
                b.set("value", a, !1);
                b.intermediateChanges = !0
            },
            ensureEnabledChildSelection: function(b) {
                var a, c;
                if ((b.selectedChildWidget || {}).disabled) {
                    a = b.getChildren();
                    c = a.length;
                    for (var d = 0; d < c; d++)
                        if (!a[d].disabled) { b.selectChild(a[d]); break }
                }
            },
            enable: function(b) { b.set("disabled", !1) },
            disable: function(b) { b.set("disabled", !0) },
            popUp: function(g, a) {
                var c, d;
                c = g.on("styling-commit", function() {
                    c.remove();
                    d.remove();
                    b.close(g)
                });
                d = g.on("styling-stop", function() {
                    c.remove();
                    d.remove();
                    b.close(g)
                });
                b.open({ popup: g, around: a, orient: ["above"] })
            }
        }
    })
}, "esri/dijit/SymbolStyler/ColorRampPicker": function() {
    define("../../kernel ../_EventedWidget ../_Tooltip ./_DelayedUpdate ./colorRampUtil ./schemeUtil ./stylerUtil dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style dojo/has dojo/on dojo/query dojo/i18n!../../nls/jsapi dojo/text!./templates/ColorRampPicker.html dojo/NodeList-dom dijit/form/Button esri/dijit/HorizontalSlider".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D) {
            g = r("esri.dijit.SymbolStyler.ColorRampPicker", [g, e, h, a, n], {
                baseClass: "esriColorRampPicker",
                templateString: D,
                labels: F.widgets.symbolEditor,
                css: { item: "esriItem", label: "esriLabel", selected: "esriSelected", container: "esriContainer", list: "esriList", preview: "esriPreview", flipper: "esriFlipper", viewport: "esriViewport", transparencySection: "esriColorRampPickerTransparencySection" },
                schemes: null,
                selected: null,
                numStops: 0,
                _schemesChanged: !1,
                _selectedChanged: !1,
                _numStopsChanged: !1,
                _orientationChanged: !1,
                _transparencyChanged: !1,
                _commitPropsTrigger: null,
                _colorRampSurfaces: null,
                _previewRampSurface: null,
                _rampsAndSchemes: null,
                _transparency: null,
                _transparencyLabels: function() { return "[" + [0, 50, 100].map(function(a) { return v.replace(F.widgets.colorPicker.percent, { percent: a }) }).map(function(a) { return "'" + a + "'" }) + "]" }(),
                constructor: function(a) {
                    this._colorRampSurfaces = [];
                    this._commitPropsTrigger = this.createUpdateTrigger(this._commitProperties, this)
                },
                _commitProperties: function() {
                    var a = !1,
                        b = !1;
                    if (this._schemesChanged || this._numStopsChanged) this._numStopsChanged = this._schemesChanged = !1, this._rampsAndSchemes = a = d.getColorRampsWithSchemes(this.schemes, this.numStops), a = !0;
                    if (this._transparencyChanged) {
                        this._transparencyChanged = !1;
                        var c = 1 - this._transparency;
                        p.forEach(this.selected.colors, function(a) { a.a = c });
                        b = !0
                    }
                    this._selectedChanged && (this._selectedChanged = !1, b = !0);
                    this._orientationChanged && (this._orientationChanged = !1, a = b = !0);
                    this.selected || this.set("selected", this._rampsAndSchemes[0]);
                    b && this._renderSelected();
                    a && this._renderSuggestions()
                },
                _renderSuggestions: function() {
                    var a = this._rampsAndSchemes,
                        b = this._colorRampSurfaces,
                        d = this.dap_colorRampPicker;
                    t.empty(d);
                    b.forEach(function(a) { a.destroy() });
                    this._colorRampSurfaces = p.map(a, function(a) { var b = t.create("div", { className: this.css.item, tabIndex: 0 }, d); return c.create({ node: b, colors: a.colors, numClasses: this.numStops, style: "ramp" }) }, this)
                },
                _renderSelected: function() {
                    var a = this.selected.colors,
                        b = this.dap_previewRamp,
                        e = d.is2DScheme(this.selected.scheme);
                    this._previewRampSurface && (this._previewRampSurface.destroy(), this._previewRampSurface = null, t.empty(b));
                    w.toggle(b, "esriGrid", e);
                    this._previewRampSurface = c.create({ node: b, colors: a, numClasses: this.numStops, height: e ? void 0 : 180, style: e ? "grid" : "ramp" });
                    this.findTooltip(this.dap_colorFlipper).label = e ? this.labels.rotateColorsTooltip : this.labels.flipColorsTooltip
                },
                getStyle: function() { return this.get("selected") },
                _setSchemesAttr: function(a) {
                    this._schemesChanged = !0;
                    this._set("schemes", d.cloneScheme(a));
                    this._commitPropsTrigger()
                },
                _getSelectedAttr: function() {
                    var a = this.selected,
                        b = { colors: d._createColors(a.colors) };
                    a.scheme && (b.scheme = d.cloneScheme(a.scheme));
                    return b
                },
                _setSelectedAttr: function(a) {
                    v.isArray(a) && (a = { colors: a });
                    var b = this._hasSameColors(a.colors);
                    this._transparency = null === this._transparency ? b ? 0 : 1 - a.colors[a.colors.length - 1].a : this._transparency;
                    f.silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider, this._transparency);
                    this._transparencyChanged = !b;
                    this.dap_transparencySlider.set("disabled",
                        b, !1);
                    this._selectedChanged = !0;
                    this._set("selected", a);
                    this._commitPropsTrigger();
                    this.emit("color-ramp-change", this.get("selected"))
                },
                _hasSameColors: function(a) {
                    var b = a[0];
                    return p.every(a, function(a) {
                        var c = a.r === b.r && a.g === b.g && a.b === b.b;
                        b = a;
                        return c
                    })
                },
                _setNumStopsAttr: function(a) {
                    this._numStopsChanged = !0;
                    this._set("numStops", 0 < a ? a : 0);
                    this._commitPropsTrigger()
                },
                postCreate: function() {
                    this.inherited(arguments);
                    this._addHandlers();
                    this.createTooltips([{ node: this.dap_colorFlipper, label: this.labels.flipColorsTooltip },
                        { node: this.dap_colorRampPicker, label: this.labels.selectRampTooltip }
                    ])
                },
                _addHandlers: function() {
                    this.own(E(this.dap_colorRampPicker, E.selector("." + this.css.item, m), v.partial(this._rampClickHandler, this)), E(this.dap_colorFlipper, m, v.hitch(this, function() { this.flipColors() })), E(this.dap_transparencySlider, "change", v.hitch(this, function() {
                        this._transparency = this.dap_transparencySlider.get("value");
                        this._transparencyChanged = !0;
                        this._commitPropsTrigger()
                    })))
                },
                _rampClickHandler: function(a) {
                    var b = a.css.selected,
                        c = "." + a.css.item,
                        d = G("." + a.css.item, a.dap_colorRampPicker).indexOf(this);
                    G(c, a.dap_colorRampPicker).removeClass(b);
                    w.add(this, b);
                    a.set("selected", a._rampsAndSchemes[d])
                },
                flipColors: function() {
                    var a = this._rampsAndSchemes,
                        b = this.selected;
                    p.forEach(a, function(a) { d.flipColors(a.scheme) }); - 1 === a.map(function(a) { return a.scheme }).indexOf(b.scheme) && d.flipColors(b.scheme);
                    d.is2DScheme(b.scheme) ? b.colors = d.getColorsForClassBreaks(b.scheme, this.numStops) : b.colors.reverse();
                    this._schemesChanged = this._orientationChanged = !0;
                    this.set("selected", b);
                    this._commitPropsTrigger()
                },
                destroy: function() {
                    this.inherited(arguments);
                    p.forEach(this._colorRampSurfaces, function(a) { a.destroy() });
                    this._previewRampSurface && this._previewRampSurface.destroy()
                }
            });
            v.setObject("dijit.SymbolStyler.ColorRampPicker", g, b);
            return g
        })
}, "esri/dijit/SymbolStyler/colorRampUtil": function() {
    define(["../../symbols/utils", "dojo/_base/array", "dojox/gfx"], function(b, g, n) {
        var a = {
            create: function(b) {
                var c = b.colors,
                    f = b.node,
                    e = b.numClasses,
                    g = b.height || 70,
                    m = b.width ||
                    20,
                    n = b.size || 40;
                return "grid" === (b.style || "ramp") ? a._create2DColorRamp({ node: f, size: n, colors: c, numClasses: e }) : a._createColorRamp({ node: f, height: g, width: m, colors: c, numClasses: e })
            },
            _createColorRamp: function(b) {
                var c = b.node,
                    f = b.width,
                    e = b.height;
                b = a._stopsFromColors(b);
                c = n.createSurface(c, f, e);
                return c = c.createRect(c.getDimensions()).setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: e, colors: b })
            },
            _create2DColorRamp: function(c) {
                var d = c.size,
                    f = c.colors,
                    e = c.numClasses;
                c = n.createSurface(c.node, d, d);
                return c = b.create2DColorRamp({
                    surface: c,
                    colors: a._to2DArray(f, e),
                    numClasses: e,
                    size: d
                })
            },
            _to2DArray: function(a, b) {
                for (var c = [], d = 0; d < b; d++) {
                    for (var g = [], m = 0; m < b; m++) g.push(a[d * b + m]);
                    c.push(g.reverse())
                }
                return c
            },
            _stopsFromColors: function(a) {
                var b = a.colors;
                a = 0 < a.numClasses;
                var c = b.length,
                    e = a ? 1 / c : 1 / (c - 1),
                    g = [],
                    m = b[0],
                    n;
                if ("object" === typeof m && m.hasOwnProperty("offset") && m.hasOwnProperty("color")) return b;
                for (var r = 0; r < c; r++) n = r * e, m = b[c - 1 - r], g.push({ offset: n, color: m }), a && (n = (r + 1) * e, g.push({ offset: n, color: m }));
                return g
            }
        };
        return a
    })
}, "arcgisonline/map/dijit/renderer/_UniqueValuesMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/Deferred dojo/dom dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/styles/type esri/renderers/smartMapping esri/tasks/query esri/tasks/QueryTask esri/tasks/UniqueValueDefinition esri/tasks/GenerateRendererParameters esri/tasks/GenerateRendererTask esri/tasks/StatisticDefinition esri/renderers/UniqueValueRenderer esri/dijit/OpacitySlider".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F) {
            return {
                allUniqueValues: null,
                maxCount: 200,
                defaultColors: "#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" "),
                buildUniqueRenderer: function(a) {
                    var b = new c;
                    setTimeout(function() { b.progress(b) }, 1);
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildUniqueRendererGo(!1, a, b);
                    else {
                        var d = this.getFieldForUniqueRenderer();
                        "esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass && this.renderer.attributeField ||
                            !this.hasAttributeCustomExpression(d) ? this.isOwnerOfHostedFS ? (d = this.layer.getEditCapabilities(), !this.layer.isEditable() || !d.canCreate && (d.canUpdate || d.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildUniqueRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildUniqueRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({
                                title: this.i18n.warning,
                                message: this.i18n.featureTypesAndTemplatesWarning,
                                choiceOneTitle: this.i18n.yesLabel,
                                choiceOneHandler: g.hitch(this, function() { this.buildUniqueRendererGo(!0, a, b) }),
                                choiceTwoTitle: this.i18n.noLabel,
                                choiceTwoHandler: g.hitch(this, function() {!b.isRejected() && b.reject() })
                            })) : (this.buildUniqueRendererGo(!1, a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates)) : this.buildUniqueRendererGo(!1, a, b)
                    }
                    return b
                },
                buildUniqueRendererGo: function(b,
                    c, d) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    this.hasDynamic = arcgisonline.map.main.hasDynamicLayers(this.mapLayer);
                    attributeItem = this.getFieldForUniqueRenderer();
                    var e;
                    this.isMultiAttributesRenderer && "esriGeometryPolygon" === this.geometryType && (e = this.renderer.infos[0].symbol);
                    r.createTypeRenderer({
                        layer: this.fLayer || this.layer,
                        field: this.hasAttributeCustomExpression(attributeItem) ? null : attributeItem.name,
                        valueExpression: this.hasAttributeCustomExpression(attributeItem) ? attributeItem.valueExpression : null,
                        valueExpressionTitle: attributeItem.valueExpressionTitle,
                        theme: "default",
                        basemap: this.getBasemapType(),
                        scheme: this.scheme,
                        numTypes: 10,
                        showOthers: !0,
                        optimizeOutline: !0,
                        includeAllCodedValues: !0,
                        sortBy: "count"
                    }).then(g.hitch(this, function(c) {
                            if (!d.isRejected()) {
                                this.scheme = c.scheme;
                                this.onCalculationsSource && this.onCalculationsSource({ partialData: c.partialData });
                                b && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                                if (this.isMultiAttributesRenderer) {
                                    var f =
                                        this.getVisualVariablesExceptTypes(["colorInfo"], this.renderer.visualVariables);
                                    f && c.renderer.setVisualVariables(f);
                                    c.renderer.backgroundFillSymbol = this.renderer.backgroundFillSymbol;
                                    if ("esriGeometryPolygon" === this.geometryType) {
                                        var m = [];
                                        a.forEach(c.renderer.infos, function(a) { m.push(g.clone(a)) });
                                        a.forEach(m, function(a) { c.renderer.removeValue(a.value) });
                                        a.forEach(m, function(a) {
                                            var b = h.fromJson(e.toJson());
                                            c.renderer.addValue({
                                                value: a.value,
                                                symbol: this.convertFillToMarkerSymbol(a.symbol, b.style, b.outline),
                                                label: a.label
                                            })
                                        }, this);
                                        a.forEach(c.uniqueValueInfos, function(a) {
                                            var b = h.fromJson(e.toJson());
                                            a.symbol = this.convertFillToMarkerSymbol(a.symbol, b.style, b.outline)
                                        }, this)
                                    }
                                } else delete this.authoringInfo;
                                this.allUniqueValues = c.uniqueValueInfos;
                                this.allUniqueValuesPartialData = c.partialData; - 1 === c.othersStartIndex && this.allUniqueValues.length && (this.defaultInfo = { defaultSymbol: c.renderer.defaultSymbol, defaultLabel: c.renderer.defaultLabel }, delete c.renderer.defaultSymbol, delete c.renderer.defaultLabel);
                                d.resolve(c.renderer)
                            }
                        }),
                        g.hitch(this, function(a) { d.isRejected() || (this.handleError(a, "createTypeRenderer", !0), d.reject()) }))
                },
                applyUniqueRenderer: function(a) {
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    !this.hasDynamic && b !== this.getRendererStyle(a) && this.scheme && e.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) ||
                        this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.types.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                updateUniqueRenderer: function(b) {
                    if (e.isDefined(b) && "esriGeometryPolygon" === this.geometryType)
                        if (b) {
                            var c = [];
                            a.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                            a.forEach(c, function(a) { this.renderer.removeValue(a.value) }, this);
                            a.forEach(c, function(a) {
                                this.renderer.addValue({
                                    value: a.value,
                                    symbol: this.setOutlineWidthOfSymbol(a.symbol, 1),
                                    label: a.label
                                })
                            }, this);
                            this.portalPanel.lastUniqueDefaultSymbol = this.setOutlineWidthOfSymbol(this.portalPanel.lastUniqueDefaultSymbol, 1);
                            this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol, 1));
                            this.defaultInfo && this.defaultInfo.defaultSymbol && (this.defaultInfo.defaultSymbol = this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, 1));
                            this.getSuggestedOutline().then(g.hitch(this, function(a) {
                                this.replaceVisualVariable("sizeInfo",
                                    "outline", a.widthInfo, this.renderer);
                                this.applyUniqueRenderer(this.renderer)
                            }), g.hitch(this, function(a) {
                                a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables);
                                this.renderer.setVisualVariables(a);
                                this.applyUniqueRenderer(this.renderer)
                            }))
                        } else b = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), this.renderer.setVisualVariables(b), this.applyUniqueRenderer(this.renderer);
                    else this.applyUniqueRenderer(this.renderer)
                },
                ungroupUniqueValues: function() {
                    var b = g.clone(this.allUniqueValues);
                    attributeItem = this.getFieldForUniqueRenderer();
                    var c;
                    c = this.renderer.defaultSymbol && this.renderer.defaultLabel ? h.fromJson(this.renderer.defaultSymbol.toJson()) : this.defaultInfo ? h.fromJson(this.defaultInfo.defaultSymbol.toJson()) : this.getDefaultSymbol(this.geometryType);
                    var d = new G(c, attributeItem.name);
                    if ("customExpr" === attributeItem.name || "customExpr2" === attributeItem.name) d.attributeField = void 0, d.setValueExpression(attributeItem.valueExpression),
                        d.valueExpressionTitle = attributeItem.valueExpressionTitle;
                    d.authoringInfo = dojo.clone(this.renderer.authoringInfo);
                    this.renderer.backgroundFillSymbol && (d.backgroundFillSymbol = this.renderer.backgroundFillSymbol);
                    b.length > this.maxCount ? (b = b.slice(0, this.maxCount), this.renderer.defaultSymbol && this.renderer.defaultLabel || this.layer && this.layer.getFeatureReduction && this.layer.getFeatureReduction() || (d.defaultSymbol = null)) : this.layer && this.layer.getFeatureReduction && this.layer.getFeatureReduction() || (d.defaultSymbol =
                        null);
                    a.forEach(this.renderer.infos, function(c) {
                        d.addValue(c);
                        b = a.filter(b, function(a) { return a.value != c.value })
                    });
                    a.forEach(b, function(a, b) { null !== a.value && d.addValue({ value: a.value, symbol: a.symbol, label: a.label }) }, this);
                    return d
                },
                reorderUniqueValues: function(b, c, d) {
                    attributeItem = this.getFieldForUniqueRenderer();
                    d = this.getDefaultSymbol(this.geometryType);
                    var e = new G(d, attributeItem.name);
                    if ("customExpr" === attributeItem.name || "customExpr2" === attributeItem.name) e.attributeField = void 0, e.setValueExpression(attributeItem.valueExpression),
                        e.valueExpressionTitle = attributeItem.valueExpressionTitle;
                    e.authoringInfo = dojo.clone(this.renderer.authoringInfo);
                    e.defaultSymbol = null;
                    this.renderer.backgroundFillSymbol && (e.backgroundFillSymbol = this.renderer.backgroundFillSymbol);
                    c && (e.defaultSymbol = c.symbol, e.defaultLabel = c.label);
                    a.forEach(b, g.hitch(this, function(b) { b.symbol ? e.addValue({ value: b.value, label: b.label, symbol: b.symbol }) : a.forEach(this.allUniqueValues, function(a) { a.value === b.value && e.addValue({ value: b.value, label: b.label, symbol: a.symbol }) }) }));
                    return e
                },
                getAllUniqueValues: function(b) {
                    var d = new c;
                    setTimeout(function() { d.progress(d) }, 1);
                    if (this.allUniqueValues && !b) d.resolve();
                    else if (this.allUniqueValues) a.forEach(this.allUniqueValues, function(a, c) { this.applyColorToSymbol(a.symbol, b[c % b.length]) }, this), d.resolve();
                    else {
                        var e = null;
                        b && (e = p.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType }).primaryScheme, e.colors = b);
                        attributeItem = this.getFieldForUniqueRenderer();
                        r.createTypeRenderer({
                            layer: this.fLayer ||
                                this.layer,
                            field: this.hasAttributeCustomExpression(attributeItem) ? null : attributeItem.name,
                            valueExpression: this.hasAttributeCustomExpression(attributeItem) ? attributeItem.valueExpression : null,
                            valueExpressionTitle: attributeItem.valueExpressionTitle,
                            theme: "default",
                            basemap: this.getBasemapType(),
                            scheme: e,
                            numTypes: 10,
                            showOthers: !1,
                            optimizeOutline: !1,
                            includeAllCodedValues: !0,
                            sortBy: "count"
                        }).then(g.hitch(this, function(b) {
                            if (!d.isRejected()) {
                                this.onCalculationsSource && this.onCalculationsSource({ partialData: b.partialData });
                                if (this.isMultiAttributesRenderer && "esriGeometryPolygon" === this.geometryType) {
                                    var c = this.renderer.infos.length && this.renderer.infos[0].symbol;
                                    c instanceof m || (c = null);
                                    a.forEach(b.uniqueValueInfos, function(a) {
                                        var b = c && h.fromJson(c.toJson());
                                        a.symbol = this.convertFillToMarkerSymbol(a.symbol, c && b.style, c && b.outline)
                                    }, this)
                                }
                                this.allUniqueValues = b.uniqueValueInfos;
                                this.allUniqueValuesPartialData = b.partialData;
                                d.resolve()
                            }
                        }), g.hitch(this, function(a) {
                            d.isRejected() || (this.handleError(a, "createTypeRenderer", !1), d.reject())
                        }))
                    }
                    return d
                }
            }
        })
}, "esri/dijit/OpacitySlider": function() {
    define("../kernel ../numberUtils ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils ../Color dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojox/gfx dojo/text!./OpacitySlider/templates/OpacitySlider.html".split(" "), function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x) {
        d = h([f, d, v], {
            declaredClass: "esri.dijit.OpacitySlider",
            baseClass: "esriOpacitySlider",
            templateString: x,
            opacityInfo: null,
            minValue: null,
            maxValue: null,
            histogram: null,
            statistics: !1,
            zoomOptions: null,
            handles: [0, 1],
            showLabels: !0,
            showTicks: !0,
            showHandles: !0,
            showHistogram: !0,
            showStatistics: !0,
            showTransparentBackground: !0,
            histogramWidth: 100,
            rampWidth: 26,
            _rampNode: null,
            _sliderHeight: null,
            _updateTimer: null,
            _forceMinValue: null,
            _forceMaxValue: null,
            constructor: function(a, b) {
                b && (void 0 !== a.minValue && this.set("_forceMinValue", a.minValue), void 0 !== a.maxValue && this.set("_forceMaxValue", a.maxValue), this._updateTimeout =
                    p(this._updateTimeout, 0))
            },
            postCreate: function() {
                this.inherited(arguments);
                this._setupDataDefaults()
            },
            startup: function() {
                this.inherited(arguments);
                this._slider = new n({
                    type: "OpacitySlider",
                    values: this.values,
                    isDate: this.isDate,
                    minimum: this.zoomOptions ? this.zoomOptions.minSliderValue : this.minValue,
                    maximum: this.zoomOptions ? this.zoomOptions.maxSliderValue : this.maxValue,
                    _minZoomLabel: this.zoomOptions ? this.minValue : null,
                    _maxZoomLabel: this.zoomOptions ? this.maxValue : null,
                    _isZoomed: this.zoomOptions ? !0 : !1,
                    showLabels: this.showLabels,
                    showTicks: this.showTicks,
                    showHandles: this.showHandles
                }, this._sliderNode);
                this._slider.startup();
                this._rampNode = this._slider._sliderAreaRight;
                this._sliderHeight = r.get(this._rampNode, "height") || 155;
                this._valuesAutoAdjust();
                this._createSVGSurfaces();
                this._slider.on("slide", m.hitch(this, function(a) {
                    this._valuesAutoAdjust();
                    this._fillRamp()
                }));
                this._slider.on("change", m.hitch(this, function(a) {
                    this.set("values", a.values);
                    this._updateOpacityInfo(a.values);
                    this._valuesAutoAdjust();
                    this._fillRamp();
                    this.emit("change", m.clone(this.opacityInfo))
                }));
                this._slider.on("handle-value-change", m.hitch(this, function(a) {
                    this.set("values", a.values);
                    this._updateOpacityInfo(a.values);
                    this._valuesAutoAdjust();
                    this._fillRamp();
                    this.emit("handle-value-change", m.clone(this.opacityInfo))
                }));
                this._slider.on("data-value-change", m.hitch(this, function(a) {
                    this.set({ minValue: a.min, maxValue: a.max });
                    this._updateRendererSlider();
                    this.emit("data-value-change", {
                        minValue: this.minValue,
                        maxValue: this.maxValue,
                        opacityInfo: m.clone(this.opacityInfo)
                    })
                }));
                this._slider.on("stop", m.hitch(this, function(a) { this.emit("handle-value-change", m.clone(this.opacityInfo)) }));
                this._slider.on("zoom-out", m.hitch(this, function(a) { this.set("zoomOptions", null) }));
                this.statistics && this.showStatistics && this._generateStatistics();
                this.showHistogram && (this.histogram || this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram();
                this.watch("minValue", this._updateTimeout);
                this.watch("maxValue", this._updateTimeout);
                this.watch("opacityInfo",
                    this._updateTimeout);
                this.watch("statistics", this._updateTimeout);
                this.watch("histogram", this._updateTimeout);
                this.watch("zoomOptions", this._updateTimeout);
                this.watch("showHandles", this._updateTimeout);
                this.watch("showLabels", this._updateTimeout);
                this.watch("showTicks", this._updateTimeout);
                this.watch("zoomOptions", this._zoomEventHandler);
                this.watch("showHistogram", this._toggleHistogram);
                this.watch("showTransparentBackground", this._toggleTransparentBackground)
            },
            destroy: function() {
                this.inherited(arguments);
                this._slider && this._slider.destroy();
                this._avgHandleObjs && this._avgHandleObjs.avgHandleTooltip && this._avgHandleObjs.avgHandleTooltip.destroy();
                this.countTooltips && e.forEach(this.countTooltips, function(a) { a.destroy() })
            },
            _updateOpacityInfo: function(a) {
                e.forEach(this.opacityInfo.stops, m.hitch(this, function(b, c) {
                    b.value = a[c].value;
                    b.opacity = a[c].opacity
                }))
            },
            _valuesAutoAdjust: function() {
                var a, b, c, d, f, g, h, m = this._slider.values,
                    n = [];
                e.forEach(m, function(a, b) { a.hidden || n.push(b) });
                for (g = 0; g < n.length - 1; g++)
                    for (a =
                        n[g], b = n[g + 1], c = b - a, d = m[a].value, f = m[b].value, h = a + 1; h < b; h++) m[h].value = d * (b - h) / c + f * (h - a) / c
            },
            _getHandleInfo: function(a) { return e.map(a, m.hitch(this, function(b, d) { return { color: new c([0, 121, 193, b.opacity]), value: a[d].value, opacity: a[d].opacity } })) },
            _updateTimeout: function(a) { this._updateRendererSlider() },
            _updateRendererSlider: function(a) {
                null !== this.zoomOptions && !1 !== this.zoomOptions ? (this.toggleSliderBottom = this.zoomOptions.minSliderValue > this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue <
                    this.maxValue, this._slider.set({ minimum: this.zoomOptions.minSliderValue, maximum: this.zoomOptions.maxSliderValue, _minZoomLabel: this.minValue, _maxZoomLabel: this.maxValue, _isZoomed: !0 })) : this._slider.set({ minimum: this.minValue, maximum: this.maxValue, _minZoomLabel: null, _maxZoomLabel: null, _isZoomed: !1 });
                this.set("values", this._getHandleInfo(this.opacityInfo.stops));
                this._slider.set("values", this.values);
                this._slider._reset();
                this._slider._updateRoundedLabels();
                this._slider._generateMoveables();
                this._clearRect();
                this._createSVGSurfaces();
                this.statistics && this.showStatistics && this._generateStatistics();
                this.showHistogram && (this.histogram || this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram()
            },
            _zoomEventHandler: function() { this.emit("zoomed", !!this.zoomOptions) },
            _setupDataDefaults: function() {
                this.statistics ? this.set({ minValue: this.statistics.min, maxValue: this.statistics.max }) : this.set({ minValue: 0, maxValue: 100 });
                null !== this._forceMinValue && this.set("minValue", this._forceMinValue);
                null !== this._forceMaxValue &&
                    this.set("maxValue", this._forceMaxValue);
                null !== this.zoomOptions && (this.toggleSliderBottom = this.zoomOptions.minSliderValue > this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue < this.maxValue);
                this.minValue === this.maxValue && (0 === this.minValue ? this.set("maxValue", 100) : null === this.minValue ? this.set({ minValue: 0, maxValue: 100 }) : this.set({ minValue: 0, maxValue: 2 * this.minValue }));
                null === this.minValue && this.set("minValue", 0);
                null === this.maxValue && this.set("maxValue", 100);
                this.set("values", this._getHandleInfo(m.clone(this.opacityInfo.stops)))
            },
            _createSVGSurfaces: function() {
                this._colorRampSurface = t.createSurface(this._rampNode, this.rampWidth - 2, this._sliderHeight - 2);
                r.set(this._colorRampSurface.rawNode, "border", "1px solid #888");
                this._surfaceRect = this._colorRampSurface.createRect({ width: this.rampWidth, height: this._sliderHeight });
                this._transparentBackgroundNode = a.generateTransparentBackground(this._colorRampSurface, this.rampWidth - 2, this._sliderHeight - 2, this.showTransparentBackground);
                this._histogramSurface = a.generateHistogramSurface(this._rampNode,
                    this.histogramWidth, this._sliderHeight, this.rampWidth);
                this._fillRamp();
                null !== this.zoomOptions && (this.toggleSliderBottom && this.toggleSliderTop ? (this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 5)), this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 195))) : this.toggleSliderBottom ? this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({
                    color: "#fff",
                    width: 3
                }).setTransform(t.matrix.translate(0, 195)) : this.toggleSliderTop && this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 5)))
            },
            _fillRamp: function() {
                var a = this._slider.minimum,
                    b = this._slider.maximum,
                    c = this._slider.values.slice(0);
                e.forEach(c, function(c) { c.offset = (b - c.value) / (b - a) });
                c.reverse();
                null !== this.zoomOptions ? this.toggleSliderBottom && this.toggleSliderTop ? this._surfaceRect.setFill({
                    type: "linear",
                    x1: 0,
                    y1: 10,
                    x2: 0,
                    y2: this._sliderHeight - 10,
                    colors: c
                }) : this.toggleSliderBottom ? this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight - 20, colors: c }) : this.toggleSliderTop && this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 20, x2: 0, y2: this._sliderHeight, colors: c }) : this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight, colors: c })
            },
            _toggleTransparentBackground: function() { this.showTransparentBackground ? this._transparentBackgroundNode.setFill(a.getTransparentFill()) : this._transparentBackgroundNode.setFill(null) },
            _clearRect: function() {
                this._colorRampSurface.destroy();
                this._histogramSurface.destroy()
            },
            _showHistogram: function() { this.histogram || this.zoomOptions && this.zoomOptions.histogram ? this._generateHistogram() : this._barsGroup && (this._barsGroup.destroy(), this._barsGroup = null) },
            _toggleHistogram: function() { this.showHistogram ? (r.set(this._barsGroup.rawNode, "display", "inline-block"), this._showHistogram()) : r.set(this._barsGroup.rawNode, "display", "none") },
            _generateHistogram: function() {
                var b = this.zoomOptions && this.zoomOptions.histogram ?
                    this.zoomOptions.histogram : this.histogram;
                this._barsGroup = a.generateHistogram(this._histogramSurface, b, this.histogramWidth, this.rampWidth, this.isLeftToRight());
                this.countTooltips = a.generateCountTooltips(b, this._barsGroup)
            },
            _generateStatistics: function() {
                if (!(2 > this.statistics.count || isNaN(this.statistics.avg))) {
                    var b = this.statistics,
                        c = this._slider,
                        d = this.zoomOptions || null,
                        e = a.getPrecision(this.maxValue),
                        f = b.avg,
                        h, m;
                    b.min === b.max && b.min === b.avg ? (h = 0, m = 2 * b.avg) : (h = b.min, m = b.max);
                    if (h !== c.minimum || m !==
                        c.maximum) h = c.minimum, m = c.maximum;
                    d && (h = d.minSliderValue, m = d.maxSliderValue);
                    f = g.round([b.avg, m, h])[0];
                    this._avgHandleObjs = a.generateAvgLine(this._histogramSurface, f, this._sliderHeight * (m - b.avg) / (m - h), e, this.isLeftToRight(), this.isDate)
                }
            }
        });
        m.setObject("dijit.OpacitySlider", d, b);
        return d
    })
}, "esri/dijit/RendererSlider": function() {
    define("../kernel ../numberUtils ../renderers/utils ./DateTimeTextBox ./RendererSlider/sliderUtils dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/NumberTextBox dojo/debounce dojo/on dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dnd/move dojo/dom-construct dojo/dom-style dojo/dom-class dojo/Evented dojo/number dojo/has dojo/text!./RendererSlider/templates/RendererSlider.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A) {
            d = v([e, f, d, G], {
                declaredClass: "esri.dijit.RendererSlider",
                baseClass: "esriRendererSlider",
                templateString: A,
                theme: "Slider",
                intermediateChanges: !1,
                type: null,
                minimum: 0,
                maximum: 100,
                values: [50],
                precision: 2,
                isDate: !1,
                handles: [],
                primaryHandle: null,
                showHandles: !0,
                showTicks: !0,
                showLabels: !0,
                showRatioLabels: !1,
                minLabel: null,
                maxLabel: null,
                _visibleLabels: ["data", "handle"],
                _roundedDataLabels: [],
                _roundedHandleLabels: [],
                _ratioLabels: [],
                _minRatioLabel: "",
                _maxRatioLabel: "",
                _isZoomed: !1,
                _minZoomLabel: "",
                _maxZoomLabel: "",
                _maximumNumberEditor: null,
                _minimumNumberEditor: null,
                _valueDifferenceByIndex: [],
                _primaryHandleIdx: null,
                _currentTopValue: [],
                _isLTR: !0,
                _ctrlDown: !1,
                _histogramSurface: null,
                _css: null,
                _minPrecisionForSmallNumbers: 3,
                constructor: function(a, b) {
                    this.inherited(arguments);
                    this.domNode = b;
                    this._css = {
                        container: "esri-renderer-slider",
                        slidernode: "esri-slider-node",
                        sliderarea: "esri-slider-area",
                        sliderarearight: "esri-slider-area-right",
                        moveable: "esri-moveable",
                        handler: "esri-handle",
                        handlerSpan: "esri-handle-span",
                        handlerContainer: "esri-handle-container",
                        handlerLabel: "esri-handle-label",
                        handlerLabelSpan: "esri-handle-label-span",
                        topLabelNode: "esri-top-label-node",
                        bottomLabelNode: "esri-bottom-label-node",
                        topLabelNodeHover: "esri-top-label-node-hover",
                        bottomLabelNodeHover: "esri-bottom-label-node-hover",
                        heatmapTick: "esri-heatmap-tick",
                        handlerTick: "esri-handler-tick",
                        handlerTickTop: "esri-handler-tick-top",
                        handlerTickBottom: "esri-handler-tick-bottom"
                    };
                    this.showLabels = a.showLabels || this._visibleLabels;
                    this._updateTimeout = m(this._updateTimeout, 0)
                },
                startup: function() {
                    this.inherited(arguments);
                    this.set("_sliderHeight", B.get(this._sliderArea, "height") || 200);
                    this._checkMinMaxDefaults();
                    this.set("_isLTR", this.isLeftToRight());
                    if (!this._isLTR) {
                        var a = B.get(this._sliderNode, "padding-left") + B.get(this._sliderNode, "padding-right"),
                            b = Math.round(B.get(this._sliderNode, "width"));
                        this.set("_sliderNodeWidth_RTL", a + b)
                    }
                    this.set("precision", c.getCombinedPrecision(this.minimum, this.maximum));
                    this._updateRoundedLabels();
                    this._generateMoveables();
                    this._generateMinMaxEditors();
                    this._generateCtrlKeyListener();
                    this.watch("values", this._valuesChange);
                    this.watch("minimum", this._updateTimeout);
                    this.watch("maximum", this._updateTimeout);
                    this.watch("showRatioLabels", this._updateTimeout)
                },
                destroy: function() { this.inherited(arguments) },
                setValue: function(a, b, c) {
                    var d = this.get("values"),
                        e = d.slice(0);
                    "object" === typeof d[0] ? e[a].value = b : e[a] = b;
                    (this.intermediateChanges || c) && this.set("values", e);
                    c ? this.emit("stop", { values: this.get("values") }) :
                        this.emit("slide", { values: e })
                },
                _updateTimeout: function() { this._updateSlider() },
                _updateSlider: function() {
                    this._reset();
                    this._checkMinMaxDefaults();
                    this._updateRoundedLabels();
                    this._generateMoveables();
                    this._generateMinMaxEditors();
                    this._generateCtrlKeyListener()
                },
                _checkMinMaxDefaults: function() {
                    var a = this.values,
                        b;
                    this.minimum === this.maximum && a && 0 < a.length && (isNaN(a[0]) ? this.set({ minimum: 0, maximum: 2 * a[0].value }) : this.set({ minimum: 0, maximum: 2 * a[0] }));
                    a && 0 < a.length && (b = isNaN(a[0]) ? a[0].value : a[0], this.minimum >
                        b && this.set("minimum", b), a = isNaN(a[a.length - 1]) ? a[a.length - 1].value : a[a.length - 1], this.maximum < a && this.set("maximum", a))
                },
                _calculateValueFromHandlePosition: function(a) {
                    var b = this.get("minimum"),
                        c = this.get("maximum"),
                        d = this.get("precision"),
                        e = this.get("step") || Math.pow(10, -d);
                    return 1 >= b && -1 <= b && 1 >= c && -1 <= c || d >= this._minPrecisionForSmallNumbers ? (a * (c - b) + b) / e * e : parseFloat((Math.round((a * (c - b) + b) / e) * e).toFixed(d))
                },
                _generateMoveables: function() {
                    var a, b = this._sliderNode,
                        d = this._sliderHeight,
                        e = this.get("minimum"),
                        f = this.get("maximum");
                    this.get("precision");
                    this.get("step");
                    var g = this.get("showLabels"),
                        h = this.get("showTicks"),
                        m = w.hitch(this, this.setValue),
                        n = this.get("values");
                    this._updateMinMaxLabels();
                    this.set("_primaryHandleIdx", null);
                    a = r.map(n, w.hitch(this, function(n, p) {
                        var v, A, D, F, y;
                        n && n.primaryHandle && this.set("_primaryHandleIdx", p);
                        if ("object" === typeof n && n.hidden) return null;
                        "object" === typeof n && (n = n.value);
                        v = x.create("div", { style: this._getHandleStyleString(n), className: this._css.moveable }, b);
                        y = v._handleContainer =
                            x.create("div", { className: this._css.handlerContainer }, v);
                        v._arrowSpan = D = x.create("span", { className: this._css.handlerSpan }, y);
                        v._handler = n = x.create("div", { className: this._css.handler }, y);
                        "HeatmapSlider" !== this.type && (!0 === g || "object" === typeof g && -1 !== r.indexOf(g, "handles")) && (A = this._generateHandleLabel(v, p));
                        h && this._generateHandleTicks(v, p);
                        F = new t.constrainedMoveable(v, { handle: y, within: !0, constraints: w.hitch(this, function() { return { t: 0, l: this._isLTR ? 0 : this._sliderNodeWidth_RTL, w: 0, h: d } }) });
                        F.onMoveStart =
                            w.hitch(this, function(b) {
                                var e = this.handles,
                                    f = r.indexOf(e, p),
                                    g, h;
                                this._currentTopValue[p] = b.node.style.top;
                                v.labelNode && v.labelNode._autoPositioned && (B.set(v.labelNode, "top", "3px"), v.labelNode._autoPositioned = !1);
                                c._autoPositionHandleLabels(this.get("moveables"));
                                v._numberEditor && (v._numberEditor.destroy(), v._numberEditor = null);
                                this._primaryHandleIdx !== p ? (0 < e.length ? (b = null !== e[f - 1] ? e[f - 1] : null, e = null !== e[f + 1] ? e[f + 1] : null, f = a[b], e = a[e]) : (f = a[p - 1], e = a[p + 1]), f && e ? (f = f.style.top, e = e.style.top, g = Number(f.replace("px",
                                    "")), h = Number(e.replace("px", "")), F.constraints = w.hitch(this, function() { return { t: h + 2, l: this._isLTR ? 0 : this._sliderNodeWidth_RTL, w: 0, h: d - h - (d - g + 4) } })) : f ? (f = f.style.top, g = Number(f.replace("px", "")), F.constraints = w.hitch(this, function() { return { t: 0, l: this._isLTR ? 0 : this._sliderNodeWidth_RTL, w: 0, h: d - (d - g + 2) } })) : e && (e = e.style.top, h = Number(e.replace("px", "")), F.constraints = w.hitch(this, function() { return { t: h + 2, l: this._isLTR ? 0 : this._sliderNodeWidth_RTL, w: 0, h: d - (h + 2) } }))) : (0 < e.length ? (b = null !== e[f - 1] ? e[f - 1] :
                                    null, e = null !== e[f + 1] ? e[f + 1] : null, f = a[b], e = a[e]) : (f = a[p - 1], e = a[p + 1]), f && e && (f = f.style.top, e = e.style.top, g = Number(f.replace("px", "")), h = Number(e.replace("px", "")), F.constraints = w.hitch(this, function() { return { t: 2, l: this._isLTR ? 0 : this._sliderNodeWidth_RTL, w: 0, h: d - 4 } })))
                            });
                        F.onMoved = w.hitch(this, function(b) {
                            var g, h, n, q, t;
                            p === this._primaryHandleIdx && (n = Number(this._currentTopValue[p].replace("px", "")) - Number(b.node.style.top.replace("px", "")), this._currentTopValue[p] = b.node.style.top, r.forEach(a, w.hitch(this,
                                function(a, b) { a && b !== p && (q = Number(a.style.top.replace("px", "")), t = q - n, g = 1 - Number(t / d), h = this._calculateValueFromHandlePosition(g), h < e || h > f || (B.set(a, "top", t + "px"), m(b, h, !1), a.labelNode && (a.labelNode.spanNode.innerHTML = this.showRatioLabels ? this._getLabelValueFromIndex(b) : this._formatValue(h.toFixed(6))))) })));
                            g = 1 - Number(b.node.style.top.replace("px", "")) / d;
                            h = this._calculateValueFromHandlePosition(g);
                            null !== this._primaryHandleIdx && p !== this._primaryHandleIdx && this._ctrlDown && (n = Number(this._currentTopValue[p].replace("px",
                                "")) - Number(b.node.style.top.replace("px", "")), this._currentTopValue[p] = b.node.style.top, 0 === p ? (q = Number(a[a.length - 1].style.top.replace("px", "")), b = q + n, b > d && (b = d), 0 > b && (b = 0), B.set(a[a.length - 1], "top", b + "px"), b = 1 - b / d, b = this._calculateValueFromHandlePosition(b), m(a.length - 1, b, !1), a[a.length - 1].labelNode && (a[a.length - 1].labelNode.spanNode.innerHTML = this._formatValue(b.toFixed(6)))) : p === a.length - 1 && (q = Number(a[0].style.top.replace("px", "")), b = q + n, b > d && (b = d), 0 > b && (b = 0), B.set(a[0], "top", b + "px"), b = 1 - b /
                                d, b = this._calculateValueFromHandlePosition(b), m(0, b, !1), a[0].labelNode && (a[0].labelNode.spanNode.innerHTML = this._formatValue(b.toFixed(6)))));
                            m(p, h, !1);
                            this._updateRoundedLabels();
                            A && (b = this._formatValue(parseFloat(this._roundValue([h, parseFloat(this._getLabelValueFromIndex(p, !0))])[0]).toFixed(this.precision)), A.spanNode.innerHTML = this.showRatioLabels ? this._getLabelValueFromIndex(p) : b);
                            c._autoPositionHandleLabels(this.get("moveables"))
                        });
                        F.onMoveStop = w.hitch(this, function(a) {
                            a = Number(a.node.style.top.replace("px",
                                ""));
                            a = this._calculateValueFromHandlePosition(1 - a / d);
                            m(p, a, !0);
                            this._updateRoundedLabels();
                            A && (a = this._formatValue(parseFloat(this._roundValue([a, parseFloat(this._getLabelValueFromIndex(p, !0))])[0]).toFixed(this.precision)), A.spanNode.innerHTML = this.showRatioLabels ? this._getLabelValueFromIndex(p) : a);
                            c._autoPositionHandleLabels(this.get("moveables"))
                        });
                        this.showHandles || (B.set(n, "display", "none"), B.set(D, "display", "none"));
                        return v
                    }));
                    this.set("moveables", a);
                    c._autoPositionHandleLabels(this.get("moveables"))
                },
                _reset: function() {
                    r.forEach(this.moveables, w.hitch(this, function(a) { a && a.parentElement.removeChild(a) }));
                    this.moveables = []
                },
                _getHandleStyleString: function(a) {
                    var b = this.get("minimum"),
                        c = this.get("maximum");
                    return "top: " + Math.round((1 - (a - b) / (c - b)) * this._sliderHeight) + "px; " + ("left: " + (this._isLTR ? 0 : this._sliderNodeWidth_RTL) + "px;")
                },
                _generateHandleTicks: function(a, b) {
                    var c = this._css,
                        d = c.handlerTick + " " + c.handlerTickTop,
                        e = c.handlerTick + " " + c.handlerTickBottom;
                    b = 0 === b ? e : d;
                    "HeatmapSlider" === this.type &&
                        (b += c.heatmapTick);
                    a._tick = x.create("div", { className: b }, a)
                },
                _updateLabels: function() {
                    this._updateMinMaxLabels();
                    this._updateRoundedLabels()
                },
                _resetLabelPositions: function() {
                    r.forEach(this.moveables, function(a) {
                        if (a) {
                            var b = a.labelNode;
                            b && (B.set(b, "top", "3px"), a.labelNode._autoPositioned = !1)
                        }
                    })
                },
                _generateHandleLabel: function(a, b) {
                    var c, d;
                    c = x.create("div", { className: this._css.handlerLabel }, a);
                    d = x.create("span", { className: this._css.handlerLabelSpan, innerHTML: this._getLabelValueFromIndex(b) }, c);
                    c.spanNode =
                        d;
                    a.labelNode = c;
                    p(c, "click", w.hitch(this, function() { this._generateHandleLabelEditor(a, b) }));
                    return c
                },
                _updateMinMaxLabels: function() {
                    var a = this.minimum,
                        b = this.maximum,
                        c = this.showLabels,
                        d = this.minLabel,
                        e = this.maxLabel,
                        f = this._topNodeSpan,
                        g = this._bottomNodeSpan,
                        h = this._isZoomed,
                        m = this._maxZoomLabel,
                        n = this._minZoomLabel,
                        p = this.showRatioLabels,
                        t = this._maxRatioLabel,
                        v = this._minRatioLabel,
                        w = this._roundedDataLabels;
                    !1 === c || "object" === typeof c && -1 === r.indexOf(c, "data") ? (f.innerHTML = "", g.innerHTML = "") : h ? p ?
                        (f.innerHTML = t, g.innerHTML = v) : (f.innerHTML = this._formatValue(m), g.innerHTML = this._formatValue(n)) : p ? (f.innerHTML = t, g.innerHTML = v) : (h = isNaN(d) ? d : this._roundValue([d, e])[0], c = isNaN(e) ? e : this._roundValue([d, e])[1], d = isNaN(h) || null === h ? d : this._formatValue(h), e = isNaN(c) || null === c ? e : this._formatValue(c), a = this._formatValue(w[0]) || this._formatValue(a), b = this._formatValue(w[1]) || this._formatValue(b), f.innerHTML = e || b, g.innerHTML = d || a)
                },
                _formatValue: function(a) {
                    "string" === typeof a && (a = Number(a));
                    return this.isDate ?
                        n.formatDate(new Date(a), n.timelineDateFormatOptions) : g.format(a)
                },
                _roundValue: function(a) { return this.isDate ? a.slice(0) : g.round(a) },
                _updateRoundedLabels: function() {
                    this._roundedDataLabels = this._roundValue([this.minimum, this.maximum]);
                    switch (this.type) {
                        case "SizeInfoSlider":
                        case "ClassedSizeSlider":
                        case "ClassedColorSlider":
                            this._roundedHandleLabels = this._roundValue(this.values);
                            break;
                        case "ColorInfoSlider":
                        case "OpacitySlider":
                            this._roundedHandleLabels = this._roundValue(this._getValuesFromObject(this.values))
                    }
                    this._updateRatioLabels()
                },
                _updateRatioLabels: function() {
                    var a = this.get("showRatioLabels"),
                        b = this.get("minimum"),
                        c = this.get("maximum"),
                        d = this._getValuesFromObject(this.values),
                        e = [],
                        f, g;
                    !1 !== a && ("percent" !== a && "percentTotal" !== a ? this.set("showRatioLabels", !1) : ("percent" === a ? (r.forEach(d, function(a) { e.push(this._getRatioFromValue(a)) }, this), f = this._formatValue(this._getRatioFromValue(b).toFixed(2)), g = this._formatValue(this._getRatioFromValue(c).toFixed(2))) : "percentTotal" === a && (r.forEach(d, function(a) { e.push(this._getRatioFromValue(a)) },
                        this), f = this._formatValue(this._getRatioFromValue(b).toFixed(2)), g = this._formatValue(this._getRatioFromValue(c).toFixed(2))), this.set({ _ratioLabels: e, _minRatioLabel: f + "%", _maxRatioLabel: g + "%" })))
                },
                _generateMinMaxEditors: function() {
                    !this.showLabels || "object" === typeof this.showLabels && -1 === r.indexOf(this.showLabels, "data") || "HeatmapSlider" === this.type ? (E.remove(this._topNode, this._css.topLabelNodeHover), E.remove(this._botNode, this._css.bottomLabelNodeHover)) : (p(this._topNode, "click", w.hitch(this, this._generateMaxEditor)),
                        p(this._botNode, "click", w.hitch(this, this._generateMinEditor)))
                },
                _generateMaxEditor: function() {
                    if (!(this._maximumNumberEditor && this._topLabelNode || this._isZoomed)) {
                        var b = this.get("minLabel"),
                            c = this.get("maxLabel"),
                            d = this.get("maximum"),
                            e, f;
                        this._topNodeSpan.innerHTML = "";
                        this._topLabelNode = x.create("input", { type: "text" }, this._topNode);
                        e = this.handles && 0 < this.handles.length ? this.values[this.handles[this.handles.length - 1]] : this.values[this.values.length - 1];
                        "object" === typeof e && (e = e.value);
                        this.showRatioLabels &&
                            (e = this._getLabelValueFromIndex(this.values.length - 1, !0).replace("%", ""), d = Number(this._maxRatioLabel.replace("%", "")));
                        this.isDate ? (f = new a({ date: new Date(Number(d)), required: !0, constraints: { min: new Date(e), max: null } }, this._topLabelNode), b = { editor: f, editorPropName: "_maximumNumberEditor", spanNode: this._topNodeSpan, operator: "\x3c" }, f.on("keydown", w.hitch(this, this._minMaxKeydownDateHandler, b)), f.on("blur", w.hitch(this, this._minMaxBlurDateValue, b)), f.watch("date", w.hitch(this, this._minMaxUpdateDateValue,
                            b))) : (f = new h({ value: Number(d), required: !0, constraints: { min: e, max: "percentTotal" === this.showRatioLabels ? 100 : null, places: "0,20" } }, this._topLabelNode), p(f, "keydown", w.hitch(this, this._keydownHandler, { editor: f, originalValidate: !1 })), p(f, "blur", w.hitch(this, this._minMaxBlurHandler, { editor: f, editorPropName: "_maximumNumberEditor", label: c, current: d, spanNode: this._topNodeSpan, index: 1, minLabel: b, maxLabel: c, ratioLabel: this._maxRatioLabel })), p(f, "change", w.hitch(this, this._minMaxChangeHandler, {
                            label: c,
                            current: d,
                            spanNode: this._topNodeSpan,
                            index: 1,
                            minLabel: b,
                            maxLabel: c,
                            ratioLabel: this._maxRatioLabel,
                            handleValue: e,
                            operator: "\x3c"
                        })));
                        this._maximumNumberEditor = f;
                        f.startup();
                        f.focus();
                        f.textbox.select()
                    }
                },
                _generateMinEditor: function() {
                    if (!(this._minimumNumberEditor && this._botLabelNode || this._isZoomed)) {
                        var b = this.minLabel,
                            c = this.maxLabel,
                            d = this.minimum,
                            e, f;
                        this._bottomNodeSpan.innerHTML = "";
                        this._botLabelNode = x.create("input", { type: "text" }, this._botNode);
                        e = this.handles && 0 < this.handles.length ? this.values[this.handles[0]] :
                            this.values[0];
                        "object" === typeof e && (e = e.value);
                        this.showRatioLabels && (e = this._getLabelValueFromIndex(0, !0).replace("%", ""), d = Number(this._minRatioLabel.replace("%", "")));
                        this.isDate ? (f = new a({ date: new Date(Number(d)), required: !0, constraints: { min: null, max: new Date(e) } }, this._botLabelNode), b = { editor: f, editorPropName: "_minimumNumberEditor", spanNode: this._bottomNodeSpan, operator: "\x3e" }, f.on("keydown", w.hitch(this, this._minMaxKeydownDateHandler, b)), f.on("blur", w.hitch(this, this._minMaxBlurDateValue,
                            b)), f.watch("date", w.hitch(this, this._minMaxUpdateDateValue, b))) : (f = new h({ value: Number(d), required: !0, constraints: { max: e, min: "percentTotal" === this.showRatioLabels ? 0 : null, places: "0,20" } }, this._botLabelNode), p(f, "keydown", w.hitch(this, this._keydownHandler, { editor: f, originalValidate: !1 })), p(f, "blur", w.hitch(this, this._minMaxBlurHandler, { editor: f, editorPropName: "_minimumNumberEditor", label: b, current: d, spanNode: this._bottomNodeSpan, index: 0, minLabel: b, maxLabel: c, ratioLabel: this._minRatioLabel })), p(f, "change",
                            w.hitch(this, this._minMaxChangeHandler, { label: b, current: d, spanNode: this._bottomNodeSpan, index: 0, minLabel: b, maxLabel: c, ratioLabel: this._minRatioLabel, handleValue: e, operator: "\x3e" })));
                        this._minimumNumberEditor = f;
                        f.startup();
                        f.focus();
                        f.textbox.select()
                    }
                },
                _minMaxBlurHandler: function(a, b) {
                    b = a.editor;
                    var c = a.editorPropName,
                        d = a.label,
                        e = a.current,
                        f = a.spanNode,
                        g = a.index,
                        h = a.minLabel,
                        m = a.maxLabel;
                    a = a.ratioLabel;
                    h = isNaN(d) ? d : this._roundValue([h, m])[g];
                    d = isNaN(h) || null === h ? d : this._formatValue(h);
                    e = this._formatValue(this._roundedDataLabels[g]) ||
                        this._formatValue(e);
                    this.showLabels || "object" === typeof this.showLabels && -1 !== r.indexOf(this.showLabels, "data") ? f.innerHTML = this.showRatioLabels ? a : d || e : f.innerHTML = "";
                    b.destroy();
                    this[c] = null
                },
                _minMaxChangeHandler: function(a, b) {
                    var c = a.label,
                        d = a.current,
                        e = a.spanNode,
                        f = a.index,
                        g = a.minLabel,
                        h = a.maxLabel,
                        m = a.ratioLabel,
                        n = a.handleValue;
                    a = a.operator;
                    ("\x3c" === a ? b < Number(n) : b > Number(n)) || isNaN(b) || void 0 === b ? (b = isNaN(c) ? c : this._roundValue([g, h])[f], b = isNaN(b) || null === b ? c : this._formatValue(b), d = this._formatValue(this._roundedDataLabels[f]) ||
                        this._formatValue(d), e.innerHTML = this.showRatioLabels ? m : b || d) : (m = this.showRatioLabels ? this._getValueFromPercent(b) : b, e.innerHTML = this.showRatioLabels ? m : this._formatValue(b), this.set("\x3c" === a ? "maximum" : "minimum", m), this._reset(), this._updateRoundedLabels(), this._generateMoveables(), this._generateMinMaxEditors(), this.emit("data-value-change", { min: this.minimum, max: this.maximum, values: w.clone(this.values) }))
                },
                _minMaxKeydownDateHandler: function(a, b) {
                    13 === b.keyCode && a.editor.isValid() && setTimeout(w.hitch(this,
                        this._destroyMinMaxHandleEditor, a), 0)
                },
                _minMaxBlurDateValue: function(a, b) { setTimeout(w.hitch(this, this._destroyMinMaxHandleEditor, a), 0) },
                _destroyMinMaxHandleEditor: function(a) {
                    a.spanNode.innerHTML = this._formatValue(this.get("\x3c" === a.operator ? "maximum" : "minimum"));
                    a.editor.destroy();
                    this[a.editorPropName] = null
                },
                _minMaxUpdateDateValue: function(a) {
                    var b = a.spanNode,
                        c = a.operator;
                    a = a.editor.get("date");
                    var c = "\x3c" === c ? "maximum" : "minimum",
                        d = this.get(c);
                    a = a && a.getTime();
                    if (d = d !== a) b.innerHTML = this._formatValue(a),
                        this.set(c, a);
                    this._reset();
                    this._updateRoundedLabels();
                    this._generateMoveables();
                    this._generateMinMaxEditors();
                    d && this.emit("data-value-change", { min: this.minimum, max: this.maximum, values: w.clone(this.values) })
                },
                _generateHandleLabelEditor: function(b, c) {
                    if (!b._numberEditor) {
                        var d = this.get("handles"),
                            e = this.get("maximum"),
                            f = this.get("minimum"),
                            g = this.get("_isZoomed"),
                            m = this.get("values"),
                            n = m[c],
                            t = r.indexOf(d, c),
                            v = b.labelNode,
                            A, D, F, B;
                        "object" === typeof n && (n = n.value);
                        v.spanNode.innerHTML = "";
                        B = x.create("input", { type: "text" }, v);
                        0 < d.length ? (A = null !== d[t - 1] ? d[t - 1] : null, D = null !== d[t + 1] ? d[t + 1] : null, d = m[A], m = m[D]) : (d = m[c - 1], m = m[c + 1]);
                        "object" === typeof d && (d = d.value);
                        "object" === typeof m && (m = m.value);
                        t = void 0 !== d && null !== d ? d : g && !isNaN(this._minZoomLabel) ? this._minZoomLabel : f;
                        F = void 0 !== m && null !== m ? m : g && !isNaN(this._maxZoomLabel) ? this._maxZoomLabel : e;
                        this.showRatioLabels && (n = this._getLabelValueFromIndex(c).replace("%", ""), t = d ? Number(this._getLabelValueFromIndex(A, !0).replace("%", "")) : Number(this._minRatioLabel.replace("%",
                            "")) || Number(this._getRatioFromValue(this.minimum)), F = m ? Number(this._getLabelValueFromIndex(D, !0).replace("%", "")) : Number(this._maxRatioLabel.replace("%", "")) || Number(this._getRatioFromValue(this.maximum)));
                        this.isDate ? (A = new a({ date: new Date(n), required: !0, constraints: { min: new Date(t), max: new Date(F) } }, B), c = { editor: A, editorPropName: "_numberEditor", min: f, max: e, index: c, zoomed: g, spanNode: v.spanNode, moveable: b }, A.on("keydown", w.hitch(this, this._stopKeydownDateHandler, c)), A.on("blur", w.hitch(this, this._stopBlurDateHandler,
                            c)), A.watch("date", w.hitch(this, this._stopUpdateDateValue, c))) : (A = new h({ value: n, constraints: { min: t, max: F, places: "0,20" } }, B), p(A, "keydown", w.hitch(this, this._keydownHandler, { editor: A, originalValidate: !1 })), p(A, "blur", w.hitch(this, this._blurHandler, { editor: A, editorPropName: "_numberEditor", updatedValue: n, min: f, max: e, index: c, zoomed: g, spanNode: v.spanNode, moveable: b })), p(A, "change", w.hitch(this, this._changeHandler, { editor: A, index: c, spanNode: v.spanNode })));
                        b._numberEditor = A;
                        A.focus();
                        A.textbox.select()
                    }
                },
                _keydownHandler: function(a, b) {
                    var c = a.originalValidate;
                    a = a.editor;
                    !1 !== c && (a.validate = c);
                    13 === b.keyCode && (b = a.get("value"), void 0 === b && (b = a.get("displayedValue")), b <= a.constraints.max && b >= a.constraints.min ? a.focusNode.blur() : (c = a.validate, a.validate(!1), a.validate = function() { return !1 }))
                },
                _blurHandler: function(a, b) {
                    b = a.editor;
                    var c = a.editorPropName,
                        d = a.updatedValue,
                        e = a.min,
                        f = a.max,
                        g = a.index,
                        h = a.zoomed,
                        m = a.spanNode;
                    a = a.moveable;
                    isNaN(b.get("value")) && b.set("value", d);
                    h && (b.get("value") > f || b.get("value") <
                        e) && (this.set("_isZoomed", !1), this.emit("zoom-out"));
                    m.innerHTML = this._getLabelValueFromIndex(g);
                    b.destroy();
                    a[c] = null
                },
                _changeHandler: function(a, b) {
                    var c = a.editor,
                        d = a.index;
                    a = a.spanNode;
                    var e = b;
                    b > c.constraints.max || b < c.constraints.min || isNaN(b) || void 0 === b ? a.innerHTML = this._getLabelValueFromIndex(d) : (this.showRatioLabels && (e = this._getValueFromPercent(b)), "object" === typeof this.values[d] ? this.values[d].value = e : this.values[d] = e, this._reset(), this._updateRoundedLabels(), this._generateMoveables(), this._generateMinMaxEditors(),
                        this.emit("handle-value-change", { values: this.values }))
                },
                _stopKeydownDateHandler: function(a, b) { 13 === b.keyCode && a.editor.isValid() && setTimeout(w.hitch(this, this._destroyHandleEditor, a), 0) },
                _stopBlurDateHandler: function(a, b) { setTimeout(w.hitch(this, this._destroyHandleEditor, a), 0) },
                _destroyHandleEditor: function(a) {
                    a.spanNode.innerHTML = this._getLabelValueFromIndex(a.index);
                    a.editor.destroy();
                    a.moveable[a.editorPropName] = null
                },
                _stopUpdateDateValue: function(a) {
                    var b = a.min,
                        c = a.max,
                        d = a.index,
                        e = a.zoomed,
                        f =
                        a.spanNode;
                    a = (a = a.editor.get("date")) && a.getTime();
                    e && (a > c || a < b) && (this.set("_isZoomed", !1), this.emit("zoom-out"));
                    if (b = ("object" === typeof this.values[d] ? this.values[d].value : this.values[d]) !== a) "object" === typeof this.values[d] ? this.values[d].value = a : this.values[d] = a;
                    f.innerHTML = this._getLabelValueFromIndex(d);
                    this._reset();
                    this._updateRoundedLabels();
                    this._generateMoveables();
                    this._generateMinMaxEditors();
                    b && this.emit("handle-value-change", { values: this.values })
                },
                _getRatioFromValue: function(a) {
                    var b =
                        this.get("showRatioLabels");
                    return "percent" === b ? 100 * a : "percentTotal" === b ? a / (1 + a) * 100 : null
                },
                _getValueFromPercent: function(a) {
                    var b, c = this.get("showRatioLabels");
                    if ("percent" === c) b = a / 100;
                    else if ("percentTotal" === c) {
                        if (100 <= a) return 100;
                        b = a / (100 - a)
                    }
                    return b
                },
                _getLabelValueFromIndex: function(a, b) {
                    return this.showRatioLabels && this._ratioLabels[a] ? !0 === b ? parseFloat(this._ratioLabels[a].toFixed(2)) + "%" : this._formatValue(parseFloat(this._ratioLabels[a].toFixed(2))) + "%" : !0 === b ? this._roundedHandleLabels[a] :
                        this._formatValue(this._roundedHandleLabels[a])
                },
                _getValuesFromObject: function(a) {
                    var b = [];
                    r.forEach(a, function(a) { b.push(a.value) });
                    return b
                },
                _getDecimalPlaces: function(a) { return F.format(a, { places: "0,20", round: -1 }).replace(/^-?\d*\.?|0+$/g, "").length },
                _collisionCheck: function(a, b) { return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom) },
                _generateCtrlKeyListener: function() {
                    p(document, "keydown", w.hitch(this, function(a) { this._ctrlDown = a.metaKey || a.ctrlKey }));
                    p(document, "keyup", w.hitch(this,
                        function(a) { this._ctrlDown = a.metaKey || a.ctrlKey }))
                },
                _valuesChange: function() { this.emit("change", { values: this.get("values") }) }
            });
            w.setObject("dijit.RendererSlider", d, b);
            return d
        })
}, "esri/dijit/DateTimeTextBox": function() {
    define("dojo/_base/lang dojo/_base/declare dojo/date/locale dojo/sniff dojo/keys ../kernel ../renderers/utils ./_EventedWidget dijit/form/_DateTimeTextBox dijit/form/ValidationTextBox".split(" "), function(b, g, n, a, c, d, f, e, h, m) {
        g = g([m], {
            declaredClass: "esri.dijit.DateTimeTextBox",
            value: null,
            date: null,
            _timeSeparator: ", ",
            _dateFormatOptions: { dateOptions: { formatLength: "short", selector: "date", fullYear: !0 }, timeOptions: { formatLength: "short", selector: "time" } },
            constructor: function(a, c) {
                this._getValidDateTimeRE = b.hitch(this, this._getValidDateTimeRE);
                this.set("pattern", this._getValidDateTimeRE);
                this.set("invalidMessage", this._getInvalidMessage())
            },
            postCreate: function() {
                this.inherited(arguments);
                this.own(this.on("change", b.hitch(this, this._valueChangeHandler)), this.on("keydown", b.hitch(this, this._keydownHandler)))
            },
            format: function(a) { return this._formatDate(a) },
            parse: function(a, b) { a = this._parseDateString(a, b); return a.isValid ? new Date(a.value) : void 0 },
            compare: h.prototype.compare,
            _isInvalidDate: h.prototype._isInvalidDate,
            _setDateAttr: function(a) {
                this._set("date", a);
                this.set("value", a)
            },
            _valueChangeHandler: function(a) { this.isValid() && this.set("date", a) },
            _keydownHandler: function(a) { a.keyCode === c.ENTER && this._commitValueToDate() },
            _commitValueToDate: function() {
                var a = this._parseDateString(this.textbox.value);
                a.isValid &&
                    this.set("value", new Date(a.value))
            },
            _formatDate: function(a) {
                var b = "";
                a instanceof Date && (a = a.getTime());
                "number" !== typeof a || isNaN(a) || (b = f.formatDate(a, { selector: "date", dateOptions: this._dateFormatOptions.dateOptions }), a = f.formatDate(a, { selector: "time", timeOptions: this._dateFormatOptions.timeOptions }), b = this._mergeDateTime(b, a));
                return b
            },
            _parseDateString: function(a, b) {
                b = b || {};
                var c = (a || "").split(this._timeSeparator);
                a = c[1];
                var d = n.parse(c[0], this._dateFormatOptions.dateOptions),
                    c = n.parse(a, this._dateFormatOptions.timeOptions),
                    e = !1,
                    f = b.min;
                b = b.max;
                d = d && d.getTime();
                "number" !== typeof d || isNaN(d) ? d = null : c ? (a = c && c.getTime(), "number" !== typeof a || isNaN(a) || (a -= 6E4 * c.getTimezoneOffset(), d += a, e = !0)) : e = !a;
                e && (f = f && f.getTime(), b = b && b.getTime(), "number" !== typeof f || isNaN(f) || d < f && (e = !1), "number" !== typeof b || isNaN(b) || d > b && (e = !1));
                return { isValid: e, value: d }
            },
            _getValidDateTimeRE: function() {
                var a = n.regexp(this._dateFormatOptions.dateOptions),
                    b = n.regexp(this._dateFormatOptions.timeOptions);
                return a + "(,\\s" + b + ")?"
            },
            _getInvalidMessage: function() { return this._formatDate(new Date(0)) },
            _mergeDateTime: function(a, b) { return a + (b ? this._timeSeparator + b : "") }
        });
        b.setObject("dijit.DateTimeTextBox", g, d);
        return g
    })
}, "esri/dijit/RendererSlider/sliderUtils": function() {
    define("../../renderers/utils ../../numberUtils dojo/i18n!../../nls/jsapi dojo/_base/array dojo/_base/lang dojo/dom-style dojo/string dijit/Tooltip dojox/gfx".split(" "), function(b, g, n, a, c, d, f, e, h) {
        return {
            histogramXAvgPadding: 18,
            labelTopOffset: 3,
            generateTransparentBackground: function(a, b, c, d) {
                a = a.createRect({ width: b, height: c }).setFill(d ?
                    this.getTransparentFill() : null);
                a.moveToBack();
                return a
            },
            getTransparentFill: function() { return { type: "pattern", x: 0, y: 0, width: 16, height: 16, src: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2Ij48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNjY2MiIC8+PHBhdGggZD0iTTAgMCBMOCAwIEw4IDggTDAgOCBaIiBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDgpIiAvPjxwYXRoIGQ9Ik0wIDAgTDggMCBMOCA4IEwwIDggWiIgZmlsbD0iI2NjYyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCw4KSIgLz48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNmZmYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgsMCkiIC8+PC9zdmc+" } },
            generateHistogramSurface: function(a, b, c, e) {
                a = h.createSurface(a, b, c);
                d.set(a.rawNode, { overflow: "visible", display: "inline-block", left: e + "px" });
                a.rawNode.setAttribute("class", "esri-histogram-surface");
                return a
            },
            generateCountTooltips: function(b, d) {
                var g = [];
                b = a.map(b.bins, function(a) { return "object" === typeof a ? a.count : a });
                b.reverse();
                a.forEach(b, c.hitch(this, function(a, b) {
                    a = f.substitute(n.widgets.rendererSlider.count, { count: a });
                    g.push(new e({ connectId: [d.children[b].rawNode], label: a }))
                }));
                return g
            },
            generateHistogram: function(b,
                e, f, g, n) {
                var m = b.createGroup(),
                    p, r, v;
                m.rawNode.setAttribute("class", "esri-histogram-group");
                p = a.map(e.bins, function(a) { return "object" === typeof a ? a.count : a });
                p.reverse();
                r = b.getDimensions().height / p.length;
                a.forEach(p, c.hitch(this, function(a, b) {
                    v = 0 < a ? (f - this.histogramXAvgPadding) * (a / Math.max.apply(Math, p)) : 0;
                    a = m.createRect({ width: v, height: r }).setFill("#aaa").setTransform(h.matrix.translate(0, r * b));
                    a.rawNode.setAttribute("class", "esri-histogram-bar");
                    a.rawNode.setAttribute("shape-rendering", "crispEdges")
                }));
                d.set(b.rawNode, { display: "inline-block", left: g + "px" });
                n || m.setTransform({ dx: f, dy: 0, xx: -1, xy: 0, yx: 0, yy: 1 });
                return m
            },
            generateAvgLine: function(a, c, h, v, w, t, x) {
                if (null != c) {
                    var m = a.rawNode.getAttribute("width"),
                        p = a.rawNode.getAttribute("height");
                    h = Math.round(h);
                    var r;
                    r = a.createLine({ x1: w ? 0 : 12, y1: h, x2: w ? m - this.histogramXAvgPadding + 4 : m, y2: h }).setStroke({ color: "#667" }).moveToBack();
                    r.rawNode.setAttribute("shape-rendering", "crispEdges");
                    a = a.createImage({
                        x: w ? m - this.histogramXAvgPadding + 6 : 0,
                        y: h - 8,
                        width: 12,
                        height: 14,
                        src: require.toUrl("esri/dijit/RendererSlider/images/xAvg.png")
                    });
                    c = t ? b.formatDate(c, b.timelineDateFormatOptions) : x ? g.format(parseFloat(c.toFixed(2))).toString() + "%" : g.format(parseFloat(c.toFixed(2 > v ? 2 : v))).toString();
                    c = f.substitute(n.widgets.rendererSlider.statsAvg, { avg: c });
                    c = new e({ connectId: [a.rawNode], label: c });
                    h > p || 0 > h ? (d.set(r.rawNode, "display", "none"), d.set(a.rawNode, "display", "none")) : (d.set(r.rawNode, "display", "block"), d.set(a.rawNode, "display", "block"));
                    return {
                        avgHandleLine: r,
                        avgHandleImage: a,
                        avgHandleTooltip: c
                    }
                }
            },
            getCombinedPrecision: function(a, b) {
                var c = this.getPrecision(a),
                    d = this.getPrecision(b);
                return -10 < a && 10 > a && -10 < b && 10 > b && 2 > c && 2 > d ? 2 : c > d ? c : d
            },
            getPrecision: function(a) {
                for (var b = 1; Math.round(a * b) / b !== a;) b *= 10;
                a = Math.round(Math.log(b) / Math.LN10);
                return 20 < a ? 20 : a
            },
            _resetLabelPositions: function(b) {
                a.forEach(b, function(a) {
                    if (a) {
                        var b = a.labelNode;
                        b && (d.set(b, "top", "3px"), a.labelNode._autoPositioned = !1)
                    }
                })
            },
            _autoPositionHandleLabels: function(b) {
                var c = [];
                if (0 !== b.length && (this._resetLabelPositions(b),
                        a.forEach(b, function(a, b) { a && a.labelNode && c.push({ index: b, handle: a, label: a.labelNode, rect: a.labelNode.getBoundingClientRect() }) }), 0 !== c.length)) switch (c.length) {
                    case 1:
                        break;
                    case 2:
                        this._autoPositionTwoHandles(b, c);
                        break;
                    case 3:
                        this._autoPositionThreeHandles(b, c);
                        break;
                    default:
                        this._autoPositionManyHandles(b, c)
                }
            },
            _autoPositionTwoHandles: function(a, b) {
                var c;
                this.collisionCheck(b[0].rect, b[1].rect) && (a = b[0].rect.top - b[1].rect.top, c = (b[0].rect.height - a) / 2, a = this.labelTopOffset + c, c = this.labelTopOffset -
                    c, d.set(b[0].label, "top", a + "px"), d.set(b[1].label, "top", c + "px"), b[0].label._autoPositioned = !0, b[1].label._autoPositioned = !0)
            },
            _autoPositionThreeHandles: function(b, e) {
                var f, g, h, m, n, p;
                a.forEach(e, c.hitch(this, function(a, b) {
                    (b = e[b - 1]) && b.rect && this.collisionCheck(a.rect, b.rect) && (a.label._autoPositioned && !b.label._autoPositioned ? (f = b.rect.top - a.rect.top, h = a.rect.height, m = h - f + this.labelTopOffset, d.set(b.label, "top", m + "px"), b.label._autoPositioned = !0) : (!a.label._autoPositioned && b.label._autoPositioned ?
                        (f = b.rect.top - a.rect.top, h = a.rect.height, m = -1 * (h - f) + Number(b.label.style.top.replace("px", "")), d.set(a.label, "top", m + "px")) : (f = b.rect.top - a.rect.top, g = (a.rect.height - f) / 2, n = this.labelTopOffset - g, p = this.labelTopOffset + g, d.set(b.label, "top", p + "px"), d.set(a.label, "top", n + "px"), b.label._autoPositioned = !0), a.label._autoPositioned = !0))
                }));
                if (e[2].handle && 10 > e[2].handle.style.top.replace("px", "")) {
                    b = e[2].label;
                    var E = e[1].label,
                        G = e[0].label,
                        F = b.getBoundingClientRect(),
                        D = E.getBoundingClientRect(),
                        A = G.getBoundingClientRect(),
                        H;
                    b._autoPositioned && E._autoPositioned && G._autoPositioned ? (F = Number(b.style.top.replace("px", "")) + 8, D = Number(E.style.top.replace("px", "")) + 8, A = Number(G.style.top.replace("px", "")) + 8, d.set(b, "top", F + "px"), d.set(E, "top", D + "px"), d.set(G, "top", A + "px")) : (b._autoPositioned && (H = Number(b.style.top.replace("px", "")) + 4, d.set(b, "top", H + "px")), E._autoPositioned && D.top - F.top < D.height && (H = Number(E.style.top.replace("px", "")) + 4, d.set(E, "top", H + "px")), A.top - D.top < A.height && (H = Number(G.style.top.replace("px", "")) +
                        4, d.set(G, "top", H + "px")))
                }
            },
            _autoPositionManyHandles: function() {},
            collisionCheck: function(a, b) { return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom) }
        }
    })
}, "arcgisonline/map/dijit/renderer/_OpacityMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/Deferred dojo/dom dojo/dom-construct esri/lang esri/renderers/smartMapping esri/dijit/OpacitySlider".split(" "), function(b, g, n, a, c, d, f, e, h, m) {
        return {
            createAttributeTransparencySlider: function(a,
                b) {
                b || (b = new c, setTimeout(function() { b.progress(b) }, 1));
                this.destroyAttributeTransparencySlider();
                var d = this.getRendererDataRange("transparencyInfo");
                if (!a.statistics) return (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                    b.isRejected() || this.getOpacityInputBase(a, "statistics").then(g.hitch(this, function(c) {
                        (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics(c).then(g.hitch(this, function(c) {
                            b.isRejected() || (a.statistics = c, this.createAttributeTransparencySlider(a,
                                b))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getFieldStatistics", !1), b.reject()) }))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getOpacityInputBase", !1), b.reject()) }))
                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) })), b;
                this.displayZeroFeaturesMsg(a.statistics.count);
                this.onCalculationsSource(a.statistics);
                e.isDefined(a.statistics.count) && 0 === a.statistics.count || !e.isDefined(a.statistics.count) && null === a.statistics.min ?
                    (this.opacitySlider = new m({ statistics: a.statistics, opacityInfo: g.clone(a.opacityInfo), showHistogram: !1, minValue: d.min || 0, maxValue: d.max || 100, showLabel: !0, showTick: !0, isDate: this.isTypeDate(a.attributeItem) }, "rendererAttributeTransparencySlider"), this.opacitySlider.startup(), this.enableOpacitySliderChangeEvent(a), b.resolve(a.opacityInfo)) : this.getOpacityInputBase(a, "histogram").then(g.hitch(this, function(c) {
                        c = g.mixin(c, { minValue: d.min, maxValue: d.max });
                        this.getOpacityHistogram(c).then(g.hitch(this,
                            function(c) { b.isRejected() || (this.opacitySlider = new m({ statistics: a.statistics, opacityInfo: g.clone(a.opacityInfo), histogram: c, minValue: e.isDefined(d.min) ? d.min : a.statistics.min, maxValue: e.isDefined(d.max) ? d.max : a.statistics.max, showLabel: !0, showTick: !0, isDate: a.attributeItem ? this.isTypeDate(a.attributeItem) : !1 }, "rendererAttributeTransparencySlider"), this.opacitySlider.startup(), this.enableOpacitySliderChangeEvent(a), b.resolve(a.opacityInfo)) }), g.hitch(this, function(c) {
                            b.isRejected() || (this.opacitySlider =
                                new m({ statistics: a.statistics, opacityInfo: g.clone(a.opacityInfo), showHistogram: !1, minValue: e.isDefined(d.min) ? d.min : a.statistics.min, maxValue: e.isDefined(d.max) ? d.max : a.statistics.max, showLabel: !0, showTick: !0, isDate: this.isTypeDate(a.attributeItem) }, "rendererAttributeTransparencySlider"), this.opacitySlider.startup(), this.enableOpacitySliderChangeEvent(a), b.resolve(a.opacityInfo))
                        }))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getOpacityInputBase", !1), b.reject()) }));
                return b
            },
            zoomInOpacitySlider: function(a) {
                var b = new c;
                setTimeout(function() { b.progress(b) }, 1);
                a = a || {};
                var d = this.opacitySlider.get("statistics"),
                    f = this.opacitySlider.get("values"),
                    h = f[0].value,
                    f = f[1].value,
                    m = f - h,
                    n, p;
                d.min === d.max ? (n = h - m / 3, p = f + m / 3, h = n, d = p) : (n = Math.max(h - m / 3, Math.min(d.min, this.opacitySlider.minValue)), p = Math.min(f + m / 3, Math.max(d.max, this.opacitySlider.maxValue)), h = e.isDefined(a.minValue) ? a.minValue : Math.min(d.min, this.opacitySlider.minValue), d = e.isDefined(a.maxValue) ? a.maxValue : Math.max(d.max,
                    this.opacitySlider.maxValue));
                n === h && p === d ? b.reject() : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                    b.isRejected() || this.getOpacityInputBase(a, "histogram").then(g.hitch(this, function(c) {
                        c = g.mixin(c, { minValue: n, maxValue: p });
                        this.getOpacityHistogram(c).then(g.hitch(this, function(c) {
                            b.isRejected() || (this.onCalculationsSource(c), c = { histogram: c, minSliderValue: n, maxSliderValue: p }, this.disableOpacitySliderChangeEvent(), this.opacitySlider.set("zoomOptions",
                                c), setTimeout(g.hitch(this, function() { this.enableOpacitySliderChangeEvent(a) }), 1E3), b.resolve())
                        }), g.hitch(this, function(c) { b.isRejected() || (c = { histogram: null, minSliderValue: n, maxSliderValue: p }, this.disableOpacitySliderChangeEvent(), this.opacitySlider.set("zoomOptions", c), setTimeout(g.hitch(this, function() { this.enableOpacitySliderChangeEvent(a) }), 1E3), b.resolve()) }))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getOpacityInputBase", !1), b.reject()) }))
                }), g.hitch(this, function(a) {
                    b.isRejected() ||
                        (this.handleError(a, "addPlugin", !1), b.reject())
                }));
                return b
            },
            zoomOutOpacitySlider: function(a) {
                this.disableOpacitySliderChangeEvent();
                this.opacitySlider.set("zoomOptions", null);
                setTimeout(g.hitch(this, function(a) { this.enableOpacitySliderChangeEvent(a) }, a), 1E3)
            },
            updateAttributeTransparencySlider: function(a) { this.opacitySlider && this.opacitySlider.set("opacityInfo", g.clone(this.opacityInfo)) },
            enableOpacitySliderChangeEvent: function(a) {
                this.sliderZoomedHandler = this.opacitySlider.on("zoomed", g.hitch(this,
                    function(a) {!1 === a && this.clearZoom() }));
                this.sliderChangeHandler = this.opacitySlider.on("handle-value-change", g.hitch(this, function(a) { this.opacityInfo = a }));
                this.sliderChangeHandler2 = this.opacitySlider.on("data-value-change", g.hitch(this, function(a, b) {
                    this.authoringInfo = this.renderer.authoringInfo || {};
                    this.replaceVisualVariable("transparencyInfo", null, { type: "transparencyInfo", minSliderValue: b.minValue, maxSliderValue: b.maxValue }, this.authoringInfo);
                    this.getOpacityInputBase(a, "histogram").then(g.hitch(this,
                        function(c) {
                            c = g.mixin(c, { minValue: b.minValue, maxValue: b.maxValue });
                            this.getOpacityHistogram(c).then(g.hitch(this, function(a, b) {
                                this.onCalculationsSource(b);
                                this.disableOpacitySliderChangeEvent();
                                this.opacitySlider.set("histogram", b);
                                setTimeout(g.hitch(this, function() { this.enableOpacitySliderChangeEvent(a) }), 1E3)
                            }, a), g.hitch(this, function(a, b) {
                                this.handleError(b, "getHistogram", !1);
                                this.disableOpacitySliderChangeEvent();
                                this.opacitySlider.set("histogram", null);
                                setTimeout(g.hitch(this, function() { this.enableOpacitySliderChangeEvent(a) }),
                                    1E3)
                            }, a))
                        }), g.hitch(this, function(a) { deferred.isRejected() || (this.handleError(a, "getOpacityInputBase", !1), deferred.reject()) }))
                }, a))
            },
            disableOpacitySliderChangeEvent: function() {
                this.sliderChangeHandler && this.sliderChangeHandler.remove();
                this.sliderChangeHandler = null;
                this.sliderChangeHandler2 && this.sliderChangeHandler2.remove();
                this.sliderChangeHandler2 = null
            },
            destroyAttributeTransparencySlider: function() {
                this.opacitySlider && this.opacitySlider.destroy();
                d.byId("rendererAttributeTransparencySlider") ||
                    f.create("div", { id: "rendererAttributeTransparencySlider" }, d.byId("rendererAttributeTransparencySliderDiv"))
            },
            getOpacityHistogram: function(a) {
                var b = new c,
                    d = this.getRendererDataRange("transparencyInfo"),
                    f = e.isDefined(a.minValue) ? a.minValue : d.min,
                    h = e.isDefined(a.maxValue) ? a.maxValue : d.max;
                setTimeout(function() { b.progress(b) }, 1);
                this.histogramInfo && this.histogramInfo.field === a.field && this.histogramInfo.valueExpression === a.valueExpression && this.histogramInfo.normalizationType === a.normalizationType && this.histogramInfo.normalizationField ===
                    a.normalizationField && this.histogramInfo.sqlExpression === a.sqlExpression && this.histogramInfo.sqlWhere === a.sqlWhere && this.histogramInfo.minValue === f && this.histogramInfo.maxValue === h ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram(g.mixin(a, { numBins: this.numHistogramBins, classificationMethod: "equal-interval" })).then(g.hitch(this, function(c) {
                            b.isRejected() ||
                                (this.histogramInfo = { histogram: c, field: a.field, valueExpression: a.valueExpression, normalizationType: a.normalizationType, normalizationField: a.normalizationField, sqlExpression: a.sqlExpression, sqlWhere: a.sqlWhere, minValue: f, maxValue: h }, b.resolve(c))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getOpacityHistogram", !1), b.reject()) }))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                return b
            },
            getOpacityInfo: function() {
                return this.getVisualVariableByType("opacityInfo",
                    null, this.renderer.visualVariables)
            },
            getOpacityInputBase: function(b, d) {
                var e = new c;
                if (-1 < a.indexOf(["predominance", "predominancesize"], this.getRendererStyle(this.renderer))) {
                    this.savedExpressions = this.savedExpressions || {};
                    var f = "";
                    dojo.forEach(this.renderer.authoringInfo.fields, function(a) { f += a + "--" });
                    this.savedExpressions[f] ? "statistics" === d ? e.resolve(this.savedExpressions[f].opacity.statisticsQuery) : e.resolve(this.savedExpressions[f].opacity.histogramQuery) : (this.fLayer || this.layer).statisticsPlugin.getPredominanceExpressions({ fields: this.renderer.authoringInfo.fields }).then(g.hitch(this,
                        function(a) { "statistics" === d ? (a.opacity.statisticsQuery.valueExpression = a.opacity.valueExpression, e.resolve(a.opacity.statisticsQuery)) : (a.opacity.histogramQuery.valueExpression = a.opacity.valueExpression, e.resolve(a.opacity.histogramQuery)) }), function(a) { e.reject(a) })
                } else e.resolve({ field: b.opacityInfo.field, valueExpression: b.opacityInfo.valueExpression, normalizationField: b.opacityInfo.normalizationField, normalizationType: b.opacityInfo.normalizationField ? "field" : null });
                return e
            }
        }
    })
}, "arcgisonline/map/dijit/renderer/UniqueValuesGrid": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/on dojo/dom dojo/query dojo/mouse dojo/has dojo/topic dojo/string dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/form/Button dijit/form/CheckBox dijit/Tooltip esri/symbols/jsonUtils esri/styles/type esri/styles/predominance esri/lang dgrid/OnDemandGrid dgrid/Selection dgrid/editor dgrid/extensions/DnD dojo/dnd/Source dojo/dnd/Manager dojo/dnd/Avatar dojo/store/Memory dojo/store/Observable arcgisonline/map/dijit/renderer/_UniqueValuesMixin arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/registry".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y) {
            c = b([N], {
                declaredClass: "arcgisonline.map.dijit.renderer.UniqueValuesGrid",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGOUniqueValuesGrid",
                i18n: null,
                id: "",
                grid: null,
                lastDefaultLabel: null,
                lastDefaultSymbol: null,
                ordersList: null,
                didDragFromSource: !1,
                symbolButton: null,
                otherCheckBox: null,
                scrollPos: 0,
                batchCount: 205,
                tooltips: [],
                headerTooltips: [],
                constructor: function(a, b) {
                    g.mixin(this, U);
                    g.mixin(this,
                        C);
                    g.mixin(this, V);
                    null != a && (a.id && (this.id = a.id), a.renderer && (this.renderer = a.renderer), a.allUniqueValues && (this.allUniqueValues = a.allUniqueValues), this.hasUniqueValuesCount = this.allUniqueValues && this.allUniqueValues.length && H.isDefined(this.allUniqueValues[0].count), a.style && (this.style = a.style), a.onSymbolClick && (this.onSymbolClick = a.onSymbolClick), a.onLabelClick && (this.onLabelClick = a.onLabelClick), a.defaultInfo && (this.defaultInfo = a.defaultInfo), a.backgroundSymbol && (this.backgroundSymbol = a.backgroundSymbol),
                        a.params && g.mixin(this, a.params))
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(X.common);
                    g.mixin(this.i18n, X.rendererUniqueValuesPanel)
                },
                postCreate: function() { this.createGrid() },
                destroy: function() {
                    this.onRendererItemChangeHandler && p.unsubscribe(this.onRendererItemChangeHandler);
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this.headerTooltips, function(a) { a.destroy() });
                    this.grid && (delete this.store, this.grid.destroy(), delete this.grid);
                    this.inherited(arguments)
                },
                resize: function() {
                    e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px");
                    this.adjustButtonColumn();
                    this.grid.resize()
                },
                adjustButtonColumn: function() { this.isRelationshipStyle || (100 > e(".labelCell").style("width")[0] ? (w.set(this.changeSymbolsText, "display", "none"), this.ungroupText && w.set(this.ungroupText, "display", "none")) : (w.set(this.changeSymbolsText, "display", ""), this.ungroupText && w.set(this.ungroupText, "display", ""))) },
                hide: function() {},
                updateGrid: function(a) {
                    a.attributeField2 = this.renderer.attributeField2;
                    this.renderer = a;
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    this.hideMsgs();
                    this.getData();
                    this.store = W(new S({
                        data: this.data,
                        idProperty: "id",
                        put: g.partial(this.observerPutHandler, this),
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "order" }];
                            return S.prototype.query.call(this, a, b)
                        }
                    }));
                    this.scrollPos = this.grid.bodyNode.scrollTop;
                    this.grid.set("store", this.store)
                },
                createGrid: function() {
                    this.isPredomStyle = -1 < dojo.indexOf(["predominance", "predominancesize"], this.getRendererStyle(this.renderer));
                    this.isRelationshipStyle = -1 < dojo.indexOf(["relationship", "relationshipSize"], this.getRendererStyle(this.renderer));
                    this.parentNodeId = "renderer-unique-main";
                    this.isPredomStyle ? this.parentNodeId = "renderer-predominance-main" : this.isRelationshipStyle && (this.parentNodeId = "renderer-relationship-legend-content");
                    this.grid ? (n.forEach(this.tooltips, function(a) { a.destroy() }), n.forEach(this.headerTooltips, function(a) { a.destroy() }), this.scrollPos = this.grid.bodyNode.scrollTop, delete this.store, this.grid.destroy(),
                        delete this.grid) : this.scrollPos = 0;
                    f.byId("_" + this.id) || t.create("div", { id: "_" + this.id }, this.domNode);
                    this.maxSymbolWidth = 30;
                    this.getData();
                    this.getColumns();
                    this.store = W(new S({
                        data: this.data,
                        idProperty: "id",
                        put: g.partial(this.observerPutHandler, this),
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "order" }];
                            return S.prototype.query.call(this, a, b)
                        }
                    }));
                    this.grid = new(b([J, L, K]))({
                        store: this.store,
                        selectionMode: "single",
                        columns: this.columns,
                        style: this.style ? this.style : "width: 200px;",
                        sort: [{ attribute: "order" }],
                        minRowsPerPage: this.batchCount,
                        maxRowsPerPage: this.batchCount,
                        showHeader: !0,
                        dndParams: { withHandles: !0 }
                    }, "_" + this.id);
                    this.onDndStartHandler && a.disconnect(this.onDndStartHandler);
                    this.onMouseMoveHandler && a.disconnect(this.onMouseMoveHandler);
                    this.onDndCancelHandler && a.disconnect(this.onDndCancelHandler);
                    this.onDndStartHandler = a.connect(this.grid.dndSource, "onDndStart", g.hitch(this, "handleDragStart"));
                    this.onMouseMoveHandler = a.connect(this.grid.dndSource, "onMouseMove", g.hitch(this, "handleDragMove"));
                    this.onDndCancelHandler = a.connect(this.grid.dndSource, "onDndCancel", g.hitch(this, "handleDragEnd"));
                    this.grid.on("dgrid-editor-hide", g.hitch(this, function(a) { this.handleLabelChange(a.cell.row.data, a.editor.value) }));
                    this.grid.on("dgrid-error", g.hitch(this, function(a) {}));
                    this.grid.on("dgrid-refresh-complete", g.hitch(this, function(a) {
                        this.grid.scrollTo({ y: this.scrollPos });
                        this.displayMsgs();
                        e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px");
                        this.adjustButtonColumn()
                    }));
                    this.resize()
                },
                getColumns: function() {
                    this.columns = {};
                    this.isRelationshipStyle || (this.columns.check = {
                        className: "checkCell",
                        field: "check",
                        label: "",
                        sortable: !1,
                        renderCell: g.hitch(this, function(a, b, c, d) {
                            if ("otherCategory" === a.type) return a = t.create("div", {}, c), this.otherCheckBox = new E({ checked: this.renderer.defaultSymbol ? !0 : !1, onChange: g.hitch(this, "onOtherCheckChange") }, a), this.otherCheckBox.startup(), this.tooltips.push(new G({ connectId: [this.otherCheckBox.domNode], label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.otherTooltip + "\x3c/div\x3e" })),
                                a;
                            if (!a.type) return v.add(c, "dojoDndHandle"), a = t.create("div", { "class": "dndIcon esriFloatTrailing" })
                        })
                    });
                    this.columns.symbol = {
                        className: "symbolCell",
                        field: "symbol",
                        label: "",
                        sortable: !1,
                        renderCell: g.hitch(this, function(a, b, c, e) {
                            if (b) {
                                var f = t.create("div", { style: "width:" + a.symbolSize.width + "px;height:" + a.symbolSize.height + "px;", "class": "symbol" });
                                d(c, "click", g.hitch(this, function(a) {
                                    this.didDragFromSource || (this.grid.clearSelection && this.grid.clearSelection(), this.grid.dndSource && this.grid.dndSource.selectNone(),
                                        this.onRowClickSymbolHandler(a))
                                }, a));
                                this.tooltips.push(new G({ connectId: [f], label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.oneSymbolTooltip + "\x3c/div\x3e" }));
                                9 > m("ie") ? setTimeout(g.hitch(this, function(a, b, c) { this.isSymbolTransparent(b) ? this.drawTransparentSymbol(a) : (this.drawSymbol(a, b, c.symbolSize.width, c.symbolSize.height, null, 1), this.updateBackgroundForAlmostWhite(b, a)) }, f, b, a), 100) : this.isSymbolTransparent(b) ? this.drawTransparentSymbol(f) : (this.drawSymbol(f, b, a.symbolSize.width, a.symbolSize.height,
                                    null, 1), this.updateBackgroundForAlmostWhite(b, f))
                            }
                            return f
                        })
                    };
                    this.columns.label = M({
                        className: "labelCell",
                        field: "label",
                        name: this.i18n.labelTitle,
                        label: this.i18n.labelTitle,
                        sortable: !1,
                        canEdit: g.hitch(this, function(a) { if (this.isRelationshipStyle) { if (!a.type) { if (-1 < n.indexOf(["HH", "LH", "HL", "LL"], a.value)) return !0 } else if ("otherCategory" === a.type) return !0; return !1 } return !a.type || "otherCategory" === a.type }),
                        renderCell: g.hitch(this, function(a, b, c, d) {
                            return "otherCategory" === a.type ? a = t.create("span", {
                                innerHTML: x.encode(a.label),
                                "class": "otherCategory"
                            }) : "other" === a.type ? (b = t.create("div", {}), t.create("span", { innerHTML: x.encode(a.label), "class": "other" }, b), b) : "otherNoData" === a.type ? a = t.create("span", { innerHTML: x.encode(a.label), "class": "otherNoData" }) : this.isRelationshipStyle ? -1 < n.indexOf(["HH", "LH", "HL", "LL"], a.value) ? a = t.create("span", { innerHTML: x.encode(a.label), "class": "info" }) : "" : a = t.create("span", { innerHTML: x.encode(a.label), "class": "info" })
                        })
                    }, "text", "click");
                    if (this.hasUniqueValuesCount || 1 === this.data.length) this.columns.count = { className: "countCell", field: "count", label: this.i18n.countTitle, sortable: !1, renderHeaderCell: g.hitch(this, function(a) { return t.create("span", { innerHTML: this.i18n.countTitle, "class": "countHeader" }, a) }), renderCell: g.hitch(this, function(a, b, c, d) { return "other" === a.type ? t.create("span", { innerHTML: a.count || 0, "class": "other" }) : "otherNoData" === a.type ? t.create("span", { innerHTML: a.count || 0, "class": "otherNoData" }) : t.create("span", { innerHTML: a.count || 0 }) }) };
                    this.isRelationshipStyle || (this.columns.button = {
                        className: "buttonCell",
                        field: "button",
                        label: "",
                        sortable: !1,
                        renderCell: g.hitch(this, function(a, b, c, e) {
                            if ("otherCategory" === a.type && this.allUniqueValues && !this.isPredomStyle && !this.renderer.attributeField2) {
                                b = t.create("div", {}, c);
                                a = t.create("table", { cellpadding: 0, cellspacing: 0, style: "padding: 0 5px;" }, b);
                                e = t.create("tbody", {}, a);
                                e = t.create("tr", {}, e);
                                var f = t.create("td", {}, e);
                                t.create("div", { click: g.hitch(this, "handleUngroupClick"), "class": "ungroupIcon", style: 1 < this.data.length ? "cursor: pointer;" : "" }, f);
                                f = t.create("td", {},
                                    e);
                                this.ungroupText = t.create("div", { click: g.hitch(this, "handleUngroupClick"), innerHTML: this.i18n.ungroup, style: "padding:0 5px;" + (1 < this.data.length ? "color: #21759B;cursor: pointer;" : "color: #909090") }, f);
                                this.tooltips.push(new G({ connectId: [a], label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.ungroupTooltip + "\x3c/div\x3e" }));
                                return b
                            }
                            "other" !== a.type || this.isPredomStyle || (b = t.create("div", { style: "padding:0 5px;" }, c), b = t.create("div", { "class": "othersArrowIcon", style: "cursor: pointer;" }, b), d(b,
                                "click", g.hitch(this, function(a) { if (!this.didDragFromSource) return this.grid.clearSelection && this.grid.clearSelection(), this.grid.dndSource && this.grid.dndSource.selectNone(), this.onRowClickArrowHandler(a, c), !1 }, a)), this.tooltips.push(new G({ connectId: [b], label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.arrowTooltip + "\x3c/div\x3e" })))
                        }),
                        renderHeaderCell: g.hitch(this, function(a) {
                            a = t.create("div", {}, a);
                            var b = t.create("table", { cellpadding: 0, cellspacing: 0, style: "padding: 0 5px;" }, a),
                                c = t.create("tbody", {}, b),
                                c = t.create("tr", {}, c),
                                d = t.create("td", {}, c);
                            t.create("div", { click: g.hitch(this, "handleChangeSymbols"), "class": "styleIcon", style: 1 < this.data.length ? "cursor: pointer;" : "" }, d);
                            d = t.create("td", {}, c);
                            this.changeSymbolsText = t.create("div", { click: g.hitch(this, "handleChangeSymbols"), innerHTML: this.i18n.symbols, style: "padding:0 5px;" + (1 < this.data.length ? "color: #21759B;cursor: pointer;" : "color: #909090") }, d);
                            this.headerTooltips.push(new G({
                                connectId: [b],
                                label: "\x3cdiv class\x3d'rendererTooltip'\x3e" +
                                    this.i18n.symbolsTooltip + "\x3c/div\x3e"
                            }));
                            return a
                        })
                    })
                },
                getData: function() {
                    var a = this.allUniqueValues ? g.clone(this.allUniqueValues) : [];
                    this.data = n.map(this.renderer.infos, function(b, c) {
                        var d, e;
                        for (e = 0; e < a.length; e++)
                            if (b.value == a[e].value) {
                                d = a[e].count;
                                a.splice(e, 1);
                                break
                            }
                        e = this._calcSymbolWidthHeight(b.symbol);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, e.width);
                        return { symbol: b.symbol, symbolSize: e, label: b.label, value: b.value, count: d, id: c, order: c + 1 }
                    }, this);
                    if (!this.isRelationshipStyle) {
                        this.portalPanel.lastUniqueDefaultSymbol &&
                            this.portalPanel.lastUniqueDefaultLabel || (this.renderer.defaultSymbol && this.renderer.defaultLabel ? (this.portalPanel.lastUniqueDefaultSymbol = F.fromJson(this.renderer.defaultSymbol.toJson()), this.portalPanel.lastUniqueDefaultLabel = this.renderer.defaultLabel) : this.defaultInfo ? (this.portalPanel.lastUniqueDefaultSymbol = F.fromJson(this.defaultInfo.defaultSymbol.toJson()), this.portalPanel.lastUniqueDefaultLabel = this.defaultInfo.defaultLabel) : (this.portalPanel.lastUniqueDefaultSymbol = this.getDefaultSymbol(this.geometryType),
                                this.portalPanel.lastUniqueDefaultLabel = this.i18n.others));
                        var b = this.portalPanel.lastUniqueDefaultSymbol,
                            c = this._calcSymbolWidthHeight(b);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, c.width);
                        b = { type: "otherCategory", symbol: b, symbolSize: c, label: this.renderer.defaultLabel || this.portalPanel.lastUniqueDefaultLabel || this.i18n.other, value: "other", id: this.renderer.infos.length, order: this.renderer.infos.length + 1, count: 0 };
                        this.data.push(b)
                    }
                    var d = 0;
                    this.hasUniqueValuesCount && (n.forEach(a, function(a, b) {
                        d +=
                            a.count
                    }), b.count = d);
                    a.length + this.data.length - 1 > this.maxCount && (a = a.slice(0, this.maxCount - (this.data.length - 1)));
                    var e = this.data.length,
                        f = 0,
                        a = n.filter(a, function(a, b) { return null === a.value ? (this.hasUniqueValuesCount && (f += a.count), !1) : !0 }, this);
                    this.renderer.attributeField2 || (b = n.map(a, function(a, b) { return { type: "other", label: a.label, value: a.value, count: a.count, id: b + e, order: b + 1 + e } }), this.data = this.data.concat(b), f && this.data.push({
                        type: "otherNoData",
                        label: this.i18n.noData,
                        value: null,
                        count: f,
                        id: this.data.length,
                        order: this.data.length + 1
                    }))
                },
                handleDragStart: function(a, b, c) {
                    if ("rendererUniqueValuesStack" === leftPanel.visibleStack || "rendererPredominanceStack" === leftPanel.visibleStack)
                        if (this.sourceItem = this.grid.row(b[0]).data, "otherCategory" === this.sourceItem.type || "other" === this.sourceItem.type) p.publish("/dnd/cancel"), O.manager().stopDrag(), this.grid.clearSelection(), this.grid.dndSource.selectNone();
                        else return this.ordersList = n.map(this.data, function(a) { return a.order }), this.ordersList = this.ordersList.sort(function(a,
                            b) { return a - b }), this.sourceOrdersPos = n.indexOf(this.ordersList, this.sourceItem.order), this.didDragFromSource = !1, R.prototype._generateText = g.partial(function(a) { return "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + x.encode(a) + "\x26nbsp;\x26nbsp;" }, this.sourceItem.label), O.manager().updateAvatar(), !0
                },
                handleDragMove: function(a) {
                    if (("rendererUniqueValuesStack" === leftPanel.visibleStack || "rendererPredominanceStack" === leftPanel.visibleStack) && this.sourceItem) {
                        var b = function() {
                            9 > m("ie") && !0 !== O.manager().canDropFlag &&
                                O.manager().avatar && (O.manager().canDropFlag = !0, v.toggle(O.manager().avatar, "dojoDndAvatarCanDrop", O.manager().canDropFlag), O.manager().updateAvatar())
                        };
                        a = function() {!1 !== O.manager().canDropFlag && (O.manager().canDropFlag = !1, v.toggle(O.manager().avatar, "dojoDndAvatarCanDrop", O.manager().canDropFlag), O.manager().updateAvatar()) };
                        e(".canDragBefore", f.byId(this.parentNodeId)).forEach(function(a) { v.remove(a, "canDragBefore") });
                        e(".canDragAfter", f.byId(this.parentNodeId)).forEach(function(a) {
                            v.remove(a,
                                "canDragAfter")
                        });
                        var c = !0;
                        if (this.grid.dndSource.current) {
                            var d = this.grid.row(this.grid.dndSource.current).data;
                            this.didDragFromSource || d.id === this.sourceItem.id || (this.didDragFromSource = !0);
                            if (this.ordersList[this.sourceOrdersPos] == d.order) a(), c = !1;
                            else if (this.isPredomStyle && d.order >= this.ordersList[this.ordersList.length - 2])
                                if (this.ordersList[this.ordersList.length - 1] == d.order) a(), c = !1;
                                else {
                                    var g = e(".dojoDndItemAfter", f.byId(this.parentNodeId));
                                    g.length ? (a(), c = !1) : this.sourceOrdersPos < this.ordersList.length -
                                        1 && this.ordersList[this.sourceOrdersPos + 1] == d.order && (g = e(".dojoDndItemBefore", f.byId(this.parentNodeId)), g.length ? (a(), c = !1) : b())
                                }
                            else this.sourceOrdersPos < this.ordersList.length - 1 && this.ordersList[this.sourceOrdersPos + 1] == d.order ? (g = e(".dojoDndItemBefore", f.byId(this.parentNodeId)), g.length ? (a(), c = !1) : b()) : 0 < this.sourceOrdersPos && this.ordersList[this.sourceOrdersPos - 1] == d.order ? (g = e(".dojoDndItemAfter", f.byId(this.parentNodeId)), g.length ? (a(), c = !1) : b()) : b();
                            c && b()
                        } else this.isPredomStyle ? (a(), c = !1) : n.forEach(this.data, function(a, c) { b() }, this);
                        c && (g = e(".dojoDndItemBefore", f.byId(this.parentNodeId)), g.length && v.add(g[0], "canDragBefore"), g = e(".dojoDndItemAfter", f.byId(this.parentNodeId)), g.length && v.add(g[0], "canDragAfter"))
                    }
                },
                handleDragEnd: function(a, b, c, d) {
                    if ("rendererUniqueValuesStack" === leftPanel.visibleStack || "rendererPredominanceStack" === leftPanel.visibleStack) {
                        e(".canDragBefore", f.byId(this.parentNodeId)).forEach(function(a) { v.remove(a, "canDragBefore") });
                        e(".canDragAfter", f.byId(this.parentNodeId)).forEach(function(a) {
                            v.remove(a,
                                "canDragAfter")
                        });
                        var h = 0;
                        n.forEach(this.data, function(a) { "otherCategory" === a.type && (h = a.order) });
                        if (this.sourceItem.order > h) {
                            n.forEach(this.data, function(a) { a.id === this.sourceItem.id && (a.type = "other", delete a.symbol, delete a.symbolSize) }, this);
                            b = !1;
                            for (a = 0; a < this.data.length; a++)
                                if (!this.data[a].type) { b = !0; break }
                            b || this.otherCheckBox.set("checked", !0)
                        }
                        this.ordersList = this.sourceOrdersPos = this.sourceItem = null;
                        setTimeout(g.hitch(this, function() { this.didDragFromSource = !1 }), 1E3);
                        this.orderRendererInfos()
                    }
                },
                handleUngroupClick: function() { a.publish("onUngroupUniqueValues") },
                onRowClickArrowHandler: function(a, b) {
                    n.forEach(this.data, function(b) { b.id === a.id && delete b.type }, this);
                    this.orderRendererInfos()
                },
                orderRendererInfos: function() {
                    var b = n.filter(this.data, function(a) { return !a.type }),
                        b = b.sort(function(a, b) {
                            a = a.order;
                            b = b.order;
                            return a == b ? 0 : a < b ? -1 : 1
                        }),
                        b = n.map(b, function(a) { return { value: a.value, label: a.label, symbol: a.symbol } }),
                        c = null;
                    this.otherCheckBox.checked && n.forEach(this.data, function(a) {
                        "otherCategory" ===
                        a.type && (c = { label: a.label, symbol: a.symbol })
                    }, this);
                    a.publish("onReorderUniqueValues", [b, c])
                },
                handleChangeSymbols: function() {
                    if (1 !== this.data.length) {
                        var a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType),
                            b;
                        b = this.isPredomStyle ? A.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType, numColors: this.renderer.infos ? this.renderer.infos.length : 10 }) : D.getSchemes({
                            theme: "default",
                            basemap: this.getBasemapType(),
                            geometryType: this.geometryType
                        });
                        for (var c = [], d = !1, e = 0; e < this.renderer.infos.length; e++)
                            if ("picturemarkersymbol" !== this.renderer.infos[e].symbol.type && (d = !0), 12 > e) c.push(this.getSymbolColor(this.renderer.infos[e].symbol));
                            else break;
                        if (!d) c = g.clone(b.primaryScheme.colors), a = this.getDefaultSymbol(this.geometryType);
                        else if ("picturemarkersymbol" === a.type) {
                            for (e = 1; e < this.renderer.infos.length; e++)
                                if ("picturemarkersymbol" !== this.renderer.infos[e].symbol.type) { a = this.renderer.infos[e].symbol; break }
                                "picturemarkersymbol" ===
                            a.type && (a = this.getDefaultSymbol(this.geometryType))
                        }
                        this.isPredomStyle && (b.primaryScheme.colors.length = c.length, dojo.forEach(b.secondarySchemes, function(a) { a.colors.length = c.length }));
                        c = c.reverse();
                        b.primaryScheme.colors.reverse();
                        n.forEach(b.secondarySchemes, function(a) { a.colors = a.colors.reverse() });
                        d = null;
                        "uniquesize" === this.getRendererStyle(this.renderer) && (d = { symbolDisplayMode: "default" });
                        this.showSymbolStyler(a, {
                            externalSizing: -1 < dojo.indexOf(["uniquesize", "predominancesize"], this.getRendererStyle(this.renderer)) ?
                                !0 : !1,
                            optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                            schemes: b,
                            tabOptions: d,
                            colorRamp: { colors: c, numStops: c.length, scheme: this.scheme }
                        }, g.hitch(this, "onSymbolsChange"))
                    }
                },
                onSymbolsChange: function(b, c, d, e) {
                    if (b && c) {
                        c = c.reverse();
                        var f = b.toJson();
                        "esriPMS" != b.type || 0 != f.url.length && "http://" != f.url || (b = F.fromJson(this.getMarkerJson()));
                        var h = [];
                        n.forEach(this.renderer.infos, function(a) { h.push(g.clone(a)) });
                        n.forEach(h, function(a) { this.renderer.removeValue(a.value) }, this);
                        n.forEach(h,
                            function(a, d) {
                                d = this.applyColorToSymbol(F.fromJson(b.toJson()), dojo.clone(c[d % 12]));
                                this.renderer.addValue({ value: a.value, symbol: d, label: a.label || a.value })
                            }, this);
                        a.publish("onUpdateUniqueValueSymbols", [c, d, e])
                    }
                },
                handleLabelChange: function(b, c) {
                    b.label = c.length || this.isRelationshipStyle ? c : this.getLabel(b.value);
                    n.forEach(this.data, function(a) { b.id == a.id && (a.label = b.label) }, this);
                    a.publish("onUpdateUniqueValue", [{ symbol: b.symbol, value: "otherCategory" === b.type ? null : b.value, label: b.label }])
                },
                onOtherCheckChange: function(b) {
                    if (b) n.forEach(this.data,
                        function(b) { "otherCategory" === b.type && a.publish("onUpdateUniqueValueDefault", [{ symbol: b.symbol, label: b.label }]) });
                    else {
                        var c = !1;
                        for (b = 0; b < this.data.length; b++)
                            if (!this.data[b].type) { c = !0; break }
                        c ? (this.portalPanel.lastUniqueDefaultSymbol = F.fromJson(this.renderer.defaultSymbol.toJson()), this.portalPanel.lastUniqueDefaultLabel = this.renderer.defaultLabel, a.publish("onUpdateUniqueValueDefault", [null])) : this.otherCheckBox.set("checked", !0)
                    }
                },
                onRowClickSymbolHandler: function(a, b) {
                    b = D.getSchemes({
                        theme: "default",
                        basemap: this.getBasemapType(),
                        geometryType: this.geometryType
                    });
                    var c = !1; - 1 < dojo.indexOf(["uniquesize", "predominancesize"], this.getRendererStyle(this.renderer)) && "otherCategory" !== a.type && (c = !0);
                    this.showSymbolStyler(a.symbol, { externalSizing: c, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: b, activeTab: "fill" }, g.hitch(this, "onSymbolChange", a))
                },
                onSymbolChange: function(b, c, d, e, f) {
                    d = this._calcSymbolWidthHeight(c);
                    var h = { symbol: c, symbolSize: d, label: b.label };
                    n.forEach(this.data,
                        function(a) { b.id == a.id && (a = g.mixin(a, h), this.store.put(a)) }, this);
                    this.maxSymbolWidth = this._calcTotalSymbolWidthHeight().width;
                    "otherCategory" === b.type ? (d = { symbol: c, label: b.label }, this.portalPanel.lastUniqueDefaultSymbol = F.fromJson(c.toJson()), a.publish("onUpdateUniqueValueDefault", [d, f])) : (d = { symbol: c, value: b.value, label: b.label }, a.publish("onUpdateUniqueValue", [d, f]))
                },
                observerPutHandler: function(a, b, c) {
                    c && a.ordersList && (c.before ? n.forEach(a.ordersList, function(d, e) {
                        d === c.before.order && (b.order =
                            0 === e ? d / 2 : (d + a.ordersList[e - 1]) / 2)
                    }, this) : b.order = a.ordersList[a.ordersList.length - 1] + 1);
                    return S.prototype.put.call(this, b, c)
                },
                displayMsgs: function() { this.allUniqueValues && this.allUniqueValues.length > this.maxCount ? this.displayMsg(r.substitute(this.i18n.tooManyValues, { count: this.maxCount })) : 1 === this.data.length && this.displayMsg(r.substitute(this.i18n.noFeatures, { other: this.portalPanel.lastUniqueDefaultLabel })) },
                displayMsg: function(a) {
                    var b = e(".dgrid-preload")[1],
                        b = t.create("div", { "class": "footerMsgDiv" },
                            b, "after");
                    t.create("span", { innerHTML: a, "class": "footerMsg" }, b)
                },
                hideMsgs: function(a) { e(".dgrid-preload").forEach(t.empty) }
            });
            g.setObject("arcgisonline.map.dijit.renderer.UniqueValuesGrid", c);
            return c
        })
}, "dgrid/extensions/DnD": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/on dojo/topic dojo/has dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList put-selector/put ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll xstyle/css!dojo/resources/dnd.css".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w) {
            var t = b(h, {
                grid: null,
                getObject: function(a) { var b = this.grid; return b.store.get(a.id.slice(b.id.length + 5)) },
                _legalMouseDown: function(a) { return this.inherited(arguments) && a.target != this.grid.bodyNode },
                onDrop: function(b, c, d) {
                    var e = this,
                        f = this._targetAnchor = this.targetAnchor,
                        g = this.grid,
                        h = g.store;
                    !this.before && f && (f = f.nextSibling);
                    f = f && g.row(f);
                    a.when(f && h.get(f.id), function(a) {
                        if (e != b) e.onDropExternal(b, c, d, a);
                        else e.onDropInternal(c, d, a)
                    })
                },
                onDropInternal: function(b,
                    c, d) {
                    var e = this.grid,
                        f = e.store,
                        g = this,
                        h = g._targetAnchor,
                        m;
                    h && (m = this.before ? h.previousSibling : h.nextSibling);
                    h = e.row(b[0]);
                    (c || m !== b[0] && (d || !h || e.down(h).element != b[0])) && b.forEach(function(b) {
                        a.when(g.getObject(b), function(a) {
                            var b = f.getIdentity(a);
                            f[c && f.copy ? "copy" : "put"](a, { before: d });
                            g._selectedNodes[b] && (g._selectedNodes[b] = e.row(b).element)
                        })
                    })
                },
                onDropExternal: function(b, c, d, e) {
                    var f = this.grid.store,
                        g = b.grid;
                    c.forEach(function(c, h) {
                        a.when(b.getObject(c), function(m) {
                            d || (g ? a.when(g.store.getIdentity(m),
                                function(a) {
                                    !h && b.selectNone();
                                    b.delItem(c.id);
                                    g.store.remove(a)
                                }) : b.deleteSelectedNodes());
                            f[f.copy ? "copy" : "put"](m, { before: e })
                        })
                    })
                },
                onDndStart: function(a, b, c) {
                    this.inherited(arguments);
                    a == this && (this.grid.cancelTouchScroll && this.grid.cancelTouchScroll(), m.manager().avatar.node.style.width = this.grid.domNode.offsetWidth / 2 + "px")
                },
                onMouseDown: function(a) { e("touch") && this.isDragging && 1 < w.countCurrentTouches(a, this.grid.touchNode) ? (f.publish("/dnd/cancel"), m.manager().stopDrag()) : this.inherited(arguments) },
                onMouseMove: function(a) {
                    (!e("touch") || 1 >= w.countCurrentTouches(a, this.grid.touchNode)) && this.inherited(arguments)
                },
                checkAcceptance: function(a, b) { return a.getObject && h.prototype.checkAcceptance.apply(this, arguments) },
                getSelectedNodes: function() {
                    if (!this.grid.selection) return this.inherited(arguments);
                    var a = new p,
                        b;
                    for (b in this.grid.selection) a.push(this._selectedNodes[b]);
                    return a
                }
            });
            b = b("dgrid.extensions.DnD", v, {
                dndSourceType: "dgrid-row",
                dndParams: null,
                dndConstructor: t,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.dndParams = g.mixin({ accept: [this.dndSourceType] }, this.dndParams)
                },
                postCreate: function() {
                    function a(a) { d[a.id] = a.element }

                    function b(a) {
                        delete d[a.id];
                        r(a.element, "!dojoDndItemSelected!dojoDndItemAnchor")
                    }
                    this.inherited(arguments);
                    this.dndSource = new(this.dndConstructor || t)(this.bodyNode, g.mixin(this.dndParams, { grid: this, dropParent: this.contentNode }));
                    var d = this.dndSource._selectedNodes = {};
                    this.on("dgrid-select", function(b) { n.forEach(b.rows, a) });
                    this.on("dgrid-deselect", function(a) {
                        n.forEach(a.rows,
                            b)
                    });
                    c.after(this, "destroy", function() {
                        delete this.dndSource._selectedNodes;
                        d = null;
                        this.dndSource.destroy()
                    }, !0)
                },
                insertRow: function(a) {
                    var b = this.inherited(arguments),
                        c = "function" == typeof this.getObjectDndType ? this.getObjectDndType(a) : [this.dndSourceType];
                    r(b, ".dojoDndItem");
                    this.dndSource.setItem(b.id, { data: a, type: c instanceof Array ? c : [c] });
                    return b
                },
                removeRow: function(a) {
                    this.dndSource.delItem(this.row(a));
                    this.inherited(arguments)
                }
            });
            b.GridSource = t;
            return b
        })
}, "arcgisonline/map/dijit/renderer/AttributeTransparencyDlg": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/has dijit/_Widget dijit/_Templated".split(" "),
        function(b, g, n, a, c, d) {
            b = g([c, d], { declaredClass: "arcgisonline.map.dijit.renderer.AttributeTransparencyDlg", basePath: b.toUrl("arcgisonline/map/renderer"), widgetsInTemplate: !1, templateString: "\x3cdiv\x3e\x3c/div\x3e" });
            n.setObject("arcgisonline.map.dijit.renderer.AttributeTransparencyDlg", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/AttributeTransparency": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/Evented dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dijit/registry dijit/TooltipDialog dijit/Tooltip dojo/store/Memory esri/renderers/smartMapping esri/lang esri/symbols/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_UniqueValuesMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/AttributeTransparency.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R) {
            b = b([P, O], {
                declaredClass: "arcgisonline.map.dijit.renderer.AttributeTransparency",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGOAttributeTransparency",
                widgetsInTemplate: !0,
                templateString: R,
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                origPanelRenderer: null,
                tooltips: [],
                constructor: function(a, b) {
                    g.mixin(this, H);
                    g.mixin(this,
                        J);
                    g.mixin(this, L);
                    g.mixin(this, M);
                    a && (g.mixin(this, a), this.renderer = this.layer.renderer, this.opacityInfo = this.getOpacityInfo(), this.authoringInfo = g.clone(this.renderer.authoringInfo))
                },
                destroy: function() {
                    this.destroyBusy(this._doneChangingButton);
                    this.destroyAttributeTransparencySlider();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(K.common);
                    g.mixin(this.i18n, K.rendererCommon);
                    g.mixin(this.i18n,
                        K.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    var b = 40;
                    p(".toolsLabel").forEach(function(a) { b = Math.max(b, c.coords(a).w) });
                    p(".toolsColumnTD").style("width", b + 10 + "px");
                    a.connect(this._rendererAttributeTransparencEditExpression, "click", g.hitch(this, "_onAttributeTransparencyEditExpressionClick"));
                    a.connect(this._rendererAttributeTransparencyFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttributeTransparencyAttribute));
                    a.connect(this._rendererAttributeTransparencyDividedByFieldDescription,
                        "click", g.hitch(this, "onFieldDescriptionClick", this._rendererAttributeTransparencyDividedByAttribute))
                },
                _onClose: function(b) {
                    b.preventDefault();
                    this.hideBusy(this._doneChangingButton);
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origPanelRenderer);
                    a.publish("attribute-transparency-stop")
                },
                _onCancel: function(b) {
                    b.preventDefault();
                    this.hideBusy(this._doneChangingButton);
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origPanelRenderer);
                    a.publish("attribute-transparency-stop")
                },
                _onOK: function(b) {
                    b.preventDefault();
                    this.hideBusy(this._doneChangingButton);
                    this.hideFieldDescriptionPopup();
                    this._doneChangingButton.set("disabled", !0);
                    this._cancelButton.set("disabled", !0);
                    this.updateLegendProperty(this.opacityInfo, "opacityInfo", this._rendererAttributeTransparencyLegendCheck.get("checked"));
                    a.publish("attribute-transparency-commit", [{ opacityInfo: this.opacityInfo, authoringInfo: this.authoringInfo }])
                },
                startup: function() {
                    this.inherited(arguments);
                    t.set(this._rendererAttributeTransparencEditExpression,
                        "display", "none");
                    this._init()
                },
                _init: function() {
                    this.origPanelRenderer = this.buildCurrentRendererInfo();
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                    this.createTooltips()
                },
                updateUIWithRenderer: function() {
                    this._rendererAttributeTransparencyAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' " + (this.showDateFields ?
                            "OR type:'esriFieldTypeDate' " : "") + " OR type:'none' OR type:'transExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'"
                    });
                    this._rendererAttributeTransparencyDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "'" + (this.opacityInfo && this.opacityInfo.field ?
                            " AND NOT name:'" + this.opacityInfo.field + "'" : "")
                    });
                    var a = 60;
                    n.forEach(p(".firstColumnLabel", this.domNode), function(b) { a = Math.max(a, c.coords(b).w) });
                    var b = 335 - a;
                    t.set(this._rendererAttributeTransparencyAttribute.domNode, "width", b + "px");
                    t.set(this._rendererAttributeTransparencyDividedByAttribute.domNode, "width", b + "px");
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    t.set(this._rendererAttributeTransparencEditExpression, "display", "none");
                    this.opacityInfo &&
                        (this.opacityInfo.field || this.opacityInfo.valueExpression) ? (!this.opacityInfo.stops && this.opacityInfo.opacityValues && (this.opacityInfo.stops = [{ opacity: this.opacityInfo.opacityValues[0], value: this.opacityInfo.minDataValue }, { opacity: this.opacityInfo.opacityValues[1], value: this.opacityInfo.maxDataValue }], delete this.opacityInfo.opacityValues, delete this.opacityInfo.minDataValue, delete this.opacityInfo.maxDataValue), p(".AttributeTransparencyToggle").forEach(function(a) { t.set(a, "display", "") }), -1 < n.indexOf(["predominance",
                            "predominancesize"
                        ], this.getRendererStyle(this.renderer)) && this.opacityInfo.valueExpression ? (t.set(e.byId("AttributeTransparencyFields"), "display", "none"), e.byId("AttributeTransparencyMsg").innerHTML = this.i18n.attributeTransparencyMsgForPredominance, t.set(this._rendererAttributeTransparencEditExpression, "display", "")) : this.opacityInfo.valueExpression ? (this._rendererAttributeTransparencyAttribute.set("value", "customExprTrans"), t.set(this._rendererAttributeTransparencEditExpression, "display", ""), t.set(e.byId("AttributeTransparencyDividedBy"),
                            "display", "none")) : (e.byId("AttributeTransparencyMsg").innerHTML = this.i18n.attributeTransparencyMsg, this._rendererAttributeTransparencyAttribute.set("value", this.opacityInfo.field), this.opacityInfo.normalizationField && this._rendererAttributeTransparencyDividedByAttribute.set("value", this.opacityInfo.normalizationField), this.attributesStore.fetchItemByIdentity({
                            identity: this.opacityInfo.field,
                            onItem: g.hitch(this, function(a) {
                                a = this.clean(a);
                                "esriFieldTypeDate" === a.type && t.set(e.byId("AttributeTransparencyDividedBy"),
                                    "display", "none")
                            })
                        })), this._rendererAttributeTransparencyZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererAttributeTransparencyZoomTitle, "display", ""), this._rendererAttributeTransparencyMax.set("value", 100 - 100 * this.opacityInfo.stops[0].opacity), this._rendererAttributeTransparencyMin.set("value", 100 - 100 * this.opacityInfo.stops[1].opacity), this.attributesStore.fetchItemByIdentity({
                            identity: this.opacityInfo && this.opacityInfo.field,
                            onItem: g.hitch(this, function(a) {
                                a = a && this.clean(a);
                                9 > h("ie") ?
                                    setTimeout(g.hitch(this, function() { this.createAttributeTransparencySlider({ opacityInfo: this.opacityInfo, authoringInfo: this.authoringInfo, attributeItem: a }).then(g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }), g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }), g.hitch(this, function(a) { this.showBusy("AttributeTransparencyContent", a, this._doneChangingButton, 960) })) }), 1E3) : this.createAttributeTransparencySlider({
                                        opacityInfo: this.opacityInfo,
                                        authoringInfo: this.authoringInfo,
                                        attributeItem: a
                                    }).then(g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }), g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }), g.hitch(this, function(a) { this.showBusy("AttributeTransparencyContent", a, this._doneChangingButton, 960) }))
                            })
                        }), this.opacityInfo.legendOptions && !1 === this.opacityInfo.legendOptions.showLegend ? this._rendererAttributeTransparencyLegendCheck.set("checked", !1) : this._rendererAttributeTransparencyLegendCheck.set("checked", !0)) : (p(".AttributeTransparencyToggle").forEach(function(a) {
                            t.set(a,
                                "display", "none")
                        }), this._rendererAttributeTransparencyAttribute.set("value", "_" + this.i18n.none + "_"));
                    this.getAttributeItemFromStore(this._rendererAttributeTransparencyAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererAttributeTransparencyFieldDescription, "display", "") : t.set(this._rendererAttributeTransparencyFieldDescription, "display", "none") }));
                    this.getAttributeItemFromStore(this._rendererAttributeTransparencyDividedByAttribute.get("value")).then(g.hitch(this,
                        function(a) { a && a.descriptionValue ? t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "") : t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "none") }));
                    setTimeout(g.hitch(this, function() { this.adjustDlg() }), 500)
                },
                createTooltips: function() {
                    var a = function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" };
                    this.tooltips.push(new E({ connectId: this._rendererAttributeTransparencyZoomTitle, label: a(this.i18n.zoomTooltip) }));
                    this.tooltips.push(new E({
                        connectId: this._rendererAttributeTransparencyDividedByAttribute.domNode,
                        label: a(this.i18n.dividedByTooltip)
                    }));
                    this.tooltips.push(new E({ connectId: this._rendererAttributeTransparencEditExpression, label: a(this.i18n.editExpression) }));
                    this.tooltips.push(new E({ connectId: this._rendererAttributeTransparencyFieldDescription, label: a(this.i18n.showDescription) }));
                    this.tooltips.push(new E({ connectId: this._rendererAttributeTransparencyDividedByFieldDescription, label: a(this.i18n.showDescription) }))
                },
                _onChangeAttribute: function() {
                    if (!this.disableAllEvents) {
                        t.set(this._estimatedValuesMsg,
                            "display", "none");
                        t.set(this._zeroFeaturesMsg, "display", "none");
                        var a = this._rendererAttributeTransparencyAttribute.get("value");
                        a !== "_" + this.i18n.none + "_" ? this.attributesStore.fetchItemByIdentity({
                            identity: a,
                            onItem: g.hitch(this, function(b) {
                                var c = b;
                                (b = this.clean(b)) && b.descriptionValue ? t.set(this._rendererAttributeTransparencyFieldDescription, "display", "") : t.set(this._rendererAttributeTransparencyFieldDescription, "display", "none");
                                if ("customExprTrans" !== b.name || b.valueExpression) {
                                    this.disableAllEvents = !0;
                                    "customExprTrans" === b.name ? (this._rendererAttributeTransparencyAttribute.setStore(this.attributesStore, this._rendererAttributeTransparencyAttribute.get("value"), { query: this._rendererAttributeTransparencyAttribute.query }, !1), t.set(this._rendererAttributeTransparencEditExpression, "display", "")) : t.set(this._rendererAttributeTransparencEditExpression, "display", "none");
                                    p(".AttributeTransparencyToggle").forEach(function(a) { t.set(a, "display", "") });
                                    this._rendererAttributeTransparencyZoomLabel.innerHTML =
                                        this.i18n.zoomIn;
                                    t.set(this._rendererAttributeTransparencyZoomTitle, "display", ""); - 1 < n.indexOf(["esriFieldTypeDate", "transExpr"], b.type) ? (t.set(e.byId("AttributeTransparencyDividedBy"), "display", "none"), this._rendererAttributeTransparencyDividedByAttribute.set("value", "_" + this.i18n.none + "_")) : (this._rendererAttributeTransparencyDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", {
                                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" +
                                            this.layer.objectIdField + "' AND NOT name:'" + a + "'"
                                    }), this.opacityInfo && this.opacityInfo.normalizationField && this.opacityInfo.normalizationField !== a && this._rendererAttributeTransparencyDividedByAttribute.set("value", this.opacityInfo.normalizationField));
                                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                                    var d = { layer: this.fLayer || this.layer, useStdDev: !0 };
                                    this.hasAttributeCustomExpression(b) ? (d.valueExpression = b.valueExpression, d.valueExpressionTitle = b.valueExpressionTitle) : d.field = a;
                                    var h = this._rendererAttributeTransparencyDividedByAttribute.get("value");
                                    h !== "_" + this.i18n.none + "_" && (d.normalizationField = h);
                                    this.getAttributeItemFromStore(h).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "") : t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "none") }));
                                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                                        var a = new v;
                                        this.showBusy("AttributeTransparencyContent",
                                            a, this._doneChangingButton, 960);
                                        F.createOpacityInfo(d).then(g.hitch(this, function(c) {
                                            if (!a.isRejected()) {
                                                a.resolve();
                                                this.opacityInfo && (c.opacityInfo.stops[0].opacity = this.opacityInfo.stops[0].opacity, c.opacityInfo.stops[1].opacity = this.opacityInfo.stops[1].opacity);
                                                this.opacityInfo = c.opacityInfo;
                                                this._rendererAttributeTransparencyMax.set("value", 100 - 100 * this.opacityInfo.stops[0].opacity);
                                                this._rendererAttributeTransparencyMin.set("value", 100 - 100 * this.opacityInfo.stops[1].opacity);
                                                this.authoringInfo =
                                                    this.renderer.authoringInfo || {};
                                                var d = [];
                                                this.authoringInfo.visualVariables && (d = this.getVisualVariablesExceptType("transparencyInfo", null, this.authoringInfo.visualVariables) || []);
                                                d.push({ type: "transparencyInfo", minSliderValue: c.statistics.min, maxSliderValue: c.statistics.max });
                                                this.authoringInfo.visualVariables = d;
                                                this.createAttributeTransparencySlider({ opacityInfo: this.opacityInfo, statistics: c.statistics, attributeItem: b }).then(g.hitch(this, function(a) {
                                                        this.hideBusy(this._doneChangingButton);
                                                        this.adjustDlg()
                                                    }),
                                                    g.hitch(this, function(a) {
                                                        this.hideBusy(this._doneChangingButton);
                                                        this.adjustDlg()
                                                    }))
                                            }
                                        }), g.hitch(this, function(b) { a.isRejected() || (a.resolve(), this.hideBusy(this._doneChangingButton), this.adjustDlg(), this.handleError(b, "createOpacityInfo", !0)) }))
                                    }), g.hitch(this, function(a) {
                                        this.hideBusy(this._doneChangingButton);
                                        this.adjustDlg();
                                        this.handleError(a, "addPlugin", !0)
                                    }))
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(c, "valueExpression", a.expression);
                                    this.attributesStore.setValue(c,
                                        "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(c, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(c, "displayName", f.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this._rendererAttributeTransparencyAttribute.setStore(this.attributesStore, this._rendererAttributeTransparencyAttribute.get("value"), { query: this._rendererAttributeTransparencyAttribute.query }, !1);
                                    this._onChangeAttribute()
                                }), g.hitch(this, function() {
                                    this._rendererAttributeTransparencyAttribute.set("value",
                                        this.opacityInfo ? this.opacityInfo.field : "_" + this.i18n.none + "_", !1)
                                }))
                            })
                        }) : (this._rendererAttributeTransparencyDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "'" }), this.opacityInfo && this.opacityInfo.normalizationField && this._rendererAttributeTransparencyDividedByAttribute.set("value", this.opacityInfo.normalizationField),
                            t.set(this._rendererAttributeTransparencyFieldDescription, "display", "none"), t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "none"), delete this.opacityInfo, p(".AttributeTransparencyToggle").forEach(function(a) { t.set(a, "display", "none") }), this.destroyAttributeTransparencySlider(), this.adjustDlg())
                    }
                },
                _onChangeDividedByAttribute: function() {
                    if (!(this.disableAllEvents || this.opacityInfo && this.opacityInfo.valueExpression)) {
                        var a = this._rendererAttributeTransparencyAttribute.get("value");
                        a !== "_" + this.i18n.none + "_" ? (p(".AttributeTransparencyToggle").forEach(function(a) { t.set(a, "display", "") }), this._rendererAttributeTransparencyZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererAttributeTransparencyZoomTitle, "display", ""), this.attributesStore.fetchItemByIdentity({
                            identity: a,
                            onItem: g.hitch(this, function(b) {
                                b = this.clean(b);
                                var c = { layer: this.fLayer || this.layer, field: a, useStdDev: !0 };
                                this.hasAttributeCustomExpression(b) ? (c.valueExpression = b.valueExpression, c.valueExpressionTitle = b.valueExpressionTitle) :
                                    c.field = a;
                                b = this._rendererAttributeTransparencyDividedByAttribute.get("value");
                                b !== "_" + this.i18n.none + "_" && (c.normalizationField = b);
                                this.getAttributeItemFromStore(b).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "") : t.set(this._rendererAttributeTransparencyDividedByFieldDescription, "display", "none") }));
                                this.adjustDlg();
                                (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                                    var a =
                                        new v;
                                    this.showBusy("AttributeTransparencyContent", a, this._doneChangingButton, 960);
                                    F.createOpacityInfo(c).then(g.hitch(this, function(b) {
                                        if (!a.isRejected()) {
                                            a.resolve();
                                            this.opacityInfo && (b.opacityInfo.stops[0].opacity = this.opacityInfo.stops[0].opacity, b.opacityInfo.stops[1].opacity = this.opacityInfo.stops[1].opacity);
                                            this.opacityInfo = b.opacityInfo;
                                            this._rendererAttributeTransparencyMax.set("value", 100 - 100 * this.opacityInfo.stops[0].opacity);
                                            this._rendererAttributeTransparencyMin.set("value", 100 - 100 *
                                                this.opacityInfo.stops[1].opacity);
                                            this.authoringInfo = this.renderer.authoringInfo || {};
                                            var c = [];
                                            this.authoringInfo.visualVariables && (c = this.getVisualVariablesExceptType("transparencyInfo", null, this.authoringInfo.visualVariables) || []);
                                            c.push({ type: "transparencyInfo", minSliderValue: b.statistics.min, maxSliderValue: b.statistics.max });
                                            this.authoringInfo.visualVariables = c;
                                            this.createAttributeTransparencySlider({ opacityInfo: this.opacityInfo, statistics: b.statistics }).then(g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }),
                                                g.hitch(this, function(a) { this.hideBusy(this._doneChangingButton) }))
                                        }
                                    }), g.hitch(this, function(b) { a.isRejected() || (a.resolve(), this.hideBusy(this._doneChangingButton), this.handleError(b, "createOpacityInfo", !1)) }))
                                }), g.hitch(this, function(a) { this.handleError(a, "addPlugin", !1) }))
                            })
                        })) : (delete this.opacityInfo, p(".AttributeTransparencyToggle").forEach(function(a) { t.set(a, "display", "none") }), this.destroyAttributeTransparencySlider())
                    }
                },
                _onClickZoom: function() {
                    this.disableAllEvents || (this.opacitySlider.get("zoomOptions") ?
                        (this.zoomOutOpacitySlider({ opacityInfo: this.opacityInfo }), w.remove(this._rendererAttributeTransparencyZoomIcon, "active"), this._rendererAttributeTransparencyZoomLabel.innerHTML = this.i18n.zoomIn) : this.zoomInOpacitySlider({ opacityInfo: this.opacityInfo }).then(g.hitch(this, function(a) {
                            w.add(this._rendererAttributeTransparencyZoomIcon, "active");
                            this._rendererAttributeTransparencyZoomLabel.innerHTML = this.i18n.zoomOut
                        }), g.hitch(this, function(a) {})))
                },
                clearZoom: function() {
                    "type" === this.getRendererStyle(this.renderer) &&
                        this.opacitySlider && (this.opacitySlider.get("zoomOptions") && this.zoomOutOpacitySlider({ opacityInfo: this.opacityInfo }), w.remove(this._rendererAttributeTransparencyZoomIcon, "active"), this._rendererAttributeTransparencyZoomLabel.innerHTML = this.i18n.zoomIn)
                },
                onAttributeTransparencySliderChange: function(a) {},
                _onChangeMin: function() {
                    this.disableAllEvents || (0 > this._rendererAttributeTransparencyMin.get("value") && this._rendererAttributeTransparencyMin.set("value", 0), 100 < this._rendererAttributeTransparencyMin.get("value") &&
                        this._rendererAttributeTransparencyMin.set("value", 100), this.opacityInfo && (this.opacityInfo.stops[1].opacity = (100 - this._rendererAttributeTransparencyMin.get("value")) / 100, this.updateAttributeTransparencySlider(this.opacityInfo)))
                },
                _onChangeMax: function() {
                    this.disableAllEvents || (0 > this._rendererAttributeTransparencyMax.get("value") && this._rendererAttributeTransparencyMax.set("value", 0), 100 < this._rendererAttributeTransparencyMax.get("value") && this._rendererAttributeTransparencyMax.set("value", 100),
                        this.opacityInfo && (this.opacityInfo.stops[0].opacity = (100 - this._rendererAttributeTransparencyMax.get("value")) / 100, this.updateAttributeTransparencySlider(this.opacityInfo)))
                },
                _onAttributeTransparencyEditExpressionClick: function() {
                    this.onClickExpressionEditor({ expression: this.opacityInfo.valueExpression, title: this.opacityInfo.valueExpressionTitle || this.opacityInfo.legendOptions && this.opacityInfo.legendOptions.title }).then(g.hitch(this, function(a) {
                        this.attributesStore.fetchItemByIdentity({
                            identity: "customExprTrans",
                            onItem: g.hitch(this, function(b) {
                                var c = b;
                                b = this.clean(b);
                                this.attributesStore.setValue(c, "valueExpression", a.expression);
                                this.attributesStore.setValue(c, "valueExpressionReturnType", a.returnType);
                                this.attributesStore.setValue(c, "valueExpressionTitle", a.title);
                                this.attributesStore.setValue(c, "displayName", f.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                if (b.valueExpression !== a.expression) this._onChangeAttribute();
                                else
                                    for (key in this._rendererAttributeTransparencyAttribute.setStore(this.attributesStore,
                                            this._rendererAttributeTransparencyAttribute.get("value"), { query: this._rendererAttributeTransparencyAttribute.query }, !1), this.opacityInfo.valueExpression === a.expression && this.opacityInfo.valueExpressionTitle === b.valueExpressionTitle && (this.opacityInfo.valueExpressionTitle = a.title, this.opacitySlider.set("opacityInfo", g.clone(this.opacityInfo))), this.savedRenderers)
                                        if (c = rendererJsonUtils.fromJson(g.clone(this.savedRenderers[key].renderer)), c.visualVariables) {
                                            var d = this.getVisualVariableByType("opacityInfo",
                                                null, c.visualVariables);
                                            d && d.valueExpression === a.expression && d.valueExpressionTitle === b.valueExpressionTitle && (d.valueExpressionTitle = a.title, this.replaceVisualVariable("opacityInfo", null, d, c), this.savedRenderers[key].renderer = c.toJson())
                                        }
                            })
                        })
                    }), g.hitch(this, function() {}))
                },
                adjustDlg: function() {
                    x.byId("attributeTransparencyDlg").resize();
                    var a = 60;
                    n.forEach(p(".firstColumnLabel", this.domNode), function(b) { a = Math.max(a, c.coords(b).w) });
                    var b = t.get(e.byId("AttributeTransparencyFields"), "width"),
                        b = b - (a +
                            10),
                        d = 0;
                    if ("none" !== t.get(this._rendererAttributeTransparencEditExpression, "display") || "none" !== t.get(this._rendererAttributeTransparencyFieldDescription, "display") || "none" !== t.get(this._rendererAttributeTransparencyDividedByFieldDescription, "display")) d = 30;
                    t.set(this._rendererAttributeTransparencyAttribute.domNode, "width", b - d + "px");
                    t.set(this._rendererAttributeTransparencyDividedByAttribute.domNode, "width", b - d + "px");
                    b = dijit.byId("attributeTransparencyDlg").containerNode;
                    b.clientHeight < b.scrollHeight &&
                        t.set(e.byId("attributeTransparencyDlg"), "top", "10px")
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.AttributeTransparency", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/Color": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dojo/store/Memory dojo/data/ObjectStore esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_ColorMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_PrecisionMixin arcgisonline/map/dijit/renderer/_ColorPanelMixin esri/renderers/SimpleRenderer esri/symbols/SimpleLineSymbol dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Color.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N) {
            b = b([C, X], {
                declaredClass: "arcgisonline.map.dijit.renderer.Color",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererColor",
                widgetsInTemplate: !0,
                templateString: N,
                _rConnects: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                colorRendererGrid: null,
                origGalleryRenderer: null,
                isMultiAttributesRenderer: !1,
                attributeTypeIsDate: !1,
                constructor: function(a, b) {
                    g.mixin(this, M);
                    g.mixin(this, K);
                    g.mixin(this, P);
                    g.mixin(this, O);
                    g.mixin(this, R);
                    g.mixin(this, S);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.colorSlider && this.colorSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.destroyColorRendererGrid();
                    this.destroyTooltips();
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(V.common);
                    g.mixin(this.i18n, V.rendererCommon);
                    g.mixin(this.i18n, V.rendererColorPanel);
                    g.mixin(this.i18n, V.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererColorPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"),
                        "resize", this, "adjustHeight"));
                    this._rConnects.push(a.subscribe("onUpdateColor", g.hitch(this, "onUpdateInfo")));
                    a.connect(this._rendererColorOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererColorRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererColorRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererColorRotationAttribute));
                    a.connect(this._rendererColorDividedByFieldDescription,
                        "click", g.hitch(this, "onFieldDescriptionClick", this._rendererColorDividedByAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.portalPanel.scheme = this.scheme;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack(this.renderer) : leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererColorFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererColorHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = -1 < dojo.indexOf(["colorsize", "colorAgeSize"], this.getRendererStyle(this.renderer));
                    this._rendererColorLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !==
                        this.layer.name && (this._rendererColorLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererColorField.innerHTML = this.attributeItem.valueExpressionTitle || this.attributeItem.alias;
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    t.set(this._rendererColorGridDiv, "display", "none");
                    this.attributeTypeIsDate = "esriFieldTypeDate" === this.attributeItem.type;
                    this.scheme = null;
                    this._fillRendererColorTheme();
                    var a = new G({
                            data: [{
                                label: "" +
                                    p.format(.5, { pattern: "0.##" }),
                                id: .5,
                                value: .5
                            }, { label: "1", id: 1, value: 1 }]
                        }),
                        a = new F({ objectStore: a });
                    this._rendererColorClassifyStdDevInterval.set("store", a);
                    this._rendererColorClassifyStdDevInterval.set("value", 1);
                    this.transparencySlider = this.createTransparencySlider("rendererColorTransparencySlider");
                    this.createScaleSlider("rendererColorScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    this.attributeTypeIsDate || this.attributeItem.valueExpression ? t.set(f.byId("rendererColorDividedBy"),
                        "display", "none") : this.attributesStore.fetchItemByIdentity({ identity: "_total_", onItem: g.hitch(this, function(a) { a.alias = [d.substitute(this.i18n.total, { field: this.attributeItem.alias })] }) });
                    this.attributeTypeIsDate ? (t.set(this._rendererColorClassify, "display", "none"), t.set(this._rendererColorOtherCheckMsg, "paddingTop", "20px")) : (this.hasDynamic && !this.newDMS && (t.set(this._rendererColorClassifyCheckDiv, "display", "none"), w.add(this._rendererColorClassifyText, "sectionTitle"), t.set(this._rendererColorClassify,
                        "paddingBottom", "10px")), this._fillRendererColorClassifications(), a = this.i18n.classifyMethod.indexOf("${method}"), this._rendererColorClassifyMethodPart1.innerHTML = this.i18n.classifyMethod.substring(0, a), this._rendererColorClassifyMethodPart2.innerHTML = this.i18n.classifyMethod.substring(a + 9), a = this.i18n.classifyClasses.indexOf("${num}"), this._rendererColorClassifyClassesPart1.innerHTML = this.i18n.classifyClasses.substring(0, a), this._rendererColorClassifyClassesPart2.innerHTML = this.i18n.classifyClasses.substring(a +
                        6), a = this.i18n.classifyStdDevIntervals.indexOf("${num}"), this._rendererColorClassifyStdDevIntervalPart1.innerHTML = this.i18n.classifyStdDevIntervals.substring(0, a), this._rendererColorClassifyStdDevIntervalPart2.innerHTML = this.i18n.classifyStdDevIntervals.substring(a + 6));
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType ? t.set(this._rendererColorRotation, "display", "none") : (this._rendererColorRotationAttribute.setStore(this.attributesStore, "", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                            this.layer.objectIdField + "'"
                    }), t.set(this._rendererColorRotation, "display", ""));
                    if (this.hasDynamic && !this.newDMS || this.isGeoRSS || this.isSL || !this.hasNumericField && !this.hasDateField) m(".rendererColorHasAttributeTransparency").forEach(function(a) { t.set(a, "display", "none") }), w.remove(f.byId("rendererColorTransparencySliderDiv"), "esriLeadingPadding1");
                    else {
                        var a = this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererColorAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererColorAttributeTransparencyLabel_part3.innerHTML =
                            a.substring(b + 8);
                        var c = this.getOpacityInfo();
                        c && c.field ? "function" == typeof c.field ? this._rendererColorAttributeTransparencyLabel_part2.innerHTML = "predominant total" : this.attributesStore.fetchItemByIdentity({
                            identity: c.field,
                            onItem: g.hitch(this, function(a) {
                                c.normalizationField ? this.attributesStore.fetchItemByIdentity({
                                    identity: c.normalizationField,
                                    onItem: g.hitch(this, function(b) {
                                        this._rendererColorAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, {
                                            field1: a.alias ||
                                                a.name,
                                            field2: b.alias || b.name
                                        })
                                    })
                                }) : this._rendererColorAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name
                            })
                        }) : this._rendererColorAttributeTransparencyLabel_part2.innerHTML = c && c.valueExpression ? this.getRendererCustomExpression(null, "transparency").title : this.i18n.attributeValues
                    }
                    this.updateUIWithRenderer();
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    var a = !1;
                    this.renderer.normalizationTotal &&
                        "percent-of-total" === this.renderer.normalizationType && (a = !0);
                    "classedColor" === this.getRendererStyle(this.renderer) ? (this._rendererColorDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none'" + (a ? " OR type:'total'" : "") + ") AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" }), w.remove(this._rendererColorSymbols,
                        "symbolIconContinuous"), w.add(this._rendererColorSymbols, "symbolIconClassed")) : (this._rendererColorDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" }), w.remove(this._rendererColorSymbols, "symbolIconClassed"), w.add(this._rendererColorSymbols, "symbolIconContinuous"));
                    a ? this._rendererColorDividedByAttribute.set("value", "_total_") : "color" !== this.getRendererStyle(this.renderer) && "classedColor" !== this.getRendererStyle(this.renderer) || !this.renderer.normalizationField || "field" !== this.renderer.normalizationType ? "colorsize" === this.getRendererStyle(this.renderer) && (a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables)) && a.normalizationField && this._rendererColorDividedByAttribute.set("value", a.normalizationField) : this._rendererColorDividedByAttribute.set("value",
                        this.renderer.normalizationField);
                    this.getAttributeItemFromStore(this._rendererColorDividedByAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererColorDividedByFieldDescription, "display", "") : t.set(this._rendererColorDividedByFieldDescription, "display", "none") }));
                    "esriGeometryPolygon" === this.geometryType && "colorsize" === this.getRendererStyle(this.renderer) && (this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ? this.drawTransparentSymbol(this._rendererColorPolygonSymbol) :
                        (this.drawSymbol(this._rendererColorPolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererColorPolygonSymbol)) : (this.renderer.backgroundFillSymbol = J.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererColorPolygonSymbol)), t.set(this._rendererColorPolygonsTitle, "display", ""));
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel },
                        t.set(this._rendererColorOther, "display", ""), this._rendererColorOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererColorOther, "display", "none"), this._rendererColorOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererColorOtherSymbol) : (this.drawSymbol(this._rendererColorOtherSymbol, this.defaultInfo.defaultSymbol, null, null,
                        null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererColorOtherSymbol));
                    "classedColor" === this.getRendererStyle(this.renderer) ? (t.set(f.byId("rendererColorTheme"), "display", "none"), t.set(this._rendererColorZoomTitle, "display", "none"), this._rendererColorClassifyCheck.set("checked", !0), t.set(this._rendererColorClassifyContent, "display", ""), t.set(this._rendererColorClassifyClassesTitle, "display", ""), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "none"),
                        t.set(this._rendererColorLegendClassesTitle, "display", ""), this._rendererColorOtherTxt.innerHTML = this.i18n.drawClassifiedOthers, t.set(this._rendererColorLegend, "display", "none"), this.renderer.authoringInfo ? (this._rendererColorClassifyMethods.set("value", this.getClassificationMethod(this.fromClassificationMethodConstant(this.renderer.authoringInfo.classificationMethod))), "esriClassifyStandardDeviation" === this.renderer.authoringInfo.classificationMethod ? (this._rendererColorClassifyStdDevInterval.set("value",
                            this.renderer.authoringInfo.standardDeviationInterval || 1), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", ""), t.set(this._rendererColorClassifyClassesTitle, "display", "none")) : this._rendererColorClassifyClasses.set("value", this.renderer.infos.length)) : this._rendererColorClassifyClasses.set("value", this.renderer.infos.length)) : "color" === this.getRendererStyle(this.renderer) ? ((a = this.renderer.authoringInfo ? this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables) :
                        null) && a.theme && this._rendererColorTheme.set("value", this.getThemeAlias(a.theme)), t.set(f.byId("rendererColorTheme"), "display", ""), this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererColorZoomTitle, "display", ""), this._rendererColorClassifyCheck.set("checked", !1), t.set(this._rendererColorClassifyContent, "display", "none"), t.set(this._rendererColorLegendClassesTitle, "display", "none"), this._rendererColorOtherTxt.innerHTML = this.i18n.drawOthers, t.set(this._rendererColorInvertTitle,
                        "display", ""), t.set(this._rendererColorLegend, "display", "")) : -1 < n.indexOf(["colorsize", "colorAgeSize"], this.getRendererStyle(this.renderer)) ? ((a = this.renderer.authoringInfo ? this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables) : null) && a.theme && this._rendererColorTheme.set("value", this.getThemeAlias(a.theme)), t.set(this._rendererColorClassify, "display", "none"), t.set(this._rendererColorLegendClassesTitle, "display", "none"), t.set(this._rendererColorInvertTitle, "display",
                        ""), t.set(this._rendererColorLegend, "display", "")) : "ratio" === this.getRendererStyle(this.renderer) && (t.set(this._rendererColorDividedByAttribute.domNode, "display", "none"), x.place(x.create("span", { innerHTML: this.attributeItem2.alias }), f.byId("rendererColorDividedBySelect"), "first"), t.set(f.byId("rendererColorTheme"), "display", "none"), t.set(this._rendererColorClassify, "display", "none"), this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererColorZoomTitle, "display", ""), t.set(this._rendererColorLegendClassesTitle,
                        "display", "none"), this._rendererColorOtherTxt.innerHTML = this.i18n.drawOthers, t.set(this._rendererColorInvertTitle, "display", ""), t.set(this._rendererColorLegend, "display", ""));
                    t.set(this._rendererColorRotationEditExpression, "display", "none");
                    t.set(this._rendererColorRotationFieldDescription, "display", "none");
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || (a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType),
                        this.drawRotationSymbol(a, this._rendererColorRotateRightSymbol, this._rendererColorRotateLeftSymbol), a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), this._rendererColorRotationCheck.set("checked", a ? !0 : !1), a && (this._rendererColorRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererColorRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)),
                            a.field ? (this._rendererColorRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererColorRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererColorRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererColorRotationEditExpression, "display", ""))), t.set(this._rendererColorRotationContent, "display", a ? "" : "none"));
                    var b = "ratio" === this.getRendererStyle(this.renderer) ?
                        this._rendererRatioLegendCheck : this._rendererColorLegendCheck;
                    (a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables)) && (a.legendOptions && !1 === a.legendOptions.showLegend ? b.set("checked", !1) : b.set("checked", !0));
                    "classedColor" === this.getRendererStyle(this.renderer) ? this.getParams().then(g.hitch(this, function(a) {
                        9 > e("ie") ? setTimeout(g.hitch(this, function() {
                            this.createClassedColorInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }),
                                g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        }), 1E3) : this.createClassedColorInfoSlider(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    })) : this.getParams().then(g.hitch(this, function(a) {
                        9 > e("ie") ? setTimeout(g.hitch(this, function() {
                            this.createColorInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }),
                                g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        }), 1E3) : this.createColorInfoSlider(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    }));
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                _fillRendererColorClassifications: function() {
                    var a = function(a, b, c) {
                        return "\x3chtml\x3e\x3cbody\x3e\x3cdiv class\x3d'" + c + "_classificationTitle'\x3e" + a + "\x3c/div\x3e\x3cdiv class\x3d'" +
                            c + "_classificationMsg'\x3e" + b + "\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e"
                    };
                    this.classificationData = [];
                    this.classificationData.push({ name: this.i18n.classifyNaturalBreaks, key: "natural-breaks", label: a(this.i18n.classifyNaturalBreaks, this.i18n.classifyNaturalBreaksMsg, this.baseClass) });
                    this.classificationData.push({ name: this.i18n.classifyEqualInterval, key: "equal-interval", label: a(this.i18n.classifyEqualInterval, this.i18n.classifyEqualIntervalMsg, this.baseClass) });
                    this.isFeatColl || this.classificationData.push({
                        name: this.i18n.classifyStandardDeviation,
                        key: "standard-deviation",
                        label: a(this.i18n.classifyStandardDeviation, this.i18n.classifyStandardDeviationMsg, this.baseClass)
                    });
                    this.classificationData.push({ name: this.i18n.classifyQuantile, key: "quantile", label: a(this.i18n.classifyQuantile, this.i18n.classifyQuantileMsg, this.baseClass) });
                    this.classificationData.push({ name: this.i18n.classifyManualBreaks, key: "manual", label: a(this.i18n.classifyManualBreaks, this.i18n.classifyManualBreaksMsg, this.baseClass) });
                    this.classificationStore = new G({
                        data: this.classificationData,
                        idProperty: "name"
                    });
                    this._rendererColorClassifyMethods.set("store", this.classificationStore);
                    this._rendererColorClassifyMethods.set("labelAttr", "label");
                    this._rendererColorClassifyMethods.set("labelType", "html");
                    this._rendererColorClassifyMethods.textbox.readOnly = !0;
                    t.set(this._rendererColorClassifyMethods.textbox, "cursor", "pointer");
                    this._rendererColorClassifyMethods.textbox.onclick = g.hitch(this, function() { this._rendererColorClassifyMethods.loadDropDown() });
                    this.renderer.authoringInfo && this.renderer.authoringInfo.classificationMethod ?
                        this._rendererColorClassifyMethods.set("value", this.getClassificationMethod(this.fromClassificationMethodConstant(this.renderer.authoringInfo.classificationMethod))) : this._rendererColorClassifyMethods.set("value", this.i18n.classifyManualBreaks);
                    t.set(this._rendererColorClassifyClassesTitle, "display", "");
                    t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "none");
                    r.after(this._rendererColorClassifyMethods, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _onChangeDividedByAttribute: function() {
                    this.disableAllEvents ||
                        (this.getAttributeItemFromStore(this._rendererColorDividedByAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererColorDividedByFieldDescription, "display", "") : t.set(this._rendererColorDividedByFieldDescription, "display", "none") })), this.adjustHeight(), this.getParams().then(g.hitch(this, function(a) {
                            this.clearZoom();
                            this.buildColorRenderer(a).then(g.hitch(this, function(b) {
                                this.renderer = b = b.renderer;
                                this._rendererColorDividedByAttribute.setStore(this.attributesStore,
                                    a.normalizationField || "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" });
                                D.isDefined(a.numClasses) && a.numClasses !== b.infos.length && (this.disableAllEvents = !0, this._rendererColorClassifyClasses.set("value", b.infos.length), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3));
                                this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ?
                                    this.drawTransparentSymbol(this._rendererColorOtherSymbol) : (this.drawSymbol(this._rendererColorOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererColorOtherSymbol));
                                this.applyColorRenderer(this.renderer, { theme: this.getTheme(), scheme: this.scheme });
                                this._rendererColorClassifyCheck.get("checked") ? this.createClassedColorInfoSlider(a).then(g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function() { this.hideBusy() })) :
                                    this.createColorInfoSlider(a).then(g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function() { this.hideBusy() }))
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        })))
                },
                _onClickLegendClasses: function() {
                    -1 === this._rendererColorLegendClassesIcon.className.indexOf("active") ? (w.add(this._rendererColorLegendClassesIcon, "active"), this._rendererColorLegendClassesText.innerHTML = this.i18n.classes, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.classesTooltip)),
                        t.set(this._rendererColorSliderDiv, "display", "none"), t.set(this._rendererColorGridDiv, "display", ""), this.updateColorRendererGrid()) : (w.remove(this._rendererColorLegendClassesIcon, "active"), this._rendererColorLegendClassesText.innerHTML = this.i18n.legend, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip)), t.set(this._rendererColorSliderDiv, "display", ""), t.set(this._rendererColorGridDiv, "display", "none"))
                },
                _onChangeClassify: function(a) {
                    this.disableAllEvents || (a ? (t.set(this._rendererColorClassifyContent,
                            "display", ""), t.set(f.byId("rendererColorTheme"), "display", "none"), t.set(this._rendererColorZoomTitle, "display", "none"), t.set(this._rendererColorClassifyClassesTitle, "display", ""), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "none"), w.remove(this._rendererColorLegendClassesIcon, "active"), t.set(this._rendererColorLegendClassesTitle, "display", ""), this._rendererColorLegendClassesText.innerHTML = this.i18n.legend, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip)),
                        t.set(this._rendererColorSliderDiv, "display", ""), t.set(this._rendererColorGridDiv, "display", "none"), t.set(this._rendererColorLegend, "display", "none"), this.disableAllEvents = !0, this._rendererColorClassifyMethods.set("value", this.i18n.classifyNaturalBreaks), this._rendererColorOtherTxt.innerHTML = this.i18n.drawClassifiedOthers, this.otherTooltip.set("label", this.wrapTooltipText(this.i18n.drawClassifiedOthers)), -1 === n.indexOf(["high-to-low", "above-and-below"], this.getTheme()) && (this.scheme = null)) : (t.set(this._rendererColorClassifyContent,
                        "display", "none"), t.set(f.byId("rendererColorTheme"), "display", ""), t.set(this._rendererColorLegendClassesTitle, "display", "none"), t.set(this._rendererColorZoomTitle, "display", ""), t.set(this._rendererColorLegend, "display", ""), this._rendererColorOtherTxt.innerHTML = this.i18n.drawOthers, this.otherTooltip.set("label", this.wrapTooltipText(this.i18n.drawOthers)), this.scheme && -1 === n.indexOf(["high-to-low", "above-and-below"], this.scheme.theme) && (this.scheme = null), this.disableAllEvents = !0, this._rendererColorTheme.set("value",
                        this.i18n.highToLow), "_total_" === this._rendererColorDividedByAttribute.get("value") && this._rendererColorDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" })), this.updateClassifyInfo(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }),
                        1E3))
                },
                _onChangeClassifyMethod: function() {
                    this.disableAllEvents || (this._rendererColorClassifyMethods.get("value") === this.i18n.classifyManualBreaks ? (this.disableAllEvents = !0, 10 < this.renderer.infos.length ? (this._rendererColorClassifyMethods.set("value", this.i18n.classifyNaturalBreaks), this.updateClassifyInfo()) : (this._rendererColorClassifyClasses.set("value", this.renderer.infos.length), delete this.authoringInfo.classificationMethod, delete this.renderer.authoringInfo.classificationMethod, delete this.authoringInfo.standardDeviationInterval,
                        delete this.renderer.authoringInfo.standardDeviationInterval), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3), t.set(this._rendererColorClassifyClassesTitle, "display", ""), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "none")) : (this._rendererColorClassifyMethods.get("value") === this.i18n.classifyStandardDeviation ? (t.set(this._rendererColorClassifyClassesTitle, "display", "none"), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "")) : (t.set(this._rendererColorClassifyClassesTitle,
                        "display", ""), t.set(this._rendererColorClassifyStdDevIntervalTitle, "display", "none")), this.updateClassifyInfo()))
                },
                _onChangeClassifyClasses: function() {
                    this.disableAllEvents || (this.waitingHandler && clearTimeout(this.waitingHandler), this.waitingHandler = setTimeout(g.hitch(this, function() {
                        clearTimeout(this.waitingHandler);
                        this.waitingHandler = null;
                        this.updateClassifyInfo()
                    }), 500))
                },
                _onChangeClassifyStdDevInterval: function() { this.disableAllEvents || this.updateClassifyInfo() },
                updateClassifyInfo: function() {
                    var a =
                        this.getRendererDataRange("colorInfo");
                    this._rendererColorClassifyCheck.get("checked") ? (w.remove(this._rendererColorSymbols, "symbolIconContinuous"), w.add(this._rendererColorSymbols, "symbolIconClassed"), t.set(this._rendererColorInvertTitle, "display", "none"), this.getParams().then(g.hitch(this, function(b) {
                        10 < b.numClasses && (b.numClasses = 4, this.disableAllEvents = !0, this._rendererColorClassifyClasses.set("value", 4));
                        this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables) || (b.minValue =
                            a.min, b.maxValue = a.max);
                        if (this.authoringInfo) {
                            var c = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                            c && c.theme && "high-to-low" !== c.theme && delete this.scheme
                        }
                        this.buildColorRenderer(b).then(g.hitch(this, function(a) {
                            a = a.renderer;
                            this._rendererColorClassifyMethods.get("value") !== this.i18n.classifyStandardDeviation && D.isDefined(b.numClasses) && b.numClasses !== a.infos.length && (this.disableAllEvents = !0, this._rendererColorClassifyClasses.set("value", a.infos.length),
                                setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3));
                            this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererColorOtherSymbol) : (this.drawSymbol(this._rendererColorOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererColorOtherSymbol));
                            this.applyColorRenderer(a);
                            this.createClassedColorInfoSlider(b).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }),
                                g.hitch(this, function() { this.hideBusy() }))
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    }))) : (w.remove(this._rendererColorSymbols, "symbolIconClassed"), w.add(this._rendererColorSymbols, "symbolIconContinuous"), t.set(this._rendererColorInvertTitle, "display", ""), this.getParams().then(g.hitch(this, function(b) {
                        this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables) && (b.minValue = a.min, b.maxValue = a.max);
                        this.buildColorRenderer(b).then(g.hitch(this,
                            function(a) {
                                this.applyColorRenderer(a.renderer);
                                w.remove(this._rendererColorLegendClassesIcon, "active");
                                this._rendererColorLegendClassesText.innerHTML = this.i18n.legend;
                                this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip));
                                t.set(this._rendererColorSliderDiv, "display", "");
                                t.set(this._rendererColorGridDiv, "display", "none");
                                w.remove(this._rendererColorZoomIcon, "active");
                                this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn;
                                this.createColorInfoSlider(b).then(g.hitch(this,
                                    function() {
                                        this.hideBusy();
                                        this.adjustHeight()
                                    }), g.hitch(this, function() { this.hideBusy() }))
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    })))
                },
                onUpdateInfo: function(a, b) {
                    if ("_default_" === a.minValue) this.renderer.defaultLabel = a.label, this.renderer.defaultSymbol = a.symbol, this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, this.updateColorRenderer(b);
                    else {
                        var c = this.renderer.infos;
                        this.renderer.clearBreaks();
                        n.forEach(c, function(b, c) { a.minValue === b.minValue && a.maxValue === b.maxValue ? this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: a.symbol, label: a.label }) : this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: b.symbol, label: b.label }) }, this);
                        this.updateColorRenderer(b);
                        this.updateColorSlider()
                    }
                },
                _onChangeColorPrecision: function() {
                    if (!this.disableAllEvents) {
                        var a = this._rendererColorPrecision.get("value");
                        "select" !== a && (this.updateValues(parseFloat(a)), this.applyColorRenderer(this.renderer),
                            "block" === t.get(this._rendererColorGridDiv, "display") && this.updateColorRendererGrid(), this.updateColorSlider(), this.onColorSliderChange("precisionChange"))
                    }
                },
                _onClickSwitch: function() {},
                _onClickSwitch2: function() {},
                _onChangeFieldSelect: function() {},
                _onChangeFixedDate: function() {},
                _onChangeFixedTime: function() {},
                _onChangeUnits: function() {},
                getParams: function() {
                    var a = new v,
                        b = {};
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererColorDividedByAttribute.get("value"),
                        onItem: g.hitch(this,
                            function(c) {
                                c && "total" === c.type[0] ? b.normalizationType = "percent-of-total" : c && "none" !== c.type[0] && (b.normalizationType = "field", b.normalizationField = c.name[0]);
                                if (this._rendererColorClassifyCheck.get("checked")) {
                                    b.numClasses = this._rendererColorClassifyClasses.get("value");
                                    switch (this._rendererColorClassifyMethods.get("value")) {
                                        case this.i18n.classifyNaturalBreaks:
                                            b.classificationMethod = "natural-breaks";
                                            break;
                                        case this.i18n.classifyEqualInterval:
                                            b.classificationMethod = "equal-interval";
                                            break;
                                        case this.i18n.classifyStandardDeviation:
                                            b.classificationMethod =
                                                "standard-deviation";
                                            break;
                                        case this.i18n.classifyQuantile:
                                            b.classificationMethod = "quantile"
                                    }
                                    "standard-deviation" === b.classificationMethod && (b.standardDeviationInterval = this._rendererColorClassifyStdDevInterval.get("value"))
                                } else b.theme = this.getTheme();
                                b.showOthers = this._rendererColorOtherCheck.get("checked");
                                b.classified = this._rendererColorClassifyCheck.get("checked");
                                b.symbol = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                                b.rotationInfo = this.renderer.rotationInfo;
                                b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                                b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                                b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                                a.resolve(b)
                            })
                    });
                    return a
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererColorStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererColorTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererColorFooter_links")).h + 10;
                        t.set(f.byId("rendererColorFooterDiv"), "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && t.set(f.byId("renderer-color-content"), "height", a + "px");
                        var g = 60;
                        n.forEach(m(".firstColumnLabel", this.domNode), function(a) { g = Math.max(g, c.coords(a).w) });
                        var h = 40;
                        m(".toolsLabel").forEach(function(a) { h = Math.max(h, c.coords(a).w) });
                        m(".toolsColumnTD").style("width", h + 4 + "px");
                        b = c.coords(f.byId("leftContentStackContainer")).w;
                        a =
                            b - g - 45;
                        0 < a && (d = 0, "none" !== t.get(this._rendererColorDividedByFieldDescription, "display") && (d = 30), t.set(this._rendererColorDividedByAttribute.domNode, "width", a - d + "px"), d = dojo.isChrome || dojo.isSafari ? 2 : 0, t.set(this._rendererColorTheme.domNode, "width", a - d + "px"), (e = f.byId("widget_rendererColorThemeDropdown_dropdown")) && t.set(e, "width", a - d + "px"), e && m(".dijitMenuItem", e).style("width", a - 30 + "px"));
                        t.set(this._rendererColorGridDiv, "width", b - h - 42 + "px");
                        this.colorRendererGrid && this.colorRendererGrid.resize();
                        a = b - 35;
                        if (0 < a) {
                            b = 0;
                            if ("none" !== t.get(this._rendererColorRotationEditExpression, "display") || "none" !== t.get(this._rendererColorRotationFieldDescription, "display")) b = 30;
                            t.set(this._rendererColorRotationAttribute.domNode, "width", a - b - 21 + "px");
                            m(".dijitSelectLabel", this._rendererColorRotationAttribute.domNode).style("maxWidth", a - b - 51 + "px");
                            this.transparencySlider && t.set(this.transparencySlider.domNode, "width", a - 30 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", a - 15 + "px");
                            b = c.coords(this._rendererColorPrecisionLabel).w;
                            t.set(this._rendererColorPrecision.domNode, "width", a - b - 38 + "px");
                            b = c.coords(this._rendererColorClassifyMethodPart1).w;
                            d = c.coords(this._rendererColorClassifyMethodPart2).w;
                            a = Math.max(a - b - (0 < d ? d + 5 : 0) - 28, 30);
                            t.set(this._rendererColorClassifyMethods.domNode, "width", a + "px");
                            if (e = f.byId("widget_rendererColorClassifyMethodDropdown_dropdown")) m(".dijitMenuItem", e).style("width", a - 28 + "px"), t.set(e, "width", a + 2 + "px"), t.set(f.byId("rendererColorClassifyMethodDropdown_popup"), "width", a + "px"), t.set(f.byId("rendererColorClassifyMethodDropdown_popup"),
                                "height", "100%")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Color", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_ColorMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom dojo/Deferred dojo/dom-construct dojo/dom-style esri/lang esri/Color esri/symbols/jsonUtils esri/renderers/smartMapping esri/styles/choropleth esri/plugins/FeatureLayerStatistics esri/dijit/ColorInfoSlider esri/dijit/ClassedColorSlider esri/renderers/SimpleRenderer esri/renderers/ClassBreaksRenderer arcgisonline/map/dijit/renderer/ColorGrid".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G) {
            return {
                buildColorRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic && !this.newDMS) this.buildColorRendererGo(null, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildColorRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildColorRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildColorRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() {!b.isRejected() && b.reject() }) })
                        } else this.buildColorRendererGo(null,
                            a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildColorRendererGo(null, a, b);
                    return b
                },
                buildColorRendererGo: function(a, b, c) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    this.scheme = this.scheme || this.findColorScheme(this.renderer, b.theme);
                    var d, e = null;
                    this.renderer.visualVariables && "color" === this.getRendererType(this.renderer) && (d = this.getVisualVariablesExceptTypes([{ type: "colorInfo" },
                        { type: "sizeInfo", target: "outline" }
                    ], this.renderer.visualVariables), e = this.renderer.authoringInfo && this.getVisualVariablesExceptTypes([{ type: "colorInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.authoringInfo.visualVariables));
                    var f = b.attributeItem || this.attributeItem;
                    if (b.classified || this.hasDynamic && !this.newDMS) {
                        var m, n;
                        b.classificationMethod || (m = b.minValue, n = b.maxValue);
                        r.createClassedColorRenderer({
                            layer: this.fLayer || this.layer,
                            field: this.hasAttributeCustomExpression(f) ? null : f.name,
                            valueExpression: this.hasAttributeCustomExpression(f) ?
                                f.valueExpression : null,
                            valueExpressionTitle: f.valueExpressionTitle,
                            minValue: m,
                            maxValue: n,
                            basemap: this.getBasemapType(),
                            showOthers: !0,
                            numClasses: "standard-deviation" !== b.classificationMethod ? b.numClasses : void 0,
                            scheme: this.scheme,
                            classificationMethod: b.classificationMethod || "equal-interval",
                            standardDeviationInterval: b.standardDeviationInterval,
                            normalizationType: b.normalizationType,
                            normalizationField: b.normalizationField,
                            optimizeOutline: h.isDefined(b.optimizeOutline) ? b.optimizeOutline : !0
                        }).then(g.hitch(this,
                            function(f) {
                                c.isRejected() || (this.scheme = f.scheme, a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0), this.authoringInfo = { type: "classedColor" }, b.classificationMethod && (this.authoringInfo.classificationMethod = this.getClassificationMethodConstant(b.classificationMethod)), "standard-deviation" === b.classificationMethod && (this.authoringInfo.standardDeviationInterval = b.standardDeviationInterval), d && (f.renderer.visualVariables ? f.renderer.setVisualVariables(f.renderer.visualVariables.concat(d)) :
                                    f.renderer.setVisualVariables(d), e && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(e) : e)), f.renderer = this.updateRendererProperties(b, f.renderer), c.resolve({ renderer: f.renderer, statistics: f.statistics }))
                            }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createClassedColorRenderer", !0), c.reject()) }))
                    } else r.createColorRenderer({
                        layer: this.fLayer || this.layer,
                        field: this.hasAttributeCustomExpression(f) ? null : f.name,
                        valueExpression: this.hasAttributeCustomExpression(f) ?
                            f.valueExpression : null,
                        valueExpressionTitle: f.valueExpressionTitle,
                        normalizationType: b.normalizationType,
                        normalizationField: b.normalizationField,
                        theme: b.theme || "high-to-low",
                        minValue: b.minValue,
                        maxValue: b.maxValue,
                        basemap: this.getBasemapType(),
                        scheme: this.scheme,
                        optimizeOutline: h.isDefined(b.optimizeOutline) ? b.optimizeOutline : !0,
                        showOthers: !0
                    }).then(g.hitch(this, function(g) {
                            if (!c.isRejected()) {
                                g.statistics = this.checkStatistics(g.statistics, this.isTypeDate(f) ? !0 : !1);
                                this.scheme = g.scheme;
                                this.onCalculationsSource &&
                                    g.statistics && this.onCalculationsSource(g.statistics);
                                a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                                var m = { type: "colorInfo", minSliderValue: h.isDefined(b.minValue) ? b.minValue : g.statistics.min, maxSliderValue: h.isDefined(b.maxValue) ? b.maxValue : g.statistics.max, theme: b.theme || "high-to-low" };
                                if (this.isMultiAttributesRenderer) {
                                    this.authoringInfo = this.authoringInfo || {};
                                    this.authoringInfo.visualVariables = this.authoringInfo.visualVariables || [];
                                    this.replaceVisualVariable("colorInfo", null, m, this.authoringInfo);
                                    (m = this.getVisualVariablesExceptTypes([{ type: "colorInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.visualVariables)) && g.renderer.setVisualVariables(g.renderer.visualVariables.concat(m));
                                    visVar = this.getVisualVariableByType("colorInfo", null, g.renderer.visualVariables) || null;
                                    g.renderer.attributeField = visVar.field;
                                    g.renderer.valueExpression = visVar.valueExpression;
                                    (g.renderer.normalizationField = visVar.normalizationField) ? g.renderer.normalizationType =
                                        "field": (delete g.renderer.normalizationField, delete g.renderer.normalizationType);
                                    if ("esriGeometryPolygon" === this.geometryType) {
                                        var m = g.renderer.infos[0],
                                            n = p.fromJson(m.symbol.toJson());
                                        m.symbol = this.convertFillToMarkerSymbol(n, n.style, n.outline);
                                        g.renderer.clearBreaks();
                                        g.renderer.addBreak(m);
                                        this.renderer.backgroundFillSymbol && (g.renderer.backgroundFillSymbol = this.renderer.backgroundFillSymbol)
                                    }
                                    g.renderer.authoringInfo = this.authoringInfo
                                } else this.authoringInfo = { visualVariables: [m] }, d && (g.renderer.visualVariables ?
                                    g.renderer.setVisualVariables(g.renderer.visualVariables.concat(d)) : g.renderer.setVisualVariables(d), e && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(e) : e));
                                g.renderer = this.updateRendererProperties(b, g.renderer);
                                m = "ratio" === this.getRendererStyle(this.renderer) ? this._rendererRatioLegendCheck : this._rendererColorLegendCheck;
                                this.updateLegendProperty(g.renderer, "colorInfo", m && m.get("checked"));
                                c.resolve({ renderer: g.renderer, statistics: g.statistics })
                            }
                        }),
                        g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createColorRenderer", !0), c.reject()) }))
                },
                buildColorInfo: function(a, b) {
                    b = new d;
                    var c = a.attributeItem || this.attributeItem;
                    r.createColorInfo({
                        layer: this.fLayer || this.layer,
                        field: this.hasAttributeCustomExpression(c) ? null : c.name,
                        valueExpression: this.hasAttributeCustomExpression(c) ? c.valueExpression : null,
                        valueExpressionTitle: c.valueExpressionTitle,
                        normalizationType: a.normalizationType,
                        normalizationField: a.normalizationField,
                        theme: a.theme || "high-to-low",
                        basemap: this.getBasemapType(),
                        scheme: a.scheme,
                        statistics: a.statistics
                    }).then(g.hitch(this, function(d) {
                        if (!b.isRejected()) {
                            d.statistics = this.checkStatistics(d.statistics, this.isTypeDate(c) ? !0 : !1);
                            var e = { visualVariables: [{ type: "colorInfo", minSliderValue: h.isDefined(a.minValue) ? a.minValue : d.statistics.min, maxSliderValue: h.isDefined(a.maxValue) ? a.maxValue : d.statistics.max, theme: a.theme || "high-to-low" }] },
                                f = "ratio" === this.getRendererStyle(this.renderer) ? this._rendererRatioLegendCheck : this._rendererColorLegendCheck;
                            this.updateLegendProperty(d.colorInfo, "colorInfo", f && f.get("checked"));
                            b.resolve({ colorInfo: d.colorInfo, statistics: d.statistics, authoringInfo: e, scheme: d.scheme })
                        }
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "createColorInfo", !0), b.reject()) }));
                    return b
                },
                applyColorRenderer: function(a, b, c) {
                    a.authoringInfo && (a.authoringInfo.classificationMethod ? a.classificationMethod = a.authoringInfo.classificationMethod : delete a.classificationMethod);
                    b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    this.updateColorRendererGrid();
                    !this.hasDynamic && (b !== this.getRendererStyle(a) || c) && this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                updateSymbolOnColorRenderer: function(b, c) {
                    b = b || {};
                    c = c || this.renderer;
                    if (!b.colors && !b.symbol) return c;
                    this.disableSliderChangeEvent();
                    var d = this.getVisualVariableByType("colorInfo", null, c.visualVariables);
                    if (d) {
                        if (b.symbol) {
                            var e = c.infos[0];
                            c.clearBreaks();
                            var f = p.fromJson(b.symbol.toJson()),
                                f = this.switchSymbolKeepColor(f, e.symbol);
                            c.addBreak({ minValue: e.minValue, maxValue: e.maxValue, symbol: f, label: e.label })
                        }
                        b.colors && (a.forEach(d.stops, function(a, c) { a.color = b.colors[c] }),
                            this.replaceVisualVariable("colorInfo", null, d, c), this.updateColorSlider(c))
                    } else b.symbol && (d = c.infos, c.clearBreaks(), a.forEach(d, function(a, d) {
                        d = p.fromJson(b.symbol.toJson());
                        "picturemarkersymbol" === d.type && (d = this.getDefaultSymbol(this.geometryType));
                        d = this.switchSymbolKeepColor(d, a.symbol);
                        c.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: d, label: a.label })
                    }, this)), b.colors && (d = c.infos, c.clearBreaks(), a.forEach(d, function(a, d) {
                        c.addBreak({
                            minValue: a.minValue,
                            maxValue: a.maxValue,
                            symbol: a.symbol.setColor(b.colors[Math.min(d,
                                b.colors.length - 1)]),
                            label: a.label
                        })
                    }), this.updateColorSlider(c));
                    setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(b) }), 1E3);
                    return c
                },
                updateOutlineWidthOnColorRenderer: function(b) {
                    var c = this.renderer.infos;
                    this.renderer.clearBreaks();
                    a.forEach(c, function(a, c) { this.renderer.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: this.setOutlineWidthOfSymbol(a.symbol, b), label: a.label }) }, this);
                    this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol,
                        b));
                    this.defaultInfo && this.defaultInfo.defaultSymbol && (this.defaultInfo.defaultSymbol = this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, b))
                },
                updateColorRenderer: function(a, b) {
                    b = b || this._rendererColorOtherSymbol;
                    h.isDefined(a) && "esriGeometryPolygon" === this.geometryType ? a ? (this.updateOutlineWidthOnColorRenderer(1), this.getSuggestedOutline().then(g.hitch(this, function(a) {
                        this.replaceVisualVariable("sizeInfo", "outline", a.widthInfo, this.renderer);
                        this.applyColorRenderer(this.renderer)
                    }), g.hitch(this,
                        function(a) {
                            a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables);
                            this.renderer.setVisualVariables(a);
                            this.applyColorRenderer(this.renderer)
                        }))) : (a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), this.renderer.setVisualVariables(a), this.applyColorRenderer(this.renderer)) : this.applyColorRenderer(this.renderer);
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(b) :
                        (this.drawSymbol(b, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, b))
                },
                updateSchemeOnColorRenderer: function(b) {
                    b = b || {};
                    if (!b.scheme) return c;
                    var c = b.renderer || this.renderer,
                        d = this.getVisualVariableByType("colorInfo", null, c.visualVariables);
                    if (d) {
                        var e = b.scheme.colors;
                        b = d.stops.length - 1;
                        if (m.toJsonColor(e[0]).toString() === m.toJsonColor(d.stops[0].color).toString() && m.toJsonColor(e[b]).toString() === m.toJsonColor(d.stops[b].color).toString() ||
                            m.toJsonColor(e[0]).toString() === m.toJsonColor(d.stops[b].color).toString() && m.toJsonColor(e[b]).toString() === m.toJsonColor(d.stops[0].color).toString()) return c;
                        a.forEach(d.stops, function(a, b) { a.color = e[b] });
                        this.replaceVisualVariable("colorInfo", null, d, c)
                    } else {
                        d = c.infos;
                        e = b.scheme.colorsForClassBreaks[d.length - 1].colors;
                        b = d.length - 1;
                        if (m.toJsonColor(e[0]).toString() === m.toJsonColor(d[0].symbol.color).toString() && m.toJsonColor(e[b]).toString() === m.toJsonColor(d[b].symbol.color).toString() || m.toJsonColor(e[0]).toString() ===
                            m.toJsonColor(d[b].symbol.color).toString() && m.toJsonColor(e[b]).toString() === m.toJsonColor(d[0].symbol.color).toString()) return c;
                        c.clearBreaks();
                        a.forEach(d, function(a, b) { c.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: a.symbol.setColor(e[b]), label: a.label }) }, this)
                    }
                    this.updateColorSlider(c);
                    return c
                },
                updateThemeOnColorRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    this.scheme = null;
                    var c = this.getRendererDataRange("colorInfo");
                    this.buildColorRenderer({
                        classified: a.classified,
                        theme: a.theme,
                        normalizationType: a.normalizationType,
                        normalizationField: a.normalizationField,
                        minValue: c.min,
                        maxValue: c.max,
                        showOthers: a.showOthers
                    }).then(g.hitch(this, function(c) {
                        b.isRejected() || (this.renderer = c.renderer, this.disableSliderChangeEvent(), c = this.getHandleInfo(a.theme), this.updateColorSlider(), this.colorSlider && this.colorSlider.set("handles", c.handles), this.colorSlider && this.colorSlider.set("primaryHandle", c.primaryHandle), setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }),
                            1E3), b.resolve(this.renderer))
                    }), g.hitch(this, function(a) { b.isRejected() || b.reject() }));
                    return b
                },
                updateRendererProperties: function(a, b) {
                    b = b || this.renderer;
                    a = a || {};
                    b = this.updateSymbolOnColorRenderer(a, b);
                    a.showOthers ? (b.defaultSymbol = a.defaultSymbol, b.defaultLabel = a.defaultLabel) : a.showOthers || (delete b.defaultSymbol, delete b.defaultLabel);
                    a.rotationInfo && (b.setRotationInfo(a.rotationInfo), this.removeRotationInfoVisualVariable(b));
                    return b
                },
                createColorInfoSlider: function(a) {
                    var b = a.attributeItem ||
                        this.attributeItem,
                        c = function(a, c) {
                            var d = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                                e = this.getRendererDataRange("colorInfo");
                            if (a.statistics && 0 !== a.statistics.count && ("esriFieldTypeInteger" != b.type && "esriFieldTypeSmallInteger" != b.type || "percent-of-total" !== a.normalizationType)) f = this.getHandleInfo(a.theme, d.stops), this.getHistogram(dojo.mixin(a, {
                                field: this.hasAttributeCustomExpression(b) ? null : b.name,
                                valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null,
                                numBins: this.numHistogramBins,
                                classificationMethod: "equal-interval",
                                minValue: e.min,
                                maxValue: e.max
                            })).then(g.hitch(this, function(g) {
                                c.isRejected() || (this.onCalculationsSource(g), this.colorSlider = new t({
                                    colorInfo: d,
                                    statistics: a.statistics,
                                    histogram: g,
                                    minValue: h.isDefined(e.min) ? e.min : null,
                                    maxValue: h.isDefined(e.max) ? e.max : null,
                                    handles: f.handles,
                                    primaryHandle: f.primaryHandle,
                                    showLabel: !0,
                                    showTick: !0,
                                    showRatioLabels: a.showRatioLabels,
                                    histogramWidth: 70,
                                    isDate: this.isTypeDate(b) && -1 < dojo.indexOf(["color",
                                        "colorsize", "colorAgeSize"
                                    ], this.getRendererStyle(this.renderer))
                                }, a.colorSliderDivId || "rendererColorSlider"), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a), c.resolve())
                            }), g.hitch(this, function(g) {
                                c.isRejected() || (this.colorSlider = new t({
                                    colorInfo: d,
                                    statistics: a.statistics,
                                    histogram: null,
                                    minValue: e.min,
                                    maxValue: e.max,
                                    handles: f.handles,
                                    primaryHandle: f.primaryHandle,
                                    showLabel: !0,
                                    showTick: !0,
                                    showRatioLabels: a.showRatioLabels,
                                    histogramWidth: 70,
                                    isDate: this.isTypeDate(b) && -1 < dojo.indexOf(["color",
                                        "colorsize", "colorAgeSize"
                                    ], this.getRendererStyle(this.renderer))
                                }, a.colorSliderDivId || "rendererColorSlider"), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a), c.resolve())
                            }));
                            else {
                                var f = this.getHandleInfo(a.theme, d.stops);
                                this.colorSlider = new t({
                                    colorInfo: d,
                                    statistics: a.statistics,
                                    minValue: h.isDefined(e.min) ? Math.min(e.min, d.stops[0].value) : null,
                                    maxValue: h.isDefined(e.max) ? Math.max(e.max, d.stops[d.stops.length - 1].value) : null,
                                    showHistogram: !1,
                                    handles: f.handles,
                                    primaryHandle: f.primaryHandle,
                                    showLabel: !0,
                                    showTick: !0,
                                    showRatioLabels: a.showRatioLabels,
                                    histogramWidth: 70,
                                    isDate: this.isTypeDate(b) && -1 < dojo.indexOf(["color", "colorsize", "colorAgeSize"], this.getRendererStyle(this.renderer))
                                }, "rendererColorSlider");
                                this.colorSlider.startup();
                                this.enableColorSliderChangeEvent(a);
                                c.resolve()
                            }
                        },
                        e = new d;
                    setTimeout(function() { e.progress(e) }, 1);
                    a = a || {};
                    this.destroyColorSlider(a);
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        e.isRejected() || (a.statistics ?
                            (this.displayZeroFeaturesMsg(a.statistics.count), this.onCalculationsSource(a.statistics), g.hitch(this, c, a, e)()) : (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics({ field: this.hasAttributeCustomExpression(b) ? null : b.name, valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null, normalizationType: a.normalizationType, normalizationField: a.normalizationField }).then(g.hitch(this, function(b) {
                                e.isRejected() || (a.statistics = b, this.displayZeroFeaturesMsg(b.count), this.onCalculationsSource(b),
                                    g.hitch(this, c, a, e)())
                            }), g.hitch(this, function(b) { e.isRejected() || (b && b.message && -1 < b.message.indexOf("valueExpression has unknown field names") || this.handleError(b, "getFieldStatistics", !1), g.hitch(this, c, a, e)()) })))
                    }), g.hitch(this, function(a) { e.isRejected() || (this.handleError(a, "addPlugin", !1), e.reject()) }));
                    return e
                },
                createClassedColorInfoSlider: function(a, b) {
                    var c = a.attributeItem || this.attributeItem,
                        e = function(a, b) {
                            var d = this.getRendererDataRange("colorInfo");
                            this.getHistogram(dojo.mixin(a, {
                                field: this.hasAttributeCustomExpression(c) ?
                                    null : c.name,
                                valueExpression: this.hasAttributeCustomExpression(c) ? c.valueExpression : null,
                                minValue: d.min,
                                maxValue: d.max
                            })).then(g.hitch(this, function(c) {
                                b.isRejected() || (this.onCalculationsSource(c), this.colorSlider = new x({ breakInfos: g.clone(this.renderer.infos), classificationMethod: a.classificationMethod, normalizationType: a.normalizationType, statistics: a.statistics, histogram: c, minValue: d.min, maxValue: d.max, showLabel: !0, showTick: !0, showHandles: 10 < this.renderer.infos.length ? !1 : !0, histogramWidth: 70 },
                                    "rendererColorSlider"), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a), this.precisionsStore = this.buildPrecisionsStore(this.renderer), this._rendererColorPrecision.setStore(this.precisionsStore, "", {}), b.resolve())
                            }), g.hitch(this, function(c) {
                                b.isRejected() || (this.colorSlider = new x({
                                    breakInfos: g.clone(this.renderer.infos),
                                    classificationMethod: a.classificationMethod,
                                    normalizationType: a.normalizationType,
                                    statistics: a.statistics,
                                    histogram: null,
                                    minValue: d.min,
                                    maxValue: d.max,
                                    showLabel: !0,
                                    showTick: !0,
                                    showHandles: 10 < this.renderer.infos.length ? !1 : !0,
                                    histogramWidth: 70
                                }, "rendererColorSlider"), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a), this.precisionsStore = this.buildPrecisionsStore(this.renderer), this._rendererColorPrecision.setStore(this.precisionsStore, "", {}), b.resolve())
                            }))
                        };
                    b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    this.destroyColorSlider(a);
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        b.isRejected() ||
                            (a.statistics ? (this.displayZeroFeaturesMsg(a.statistics.count), this.onCalculationsSource(a.statistics), g.hitch(this, e, a, b)()) : (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics({ field: this.hasAttributeCustomExpression(c) ? null : c.name, valueExpression: this.hasAttributeCustomExpression(c) ? c.valueExpression : null, normalizationType: a.normalizationType, normalizationField: a.normalizationField }).then(g.hitch(this, function(c) {
                                b.isRejected() || (a.statistics = c, this.displayZeroFeaturesMsg(c.count), this.onCalculationsSource(c),
                                    g.hitch(this, e, a, b)())
                            }), g.hitch(this, function(c) { b.isRejected() || (this.handleError(c, "getFieldStatistics", !1), g.hitch(this, e, a, b)()) })))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                },
                updateColorSlider: function(a, b) {
                    if (this.colorSlider) {
                        a = a || this.renderer;
                        var c = this.getVisualVariableByType("colorInfo", null, a.visualVariables);
                        c ? (this.clearZoom(), !b && (this.renderer.authoringInfo || this.authoringInfo) && (a = this.getVisualVariableByType("colorInfo",
                            null, (this.renderer.authoringInfo || this.authoringInfo).visualVariables)) && (this.colorSlider.set("minValue", a.minSliderValue), this.colorSlider.set("maxValue", a.maxSliderValue)), this.colorSlider.set("colorInfo", c), b && (this.colorSlider.set("statistics", b), this.colorSlider.set("minValue", b.min), this.colorSlider.set("maxValue", b.max), this.colorSlider.set("histogram", null), this.getParams().then(g.hitch(this, function(a) {
                            var d, e;
                            c.valueExpression ? d = c.valueExpression : this.hasAttributeCustomExpression(this.attributeItem) ?
                                d = this.attributeItem.valueExpression : e = this.attributeItem.name;
                            this.getHistogram(g.mixin(a, { field: e, valueExpression: d, minValue: b.min, maxValue: b.max })).then(g.hitch(this, function(a) { this.colorSlider.set("histogram", a) }), g.hitch(this, function(a) {}))
                        })))) : (this.colorSlider.set("breakInfos", g.clone(a.infos)), a = this.getRendererDataRange("colorInfo"), h.isDefined(a.min) && h.isDefined(a.max) && (this.colorSlider.set("minValue", a.min), this.colorSlider.set("maxValue", a.max)))
                    }
                },
                enableColorSliderChangeEvent: function(a) {
                    if (this.colorSlider) {
                        a =
                            a || {};
                        var b = a.attributeItem || this.attributeItem;
                        this.sliderZoomedHandler = this.colorSlider.on("zoomed", g.hitch(this, function(a) {!1 === a && this.clearZoom() }));
                        if (this.colorSlider instanceof t) {
                            var c = "handle-value-change";
                            this.layer && this.layer.hasWebGLSurface && this.layer.hasWebGLSurface() && (c = "data-change");
                            this.sliderChangeHandler = this.colorSlider.on(c, g.hitch(this, function(b) {
                                this.replaceVisualVariable("colorInfo", null, b.colorInfo ? b.colorInfo : b, this.renderer);
                                this.updateStopLabels && this.updateStopLabels();
                                this.applyColorRenderer(this.renderer, a);
                                this.onColorSliderChange()
                            }));
                            this.sliderChangeHandler2 = this.colorSlider.on("data-value-change", g.hitch(this, function(c) {
                                var d = this.getVisualVariableByType("colorInfo", null, this.authoringInfo.visualVariables);
                                d.minSliderValue = c.minValue;
                                d.maxSliderValue = c.maxValue;
                                this.replaceVisualVariable("colorInfo", null, d, this.authoringInfo);
                                this.updateStopLabels && this.updateStopLabels();
                                this.applyColorRenderer(this.renderer, a);
                                this.onColorSliderChange();
                                this.getParams().then(g.hitch(this,
                                    function(a) {
                                        this.getHistogram(dojo.mixin(a, { field: this.hasAttributeCustomExpression(b) ? null : b.name, valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null, minValue: c.minValue, maxValue: c.maxValue })).then(g.hitch(this, function(b) {
                                            this.onCalculationsSource(b);
                                            this.disableSliderChangeEvent();
                                            this.colorSlider.set("histogram", b);
                                            setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3)
                                        }), g.hitch(this, function(b) {
                                            this.handleError(b, "getHistogram", !1);
                                            this.disableSliderChangeEvent();
                                            this.colorSlider.set("histogram", null);
                                            setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3)
                                        }))
                                    }))
                            }))
                        } else this.sliderChangeHandler = this.colorSlider.on("handle-value-change", g.hitch(this, function(b) { this.updateBreakInfos(b.breakInfos ? b.breakInfos : b, a) })), this.sliderChangeHandler2 = this.colorSlider.on("data-value-change", g.hitch(this, function(c) {
                            this.updateBreakInfos(c.breakInfos, a);
                            this.precisionsStore = this.buildPrecisionsStore(this.renderer);
                            this._rendererColorPrecision.setStore(this.precisionsStore,
                                "", {});
                            this.getParams().then(g.hitch(this, function(a) {
                                this.getHistogram(dojo.mixin(a, { field: this.hasAttributeCustomExpression(b) ? null : b.name, valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null, minValue: c.minValue, maxValue: c.maxValue })).then(g.hitch(this, function(b) {
                                    this.onCalculationsSource(b);
                                    this.disableSliderChangeEvent();
                                    this.colorSlider.set("histogram", b);
                                    setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3)
                                }), g.hitch(this, function(b) {
                                    this.handleError(b,
                                        "getHistogram", !1);
                                    this.disableSliderChangeEvent();
                                    this.colorSlider.set("histogram", null);
                                    setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3)
                                }))
                            }))
                        }))
                    }
                },
                updateBreakInfos: function(b, c) {
                    this.renderer.clearBreaks();
                    a.forEach(b, function(a, b) { this.renderer.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: a.symbol, label: a.label }) }, this);
                    this.applyColorRenderer(this.renderer, c);
                    this.onColorSliderChange()
                },
                disableSliderChangeEvent: function() {
                    this.sliderZoomedHandler && this.sliderZoomedHandler.remove();
                    this.sliderZoomedHandler = null;
                    this.sliderChangeHandler && this.sliderChangeHandler.remove();
                    this.sliderChangeHandler = null;
                    this.sliderChangeHandler2 && this.sliderChangeHandler2.remove();
                    this.sliderChangeHandler2 = null
                },
                zoomInSlider: function(a) {
                    if (this.colorSlider) {
                        var b = new d;
                        setTimeout(function() { b.progress(b) }, 1);
                        a = a || {};
                        var c = a.attributeItem || this.attributeItem,
                            e = this.colorSlider.get("statistics"),
                            f = this.colorSlider.get("handles"),
                            m = this.colorSlider.get("colorInfo").stops[f[0]].value,
                            f = this.colorSlider.get("colorInfo").stops[f[f.length -
                                1]].value,
                            n = f - m,
                            p, r;
                        e.min === e.max ? (p = m - n / 3, r = f + n / 3, m = p, e = r) : (p = Math.max(m - n / 3, Math.min(e.min, this.colorSlider.minValue)), r = Math.min(f + n / 3, Math.max(e.max, this.colorSlider.maxValue)), m = h.isDefined(a.minValue) ? a.minValue : Math.min(e.min, this.colorSlider.minValue), e = h.isDefined(a.maxValue) ? a.maxValue : Math.max(e.max, this.colorSlider.maxValue));
                        p === m && r === e ? b.reject() : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            b.isRejected() || this.getHistogram(dojo.mixin(a, { field: this.hasAttributeCustomExpression(c) ? null : c.name, valueExpression: this.hasAttributeCustomExpression(c) ? c.valueExpression : null, minValue: p, maxValue: r })).then(g.hitch(this, function(c) { b.isRejected() || (this.onCalculationsSource(c), c = { histogram: c, minSliderValue: p, maxSliderValue: r }, this.disableSliderChangeEvent(), this.colorSlider.set("zoomOptions", c), setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3), b.resolve()) }), g.hitch(this, function(c) {
                                b.isRejected() || (c = {
                                    histogram: null,
                                    minSliderValue: p,
                                    maxSliderValue: r
                                }, this.disableSliderChangeEvent(), this.colorSlider.set("zoomOptions", c), setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3), b.resolve())
                            }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                        return b
                    }
                },
                zoomOutSlider: function() {
                    this.disableSliderChangeEvent();
                    this.colorSlider && null !== this.colorSlider.get("zoomOptions") && this.colorSlider.set("zoomOptions", null);
                    setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent() }),
                        1E3)
                },
                getHistogram: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    this.histogramInfo && this.histogramInfo.field === a.field && this.histogramInfo.valueExpression === a.valueExpression && this.histogramInfo.normalizationType === a.normalizationType && this.histogramInfo.normalizationField === a.normalizationField && this.histogramInfo.minValue === a.minValue && this.histogramInfo.maxValue === a.maxValue ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this,
                        function() {
                            b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram({ field: a.field, valueExpression: a.valueExpression, numBins: this.numHistogramBins, classificationMethod: "equal-interval", normalizationType: a.normalizationType, normalizationField: a.normalizationField, minValue: a.minValue, maxValue: a.maxValue }).then(g.hitch(this, function(c) {
                                b.isRejected() || (this.histogramInfo = {
                                    histogram: c,
                                    field: a.field,
                                    valueExpression: a.valueExpression,
                                    normalizationType: a.normalizationType,
                                    normalizationField: a.normalizationField,
                                    minValue: a.minValue,
                                    maxValue: a.maxValue
                                }, b.resolve(c))
                            }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram", !1), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                },
                getHandleInfo: function(a, b) {
                    if (b && 5 !== b.length) return { handles: dojo.map(b, function(a, b) { return b }), primaryHandle: null };
                    switch (a) {
                        case "high-to-low":
                            return { handles: [0, 4], primaryHandle: null };
                        case "above-and-below":
                            return { handles: [0, 2, 4], primaryHandle: 2 };
                        case "centered-on":
                            return { handles: [0, 2, 4], primaryHandle: 2 };
                        case "extremes":
                            return { handles: [0, 2, 4], primaryHandle: null };
                        case "group-similar":
                            return { handles: [0, 1, 2, 3, 4], primaryHandle: null }
                    }
                },
                destroyColorSlider: function(a) {
                    this.disableSliderChangeEvent();
                    this.colorSlider && this.colorSlider.destroy();
                    c.byId(a.colorSliderDivId || "rendererColorSlider") || f.create("div", { id: a.colorSliderDivId || "rendererColorSlider" }, a.colorSliderDivId ? this._rendererRatioSliderDiv : this._rendererColorSliderDiv)
                },
                findColorScheme: function(b,
                    c) {
                    if (-1 < a.indexOf(["uniquesize", "uniqueAgeSize"], this.getRendererStyle(b))) return null;
                    var d, e = this.getVisualVariableByType("colorInfo", null, b.visualVariables);
                    e ? (b = a.map(e.stops, function(a) { return a.color }), d = v.getMatchingSchemes({ theme: c || "high-to-low", colors: b, geometryType: this.geometryType })) : (b = a.filter(a.map(b.infos, function(a) { return a.symbol.color }), function(a) { return a })) && b.length && ((d = v.getMatchingSchemes({ theme: "high-to-low", colors: b, geometryType: this.geometryType })) && d.length || (d = v.getMatchingSchemes({
                        theme: "above-and-below",
                        colors: b,
                        geometryType: this.geometryType
                    })));
                    return d && d.length ? d[0] : null
                },
                updateColorRendererGrid: function(a) {
                    "rendererColorStack" !== arcgisonline.map.leftPanel.getLeftContentPanelStack() || this._rendererColorLegendClassesIcon && -1 === this._rendererColorLegendClassesIcon.className.indexOf("active") || (a = a || this.renderer, "classedColor" === this.getRendererStyle(a) && (this.colorRendererGrid ? this.colorRendererGrid.updateGrid(a) : (G = this.portalPanel._ColorGrid, this.colorRendererGrid = new G({
                        id: "rendererColorGrid",
                        renderer: a,
                        style: "position: relative; width: 100%; height:100%; overflow-y:hidden; overflow-x:hidden; padding:0;",
                        params: this.params
                    }, "rendererColorGrid")), this.adjustHeight()))
                },
                destroyColorRendererGrid: function() { this.colorRendererGrid && (this.colorRendererGrid.destroy(), this.colorRendererGrid = null, c.byId("rendererColorGrid") || f.create("div", { id: "rendererColorGrid" }, this._rendererColorGridContainer)) }
            }
        })
}, "esri/plugins/FeatureLayerStatistics": function() {
    define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/has dojo/Deferred dojo/on dojo/promise/all dojo/when dojo/string ../kernel ../config ../urlUtils ../Evented ../SpatialReference ../support/expressionUtils ../tasks/query ../tasks/StatisticDefinition ../tasks/GenerateRendererTask ../tasks/UniqueValueDefinition ../tasks/ClassBreaksDefinition ../tasks/GenerateRendererParameters ../tasks/generateRenderer ../tasks/GeometryService ../tasks/ProjectParameters ../layers/TileInfo ../layers/support/attributeUtils ../layers/HeatmapManager ../workers/heatmapCalculator ../geometry/mathUtils ../geometry/webMercatorUtils ../geometry/scaleUtils ../geometry/Point ../geometry/Extent".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U) {
            p = p.defaults;
            var V = P.prototype._calculateIntensityMatrix,
                C = P.calculateStats,
                X = K.prototype._getScreenPoints,
                N = /_value$/i,
                y = "min max avg stddev count sum variance".split(" "),
                q = n([v], {
                    declaredClass: "esri.plugins.FeatureLayerStatistics",
                    sampleSize: 500,
                    worldScale: 1E8,
                    generalizeForScale: 4E5,
                    generalizeForResolution: 105,
                    mapWidth: 1280,
                    mapHeight: 800,
                    mapPaddingRatioForFE: .25,
                    minDistance: 12,
                    minLength: 30,
                    minSize: 15,
                    minScaleRelaxationRatio: .25,
                    samplingThreshold: 2E4,
                    numBins: 10,
                    numClasses: 5,
                    classificationMethod: "equal-interval",
                    standardDeviationInterval: 1,
                    geometryServiceUrl: r.getProtocolForWebResource() + "//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",
                    tileInfo: new L({
                        rows: 256,
                        cols: 256,
                        dpi: 96,
                        format: "JPEG",
                        compressionQuality: 90,
                        origin: { x: -2.0037508342787E7, y: 2.0037508342787E7 },
                        spatialReference: { wkid: 102100, latestWkid: 3857 },
                        lods: [{ level: 0, resolution: 156543.03392800014, scale: 5.91657527591555E8 }, {
                                level: 1,
                                resolution: 78271.51696399994,
                                scale: 2.95828763795777E8
                            }, { level: 2, resolution: 39135.75848200009, scale: 1.47914381897889E8 }, { level: 3, resolution: 19567.87924099992, scale: 7.3957190948944E7 }, { level: 4, resolution: 9783.93962049996, scale: 3.6978595474472E7 }, { level: 5, resolution: 4891.96981024998, scale: 1.8489297737236E7 }, { level: 6, resolution: 2445.98490512499, scale: 9244648.868618 }, { level: 7, resolution: 1222.992452562495, scale: 4622324.434309 }, { level: 8, resolution: 611.4962262813797, scale: 2311162.217155 }, { level: 9, resolution: 305.74811314055756, scale: 1155581.108577 },
                            { level: 10, resolution: 152.87405657041106, scale: 577790.554289 }, { level: 11, resolution: 76.43702828507324, scale: 288895.277144 }, { level: 12, resolution: 38.21851414253662, scale: 144447.638572 }, { level: 13, resolution: 19.10925707126831, scale: 72223.819286 }, { level: 14, resolution: 9.554628535634155, scale: 36111.909643 }, { level: 15, resolution: 4.77731426794937, scale: 18055.954822 }, { level: 16, resolution: 2.388657133974685, scale: 9027.977411 }, { level: 17, resolution: 1.1943285668550503, scale: 4513.988705 }, {
                                level: 18,
                                resolution: .5971642835598172,
                                scale: 2256.994353
                            }, { level: 19, resolution: .29858214164761665, scale: 1128.497176 }
                        ]
                    }),
                    _outlineInfo: [{ size: 10, width: 0 }, { size: 20, width: .5 }, { size: 80, width: 1 }, { size: 250, width: 2 }],
                    _srcQuery: "service-query",
                    _srcGenRend: "service-generate-renderer",
                    _srcMemory: "features-in-memory",
                    _srcFeatures: "features",
                    _log10e: Math.LOG10E,
                    _reNumber: /\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,
                    constructor: function(a) {
                        b.mixin(this, a);
                        this._sampleCache = this._maxFeaturesForStats = null;
                        this._gsTask = p.geometryService || new H(this.geometryServiceUrl);
                        if (this.layer.loaded) this._createGRTask();
                        else d.once(this.layer, "load", b.hitch(this, this._createGRTask))
                    },
                    destroy: function() {
                        this.clearFeaturesCache();
                        this.layer = this._grTask = null
                    },
                    clearFeaturesCache: function() { this._sampleCache = this._maxFeaturesForStats = null },
                    getUniqueValues: function(a) {
                        var b = new c;
                        a && (a.field || a.valueExpression) ? this._callAfterLoad(this._fetchFeatures, { dfd: b, params: a }, this._findUniqueValues) : this._rejectDfd(b, "FeatureLayerStatistics.getUniqueValues: 'field' or 'valueExpression' parameter is required.");
                        return b.promise
                    },
                    getPredominantCategories: function(a) {
                        var b = new c;
                        a && a.fields ? 2 > a.fields.length ? this._rejectDfd(b, "FeatureLayerStatistics.getPredominantCategories: invalid fields. Minimum required is 2.") : this._callAfterLoad(this._predominantCategories, { dfd: b, params: a }) : this._rejectDfd(b, "FeatureLayerStatistics.getPredominantCategories: 'fields' parameter is missing.");
                        return b.promise
                    },
                    getPredominanceExpressions: function(a) {
                        var b = new c;
                        a && a.fields ? 2 > a.fields.length ? this._rejectDfd(b, "FeatureLayerStatistics.getPredominanceExpressions: invalid fields. Minimum required is 2.") :
                            this._callAfterLoad(this._predominanceExpressions, { dfd: b, params: a }) : this._rejectDfd(b, "FeatureLayerStatistics.getPredominanceExpressions: 'fields' parameter is missing.");
                        return b.promise
                    },
                    getAgeStatistics: function(a) {
                        var b = new c;
                        null == a.startTime || null == a.endTime || null == a.units ? this._rejectDfd(b, "FeatureLayerStatistics.getAgeStatistics: 'startTime', 'endTime' or 'units' parameter is missing.") : this._callAfterLoad(this._ageStatistics, { dfd: b, params: a });
                        return b.promise
                    },
                    getSuggestedAgeUnits: function(a) {
                        var b =
                            new c;
                        null == a.startTime || null == a.endTime ? this._rejectDfd(b, "FeatureLayerStatistics.getSuggestedAgeUnits: 'startTime' or 'endTime' parameter is missing.") : this._callAfterLoad(this._suggestedAgeUnits, { dfd: b, params: a });
                        return b.promise
                    },
                    getAgeExpressions: function(a) {
                        var b = new c;
                        null == a.startTime || null == a.endTime ? this._rejectDfd(b, "FeatureLayerStatistics.getAgeExpressions: 'startTime' or 'endTime' parameter is missing.") : this._callAfterLoad(this._ageExpressions, { dfd: b, params: a });
                        return b.promise
                    },
                    getFieldStatistics: function(a) {
                        var b =
                            new c;
                        a && (a.field || a.valueExpression || a.sqlExpression) ? this._callAfterLoad(this._getFieldStats, { dfd: b, params: a }) : this._rejectDfd(b, "FeatureLayerStatistics.getFieldStatistics: 'field', 'valueExpression' or 'sqlExpression' parameter is required.");
                        return b.promise
                    },
                    getSuggestedDataRange: function(a) {
                        var b = a && a.statistics;
                        if (b) {
                            var c, d;
                            null == b.min ? a.isDate ? (a = this._getYearOfDate(), c = a[0], d = a[1]) : (c = 0, d = 100) : b.min === b.max && (a.isDate ? (a = this._getYearOfDate(b.min), c = a[0], d = a[1]) : 0 > b.min ? (c = 2 * b.min, d = 0) :
                                0 < b.min ? (c = 0, d = 2 * b.min) : (c = 0, d = 100));
                            return { min: null != c ? c : b.min, max: null != d ? d : b.max, defaultStatistics: null != c || null != d }
                        }
                    },
                    getSpatialStatistics: function(a) {
                        var b = new c;
                        a && a.features && a.features.length ? this._callAfterLoad(this._spatialStats, { dfd: b, params: a }) : this._rejectDfd(b, "FeatureLayerStatistics.getSpatialStatistics: 'features' parameter is missing or it has no features.");
                        return b.promise
                    },
                    getSuggestedSizeRange: function(a) {
                        var b = new c;
                        this._callAfterLoad(this._getSizeRange, { dfd: b, params: a });
                        return b.promise
                    },
                    getSuggestedOutline: function(a) {
                        var b = new c;
                        this._callAfterLoad(this._getOutline, { dfd: b, params: a });
                        return b.promise
                    },
                    getHeatmapStatistics: function(a) {
                        var b = new c;
                        this._callAfterLoad(this._getHeatmapStats, { dfd: b, params: a });
                        return b.promise
                    },
                    getHistogram: function(a) {
                        var b = new c;
                        a && (a.field || a.valueExpression || a.sqlExpression) ? this._callAfterLoad(this._fetchFeatures, { dfd: b, params: a }, this._getHistogram) : this._rejectDfd(b, "FeatureLayerStatistics.getHistogram: 'field', 'valueExpression' or 'sqlExpression' parameter is required.");
                        return b.promise
                    },
                    getSampleFeatures: function(a) {
                        var d = new c;
                        a = b.mixin({}, a);
                        a.caching = null != a.caching ? a.caching : !0;
                        a.sampleSize = a.sampleSize || this.sampleSize;
                        this._callAfterLoad(this._sampleFeatures, { dfd: d, params: a });
                        return d.promise
                    },
                    getSuggestedScaleRange: function(a) {
                        var b = new c;
                        this._callAfterLoad(this._scaleRange, { dfd: b, params: a });
                        return b.promise
                    },
                    getClassBreaks: function(a) {
                        var b = new c;
                        a && (a.field || a.valueExpression) ? this._callAfterLoad(this._fetchFeatures, { dfd: b, params: a }, this._findClassBreaks) :
                            this._rejectDfd(b, "FeatureLayerStatistics.getClassBreaks: 'field' or 'valueExpression' parameter is required.");
                        return b.promise
                    },
                    _isCollection: function() { return !this.layer.url || -1 < this.layer.declaredClass.indexOf("CSVLayer") },
                    _getFieldStats: function(a) {
                        var c = this,
                            d = a.params,
                            f = b.isFunction(d.field),
                            g = d.valueExpression || d.sqlExpression,
                            h = g && !d.sqlExpression,
                            m = this._isCollection() || d.features,
                            n = f || h,
                            p = (f = d.field && !f ? this.layer.getField(d.field) : null) ? f.type === this._dateType : !1;
                        if (f) {
                            if (this._rejectIfInvalidType(a.dfd,
                                    f, "getFieldStatistics", [].concat(this._numericTypes).concat(this._dateType))) return;
                            if (p && d.normalizationType) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getFieldStatistics: normalization is not supported when calculating statistics for date field."); return }
                        } else if (g) {
                            if (d.normalizationType) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getFieldStatistics: normalization is not supported when valueExpression or sqlExpression is specified."); return }
                            if (h && (h = this._getExpressionInfo(d.valueExpression),
                                    this._rejectIfInvalidExpression(a.dfd, h, "getFieldStatistics"))) return
                        }
                        m || n ? (g = !m && n ? this._fetchMaxFeaturesForStats() : null, e(g).always(function(e) {
                            var f = e && e.features;
                            f && (d = b.mixin({}, d), d.features = f);
                            c._statsFromMemory(d, p).then(function(b) { c._resolveStats(a.dfd, b, e && e.hasAllFeatures) }).otherwise(function(b) { c._rejectDfd(a.dfd, "FeatureLayerStatistics.getFieldStatistics: unable to calculate field statistics.") })
                        })) : this._canUseSQL92Expression() || !p && !g ? (d.normalizationType ? this._statsFromGenRend(d) :
                            this._statsFromQuery(d, p)).then(function(b) { c._resolveStats(a.dfd, b) }).otherwise(function(f) {
                            e(c._fetchMaxFeaturesForStats()).always(function(e) {
                                var f = e && e.features;
                                f && (d = b.mixin({}, d), d.features = f);
                                c._statsFromMemory(d, p).then(function(b) { c._resolveStats(a.dfd, b, e && e.hasAllFeatures) }).otherwise(function(b) { c._rejectDfd(a.dfd, "FeatureLayerStatistics.getFieldStatistics: unable to calculate field statistics.") })
                            })
                        }) : this._rejectDfd(a.dfd, "FeatureLayerStatistics.getFieldStatistics: unable to calculate statistics. Make sure the layer supports SQL expressions and standardized queries.")
                    },
                    _resolveStats: function(a, b, c) {
                        for (var d in b) - 1 < g.indexOf(y, d) && (this._isValidNumber(b[d]) || (b[d] = null));
                        b.partialData = null != c ? !c : !this._isCollection() && b.source === this._srcMemory;
                        a.resolve(b)
                    },
                    _statsFromQuery: function(a, c) {
                        var d;
                        this._canUseSQL92Expression() && c && (d = b.mixin({}, a), delete d.field, d.sqlExpression = this._msSinceUnixEpochSQL(a.field));
                        return this._executeStatsQuery(d || a).then(function(a) {
                            c && (g.forEach("min max avg stddev sum variance".split(" "), function(b) { null != a[b] && (a[b] = Math.ceil(a[b])) }),
                                a.min === a.max && null != a.min && (a.avg = a.min, a.stddev = a.variance = 0));
                            return a
                        })
                    },
                    _msSinceUnixEpochSQL: function(a) { return this._getDateDiffSQL(new Date(0), a, "milliseconds").sqlExpression },
                    _executeStatsQuery: function(a) {
                        var b = this.layer,
                            d = new c;
                        if (b.url && b.supportsStatistics) {
                            var e = new x,
                                f = this,
                                h = a.sqlExpression || a.field,
                                m = h ? this._getRangeExpr(h, a.minValue, a.maxValue) : null;
                            e.sqlFormat = a.sqlExpression ? "standard" : null;
                            e.where = this._mergeWhereClauses(a.sqlWhere, m);
                            e.outStatistics = g.map(y, function(a) {
                                var b =
                                    new B;
                                b.statisticType = "variance" === a ? "var" : a;
                                b.onStatisticField = h;
                                b.outStatisticFieldName = a + "_value";
                                return b
                            });
                            b.queryFeatures(e).then(function(a) {
                                a = (a = a && a.features) && a[0] && a[0].attributes;
                                var b, c = { source: f._srcQuery };
                                for (b in a) c[b.replace(N, "").toLowerCase()] = a[b];
                                c.min === c.max && null != c.min && null == c.stddev && (c.stddev = c.variance = 0);
                                d.resolve(c)
                            }).otherwise(function(a) { f._rejectDfd(d, "FeatureLayerStatistics: Statistics query operation failed.") })
                        } else this._rejectDfd(d, "FeatureLayerStatistics: Statistics query requires a layer that supports statistics.");
                        return d.promise
                    },
                    _mergeWhereClauses: function(a, b) { b && (a = a ? "(" + a + ") AND (" + b + ")" : b); return a },
                    _statsFromMemory: function(a, d) {
                        var e = new c,
                            f;
                        if ("percent-of-total" === a.normalizationType) {
                            f = this._calcStatsFromMemory({ field: a.field }).sum;
                            if (null == f) { this._rejectDfd(e, "getFieldStatistics: invalid normalizationTotal."); return }
                            a = b.mixin({ normalizationTotal: f }, a)
                        }
                        e.resolve(this._calcStatsFromMemory(a, d));
                        return e.promise
                    },
                    _calcStatsFromMemory: function(a, b) {
                        var c = !(!a.features || !a.features.length),
                            d = this._getDataValues(c ?
                                a.features : this.layer.graphics, a),
                            e = this._calcStatistics(d, !a.normalizationType);
                        e.source = c ? this._srcFeatures : this._srcMemory;
                        b && g.forEach(["avg", "stddev", "variance"], function(a) { null != e[a] && (e[a] = Math.ceil(e[a])) });
                        return e
                    },
                    _isValidNumber: function(a) { return "number" === typeof a && !isNaN(a) && Infinity !== a && -Infinity !== a },
                    _getDataValues: function(a, b) {
                        var c = M.createAttributeCache({
                                field: b.field,
                                valueExpression: b.valueExpression,
                                normalizationType: b.normalizationType,
                                normalizationField: b.normalizationField,
                                normalizationTotal: b.normalizationTotal
                            }),
                            d = null == b.minValue ? -Infinity : b.minValue,
                            e = null == b.maxValue ? Infinity : b.maxValue,
                            f = [];
                        g.forEach(a, function(a) {
                            a = a._getDataValue(c.attributeInfo, c, t, this.layer);
                            null != a && a >= d && a <= e && f.push(a)
                        }, this);
                        return f
                    },
                    _calcStatistics: function(a, b) {
                        var c = Infinity,
                            d = -Infinity,
                            e = 0,
                            f = null,
                            h = null,
                            m = null,
                            n = null;
                        g.forEach(a, function(a) {
                            e++;
                            f += a;
                            a < c && (c = a);
                            a > d && (d = a)
                        });
                        if (e) {
                            var h = f / e,
                                p = 0;
                            g.forEach(a, function(a) { p += Math.pow(a - h, 2) });
                            n = b ? 1 < e ? p / (e - 1) : 0 : 0 < e ? p / e : 0;
                            m = Math.sqrt(n)
                        }
                        return {
                            min: e ?
                                c : null,
                            max: e ? d : null,
                            count: e,
                            sum: f,
                            avg: h,
                            stddev: m,
                            variance: n
                        }
                    },
                    _statsFromGenRend: function(a) {
                        var b = new c,
                            d = this,
                            e = a.normalizationType,
                            f = a.normalizationField;
                        this.getClassBreaks({ field: a.field, classificationMethod: "standard-deviation", standardDeviationInterval: .25, normalizationType: e, normalizationField: "field" === e ? f : void 0, minValue: a.minValue, maxValue: a.maxValue }).then(function(a) {
                            var c, e, f;
                            g.some(a.classBreakInfos, function(a, b) { a.hasAvg && (c = a); return !!c });
                            c && (f = c.maxValue - c.minValue, e = c.minValue + f /
                                2, f *= 4);
                            b.resolve({ min: a.minValue, max: a.maxValue, avg: e, stddev: f, source: d._srcGenRend })
                        }).otherwise(function(a) { d._rejectDfd(b, "FeatureLayerStatistics.getFieldStatistics: unable to calculate class breaks.") });
                        return b.promise
                    },
                    _getYearOfDate: function(a) {
                        var b = ("number" === typeof a ? new Date(a) : new Date).getUTCFullYear(),
                            c = Date.UTC(b, 0, 1, 12, 0, 0, 0),
                            b = Date.UTC(b, 11, 31, 12, 0, 0, 0);
                        "number" === typeof a && (a < c && (c = a), a > b && (b = a));
                        return [c, b]
                    },
                    _spatialStats: function(a) {
                        var b = a.params.features,
                            c = this.layer.geometryType,
                            d = {},
                            c = { point: "esriGeometryPoint" === c, mPoint: "esriGeometryMultipoint" === c, line: "esriGeometryPolyline" === c, polygon: "esriGeometryPolygon" === c || this.layer.hasXYFootprint() };
                        c.point ? d = this._getPointStats(b) : c.mPoint ? d = this._getPointStats(b, !0) : c.line ? d = this._getLineStats(b) : c.polygon && (d = this._getPolygonStats(b));
                        d.avgXY = this._getAvgXY(b, c);
                        a.dfd.resolve(d)
                    },
                    _getPointStats: function(a, b) {
                        var c, d = a.length,
                            e, f, g = {},
                            h = {},
                            m = 0,
                            n = 0,
                            p = Infinity,
                            q = -Infinity,
                            r = 0,
                            u = 0,
                            t, v, w = [];
                        if (b)
                            for (c = 0; c < d; c++) a[c].geometry &&
                                w.push.apply(w, a[c].geometry.points);
                        else w = a;
                        d = w.length;
                        for (c = 0; c < d; c++)
                            if (b ? (g.x = w[c][0], g.y = w[c][1], e = g) : e = w[c].geometry, e) {
                                t = Infinity;
                                v = -Infinity;
                                for (a = 0; a < d; a++) a !== c && (b ? (h.x = w[a][0], h.y = w[a][1], f = h) : f = w[a].geometry, f && (f = O.getLength(e, f), 0 < f && (f < t && (t = f), f < p && (p = f), f > v && (v = f), f > q && (q = f))));
                                Infinity !== t && (++r, m += t); - Infinity !== v && (++u, n += v)
                            }
                        return { minDistance: Infinity !== p ? p : null, maxDistance: -Infinity !== q ? q : null, avgMinDistance: r ? m / r : null, avgMaxDistance: u ? n / u : null }
                    },
                    _getLineStats: function(a) {
                        var b,
                            c = a.length,
                            d, e = {},
                            f = {},
                            g = Infinity,
                            h = -Infinity,
                            m = 0,
                            n = 0;
                        for (b = 0; b < c; b++)
                            if (d = a[b].geometry) d = this._getLineLength(d, e, f), 0 < d && (++n, m += d, d < g && (g = d), d > h && (h = d));
                        return { minLength: Infinity !== g ? g : null, maxLength: -Infinity !== h ? h : null, avgLength: n ? m / n : null }
                    },
                    _getLineLength: function(a, b, c) {
                        a = a.paths;
                        var d, e = a.length,
                            f, g = 0;
                        for (d = 0; d < e; d++) f = a[d], f = this._getActualLineLength(f, b, c), 0 < f && (g += f);
                        return g
                    },
                    _getApproxLineLength: function(a, b, c) {
                        var d = a[0],
                            e = a[a.length - 1],
                            f = 0;
                        d && e && d[0] === e[0] && d[1] === e[1] && (e = a[a.length -
                            2]);
                        d && e && d !== e && (b.x = d[0], b.y = d[1], c.x = e[0], c.y = e[1], f = O.getLength(b, c));
                        return f
                    },
                    _getActualLineLength: function(a, b, c) {
                        var d, e = a.length,
                            f, g, h = 0;
                        for (d = 0; d < e - 1; d++) f = a[d], g = a[d + 1], f && g && (b.x = f[0], b.y = f[1], c.x = g[0], c.y = g[1], h += O.getLength(b, c));
                        return h
                    },
                    _getPolygonStats: function(a) {
                        var b, c = a.length,
                            d, e = Infinity,
                            f = -Infinity,
                            g = 0,
                            h = 0;
                        for (b = 0; b < c; b++) a[b].geometry && (d = a[b].geometry.getExtent()) && (d = (d.getWidth() + d.getHeight()) / 2, 0 < d && (++h, g += d, d < e && (e = d), d > f && (f = d)));
                        return {
                            minSize: Infinity !== e ? e : null,
                            maxSize: -Infinity !== f ? f : null,
                            avgSize: h ? g / h : null
                        }
                    },
                    _getAvgXY: function(a, b) {
                        var c, d, e, f = a.length,
                            g, h, m, n, p = null,
                            q = null,
                            r = 0,
                            u;
                        for (c = 0; c < f; c++)
                            if (d = a[c].geometry)
                                if (b.point) ++r, p += d.x, q += d.y;
                                else if (b.mPoint)
                            for (m = d.points, h = m.length, d = 0; d < h; d++) ++r, p += m[d][0], q += m[d][1];
                        else if (b.line)
                            for (n = d.paths, g = n.length, d = 0; d < g; d++)
                                for (m = n[d], h = m.length, e = 0; e < h; e++) ++r, p += m[e][0], q += m[e][1];
                        else if (b.polygon)
                            for (n = d.rings, g = n.length, d = 0; d < g; d++)
                                for (m = n[d], h = m.length, e = 0; e < h; e++) ++r, p += m[e][0], q += m[e][1];
                        null !=
                            p && null != q && (u = { x: p / r, y: q / r });
                        return u
                    },
                    _getSizeRange: function(a) {
                        var b = this,
                            c = a.params,
                            d = this.layer,
                            e = d.getMap();
                        if ("esriGeometryPolygon" === d.geometryType || d.hasXYFootprint())
                            if (e)
                                if (c && "visible-scale-range" === c.optimizeForScale) {
                                    var f = this._projectExtent(d.fullExtent, this.tileInfo.spatialReference);
                                    this.getSuggestedScaleRange({ map: !1 }).then(function(c) { b._processSizeRange(c.spatialStatistics, e, a.dfd, f, c) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedSizeRange: unable to calculate suggested scale range.") })
                                } else this._getFeatures(e,
                                    c).then(function(c) { b.getSpatialStatistics({ features: c }).then(function(c) { b._processSizeRange(c, e, a.dfd) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedSizeRange: unable to calculate spatial statistics.") }) }).otherwise(function(c) { b._rejectDfd(a.dfd, c.message) });
                        else this._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedSizeRange: layer has to be added to the map.");
                        else this._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedSizeRange: not supported for points and lines.")
                    },
                    _processSizeRange: function(a, b, c, d, f) {
                        var g = this;
                        e(d).always(function(d) {
                            d = d && d.hasOwnProperty("xmin") ? d : null;
                            g._calcSizeRange(a, b, c, d, f)
                        })
                    },
                    _getFeatures: function(a, b) {
                        var d = new c,
                            f = this;
                        b && b.useMapExtent ? (b = new x, b.geometry = a.extent, a = this.layer.queryFeatures(b)) : a = { features: this.layer.graphics.slice(0) };
                        e(a).then(function(a) {
                            (a = a && a.features) && a.length ? d.resolve(a) : f._rejectDfd(d, "FeatureLayerStatistics: layer has 0 features.")
                        }).otherwise(function(a) { f._rejectDfd(d, "FeatureLayerStatistics: unable to query features.") });
                        return d.promise
                    },
                    _calcSizeRange: function(a, b, c, d, e) {
                        var f = a && a.avgSize,
                            h = b.getResolution();
                        b = b.getScale();
                        if (null == f || isNaN(f)) this._rejectDfd(c, "FeatureLayerStatistics.getSuggestedSizeRange: invalid average feature size.");
                        else if (h && b) {
                            var m;
                            if (e) {
                                var n = h / b;
                                d = this._getScaleValues(d, e);
                                var p = d.feScaleIndex,
                                    q = [],
                                    r = [];
                                m = d.scales[p];
                                g.forEach(d.scales, function(a, b) {
                                    var c = this._calcSizeValues(f, n * a);
                                    b = -1 < p && b > p ? 2 : 1;
                                    q.push({ value: a, size: c.min / b });
                                    r.push({ value: a, size: c.max / b })
                                }, this);
                                d = {
                                    type: "sizeInfo",
                                    expression: "view.scale",
                                    valueExpression: "$view.scale",
                                    stops: q
                                };
                                h = { type: "sizeInfo", expression: "view.scale", valueExpression: "$view.scale", stops: r }
                            } else h = this._calcSizeValues(f, h), d = h.min, h = h.max;
                            c.resolve({ minSize: d, maxSize: h, spatialStatistics: a, avgFeatureSize: f, scaleAtFullExtent: m, suggestedScaleRange: e })
                        } else this._rejectDfd(c, "FeatureLayerStatistics.getSuggestedSizeRange: invalid map scale/resolution.")
                    },
                    _getScaleValues: function(a, b) {
                        var c = this.tileInfo.lods,
                            d = this.layer.minScale || c[0].scale,
                            c = this.layer.maxScale ||
                            c[c.length - 1].scale,
                            e = b && b.minScale || 0;
                        b = b && b.maxScale || 0;
                        a = (a = a && this._findLODForFE(this.tileInfo.lods, a, this.mapWidth, this.mapHeight)) && a.scale < d && a.scale > c ? Math.round(a.scale) : 0;
                        var f = g.map([d, c, e, b, a], Math.round);
                        f.sort(this._numberSorter);
                        f = g.filter(f, function(a, b) { return !!a && g.indexOf(f, a) === b });
                        f = g.filter(f, function(a, b, c) { return b ? 5 < Math.abs(a - c[b - 1]) : !0 });
                        return { scales: f, feScaleIndex: g.indexOf(f, a) }
                    },
                    _numberSorter: function(a, b) { return a - b },
                    _findLODForFE: function(a, b, c, d) {
                        var e = a.length,
                            f =
                            b.getWidth(),
                            g = b.getHeight(),
                            h, m;
                        for (b = 0; b < e; b++)
                            if (h = a[b], c * h.resolution < f || d * h.resolution < g) { m = 0 === b ? a[b] : a[b - 1]; break } else if (b === e - 1) { m = a[b]; break }
                        return m
                    },
                    _calcSizeValues: function(a, b) {
                        a = Math.ceil(a / b);
                        a = Math.ceil(a / 4);
                        4 > a ? a = 4 : 16 < a && (a = 16);
                        b = 5 * a;
                        return { min: a, max: 50 > b ? 50 : b }
                    },
                    _getOutline: function(a) {
                        var b = this;
                        "esriGeometryPolygon" === this.layer.geometryType || this.layer.hasXYFootprint() ? this._getFeatures().then(function(c) {
                            b.getSpatialStatistics({ features: c }).then(function(d) {
                                if (d.avgSize) {
                                    var e;
                                    g.some(c, function(a) { a.geometry && (e = a.geometry.spatialReference); return !!e });
                                    b._calcOutline(d, e, a.params, a.dfd)
                                } else b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedOutline: average feature size is 0 or null.")
                            }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedOutline: unable to calculate spatial statistics.") })
                        }).otherwise(function(c) { b._rejectDfd(a.dfd, c.message) }) : this._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedOutline: not supported for points and lines.")
                    },
                    _calcOutline: function(a, b, c, d) {
                        var e = a.avgSize,
                            f = c && null != c.allowZeroWidth ? c.allowZeroWidth : !0,
                            h = 39.37 * 96 * S.getUnitValueForSR(b);
                        b = g.map(g.filter(this._outlineInfo, function(a, b) { return f || 0 < b }), function(a) { return { size: a.width, value: Math.round(e / a.size * h) } });
                        b.sort(function(a, b) { return a.value - b.value });
                        d.resolve({ widthInfo: { type: "sizeInfo", target: "outline", expression: "view.scale", valueExpression: "$view.scale", stops: b }, opacity: .25, spatialStatistics: a })
                    },
                    _getHeatmapStats: function(a) {
                        var b = this,
                            c = this.layer,
                            d = a.params,
                            e = a.dfd,
                            f = d.fieldOffset;
                        a = d.field && this.layer.getField(d.field);
                        d.field && this._rejectNonNumeric(e, a, "getHeatmapStatistics") || (d.field && null == f ? c.statisticsPlugin.getFieldStatistics({ field: d.field }).then(function(a) { b._calcHeatmapStats(a, f, d, e) }).otherwise(function(a) { b._rejectDfd(e, "FeatureLayerStatistics.getHeatmapStatistics: unable to calculate field statistics.") }) : this._calcHeatmapStats(null, f, d, e))
                    },
                    _calcHeatmapStats: function(a, b, c, d) {
                        var e = this;
                        if (a) {
                            var f = a.min,
                                g = a.max;
                            a.count ? f ===
                                g && 0 === f ? b = 1 : 0 >= g ? b = "abs" : 0 > f && (b = -1.01 * f) : b = 1
                        }
                        this._heatStatsFromMemory(c, b).then(function(c) {
                            c.fieldStatistics = a;
                            c.fieldOffset = b;
                            d.resolve(c)
                        }).otherwise(function(a) { e._rejectDfd(d, "FeatureLayerStatistics.getHeatmapStatistics: unable to calculate heatmap statistics.") })
                    },
                    _heatStatsFromMemory: function(a, b) {
                        var d = new c,
                            e = this.layer,
                            f = e.graphics,
                            g = f.length,
                            h = e.getMap();
                        if (!g) return d.resolve({ count: 0, min: null, max: null, avg: null, stddev: null, source: this._srcMemory }), d.promise;
                        (a = (a = h && V(X(f, h, e), h.width,
                            h.height, a.blurRadius || 10, a.field, b)) && a.matrix && C(a.matrix)) ? d.resolve({ count: g, min: a.min, max: a.max, avg: a.mean, stddev: a.stdDev, source: this._srcMemory }): this._rejectDfd(d, "FeatureLayerStatistics.getHeatmapStatistics: unable to calculate heatmap statistics.");
                        return d.promise
                    },
                    _getHistogram: function(a) {
                        var b = this,
                            c = a.params,
                            d = c.minValue,
                            e = c.maxValue,
                            f = c.valueExpression || c.sqlExpression,
                            g = f && !c.sqlExpression,
                            h = this._isCollection() || g,
                            m = this._canUseSQL92Expression(),
                            n = null != d && null != e,
                            p = c.field ? this.layer.getField(c.field) :
                            null,
                            q = p ? p.type === this._dateType : !1,
                            r = !c.classificationMethod || "equal-interval" === c.classificationMethod;
                        if (p) {
                            if (this._rejectIfInvalidType(a.dfd, p, "getHistogram", [].concat(this._numericTypes).concat(this._dateType))) return;
                            if (q) {
                                if (c.normalizationType) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: normalization is not supported when calculating histogram for date field."); return }
                                if (!r) {
                                    this._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram:  classification methods other than 'equal-interval' are not supported when calculating histogram for date field.");
                                    return
                                }
                            }
                        } else if (f) {
                            if (c.normalizationType) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: normalization is not supported when valueExpression or sqlExpression is specified."); return }
                            if (!r) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: classification methods other than 'equal-interval' are not supported when valueExpression or sqlExpression is specified."); return }
                            if (g) { if (g = this._getExpressionInfo(c.valueExpression), this._rejectIfInvalidExpression(a.dfd, g, "getHistogram")) return } else if (!c.valueExpression) {
                                this._rejectDfd(a.dfd,
                                    "FeatureLayerStatistics.getHistogram: valueExpression parameter is missing.");
                                return
                            }
                        }
                        f && !h ? this._getBinsFromStatsQueryForExpr(a.dfd, c, d, e) : m && r && !h ? this._getBinsFromStatsQueryForField(a, q) : c.normalizationType || !r ? this._binParamsFromGenRend(c).then(function(f) {
                                if (n)
                                    if (d > f.max || e < f.min) b._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: custom value range is beyond field value range.");
                                    else {
                                        var g = b._getFieldExpr(c, f.normTotal),
                                            g = b._getRangeExpr(g, d, e);
                                        r ? b._getBins(a, f.sqlExpr, d, e, null, "parameters",
                                            null, f.excludeZerosExpr) : b._binParamsFromGenRend(c, g).then(function(c) { b._getBins(a, c.sqlExpr, c.min, c.max, c.intervals, c.source, c.normTotal, c.excludeZerosExpr) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: unable to calculate histogram parameters using custom min/max values.") })
                                    }
                                else b._getBins(a, f.sqlExpr, f.min, f.max, f.intervals, f.source, f.normTotal, f.excludeZerosExpr)
                            }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: unable to calculate min/max from generate renderer operation.") }) :
                            n ? this._getBins(a, null, d, e, null, "parameters") : this.getFieldStatistics(c).then(function(c) { c.count ? b._getBins(a, null, c.min, c.max, null, c.source) : b._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: cannot calculate histogram for 0 features (statistics.count \x3d 0).") }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getHistogram: unable to calculate min/max.") })
                    },
                    _getBins: function(a, b, c, d, e, f, h, m) {
                        var n = this,
                            p = a.params.field,
                            q = p ? this.layer.getField(p) : null,
                            q = q ? q.type === this._dateType :
                            !1,
                            r = a.params.numBins || this.numBins;
                        e = e || this._getEqualIntervalBins(c, d, r);
                        b = b || p;
                        this._isCollection() || q || a.params.features ? this._countBinsInMemory(a, c, d, e, h, f) : this._queryBins(b, e, m).then(function(b) {
                            b = g.map(b, function(a, b) { return { minValue: e[b][0], maxValue: e[b][1], count: a } });
                            a.dfd.resolve({ bins: b, minValue: c, maxValue: d, normalizationTotal: h, source: n._srcQuery, statisticsSource: f, partialData: !1 })
                        }).otherwise(function(b) { n._countBinsInMemory(a, c, d, e, h, f) })
                    },
                    _getEqualIntervalBins: function(a, b, c) {
                        b = (b -
                            a) / c;
                        var d = a,
                            e, f = [];
                        for (a = 1; a <= c; a++) e = d + b, e = Number(e.toFixed(16)), f.push([d, e]), d = e;
                        return f
                    },
                    _countBinsInMemory: function(a, b, c, d, e, f) {
                        var g = this;
                        this._binsFromMemory(a.params, b, c, d, e).then(function(d) {
                            var h = a.params.hasAllFeatures;
                            a.dfd.resolve({ bins: d, minValue: b, maxValue: c, normalizationTotal: e, source: a.params.features ? g._srcFeatures : g._srcMemory, statisticsSource: f, partialData: null != h ? !h : !g._isCollection() })
                        }).otherwise(function(b) { g._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate histogram.") })
                    },
                    _queryBins: function(a, b, c) {
                        var d = this.layer,
                            e, h, m = [],
                            n = b.length;
                        for (e = 0; e < n; e++) h = new x, h.where = (c ? c + " AND " : "") + a + " \x3e\x3d " + b[e][0] + (null !== b[e][1] ? " AND " + a + (e === n - 1 ? " \x3c\x3d " : " \x3c ") + b[e][1] : ""), m.push(h);
                        return f(g.map(m, function(a) { return d.queryCount(a) }))
                    },
                    _binsFromMemory: function(a, b, d, e, f) {
                        var g = new c;
                        f = M.createAttributeCache({ field: a.field, valueExpression: a.valueExpression, normalizationType: a.normalizationType, normalizationField: a.normalizationField, normalizationTotal: f });
                        a = a.features ||
                            this.layer.graphics;
                        var h, m, n, p = [];
                        if (!a.length) return this._rejectDfd(g, "Layer has 0 features in memory."), g.promise;
                        n = e.length;
                        for (m = 0; m < n; m++) p.push({ minValue: e[m][0], maxValue: e[m][1], count: 0 });
                        n = a.length;
                        for (m = 0; m < n; m++) h = a[m], h = h._getDataValue(f.attributeInfo, f, t, this.layer), null != h && h >= b && h <= d && (h = this._binIndex(e, h), -1 < h && p[h].count++);
                        g.resolve(p);
                        return g.promise
                    },
                    _binIndex: function(a, b) {
                        var c, d, e = -1;
                        for (c = a.length - 1; 0 <= c; c--)
                            if (d = a[c][0], b >= d) { e = c; break }
                        return e
                    },
                    _binParamsFromGenRend: function(a,
                        b) {
                        var d = this.layer,
                            e = new c,
                            f = this,
                            g = this._getGRWhereInfo(d, a),
                            h = g.where,
                            m = a.numBins || this.numBins,
                            n = this._createCBDefn(a, m),
                            p = new D;
                        p.classificationDefinition = n;
                        p.where = h ? h + (b ? " AND " + b : "") : b;
                        !this._isCollection() && 10.1 <= d.version && !a.features ? this._grTask.execute(p).then(function(b) { f._resolveBinParams(b, g, f._srcGenRend, a, e) }).otherwise(function(b) { f._binParamsFromMemory(m, g, a, e) }) : f._binParamsFromMemory(m, g, a, e);
                        return e.promise
                    },
                    _binParamsFromMemory: function(a, b, c, d) {
                        var e = this;
                        this._cbFromMemory(c,
                            a).then(function(a) { e._resolveBinParams(a, b, c.features ? e._srcFeatures : e._srcMemory, c, d) }).otherwise(function(a) { e._rejectDfd(d, "FeatureLayerStatistics.getHistogram: unable to calculate class breaks.") })
                    },
                    _resolveBinParams: function(a, b, c, d, e) {
                        var f, h, m = [],
                            n = a.infos;
                        h = n.length;
                        f = n[0].minValue;
                        h = n[h - 1].maxValue;
                        g.forEach(n, function(a, b) { m.push([a.minValue, a.maxValue]) });
                        e.resolve({
                            min: f,
                            max: h,
                            intervals: m,
                            sqlExpr: this._getFieldExpr(d, a.normalizationTotal),
                            excludeZerosExpr: b.excludeZerosExpr,
                            normTotal: a.normalizationTotal,
                            source: c
                        })
                    },
                    _getGRWhereInfo: function(a, b) {
                        var c = b.field,
                            d = b.normalizationType;
                        b = b.normalizationField;
                        a = a.getDefinitionExpression();
                        var e;
                        "log" === d ? e = "(NOT " + c + " \x3d 0)" : "field" === d && (e = "(NOT " + b + " \x3d 0)");
                        return { where: e ? e + (a ? " AND " + a : "") : a, excludeZerosExpr: e }
                    },
                    _getFieldExpr: function(a, b) {
                        var c = a.field,
                            d = a.normalizationType;
                        a = a.normalizationField;
                        var e = c;
                        "percent-of-total" === d ? e = "((" + c + " / " + b + ") * 100)" : "log" === d ? e = "(log(" + c + ") * " + this._log10e + ")" : "field" === d && (e = "(" + c + " / " + a + ")");
                        return e
                    },
                    _getRangeExpr: function(a, b, c) {
                        b = null != b ? a + " \x3e\x3d " + b : "";
                        a = null != c ? a + " \x3c\x3d " + c : "";
                        c = "";
                        return (c = b && a ? b + " AND " + a : b || a) ? "(" + c + ")" : ""
                    },
                    _getBinsFromStatsQueryForExpr: function(a, b, c, d) {
                        var f = this,
                            g = null != c && null != d;
                        c = g ? { min: c, max: d } : this.getFieldStatistics(b);
                        e(c).then(function(c) { f._getBinsFromStatsQuery(b, c.min, c.max, g ? "parameters" : c.source).then(function(b) { a.resolve(b) }).otherwise(function(b) { f._rejectDfd(a, "FeatureLayerStatistics.getHistogram: query to calculate count failed.") }) }).otherwise(function(b) {
                            f._rejectDfd(a,
                                "FeatureLayerStatistics.getHistogram: unable to calculate min/max.")
                        })
                    },
                    _getBinsFromStatsQueryForField: function(a, b) {
                        var c = this,
                            d = a.params,
                            f = this.layer,
                            g;
                        "percent-of-total" === d.normalizationType && (g = this.getFieldStatistics({ field: d.field }).then(function(a) { return a.sum }));
                        e(g).then(function(e) {
                            e = { numBins: d.numBins, sqlExpression: b ? c._msSinceUnixEpochSQL(d.field) : c._getFieldExpr(d, e), sqlWhere: b ? null : c._getGRWhereInfo(f, d).excludeZerosExpr };
                            c._getBinsFromStatsQueryForExpr(a.dfd, e, d.minValue, d.maxValue)
                        }).otherwise(function(b) {
                            c._rejectDfd(a.dfd,
                                "FeatureLayerStatistics.getHistogram: unable to calculate normalizationTotal.")
                        })
                    },
                    _getBinsFromStatsQuery: function(a, b, d, e) {
                        var f = this.layer,
                            h = new c;
                        if (this._canUseSQL92Expression()) {
                            var m = this._getEqualIntervalBins(b, d, a.numBins || this.numBins),
                                n = this._calcBinsSQL(a.sqlExpression, m),
                                p = this,
                                q = new B;
                            q.statisticType = "count";
                            q.outStatisticFieldName = "countOFExpr";
                            q.onStatisticField = "*";
                            var r = new x;
                            r.outStatistics = [q];
                            r.groupByFieldsForStatistics = [n];
                            r.orderByFields = [n];
                            r.where = a.sqlWhere;
                            r.sqlFormat = "standard";
                            f.queryFeatures(r).then(function(a) {
                                var c = {};
                                g.forEach(a.features, function(a) {
                                    var b = a.attributes;
                                    a = this._getCustomExprVal(b, "countOFExpr");
                                    b = this._getAttributeVal(b, "countOFExpr");
                                    0 !== a && (c[a] = b)
                                }, p);
                                var f = [];
                                g.forEach(m, function(a, b) {
                                    b += 1;
                                    f.push({ minValue: a[0], maxValue: a[1], count: c.hasOwnProperty(b) ? c[b] : 0 })
                                });
                                h.resolve({ bins: f, minValue: b, maxValue: d, source: p._srcQuery, statisticsSource: e, partialData: !1 })
                            }).otherwise(function(a) { p._rejectDfd(h, "FeatureLayerStatistics.getHistogram: Statistics query operation failed.") })
                        } else this._rejectDfd(h,
                            "FeatureLayerStatistics.getHistogram: make sure the layer supports advanced SQL expressions and standardized queries.");
                        return h.promise
                    },
                    _fetchMaxFeaturesForStats: function() {
                        var a = this;
                        if (this._maxFeaturesForStats) {
                            var b = new c;
                            b.resolve(this._maxFeaturesForStats);
                            return b.promise
                        }
                        return this.getSampleFeatures({ sampleSize: -1, caching: !1, returnGeometry: !1 }).then(function(b) { a._maxFeaturesForStats = { features: b.features, hasAllFeatures: b.features.length === b.totalFeatures }; return a._maxFeaturesForStats })
                    },
                    _sampleFeatures: function(a) {
                        var b = this,
                            c = a.params,
                            d = a.dfd,
                            e = this.layer,
                            f = e.graphics,
                            g = c.caching;
                        a = this._sampleCache;
                        var h = c.resample,
                            m = c.sampleSize;
                        g && a && !h ? d.resolve(this._cloneSample(a)) : (d._time = { start: this._getTime() }, f.length && 0 < m && m <= f.length ? this._resolveSample(d, this._pickItems(f, m), g, this._srcMemory) : (a = new x, a.where = "1\x3d1", d._time.countStart = this._getTime(), e.queryCount(a).then(function(a) {
                            d._time.countEnd = b._getTime();
                            d._totalFeatures = a; - 1 === m && (m = a);
                            m > e.maxRecordCount && (m = e.maxRecordCount);
                            var h;
                            a ? a <= f.length || f.length >= e.maxRecordCount ? b._resolveSample(d, b._pickItems(f, f.length), g, b._srcMemory) : a <= m ? (h = new x, h.where = "1\x3d1", b._queryFeatures(h, c, e, f, d)) : a <= b.samplingThreshold ? (a = new x, a.where = "1\x3d1", d._time.idStart = b._getTime(), e.queryIds(a).then(function(a) {
                                d._time.idEnd = b._getTime();
                                var g = new x;
                                g.objectIds = b._pickItems(a, m);
                                b._queryFeatures(g, c, e, f, d)
                            }).otherwise(function(a) {
                                h = new x;
                                h.where = "1\x3d1";
                                b._queryFeatures(h, c, e, f, d)
                            })) : (h = new x, h.where = "1\x3d1", (a = e.advancedQueryCapabilities) &&
                                a.supportsPagination && (h.num = m), b._queryFeatures(h, c, e, f, d)) : b._resolveSample(d, [], g, b._srcQuery)
                        }).otherwise(function(a) { b._resolveSample(d, b._pickItems(f, f.length), g, b._srcMemory) })))
                    },
                    _queryFeatures: function(a, b, c, d, e) {
                        var f = this;
                        a.outSpatialReference = b.spatialReference;
                        a.maxAllowableOffset = b.maxAllowableOffset;
                        a.outFields = b.outFields;
                        null != b.returnGeometry && (a.returnGeometry = b.returnGeometry);
                        e._time.featStart = this._getTime();
                        c.queryFeatures(a).then(function(a) {
                            e._time.featEnd = f._getTime();
                            f._resolveSample(e,
                                a && a.features || [], b.caching, f._srcQuery)
                        }).otherwise(function(a) { f._resolveSample(e, f._pickItems(d, d.length), b.caching, f._srcMemory) })
                    },
                    _pickItems: function(a, b) {
                        var c = a.length,
                            d = [],
                            e, f = [];
                        if (b >= c) f = a.slice(0);
                        else
                            for (; f.length < b;) e = this._getRandomInt(0, c), -1 === g.indexOf(d, e) && (d.push(e), f.push(a[e]));
                        return f
                    },
                    _getRandomInt: function(a, b) { return Math.floor(Math.random() * (b - a)) + a },
                    _resolveSample: function(a, b, c, d) {
                        b = b || [];
                        var e, f = b.length,
                            g;
                        for (e = 0; e < f && !(g = (g = b[e].geometry) && g.spatialReference); e++);
                        a._time.end = (new Date).getTime();
                        e = a._time;
                        a._time = null;
                        b = { features: b, spatialReference: g && new w(g.toJson()), source: d, time: this._getTimeStats(e), totalFeatures: a._totalFeatures };
                        c && (this._sampleCache = this._cloneSample(b));
                        a.resolve(b)
                    },
                    _cloneSample: function(a) { return { features: g.map(a.features, function(a) { return new a.constructor(a.toJson()) }), spatialReference: a.spatialReference && new w(a.spatialReference.toJson()), source: a.source, time: b.clone(a.time), totalFeatures: a.totalFeatures } },
                    _getTimeStats: function(a) {
                        var b =
                            this._getTimeDiff;
                        return { total: b(a.start, a.end), features: b(a.featStart, a.featEnd), featureIds: b(a.idStart, a.idEnd), featureCount: b(a.countStart, a.countEnd) }
                    },
                    _getTimeDiff: function(a, b) {
                        var c;
                        null != a && null != b && (a = b - a, b = "millisecond", 1E3 <= a && (a /= 1E3, b = "second", 60 <= a && (a /= 60, b = "minute")), c = { value: Number(a.toFixed(2)), unit: b });
                        return c
                    },
                    _getTime: function() { return (new Date).getTime() },
                    _scaleRange: function(a) {
                        var b = this,
                            c = a.params,
                            d = this.layer,
                            f = c && c.sampleSize || this.sampleSize,
                            g = c && c.map || d.getMap(),
                            h = c &&
                            c.mapWidth || this.mapWidth,
                            m = c && c.mapHeight || this.mapHeight,
                            n = c && c.generalizeForScale || this.generalizeForScale,
                            p, q;
                        c && !1 === c.map && (g = null);
                        g && g.__tileInfo ? (p = g.__tileInfo, q = g.spatialReference, g = g.extent.getWidth() / g.width / g.getScale() * n) : (p = this.tileInfo, q = p.spatialReference, g = this.generalizeForResolution / this.generalizeForScale * n);
                        this.getSampleFeatures({ sampleSize: f, spatialReference: q, maxAllowableOffset: g, outFields: [] }).then(function(f) {
                            var g = b._projectExtent(d.fullExtent, q),
                                n = f.features;
                            n && n.length ?
                                b.getSpatialStatistics({ features: n }).then(function(d) {
                                    e(g).always(function(e) {
                                        e = e && e.hasOwnProperty("xmin") ? e : null;
                                        b._processScaleRange(a.dfd, c, p, h, m, e, f, d)
                                    })
                                }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedScaleRange: unable to calculate spatial statistics.") }) : b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedScaleRange: sampling returned 0 features.")
                        }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedScaleRange: unable to sample features.") })
                    },
                    _processScaleRange: function(a, b, c, d, e, f, g, h) {
                        var m = this.layer.geometryType,
                            n = { point: "esriGeometryPoint" === m, mPoint: "esriGeometryMultipoint" === m, line: "esriGeometryPolyline" === m, polygon: "esriGeometryPolygon" === m || this.layer.hasXYFootprint() },
                            m = b && b.forPublishingTiles,
                            p = c.lods,
                            q = this._getLODForMinScale(b, h, n, c),
                            r = m || n.polygon ? this._getLODForMaxScale(b, h, n, c) : null,
                            u = 1 - this.mapPaddingRatioForFE,
                            t = (u = f && this._findLODForFE(p, f, d * u, e * u)) ? u.scale : null,
                            v = (b = this._getLODForMinScale(b, h, n, c, this.minScaleRelaxationRatio)) ?
                            b.scale : null,
                            x = (b = h.avgXY) && new W(b.x, b.y, g.spatialReference && new w(g.spatialReference.toJson())),
                            z = this,
                            y, A = m || n.polygon ? r ? Math.floor(r.scale) : null : 0,
                            D;
                        q && f && x && (D = this._findClosestLOD(p, q, f, x, d, e));
                        y = (q = D || q) ? Math.ceil(q.scale) : null;
                        v = v && t ? Math.max(v, 2 * t) : v || 2 * t;
                        t = t && Math.ceil(t);
                        v = v && Math.ceil(v);
                        q || r ? q && x ? this._countAtView(x, q, d, e).then(function(b) {
                            var c;
                            b || (b = g.features[0], c = n.point ? b.geometry : (b = b.geometry && b.geometry.getExtent()) && b.getCenter());
                            z._resolveScaleRange(a, y, A, t, v, c || x, g, h)
                        }).otherwise(function(b) {
                            z._resolveScaleRange(a,
                                y, A, t, v, x, g, h)
                        }) : this._resolveScaleRange(a, y, A, t, v, x, g, h) : this._rejectDfd(a, "FeatureLayerStatistics.getSuggestedScaleRange: unable to find optimal scale range.")
                    },
                    _resolveScaleRange: function(a, b, c, d, e, f, g, h) {
                        b < c ? this._rejectDfd(a, "FeatureLayerStatistics.getSuggestedScaleRange: invalid scale range - calculated minScale is less than maxScale.") : (c > b / 2 && (c = Math.floor(c / 2)), a.resolve({
                            minScale: b && (b > this.worldScale ? 0 : b),
                            maxScale: c,
                            scaleAtFullExtent: d,
                            relaxedMinScale: e && (e > this.worldScale ? 0 : e),
                            center: f,
                            sampleInfo: g,
                            spatialStatistics: h
                        }))
                    },
                    _countAtView: function(a, b, c, d) {
                        a = this._getExtentFromCenter(a, b, c, d);
                        b = new x;
                        b.geometry = a;
                        return this.layer.queryCount(b).promise
                    },
                    _projectExtent: function(a, b) {
                        if (a.spatialReference.equals(b)) return new a.constructor(a.toJson());
                        if (R.canProject(a.spatialReference, b)) return R.project(a, b);
                        var c = new J;
                        c.geometries = [a];
                        c.outSR = b;
                        return this._gsTask.project(c).then(function(a) { return a && a[0] })
                    },
                    _getLODForMinScale: function(a, b, c, d, e) {
                        var f = a && a.minDistance || this.minDistance,
                            g = a && a.minLength || this.minLength;
                        a = a && a.minSize || this.minSize;
                        var h, m, n;
                        c.point ? (h = b.avgMinDistance, n = f) : c.mPoint ? (h = b.avgMinDistance, n = f) : c.line ? (h = b.avgLength, n = g) : c.polygon && (h = b.avgSize, n = a);
                        0 < h && (m = this._findLOD(d, h, n * (e || 1)));
                        return m
                    },
                    _getLODForMaxScale: function(a, b, c, d) {
                        var e = this.mapWidth,
                            f = a && a.forPublishingTiles,
                            g = a && a.maxDistance || e / 4,
                            h = a && a.maxLength || e / 4;
                        a = a && a.maxSize || e / 2;
                        var m, n, p;
                        c.point ? (m = f ? b.avgMinDistance : b.minDistance, p = g) : c.mPoint ? (m = f ? b.avgMinDistance : b.minDistance, p = g) : c.line ?
                            (m = f ? b.avgLength : b.minLength, p = h) : c.polygon && (m = f ? b.avgSize : b.minSize, p = a);
                        0 < m && (n = this._findLOD(d, m, null, p));
                        return n
                    },
                    _findLOD: function(a, b, c, d) {
                        a = a && a.lods;
                        var e, f, g, h;
                        if (a && a.length) {
                            var m = null != d,
                                n = m ? 0 : a.length - 1,
                                p = m ? -1 : 1;
                            for (g = m ? a.length - 1 : 0; m ? g >= n : g <= n; g += p)
                                if (f = a[g], h = Math.round(b / f.resolution), m) { if (h <= d) { e = f; break } } else if (h >= c) { e = f; break }
                        }
                        return e
                    },
                    _getExtentFromCenter: function(a, b, c, d) {
                        c = c / 2 * b.resolution;
                        b = d / 2 * b.resolution;
                        return new U(a.x - c, a.y - b, a.x + c, a.y + b, new w(a.spatialReference.toJson()))
                    },
                    _findClosestLOD: function(a, b, c, d, e, f) {
                        var g, h = a.length,
                            m, n;
                        for (g = 0; g < h; g++)
                            if (!(a[g].level < b.level))
                                if (m = this._getExtentFromCenter(d, a[g], e, f), !m.contains(c)) { n = a[g - 1]; break } else if (g === h - 1) { n = a[g]; break }
                        return n = n && n.level > b.level ? n : null
                    },
                    _findUniqueValues: function(a) {
                        var b = this,
                            c = a.params,
                            d = c.field,
                            e = d ? this.layer.getField(d) : null,
                            f = c.valueExpression || c.sqlExpression,
                            g = c.valueExpression && (!c.sqlExpression || !this._canUseSQL92Expression()),
                            h = this._isCollection() || c.features || g;
                        if (d && !e) this._rejectDfd(a.dfd,
                            "FeatureLayerStatistics.getUniqueValues: unknown 'field'.");
                        else {
                            if (f)
                                if (g) { if (d = this._getExpressionInfo(c.valueExpression), this._rejectIfInvalidExpression(a.dfd, d, "getUniqueValues")) return } else if (!c.valueExpression) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getUniqueValues: valueExpression parameter is missing."); return }
                            h ? this._uvFromMemory(c).then(function(d) { b._resolveUVDfd(d, a, e, c.features ? b._srcFeatures : b._srcMemory) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate unique values.") }) :
                                this._uvFromStatisticsQuery(c).then(function(c) { b._resolveUVDfd(c, a, e, b._srcQuery) }).otherwise(function(d) { b._uvFromGenRenderer(c, e).then(function(c) { b._resolveUVDfd(c, a, e, b._srcGenRend) }).otherwise(function(d) { b._uvFromMemory(c).then(function(c) { b._resolveUVDfd(c, a, e, b._srcMemory) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate unique values.") }) }) })
                        }
                    },
                    _uvFromStatisticsQuery: function(a) {
                        var d = this.layer,
                            e = new c;
                        if (d.supportsStatistics) {
                            var f = a.field;
                            a = a.sqlExpression;
                            var h = "countOF" + (f || "Expr"),
                                m = this,
                                n = new B;
                            n.statisticType = "count";
                            n.onStatisticField = a ? "*" : f;
                            n.outStatisticFieldName = h;
                            var p = new x;
                            p.outStatistics = [n];
                            p.groupByFieldsForStatistics = [f || a];
                            p.sqlFormat = a ? "standard" : null;
                            d.queryFeatures(p).then(function(a) {
                                var c, n, q = {},
                                    r, t, u = !!a.exceededTransferLimit;
                                g.forEach(a.features, function(a) {
                                    c = a.attributes;
                                    n = f ? this._getAttributeVal(c, f) : this._getCustomExprVal(c, h);
                                    r = this._getAttributeVal(c, h);
                                    null === n && 0 === r && (t = !0);
                                    if (null == n || "" === n || "string" === typeof n && "" ===
                                        b.trim(n)) n = null;
                                    null == q[n] ? q[n] = { count: r, data: n } : q[n].count += r
                                }, m);
                                f && t ? (p = new x, p.where = f + " is NULL", d.queryCount(p).then(function(a) {
                                    q["null"].count += a || 0;
                                    e.resolve({ count: q, partialData: u })
                                }).otherwise(function(a) { e.resolve({ count: q, partialData: u }) })) : e.resolve({ count: q, partialData: u })
                            }).otherwise(function(a) { m._rejectDfd(e, "FeatureLayerStatistics: Statistics query operation failed.") })
                        } else this._rejectDfd(e, "FeatureLayerStatistics: Statistics query requires a layer that supports statistics.");
                        return e.promise
                    },
                    _uvFromGenRenderer: function(a, d) {
                        var e = this.layer,
                            f = new c,
                            h = this;
                        if (10.1 <= e.version) {
                            var m = new G;
                            m.attributeField = a.field;
                            a = new D;
                            a.classificationDefinition = m;
                            a.where = e.getDefinitionExpression();
                            this._grTask.execute(a).then(function(a) {
                                var c = {},
                                    e, m = -1 < g.indexOf(h._numericTypes, d.type);
                                g.forEach(a.infos, function(a) {
                                    e = a.value;
                                    if (null == e || "" === e || "string" === typeof e && ("" === b.trim(e) || "\x3cnull\x3e" === e.toLowerCase())) e = null;
                                    null == c[e] ? c[e] = { count: a.count, data: m && e ? Number(e) : e } : c[e].count +=
                                        a.count
                                });
                                f.resolve({ count: c })
                            }).otherwise(function(a) { h._rejectDfd(f, "FeatureLayerStatistics: Generate renderer operation failed.") })
                        } else this._rejectDfd(f, "FeatureLayerStatistics: Generate renderer operation requires server version 10.1 or later.");
                        return f.promise
                    },
                    _uvFromMemory: function(a) {
                        var d = this.layer,
                            e = new c,
                            f = M.createAttributeCache({ field: a.field, valueExpression: a.valueExpression }, !0),
                            h = {};
                        g.forEach(a.features || d.graphics, function(a) {
                            a = a._getDataValue(f.attributeInfo, f, t, d);
                            if (null == a ||
                                "" === a || "string" === typeof a && "" === b.trim(a)) a = null;
                            null == h[a] ? h[a] = { count: 1, data: a } : h[a].count++
                        }, this);
                        e.resolve({ count: h });
                        return e.promise
                    },
                    _resolveUVDfd: function(a, b, c, d) {
                        var e = a.count,
                            f = c && this.layer.getDomain(c.name),
                            h;
                        c = [];
                        b.params.includeAllCodedValues && f && "codedValue" === f.type && g.forEach(f.codedValues, function(a) {
                            a = a.code;
                            e.hasOwnProperty(a) || (e[a] = { data: a, count: 0 })
                        });
                        for (h in e) f = e[h], c.push({ value: f.data, count: f.count });
                        b.dfd.resolve({
                            source: d,
                            partialData: null != b.params.hasAllFeatures ?
                                !b.params.hasAllFeatures : !this._isCollection() && (d === this._srcMemory || a.partialData),
                            uniqueValueInfos: c
                        })
                    },
                    _findClassBreaks: function(a) {
                        var b = this,
                            c = a.params,
                            d = c.minValue,
                            e = c.maxValue,
                            f = null != d || null != e,
                            g = c.classificationMethod,
                            h = "percent-of-total" === c.normalizationType,
                            m = c.numClasses || this.numClasses,
                            n = !1 !== c.analyzeData,
                            p = c.field,
                            q = p ? this.layer.getField(p) : null,
                            r = c.valueExpression,
                            p = this._isCollection() || c.features || r;
                        if (!q || !this._rejectNonNumeric(a.dfd, q, "getClassBreaks")) {
                            if (r) {
                                if (c.normalizationType) {
                                    this._rejectDfd(a.dfd,
                                        "FeatureLayerStatistics.getClassBreaks: normalization is not supported when valueExpression is specified.");
                                    return
                                }
                                d = this._getExpressionInfo(r);
                                if (this._rejectIfInvalidExpression(a.dfd, d, "getClassBreaks")) return
                            } else if (f)
                                if (n) { if (h && null == c.normalizationTotal) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: normalizationTotal is required when minValue/maxValue are specified."); return } } else {
                                    if (null == d || null == e) {
                                        this._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: both minValue AND maxValue are required when data analysis is disabled.");
                                        return
                                    }
                                    if (g && "equal-interval" !== g) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: data analysis can be disabled only for equal-interval classification."); return }
                                    if (h && null == c.normalizationTotal) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: normalizationTotal is required when data analysis is disabled."); return }
                                }
                            else if (!n) { this._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: both minValue AND maxValue are required when data analysis is disabled."); return }
                            n ?
                                p ? this._cbFromMemory(c, m).then(function(d) { b._resolveCBDfd(a.dfd, c, d, c.features ? b._srcFeatures : b._srcMemory) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate class breaks.") }) : this._cbFromGenRend(c, m).then(function(d) { b._resolveCBDfd(a.dfd, c, d, b._srcGenRend) }).otherwise(function(d) {
                                    f ? b._rejectDfd(a.dfd, "FeatureLayerStatistics.getClassBreaks: cannot calculate class breaks in-memory when minValue/maxValue are specified.") : b._cbFromMemory(c, m).then(function(d) {
                                        b._resolveCBDfd(a.dfd,
                                            c, d, b._srcMemory)
                                    }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate class breaks.") })
                                }) : this._cbFromInterpolation(c, m).then(function(d) { b._resolveCBDfd(a.dfd, c, d, b._srcMemory) }).otherwise(function(c) { b._rejectDfd(a.dfd, "FeatureLayerStatistics: unable to calculate class breaks.") })
                        }
                    },
                    _cbFromGenRend: function(a, b) {
                        var d = this.layer,
                            e = new c,
                            f = this;
                        if (d.url && 10.1 <= d.version) {
                            b = this._createCBDefn(a, b);
                            var d = this._getGRWhereInfo(d, a).where,
                                g = this._getFieldExpr(a, a.normalizationTotal);
                            a = this._getRangeExpr(g, a.minValue, a.maxValue);
                            g = new D;
                            g.classificationDefinition = b;
                            g.where = d ? d + (a ? " AND " + a : "") : a;
                            this._grTask.execute(g).then(function(a) { e.resolve(a) }).otherwise(function(a) { f._rejectDfd(e, "FeatureLayerStatistics: Generate renderer operation failed.") })
                        } else this._rejectDfd(e, "FeatureLayerStatistics: Generate renderer operation requires server version 10.1 or later.");
                        return e.promise
                    },
                    _cbFromMemory: function(a, d) {
                        var e = new c,
                            f = a.features || this.layer.graphics;
                        if (f.length) {
                            d = this._createCBDefn(a,
                                d);
                            var g;
                            if ("percent-of-total" === a.normalizationType) {
                                g = this._calcStatsFromMemory({ field: a.field }).sum;
                                if (null == g) return this._rejectDfd(e, "FeatureLayerStatistics: Invalid normalizationTotal."), e.promise;
                                a = b.mixin({ normalizationTotal: g }, a)
                            }
                            e.resolve(A.createClassBreaksRenderer({ features: f, definition: d, values: this._getDataValues(f, a) }))
                        } else this._rejectDfd(e, "Layer has 0 features in memory.");
                        return e.promise
                    },
                    _cbFromInterpolation: function(a, b) {
                        var d = new c,
                            e = a.minValue,
                            f = a.maxValue;
                        if (e >= f || !b || 1 >
                            b) this._rejectDfd(d, "FeatureLayerStatistics.getClassBreaks: invalid input parameters: minValue, maxValue or numClasses.");
                        else {
                            var g = [],
                                h, m, n = (f - e) / b;
                            for (h = 0; h < b; h++) m = e + h * n, g.push({ minValue: m, maxValue: m + n });
                            g[b - 1].maxValue = f;
                            d.resolve({ infos: g, normalizationTotal: a.normalizationTotal })
                        }
                        return d.promise
                    },
                    _createCBDefn: function(a, b) {
                        var c = a.field,
                            d = a.classificationMethod || this.classificationMethod,
                            e = a.normalizationType,
                            f = a.normalizationField,
                            g = new F;
                        g.classificationField = c;
                        g.breakCount = b;
                        g.classificationMethod =
                            d;
                        g.standardDeviationInterval = "standard-deviation" === d ? a.standardDeviationInterval || this.standardDeviationInterval : void 0;
                        g.normalizationType = e;
                        g.normalizationField = "field" === e ? f : void 0;
                        return g
                    },
                    _resolveCBDfd: function(a, c, d, e) {
                        var f = d.infos,
                            h = f[0].minValue,
                            m = f[f.length - 1].maxValue,
                            n = "standard-deviation" === c.classificationMethod,
                            p = this._reNumber,
                            q, r, t, f = g.map(f, function(a) {
                                t = a.label;
                                r = { minValue: a.minValue, maxValue: a.maxValue, label: t };
                                n && t && (q = t.match(p), q = g.map(q, function(a) { return +b.trim(a) }), 2 ===
                                    q.length ? (r.minStdDev = q[0], r.maxStdDev = q[1], 0 > q[0] && 0 < q[1] && (r.hasAvg = !0)) : 1 === q.length && (-1 < t.indexOf("\x3c") ? (r.minStdDev = null, r.maxStdDev = q[0]) : -1 < t.indexOf("\x3e") && (r.minStdDev = q[0], r.maxStdDev = null)));
                                return r
                            });
                        c = !1 !== c.analyzeData ? null != c.hasAllFeatures ? !c.hasAllFeatures : !this._isCollection() && e === this._srcMemory : !1;
                        a.resolve({ minValue: h, maxValue: m, classBreakInfos: f, normalizationTotal: d.normalizationTotal, source: e, partialData: c })
                    },
                    _reHostedFS: /(https?:)?\/\/services.*\.arcgis\.com/i,
                    _noDominantCategoryField: "no_dominant_category",
                    _predominantCategories: function(a) {
                        var b = a.dfd,
                            c = a.params.fields,
                            d = this;
                        if (this._canUseExpression()) {
                            a = this._predominantCategoryArcade(c);
                            var e = this._predominantCategoryNameSQL(c);
                            (this._isCollection() ? this._uvFromMemory({ valueExpression: a }) : this._uvFromStatisticsQuery({ sqlExpression: e.expression, valueExpression: a })).then(function(a) {
                                var e = d._isCollection() ? d._srcMemory : d._srcQuery;
                                d._resolvePredominantCategories(b, c, a, e)
                            }).otherwise(function(a) { d._rejectDfd(b, "FeatureLayerStatistics.getPredominantCategories: error when counting features in each predominant category.") })
                        } else this._rejectDfd(b,
                            "FeatureLayerStatistics.getPredominantCategories: make sure the layer supports advanced SQL expressions and standardized queries.")
                    },
                    _resolvePredominantCategories: function(a, b, c, d) {
                        var e, f = [],
                            h = c.count;
                        for (e in h) c = h[e], f.push({ value: c.data, count: c.count });
                        var m = g.map(f, function(a) { return a.value });
                        e = g.filter(b, function(a) { return -1 === g.indexOf(m, a) });
                        g.forEach(e, function(a) { f.push({ value: a, count: 0 }) });
                        f.sort(this._predominantFieldSorter(b));
                        g.forEach(f, function(a) {
                            a.value === this._noDominantCategoryField &&
                                (a.value = null)
                        }, this);
                        a.resolve({ predominantCategoryInfos: f, source: d })
                    },
                    _predominantCategoryNameSQL: function(a) { return { expression: this._calcMaxFieldSQL(a, { returnFieldName: !0, defaultValue: "'" + this._noDominantCategoryField + "'" }) } },
                    _calcMaxFieldSQL: function(a, b) {
                        var c = [],
                            d, e, f, h;
                        b && (d = b.resultValue, e = b.returnFieldName, f = b.defaultValue, h = b.integerFields);
                        e && f && (b = g.map(a, function(a) { return a + " \x3c\x3d 0" }), c.push("WHEN " + b.join(" AND ") + " THEN " + f));
                        g.forEach(a, function(b) {
                            var f = [];
                            g.forEach(a, function(a) {
                                b !==
                                    a && f.push(b + " \x3e " + a)
                            });
                            c.push("WHEN " + f.join(" AND ") + " THEN " + (d || e && "'" + b + "'" || (-1 < g.indexOf(h, b) ? "cast(" + b + " as float)" : b)))
                        });
                        return ["CASE", c.join(" "), "ELSE " + (f || "0"), "END"].join(" ")
                    },
                    _predominantFieldSorter: function(a) {
                        return function(b, c) {
                            b = g.indexOf(a, b.value);
                            c = g.indexOf(a, c.value);
                            return b - c
                        }
                    },
                    _predominanceExpressions: function(a) {
                        var b = a.params.fields,
                            c = g.map(g.filter(this.layer.fields, function(a) { return -1 < g.indexOf(this._integerTypes, a.type) }, this), function(a) { return a.name }),
                            d = this._sumOfFieldsSQL(b),
                            c = this._strengthOfPredominanceSQL(b, c);
                        a.dfd.resolve({ predominantCategory: { valueExpression: this._predominantCategoryArcade(b) }, size: { valueExpression: this._sumOfFieldsArcade(b), statisticsQuery: d, histogramQuery: d }, opacity: { valueExpression: this._strengthOfPredominanceArcade(b), statisticsQuery: c, histogramQuery: c } })
                    },
                    _calcMaxFieldInfo: function(a, b) {
                        a = g.map(a, function(a) { return '"' + a + '"' });
                        a = ["var fieldNames \x3d [ " + a.join(", ") + " ];", "var numFields \x3d " + a.length + ";", "var maxValueField \x3d null;", "var maxValue \x3d -Infinity;",
                            "var value, i, totalValue \x3d null;", "for(i \x3d 0; i \x3c numFields; i++) {", "value \x3d $feature[fieldNames[i]];", "if(value \x3e 0) {", "if(value \x3e maxValue) {", "maxValue \x3d value;", "maxValueField \x3d fieldNames[i];", "}", "else if (value \x3d\x3d maxValue) {", "maxValueField \x3d null;", "}", "}"
                        ];
                        b && a.push("if(value !\x3d null \x26\x26 value \x3e\x3d 0) {", "if (totalValue \x3d\x3d null) { totalValue \x3d 0; }", "totalValue \x3d totalValue + value;", "}");
                        a.push("}");
                        return a
                    },
                    _declareFieldNames: function(a) {
                        var b = [],
                            b = g.map(a, function(a) { return '$feature["' + a + '"];' });
                        return b.length ? b.join("\n") + "\n" : ""
                    },
                    _predominantCategoryArcade: function(a) {
                        var b = this._calcMaxFieldInfo(a);
                        b.push("return maxValueField;");
                        return this._declareFieldNames(a) + b.join("\n")
                    },
                    _sumOfFieldsArcade: function(a) {
                        var b = this._declareFieldNames(a);
                        a = g.map(a, function(a) { return '"' + a + '"' });
                        a = ["var fieldNames \x3d [ " + a.join(", ") + " ];", "var numFields \x3d " + a.length + ";", "var value, i, totalValue \x3d null;", "for(i \x3d 0; i \x3c numFields; i++) {",
                            "value \x3d $feature[fieldNames[i]];", "if(value !\x3d null \x26\x26 value \x3e\x3d 0) {", "if (totalValue \x3d\x3d null) { totalValue \x3d 0; }", "totalValue \x3d totalValue + value;", "}", "}", "return totalValue;"
                        ];
                        return b + a.join("\n")
                    },
                    _strengthOfPredominanceArcade: function(a) {
                        var b = this._calcMaxFieldInfo(a, !0);
                        b.push("var strength \x3d null;", "if (maxValueField !\x3d null \x26\x26 totalValue \x3e 0) {", "strength \x3d (maxValue / totalValue) * 100;", "}", "return strength;");
                        return this._declareFieldNames(a) +
                            b.join("\n")
                    },
                    _calcSumOfFieldsSQL: function(a) { return a.join(" + ") },
                    _ensurePositiveFields: function(a) { return "(" + g.map(a, function(a) { return a + " \x3e\x3d 0" }).join(" OR ") + ")" },
                    _sumOfFieldsSQL: function(a) { return { sqlExpression: "(" + this._calcSumOfFieldsSQL(a) + ")", sqlWhere: this._ensurePositiveFields(a) } },
                    _strengthOfPredominanceSQL: function(a, b) {
                        return {
                            sqlExpression: "(((" + this._calcMaxFieldSQL(a, { integerFields: b }) + ") / (" + this._calcSumOfFieldsSQL(a) + ")) * 100)",
                            sqlWhere: this._ensurePositiveFields(a) + " AND ((" +
                                this._calcSumOfFieldsSQL(a) + ") \x3e 0)"
                        }
                    },
                    _calcBinsSQL: function(a, b) {
                        var c = [],
                            d = b.length;
                        g.forEach(b, function(b, e) { c.push("WHEN (" + [a + " \x3e\x3d " + b[0], a + (e === d - 1 ? " \x3c\x3d " : " \x3c ") + b[1]].join(" AND ") + ") THEN " + (e + 1)) });
                        return ["CASE", c.join(" "), "ELSE 0 END"].join(" ")
                    },
                    _ageStatistics: function(a) {
                        var c = a.params.units,
                            d = this;
                        this.getAgeExpressions({ startTime: a.params.startTime, endTime: a.params.endTime, units: c }).then(function(e) {
                            var f = { valueExpression: e.valueExpression };
                            b.mixin(f, e.statisticsQuery);
                            d.getFieldStatistics(f).then(function(b) { a.dfd.resolve({ units: c, statistics: b }) }).otherwise(function(b) { d._rejectDfd(a.dfd, "FeatureLayerStatistics.getAgeStatistics: unable to calculate statistics.") })
                        }).otherwise(function(b) { d._rejectDfd(a.dfd, "FeatureLayerStatistics.getAgeStatistics: unable to generate expressions to calculate age.") })
                    },
                    _supportedAgeUnits: "years months days hours minutes seconds".split(" "),
                    _unitValueInDays: {
                        years: 365,
                        months: 30,
                        days: 1,
                        hours: 1 / 24,
                        minutes: 1 / 1440,
                        seconds: 1 / 86400,
                        milliseconds: 1 /
                            864E5
                    },
                    _suggestedAgeUnits: function(a) {
                        var b = a.params.startTime,
                            c = a.params.endTime,
                            d = this;
                        this._rejectIfInvalidDates(a.dfd, b, c, "getSuggestedAgeUnits") || this.getAgeStatistics({ startTime: b, endTime: c, units: "days" }).then(function(b) {
                            b = b.statistics;
                            null != b.avg ? a.dfd.resolve({ units: d._calcSuggestedAgeUnits(b), statistics: b }) : d._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedAgeUnits: 'avg' statistic is not available.")
                        }).otherwise(function(b) { d._rejectDfd(a.dfd, "FeatureLayerStatistics.getSuggestedAgeUnits: unable to calculate statistics.") })
                    },
                    _calcSuggestedAgeUnits: function(a) {
                        var b, c = this._unitValueInDays,
                            d = Math.abs(a.avg);
                        g.some(this._supportedAgeUnits, function(a) { d > 2 * c[a] && (b = a); return !!b });
                        return b
                    },
                    _ageExpressions: function(a) {
                        var b = a.params.startTime,
                            c = a.params.endTime,
                            d = a.params.units || "days";
                        if (!this._rejectIfInvalidDates(a.dfd, b, c, "getAgeExpressions"))
                            if (-1 === g.indexOf(this._supportedAgeUnits, d)) this._rejectDfd(a.dfd, "FeatureLayerStatistics.getAgeExpressions: invalid 'units'. Supported units are: years, months, days, hours, minutes, seconds.");
                            else {
                                var e = this._getDateDiffSQL(b, c, d);
                                a.dfd.resolve({ valueExpression: this._getDateDiffArcade(b, c, d), statisticsQuery: e, histogramQuery: e })
                            }
                    },
                    _getDateDiffArcade: function(a, b, c) {
                        var d = this._getDateType(a),
                            e = this._getDateType(b);
                        c = [this._readDateValueArcade(a, d, "startTime"), this._readDateValueArcade(b, e, "endTime"), "var retVal \x3d null;", "if (startTime !\x3d null \x26\x26 endTime !\x3d null) {", "startTime \x3d Date(startTime);", "endTime \x3d Date(endTime);", "retVal \x3d DateDiff(endTime, startTime, '" +
                            c + "');", "}", "return retVal;"
                        ];
                        var f = [];
                        "field" === d && f.push(a);
                        "field" === e && f.push(b);
                        return this._declareFieldNames(f) + c.join("\n")
                    },
                    _readDateValueArcade: function(a, b, c) { a = "number" === b ? a : "date" === b ? a.getTime() : '$feature["' + a + '"]'; return "var " + c + " \x3d " + a + ";" },
                    _getDateDiffSQL: function(a, b, c) {
                        a = "(" + this._getDateValueSQL(b, this._getDateType(b)) + " - " + this._getDateValueSQL(a, this._getDateType(a)) + ")";
                        c = this._unitValueInDays[c];
                        b = "/";
                        1 > c && (c = 1 / c, b = "*");
                        return {
                            sqlExpression: 1 === c ? a : "(" + a + " " + b + " " + c + ")",
                            sqlWhere: null
                        }
                    },
                    _getDateValueSQL: function(a, b) { if ("date" === b || "number" === b) "number" === b && (a = new Date(a)), a = "TIMESTAMP'" + a.getUTCFullYear() + "-" + this._padZeros(a.getUTCMonth() + 1) + "-" + this._padZeros(a.getUTCDate()) + " " + this._padZeros(a.getUTCHours()) + ":" + this._padZeros(a.getUTCMinutes()) + ":" + this._padZeros(a.getUTCSeconds()) + "'"; return a },
                    _padZeros: function(a) { return h.pad(a, 2, "0") },
                    _getDateType: function(a) {
                        var b;
                        if (a instanceof Date) b = "date";
                        else if ("number" === typeof a) b = "number";
                        else if ("string" ===
                            typeof a) { var c = this.layer.getField(a); "\x3cnow\x3e" === a.toLowerCase() ? b = "" : c && c.type === this._dateType && (b = "field") }
                        return b
                    },
                    _rejectIfInvalidDates: function(a, b, c, d) {
                        var e = [],
                            f = !1,
                            h = g.every([b, c], function(a) {
                                (a = this._getDateType(a)) && e.push(a);
                                return !!a
                            }, this),
                            m = "FeatureLayerStatistics." + d + ": invalid combination of 'startTime' and 'endTime' parameters.",
                            n = ["date", "number"];
                        h ? e[0] === e[1] ? "field" === e[0] ? b === c && (this._rejectDfd(a, "FeatureLayerStatistics." + d + ": 'startTime' and 'endTime' parameters cannot be identical."),
                            f = !0) : (this._rejectDfd(a, m), f = !0) : -1 < g.indexOf(n, e[0]) && -1 < g.indexOf(n, e[1]) && (this._rejectDfd(a, m), f = !0) : (this._rejectDfd(a, "FeatureLayerStatistics." + d + ": 'startTime' and 'endTime' parameters must be one of these values: a date object, unix epoch time, name of a valid date field or \x26lt;now\x26gt;."), f = !0);
                        return f
                    },
                    _fetchFeatures: function(a, c) {
                        var d = a.params,
                            f = d.valueExpression && (!d.sqlExpression || !this._canUseSQL92Expression()),
                            g = this,
                            f = d.features || this._isCollection() || !f ? null : this._fetchMaxFeaturesForStats();
                        e(f).always(function(e) {
                            var f, h;
                            e && (f = e.features, h = e.hasAllFeatures);
                            f && (a.params = b.mixin({}, d), a.params.features = f, a.params.hasAllFeatures = h);
                            c.call(g, a)
                        })
                    },
                    _rejectDfd: function(a, b) { a.reject(Error(b)) },
                    _rejectNonNumeric: function(a, b, c) {
                        var d;
                        if (!b) this._rejectDfd(a, "FeatureLayerStatistics." + c + ": unknown 'field'."), d = !0;
                        else if (b.name === this.layer.objectIdField || -1 === g.indexOf(this._numericTypes, b.type)) this._rejectDfd(a, "FeatureLayerStatistics." + c + ": 'field' should be numeric."), d = !0;
                        return d
                    },
                    _rejectIfInvalidType: function(a,
                        b, c, d) {
                        var e;
                        if (!b) this._rejectDfd(a, "FeatureLayerStatistics." + c + ": unknown 'field'."), e = !0;
                        else if (b.name === this.layer.objectIdField || -1 === g.indexOf(d, b.type)) this._rejectDfd(a, "FeatureLayerStatistics." + c + ": 'field' should be one of these types: " + d.join(",")), e = !0;
                        return e
                    },
                    _canUseExpression: function() { return this._isCollection() || this._canUseSQL92Expression() },
                    _canUseSQL92Expression: function() { return this._reHostedFS.test(this.layer.url) },
                    _getExpressionInfo: function(a) {
                        var b = t.extractFieldNames(a),
                            c = this.layer,
                            d = [];
                        g.forEach(b, function(a, e) {
                            var f = c.getField(a);
                            f ? b[e] = f.name : d.push(a)
                        });
                        return { fields: b, unknownFields: d }
                    },
                    _rejectIfInvalidExpression: function(a, b, c) {
                        b = b.unknownFields;
                        var d;
                        b && b.length && (this._rejectDfd(a, "FeatureLayerStatistics." + c + ": valueExpression has unknown field names: " + b.join(", ")), d = !0);
                        return d
                    },
                    _getAttributeVal: function(a, b) {
                        var c, d;
                        b = b.toLowerCase();
                        if (a)
                            for (d in a)
                                if (d.toLowerCase() === b) { c = a[d]; break }
                        return c
                    },
                    _getCustomExprVal: function(a, b) {
                        var c, d;
                        b = b.toLowerCase();
                        if (a)
                            for (d in a)
                                if (d.toLowerCase() !== b) { c = a[d]; break }
                        return c
                    },
                    _callAfterLoad: function(a, c, e) {
                        if (this._loaded) a.call(this, c, e);
                        else d.once(this, "_load", b.hitch(this, a, c, e))
                    },
                    _numericTypes: ["esriFieldTypeInteger", "esriFieldTypeSmallInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"],
                    _integerTypes: ["esriFieldTypeInteger", "esriFieldTypeSmallInteger"],
                    _dateType: "esriFieldTypeDate",
                    _createGRTask: function() {
                        this._grTask = new E(this.layer, { source: this.layer.source, gdbVersion: this.layer.gdbVersion });
                        this._loaded = !0;
                        this.emit("_load")
                    }
                });
            b.mixin(q, { add: function(a, b) { a.statisticsPlugin || (b = b || {}, b.layer = a, a.statisticsPlugin = new q(b)) }, remove: function(a) { a.statisticsPlugin && (a.statisticsPlugin.destroy(), delete a.statisticsPlugin) } });
            b.setObject("plugins.FeatureLayerStatistics", q, m);
            return q
        })
}, "esri/workers/heatmapCalculator": function() {
    (function(b, g) {
        "function" === typeof define && define.amd ? define([], g) : b.HeatmapCalculator = g();
        if (b.importScripts && "function" === typeof b.importScripts) {
            var n;
            b.addEventListener("message",
                function(a) {
                    var c = a.data,
                        d = c.action;
                    a = c.msgId;
                    d && a && ("initialize" == d ? (n = new b.HeatmapCalculator(c), postMessage({ msgId: a })) : "calculate" == d && (c = n.calculateImageData(c), postMessage({ msgId: a, imageData: c }, c)))
                }, !1)
        }
    })(this, function() {
        function b(a) {
            a = a || {};
            this.radius = a.blurRadius || 10;
            this.maxVal = a.maxPixelIntensity;
            this.minVal = a.minPixelIntensity;
            this.field = a.field;
            this.fieldOffset = a.fieldOffset;
            this.width = a.width;
            this.height = a.height;
            this.gradient = a.gradient;
            this.stats = null
        }

        function g(a, b) {
            for (var c =
                    Array(a), d = 0; d < a; d++)
                for (var g = c[d] = Array(b), m = 0; m < b; m++) g[m] = 0;
            return c
        }

        function n(a, b) { return a - b }
        var a = window.ArrayBuffer ? !0 : !1;
        b.prototype.calculateImageData = function(a) {
            var b = this.radius = a.blurRadius || this.blurRadius;
            this.maxVal = null != a.maxPixelIntensity ? a.maxPixelIntensity : this.maxPixelIntensity;
            this.minVal = null != a.minPixelIntensity ? a.minPixelIntensity : this.minPixelIntensity;
            var c = this.field = "field" in a ? a.field : this.field,
                e = this.fieldOffset = "fieldOffset" in a ? a.fieldOffset : this.fieldOffset,
                g =
                a.screenPoints,
                m = a.gradient;
            if (m) this.gradient = m;
            else if (this.gradient) m = this.gradient;
            else return !1;
            var n = a.features,
                r = a.mapinfo;
            g || (n && r ? g = this.screenPoints = this._calculateScreenPoints(n, r) : !r && this.screenPoints && (n = !0, a.width && a.width != this.width && (n = !1, this.width = a.width), a.height && a.height != this.height && (n = !1, this.height = a.height), n ? g = this.screenPoints : this.screenPoints = null));
            if (!g) return !1;
            n = r.width || a.width || this.width;
            a = r.height || a.height || this.height;
            b = this._calculateIntensityMatrix(g, n,
                a, b, c, e);
            this._lastMatrix = b.matrix;
            this._maxIntVal = b.max;
            return this._createImageData(n, a, this._lastMatrix, m)
        };
        b.prototype._calculateScreenPoints = function(a, b) {
            var c = b.resolution,
                d = b.width,
                g = b.height;
            b = b.extent;
            var m = [];
            if (b) c || (c = g ? Math.abs(b[3] - b[1]) / g : Math.abs(b[2] - b[0]) / d);
            else return !1;
            d = 0;
            for (g = a.length; d < g; d++) {
                var n = a[d];
                m[d] = { x: Math.round((n.geometry.x - b[0]) / c), y: Math.round((b[3] - n.geometry.y) / c), attributes: n.attributes }
            }
            return m
        };
        b.prototype._calculateIntensityMatrix = function(a, b, f, e, h,
            m) {
            var c = g(f, b),
                d = Math.round(4.5 * e),
                n = e * e,
                w = [],
                t = 2 * d + 1,
                x = -1,
                B = 1,
                E = -Infinity,
                G;
            m = m || 0;
            for (h = function(a) { return "function" == typeof a ? a : a ? "abs" == m ? function(b) { return -1 * +b.attributes[a] } : function(b) { return +b.attributes[a] + m } : function() { return 1 } }(h); ++x < t;) w[x] = Math.exp(-Math.pow(x - d, 2) / (2 * n)) / Math.sqrt(2 * Math.PI) * (e / 2);
            for (x = 0; x < a.length; x++) {
                G = a[x];
                e = G.x - d;
                var n = G.y - d,
                    t = e,
                    F = n,
                    B = +h(G);
                if (!isNaN(B) && null !== B)
                    for (var D = Math.min(G.y + d, f - 1), A = Math.min(G.x + d, b - 1); n <= D;) {
                        for (var H = w[n - F]; e <= A;) - 1 < e && -1 < n &&
                            (G = c[n][e] += H * w[e - t] * B, G > E && (E = G)), e++;
                        n++;
                        e = t
                    }
            }
            return { matrix: c, max: E }
        };
        b.prototype._createImageData = function(b, d, f, e) {
            if (!a) return this._createPixelData(b, d, f, e);
            var c = new Uint32Array(b * d);
            e = e.buffer ? new Uint32Array(e.buffer) : new Uint32Array((new Uint8Array(e)).buffer);
            for (var g = this.minVal, n = e.length / (this.maxVal - g), r = 0; r < d; r++)
                for (var v = f[r], w = 0; w < b; w++) {
                    var t = Math.floor((v[w] - g) * n);
                    c[r * b + w] = 0 > t ? e[0] : t < e.length ? e[t] : e[e.length - 1]
                }
            return c
        };
        b.prototype._createPixelData = function(a, b, f, e) {
            for (var c =
                    Array(a * b * 4), d = this.minVal, g = e.length / 4 / (this.maxVal - d), n = 3, v = 0; v < b; v++)
                for (var w = f[v], t = 0; t < a; t++) {
                    var x = 4 * (v * a + t) + 3,
                        B = 4 * Math.floor((w[t] - d) * g) + 3;
                    3 > B ? B = 3 : B > e.length - 1 && (B = e.length - 1);
                    for (n = 4; n--;) c[x - n] = e[B - n]
                }
            return c
        };
        b.calculateStats = function(a, b) {
            if (!a) return !1;
            for (var c = a.length, d = 0, g = 0, m = 0, n = 0, r = Infinity, v = -Infinity, w, t, x, B, E; c--;)
                for (x = a[c], w = x.length; w--;)
                    if (E = x[w], !b || b(E)) B || (B = E), t = E - B, n += E, d += t, g += t * t, E < r && (r = E), E > v && (v = E), m++;
            return 0 < m ? {
                mean: n / m,
                stdDev: Math.sqrt((g - d * d / m) / m),
                min: r,
                max: v,
                mid: (v - r) / 2
            } : { mean: 0, stdDev: 0, min: 0, max: 0, mid: 0 }
        };
        b.getBinnedValues = function(a) {
            function b(a, b, c) { for (var d = []; a < b; a += c) d.push(a); return d }
            a = a || {};
            var c = a.stats,
                e = a.min,
                h = a.max,
                m = a.bins,
                p = a.count,
                r = a.size;
            a = a.values;
            if (!a) return !1;
            c && null != c.max && null != c.min && (e = c.min, h = c.max);
            if (!m)
                if (r) {
                    null == e && (e = 0);
                    if (null == h) {
                        if (null == p) return !1;
                        h = e + p * r
                    }
                    m = b(e, h, r)
                } else if (p) {
                c && null != c.min && null != c.max ? (e = c.min, h = c.max) : null != h && 0 < h && null == e && (e = 0);
                if (null == e || null == h) return !1;
                m = b(e, h, (h - e) / p)
            }
            for (var p =
                    m.length, c = g(p, 0), e = a.length, v, w, t; e--;)
                for (r = a[e], h = r.length; h--;) {
                    v = r[h];
                    for (t = 1; t < p && !(w = m[t], v < w); t++);
                    c[t - 1].push(v)
                }
            return c.map(function(a) { return a.sort(n) })
        };
        b.getHistogramData = function(a) {
            a = a || {};
            var c = a.binnedData,
                f = a.stats,
                e = a.byStdDev,
                g = a.matrix;
            a = a.binOptions || {};
            if (!c)
                if (g) { if (a.values = g, e && (f || (f = b.calculateStats(g)), a.size = f.stdDev), a.stats = f, c = b.getBinnedValues(a), !c) return !1 } else return !1;
            var m;
            if (a.bins) a = a.bins;
            else
                for (a = [], e = 0; e < c.length; e++) g = c[e], a.push(g[0]);
            m = [];
            for (e = 0; e <
                a.length - 1; e++) g = a[e], m[e] = { range: [g, a[e + 1]], count: g.length };
            f ? c = f.max : (g = c[e], c = g[g.length - 1]);
            g = a[e];
            m[e] = { range: [g, c], count: g.length };
            return m
        };
        return b
    })
}, "esri/dijit/ColorInfoSlider": function() {
    define("../kernel ../numberUtils ../renderers/utils ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojox/gfx dojo/text!./ColorInfoSlider/templates/ColorInfoSlider.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x) {
            d = h([f, d, v], {
                declaredClass: "esri.dijit.ColorInfoSlider",
                baseClass: "esriColorInfoSlider",
                templateString: x,
                colorInfo: null,
                minValue: null,
                maxValue: null,
                histogram: null,
                statistics: !1,
                zoomOptions: null,
                handles: [],
                primaryHandle: null,
                showLabels: !0,
                showTicks: !0,
                showHandles: !0,
                showHistogram: !0,
                showStatistics: !0,
                showTransparentBackground: !1,
                showRatioLabels: !1,
                histogramWidth: 100,
                rampWidth: 26,
                _rampNode: null,
                _sliderHeight: null,
                _colorRampSurface: null,
                _histogramSurface: null,
                _surfaceRect: null,
                _barsGroup: null,
                _updateTimer: null,
                _transparentBackgroundNode: null,
                _forceMinValue: null,
                _forceMaxValue: null,
                constructor: function(a, b) { b && (void 0 !== a.minValue && this.set("_forceMinValue", a.minValue), void 0 !== a.maxValue && this.set("_forceMaxValue", a.maxValue), this._updateTimeout = p(this._updateTimeout, 0)) },
                postCreate: function() {
                    this.inherited(arguments);
                    this._setupDataDefaults()
                },
                startup: function() {
                    this.inherited(arguments);
                    this._slider = new a({
                        type: "ColorInfoSlider",
                        values: this.values,
                        isDate: this.isDate,
                        minimum: this.zoomOptions ? this.zoomOptions.minSliderValue : this.minValue,
                        maximum: this.zoomOptions ? this.zoomOptions.maxSliderValue : this.maxValue,
                        _minZoomLabel: this.zoomOptions ? this.minValue : null,
                        _maxZoomLabel: this.zoomOptions ? this.maxValue : null,
                        _isZoomed: this.zoomOptions ? !0 : !1,
                        showLabels: this.showLabels,
                        showTicks: this.showTicks,
                        showHandles: this.showHandles,
                        showRatioLabels: this.showRatioLabels,
                        handles: this.handles,
                        primaryHandle: this.primaryHandle
                    }, this._sliderNode);
                    this._slider.startup();
                    this._rampNode = this._slider._sliderAreaRight;
                    this._sliderHeight = r.get(this._rampNode, "height") || 155;
                    this._valuesAutoAdjust();
                    this._createSVGSurfaces();
                    this._slider.on("slide", m.hitch(this, function(a) {
                        this._valuesAutoAdjust();
                        this._updateColorInfo(this._slider.values);
                        this._fillRamp();
                        this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, colorInfo: m.clone(this.colorInfo) })
                    }));
                    this._slider.on("handle-value-change", m.hitch(this, function(a) {
                        this.set("values", a.values);
                        this._valuesAutoAdjust();
                        this._updateColorInfo(this._slider.values);
                        this._fillRamp();
                        this._updateRendererSlider();
                        a = m.clone(this.colorInfo);
                        this.emit("handle-value-change", a);
                        this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, colorInfo: a })
                    }));
                    this._slider.on("data-value-change", m.hitch(this, function(a) {
                        this.set({ minValue: a.min, maxValue: a.max });
                        this._updateRendererSlider();
                        a = { minValue: this.minValue, maxValue: this.maxValue, colorInfo: m.clone(this.colorInfo) };
                        this.emit("data-change", a);
                        this.emit("data-value-change",
                            a)
                    }));
                    this._slider.on("stop", m.hitch(this, function(a) { this.emit("handle-value-change", m.clone(this.colorInfo)) }));
                    this._slider.on("zoom-out", m.hitch(this, function(a) { this.set("zoomOptions", null) }));
                    this.statistics && this.showStatistics && this._generateStatistics();
                    this.showHistogram && (this.histogram || this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram();
                    this.watch("colorInfo", this._updateTimeout);
                    this.watch("handles", this._updateTimeout);
                    this.watch("primaryHandle", this._updateTimeout);
                    this.watch("statistics", this._updateTimeout);
                    this.watch("histogram", this._updateTimeout);
                    this.watch("zoomOptions", this._updateTimeout);
                    this.watch("showHandles", this._updateTimeout);
                    this.watch("showLabels", this._updateTimeout);
                    this.watch("showTicks", this._updateTimeout);
                    this.watch("showRatioLabels", this._updateTimeout);
                    this.watch("zoomOptions", this._zoomEventHandler);
                    this.watch("showHistogram", this._toggleHistogram);
                    this.watch("showTransparentBackground", this._toggleTransparentBackground)
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._slider && this._slider.destroy();
                    this._avgHandleObjs && this._avgHandleObjs.avgHandleTooltip && this._avgHandleObjs.avgHandleTooltip.destroy();
                    this.countTooltips && e.forEach(this.countTooltips, function(a) { a.destroy() })
                },
                _updateTimeout: function() { this._updateRendererSlider() },
                _updateRendererSlider: function() {
                    var a = this.get("showRatioLabels");
                    !1 !== a && "percent" !== a && "percentTotal" !== a && this.set("showRatioLabels", !1);
                    null !== this.zoomOptions && !1 !== this.zoomOptions ? (this.toggleSliderBottom = this.zoomOptions.minSliderValue >
                        this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue < this.maxValue, this._slider.set({ minimum: this.zoomOptions.minSliderValue, maximum: this.zoomOptions.maxSliderValue, showRatioLabels: this.showRatioLabels, _minZoomLabel: this.minValue, _maxZoomLabel: this.maxValue, _isZoomed: !0 })) : this._slider.set({ minimum: this.minValue, maximum: this.maxValue, showRatioLabels: this.showRatioLabels, _minZoomLabel: null, _maxZoomLabel: null, _isZoomed: !1 });
                    this.set("values", this._generateHandleValues(m.clone(this.colorInfo.stops)));
                    this._slider.set({ values: this.values, handles: this.handles, primaryHandle: this.primaryHandle });
                    this._slider._reset();
                    this._slider._updateRoundedLabels();
                    this._slider._generateMoveables();
                    this._clearRect();
                    this._createSVGSurfaces();
                    this.statistics && this.showStatistics && this._generateStatistics();
                    this.showHistogram && (this.histogram || this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram()
                },
                _generateHandleValues: function(a) {
                    e.forEach(a, m.hitch(this, function(a, b) {
                        -1 === e.indexOf(this.handles,
                            b) && b !== this.primaryHandle && (a.hidden = !0);
                        b === this.primaryHandle && (a.primaryHandle = !0)
                    }));
                    return a.slice()
                },
                _valuesAutoAdjust: function() {
                    var a = this._slider.values,
                        b = [],
                        c, d, f, g, h, m, n;
                    e.forEach(a, function(a, c) { a.hidden || b.push(c) });
                    for (m = 0; m < b.length - 1; m++)
                        for (c = b[m], d = b[m + 1], f = d - c, g = a[c].value, h = a[d].value, n = c + 1; n < d; n++) a[n].value = g * (d - n) / f + h * (n - c) / f
                },
                _zoomEventHandler: function() { this.emit("zoomed", !!this.zoomOptions) },
                _setupDataDefaults: function() {
                    this.statistics ? this.set({
                        minValue: this.statistics.min,
                        maxValue: this.statistics.max
                    }) : this.set({ minValue: 0, maxValue: 100 });
                    null !== this._forceMinValue && this.set("minValue", this._forceMinValue);
                    null !== this._forceMaxValue && this.set("maxValue", this._forceMaxValue);
                    null !== this.zoomOptions && (this.toggleSliderBottom = this.zoomOptions.minSliderValue > this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue < this.maxValue);
                    this.colorInfo.stops[0].value === this.colorInfo.stops[this.colorInfo.stops.length - 1].value && 0 !== this.colorInfo.stops[0].value && (this.set({
                        minValue: 0,
                        maxValue: 2 * this.colorInfo.stops[0].value
                    }), this.colorInfo.stops[0].value = this.maxValue / 5, this.colorInfo.stops[this.colorInfo.stops.length - 1].value = this.maxValue / 5 * 4);
                    this.minValue === this.maxValue && (0 === this.minValue ? this.set("maxValue", 100) : null === this.minValue ? this.set({ minValue: 0, maxValue: 100 }) : this.set({ minValue: 0, maxValue: 2 * this.minValue }));
                    this.set("values", this._generateHandleValues(m.clone(this.colorInfo.stops)))
                },
                _createSVGSurfaces: function() {
                    this._colorRampSurface = t.createSurface(this._rampNode,
                        this.rampWidth - 2, this._sliderHeight - 2);
                    r.set(this._colorRampSurface.rawNode, "border", "1px solid #888");
                    this._surfaceRect = this._colorRampSurface.createRect({ width: this.rampWidth, height: this._sliderHeight });
                    this._transparentBackgroundNode = c.generateTransparentBackground(this._colorRampSurface, this.rampWidth - 2, this._sliderHeight - 2, this.showTransparentBackground);
                    this._histogramSurface = c.generateHistogramSurface(this._rampNode, this.histogramWidth, this._sliderHeight, this.rampWidth);
                    this._fillRamp();
                    null !==
                        this.zoomOptions && (this.toggleSliderBottom && this.toggleSliderTop ? (this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 5)), this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 195))) : this.toggleSliderBottom ? this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0,
                            195)) : this.toggleSliderTop && this._colorRampSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke({ color: "#fff", width: 3 }).setTransform(t.matrix.translate(0, 5)))
                },
                _fillRamp: function() {
                    var a = this._slider.minimum,
                        b = this._slider.maximum,
                        c = this._slider.values.slice();
                    e.forEach(c, function(c) { c.offset = (b - c.value) / (b - a) });
                    c.reverse();
                    null !== this.zoomOptions ? this.toggleSliderBottom && this.toggleSliderTop ? this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 10, x2: 0, y2: this._sliderHeight - 10, colors: c }) :
                        this.toggleSliderBottom ? this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight - 20, colors: c }) : this.toggleSliderTop && this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 20, x2: 0, y2: this._sliderHeight, colors: c }) : this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight, colors: c })
                },
                _clearRect: function() {
                    this._colorRampSurface.destroy();
                    this._histogramSurface.destroy()
                },
                _toggleTransparentBackground: function() {
                    this.showTransparentBackground ? this._transparentBackgroundNode.setFill(c.getTransparentFill()) :
                        this._transparentBackgroundNode.setFill(null)
                },
                _updateColorInfo: function(a) {
                    a = e.map(a, function(a, b) { return { value: a.value, index: b } });
                    n.updateColorStops({ stops: this.colorInfo.stops, changes: a, isDate: this.isDate, dateFormatOptions: this.isDate ? n.timelineDateFormatOptions : null })
                },
                _showHistogram: function() { this.histogram || this.zoomOptions && this.zoomOptions.histogram ? this._generateHistogram() : this._barsGroup && (this._barsGroup.destroy(), this._barsGroup = null) },
                _toggleHistogram: function() {
                    this.showHistogram ?
                        (r.set(this._barsGroup.rawNode, "display", "inline-block"), this._showHistogram()) : r.set(this._barsGroup.rawNode, "display", "none")
                },
                _generateHistogram: function() {
                    var a = this.zoomOptions && this.zoomOptions.histogram ? this.zoomOptions.histogram : this.histogram;
                    this._barsGroup = c.generateHistogram(this._histogramSurface, a, this.histogramWidth, this.rampWidth, this.isLeftToRight());
                    this.countTooltips = c.generateCountTooltips(a, this._barsGroup)
                },
                _generateStatistics: function() {
                    if (!(2 > this.statistics.count || isNaN(this.statistics.avg))) {
                        var a =
                            this.statistics,
                            b = this._slider,
                            d = this.zoomOptions || null,
                            e = c.getPrecision(this.maxValue),
                            f, h;
                        a.min === a.max && a.min === a.avg ? (f = 0, h = 2 * a.avg) : (f = a.min, h = a.max);
                        if (f !== b.minimum || h !== b.maximum) f = b.minimum, h = b.maximum;
                        d && (f = d.minSliderValue, h = d.maxSliderValue);
                        b = this._sliderHeight * (h - a.avg) / (h - f);
                        a = this.get("showRatioLabels") ? g.round([this._slider._getRatioFromValue(a.avg), f, h])[0] : g.round([a.avg, h, f])[0];
                        this._avgHandleObjs = c.generateAvgLine(this._histogramSurface, a, b, e, this.isLeftToRight(), this.isDate,
                            this.get("showRatioLabels"))
                    }
                }
            });
            m.setObject("dijit.ColorInfoSlider", d, b);
            return d
        })
}, "esri/dijit/ClassedColorSlider": function() {
    define("../kernel ../numberUtils ../renderers/utils ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojox/gfx dojo/text!./ClassedColorSlider/templates/ClassedColorSlider.html".split(" "), function(b, g, n, a, c, d, f, e, h, m, p,
        r, v, w, t, x) {
        d = h([f, d, v], {
            declaredClass: "esri.dijit.ClassedColorSlider",
            baseClass: "esriClassedColorSlider",
            templateString: x,
            breakInfos: null,
            histogram: null,
            handles: [],
            showHistogram: !0,
            showStatistics: !0,
            showLabels: !0,
            showTicks: !0,
            showHandles: !0,
            classificationMethod: null,
            normalizationType: null,
            histogramWidth: 100,
            rampWidth: 26,
            _rampNode: null,
            _sliderHeight: null,
            _colorRampSurface: null,
            _histogramSurface: null,
            _surfaceRect: null,
            _barsGroup: null,
            _updateTimer: null,
            constructor: function(a, b) {
                b && (this.breakInfos = m.clone(a.breakInfos),
                    this.set("values", this._getHandleInfo(this.breakInfos)), this._updateTimeout = p(this._updateTimeout, 0))
            },
            postCreate: function() {
                this.inherited(arguments);
                this._setupDataDefaults()
            },
            startup: function() {
                this.inherited(arguments);
                this._slider = new a({ type: "ClassedColorSlider", values: this.values, minimum: this.minValue, maximum: this.maxValue, showLabels: this.showLabels, showTicks: this.showTicks, showHandles: this.showHandles, classificationMethod: this.classificationMethod, normalizationType: this.normalizationType },
                    this._sliderNode);
                this._slider.startup();
                this._rampNode = this._slider._sliderAreaRight;
                this._sliderHeight = r.get(this._rampNode, "height") || 155;
                this._createSVGSurfaces();
                this._slider.on("slide", m.hitch(this, function(a) {
                    this.classificationMethod = null;
                    this._updateBreakInfos(a.values);
                    this._updateBreakInfoLabels();
                    this._fillRamp();
                    this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, breakInfos: m.clone(this.breakInfos) })
                }));
                this._slider.on("handle-value-change", m.hitch(this, function(a) {
                    this.classificationMethod =
                        null;
                    this._updateBreakInfos(a.values);
                    this._updateBreakInfoLabels();
                    this._fillRamp();
                    a = m.clone(this.breakInfos);
                    this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, breakInfos: a });
                    this.emit("handle-value-change", a)
                }));
                this._slider.on("data-value-change", m.hitch(this, function(a) {
                    this.classificationMethod = null;
                    this.breakInfos[0].minValue = a.min;
                    this.breakInfos[this.breakInfos.length - 1].maxValue = a.max;
                    this.set({ minValue: a.min, maxValue: a.max });
                    this._updateBreakInfoLabels();
                    this._updateRendererSlider();
                    a = { minValue: this.minValue, maxValue: this.maxValue, breakInfos: m.clone(this.breakInfos) };
                    this.emit("data-change", a);
                    this.emit("data-value-change", a)
                }));
                this._slider.on("stop", m.hitch(this, function(a) { this.emit("handle-value-change", m.clone(this.breakInfos)) }));
                this.histogram && this.showHistogram && this._generateHistogram();
                this.statistics && this.showStatistics && this._generateStatistics();
                this.watch("breakInfos", this._updateTimeout);
                this.watch("handles", this._updateTimeout);
                this.watch("statistics", this._updateTimeout);
                this.watch("showHandles", this._updateTimeout);
                this.watch("showLabels", this._updateTimeout);
                this.watch("showTicks", this._updateTimeout);
                this.watch("histogram", this._showHistogram);
                this.watch("showHistogram", this._toggleHistogram)
            },
            destroy: function() {
                this.inherited(arguments);
                this._slider && this._slider.destroy();
                this._avgHandleObjs && this._avgHandleObjs.avgHandleTooltip && this._avgHandleObjs.avgHandleTooltip.destroy();
                this.countTooltips && e.forEach(this.countTooltips, function(a) { a.destroy() })
            },
            _updateTimeout: function() { this._updateRendererSlider() },
            _updateRendererSlider: function() {
                this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[this.breakInfos.length - 1].maxValue });
                this._slider.set({ minimum: this.minValue, maximum: this.maxValue, values: this._getHandleInfo(this.breakInfos), handles: this.handles });
                this._slider._reset();
                this._slider._updateRoundedLabels();
                this._slider._generateMoveables();
                this._clearRect();
                this._createSVGSurfaces();
                this.histogram && this.showHistogram && this._generateHistogram();
                this.statistics && this.showStatistics &&
                    this._generateStatistics()
            },
            _getHandleInfo: function(a) {
                var b = [],
                    c;
                for (c = 0; c < a.length - 1; c++) b.push(a[c].maxValue);
                return b
            },
            _updateBreakInfos: function(a) {
                var b = this.breakInfos,
                    c;
                n.updateClassBreak({ classBreaks: b, normalizationType: this.normalizationType, classificationMethod: this.classificationMethod, change: a });
                for (c = 0; c < a.length; c++) b[c].maxValue = a[c], b[c + 1] && (b[c + 1].minValue = a[c])
            },
            _updateBreakInfoLabels: function() {
                n.setLabelsForClassBreaks({
                    classBreaks: this.breakInfos,
                    normalizationType: this.normalizationType,
                    classificationMethod: this.classificationMethod,
                    round: !0
                })
            },
            _setupDataDefaults: function() {
                null !== this.breakInfos && 1 < this.breakInfos.length ? this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[this.breakInfos.length - 1].maxValue }) : null !== this.breakInfos && 1 === this.breakInfos.length ? this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[0].maxValue }) : (this.set({ minValue: 0, maxValue: 100, breakInfos: [{ minValue: 0, maxValue: 20 }, { minValue: 20, maxValue: 80 }, { minValue: 80, maxValue: 100 }] }),
                    this.set("values", this._getHandleInfo(this.breakInfos)), this._updateBreakInfoLabels())
            },
            _createSVGSurfaces: function() {
                this._colorRampSurface = t.createSurface(this._rampNode, this.rampWidth, this._sliderHeight);
                r.set(this._colorRampSurface.rawNode, "border", "1px solid #888");
                this._surfaceRect = this._colorRampSurface.createRect({ width: this.rampWidth + 2, height: this._sliderHeight + 2 });
                this._histogramSurface = c.generateHistogramSurface(this._rampNode, this.histogramWidth, this._sliderHeight, this.rampWidth);
                this._fillRamp()
            },
            _clearRect: function() {
                this._colorRampSurface.destroy();
                this._histogramSurface.destroy()
            },
            _fillRamp: function() {
                var a = this.breakInfos,
                    b = this.maxValue,
                    c = this.minValue,
                    d = [],
                    e;
                for (e = 0; e < a.length; e++) {
                    var f, g;
                    b === c ? f = g = 0 : (f = (b - a[e].minValue) / (b - c), g = (b - a[e].maxValue) / (b - c));
                    d.push({ offset: f, color: a[e].symbol ? a[e].symbol.color : "#5daddd" });
                    d.push({ offset: g, color: a[e].symbol ? a[e].symbol.color : "#5daddd" })
                }
                d.reverse();
                this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight, colors: d })
            },
            _showHistogram: function() { this.histogram ? this._generateHistogram() : this._barsGroup && (this._barsGroup.destroy(), this._barsGroup = null) },
            _toggleHistogram: function() { this.showHistogram ? (r.set(this._barsGroup.rawNode, "display", "inline-block"), this._showHistogram()) : r.set(this._barsGroup.rawNode, "display", "none") },
            _generateHistogram: function() {
                this._barsGroup = c.generateHistogram(this._histogramSurface, this.histogram, this.histogramWidth, this.rampWidth, this.isLeftToRight());
                this.countTooltips = c.generateCountTooltips(this.histogram,
                    this._barsGroup)
            },
            _generateStatistics: function() {
                if (!(2 > this.statistics.count || isNaN(this.statistics.avg))) {
                    var a = this.statistics,
                        b = this._slider,
                        d = c.getPrecision(this.maxValue),
                        e, f;
                    a.min === a.max && a.min === a.avg ? (e = 0, f = 2 * a.avg) : (e = a.min, f = a.max);
                    if (e !== b.minimum || f !== b.maximum) e = b.minimum, f = b.maximum;
                    b = this._sliderHeight * (f - a.avg) / (f - e);
                    a = g.round([a.avg, f, e])[0];
                    this._avgHandleObjs = c.generateAvgLine(this._histogramSurface, a, b, d, this.isLeftToRight())
                }
            }
        });
        m.setObject("dijit.ClassedColorSlider", d, b);
        return d
    })
},
"arcgisonline/map/dijit/renderer/ColorGrid": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/on dojo/dom dojo/query dojo/mouse dojo/has dojo/topic dojo/string dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/form/Button dijit/form/CheckBox dijit/Tooltip esri/symbols/jsonUtils esri/styles/choropleth esri/lang dgrid/OnDemandGrid dgrid/Selection dgrid/editor dojo/store/Memory dojo/store/Observable arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_LabelsMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/registry".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U) {
            c = b([W], {
                declaredClass: "arcgisonline.map.dijit.renderer.ColorGrid",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGOColorGrid",
                i18n: null,
                id: "",
                grid: null,
                lastDefaultLabel: null,
                lastDefaultSymbol: null,
                ordersList: null,
                didDragFromSource: !1,
                ungroupButton: null,
                symbolButton: null,
                otherCheckBox: null,
                scrollPos: 0,
                batchCount: 205,
                tooltips: [],
                constructor: function(a, b) {
                    g.mixin(this, O);
                    g.mixin(this, P);
                    g.mixin(this,
                        R);
                    null != a && (a.id && (this.id = a.id), a.renderer && (this.renderer = a.renderer), a.style && (this.style = a.style), a.onSymbolClick && (this.onSymbolClick = a.onSymbolClick), a.onLabelClick && (this.onLabelClick = a.onLabelClick), a.params && g.mixin(this, a.params))
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(S.common);
                    g.mixin(this.i18n, S.rendererColorPanel)
                },
                postCreate: function() { this.createGrid() },
                destroy: function() {
                    this.onRendererItemChangeHandler && p.unsubscribe(this.onRendererItemChangeHandler);
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    this.grid && (delete this.store, this.grid.destroy(), delete this.grid);
                    this.inherited(arguments)
                },
                resize: function() {
                    e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px");
                    this.grid.resize()
                },
                hide: function() {},
                updateGrid: function(a) {
                    this.renderer = a;
                    this.getData();
                    this.store = K(new M({
                        data: this.data,
                        idProperty: "id",
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "id" }];
                            return M.prototype.query.call(this, a, b)
                        }
                    }));
                    this.scrollPos = this.grid.bodyNode.scrollTop;
                    this.grid.set("store", this.store)
                },
                createGrid: function() {
                    this.grid ? (n.forEach(this.tooltips, function(a) { a.destroy() }), this.scrollPos = this.grid.bodyNode.scrollTop, delete this.store, this.grid.destroy(), delete this.grid) : this.scrollPos = 0;
                    f.byId("_colorRendererGrid") || t.create("div", { id: "_colorRendererGrid" }, this.domNode);
                    this.getColumns();
                    this.maxSymbolWidth = 30;
                    this.getData();
                    this.store = K(new M({
                        data: this.data,
                        idProperty: "id",
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "id" }];
                            return M.prototype.query.call(this,
                                a, b)
                        }
                    }));
                    this.grid = new(b([H]))({ store: this.store, selectionMode: "single", columns: this.columns, className: "dgrid-autoheight", style: this.style ? this.style : "width: 200px;", sort: [{ attribute: "id" }], minRowsPerPage: this.batchCount, maxRowsPerPage: this.batchCount, showHeader: !1 }, "_colorRendererGrid");
                    this.grid.on("dgrid-editor-hide", g.hitch(this, function(a) { this.handleLabelChange(a.cell.row.data, a.editor.value) }));
                    this.grid.on("dgrid-error", g.hitch(this, function(a) {}));
                    this.grid.on("dgrid-refresh-complete", g.hitch(this,
                        function(a) {
                            this.grid.scrollTo({ y: this.scrollPos });
                            e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px")
                        }));
                    this.resize()
                },
                getColumns: function() {
                    this.columns = {};
                    this.columns.symbol = {
                        className: "symbolCell",
                        field: "symbol",
                        label: "",
                        sortable: !1,
                        renderCell: g.hitch(this, function(a, b, c, e) {
                            if (b) {
                                var f = t.create("div", { style: "width:" + a.symbolSize.width + "px;height:" + a.symbolSize.height + "px;margin: auto;", "class": "symbol" });
                                d(c, "click", g.hitch(this, function(a) { this.onRowClickSymbolHandler(a) }, a));
                                this.tooltips.push(new G({
                                    connectId: [f],
                                    label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.oneSymbolTooltip + "\x3c/div\x3e"
                                }));
                                9 > m("ie") ? setTimeout(g.hitch(this, function(a, b, c) {
                                    this.drawSymbol(a, b, c.symbolSize.width, c.symbolSize.height, null, 1);
                                    this.updateBackgroundForAlmostWhite(b, a)
                                }, f, b, a), 100) : (this.drawSymbol(f, b, a.symbolSize.width, a.symbolSize.height, null, 1), this.updateBackgroundForAlmostWhite(b, f))
                            }
                            return f
                        })
                    };
                    this.columns.label = L({
                        className: "labelCell",
                        field: "label",
                        name: this.i18n.labelTitle,
                        label: this.i18n.labelTitle,
                        sortable: !1,
                        canEdit: function(a) { return !0 },
                        renderCell: g.hitch(this, function(a, b, c, d) { return t.create("span", { innerHTML: x.encode(a.label), "class": "info" }) })
                    }, "text", "click")
                },
                getData: function() {
                    this.data = n.map(this.renderer.infos, function(a, b) {
                        var c = this._calcSymbolWidthHeight(a.symbol);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, c.width);
                        return { symbol: a.symbol, symbolSize: c, label: a.label, minValue: a.minValue, maxValue: a.maxValue, id: this.renderer.infos.length - b }
                    }, this);
                    if (this.renderer.defaultSymbol) {
                        var a = this._calcSymbolWidthHeight(this.renderer.defaultSymbol);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, a.width);
                        this.data.push({ symbol: this.renderer.defaultSymbol, symbolSize: a, label: this.renderer.defaultLabel || this.i18n.other, minValue: "_default_", maxValue: "_default_", id: this.renderer.infos.length + 1 })
                    }
                },
                handleLabelChange: function(b, c) {
                    c.length ? b.label = c : "_default_" === b.minValue ? b.label = this.i18n.other : n.forEach(this.data, function(a, c) { b.id == a.id && (b.label = this.getLabel(b, 0, c)) }, this);
                    n.forEach(this.data, function(a) { b.id == a.id && (a.label = b.label) }, this);
                    a.publish("onUpdateColor", [{ symbol: b.symbol, minValue: b.minValue, maxValue: b.maxValue, label: b.label }])
                },
                onRowClickSymbolHandler: function(a, b) {
                    b = D.getSchemes({ theme: "above-and-below", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(a.symbol, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: b }, g.hitch(this, "onSymbolChange", a))
                },
                onSymbolChange: function(b, c, d, e, f) {
                    d = this._calcSymbolWidthHeight(c);
                    var h = {
                        symbol: c,
                        symbolSize: d,
                        label: b.label
                    };
                    n.forEach(this.data, function(a) { b.id == a.id && (a = g.mixin(a, h), this.store.put(a)) }, this);
                    this.maxSymbolWidth = this._calcTotalSymbolWidthHeight().width;
                    a.publish("onUpdateColor", [{ symbol: c, minValue: b.minValue, maxValue: b.maxValue, label: b.label }, f])
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.ColorGrid", c);
            return c
        })
}, "arcgisonline/map/dijit/renderer/_LabelsMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/dom dojo/dom-style dojo/dom-class dojo/string dojo/number esri/lang dojox/data/AndOrWriteStore".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r) {
            return {
                pattern: "#,###,###,##0.######",
                updateLabels: function(a) {
                    var b;
                    for (b = this.renderer.infos.length - 1; 0 <= b; b--) {
                        var c = this.renderer.infos[b];
                        c.label = this.getLabel(c, a, b)
                    }
                },
                getLabel: function(a, b, c) {
                    var d = "";
                    p.isDefined(b) && ("percent-of-total" === this.renderer.normalizationType ? 0 === b ? d = (0 < c ? "\x3e " : "") + h.substitute(this.i18n.percentValue, { num: m.format(a.minValue, { pattern: this.pattern }) }) + " - " + h.substitute(this.i18n.percentValue, { num: m.format(a.maxValue, { pattern: this.pattern }) }) :
                        1 > b ? (d = m.round(1 / b), d = (0 < c ? "\x3e " : "") + h.substitute(this.i18n.percentValue, { num: m.format(m.round(a.minValue / b) / d, { pattern: this.pattern }) }) + " - " + h.substitute(this.i18n.percentValue, { num: m.format(m.round(a.maxValue / b) / d, { pattern: this.pattern }) })) : d = (0 < c ? "\x3e " : "") + h.substitute(this.i18n.percentValue, { num: m.format(m.round(a.minValue / b) * b, { pattern: this.pattern }) }) + " - " + h.substitute(this.i18n.percentValue, { num: m.format(m.round(a.maxValue / b) * b, { pattern: this.pattern }) }) : 0 === b ? d = (0 < c ? "\x3e " : "") + m.format(a.minValue, { pattern: this.pattern }) + " - " + m.format(a.maxValue, { pattern: this.pattern }) : 1 > b ? (d = m.round(1 / b), d = (0 < c ? "\x3e " : "") + m.format(m.round(a.minValue / b) / d, { pattern: this.pattern }) + " - " + m.format(m.round(a.maxValue / b) / d, { pattern: this.pattern })) : d = (0 < c ? "\x3e " : "") + m.format(m.round(a.minValue / b) * b, { pattern: this.pattern }) + " - " + m.format(m.round(a.maxValue / b) * b, { pattern: this.pattern }));
                    return d
                },
                buildPrecisionsStore: function() {
                    var a = [];
                    a.push({ name: this.i18n.selectAnOptions, type: "select" });
                    a.push({
                        name: this.i18n.none,
                        type: "none"
                    });
                    var b = 0;
                    n.forEach(this.renderer.infos, function(a) {
                        b = Math.max(b, this.getPrecision(a.minValue));
                        b = Math.max(b, this.getPrecision(a.maxValue))
                    }, this);
                    var c = Math.abs(this.renderer.infos[0].minValue - this.renderer.infos[this.renderer.infos.length - 1].maxValue);
                    1E7 < c ? (a.push({ name: "1000000", type: "1000000" }), a.push({ name: "100000", type: "100000" }), a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({
                        name: "1",
                        type: "1"
                    }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E6 < c ? (a.push({ name: "100000", type: "100000" }), a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E5 < c ? (a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({
                        name: "10",
                        type: "10"
                    }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E4 < c ? (a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E3 < c ? (a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }),
                        3 < b && a.push({ name: "0.001", type: "0.001" })) : 100 < c ? (a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" })) : 10 < c ? (0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({
                        name: "0.0001",
                        type: "0.0001"
                    }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : 1 < c ? (1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : .1 < c ? (2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b &&
                        a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : .01 < c && (3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" }));
                    return new r({ data: { label: "name", identifier: "type", items: a } })
                },
                formatNumber: function(a) { return m.format(a, { pattern: this.pattern }) },
                getPrecision: function(a) { for (var b = 1; Math.round(a * b) / b !== a;) b *= 10; return Math.log(b) / Math.LN10 }
            }
        })
},
"arcgisonline/map/dijit/renderer/_PrecisionMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/dom dojo/dom-style dojo/dom-class dojo/string dojo/number esri/lang dojox/data/AndOrWriteStore".split(" "), function(b, g, n, a, c, d, f, e, h, m, p, r) {
        return {
            pattern: "#,###,###,##0.######",
            updateValues: function(a) {
                var b = this.renderer.infos;
                this.renderer.clearBreaks();
                n.forEach(b, function(c, d) {
                    c = this.updateMinMax(c, a, d, 0 === d ? "first" : d === b.length - 1 ? "last" : null);
                    this.renderer.addBreak({ minValue: c.minValue, maxValue: c.maxValue, symbol: c.symbol, label: c.label })
                }, this)
            },
            updateMinMax: function(a, b, c, d) {
                if (p.isDefined(b))
                    if ("percent-of-total" === this.renderer.normalizationType) {
                        if (0 !== b) {
                            if (1 > b) {
                                var e = m.round(1 / b);
                                a.minValue = "first" === d ? Math.floor(a.minValue / b) / e : m.round(a.minValue / b) / e;
                                a.maxValue = "last" === d ? Math.ceil(a.maxValue / b) / e : m.round(a.maxValue / b) / e
                            } else a.minValue = "first" === d ? Math.floor(a.minValue / b) * b : m.round(a.minValue / b) * b, a.maxValue = "last" === d ? Math.ceil(a.maxValue /
                                b) * b : m.round(a.maxValue / b) * b;
                            a.label = (0 < c ? "\x3e " : "") + h.substitute(this.i18n.percentValue, { num: m.format(a.minValue, { pattern: this.pattern }) }) + " " + this.i18n.to + " " + h.substitute(this.i18n.percentValue, { num: m.format(a.maxValue, { pattern: this.pattern }) })
                        }
                    } else 0 !== b && (1 > b ? (e = m.round(1 / b), a.minValue = "first" === d ? Math.floor(a.minValue / b) / e : m.round(a.minValue / b) / e, a.maxValue = "last" === d ? Math.ceil(a.maxValue / b) / e : m.round(a.maxValue / b) / e) : (a.minValue = "first" === d ? Math.floor(a.minValue / b) * b : m.round(a.minValue / b) *
                        b, a.maxValue = "last" === d ? Math.ceil(a.maxValue / b) * b : m.round(a.maxValue / b) * b), a.label = (0 < c ? "\x3e " : "") + m.format(a.minValue, { pattern: this.pattern }) + " " + this.i18n.to + " " + m.format(a.maxValue, { pattern: this.pattern }));
                return a
            },
            disableOptionsBelow: function(a, b) {
                n.forEach(a.options, function(a) { var c = a.item; "select" !== c.type[0] && parseFloat(c.name[0]) < b && (a.disabled = !0) });
                a.startup()
            },
            enableAllOptions: function(a) {
                n.forEach(a.options, function(a) { delete a.disabled });
                a.startup()
            },
            buildPrecisionsStore: function() {
                var a = [];
                a.push({ name: this.i18n.selectAnOptions, type: "select" });
                var b = 0;
                n.forEach(this.renderer.infos, function(a) {
                    b = Math.max(b, this.getPrecision(a.minValue));
                    b = Math.max(b, this.getPrecision(a.maxValue))
                }, this);
                var c = Math.abs(this.renderer.infos[0].minValue - this.renderer.infos[this.renderer.infos.length - 1].maxValue);
                1E7 < c ? (2E7 < c && a.push({ name: "10000000", type: "10000000" }), a.push({ name: "1000000", type: "1000000" }), a.push({ name: "100000", type: "100000" }), a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }),
                        a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E6 < c ? (2E6 < c && a.push({ name: "1000000", type: "1000000" }), a.push({ name: "100000", type: "100000" }), a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) :
                    1E5 < c ? (2E5 < c && a.push({ name: "100000", type: "100000" }), a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E4 < c ? (2E4 < c && a.push({ name: "10000", type: "10000" }), a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }),
                        2 < b && a.push({ name: "0.01", type: "0.01" })) : 1E3 < c ? (2E3 < c && a.push({ name: "1000", type: "1000" }), a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" })) : 100 < c ? (200 < c && a.push({ name: "100", type: "100" }), a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({
                        name: "0.001",
                        type: "0.001"
                    }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" })) : 10 < c ? (20 < c && a.push({ name: "10", type: "10" }), 0 < b && a.push({ name: "1", type: "1" }), 1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : 1 < c ? (1 < b && a.push({ name: "0.1", type: "0.1" }), 2 < b && a.push({ name: "0.01", type: "0.01" }),
                        3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : .1 < c ? (2 < b && a.push({ name: "0.01", type: "0.01" }), 3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : .01 < c ? (3 < b && a.push({ name: "0.001", type: "0.001" }), 4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({
                        name: "0.00001",
                        type: "0.00001"
                    }), 6 < b && a.push({ name: "0.000001", type: "0.000001" })) : .001 < c ? (4 < b && a.push({ name: "0.0001", type: "0.0001" }), 5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" }), 7 < b && a.push({ name: "0.0000001", type: "0.0000001" })) : 1E-4 < c ? (5 < b && a.push({ name: "0.00001", type: "0.00001" }), 6 < b && a.push({ name: "0.000001", type: "0.000001" }), 7 < b && a.push({ name: "0.0000001", type: "0.0000001" }), 8 < b && a.push({ name: "0.00000001", type: "0.00000001" })) : 1E-5 < c && (6 < b && a.push({ name: "0.000001", type: "0.000001" }),
                        7 < b && a.push({ name: "0.0000001", type: "0.0000001" }), 8 < b && a.push({ name: "0.00000001", type: "0.00000001" }), 9 < b && a.push({ name: "0.000000001", type: "0.000000001" }));
                return new r({ data: { label: "name", identifier: "type", items: a } })
            },
            getPrecision: function(a) { for (var b = 1; Math.round(a * b) / b !== a;) b *= 10; return Math.log(b) / Math.LN10 }
        }
    })
}, "arcgisonline/map/dijit/renderer/_ColorPanelMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-style dojo/string dojo/aspect dojo/dom-class dojo/store/Memory dijit/registry dijit/Dialog dijit/TooltipDialog dijit/Tooltip esri/styles/size esri/styles/choropleth esri/symbols/jsonUtils arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            return {
                tooltips: [],
                createTooltips: function() {
                    this.tooltips.push(new v({ connectId: this._rendererColorTransparencyTitle, label: this.wrapTooltipText(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorScaleTitle, label: this.wrapTooltipText(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorScaleSuggest, label: this.wrapTooltipText(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new v({
                        connectId: this._rendererColorRotationText,
                        label: this.wrapTooltipText(this.i18n.rotateTooltip)
                    }));
                    this.tooltips.push(new v({ connectId: this._rendererColorRotationAttribute.domNode, label: this.wrapTooltipText(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorClassifyText, label: this.wrapTooltipText(this.i18n.classifyDataTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorClassifyMethods.domNode, label: this.wrapTooltipText(this.i18n.classifyMethodTooltip) }));
                    this.tooltips.push(new v({
                        connectId: this._rendererColorClassifyClassesTitle,
                        label: this.wrapTooltipText(d.substitute(this.i18n.numberOfClassesTooltip, { num: 10 }))
                    }));
                    this.tooltips.push(new v({ connectId: this._rendererColorSymbolsTitle, label: this.wrapTooltipText(this.i18n.symbolsTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorZoomTitle, label: this.wrapTooltipText(this.i18n.zoomTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorInvertTitle, label: this.wrapTooltipText(this.i18n.invertTooltip) }));
                    this.legendClassesTooltip = new v({
                        connectId: this._rendererColorLegendClassesTitle,
                        label: this.wrapTooltipText(this.i18n.legendTooltip)
                    });
                    this.tooltips.push(this.legendClassesTooltip);
                    this.tooltips.push(new v({ connectId: this._rendererColorDividedByAttribute.domNode, label: this.wrapTooltipText(this.i18n.dividedByTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorTheme.domNode, label: this.wrapTooltipText(this.i18n.themeTooltip) }));
                    "classedColor" === this.getRendererStyle(this.renderer) ? this.otherTooltip = new v({ connectId: this._rendererColorOtherTxt, label: this.wrapTooltipText(this.i18n.drawClassifiedOthersTooltip) }) :
                        this.otherTooltip = new v({ connectId: this._rendererColorOtherTxt, label: this.wrapTooltipText(this.i18n.drawOthersTooltip) });
                    this.tooltips.push(this.otherTooltip);
                    this.tooltips.push(new v({ connectId: this._rendererColorOtherSymbol, label: this.wrapTooltipText(this.i18n.otherSymbolTooltip) }));
                    this.tooltips.push(new v({ connectId: this._rendererColorOtherSymbolText, label: this.wrapTooltipText(this.i18n.otherSymbolTooltip) }));
                    this.tooltips.push(new v({
                        connectId: this._rendererColorRotationEditExpression,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" +
                            this.i18n.editExpression + "\x3c/div\x3e"
                    }));
                    this.tooltips.push(new v({ connectId: this._rendererColorDividedByFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this.tooltips.push(new v({ connectId: this._rendererColorRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                wrapTooltipText: function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" },
                destroyTooltips: function() {
                    n.forEach(this.tooltips,
                        function(a) { a.destroy() })
                },
                _fillRendererColorTheme: function() {
                    var a = function(a, b, c, d) { return "\x3chtml\x3e\x3cbody\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd width\x3d'30'\x3e\x3cdiv class\x3d'" + c + "'\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd valign\x3d'top'\x3e\x3cdiv class\x3d'" + d + "_themeTitle'\x3e" + a + "\x3c/div\x3e\x3cdiv class\x3d'" + d + "_themeMsg'\x3e" + b + "\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/body\x3e\x3c/html\x3e" };
                    this.themesData = [];
                    this.attributeTypeIsDate ? (this.themesData.push({
                        name: this.i18n.newToOld,
                        label: a(this.i18n.newToOld, this.i18n.newToOldMsg, this.baseClass + "_highToLowIcon", this.baseClass)
                    }), this.themesData.push({ name: this.i18n.beforeAndAfter, label: a(this.i18n.beforeAndAfter, this.i18n.beforeAndAfterMsg, this.baseClass + "_aboveAndBelowIcon", this.baseClass) })) : (this.themesData.push({ name: this.i18n.highToLow, label: a(this.i18n.highToLow, this.i18n.highToLowMsg, this.baseClass + "_highToLowIcon", this.baseClass) }), this.themesData.push({
                        name: this.i18n.aboveAndBelow,
                        label: a(this.i18n.aboveAndBelow, this.i18n.aboveAndBelowMsg,
                            this.baseClass + "_aboveAndBelowIcon", this.baseClass)
                    }), this.themesData.push({ name: this.i18n.centered, label: a(this.i18n.centered, this.i18n.centeredMsg, this.baseClass + "_centeredIcon", this.baseClass) }), this.themesData.push({ name: this.i18n.extremes, label: a(this.i18n.extremes, this.i18n.extremesMsg, this.baseClass + "_extremesIcon", this.baseClass) }));
                    this.themesStore = new h({ data: this.themesData, idProperty: "name" });
                    this._rendererColorTheme.set("store", this.themesStore);
                    this._rendererColorTheme.set("labelAttr",
                        "label");
                    this._rendererColorTheme.set("labelType", "html");
                    this._rendererColorTheme.set("value", this.attributeTypeIsDate ? this.i18n.newToOld : this.i18n.highToLow);
                    this._rendererColorTheme.textbox.readOnly = !0;
                    c.set(this._rendererColorTheme.textbox, "cursor", "pointer");
                    this._rendererColorTheme.textbox.onclick = g.hitch(this, function() { this._rendererColorTheme.loadDropDown() });
                    f.after(this._rendererColorTheme, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _onChangeColorTheme: function() {
                    this.disableAllEvents ||
                        (this.clearZoom(), this.getParams().then(g.hitch(this, function(a) {
                            this.updateThemeOnColorRenderer(a).then(g.hitch(this, function(a) {
                                this.hideBusy();
                                this.applyColorRenderer(a, { theme: this.getTheme() })
                            }), g.hitch(this, function() {
                                this.hideBusy();
                                this.updateUIWithRenderer()
                            }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        })))
                },
                getTheme: function() {
                    switch (this._rendererColorTheme ? this._rendererColorTheme.get("value") : "high-to-low") {
                        case this.i18n.highToLow:
                        case this.i18n.newToOld:
                            return "high-to-low";
                        case this.i18n.aboveAndBelow:
                        case this.i18n.beforeAndAfter:
                            return "above-and-below";
                        case this.i18n.centered:
                            return "centered-on";
                        case this.i18n.extremes:
                            return "extremes";
                        case this.i18n.groupSimilar:
                            return "group-similar";
                        default:
                            return "high-to-low"
                    }
                },
                getThemeAlias: function(a) {
                    switch (a) {
                        case "high-to-low":
                            return this.attributeTypeIsDate ? this.i18n.newToOld : this.i18n.highToLow;
                        case "above-and-below":
                            return this.attributeTypeIsDate ? this.i18n.beforeAndAfter : this.i18n.aboveAndBelow;
                        case "centered-on":
                            return this.i18n.centered;
                        case "extremes":
                            return this.i18n.extremes;
                        case "group-similar":
                            return this.i18n.groupSimilar;
                        default:
                            return this.i18n.highToLow
                    }
                },
                _onClickInvert: function() {
                    if (!this.disableAllEvents) {
                        this.invertColor();
                        var a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                        this.colorSlider && this.colorSlider.set("colorInfo", g.clone(a));
                        this.applyColorRenderer(this.renderer)
                    }
                },
                invertColor: function() {
                    for (var a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables), b =
                            a.stops.length - 1, c = Math.floor(b / 2), d = 0; d <= c; d++) {
                        var e = a.stops[d].color;
                        a.stops[d].color = a.stops[b - d].color;
                        a.stops[b - d].color = e
                    }
                    b = this.getVisualVariablesExceptTypes([{ type: "colorInfo" }], this.renderer.visualVariables) || [];
                    b.push(a);
                    this.renderer.setVisualVariables(b)
                },
                _onClickZoom: function() {
                    !this.disableAllEvents && this.colorSlider && (this.colorSlider.get("zoomOptions") ? (this.zoomOutSlider(), e.remove(this._rendererColorZoomIcon, "active"), this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn) : this.getParams().then(g.hitch(this,
                        function(a) {
                            this.zoomInSlider(a).then(g.hitch(this, function(a) {
                                this.hideBusy();
                                e.add(this._rendererColorZoomIcon, "active");
                                this._rendererColorZoomLabel.innerHTML = this.i18n.zoomOut
                            }), g.hitch(this, function(a) { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        })))
                },
                clearZoom: function() { this.colorSlider && (this.colorSlider.get("zoomOptions") && this.zoomOutSlider(), e.remove(this._rendererColorZoomIcon, "active"), this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn) },
                onColorSliderChange: function(a) {
                    "classedColor" ===
                    this.getRendererStyle(this.renderer) && (this.disableAllEvents = !0, this.authoringInfo && delete this.authoringInfo.classificationMethod, this.renderer.authoringInfo && delete this.renderer.authoringInfo.classificationMethod, this.renderer.classificationMethod = null, this._rendererColorClassifyMethods.set("value", this.getClassificationMethod(null)), this._rendererColorClassifyClasses.set("value", this.renderer.infos.length), c.set(this._rendererColorClassifyClassesTitle, "display", ""), c.set(this._rendererColorClassifyStdDevIntervalTitle,
                        "display", "none"), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3))
                },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg = (new p({ id: "attributeTransparencyDlg", style: "visibility:hidden;" })).placeAt(document.body);
                    this.attributeTransparencyDlgContent = new B({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler =
                        a.connect(this.attributeTransparencyDlg, "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new E({ attributesStore: this.attributesStore, layer: this.fLayer || this.layer, mapLayer: this.mapLayer, showDateFields: this.showDateFields, numHistogramBins: this.numHistogramBins, savedRenderers: this.savedRenderers }, "attributeTransparencyDlgContent");
                    this.attributeTransparencyDlg.set({ title: this.i18n.attributeTransparencyDlgTitle, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler = a.subscribe("attribute-transparency-commit", g.hitch(this, function(a) {
                        this.hideAttributeTransparencyDlg();
                        if (a.opacityInfo) this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo = g.clone(a.authoringInfo), this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyColorRenderer(this.renderer), this.attributesStore.fetchItemByIdentity({
                            identity: a.opacityInfo.field || "customExprTrans",
                            onItem: g.hitch(this, function(b) {
                                a.opacityInfo.normalizationField ?
                                    this.attributesStore.fetchItemByIdentity({ identity: a.opacityInfo.normalizationField, onItem: g.hitch(this, function(a) { this._rendererColorAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: b.alias || b.name, field2: a.alias || a.name }) }) }) : this._rendererColorAttributeTransparencyLabel_part2.innerHTML = a.opacityInfo.field ? b.alias || b.name : a.opacityInfo.valueExpressionTitle || a.opacityInfo.legendOptions && a.opacityInfo.legendOptions.title
                            })
                        });
                        else {
                            var b = this.getVisualVariablesExceptType("opacityInfo",
                                null, this.renderer.visualVariables);
                            this.renderer.setVisualVariables(b);
                            this.applyColorRenderer(this.renderer);
                            this._rendererColorAttributeTransparencyLabel_part2.innerHTML = this.i18n.attributeValues
                        }
                    }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() { c.set(this.attributeTransparencyDlg.domNode, "visibility", "visible") }))
                },
                hideAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlg &&
                        this.attributeTransparencyDlg.hide()
                },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler && a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency &&
                        this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    m.byId("attributeTransparencyDlg") && m.byId("attributeTransparencyDlg").destroy()
                },
                _onChangeRotation: function(a) {
                    this.disableAllEvents || (c.set(this._rendererColorRotationContent, "display", a ? "" : "none"),
                        this.adjustHeight(), this.updateRotationInfo())
                },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererColorRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererColorRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b = a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererColorRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                                    this._rendererColorRotationAttribute.set("value", "customExprRotation", !1);
                                    a = {
                                        valueExpression: a.valueExpression,
                                        valueExpressionTitle: a.valueExpressionTitle,
                                        rotationType: this._rendererColorRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic",
                                        type: "rotationInfo"
                                    };
                                    this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.setVisualVariables(c);
                                    this.applyColorRenderer(this.renderer);
                                    this.updateUIWithRenderer()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b,
                                        "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", d.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo();
                                    this.updateUIWithRenderer()
                                }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                            })
                        });
                        else {
                            c.set(this._rendererColorRotationEditExpression, "display", "none");
                            var a = {
                                field: this._rendererColorRotationAttribute.get("value"),
                                rotationType: this._rendererColorRotationClockwiseRadio.get("checked") ?
                                    "geographic" : "arithmetic",
                                type: "rotationInfo"
                            };
                            this.getAttributeItemFromStore(this._rendererColorRotationAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? c.set(this._rendererColorRotationFieldDescription, "display", "") : c.set(this._rendererColorRotationFieldDescription, "display", "none") }));
                            this.renderer.setRotationInfo(null);
                            var b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                            b.push(a);
                            this.renderer.setVisualVariables(b);
                            this.applyColorRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null), this.removeRotationInfoVisualVariable(), this.applyColorRenderer(this.renderer), this.adjustHeight()
                },
                _onChangeLegend: function(a) {
                    this.updateLegendProperty(this.renderer, "colorInfo", a);
                    this.applyColorRenderer(this.renderer)
                },
                _onClickSymbols: function() {
                    var a = t.getSchemes({ theme: this.getTheme(), basemap: this.getBasemapType(), geometryType: this.geometryType }),
                        b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    if (!b) {
                        var c =
                            t.getSchemes({ theme: "above-and-below", basemap: this.getBasemapType(), geometryType: this.geometryType });
                        a.secondarySchemes.push(c.primaryScheme);
                        a.secondarySchemes = a.secondarySchemes.concat(c.secondarySchemes)
                    }
                    var c = [],
                        d = 0;
                    if (b)
                        for (var e = b.stops, b = 0; b < e.length; b++) c.push(e[b].color);
                    else {
                        for (b = 0; b < this.renderer.infos.length; b++) c.push(this.renderer.infos[b].symbol.color);
                        d = this.renderer.infos.length
                    }
                    b = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                    e = null;
                    this.isMultiAttributesRenderer && (e = { symbolDisplayMode: "default" });
                    this.showSymbolStyler(b, { externalSizing: this.isMultiAttributesRenderer ? !0 : !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: a, tabOptions: e, colorRamp: { colors: c, numStops: d, scheme: this.scheme } }, g.hitch(this, "onSymbolsChange"))
                },
                onSymbolsChange: function(a, b, c, d) {
                    this.scheme = c || this.scheme;
                    this.updateSymbolOnColorRenderer({ symbol: a, colors: b });
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType &&
                        "esriGeometryMultipoint" != this.geometryType || (a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType), this.drawRotationSymbol(a, this._rendererColorRotateRightSymbol, this._rendererColorRotateLeftSymbol));
                    this.updateColorRenderer(d)
                },
                _onClickPolygons: function(a, b) {
                    a = w.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.renderer.backgroundFillSymbol, {
                        externalSizing: !1,
                        optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                        schemes: a
                    }, g.hitch(this, "onPolygonSymbolChange"))
                },
                onPolygonSymbolChange: function(a, b, c, d) {
                    this.renderer.backgroundFillSymbol = x.fromJson(a.toJson());
                    this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) || (this.drawSymbol(this._rendererColorPolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererColorPolygonSymbol)) : (this.renderer.backgroundFillSymbol = x.fromJson(this.transparentPolygonSymbolJson),
                        this.drawTransparentSymbol(this._rendererColorPolygonSymbol));
                    this.updateColorRenderer(d)
                },
                _onChangeOther: function(a) { this.disableAllEvents || (a ? (c.set(this._rendererColorOther, "display", ""), this.renderer.defaultSymbol = this.defaultInfo.defaultSymbol, this.renderer.defaultLabel = this.defaultInfo.defaultLabel) : (c.set(this._rendererColorOther, "display", "none"), delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel), this.applyColorRenderer(this.renderer)) },
                onClickOtherSymbol: function(a, b) {
                    b =
                        t.getSchemes({ theme: this.getTheme(), basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.defaultInfo.defaultSymbol, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: b }, g.hitch(this, "onOtherSymbolChange", a))
                },
                onOtherSymbolChange: function(a, b, c, d, e) {
                    a = b.toJson();
                    "esriPMS" !== b.type || 0 !== a.url.length && "http://" !== a.url || (b = x.fromJson(this.getMarkerJson()));
                    this.defaultInfo.defaultSymbol = b;
                    this.renderer.defaultSymbol &&
                        (this.renderer.defaultSymbol = x.fromJson(b.toJson()));
                    this.updateColorRenderer(e);
                    this.adjustHeight()
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) }
            }
        })
}, "arcgisonline/map/dijit/renderer/Size": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dojo/store/Memory dojo/data/ObjectStore esri/lang esri/symbols/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_SizeMixin arcgisonline/map/dijit/renderer/_PredominanceMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_PrecisionMixin arcgisonline/map/dijit/renderer/_SizePanelMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Size.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U) {
            b = b([S, W], {
                declaredClass: "arcgisonline.map.dijit.renderer.Size",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererSize",
                widgetsInTemplate: !0,
                templateString: U,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                sizeRendererGrid: null,
                origGalleryRenderer: null,
                isMultiAttributesRenderer: !1,
                attributeTypeIsDate: !1,
                constructor: function(a, b) {
                    g.mixin(this, H);
                    g.mixin(this, L);
                    g.mixin(this, J);
                    g.mixin(this, M);
                    g.mixin(this, K);
                    g.mixin(this, P);
                    g.mixin(this, O);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.sizeSlider && this.sizeSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.destroySizeRendererGrid();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(R.common);
                    g.mixin(this.i18n, R.rendererCommon);
                    g.mixin(this.i18n, R.rendererSizePanel);
                    g.mixin(this.i18n, R.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererSizePanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"),
                        "resize", this, "adjustHeight"));
                    this._rConnects.push(a.subscribe("onUpdateSize", g.hitch(this, "onUpdateInfo")));
                    a.connect(this._rendererSizeOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererSizeRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererSizeRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererSizeRotationAttribute));
                    a.connect(this._rendererSizeDividedByFieldDescription, "click",
                        g.hitch(this, "onFieldDescriptionClick", this._rendererSizeDividedByAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack(this.renderer) :
                        leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded ||
                        dojo.style(dojo.byId("rendererSizeFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererSizeHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    var a = this.getRendererStyle(this.renderer);
                    this.isMultiAttributesRenderer = -1 < dojo.indexOf(["colorsize", "ageColorSize", "uniquesize", "predominancesize", "relationshipSize"], this.getRendererStyle(this.renderer));
                    this._rendererSizeLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g,
                        " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererSizeLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererSizeField.innerHTML = "predominancesize" === a ? this.i18n.sumOfCategories : this.attributeItem.valueExpressionTitle || this.attributeItem.alias;
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    t.set(this._rendererSizeGridDiv, "display", "none");
                    this.attributeTypeIsDate = this.attributeItem && "esriFieldTypeDate" ===
                        this.attributeItem.type;
                    this.scheme = null;
                    var b = new G({ data: [{ label: "" + p.format(.5, { pattern: "0.##" }), id: .5, value: .5 }, { label: "1", id: 1, value: 1 }] }),
                        b = new F({ objectStore: b });
                    this._rendererSizeClassifyStdDevInterval.set("store", b);
                    this._rendererSizeClassifyStdDevInterval.set("value", 1);
                    this.transparencySlider = this.createTransparencySlider("rendererSizeTransparencySlider");
                    this.createScaleSlider("rendererSizeScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    "predominancesize" === a || this.attributeTypeIsDate ||
                        this.attributeItem.valueExpression ? t.set(f.byId("rendererSizeDividedBy"), "display", "none") : this.attributesStore.fetchItemByIdentity({ identity: "_total_", onItem: g.hitch(this, function(a) { a.alias = [d.substitute(this.i18n.total, { field: this.attributeItem.alias })] }) });
                    "esriGeometryPolygon" !== this.geometryType || this.newDMS && "uniquesize" === a ? t.set(this._rendererSizePolygonsTitle, "display", "none") : t.set(this._rendererSizePolygonsTitle, "display", "");
                    b = this.i18n.minSizeInPixels.indexOf("${num}");
                    this._rendererSizeMinPart1.innerHTML =
                        this.i18n.minSizeInPixels.substring(0, b);
                    this._rendererSizeMinPart2.innerHTML = this.i18n.minSizeInPixels.substring(b + 6);
                    b = this.i18n.maxSizeInPixels.indexOf("${num}");
                    this._rendererSizeMaxPart1.innerHTML = this.i18n.maxSizeInPixels.substring(0, b);
                    this._rendererSizeMaxPart2.innerHTML = this.i18n.maxSizeInPixels.substring(b + 6);
                    "esriGeometryPolyline" == this.geometryType ? (this._rendererSizeMin.set("constraints", { min: 0, max: 18, places: 0 }), this._rendererSizeMax.set("constraints", { min: 0, max: 18, places: 0 })) : (this._rendererSizeMin.set("constraints", { min: 1, max: 120, places: 0 }), this._rendererSizeMax.set("constraints", { min: 1, max: 120, places: 0 }));
                    "predominancesize" === a || this.attributeTypeIsDate ? (t.set(this._rendererSizeClassify, "display", "none"), t.set(this._rendererSizeOtherCheckMsg, "paddingTop", "20px")) : (this.hasDynamic && !this.newDMS && (t.set(this._rendererSizeClassifyCheckDiv, "display", "none"), w.add(this._rendererSizeClassifyText, "sectionTitle"), t.set(this._rendererSizeClassify, "paddingBottom", "10px")), this._fillRendererSizeClassifications(), b = this.i18n.classifyMethod.indexOf("${method}"),
                        this._rendererSizeClassifyMethodPart1.innerHTML = this.i18n.classifyMethod.substring(0, b), this._rendererSizeClassifyMethodPart2.innerHTML = this.i18n.classifyMethod.substring(b + 9), b = this.i18n.classifyClasses.indexOf("${num}"), this._rendererSizeClassifyClassesPart1.innerHTML = this.i18n.classifyClasses.substring(0, b), this._rendererSizeClassifyClassesPart2.innerHTML = this.i18n.classifyClasses.substring(b + 6), b = this.i18n.classifyStdDevIntervals.indexOf("${num}"), this._rendererSizeClassifyStdDevIntervalPart1.innerHTML =
                        this.i18n.classifyStdDevIntervals.substring(0, b), this._rendererSizeClassifyStdDevIntervalPart2.innerHTML = this.i18n.classifyStdDevIntervals.substring(b + 6));
                    this.hasNumericField && -1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolygon"], this.geometryType) ? (this._rendererSizeRotationAttribute.setStore(this.attributesStore, "", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                            this.layer.objectIdField + "'"
                    }), t.set(this._rendererSizeRotation, "display", "")) : t.set(this._rendererSizeRotation, "display", "none");
                    if (this.hasDynamic && !this.newDMS || this.isGeoRSS || this.isSL || !this.hasNumericField) m(".rendererSizeHasAttributeTransparency").forEach(function(a) { t.set(a, "display", "none") }), w.remove(f.byId("rendererSizeTransparencySliderDiv"), "esriLeadingPadding1");
                    else {
                        var b = this.i18n.setFromField,
                            c = b.indexOf("${field}");
                        this._rendererSizeAttributeTransparencyLabel_part1.innerHTML = b.substring(0,
                            c);
                        this._rendererSizeAttributeTransparencyLabel_part3.innerHTML = b.substring(c + 8);
                        var e = this.getOpacityInfo();
                        e ? e.valueExpression ? this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = "predominancesize" === a ? this.i18n.predominantPercentage : this.getRendererCustomExpression(null, "transparency").title : e.field && this.attributesStore.fetchItemByIdentity({
                            identity: e.field,
                            onItem: g.hitch(this, function(a) {
                                e.normalizationField ? this.attributesStore.fetchItemByIdentity({
                                    identity: e.normalizationField,
                                    onItem: g.hitch(this,
                                        function(b) { this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: a.alias || a.name, field2: b.alias || b.name }) })
                                }) : this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name
                            })
                        }) : this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = this.i18n.attributeValues
                    }
                    this.updateUIWithRenderer();
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    var a = this.getRendererStyle(this.renderer);
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    var b = !1;
                    "size" === a && this.renderer.normalizationTotal && "percent-of-total" === this.renderer.normalizationType && (b = !0);
                    this.isMultiAttributesRenderer && t.set(this._rendererSizeClassify, "display", "none");
                    "predominancesize" === a ? t.set(f.byId("rendererSizeDividedBy"), "display", "none") : ("classedSize" === a ? this._rendererSizeDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", {
                            query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none'" +
                                (b ? " OR type:'total'" : "") + ") AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'"
                        }) : this._rendererSizeDividedByAttribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" }), b ? this._rendererSizeDividedByAttribute.set("value", "_total_") :
                        -1 < n.indexOf(["size", "classedSize"], a) && this.renderer.normalizationField && "field" === this.renderer.normalizationType ? this._rendererSizeDividedByAttribute.set("value", this.renderer.normalizationField) : -1 < n.indexOf(["colorsize", "uniquesize", "ageColorSize", "relationshipSize"], a) && (b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) && b.normalizationField && this._rendererSizeDividedByAttribute.set("value", b.normalizationField));
                    this.getAttributeItemFromStore(this._rendererSizeDividedByAttribute.get("value")).then(g.hitch(this,
                        function(a) { a && a.descriptionValue ? t.set(this._rendererSizeDividedByFieldDescription, "display", "") : t.set(this._rendererSizeDividedByFieldDescription, "display", "none") }));
                    "esriGeometryPolygon" === this.geometryType && (this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ? this.drawTransparentSymbol(this._rendererSizePolygonSymbol) : (this.drawSymbol(this._rendererSizePolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol,
                        this._rendererSizePolygonSymbol)) : (this.renderer.backgroundFillSymbol = A.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererSizePolygonSymbol)));
                    b = this.getSymbolFromClassedSizeRenderer(this.renderer);
                    this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === b.type ? b : this.switchSizeKeepSymbol(b, 28), null, null, null, 1);
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererSizeOther,
                        "display", ""), this._rendererSizeOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererSizeOther, "display", "none"), this._rendererSizeOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererSizeOtherSymbol) : (this.drawSymbol(this._rendererSizeOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol,
                        this._rendererSizeOtherSymbol));
                    this.hasDynamic || "esriGeometryPolygon" !== this.geometryType || "size" !== a && "colorsize" !== a && "uniquesize" !== a && "predominancesize" !== a && "relationshipSize" !== a ? (m(".sizingTypes").forEach(function(a) { t.set(a, "display", "none") }), m(".sizingTypes2").forEach(function(a) { w.remove(a, "esriLeadingMargin107") })) : ("object" === typeof this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables).minSize ? (this._rendererSizeAutomaticRadio.set("checked", !0), this.disableSizeInput()) :
                        (this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput()), m(".sizingTypes").forEach(function(a) { t.set(a, "display", "") }), m(".sizingTypes2").forEach(function(a) { w.add(a, "esriLeadingMargin107") }));
                    "classedSize" === a ? (t.set(this._rendererSizeZoomTitle, "display", "none"), this._rendererSizeMin.set("value", this.renderer.infos && this.renderer.infos.length ? this.getSymbolSize(this.renderer.infos[0].symbol) : 8), this._rendererSizeMax.set("value", this.renderer.infos && this.renderer.infos.length ? this.getSymbolSize(this.renderer.infos[this.renderer.infos.length -
                            1].symbol) : 50), this._rendererSizeClassifyCheck.set("checked", !0), t.set(this._rendererSizeClassifyContent, "display", ""), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", "none"), t.set(this._rendererSizeLegendClassesTitle, "display", ""), this._rendererSizeClassifyClasses.set("value", this.renderer.infos.length), this._rendererSizeOtherTxt.innerHTML = this.i18n.drawClassifiedOthers, t.set(this._rendererSizeLegend, "display", "none"), this.renderer.authoringInfo ? (this._rendererSizeClassifyMethods.set("value",
                            this.getClassificationMethod(this.fromClassificationMethodConstant(this.renderer.authoringInfo.classificationMethod))), "esriClassifyStandardDeviation" === this.renderer.authoringInfo.classificationMethod ? (this._rendererSizeClassifyStdDevInterval.set("value", this.renderer.authoringInfo.standardDeviationInterval || 1), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", ""), t.set(this._rendererSizeClassifyClassesTitle, "display", "none")) : this._rendererSizeClassifyClasses.set("value", this.renderer.infos.length)) :
                        this._rendererSizeClassifyClasses.set("value", this.renderer.infos.length)) : (this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererSizeZoomTitle, "display", ""), b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), this._rendererSizeMin.set("value", "number" === typeof b.minSize ? Math.min(b.minSize, b.maxSize) : Math.min(b.minSize.stops[1].size, b.maxSize.stops[1].size)), this._rendererSizeMax.set("value", "number" === typeof b.maxSize ? Math.max(b.minSize, b.maxSize) : Math.max(b.minSize.stops[1].size,
                        b.maxSize.stops[1].size)), this._rendererSizeClassifyCheck.set("checked", !1), t.set(this._rendererSizeClassifyContent, "display", "none"), t.set(this._rendererSizeInvertTitle, "display", ""), t.set(this._rendererSizeLegendClassesTitle, "display", "none"), this._rendererSizeOtherTxt.innerHTML = this.i18n.drawOthers, t.set(this._rendererSizeLegend, "display", ""));
                    t.set(this._rendererSizeRotationEditExpression, "display", "none");
                    t.set(this._rendererSizeRotationFieldDescription, "display", "none");
                    this.hasNumericField &&
                        -1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolygon"], this.geometryType) && (b = this.getSymbolFromClassedSizeRenderer(this.renderer), this.drawRotationSymbol(b, this._rendererSizeRotateRightSymbol, this._rendererSizeRotateLeftSymbol), b = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), this._rendererSizeRotationCheck.set("checked", b ? !0 : !1), b && (this._rendererSizeRotationClockwiseRadio.set("checked", !("arithmetic" === b.rotationType ||
                            "arithmetic" === b.type)), this._rendererSizeRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== b.rotationType && "arithmetic" !== b.type)), b.field ? (this._rendererSizeRotationAttribute.set("value", b.field), this.getAttributeItemFromStore(b.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererSizeRotationFieldDescription, "display", "") }))) : b.valueExpression && (this._rendererSizeRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererSizeRotationEditExpression,
                            "display", ""))), t.set(this._rendererSizeRotationContent, "display", b ? "" : "none"));
                    (b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) && (b.legendOptions && !1 === b.legendOptions.showLegend ? this._rendererSizeLegendCheck.set("checked", !1) : this._rendererSizeLegendCheck.set("checked", !0));
                    "classedSize" === a ? this.getParams().then(g.hitch(this, function(a) {
                        9 > e("ie") ? setTimeout(g.hitch(this, function() {
                            this.createClassedSizeInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }),
                                g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        }), 1E3) : this.createClassedSizeInfoSlider(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                    })) : this.getParams().then(g.hitch(this, function(a) {
                        9 > e("ie") ? setTimeout(g.hitch(this, function() {
                            this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }),
                                g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        }), 1E3) : this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                    }));
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                _fillRendererSizeClassifications: function() {
                    var a = function(a, b, c) {
                        return "\x3chtml\x3e\x3cbody\x3e\x3cdiv class\x3d'" +
                            c + "_classificationTitle'\x3e" + a + "\x3c/div\x3e\x3cdiv class\x3d'" + c + "_classificationMsg'\x3e" + b + "\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e"
                    };
                    this.classificationData = [];
                    this.classificationData.push({ name: this.i18n.classifyNaturalBreaks, key: "natural-breaks", label: a(this.i18n.classifyNaturalBreaks, this.i18n.classifyNaturalBreaksMsg, this.baseClass) });
                    this.classificationData.push({
                        name: this.i18n.classifyEqualInterval,
                        key: "equal-interval",
                        label: a(this.i18n.classifyEqualInterval, this.i18n.classifyEqualIntervalMsg,
                            this.baseClass)
                    });
                    this.isFeatColl || this.classificationData.push({ name: this.i18n.classifyStandardDeviation, key: "standard-deviation", label: a(this.i18n.classifyStandardDeviation, this.i18n.classifyStandardDeviationMsg, this.baseClass) });
                    this.classificationData.push({ name: this.i18n.classifyQuantile, key: "quantile", label: a(this.i18n.classifyQuantile, this.i18n.classifyQuantileMsg, this.baseClass) });
                    this.classificationData.push({
                        name: this.i18n.classifyManualBreaks,
                        key: "manual",
                        label: a(this.i18n.classifyManualBreaks,
                            this.i18n.classifyManualBreaksMsg, this.baseClass)
                    });
                    this.classificationStore = new G({ data: this.classificationData, idProperty: "name" });
                    this._rendererSizeClassifyMethods.set("store", this.classificationStore);
                    this._rendererSizeClassifyMethods.set("labelAttr", "label");
                    this._rendererSizeClassifyMethods.set("labelType", "html");
                    this._rendererSizeClassifyMethods.textbox.readOnly = !0;
                    t.set(this._rendererSizeClassifyMethods.textbox, "cursor", "pointer");
                    this._rendererSizeClassifyMethods.textbox.onclick = g.hitch(this,
                        function() { this._rendererSizeClassifyMethods.loadDropDown() });
                    this.renderer.authoringInfo && this.renderer.authoringInfo.classificationMethod ? this._rendererSizeClassifyMethods.set("value", this.getClassificationMethod(this.fromClassificationMethodConstant(this.renderer.authoringInfo.classificationMethod))) : this._rendererSizeClassifyMethods.set("value", this.i18n.classifyManualBreaks);
                    t.set(this._rendererSizeClassifyClassesTitle, "display", "");
                    t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display",
                        "none");
                    r.after(this._rendererSizeClassifyMethods, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _onChangeDividedByAttribute: function() {
                    this.disableAllEvents || (this.getAttributeItemFromStore(this._rendererSizeDividedByAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererSizeDividedByFieldDescription, "display", "") : t.set(this._rendererSizeDividedByFieldDescription, "display", "none") })), this.adjustHeight(), this.getParams().then(g.hitch(this, function(a) {
                        this.clearZoom();
                        this.buildSizeRenderer(a).then(g.hitch(this, function(b) {
                            var c = b.renderer;
                            b = b.statistics;
                            this.renderer = c;
                            a.statistics = b;
                            this._rendererSizeDividedByAttribute.setStore(this.attributesStore, a.normalizationField || "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" });
                            D.isDefined(a.numClasses) && a.numClasses !==
                                c.infos.length && (this.disableAllEvents = !0, this._rendererSizeClassifyClasses.set("value", c.infos.length), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3));
                            this.drawSymbol(this._rendererSizeOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1);
                            a.inverted && this.invertSize(a.inverted);
                            this.applySizeRenderer(this.renderer);
                            this._rendererSizeClassifyCheck.get("checked") ? this.createClassedSizeInfoSlider(a).then(g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function() { this.hideBusy() })) :
                                this.createSizeInfoSlider(a).then(g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function() { this.hideBusy() }))
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                    })))
                },
                _onClickLegendClasses: function() {
                    -1 === this._rendererSizeLegendClassesIcon.className.indexOf("active") ? (w.add(this._rendererSizeLegendClassesIcon, "active"), this._rendererSizeLegendClassesText.innerHTML = this.i18n.classes, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.classesTooltip)),
                        t.set(this._rendererSizeSliderDiv, "display", "none"), t.set(this._rendererSizeGridDiv, "display", ""), this.updateSizeRendererGrid()) : (w.remove(this._rendererSizeLegendClassesIcon, "active"), this._rendererSizeLegendClassesText.innerHTML = this.i18n.legend, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip)), t.set(this._rendererSizeSliderDiv, "display", ""), t.set(this._rendererSizeGridDiv, "display", "none"))
                },
                _onChangeClassify: function(a) {
                    this.disableAllEvents ? "size" === this.getRendererStyle(this.renderer) ?
                        this._rendererSizeClassifyCheck.set("checked", !1) : this._rendererSizeClassifyCheck.set("checked", !0) : (a ? (t.set(this._rendererSizeClassifyContent, "display", ""), t.set(this._rendererSizeZoomTitle, "display", "none"), t.set(this._rendererSizeClassifyClassesTitle, "display", ""), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", "none"), w.remove(this._rendererSizeLegendClassesIcon, "active"), t.set(this._rendererSizeLegendClassesTitle, "display", ""), this._rendererSizeLegendClassesText.innerHTML = this.i18n.legend,
                            this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip)), t.set(this._rendererSizeSliderDiv, "display", ""), t.set(this._rendererSizeGridDiv, "display", "none"), t.set(this._rendererSizeLegend, "display", "none"), this.disableAllEvents = !0, this._rendererSizeClassifyMethods.set("value", this.i18n.classifyNaturalBreaks), this._rendererSizeOtherTxt.innerHTML = this.i18n.drawClassifiedOthers, this.otherTooltip.set("label", this.wrapTooltipText(this.i18n.drawClassifiedOthers))) : (t.set(this._rendererSizeInvertTitle,
                            "display", ""), t.set(this._rendererSizeClassifyContent, "display", "none"), t.set(this._rendererSizeLegendClassesTitle, "display", "none"), t.set(this._rendererSizeZoomTitle, "display", ""), t.set(this._rendererSizeLegend, "display", ""), this._rendererSizeOtherTxt.innerHTML = this.i18n.drawOthers, this.otherTooltip.set("label", this.wrapTooltipText(this.i18n.drawOthers)), "_total_" === this._rendererSizeDividedByAttribute.get("value") && (this.disableAllEvents = !0, this._rendererSizeDividedByAttribute.setStore(this.attributesStore,
                            "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'" }))), this.updateClassifyInfo(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3))
                },
                _onChangeClassifyMethod: function(a) {
                    this.disableAllEvents || (this._rendererSizeClassifyMethods.get("value") === this.i18n.classifyManualBreaks ? (this.disableAllEvents = !0, 10 < this.renderer.infos.length ? (this._rendererSizeClassifyMethods.set("value", this.i18n.classifyNaturalBreaks), this.updateClassifyInfo()) : (this._rendererSizeClassifyClasses.set("value", this.renderer.infos.length), delete this.authoringInfo.classificationMethod, delete this.renderer.authoringInfo.classificationMethod, delete this.authoringInfo.standardDeviationInterval, delete this.renderer.authoringInfo.standardDeviationInterval), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3), t.set(this._rendererSizeClassifyClassesTitle,
                        "display", ""), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", "none")) : (this._rendererSizeClassifyMethods.get("value") === this.i18n.classifyStandardDeviation ? (t.set(this._rendererSizeClassifyClassesTitle, "display", "none"), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", "")) : (t.set(this._rendererSizeClassifyClassesTitle, "display", ""), t.set(this._rendererSizeClassifyStdDevIntervalTitle, "display", "none")), this.updateClassifyInfo()))
                },
                _onChangeClassifyClasses: function(a) {
                    this.disableAllEvents ||
                        (this.waitingHandler && clearTimeout(this.waitingHandler), this.waitingHandler = setTimeout(g.hitch(this, function() {
                            clearTimeout(this.waitingHandler);
                            this.waitingHandler = null;
                            this.updateClassifyInfo()
                        }), 500))
                },
                _onChangeClassifyStdDevInterval: function() { this.disableAllEvents || this.updateClassifyInfo() },
                updateClassifyInfo: function() {
                    var a = this.disableAllEvents,
                        b = this.getRendererDataRange("sizeInfo");
                    this._rendererSizeClassifyCheck.get("checked") ? (m(".sizingTypes").forEach(function(a) { t.set(a, "display", "none") }),
                        m(".sizingTypes2").forEach(function(a) { w.remove(a, "esriLeadingMargin107") }), t.set(this._rendererSizeInvertTitle, "display", "none"), this.getParams().then(g.hitch(this, function(c) {
                            c.inverted && (this.invertSize(), delete c.inverted);
                            10 < c.numClasses && (c.numClasses = 4, this.disableAllEvents = !0, this._rendererSizeClassifyClasses.set("value", 4));
                            this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) || (c.minValue = b.min, c.maxValue = b.max);
                            this.buildSizeRenderer(c).then(g.hitch(this, function(b) {
                                var d =
                                    b.renderer;
                                b = b.statistics;
                                this.renderer = d;
                                c.statistics = b;
                                this.disableAllEvents = !0;
                                this._rendererSizeClassifyMethods.get("value") !== this.i18n.classifyStandardDeviation && D.isDefined(c.numClasses) && c.numClasses !== d.infos.length && this._rendererSizeClassifyClasses.set("value", d.infos.length);
                                this._rendererSizeMin.set("value", this.renderer.infos && this.renderer.infos.length ? this.getSymbolSize(this.renderer.infos[0].symbol) : 8);
                                this._rendererSizeMax.set("value", this.renderer.infos && this.renderer.infos.length ?
                                    this.getSymbolSize(this.renderer.infos[this.renderer.infos.length - 1].symbol) : 50);
                                this.enableSizeInput();
                                a || setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                                this.applySizeRenderer(this.renderer);
                                this.createClassedSizeInfoSlider(c).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }))
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        }))) : (this.hasDynamic && !this.newDMS ||
                        "esriGeometryPolygon" !== this.geometryType || (m(".sizingTypes").forEach(function(a) { t.set(a, "display", "") }), m(".sizingTypes2").forEach(function(a) { w.add(a, "esriLeadingMargin107") })), t.set(this._rendererSizeInvertTitle, "display", ""), this.getParams().then(g.hitch(this, function(a) {
                            this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) && (a.minValue = b.min, a.maxValue = b.max);
                            this.buildSizeRenderer(a).then(g.hitch(this, function(b) {
                                var c = b.renderer;
                                b = b.statistics;
                                this.renderer = c;
                                a.statistics =
                                    b;
                                b = this.getSymbolFromClassedSizeRenderer(this.renderer);
                                this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === b.type ? b : this.switchSizeKeepSymbol(b, 28), null, null, null, 1);
                                a.inverted && this.invertSize(a.inverted);
                                this.updateSizeUI();
                                this.applySizeRenderer(c);
                                w.remove(this._rendererSizeLegendClassesIcon, "active");
                                this._rendererSizeLegendClassesText.innerHTML = this.i18n.legend;
                                this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip));
                                t.set(this._rendererSizeSliderDiv,
                                    "display", "");
                                t.set(this._rendererSizeGridDiv, "display", "none");
                                w.remove(this._rendererSizeZoomIcon, "active");
                                this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn;
                                this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }))
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        })))
                },
                onUpdateInfo: function(a, b) {
                    "_default_" === a.minValue ? (this.renderer.defaultLabel = a.label,
                        this.renderer.defaultSymbol = a.symbol, this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, this.updateSizeRenderer(b)) : (b = this.renderer.infos, this.renderer.clearBreaks(), n.forEach(b, function(b, c) { a.minValue === b.minValue && a.maxValue === b.maxValue ? this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: a.symbol, label: a.label }) : this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: b.symbol, label: b.label }) }, this), this.updateSizeRenderer(null))
                },
                _onChangeSizePrecision: function() { if (!this.disableAllEvents) { var a = this._rendererSizePrecision.get("value"); "select" !== a && (this.updateValues(parseFloat(a)), this.applySizeRenderer(this.renderer), "block" === t.get(this._rendererSizeGridDiv, "display") && this.updateSizeRendererGrid(), this.updateSizeSlider(), this.onSizeSliderChange("precisionChange")) } },
                _onClickSwitch: function() {},
                _onClickSwitch2: function() {},
                _onChangeFieldSelect: function() {},
                _onChangeFixedDate: function() {},
                _onChangeFixedTime: function() {},
                _onChangeUnits: function() {},
                getParams: function() {
                    var a = new v,
                        b = {};
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererSizeDividedByAttribute.get("value"),
                        onItem: g.hitch(this, function(c) {
                            c && "total" === c.type[0] ? b.normalizationType = "percent-of-total" : c && "none" !== c.type[0] && (b.normalizationType = "field", b.normalizationField = c.name[0]);
                            if (this._rendererSizeClassifyCheck.get("checked")) {
                                b.numClasses = this._rendererSizeClassifyClasses.get("value");
                                switch (this._rendererSizeClassifyMethods.get("value")) {
                                    case this.i18n.classifyNaturalBreaks:
                                        b.classificationMethod =
                                            "natural-breaks";
                                        break;
                                    case this.i18n.classifyEqualInterval:
                                        b.classificationMethod = "equal-interval";
                                        break;
                                    case this.i18n.classifyStandardDeviation:
                                        b.classificationMethod = "standard-deviation";
                                        break;
                                    case this.i18n.classifyQuantile:
                                        b.classificationMethod = "quantile"
                                }
                                "standard-deviation" === b.classificationMethod && (b.standardDeviationInterval = this._rendererSizeClassifyStdDevInterval.get("value"))
                            }
                            b.showOthers = this._rendererSizeOtherCheck.get("checked");
                            b.classified = this._rendererSizeClassifyCheck.get("checked");
                            b.symbol = this.getSymbolFromClassedSizeRenderer(this.renderer);
                            b.rotationInfo = this.renderer.rotationInfo;
                            b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                            b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                            b.backgroundFillSymbol = this.renderer.backgroundFillSymbol;
                            b.optimizeForScale = this._rendererSizeAutomaticRadio.get("checked") ? "visible-scale-range" : !0;
                            b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                            if (c = this.getVisualVariableByType("sizeInfo",
                                    null, this.renderer.visualVariables)) b.inverted = "number" === typeof c.minSize ? c.maxSize < c.minSize : c.maxSize.stops[0].size < c.minSize.stops[0].size;
                            a.resolve(b)
                        })
                    });
                    return a
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererSizeStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererSizeTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererSizeFooter_links")).h + 10;
                        t.set(f.byId("rendererSizeFooterDiv"),
                            "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && t.set(f.byId("renderer-size-content"), "height", a + "px");
                        var g = 60;
                        n.forEach(m(".firstColumnLabel", this.domNode), function(a) { g = Math.max(g, c.coords(a).w) });
                        var h = 40;
                        m(".toolsLabel").forEach(function(a) { h = Math.max(h, c.coords(a).w) });
                        m(".toolsColumnTD").style("width", h + 4 + "px");
                        b = c.coords(f.byId("leftContentStackContainer")).w;
                        a = b - g - 40;
                        0 < a && (d = 0, "none" !== t.get(this._rendererSizeDividedByFieldDescription, "display") && (d = 30), t.set(this._rendererSizeDividedByAttribute.domNode,
                            "width", a - d + "px"));
                        t.set(this._rendererSizeGridDiv, "width", b - h - 42 + "px");
                        this.sizeRendererGrid && this.sizeRendererGrid.resize();
                        a = b - 35;
                        if (0 < a) {
                            b = 0;
                            if ("none" !== t.get(this._rendererSizeRotationEditExpression, "display") || "none" !== t.get(this._rendererSizeRotationFieldDescription, "display")) b = 30;
                            t.set(this._rendererSizeRotationAttribute.domNode, "width", a - b - 21 + "px");
                            m(".dijitSelectLabel", this._rendererSizeRotationAttribute.domNode).style("maxWidth", a - b - 51 + "px");
                            this.transparencySlider && t.set(this.transparencySlider.domNode,
                                "width", a - 30 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", a - 15 + "px");
                            b = c.coords(this._rendererSizePrecisionLabel).w;
                            t.set(this._rendererSizePrecision.domNode, "width", a - b - 38 + "px");
                            b = c.coords(this._rendererSizeClassifyMethodPart1).w;
                            d = c.coords(this._rendererSizeClassifyMethodPart2).w;
                            a = Math.max(a - b - (0 < d ? d + 5 : 0) - 28, 30);
                            t.set(this._rendererSizeClassifyMethods.domNode, "width", a + "px");
                            if (b = f.byId("widget_rendererSizeClassifyMethodDropdown_dropdown")) m(".dijitMenuItem", b).style("width",
                                a - 28 + "px"), t.set(b, "width", a + 2 + "px"), t.set(f.byId("rendererSizeClassifyMethodDropdown_popup"), "width", a + "px"), t.set(f.byId("rendererSizeClassifyMethodDropdown_popup"), "height", "100%")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Size", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_SizeMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom dojo/Deferred dojo/dom-construct dojo/dom-style esri/lang esri/symbols/jsonUtils esri/renderers/smartMapping esri/plugins/FeatureLayerStatistics esri/dijit/SizeInfoSlider esri/dijit/ClassedSizeSlider esri/renderers/SimpleRenderer esri/renderers/ClassBreaksRenderer esri/symbols/SimpleMarkerSymbol esri/layers/FeatureLayer arcgisonline/map/dijit/renderer/SizeGrid".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G) {
            return {
                buildSizeRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic && !this.newDMS) this.buildSizeRendererGo(null, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildSizeRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildSizeRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildSizeRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { b.reject() }) })
                        } else this.buildSizeRendererGo(null,
                            a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildSizeRendererGo(null, a, b);
                    return b
                },
                buildSizeRendererGo: function(b, c, d) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    var e, f = null;
                    this.renderer.visualVariables && "size" === this.getRendererType(this.renderer) && (e = this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }, { type: "sizeInfo", target: "outline" }],
                        this.renderer.visualVariables), f = this.renderer.authoringInfo && this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.authoringInfo.visualVariables));
                    var m = c.attributeItem || this.attributeItem;
                    if (c.classified || this.hasDynamic && !this.newDMS) {
                        var n, r;
                        c.classificationMethod || (n = c.minValue, r = c.maxValue);
                        p.createClassedSizeRenderer({
                            layer: this.fLayer || this.layer,
                            field: this.hasAttributeCustomExpression(m) ? null : m.name,
                            valueExpression: this.hasAttributeCustomExpression(m) ?
                                m.valueExpression : null,
                            valueExpressionTitle: m.valueExpressionTitle,
                            minValue: n,
                            maxValue: r,
                            basemap: this.getBasemapType(),
                            showOthers: !0,
                            numClasses: "standard-deviation" !== c.classificationMethod ? c.numClasses : void 0,
                            scheme: this.scheme,
                            classificationMethod: c.classificationMethod || "equal-interval",
                            standardDeviationInterval: c.standardDeviationInterval,
                            normalizationType: c.normalizationType,
                            normalizationField: c.normalizationField,
                            optimizeOutline: h.isDefined(c.optimizeOutline) ? c.optimizeOutline : !0,
                            optimizeForScale: !0
                        }).then(g.hitch(this,
                            function(a) {
                                if (!d.isRejected()) {
                                    this.scheme = a.scheme;
                                    b && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                                    this.authoringInfo = this.authoringInfo || {};
                                    var g = null;
                                    this.authoringInfo.visualVariables && (g = this.getVisualVariablesExceptTypes(["sizeInfo", "colorInfo"], this.authoringInfo.visualVariables) || []);
                                    this.authoringInfo = { type: "classedSize" };
                                    c.classificationMethod && (this.authoringInfo.classificationMethod = this.getClassificationMethodConstant(c.classificationMethod));
                                    "standard-deviation" === c.classificationMethod && (this.authoringInfo.standardDeviationInterval = c.standardDeviationInterval);
                                    g && g.length && (this.authoringInfo.visualVariables = g);
                                    e && (a.renderer.visualVariables ? a.renderer.setVisualVariables(a.renderer.visualVariables.concat(e)) : a.renderer.setVisualVariables(e), f && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(f) : f));
                                    a.renderer = this.updateRendererProperties(c, a.renderer);
                                    d.resolve({
                                        renderer: a.renderer,
                                        statistics: a.statistics
                                    })
                                }
                            }), g.hitch(this, function(a) { d.isRejected() || (this.handleError(a, "createClassedSizeRenderer", !0), d.reject()) }))
                    } else p.createSizeRenderer({
                        layer: this.fLayer || this.layer,
                        field: this.hasAttributeCustomExpression(m) ? null : m.name,
                        valueExpression: this.hasAttributeCustomExpression(m) ? m.valueExpression : null,
                        valueExpressionTitle: m.valueExpressionTitle,
                        basemap: this.getBasemapType(),
                        scheme: this.scheme,
                        normalizationType: c.normalizationType,
                        normalizationField: c.normalizationField,
                        optimizeForScale: c.optimizeForScale ||
                            "visible-scale-range",
                        optimizeOutline: h.isDefined(c.optimizeOutline) ? c.optimizeOutline : !0,
                        showOthers: !0
                    }).then(g.hitch(this, function(g) {
                        if (!d.isRejected()) {
                            g.statistics = this.checkStatistics(g.statistics, this.isTypeDate(m) ? !0 : !1);
                            this.scheme = g.scheme;
                            this.onCalculationsSource && g.statistics && this.onCalculationsSource(g.statistics);
                            b && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                            var n = {
                                type: "sizeInfo",
                                minSliderValue: h.isDefined(c.minValue) ?
                                    c.minValue : g.statistics.min,
                                maxSliderValue: h.isDefined(c.maxValue) ? c.maxValue : g.statistics.max
                            };
                            if (this.isMultiAttributesRenderer) {
                                this.authoringInfo = this.authoringInfo || {};
                                this.authoringInfo.visualVariables = this.authoringInfo.visualVariables || [];
                                this.replaceVisualVariable("sizeInfo", null, n, this.authoringInfo);
                                var n = this.getVisualVariableByType("sizeInfo", null, g.renderer.visualVariables) || null,
                                    p = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) || null;
                                n && p && n.field === p.field &&
                                    n.normalizationField === p.normalizationField && n.valueExpression === p.valueExpression && (n.minDataValue = p.minDataValue, n.maxDataValue = p.maxDataValue);
                                this.replaceVisualVariable("sizeInfo", null, n, g.renderer);
                                (n = this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.visualVariables)) && g.renderer.setVisualVariables(g.renderer.visualVariables.concat(n)); - 1 < a.indexOf(["color"], this.getRendererStyle(this.renderer)) && ("esri.symbol.SimpleMarkerSymbol" === this.renderer.infos[0].symbol.declaredClass ?
                                    (this.renderer.infos[0].symbol.setColor(g.renderer.infos[0].symbol.color), g.renderer.infos[0].symbol.outline && this.renderer.infos[0].symbol.outline.setColor(g.renderer.infos[0].symbol.outline.color)) : this.renderer.infos[0].symbol = g.renderer.infos[0].symbol);
                                this.renderer.backgroundFillSymbol || (this.renderer.backgroundFillSymbol = g.renderer.backgroundFillSymbol);
                                this.renderer.authoringInfo = this.authoringInfo;
                                this.renderer.setVisualVariables(g.renderer.visualVariables);
                                if (this.renderer.infos && this.renderer.infos.length &&
                                    "esri.renderer.ClassBreaksRenderer" === this.renderer.declaredClass) {
                                    if ((n = this.renderer.infos[0].symbol) && !n.size) {
                                        var p = this.renderer.infos[0],
                                            r = g.renderer.infos[0];
                                        n.size = r.symbol.size;
                                        this.renderer.clearBreaks();
                                        this.renderer.addBreak(p)
                                    }
                                    n && n.outline && !n.outline.width && (p = this.renderer.infos[0], r = g.renderer.infos[0], n.outline.width = r.symbol.outline.width, this.renderer.clearBreaks(), this.renderer.addBreak(p))
                                }
                                g.renderer = this.renderer
                            } else {
                                p = [];
                                this.authoringInfo = this.authoringInfo || {};
                                this.authoringInfo.visualVariables &&
                                    (p = this.getVisualVariablesExceptTypes(["sizeInfo", "colorInfo"], this.authoringInfo.visualVariables) || []);
                                p.push(n);
                                this.authoringInfo = {};
                                this.authoringInfo.visualVariables = p;
                                e && (g.renderer.visualVariables ? g.renderer.setVisualVariables(g.renderer.visualVariables.concat(e)) : g.renderer.setVisualVariables(e), f && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(f) : f));
                                if (n = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables)) p =
                                    this.getVisualVariableByType("sizeInfo", null, g.renderer.visualVariables), "number" === typeof n.minSize && "number" === typeof p.minSize && (p.minSize = n.minSize, p.maxSize = n.maxSize, this.replaceVisualVariable("sizeInfo", null, p, g.renderer));
                                n = this.getVisualVariableByType("sizeInfo", null, g.renderer.visualVariables) || null;
                                p = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) || null;
                                n && p && n.field === p.field && n.normalizationField === p.normalizationField && n.valueExpression === p.valueExpression &&
                                    (n.minDataValue = p.minDataValue, n.maxDataValue = p.maxDataValue, this.replaceVisualVariable("sizeInfo", null, n, g.renderer))
                            }
                            g.renderer = this.updateRendererProperties(c, g.renderer);
                            this.updateLegendProperty(g.renderer, "sizeInfo", this._rendererSizeLegendCheck && this._rendererSizeLegendCheck.get("checked"));
                            d.resolve({ renderer: g.renderer, statistics: g.statistics })
                        }
                    }), g.hitch(this, function(a) { d.isRejected() || (this.handleError(a, "createSizeRenderer", !0), d.reject()) }))
                },
                buildSizeInfo: function(a, b) {
                    b = new d;
                    var c =
                        a.attributeItem || this.attributeItem;
                    p.createSizeRenderer({ layer: this.fLayer || this.layer, field: this.hasAttributeCustomExpression(c) ? null : c.name, valueExpression: this.hasAttributeCustomExpression(c) ? c.valueExpression : null, valueExpressionTitle: c.valueExpressionTitle, basemap: this.getBasemapType(), scheme: a.scheme, normalizationType: a.normalizationType, normalizationField: a.normalizationField, statistics: a.statistics, optimizeForScale: a.optimizeForScale || "visible-scale-range" }).then(g.hitch(this, function(d) {
                        if (!b.isRejected()) {
                            d.statistics =
                                this.checkStatistics(d.statistics, this.isTypeDate(c) ? !0 : !1);
                            var e = { visualVariables: [{ type: "sizeInfo", minSliderValue: h.isDefined(a.minValue) ? a.minValue : d.statistics.min, maxSliderValue: h.isDefined(a.maxValue) ? a.maxValue : d.statistics.max }] };
                            this.updateLegendProperty(d.renderer, "sizeInfo", this._rendererSizeLegendCheck && this._rendererSizeLegendCheck.get("checked"));
                            b.resolve({
                                sizeInfo: this.getVisualVariableByType("sizeInfo", null, d.renderer.visualVariables),
                                backgroundFillSymbol: d.renderer.backgroundFillSymbol,
                                statistics: d.statistics,
                                authoringInfo: e,
                                scheme: d.scheme
                            })
                        }
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "createSizeInfo", !0), b.reject()) }));
                    return b
                },
                applySizeRenderer: function(a) {
                    a.authoringInfo && (a.authoringInfo.classificationMethod ? a.classificationMethod = a.authoringInfo.classificationMethod : delete a.classificationMethod);
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    this.updateSizeRendererGrid();
                    !this.hasDynamic && b !== this.getRendererStyle(a) &&
                        this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                updateSymbolOnSizeRenderer: function(b, c) {
                    b = b || {};
                    c = c || this.renderer;
                    if (!b.symbol) return c;
                    if (c.visualVariables && this.getVisualVariableByType("sizeInfo", null, c.visualVariables))
                        if (-1 < a.indexOf(["uniquesize", "uniqueAgeSize", "predominancesize", "relationshipSize"], this.getRendererStyle(c))) {
                            var d = [];
                            a.forEach(c.infos, function(a) { d.push(g.clone(a)) });
                            a.forEach(d, function(a) { c.removeValue(a.value) });
                            a.forEach(d, function(a) { c.addValue({ value: a.value, symbol: this.switchSymbolKeepColor(b.symbol, a.symbol), label: a.label }) }, this);
                            b.symbol = this.switchSymbolKeepColor(b.symbol,
                                d[0].symbol)
                        } else {
                            var e = c.infos[0];
                            c.clearBreaks();
                            c.addBreak(g.mixin(e, { symbol: b.symbol }))
                        }
                    else e = c.infos, c.clearBreaks(), a.forEach(e, function(a, d) { c.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: this.switchSymbolKeepSize(b.symbol, a.symbol), label: a.label }) }, this);
                    return c
                },
                updateSizeOnSizeRenderer: function(b, c) {
                    var d = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    if (d) d.minSize < d.maxSize ? (d.minSize = b, d.maxSize = c) : (d.minSize = c, d.maxSize = b), this.replaceVisualVariable("sizeInfo",
                        null, d, this.renderer), this.sizeSlider && this.sizeSlider.set("sizeInfo", g.clone(d));
                    else {
                        var d = this.renderer.infos.length,
                            e = (c - b) / (1 < d ? d - 1 : d);
                        c = this.renderer.infos;
                        this.renderer.clearBreaks();
                        a.forEach(c, function(a, c) { this.renderer.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: this.switchSizeKeepSymbol(a.symbol, b + e * c), label: a.label }) }, this);
                        this.sizeSlider && this.sizeSlider.set("breakInfos", g.clone(this.renderer.infos))
                    }
                },
                updateOutlineWidthOnSizeRenderer: function(a) {
                    "esriGeometryPolygon" ===
                    this.geometryType && (this.renderer.backgroundFillSymbol = this.setOutlineWidthOfSymbol(this.renderer.backgroundFillSymbol, a), this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol, a)), this.defaultInfo && this.defaultInfo.defaultSymbol && (this.defaultInfo.defaultSymbol = this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, a)))
                },
                updateSizeRenderer: function(a) {
                    h.isDefined(a) && "esriGeometryPolygon" === this.geometryType ? a ? (this.updateOutlineWidthOnSizeRenderer(1),
                        this.getSuggestedOutline().then(g.hitch(this, function(a) {
                            this.replaceVisualVariable("sizeInfo", "outline", a.widthInfo, this.renderer);
                            this.applySizeRenderer(this.renderer)
                        }), g.hitch(this, function(a) {
                            a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables);
                            this.renderer.setVisualVariables(a);
                            this.applySizeRenderer(this.renderer)
                        }))) : (a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), this.renderer.setVisualVariables(a),
                        this.applySizeRenderer(this.renderer)) : this.applySizeRenderer(this.renderer);
                    "esriGeometryPolygon" !== this.geometryType || this.isMultiAttributesRenderer || (this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ? this.drawTransparentSymbol(this._rendererSizePolygonSymbol) : (this.drawSymbol(this._rendererSizePolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererSizePolygonSymbol)));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ?
                        this.drawTransparentSymbol(this._rendererSizeOtherSymbol) : (this.drawSymbol(this._rendererSizeOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererSizeOtherSymbol));
                    this.updateSizeSlider()
                },
                updateRendererProperties: function(a, b) {
                    b = b || this.renderer;
                    a = a || {};
                    b = this.updateSymbolOnSizeRenderer(a, b);
                    a.showOthers ? (b.defaultSymbol = a.defaultSymbol, b.defaultLabel = a.defaultLabel) : a.showOthers || (delete b.defaultSymbol, delete b.defaultLabel);
                    a.rotationInfo && (b.setRotationInfo(a.rotationInfo), this.removeRotationInfoVisualVariable(b));
                    a.backgroundFillSymbol && (b.backgroundFillSymbol = a.backgroundFillSymbol);
                    return b
                },
                createSizeInfoSlider: function(a) {
                    var b = function(a, b) {
                            var c = this.getRendererDataRange("sizeInfo");
                            !a.statistics || 0 === a.statistics.count || e && ("esriFieldTypeInteger" === e.type || "esriFieldTypeSmallInteger" === e.type) && "percent-of-total" === a.normalizationType ? (this.sizeSlider = new v({
                                sizeInfo: this.getVisualVariableByType("sizeInfo",
                                    null, this.renderer.visualVariables),
                                statistics: a.statistics,
                                showHistogram: !1,
                                minValue: c.min,
                                maxValue: c.max,
                                showLabel: !0,
                                showTick: !0,
                                histogramWidth: 70,
                                isDate: e && this.isTypeDate(e) && -1 < dojo.indexOf(["size", "colorsize", "uniquesize", "ageColorSize"], this.getRendererStyle(this.renderer))
                            }, "rendererSizeSlider"), this.sizeSlider.startup(), this.enableSizeSliderChangeEvent(a), b.resolve()) : (e && (this.hasAttributeCustomExpression(e) ? a.valueExpression = e.valueExpression : a.field = e.name), this.getSizeInputBase(a, "histogram").then(g.hitch(this,
                                function(d) {
                                    d = g.mixin(d, { minValue: c.min, maxValue: c.max });
                                    this.getHistogram(d).then(g.hitch(this, function(d) {
                                        b.isRejected() || (this.onCalculationsSource(d), this.sizeSlider = new v({ sizeInfo: this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), statistics: a.statistics, histogram: d, minValue: c.min, maxValue: c.max, showLabel: !0, showTick: !0, histogramWidth: 70, isDate: e && this.isTypeDate(e) && -1 < dojo.indexOf(["size", "colorsize", "uniquesize", "ageColorSize"], this.getRendererStyle(this.renderer)) },
                                            "rendererSizeSlider"), this.sizeSlider.startup(), this.enableSizeSliderChangeEvent(a), b.resolve())
                                    }), g.hitch(this, function(d) {
                                        b.isRejected() || (this.sizeSlider = new v({ sizeInfo: this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables), statistics: a.statistics, showHistogram: !1, minValue: c.min, maxValue: c.max, showLabel: !0, showTick: !0, histogramWidth: 70, isDate: e && this.isTypeDate(e) && -1 < dojo.indexOf(["size", "colorsize", "uniquesize", "ageColorSize"], this.getRendererStyle(this.renderer)) }, "rendererSizeSlider"),
                                            this.sizeSlider.startup(), this.enableSizeSliderChangeEvent(a), b.resolve())
                                    }))
                                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getSizeInputBase", !1), b.reject()) })))
                        },
                        c = new d;
                    setTimeout(function() { c.progress(c) }, 1);
                    a = a || {};
                    var e = a.attributeItem || this.attributeItem;
                    this.destroySizeSlider();
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        c.isRejected() || (a.statistics ? (this.displayZeroFeaturesMsg(a.statistics.count), this.onCalculationsSource(a.statistics),
                            g.hitch(this, b, a, c)()) : (e && (this.hasAttributeCustomExpression(e) ? a.valueExpression = e.valueExpression : a.field = e.name), this.getSizeInputBase(a, "statistics").then(g.hitch(this, function(d) {
                            (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics(d).then(g.hitch(this, function(d) { c.isRejected() || (a.statistics = d, this.displayZeroFeaturesMsg(d.count), this.onCalculationsSource(d), g.hitch(this, b, a, c)()) }), g.hitch(this, function(d) {
                                c.isRejected() || (d && d.message && -1 < d.message.indexOf("valueExpression has unknown field names") ||
                                    this.handleError(d, "getFieldStatistics", !1), g.hitch(this, b, a, c)())
                            }))
                        }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "getSizeInputBase", !1), c.reject()) }))))
                    }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "addPlugin", !1), c.reject()) }));
                    return c
                },
                createClassedSizeInfoSlider: function(a) {
                    var b = a.attributeItem || this.attributeItem,
                        c = function(a, c) {
                            var d = this.getRendererDataRange("sizeInfo");
                            this.getHistogram({
                                field: this.hasAttributeCustomExpression(b) ? null : b.name,
                                valueExpression: this.hasAttributeCustomExpression(b) ?
                                    b.valueExpression : null,
                                minValue: d.min,
                                maxValue: d.max,
                                normalizationType: a.normalizationType,
                                normalizationField: a.normalizationField
                            }).then(g.hitch(this, function(b) {
                                c.isRejected() || (this.onCalculationsSource(b), this.sizeSlider = new w({ breakInfos: g.clone(this.renderer.infos), classificationMethod: a.classificationMethod, normalizationType: a.normalizationType, statistics: a.statistics, histogram: b, minValue: d.min, maxValue: d.max, showLabel: !0, showTick: !0, showHandles: 10 < this.renderer.infos.length ? !1 : !0, histogramWidth: 70 },
                                    "rendererSizeSlider"), this.sizeSlider.startup(), this.enableSizeSliderChangeEvent(a), this.precisionsStore = this.buildPrecisionsStore(this.renderer), this._rendererSizePrecision.setStore(this.precisionsStore, "", {}), c.resolve())
                            }), g.hitch(this, function(b) {
                                c.isRejected() || (this.sizeSlider = new w({
                                    breakInfos: g.clone(this.renderer.infos),
                                    classificationMethod: a.classificationMethod,
                                    normalizationType: a.normalizationType,
                                    statistics: a.statistics,
                                    histogram: null,
                                    minValue: d.min,
                                    maxValue: d.max,
                                    showLabel: !0,
                                    showTick: !0,
                                    showHandles: 10 < this.renderer.infos.length ? !1 : !0,
                                    histogramWidth: 70
                                }, "rendererSizeSlider"), this.sizeSlider.startup(), this.enableSizeSliderChangeEvent(a), this.precisionsStore = this.buildPrecisionsStore(this.renderer), this._rendererSizePrecision.setStore(this.precisionsStore, "", {}), c.resolve())
                            }))
                        },
                        e = new d;
                    setTimeout(function() { e.progress(e) }, 1);
                    a = a || {};
                    b = a.attributeItem || this.attributeItem;
                    this.destroySizeSlider();
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this,
                        function() {
                            e.isRejected() || (a.statistics ? (this.displayZeroFeaturesMsg(a.statistics.count), this.onCalculationsSource(a.statistics), g.hitch(this, c, a, e)()) : (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics({ field: this.hasAttributeCustomExpression(b) ? null : b.name, valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null, normalizationType: a.normalizationType, normalizationField: a.normalizationField }).then(g.hitch(this, function(b) {
                                e.isRejected() || (a.statistics = b, this.displayZeroFeaturesMsg(b.count),
                                    this.onCalculationsSource(b), g.hitch(this, c, a, e)())
                            }), g.hitch(this, function(b) { e.isRejected() || (this.handleError(b, "getFieldStatistics", !1), g.hitch(this, c, a, e)()) })))
                        }), g.hitch(this, function(a) { e.isRejected() || (this.handleError(a, "addPlugin", !1), e.reject()) }));
                    return e
                },
                updateSizeSlider: function(a, b) {
                    if (this.sizeSlider) {
                        a = a || this.renderer;
                        var c = this.getVisualVariableByType("sizeInfo", null, a.visualVariables);
                        c ? (this.clearZoom(), !b && this.renderer.authoringInfo && (a = this.getVisualVariableByType("sizeInfo",
                            null, this.renderer.authoringInfo.visualVariables)) && (this.sizeSlider.set("minValue", a.minSliderValue), this.sizeSlider.set("maxValue", a.maxSliderValue)), this.sizeSlider.set("sizeInfo", c), b && (this.sizeSlider.set("statistics", b), this.sizeSlider.set("minValue", b.min), this.sizeSlider.set("maxValue", b.max), this.sizeSlider.set("histogram", null), this.getParams().then(g.hitch(this, function(a) {
                            var d, e;
                            c.valueExpression ? d = c.valueExpression : this.hasAttributeCustomExpression(this.attributeItem) ? d = this.attributeItem.valueExpression :
                                e = this.attributeItem.name;
                            this.getHistogram(g.mixin(a, { field: e, valueExpression: d, minValue: b.min, maxValue: b.max })).then(g.hitch(this, function(a) { this.sizeSlider.set("histogram", a) }), g.hitch(this, function(a) {}))
                        })))) : (this.sizeSlider.set("breakInfos", g.clone(a.infos)), a = this.getRendererDataRange("sizeInfo"), h.isDefined(a.min) && h.isDefined(a.max) && (this.sizeSlider.set("minValue", a.min), this.sizeSlider.set("maxValue", a.max)))
                    }
                },
                enableSizeSliderChangeEvent: function(a) {
                    if (this.sizeSlider) {
                        a = a || {};
                        var b =
                            a.attributeItem || this.attributeItem;
                        this.sliderZoomedHandler = this.sizeSlider.on("zoomed", g.hitch(this, function(a) {!1 === a && this.clearZoom() }));
                        if (this.sizeSlider instanceof v) {
                            var c = "handle-value-change";
                            this.layer && this.layer.hasWebGLSurface && this.layer.hasWebGLSurface() && (c = "data-change");
                            this.sliderChangeHandler = this.sizeSlider.on(c, g.hitch(this, function(b) {
                                this.replaceVisualVariable("sizeInfo", null, b.sizeInfo ? b.sizeInfo : b, this.renderer);
                                this.applySizeRenderer(this.renderer, a);
                                this.onSizeSliderChange(a &&
                                    a.statistics && a.statistics.source)
                            }));
                            this.sliderChangeHandler2 = this.sizeSlider.on("data-value-change", g.hitch(this, function(c) {
                                var d;
                                this.authoringInfo ? d = this.getVisualVariableByType("sizeInfo", null, this.authoringInfo.visualVariables) : (d = { type: "sizeInfo" }, this.authoringInfo = { visualVariables: [] });
                                d.minSliderValue = c.minValue;
                                d.maxSliderValue = c.maxValue;
                                this.replaceVisualVariable("sizeInfo", null, d, this.authoringInfo);
                                this.applySizeRenderer(this.renderer, a);
                                this.onSizeSliderChange();
                                this.getParams().then(g.hitch(this,
                                    function(a) {
                                        b && (this.hasAttributeCustomExpression(b) ? a.valueExpression = b.valueExpression : a.field = b.name);
                                        this.getSizeInputBase(a, "histogram").then(g.hitch(this, function(b) {
                                            b = g.mixin(b, { minValue: c.minValue, maxValue: c.maxValue });
                                            this.getHistogram(b).then(g.hitch(this, function(b) {
                                                this.onCalculationsSource(b);
                                                this.disableSliderChangeEvent();
                                                this.sizeSlider.set("histogram", b);
                                                setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3)
                                            }), g.hitch(this, function(b) {
                                                this.handleError(b, "getHistogram", !1);
                                                this.disableSliderChangeEvent();
                                                this.sizeSlider.set("histogram", null);
                                                setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3)
                                            }))
                                        }), g.hitch(this, function(a) { deferred.isRejected() || (this.handleError(a, "getSizeInputBase", !1), deferred.reject()) }))
                                    }))
                            }))
                        } else this.sliderChangeHandler = this.sizeSlider.on("handle-value-change", g.hitch(this, function(b) { this.updateBreakInfos(b.breakInfos ? b.breakInfos : b, a) })), this.sliderChangeHandler2 = this.sizeSlider.on("data-value-change", g.hitch(this,
                            function(c) {
                                this.updateBreakInfos(c.breakInfos, a);
                                this.precisionsStore = this.buildPrecisionsStore(this.renderer);
                                this._rendererSizePrecision.setStore(this.precisionsStore, "", {});
                                this.getParams().then(g.hitch(this, function(a) {
                                    this.getHistogram({ field: this.hasAttributeCustomExpression(b) ? null : b.name, valueExpression: this.hasAttributeCustomExpression(b) ? b.valueExpression : null, minValue: c.minValue, maxValue: c.maxValue, normalizationType: a.normalizationType, normalizationField: a.normalizationField }).then(g.hitch(this,
                                        function(b) {
                                            this.onCalculationsSource(b);
                                            this.disableSliderChangeEvent();
                                            this.sizeSlider.set("histogram", b);
                                            setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3)
                                        }), g.hitch(this, function(b) {
                                        this.handleError(b, "getHistogram", !1);
                                        this.disableSliderChangeEvent();
                                        this.sizeSlider.set("histogram", null);
                                        setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3)
                                    }))
                                }))
                            }))
                    }
                },
                updateBreakInfos: function(b, c) {
                    this.renderer.clearBreaks();
                    a.forEach(b, function(a, b) {
                        this.renderer.addBreak({
                            minValue: a.minValue,
                            maxValue: a.maxValue,
                            symbol: a.symbol,
                            label: a.label
                        })
                    }, this);
                    this.applySizeRenderer(this.renderer, c);
                    this.onSizeSliderChange()
                },
                disableSliderChangeEvent: function() {
                    this.sliderZoomedHandler && this.sliderZoomedHandler.remove();
                    this.sliderZoomedHandler = null;
                    this.sliderChangeHandler && this.sliderChangeHandler.remove();
                    this.sliderChangeHandler = null;
                    this.sliderChangeHandler2 && this.sliderChangeHandler2.remove();
                    this.sliderChangeHandler2 = null
                },
                zoomInSlider: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) },
                        1);
                    a = a || {};
                    var c = a.attributeItem || this.attributeItem,
                        e = this.sizeSlider.get("statistics"),
                        f = this.sizeSlider.get("sizeInfo").minDataValue,
                        m = this.sizeSlider.get("sizeInfo").maxDataValue,
                        n = m - f,
                        p, r;
                    e.min === e.max ? (p = f - n / 3, r = m + n / 3, f = p, e = r) : (p = Math.max(f - n / 3, Math.min(e.min, this.sizeSlider.minValue)), r = Math.min(m + n / 3, Math.max(e.max, this.sizeSlider.maxValue)), f = h.isDefined(a.minValue) ? a.minValue : Math.min(e.min, this.sizeSlider.minValue), e = h.isDefined(a.maxValue) ? a.maxValue : Math.max(e.max, this.sizeSlider.maxValue));
                    p === f && r === e ? b.reject() : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        b.isRejected() || (c && (this.hasAttributeCustomExpression(c) ? a.valueExpression = c.valueExpression : a.field = c.name), this.getSizeInputBase(a, "histogram").then(g.hitch(this, function(c) {
                            c = g.mixin(c, { minValue: p, maxValue: r });
                            this.getHistogram(c).then(g.hitch(this, function(c) {
                                b.isRejected() || (this.onCalculationsSource(c), c = { histogram: c, minSliderValue: p, maxSliderValue: r }, this.disableSliderChangeEvent(),
                                    this.sizeSlider.set("zoomOptions", c), setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3), b.resolve())
                            }), g.hitch(this, function(c) { b.isRejected() || (c = { histogram: null, minSliderValue: p, maxSliderValue: r }, this.disableSliderChangeEvent(), this.sizeSlider.set("zoomOptions", c), setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent(a) }), 1E3), b.resolve()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getSizeInputBase", !1), b.reject()) })))
                    }), g.hitch(this,
                        function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                },
                zoomOutSlider: function() {
                    this.disableSliderChangeEvent();
                    this.sizeSlider && null !== this.sizeSlider.get("zoomOptions") && this.sizeSlider.set("zoomOptions", null);
                    setTimeout(g.hitch(this, function() { this.enableSizeSliderChangeEvent() }), 1E3)
                },
                getHistogram: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    this.histogramInfo && this.histogramInfo.field === a.field && this.histogramInfo.valueExpression === a.valueExpression &&
                        this.histogramInfo.normalizationType === a.normalizationType && this.histogramInfo.normalizationField === a.normalizationField && this.histogramInfo.minValue === a.minValue && this.histogramInfo.maxValue === a.maxValue ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram(g.mixin(a, { numBins: this.numHistogramBins, classificationMethod: "equal-interval" })).then(g.hitch(this,
                                function(c) { b.isRejected() || (this.histogramInfo = { histogram: c, field: a.field, valueExpression: a.valueExpression, normalizationType: a.normalizationType, normalizationField: a.normalizationField, minValue: a.minValue, maxValue: a.maxValue }, b.resolve(c)) }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram", !1), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                },
                destroySizeSlider: function() {
                    this.disableSliderChangeEvent();
                    this.sizeSlider && this.sizeSlider.destroy();
                    c.byId("rendererSizeSlider") || f.create("div", { id: "rendererSizeSlider" }, this._rendererSizeSliderDiv)
                },
                getSymbolFromClassedSizeRenderer: function(a) {
                    var b;
                    if (a.infos && a.infos.length) {
                        var c = 0;
                        for (b = a.infos[c++].symbol; this.isSymbolTransparent(b) && c < a.infos.length;) b = a.infos[c++].symbol;
                        b || (b = a.infos[0].symbol)
                    } else b = this.getDefaultSymbol("esriGeometryPolygon" === this.geometryType ? "esriGeometryPoint" : this.geometryType);
                    return b
                },
                updateSizeRendererGrid: function(a) {
                    "rendererSizeStack" !==
                    arcgisonline.map.leftPanel.getLeftContentPanelStack() || this._rendererSizeLegendClassesIcon && -1 === this._rendererSizeLegendClassesIcon.className.indexOf("active") || (a = a || this.renderer, "classedSize" === this.getRendererStyle(a) && (this.sizeRendererGrid ? this.sizeRendererGrid.updateGrid(a) : (G = this.portalPanel._SizeGrid, this.sizeRendererGrid = new G({ id: "rendererSizeGrid", renderer: a, style: "position: relative; width: 100%; height:100%; overflow-y:hidden; overflow-x:hidden; padding:0;", params: this.params }, "rendererSizeGrid")),
                        this.adjustHeight()))
                },
                destroySizeRendererGrid: function() { this.sizeRendererGrid && (this.sizeRendererGrid.destroy(), this.sizeRendererGrid = null, c.byId("rendererSizeGrid") || f.create("div", { id: "rendererSizeGrid" }, this._rendererSizeGridContainer)) },
                getSizeInputBase: function(b, c) {
                    var e = new d,
                        f = this.getRendererStyle(this.renderer);
                    if (-1 < a.indexOf(["predominance", "predominancesize"], f)) {
                        var h = "";
                        dojo.forEach(this.renderer.authoringInfo.fields, function(a) { h += a + "--" });
                        this.savedExpressions = this.savedExpressions || {};
                        this.savedExpressions[h] ? "statistics" === c ? e.resolve(this.savedExpressions[h].size.statisticsQuery) : e.resolve(this.savedExpressions[h].size.histogramQuery) : (this.fLayer || this.layer).statisticsPlugin.getPredominanceExpressions({ fields: this.renderer.authoringInfo.fields }).then(g.hitch(this, function(a) {
                            this.savedExpressions[h] = a;
                            "statistics" === c ? (a.size.statisticsQuery.valueExpression = a.size.valueExpression, e.resolve(a.size.statisticsQuery)) : (a.size.histogramQuery.valueExpression = a.size.valueExpression,
                                e.resolve(a.size.histogramQuery))
                        }), function(a) { e.reject(a) })
                    } else -1 < a.indexOf(["ageSize", "uniqueAgeSize", "colorAgeSize"], f) ? e.resolve(b) : e.resolve({ field: b.field, valueExpression: b.valueExpression, normalizationField: b.normalizationField, normalizationType: b.normalizationField ? "field" : null });
                    return e
                }
            }
        })
}, "esri/dijit/SizeInfoSlider": function() {
    define("../kernel ../numberUtils ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils ../Color dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojo/dom-construct dojo/dom-class dojox/gfx dojo/text!./SizeInfoSlider/templates/SizeInfoSlider.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            d = h([f, d, v], {
                declaredClass: "esri.dijit.SizeInfoSlider",
                baseClass: "esriSizeInfoSlider",
                templateString: E,
                values: null,
                minValue: null,
                maxValue: null,
                minSize: null,
                maxSize: null,
                histogram: null,
                statistics: !1,
                zoomOptions: null,
                showHistogram: !0,
                showStatistics: !0,
                showLabels: !0,
                showTicks: !0,
                showHandles: !0,
                histogramWidth: 100,
                rampWidth: 26,
                symbolWidth: 50,
                _rampNode: null,
                _sliderHeight: null,
                _barsGroup: null,
                _updateTimer: null,
                _forceMinValue: null,
                _forceMaxValue: null,
                _isRampFlipped: !1,
                constructor: function(a, b) { b && (void 0 !== a.minValue && this.set("_forceMinValue", a.minValue), void 0 !== a.maxValue && this.set("_forceMaxValue", a.maxValue), this._css = { handlerTickSize: "esri-handler-tick-size" }, this._updateTimeout = p(this._updateTimeout, 0), this._attachSymbols = p(this._attachSymbols, 0)) },
                postCreate: function() {
                    this.inherited(arguments);
                    this._setupDataDefaults()
                },
                startup: function() {
                    this.inherited(arguments);
                    this._slider = new n({
                        type: "SizeInfoSlider",
                        values: this.values,
                        isDate: this.isDate,
                        minimum: this.zoomOptions ?
                            this.zoomOptions.minSliderValue : this.minValue,
                        maximum: this.zoomOptions ? this.zoomOptions.maxSliderValue : this.maxValue,
                        _minZoomLabel: this.zoomOptions ? this.minValue : null,
                        _maxZoomLabel: this.zoomOptions ? this.maxValue : null,
                        _isZoomed: this.zoomOptions ? !0 : !1,
                        showLabels: this.showLabels,
                        showTicks: this.showTicks,
                        showHandles: this.showHandles
                    }, this._sliderNode);
                    this._slider.startup();
                    this._rampNode = this._slider._sliderAreaRight;
                    this._sliderHeight = r.get(this._rampNode, "height") || 155;
                    this._createSVGSurfaces();
                    this._slider.on("slide",
                        m.hitch(this, function(a) {
                            this.sizeInfo.minDataValue = a.values[0];
                            this.sizeInfo.maxDataValue = a.values[1];
                            this._set("values", a.values);
                            this._fillRamp(a.values);
                            this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, sizeInfo: m.clone(this.sizeInfo) })
                        }));
                    this._slider.on("handle-value-change", m.hitch(this, function(a) {
                        this.sizeInfo.minDataValue = a.values[0];
                        this.sizeInfo.maxDataValue = a.values[1];
                        this._set("values", a.values);
                        this._updateRendererSlider();
                        a = m.clone(this.sizeInfo);
                        this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, sizeInfo: a });
                        this.emit("handle-value-change", a)
                    }));
                    this._slider.on("data-value-change", m.hitch(this, function(a) {
                        this.set({ minValue: a.min, maxValue: a.max });
                        a = { minValue: this.minValue, maxValue: this.maxValue, sizeInfo: m.clone(this.sizeInfo) };
                        this.emit("data-change", a);
                        this.emit("data-value-change", a)
                    }));
                    this._slider.on("stop", m.hitch(this, function(a) { this.emit("handle-value-change", m.clone(this.sizeInfo)) }));
                    this._slider.on("zoom-out", m.hitch(this, function(a) {
                        this.set("zoomOptions",
                            null)
                    }));
                    this.statistics && this.showStatistics && this._generateStatistics();
                    this.showHistogram && (this.histogram || this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram();
                    this.watch("minValue", this._updateTimeout);
                    this.watch("maxValue", this._updateTimeout);
                    this.watch("symbol", this._updateTimeout);
                    this.watch("sizeInfo", this._updateTimeout);
                    this.watch("minSize", this._updateTimeout);
                    this.watch("maxSize", this._updateTimeout);
                    this.watch("statistics", this._updateTimeout);
                    this.watch("histogram",
                        this._updateTimeout);
                    this.watch("zoomOptions", this._updateTimeout);
                    this.watch("showHistogram", this._toggleHistogram);
                    this.watch("zoomOptions", this._zoomEventHandler)
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._slider && this._slider.destroy();
                    this._avgHandleObjs && this._avgHandleObjs.avgHandleTooltip && this._avgHandleObjs.avgHandleTooltip.destroy();
                    this.countTooltips && e.forEach(this.countTooltips, function(a) { a.destroy() })
                },
                _updateTimeout: function() { this._updateRendererSlider() },
                _updateRendererSlider: function() {
                    this.minSize =
                        this.sizeInfo.minSize;
                    this.maxSize = this.sizeInfo.maxSize;
                    this.values = [this.sizeInfo.minDataValue, this.sizeInfo.maxDataValue];
                    this._isRampFlipped = this.minSize > this.maxSize || this.minSize.stops && this.minSize.stops[0] && this.maxSize.stops && this.maxSize.stops[0] && this.maxSize.stops[0].size < this.minSize.stops[0].size;
                    null !== this.zoomOptions && !1 !== this.zoomOptions ? (this.toggleSliderBottom = this.zoomOptions.minSliderValue > this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue < this.maxValue, this._slider.set({
                        minimum: this.zoomOptions.minSliderValue,
                        maximum: this.zoomOptions.maxSliderValue,
                        _minZoomLabel: this.minValue,
                        _maxZoomLabel: this.maxValue,
                        _isZoomed: !0
                    })) : this._slider.set({ minimum: this.minValue, maximum: this.maxValue, _minZoomLabel: null, _maxZoomLabel: null, _isZoomed: !1 });
                    this._slider.set("values", this.values);
                    this._slider._reset();
                    this._slider._updateRoundedLabels();
                    this._slider._generateMoveables();
                    this._clearRect();
                    this._createSVGSurfaces();
                    this.statistics && this.showStatistics && this._generateStatistics();
                    this.showHistogram && (this.histogram ||
                        this.zoomOptions && this.zoomOptions.histogram) && this._generateHistogram()
                },
                _zoomEventHandler: function() { this.emit("zoomed", !!this.zoomOptions) },
                _setupDataDefaults: function() {
                    this.set({ minSize: this.sizeInfo.minSize, maxSize: this.sizeInfo.maxSize });
                    this._isRampFlipped = this.minSize > this.maxSize || this.minSize.stops && this.minSize.stops[0] && this.maxSize.stops && this.maxSize.stops[0] && this.maxSize.stops[0].size < this.minSize.stops[0].size;
                    this.statistics ? this.set({ minValue: this.statistics.min, maxValue: this.statistics.max }) :
                        this.set({ minValue: 0, maxValue: 100 });
                    null !== this._forceMinValue && this.set("minValue", this._forceMinValue);
                    null !== this._forceMaxValue && this.set("maxValue", this._forceMaxValue);
                    null !== this.zoomOptions && !1 !== this.zoomOptions && (this.toggleSliderBottom = this.zoomOptions.minSliderValue > this.minValue, this.toggleSliderTop = this.zoomOptions.maxSliderValue < this.maxValue);
                    null === this.sizeInfo.minDataValue && null === this.sizeInfo.maxDataValue || 0 === this.sizeInfo.minDataValue && 0 === this.sizeInfo.maxDataValue ? null ===
                        this.minValue && null === this.maxValue && this.set({ minValue: 0, maxValue: 100, values: [20, 80] }) : this.minValue === this.maxValue ? 0 === this.minValue ? this.set({ maxValue: 100, values: [20, 80] }) : null === this.minValue ? this.set({ minValue: 0, maxValue: 100, values: [20, 80] }) : this.set({ minValue: 0, maxValue: 2 * this.minValue, values: [this.maxValue / 5, this.maxValue / 5 * 4] }) : this.set("values", [this.sizeInfo.minDataValue, this.sizeInfo.maxDataValue]);
                    null === this.minValue && this.set("minValue", 0);
                    null === this.maxValue && this.set("maxValue",
                        100)
                },
                _createSVGSurfaces: function() {
                    this._proportionalSymbolSurface = B.createSurface(this._rampNode, this.rampWidth, this._sliderHeight);
                    this._surfaceRect = this._proportionalSymbolSurface.createRect({ width: this.rampWidth, height: this._sliderHeight });
                    this._histogramSurface = a.generateHistogramSurface(this._rampNode, this.histogramWidth, this._sliderHeight, this.rampWidth);
                    this._fillRamp();
                    this._attachSymbols()
                },
                _attachSymbols: function() {
                    var a = this._isRampFlipped ? this.minSize : this.maxSize;
                    this._attachSymbol(this._slider.moveables[0],
                        this._isRampFlipped ? this.maxSize : this.minSize);
                    this._attachSymbol(this._slider.moveables[1], a)
                },
                _attachSymbol: function(a, b) {
                    a._symbol || (a._symbol = t.create("div", { style: "position: absolute; left: 10px;" }, a));
                    var c = r.get(a._handleContainer, "height"),
                        d = a._symbol,
                        e = this.symbol;
                    e && "simplelinesymbol" == e.type ? (b = b === this.minSize ? 5 : 13, this._generateLineSymbol(a, b, c)) : (b = b === this.minSize ? 12 : 48, this._generateCircleSymbol(d, b, c));
                    return d
                },
                _generateLineSymbol: function(a, b, d) {
                    var e = a._symbol;
                    x.add(a._tick, this._css.handlerTickSize);
                    r.set(e, "top", d / 2 - b + "px");
                    r.set(e, "height", 2 * b + "px");
                    r.set(e, "width", b - 4 + "px");
                    e.innerHTML = "";
                    a = B.createSurface(e);
                    a.rawNode.style.position = "absolute";
                    a.rawNode.style.top = 1 === b ? "1px" : b / 2 + "px";
                    this.isLeftToRight() || (a.rawNode.style.left = "-45px");
                    a.setDimensions(this.rampWidth, b);
                    a.createRect({ width: this.rampWidth, height: b }).setFill(new c([0, 121, 193, .8]));
                    return a
                },
                _generateCircleSymbol: function(a, b, d) {
                    var e = b / 2;
                    b = 12 === b ? !0 : !1;
                    r.set(a, "top", d / 2 - (e + 1) + "px");
                    r.set(a, "height", 2 * (e + 1) + "px");
                    r.set(a, "width",
                        b ? 2 * (e + 1) : e + "px");
                    r.set(a, "left", b ? "8px" : "10px");
                    a.innerHTML = "";
                    a = B.createSurface(a);
                    a.rawNode.style.position = "absolute";
                    this.isLeftToRight() || (a.rawNode.style.left = "-45px");
                    b ? (a.setDimensions(2 * (e + 1), 2 * (e + 1)), a.createCircle({ cx: 7, cy: e + 1, r: e }).setFill(new c([0, 121, 193, .8])).setStroke("#fff")) : (a.setDimensions(e + 1, 2 * (e + 1)), a.createCircle({ cx: 0, cy: e + 1, r: e }).setFill(new c([0, 121, 193, .8])).setStroke("#fff"));
                    return a
                },
                _fillRamp: function(a) {
                    var b = this._slider,
                        c = this._sliderHeight,
                        d = Math.round(c - ((a ? a[0] :
                            b.values[0]) - b.minimum) / (b.maximum - b.minimum) * c);
                    a = Math.round(c - ((a ? a[1] : b.values[1]) - b.minimum) / (b.maximum - b.minimum) * c);
                    var b = this.rampWidth,
                        e = { color: "#fff", width: 3 };
                    this._proportionalSymbolSurface.clear();
                    this._isRampFlipped ? this._proportionalSymbolSurface.createPath().moveTo(10, 0).lineTo(10, a).lineTo(b, d).lineTo(b, c).lineTo(0, c).lineTo(0, 0).closePath().setFill("#9a9a9a") : this._proportionalSymbolSurface.createPath().moveTo(b, 0).lineTo(b, a).lineTo(10, d).lineTo(10, c).lineTo(0, c).lineTo(0, 0).closePath().setFill("#9a9a9a");
                    r.set(this._proportionalSymbolSurface.rawNode, "overflow", "visible");
                    r.set(this._proportionalSymbolSurface.rawNode, "background-color", "#d9d9d9");
                    null !== this.zoomOptions && !1 !== this.zoomOptions && (this.toggleSliderBottom && this.toggleSliderTop ? (this._proportionalSymbolSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke(e).setTransform(B.matrix.translate(0, 5)), this._proportionalSymbolSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke(e).setTransform(B.matrix.translate(0,
                        195))) : this.toggleSliderBottom ? this._proportionalSymbolSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke(e).setTransform(B.matrix.translate(0, 195)) : this.toggleSliderTop && this._proportionalSymbolSurface.createPath("M0,1 L6.25,-1 L12.5,1 L18.75,-1 L25,1").setStroke(e).setTransform(B.matrix.translate(0, 5)))
                },
                _clearRect: function() {
                    this._proportionalSymbolSurface.destroy();
                    this._histogramSurface.destroy()
                },
                _showHistogram: function() {
                    this.histogram || this.zoomOptions && this.zoomOptions.histogram ?
                        this._generateHistogram() : this._barsGroup && (this._barsGroup.destroy(), this._barsGroup = null)
                },
                _toggleHistogram: function() { this.showHistogram ? (r.set(this._barsGroup.rawNode, "display", "inline-block"), this._showHistogram()) : r.set(this._barsGroup.rawNode, "display", "none") },
                _generateHistogram: function() {
                    var b = this.zoomOptions && this.zoomOptions.histogram ? this.zoomOptions.histogram : this.histogram;
                    this._barsGroup = a.generateHistogram(this._histogramSurface, b, this.histogramWidth, this.rampWidth, this.isLeftToRight());
                    this.countTooltips = a.generateCountTooltips(b, this._barsGroup)
                },
                _generateStatistics: function() {
                    if (!(2 > this.statistics.count || isNaN(this.statistics.avg))) {
                        var b, c = this.statistics;
                        b = this._slider;
                        var d = this.zoomOptions || null,
                            e = a.getPrecision(this.maxValue),
                            f, h;
                        c.min === c.max && c.min === c.avg ? (f = 0, h = 2 * c.avg) : (f = c.min, h = c.max);
                        if (f !== b.minimum || h !== b.maximum) f = b.minimum, h = b.maximum;
                        d && (f = d.minSliderValue, h = d.maxSliderValue);
                        b = this._sliderHeight * (h - c.avg) / (h - f);
                        c = g.round([c.avg, h, f])[0];
                        this._avgHandleObjs =
                            a.generateAvgLine(this._histogramSurface, c, b, e, this.isLeftToRight(), this.isDate)
                    }
                }
            });
            m.setObject("dijit.SizeInfoSlider", d, b);
            return d
        })
}, "esri/dijit/ClassedSizeSlider": function() {
    define("../kernel ../numberUtils ../renderers/utils ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils ../Color dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojox/gfx dojo/text!./ClassedSizeSlider/templates/ClassedSizeSlider.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B) {
            f = m([e, f, w], {
                declaredClass: "esri.dijit.ClassedSizeSlider",
                baseClass: "esriClassedSizeSlider",
                templateString: B,
                breakInfos: null,
                histogram: null,
                handles: [],
                showHistogram: !0,
                showStatistics: !0,
                showLabels: !0,
                showTicks: !0,
                showHandles: !0,
                classificationMethod: null,
                normalizationType: null,
                histogramWidth: 100,
                rampWidth: 26,
                _rampNode: null,
                _sliderHeight: null,
                _colorRampSurface: null,
                _histogramSurface: null,
                _surfaceRect: null,
                _barsGroup: null,
                _updateTimer: null,
                constructor: function(a,
                    b) { b && (this.breakInfos = p.clone(a.breakInfos), this.set("values", this._getHandleInfo(this.breakInfos)), this._updateTimeout = r(this._updateTimeout, 0)) },
                postCreate: function() {
                    this.inherited(arguments);
                    this._setupDataDefaults()
                },
                startup: function() {
                    this.inherited(arguments);
                    this._slider = new a({
                        type: "ClassedSizeSlider",
                        values: this.values,
                        minimum: this.minValue,
                        maximum: this.maxValue,
                        showLabels: this.showLabels,
                        showTicks: this.showTicks,
                        showHandles: this.showHandles,
                        classificationMethod: this.classificationMethod,
                        normalizationType: this.normalizationType
                    }, this._sliderNode);
                    this._slider.startup();
                    this._rampNode = this._slider._sliderAreaRight;
                    this._sliderHeight = v.get(this._rampNode, "height") || 155;
                    this._createSVGSurfaces();
                    this._slider.on("slide", p.hitch(this, function(a) {
                        this.classificationMethod = null;
                        this._updateBreakInfos(a.values);
                        this._updateBreakInfoLabels();
                        this._fillRamp();
                        this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, breakInfos: p.clone(this.breakInfos) })
                    }));
                    this._slider.on("handle-value-change",
                        p.hitch(this, function(a) {
                            this.classificationMethod = null;
                            this._updateBreakInfos(a.values);
                            this._updateBreakInfoLabels();
                            this._fillRamp();
                            a = p.clone(this.breakInfos);
                            this.emit("data-change", { minValue: this.minValue, maxValue: this.maxValue, breakInfos: a });
                            this.emit("handle-value-change", a)
                        }));
                    this._slider.on("data-value-change", p.hitch(this, function(a) {
                        this.classificationMethod = null;
                        this.breakInfos[0].minValue = a.min;
                        this.breakInfos[this.breakInfos.length - 1].maxValue = a.max;
                        this.set({ minValue: a.min, maxValue: a.max });
                        this._updateBreakInfoLabels();
                        this._updateRendererSlider();
                        a = { minValue: this.minValue, maxValue: this.maxValue, breakInfos: p.clone(this.breakInfos) };
                        this.emit("data-change", a);
                        this.emit("data-value-change", a)
                    }));
                    this._slider.on("stop", p.hitch(this, function(a) { this.emit("handle-value-change", p.clone(this.breakInfos)) }));
                    this.histogram && this.showHistogram && this._generateHistogram();
                    this.statistics && this.showStatistics && this._generateStatistics();
                    this.watch("breakInfos", this._updateTimeout);
                    this.watch("handles",
                        this._updateTimeout);
                    this.watch("statistics", this._updateTimeout);
                    this.watch("showHandles", this._updateTimeout);
                    this.watch("showLabels", this._updateTimeout);
                    this.watch("showTicks", this._updateTimeout);
                    this.watch("histogram", this._showHistogram);
                    this.watch("showHistogram", this._toggleHistogram)
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._slider && this._slider.destroy();
                    this._avgHandleObjs && this._avgHandleObjs.avgHandleTooltip && this._avgHandleObjs.avgHandleTooltip.destroy();
                    this.countTooltips &&
                        h.forEach(this.countTooltips, function(a) { a.destroy() })
                },
                _updateTimeout: function() { this._updateRendererSlider() },
                _updateRendererSlider: function() {
                    this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[this.breakInfos.length - 1].maxValue });
                    this._slider.set({ minimum: this.minValue, maximum: this.maxValue, values: this._getHandleInfo(this.breakInfos), handles: this.handles });
                    this._slider._reset();
                    this._slider._updateRoundedLabels();
                    this._slider._generateMoveables();
                    this._clearRect();
                    this._createSVGSurfaces();
                    this.histogram && this.showHistogram && this._generateHistogram();
                    this.statistics && this.showStatistics && this._generateStatistics()
                },
                _getHandleInfo: function(a) {
                    var b = [],
                        c;
                    for (c = 0; c < a.length - 1; c++) b.push(a[c].maxValue);
                    return b
                },
                _updateBreakInfos: function(a) {
                    var b = this.breakInfos,
                        c;
                    n.updateClassBreak({ classBreaks: b, normalizationType: this.normalizationType, classificationMethod: this.classificationMethod, change: a });
                    for (c = 0; c < a.length; c++) b[c].maxValue = a[c], b[c + 1] && (b[c + 1].minValue = a[c])
                },
                _updateBreakInfoLabels: function() {
                    n.setLabelsForClassBreaks({
                        classBreaks: this.breakInfos,
                        normalizationType: this.normalizationType,
                        classificationMethod: this.classificationMethod,
                        round: !0
                    })
                },
                _setupDataDefaults: function() {
                    null !== this.breakInfos && 1 < this.breakInfos.length ? this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[this.breakInfos.length - 1].maxValue }) : null !== this.breakInfos && 1 === this.breakInfos.length ? this.set({ minValue: this.breakInfos[0].minValue, maxValue: this.breakInfos[0].maxValue }) : (this.set({
                        minValue: 0,
                        maxValue: 100,
                        breakInfos: [{ minValue: 0, maxValue: 20 }, {
                            minValue: 20,
                            maxValue: 80
                        }, { minValue: 80, maxValue: 100 }]
                    }), this.set("values", this._getHandleInfo(this.breakInfos)), this._updateBreakInfoLabels())
                },
                _createSVGSurfaces: function() {
                    this._colorRampSurface = x.createSurface(this._rampNode, this.rampWidth, this._sliderHeight);
                    this._surfaceRect = this._colorRampSurface.createRect({ width: this.rampWidth, height: this._sliderHeight });
                    this._histogramSurface = c.generateHistogramSurface(this._rampNode, this.histogramWidth, this._sliderHeight, this.rampWidth);
                    this._fillRamp()
                },
                _clearRect: function() {
                    this._colorRampSurface.destroy();
                    this._histogramSurface.destroy()
                },
                _fillRamp: function() {
                    var a = this.breakInfos,
                        b = this._slider,
                        c = this._sliderHeight,
                        e = [],
                        f, g, m, e = h.map(a, function(a) { return [c - Math.round((a.minValue - b.minimum) / (b.maximum - b.minimum) * c), c - Math.round((a.maxValue - b.minimum) / (b.maximum - b.minimum) * c)] });
                    e.reverse();
                    this._colorRampSurface.clear();
                    f = this.rampWidth / a.length;
                    g = this.rampWidth;
                    m = this._colorRampSurface.createPath().moveTo(g, 0);
                    h.forEach(e, p.hitch(this, function(a, b) {
                        m.lineTo(g, a[0]);
                        g = this.rampWidth - f * (b + 1);
                        m.lineTo(g,
                            a[0])
                    }));
                    m.lineTo(1, c).lineTo(0, c).lineTo(0, 0).closePath().setFill(new d([0, 121, 193, .8]))
                },
                _showHistogram: function() { this.histogram ? this._generateHistogram() : this._barsGroup && (this._barsGroup.destroy(), this._barsGroup = null) },
                _toggleHistogram: function() { this.showHistogram ? (v.set(this._barsGroup.rawNode, "display", "inline-block"), this._showHistogram()) : v.set(this._barsGroup.rawNode, "display", "none") },
                _generateHistogram: function() {
                    this._barsGroup = c.generateHistogram(this._histogramSurface, this.histogram,
                        this.histogramWidth, this.rampWidth, this.isLeftToRight());
                    this.countTooltips = c.generateCountTooltips(this.histogram, this._barsGroup)
                },
                _generateStatistics: function() {
                    if (!(2 > this.statistics.count || isNaN(this.statistics.avg))) {
                        var a = this.statistics,
                            b = this._slider,
                            d = c.getPrecision(this.maxValue),
                            e, f;
                        a.min === a.max && a.min === a.avg ? (e = 0, f = 2 * a.avg) : (e = a.min, f = a.max);
                        if (e !== b.minimum || f !== b.maximum) e = b.minimum, f = b.maximum;
                        b = this._sliderHeight * (f - a.avg) / (f - e);
                        a = g.round([a.avg, f, e])[0];
                        this._avgHandleObjs = c.generateAvgLine(this._histogramSurface,
                            a, b, d, this.isLeftToRight())
                    }
                }
            });
            p.setObject("dijit.ClassedSizeSlider", f, b);
            return f
        })
}, "arcgisonline/map/dijit/renderer/SizeGrid": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/on dojo/dom dojo/query dojo/mouse dojo/has dojo/topic dojo/string dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/form/Button dijit/form/CheckBox dijit/Tooltip esri/symbols/jsonUtils esri/styles/size esri/lang dgrid/OnDemandGrid dgrid/Selection dgrid/editor dojo/store/Memory dojo/store/Observable arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_LabelsMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/registry".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U) {
            c = b([W], {
                declaredClass: "arcgisonline.map.dijit.renderer.SizeGrid",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGOSizeGrid",
                i18n: null,
                id: "",
                grid: null,
                lastDefaultLabel: null,
                lastDefaultSymbol: null,
                ordersList: null,
                didDragFromSource: !1,
                ungroupButton: null,
                symbolButton: null,
                otherCheckBox: null,
                scrollPos: 0,
                batchCount: 205,
                tooltips: [],
                constructor: function(a, b) {
                    g.mixin(this, O);
                    g.mixin(this, P);
                    g.mixin(this,
                        R);
                    null != a && (a.id && (this.id = a.id), a.renderer && (this.renderer = a.renderer), a.style && (this.style = a.style), a.onSymbolClick && (this.onSymbolClick = a.onSymbolClick), a.onLabelClick && (this.onLabelClick = a.onLabelClick), a.params && g.mixin(this, a.params))
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(S.common);
                    g.mixin(this.i18n, S.rendererSizePanel)
                },
                postCreate: function() { this.createGrid() },
                destroy: function() {
                    this.onRendererItemChangeHandler && p.unsubscribe(this.onRendererItemChangeHandler);
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    this.grid && (delete this.store, this.grid.destroy(), delete this.grid);
                    this.inherited(arguments)
                },
                resize: function() {
                    e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px");
                    this.grid.resize()
                },
                hide: function() {},
                updateGrid: function(a) {
                    this.renderer = a;
                    this.getData();
                    this.store = K(new M({
                        data: this.data,
                        idProperty: "id",
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "id" }];
                            return M.prototype.query.call(this, a, b)
                        }
                    }));
                    this.scrollPos = this.grid.bodyNode.scrollTop;
                    this.grid.set("store", this.store)
                },
                createGrid: function() {
                    this.grid ? (n.forEach(this.tooltips, function(a) { a.destroy() }), this.scrollPos = this.grid.bodyNode.scrollTop, delete this.store, this.grid.destroy(), delete this.grid) : this.scrollPos = 0;
                    f.byId("_sizeRendererGrid") || t.create("div", { id: "_sizeRendererGrid" }, this.domNode);
                    this.getColumns();
                    this.maxSymbolWidth = 30;
                    this.getData();
                    this.store = K(new M({
                        data: this.data,
                        idProperty: "id",
                        query: function(a, b) {
                            b = b || {};
                            b.sort = [{ attribute: "id" }];
                            return M.prototype.query.call(this,
                                a, b)
                        }
                    }));
                    this.grid = new(b([H]))({ store: this.store, selectionMode: "single", columns: this.columns, className: "dgrid-autoheight", style: this.style ? this.style : "width: 200px;", sort: [{ attribute: "id" }], minRowsPerPage: this.batchCount, maxRowsPerPage: this.batchCount, showHeader: !1 }, "_sizeRendererGrid");
                    this.grid.on("dgrid-editor-hide", g.hitch(this, function(a) { this.handleLabelChange(a.cell.row.data, a.editor.value) }));
                    this.grid.on("dgrid-error", g.hitch(this, function(a) {}));
                    this.grid.on("dgrid-refresh-complete", g.hitch(this,
                        function(a) {
                            this.grid.scrollTo({ y: this.scrollPos });
                            e(".symbolCell").style("width", this.maxSymbolWidth + 10 + "px")
                        }));
                    this.resize()
                },
                getColumns: function() {
                    this.columns = {};
                    this.columns.symbol = {
                        className: "symbolCell",
                        field: "symbol",
                        label: "",
                        sortable: !1,
                        renderCell: g.hitch(this, function(a, b, c, e) {
                            if (b) {
                                var f = t.create("div", { style: "width:" + a.symbolSize.width + "px;height:" + a.symbolSize.height + "px;margin: auto;", "class": "symbol" });
                                d(c, "click", g.hitch(this, function(a) { this.onRowClickSymbolHandler(a) }, a));
                                this.tooltips.push(new G({
                                    connectId: [f],
                                    label: "\x3cdiv class\x3d'rendererTooltip'\x3e" + this.i18n.oneSymbolTooltip + "\x3c/div\x3e"
                                }));
                                9 > m("ie") ? setTimeout(g.hitch(this, function(a, b, c) {
                                    this.drawSymbol(a, b, c.symbolSize.width, c.symbolSize.height, null, 1);
                                    this.updateBackgroundForAlmostWhite(b, a)
                                }, f, b, a), 100) : (this.drawSymbol(f, b, a.symbolSize.width, a.symbolSize.height, null, 1), this.updateBackgroundForAlmostWhite(b, f))
                            }
                            return f
                        })
                    };
                    this.columns.label = L({
                        className: "labelCell",
                        field: "label",
                        name: this.i18n.labelTitle,
                        label: this.i18n.labelTitle,
                        sortable: !1,
                        canEdit: function(a) { return !0 },
                        renderCell: g.hitch(this, function(a, b, c, d) { return t.create("span", { innerHTML: x.encode(a.label), "class": "info" }) })
                    }, "text", "click")
                },
                getData: function() {
                    this.data = n.map(this.renderer.infos, function(a, b) {
                        var c = this._calcSymbolWidthHeight(a.symbol);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, c.width);
                        return { symbol: a.symbol, symbolSize: c, label: a.label, minValue: a.minValue, maxValue: a.maxValue, id: this.renderer.infos.length - b }
                    }, this);
                    if (this.renderer.defaultSymbol) {
                        var a = this._calcSymbolWidthHeight(this.renderer.defaultSymbol);
                        this.maxSymbolWidth = Math.max(this.maxSymbolWidth, a.width);
                        this.data.push({ symbol: this.renderer.defaultSymbol, symbolSize: a, label: this.renderer.defaultLabel || this.i18n.other, minValue: "_default_", maxValue: "_default_", id: this.renderer.infos.length + 1 })
                    }
                },
                handleLabelChange: function(b, c) {
                    c.length ? b.label = c : "_default_" === b.minValue ? b.label = this.i18n.other : n.forEach(this.data, function(a, c) { b.id == a.id && (b.label = this.getLabel(b, 0, c)) }, this);
                    n.forEach(this.data, function(a) { b.id == a.id && (a.label = b.label) }, this);
                    a.publish("onUpdateSize", [{ symbol: b.symbol, minValue: b.minValue, maxValue: b.maxValue, label: b.label }])
                },
                onRowClickSymbolHandler: function(a, b) {
                    b = D.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    "_default_" === a.minValue ? this.showSymbolStyler(a.symbol, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: b }, g.hitch(this, "onSymbolChange", a)) : this.showSymbolStyler(a.symbol, { externalSizing: !1, schemes: b }, g.hitch(this, "onSymbolChange",
                        a))
                },
                onSymbolChange: function(b, c, d, e, f) {
                    d = this._calcSymbolWidthHeight(c);
                    var h = { symbol: c, symbolSize: d, label: b.label };
                    n.forEach(this.data, function(a) { b.id == a.id && (a = g.mixin(a, h), this.store.put(a)) }, this);
                    this.maxSymbolWidth = this._calcTotalSymbolWidthHeight().width;
                    a.publish("onUpdateSize", [{ symbol: c, minValue: b.minValue, maxValue: b.maxValue, label: b.label }, f])
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.SizeGrid", c);
            return c
        })
}, "arcgisonline/map/dijit/renderer/_PredominanceMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/Deferred dojo/dom dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/basic esri/styles/type esri/renderers/smartMapping esri/tasks/query esri/tasks/QueryTask esri/tasks/UniqueValueDefinition esri/tasks/GenerateRendererParameters esri/tasks/GenerateRendererTask esri/tasks/StatisticDefinition esri/renderers/SimpleRenderer esri/renderers/UniqueValueRenderer esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/dijit/OpacitySlider".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J) {
            return {
                predominantCategoryInfos: null,
                maxCount: 200,
                defaultColors: "#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" "),
                buildPredominanceRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildPredominanceRendererGo(!1, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c =
                                this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildPredominanceRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildPredominanceRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({
                                title: this.i18n.warning,
                                message: this.i18n.featureTypesAndTemplatesWarning,
                                choiceOneTitle: this.i18n.yesLabel,
                                choiceOneHandler: g.hitch(this, function() { this.buildPredominanceRendererGo(!0, a, b) }),
                                choiceTwoTitle: this.i18n.noLabel,
                                choiceTwoHandler: g.hitch(this, function() { b.reject() })
                            })
                        } else this.buildPredominanceRendererGo(null, a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildPredominanceRendererGo(null, a, b);
                    return b
                },
                buildPredominanceRendererGo: function(a, b, c) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    var d = this.getPredominanceFieldList(b);
                    v.createPredominanceRenderer({ layer: this.fLayer || this.layer, fields: d, theme: "default", basemap: this.getBasemapType(), scheme: this.scheme, showOthers: !0, optimizeForScale: h.isDefined(b.optimizeForScale) ? b.optimizeForScale : "visible-scale-range", optimizeOutline: h.isDefined(b.optimizeOutline) ? b.optimizeOutline : !0, includeOpacityInfo: !0, includeSizeInfo: b && b.includeSizeInfo ? !0 : !1 }).then(g.hitch(this, function(e) {
                        if (!c.isRejected()) {
                            this.scheme = e.scheme;
                            this.predominantCategoryInfos =
                                e.predominantCategoryInfos;
                            a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                            this.authoringInfo = { type: "predominance", fields: dojo.map(d, function(a) { return a.name }), visualVariables: [{ type: "transparencyInfo", minSliderValue: 0, maxSliderValue: 100 }] };
                            if (e.size) {
                                var f = { type: "sizeInfo", minSliderValue: h.isDefined(b.minValue) ? b.minValue : e.size.statistics.min, maxSliderValue: h.isDefined(b.maxValue) ? b.maxValue : e.size.statistics.max };
                                this.authoringInfo.visualVariables.push(f)
                            }
                            e.renderer =
                                this.updatePredominanceRendererProperties(b, e.renderer);
                            c.resolve(e)
                        }
                    }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createPredominanceRenderer", !0), c.reject()) }))
                },
                applyPredominanceRenderer: function(a) {
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    this.hasDynamic || "predominance" === b || (this.layer.setOpacity(1), this.transparencySlider && this.transparencySlider.set("value", 0));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) &&
                    arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.types.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                updatePredominanceRenderer: function(b) {
                    if (h.isDefined(b) && "esriGeometryPolygon" === this.geometryType)
                        if (b) {
                            var c = [];
                            a.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                            a.forEach(c, function(a) { this.renderer.removeValue(a.value) }, this);
                            a.forEach(c, function(a) {
                                this.renderer.addValue({
                                    value: a.value,
                                    symbol: this.setOutlineWidthOfSymbol(a.symbol, 1),
                                    label: a.label
                                })
                            }, this);
                            this.portalPanel.lastUniqueDefaultSymbol = this.setOutlineWidthOfSymbol(this.portalPanel.lastUniqueDefaultSymbol, 1);
                            this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol, 1));
                            this.defaultInfo && this.defaultInfo.defaultSymbol && (this.defaultInfo.defaultSymbol = this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, 1));
                            this.getSuggestedOutline().then(g.hitch(this, function(a) {
                                this.replaceVisualVariable("sizeInfo",
                                    "outline", a.widthInfo, this.renderer);
                                this.applyPredominanceRenderer(this.renderer)
                            }), g.hitch(this, function(a) {
                                a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables);
                                this.renderer.setVisualVariables(a);
                                this.applyPredominanceRenderer(this.renderer)
                            }))
                        } else b = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), this.renderer.setVisualVariables(b), this.applyPredominanceRenderer(this.renderer);
                    else this.applyPredominanceRenderer(this.renderer)
                },
                updatePredominanceRendererProperties: function(a, b) {
                    b = b || this.renderer;
                    a = a || {};
                    a.showOthers ? (b.defaultSymbol = a.defaultSymbol, b.defaultLabel = a.defaultLabel) : a.showOthers || (delete b.defaultSymbol, delete b.defaultLabel);
                    a.rotationInfo && (b.setRotationInfo(a.rotationInfo), this.removeRotationInfoVisualVariable(b));
                    return b
                },
                reorderPredominantCategoryInfos: function(b, c, d) {
                    for (var e = this.renderer; e.infos[0];) e.removeValue(e.infos[0].value);
                    a.forEach(b, g.hitch(this, function(a) {
                        e.addValue({
                            value: a.value,
                            label: a.label,
                            symbol: a.symbol
                        })
                    }));
                    return e
                },
                getPredominantCategoryInfos: function() {
                    var a = new d;
                    setTimeout(function() { a.progress(a) }, 1);
                    if (this.predominantCategoryInfos) a.resolve();
                    else {
                        var b = this.attributeItem,
                            c = this.attributeItem2,
                            e = this.attributeItem3,
                            f = this.attributeItem4,
                            h = this.attributeItem5,
                            m = [];
                        m.push({ label: b.alias, name: b.name });
                        m.push({ label: c.alias, name: c.name });
                        e && (m.push({ label: e.alias, name: e.name }), f && (m.push({ label: f.alias, name: f.name }), h && (m.push({ label: h.alias, name: h.name }), attributeItem6 && (m.push({
                            label: attributeItem6.alias,
                            name: attributeItem6.name
                        }), attributeItem7 && (m.push({ label: attributeItem7.alias, name: attributeItem7.name }), attributeItem8 && (m.push({ label: attributeItem8.alias, name: attributeItem8.name }), attributeItem9 && (m.push({ label: attributeItem9.alias, name: attributeItem9.name }), attributeItem10 && m.push({ label: attributeItem10.alias, name: attributeItem10.name }))))))));
                        (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            a.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getPredominantCategories({ fields: g.clone(this.renderer.authoringInfo.fields) }).then(g.hitch(this,
                                function(b) { a.isRejected() || (this.predominantCategoryInfos = b.predominantCategoryInfos, a.resolve()) }), g.hitch(this, function(b) { a.isRejected() || (this.handleError(b, "getPredominantCategories", !1), a.reject()) }))
                        }), g.hitch(this, function(b) { a.isRejected() || (this.handleError(b, "addPlugin", !1), a.reject()) }))
                    }
                    return a
                },
                getPredominanceParams: function() {
                    var a = new d,
                        b = {};
                    if (!this.attributeItem && this.renderer.authoringInfo && this.renderer.authoringInfo.fields) {
                        var c = this.renderer.authoringInfo.fields;
                        this.getAttributeItemFromStore(c[0]).then(g.hitch(this,
                            function(a) {
                                b.attributeItem = a;
                                this.getAttributeItemFromStore(c[1]).then(g.hitch(this, function(a) {
                                    b.attributeItem2 = a;
                                    2 < c.length && this.getAttributeItemFromStore(c[2]).then(g.hitch(this, function(a) {
                                        b.attributeItem3 = a;
                                        3 < c.length && this.getAttributeItemFromStore(c[3]).then(g.hitch(this, function(a) {
                                            b.attributeItem4 = a;
                                            4 < c.length && this.getAttributeItemFromStore(c[4]).then(g.hitch(this, function(a) { b.attributeItem5 = a }))
                                        }))
                                    }))
                                }))
                            }))
                    }
                    b.symbol = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol :
                        this.getDefaultSymbol(this.geometryType);
                    b.rotationInfo = this.renderer.rotationInfo;
                    b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                    b.optimizeForScale = this._rendererSizeAutomaticRadio && this._rendererSizeAutomaticRadio.get("checked") ? "visible-scale-range" : !0;
                    b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                    this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) &&
                        (b.includeSizeInfo = !0);
                    a.resolve(b);
                    return a
                },
                getPredominanceFieldList: function(a) {
                    a = a || {};
                    var b = a.attributeItem || this.attributeItem,
                        c = a.attributeItem2 || this.attributeItem2,
                        d = a.attributeItem3 || this.attributeItem3,
                        e = a.attributeItem4 || this.attributeItem4,
                        f = a.attributeItem5 || this.attributeItem5,
                        g = a.attributeItem6 || this.attributeItem6,
                        h = a.attributeItem7 || this.attributeItem7,
                        m = a.attributeItem8 || this.attributeItem8,
                        n = a.attributeItem9 || this.attributeItem9;
                    a = a.attributeItem10 || this.attributeItem10;
                    var p = [];
                    p.push({ label: arcgisonline.sharing.util.htmlDecode(b.alias), name: b.name });
                    p.push({ label: arcgisonline.sharing.util.htmlDecode(c.alias), name: c.name });
                    d && (p.push({ label: arcgisonline.sharing.util.htmlDecode(d.alias), name: d.name }), e && (p.push({ label: arcgisonline.sharing.util.htmlDecode(e.alias), name: e.name }), f && (p.push({ label: arcgisonline.sharing.util.htmlDecode(f.alias), name: f.name }), g && (p.push({ label: arcgisonline.sharing.util.htmlDecode(g.alias), name: g.name }), h && (p.push({
                        label: arcgisonline.sharing.util.htmlDecode(h.alias),
                        name: h.name
                    }), m && (p.push({ label: arcgisonline.sharing.util.htmlDecode(m.alias), name: m.name }), n && (p.push({ label: arcgisonline.sharing.util.htmlDecode(n.alias), name: n.name }), a && p.push({ label: arcgisonline.sharing.util.htmlDecode(a.alias), name: a.name }))))))));
                    return p
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/_SizePanelMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-style dojo/string dojo/aspect dojo/query dojo/dom-class dijit/registry dojo/store/Memory dijit/Dialog dijit/TooltipDialog dijit/Tooltip esri/lang esri/symbols/jsonUtils esri/styles/size esri/styles/choropleth arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F) {
            return {
                tooltips: [],
                createTooltips: function() {
                    this.tooltips.push(new w({ connectId: this._rendererSizeTransparencyTitle, label: this.wrapTooltipText(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeTransparencyOverallTitle, label: this.wrapTooltipText(this.i18n.overallTransparencyTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeTransparencyPerFeatureTitle, label: this.wrapTooltipText(this.i18n.perFeaturesTransparencyTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeScaleTitle, label: this.wrapTooltipText(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeScaleSuggest, label: this.wrapTooltipText(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeRotationText, label: this.wrapTooltipText(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeRotationAttribute.domNode, label: this.wrapTooltipText(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeClassifyText, label: this.wrapTooltipText(this.i18n.classifyDataTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeClassifyMethods.domNode, label: this.wrapTooltipText(this.i18n.classifyMethodTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeClassifyClassesTitle, label: this.wrapTooltipText(d.substitute(this.i18n.numberOfClassesTooltip, { num: 10 })) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeSymbolsTitle, label: this.wrapTooltipText(this.i18n.symbolsTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeZoomTitle, label: this.wrapTooltipText(this.i18n.zoomTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeInvertTitle, label: this.wrapTooltipText(this.i18n.invertTooltip) }));
                    this.legendClassesTooltip = new w({ connectId: this._rendererSizeLegendClassesTitle, label: this.wrapTooltipText(this.i18n.legendTooltip) });
                    this.tooltips.push(this.legendClassesTooltip);
                    this.tooltips.push(new w({ connectId: this._rendererSizePolygonsTitle, label: this.wrapTooltipText(this.i18n.polygonsTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeDividedByAttribute.domNode, label: this.wrapTooltipText(this.i18n.dividedByTooltip) }));
                    "classedSize" === this.getRendererStyle(this.renderer) ? this.otherTooltip = new w({ connectId: this._rendererSizeOtherTxt, label: this.wrapTooltipText(this.i18n.drawClassifiedOthersTooltip) }) : this.otherTooltip = new w({ connectId: this._rendererSizeOtherTxt, label: this.wrapTooltipText(this.i18n.drawOthersTooltip) });
                    this.tooltips.push(this.otherTooltip);
                    this.tooltips.push(new w({
                        connectId: this._rendererSizeOtherSymbol,
                        label: this.wrapTooltipText(this.i18n.otherSymbolTooltip)
                    }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeOtherSymbolText, label: this.wrapTooltipText(this.i18n.otherSymbolTooltip) }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeRotationEditExpression, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this.tooltips.push(new w({
                        connectId: this._rendererSizeDividedByFieldDescription,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription +
                            "\x3c/div\x3e"
                    }));
                    this.tooltips.push(new w({ connectId: this._rendererSizeRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                wrapTooltipText: function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" },
                destroyTooltips: function() { n.forEach(this.tooltips, function(a) { a.destroy() }) },
                _onChangeLegend: function(a) {
                    this.updateLegendProperty(this.renderer, "sizeInfo", a);
                    this.applySizeRenderer(this.renderer)
                },
                _onClickSymbols: function(a,
                    b) {
                    a = B.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPolygon" === this.geometryType ? "esriGeometryPoint" : this.geometryType });
                    b = this.renderer.infos && this.renderer.infos.length ? this.getSymbolFromClassedSizeRenderer(this.renderer) : this.getDefaultSymbol(this.geometryType);
                    var c = null;
                    this.isMultiAttributesRenderer && (c = { excluded: ["fill"], symbolDisplayMode: "default" });
                    this.showSymbolStyler(b, { externalSizing: !0, schemes: a, tabOptions: c }, g.hitch(this, "onSymbolsChange"))
                },
                onSymbolsChange: function(a,
                    b, c) {
                    this.scheme = c || this.scheme;
                    b = a.toJson();
                    "esriPMS" != a.type || 0 != b.url.length && "http://" != b.url || (a = x.fromJson(this.getMarkerJson()));
                    a = x.fromJson(a.toJson());
                    this.isSymbolTransparent(a) ? this.drawTransparentSymbol(this._rendererSizeSymbol) : (this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === a.type ? a : this.switchSizeKeepSymbol(a, 28), null, null, null, 1), this.updateBackgroundForAlmostWhite(a, this._rendererSizeSymbol));
                    a = { symbol: x.fromJson(a.toJson()) };
                    this.updateSymbolOnSizeRenderer(a);
                    a = a.symbol;
                    this.isSymbolTransparent(a) ? this.drawTransparentSymbol(this._rendererSizeSymbol) : (this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === a.type ? a : this.switchSizeKeepSymbol(a, 28), null, null, null, 1), this.updateBackgroundForAlmostWhite(a, this._rendererSizeSymbol));
                    this.hasNumericField && -1 < n.indexOf(["esriGeometryPoint", "esriGeometryMultipoint", "esriGeometryPolygon"], this.geometryType) && this.drawRotationSymbol(a, this._rendererSizeRotateRightSymbol, this._rendererSizeRotateLeftSymbol);
                    this.updateSizeRenderer(null)
                },
                _onClickPolygons: function(a, b) {
                    a = B.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.renderer.backgroundFillSymbol, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: a }, g.hitch(this, "onPolygonSymbolChange"))
                },
                onPolygonSymbolChange: function(a, b, c, d) {
                    this.renderer.backgroundFillSymbol = x.fromJson(a.toJson());
                    this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ||
                        (this.drawSymbol(this._rendererSizePolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererSizePolygonSymbol)) : (this.renderer.backgroundFillSymbol = x.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererSizePolygonSymbol));
                    this.updateSizeRenderer(d)
                },
                _onChangeOther: function(a) {
                    this.disableAllEvents || (a ? (c.set(this._rendererSizeOther, "display", ""), this.renderer.defaultSymbol =
                        this.defaultInfo.defaultSymbol, this.renderer.defaultLabel = this.defaultInfo.defaultLabel) : (c.set(this._rendererSizeOther, "display", "none"), delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel), this.applySizeRenderer(this.renderer))
                },
                onClickOtherSymbol: function(a, b) {
                    b = B.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPolygon" === this.geometryType ? "esriGeometryPoint" : this.geometryType });
                    this.showSymbolStyler(this.defaultInfo.defaultSymbol, {
                        externalSizing: !1,
                        optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                        schemes: b
                    }, g.hitch(this, "onOtherSymbolChange", a))
                },
                onOtherSymbolChange: function(a, b, c, d, e) {
                    a = b.toJson();
                    "esriPMS" !== b.type || 0 !== a.url.length && "http://" !== a.url || (b = x.fromJson(this.getMarkerJson()));
                    this.defaultInfo.defaultSymbol = b;
                    this.renderer.defaultSymbol && (this.renderer.defaultSymbol = x.fromJson(b.toJson()));
                    "uniquesize" === this.getRendererStyle(this.renderer) && (this.lastUniqueDefaultSymbol = x.fromJson(b.toJson()));
                    this.updateSizeRenderer(e);
                    this.adjustHeight()
                },
                _onClickInvert: function() {
                    if (!this.disableAllEvents) {
                        this.invertSize();
                        var a = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                        this.sizeSlider && this.sizeSlider.set("sizeInfo", g.clone(a));
                        this.applySizeRenderer(this.renderer)
                    }
                },
                invertSize: function(a) {
                    var b = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables),
                        c = !1;
                    if ("number" === typeof b.minSize) {
                        if (!t.isDefined(a) || a && b.minSize < b.maxSize || !a && b.minSize > b.maxSize) c = b.minSize, b.minSize =
                            b.maxSize, b.maxSize = c, c = !0
                    } else if (!t.isDefined(a) || a && b.minSize.stops[0].size < b.maxSize.stops[0].size || !a && b.minSize.stops[0].size > b.maxSize.stops[0].size) c = b.minSize, b.minSize = b.maxSize, b.maxSize = c, c = !0;
                    c && (a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }], this.renderer.visualVariables) || [], a.push(b), this.renderer.setVisualVariables(a));
                    return c
                },
                _onClickZoom: function() {
                    this.disableAllEvents || (this.sizeSlider.get("zoomOptions") ? (this.zoomOutSlider(), h.remove(this._rendererSizeZoomIcon, "active"),
                        this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn) : this.getParams().then(g.hitch(this, function(a) {
                        this.zoomInSlider(a).then(g.hitch(this, function(a) {
                            h.add(this._rendererSizeZoomIcon, "active");
                            this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomOut
                        }), g.hitch(this, function(a) {}))
                    })))
                },
                clearZoom: function() { this.sizeSlider && (this.sizeSlider.get("zoomOptions") && this.zoomOutSlider(), h.remove(this._rendererSizeZoomIcon, "active"), this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn) },
                _onChangeSizing: function(a) {
                    this.disableAllEvents ?
                        "object" === typeof this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables).minSize ? (this._rendererSizeAutomaticRadio.set("checked", !0), this.disableSizeInput()) : (this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput()) : (this._rendererSizeManualRadio.get("checked") ? this.enableSizeInput() : this.disableSizeInput(), a && ("predominancesize" === this.getRendererStyle(this.renderer) ? this.getPredominanceParams().then(g.hitch(this, function(a) {
                            this.buildPredominanceRenderer(a).then(g.hitch(this,
                                function(b) {
                                    this.hideBusy();
                                    var d = b.renderer;
                                    a.statistics = b.size.statistics;
                                    this.renderer = d;
                                    b = this.getSymbolFromClassedSizeRenderer(this.renderer);
                                    this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === b.type ? b : this.switchSizeKeepSymbol(b, 28), null, null, null, 1);
                                    this.updateSizeUI();
                                    this.applyPredominanceRenderer(d);
                                    h.remove(this._rendererSizeLegendClassesIcon, "active");
                                    this._rendererSizeLegendClassesText.innerHTML = this.i18n.legend;
                                    this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip));
                                    c.set(this._rendererSizeSliderDiv, "display", "");
                                    c.set(this._rendererSizeGridDiv, "display", "none");
                                    h.remove(this._rendererSizeZoomIcon, "active");
                                    this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn;
                                    this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                                        this.hideBusy();
                                        this.adjustHeight()
                                    }), g.hitch(this, function() { this.hideBusy() }))
                                }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        })) : this.updateClassifyInfo()))
                },
                _onChangeMin: function(a) {
                    if (!this.disableAllEvents) {
                        this._rendererSizeManualRadio.get("checked") ||
                            this.hasDynamic && !this.newDMS || "esriGeometryPolygon" !== this.geometryType || "size" !== this.getRendererStyle(this.renderer) || (this.disableAllEvents = !0, this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3));
                        var b = this._rendererSizeMin.get("value"),
                            c = this._rendererSizeMax.get("value");
                        setTimeout(g.hitch(this, function(b, c) {
                                var d = this._rendererSizeMin.get("value"),
                                    e = this._rendererSizeMax.get("value");
                                b === d && c === e && this._onChangeMinAction(a)
                            },
                            b, c), 1E3)
                    }
                },
                _onChangeMinAction: function(a) {
                    a = this._rendererSizeMin.get("value");
                    var b = this._rendererSizeMax.get("value");
                    a > b && (this._rendererSizeMin.set("value", b), a = b);
                    a < this._rendererSizeMin.get("constraints").min ? (this._rendererSizeMin.set("value", this._rendererSizeMin.get("constraints").min), a = this._rendererSizeMin.get("constraints").min) : a > this._rendererSizeMin.get("constraints").max && (this._rendererSizeMin.set("value", this._rendererSizeMin.get("constraints").max), a = this._rendererSizeMin.get("constraints").max);
                    this.updateSizeOnSizeRenderer(a, b);
                    this.applySizeRenderer(this.renderer)
                },
                _onChangeMax: function(a) {
                    if (!this.disableAllEvents) {
                        this._rendererSizeManualRadio.get("checked") || this.hasDynamic && !this.newDMS || "esriGeometryPolygon" !== this.geometryType || "size" !== this.getRendererStyle(this.renderer) || (this.disableAllEvents = !0, this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3));
                        var b = this._rendererSizeMin.get("value"),
                            c =
                            this._rendererSizeMax.get("value");
                        setTimeout(g.hitch(this, function(b, c) {
                            var d = this._rendererSizeMin.get("value"),
                                e = this._rendererSizeMax.get("value");
                            b === d && c === e && this._onChangeMaxAction(a)
                        }, b, c), 1E3)
                    }
                },
                _onChangeMaxAction: function(a) {
                    a = this._rendererSizeMin.get("value");
                    var b = this._rendererSizeMax.get("value");
                    a > b && (this._rendererSizeMax.set("value", a), b = a);
                    b < this._rendererSizeMax.get("constraints").min ? (this._rendererSizeMax.set("value", this._rendererSizeMax.get("constraints").min), b = this._rendererSizeMax.get("constraints").min) :
                        b > this._rendererSizeMax.get("constraints").max && (this._rendererSizeMax.set("value", this._rendererSizeMax.get("constraints").max), b = this._rendererSizeMax.get("constraints").max);
                    this.updateSizeOnSizeRenderer(a, b);
                    this.applySizeRenderer(this.renderer)
                },
                updateSizeUI: function() {
                    this.disableAllEvents = !0;
                    var a = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    "object" === typeof a.minSize ? (this._rendererSizeMin.set("value", Math.min(a.minSize.stops[1].size, a.maxSize.stops[1].size)),
                        this._rendererSizeMax.set("value", Math.max(a.minSize.stops[1].size, a.maxSize.stops[1].size))) : "number" === typeof a.minSize && (this._rendererSizeMin.set("value", Math.min(a.minSize, a.maxSize)), this._rendererSizeMax.set("value", Math.max(a.minSize, a.maxSize)));
                    "object" === typeof this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables).minSize ? (this._rendererSizeAutomaticRadio.set("checked", !0), this.disableSizeInput()) : (this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput());
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                enableSizeInput: function() {
                    this._rendererSizeMin.set("disabled", !1);
                    this._rendererSizeMax.set("disabled", !1);
                    e(".sizingTypes2").forEach(function(a) { h.remove(a, "disabledText") })
                },
                disableSizeInput: function() {
                    this._rendererSizeMin.set("disabled", !0);
                    this._rendererSizeMax.set("disabled", !0);
                    e(".sizingTypes2").forEach(function(a) { h.add(a, "disabledText") })
                },
                _onChangeRotation: function(a) {
                    this.disableAllEvents || (c.set(this._rendererSizeRotationContent,
                        "display", a ? "" : "none"), this.adjustHeight(), this.updateRotationInfo())
                },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererSizeRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererSizeRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b =
                                    a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererSizeRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                                    this._rendererSizeRotationAttribute.set("value", "customExprRotation", !1);
                                    a = {
                                        valueExpression: a.valueExpression,
                                        valueExpressionTitle: a.valueExpressionTitle,
                                        rotationType: this._rendererSizeRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic",
                                        type: "rotationInfo"
                                    };
                                    this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.setVisualVariables(c);
                                    this.applySizeRenderer(this.renderer);
                                    this.updateUIWithRenderer()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b,
                                        "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", d.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo();
                                    this.updateUIWithRenderer()
                                }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                            })
                        });
                        else {
                            c.set(this._rendererSizeRotationEditExpression, "display", "none");
                            if (this.hasDynamic && !this.newDMS) this.renderer.rotationType =
                                this._rendererSizeRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", this.renderer.rotationExpression = "[" + this._rendererSizeRotationAttribute.get("value") + "]";
                            else {
                                var a = { field: this._rendererSizeRotationAttribute.get("value"), rotationType: this._rendererSizeRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                this.getAttributeItemFromStore(this._rendererSizeRotationAttribute.get("value")).then(g.hitch(this, function(a) {
                                    a && a.descriptionValue ? c.set(this._rendererSizeRotationFieldDescription,
                                        "display", "") : c.set(this._rendererSizeRotationFieldDescription, "display", "none")
                                }));
                                this.renderer.setRotationInfo(null);
                                var b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                b.push(a);
                                this.renderer.setVisualVariables(b)
                            }
                            this.applySizeRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null), this.removeRotationInfoVisualVariable(), this.applySizeRenderer(this.renderer), this.adjustHeight()
                },
                onSizeSliderChange: function(a) {
                    "classedSize" ===
                    this.getRendererStyle(this.renderer) && (this.disableAllEvents = !0, this.authoringInfo && delete this.authoringInfo.classificationMethod, this.renderer.authoringInfo && delete this.renderer.authoringInfo.classificationMethod, this.renderer.classificationMethod = null, this._rendererSizeClassifyMethods.set("value", this.getClassificationMethod(null)), this._rendererSizeClassifyClasses.set("value", this.renderer.infos.length), c.set(this._rendererSizeClassifyClassesTitle, "display", ""), c.set(this._rendererSizeClassifyStdDevIntervalTitle,
                        "display", "none"), "precisionChange" === a ? this.disableOptionsBelow(this._rendererSizePrecision, parseFloat(this._rendererSizePrecision.get("value"))) : (this.enableAllOptions(this._rendererSizePrecision), this._rendererSizePrecision.set("value", this.i18n.selectAnOptions)), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3))
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg = (new r({ id: "attributeTransparencyDlg", style: "visibility:hidden;" })).placeAt(document.body);
                    this.attributeTransparencyDlgContent = new G({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler = a.connect(this.attributeTransparencyDlg, "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new F({
                        attributesStore: this.attributesStore,
                        layer: this.fLayer ||
                            this.layer,
                        mapLayer: this.mapLayer,
                        showDateFields: this.showDateFields,
                        numHistogramBins: this.numHistogramBins,
                        savedRenderers: this.savedRenderers
                    }, "attributeTransparencyDlgContent");
                    var b = this.getRendererStyle(this.renderer);
                    this.attributeTransparencyDlg.set({ title: "predominancesize" === b ? this.i18n.attributeTransparencyDlgTitleForPredominance : this.i18n.attributeTransparencyDlgTitle, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler = a.subscribe("attribute-transparency-commit",
                        g.hitch(this, function(a) {
                            this.hideAttributeTransparencyDlg();
                            if (a.opacityInfo) this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo = g.clone(a.authoringInfo), this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applySizeRenderer(this.renderer), "predominancesize" === b ? this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = this.i18n.predominantPercentage : this.attributesStore.fetchItemByIdentity({
                                identity: a.opacityInfo.field || "customExprTrans",
                                onItem: g.hitch(this, function(b) {
                                    a.opacityInfo.normalizationField ? this.attributesStore.fetchItemByIdentity({ identity: a.opacityInfo.normalizationField, onItem: g.hitch(this, function(a) { this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: b.alias || b.name, field2: a.alias || a.name }) }) }) : this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = a.opacityInfo.field ? b.alias || b.name : a.opacityInfo.valueExpressionTitle || a.opacityInfo.legendOptions &&
                                        a.opacityInfo.legendOptions.title
                                })
                            });
                            else {
                                var c = this.getVisualVariablesExceptType("opacityInfo", null, this.renderer.visualVariables);
                                this.renderer.setVisualVariables(c);
                                this.applySizeRenderer(this.renderer);
                                this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = this.i18n.attributeValues
                            }
                        }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() {
                        c.set(this.attributeTransparencyDlg.domNode,
                            "visibility", "visible")
                    }))
                },
                hideAttributeTransparencyDlg: function() { this.attributeTransparencyDlg && this.attributeTransparencyDlg.hide() },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler && a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency && this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    m.byId("attributeTransparencyDlg") && m.byId("attributeTransparencyDlg").destroy()
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/AgeColor": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dijit/Tooltip dojo/data/ObjectStore esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_ColorMixin arcgisonline/map/dijit/renderer/_AgeColorMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_ColorPanelMixin esri/renderers/SimpleRenderer esri/symbols/SimpleLineSymbol dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Color.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N) {
            b = b([C, X], {
                declaredClass: "arcgisonline.map.dijit.renderer.AgeColor",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererColor",
                widgetsInTemplate: !0,
                templateString: N,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                origGalleryRenderer: null,
                isMultiAttributesRenderer: !1,
                constructor: function(a,
                    b) {
                    g.mixin(this, M);
                    g.mixin(this, K);
                    g.mixin(this, P);
                    g.mixin(this, O);
                    g.mixin(this, R);
                    g.mixin(this, S);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.colorSlider && this.colorSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.destroyTooltips();
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(V.common);
                    g.mixin(this.i18n, V.rendererCommon);
                    g.mixin(this.i18n, V.rendererColorPanel);
                    g.mixin(this.i18n, V.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererColorPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"), "resize", this,
                        "adjustHeight"));
                    a.connect(this._rendererColorOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererColorRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererColorRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererColorRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.portalPanel.scheme = this.scheme;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack(this.renderer) : leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererColorFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererColorHeader"), "display", "none");
                    t.set(f.byId("rendererColorDividedBy"),
                        "display", "none");
                    t.set(this._rendererColorGridDiv, "display", "none");
                    t.set(this._rendererColorLegendClassesTitle, "display", "none");
                    t.set(f.byId("rendererAgeColorMiddleFieldsSection"), "display", "");
                    t.set(f.byId("rendererAgeColorUnits"), "display", "");
                    var a = new Date;
                    this._rendererAgeColorFixedDate.set("value", a);
                    this._rendererAgeColorFixedTime.set("value", a);
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = -1 < dojo.indexOf(["ageColorSize"], this.getRendererStyle(this.renderer));
                    this._rendererColorLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererColorLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererColorField.innerHTML = this.i18n.age;
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    this.scheme = null;
                    this._fillRendererColorTheme();
                    this.transparencySlider = this.createTransparencySlider("rendererColorTransparencySlider");
                    this.createScaleSlider("rendererColorScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    t.set(this._rendererColorClassify, "display", "none");
                    t.set(this._rendererColorOtherCheckMsg, "paddingTop", "20px");
                    1 < this.countDateFields && this._rendererAgeColorFieldSelect.setStore(this.attributesStore, this.i18n.fixedDate, { query: "(type:'esriFieldTypeDate' OR type:'fixedDate' OR (name:'separator' AND type:'separator')) AND NOT name:'" + this.attributeItem.name + "'" });
                    !this.hasNumericField || "esriGeometryPoint" !=
                        this.geometryType && "esriGeometryMultipoint" != this.geometryType ? t.set(this._rendererColorRotation, "display", "none") : (this._rendererColorRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" }), t.set(this._rendererColorRotation, "display", ""));
                    if (this.hasNumericField ||
                        this.hasDateField) {
                        var a = this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererColorAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererColorAttributeTransparencyLabel_part3.innerHTML = a.substring(b + 8);
                        var c = this.getOpacityInfo();
                        c && c.field ? "function" == typeof c.field ? this._rendererColorAttributeTransparencyLabel_part2.innerHTML = "predominant total" : this.attributesStore.fetchItemByIdentity({
                            identity: c.field,
                            onItem: g.hitch(this, function(a) {
                                c.normalizationField ? this.attributesStore.fetchItemByIdentity({
                                    identity: c.normalizationField,
                                    onItem: g.hitch(this, function(b) { this._rendererColorAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: a.alias || a.name, field2: b.alias || b.name }) })
                                }) : this._rendererColorAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name
                            })
                        }) : this._rendererColorAttributeTransparencyLabel_part2.innerHTML = c && c.valueExpression ? this.getRendererCustomExpression(null, "transparency").title : this.i18n.attributeValues
                    } else m(".rendererColorHasAttributeTransparency").forEach(function(a) {
                        t.set(a,
                            "display", "none")
                    }), w.remove(f.byId("rendererColorTransparencySliderDiv"), "esriLeadingPadding1");
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                    this.createTooltips();
                    this.tooltips.push(new G({ connectId: this._rendererAgeColorSwitch, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.switchAttributes + "\x3c/div\x3e" }));
                    this.tooltips.push(new G({
                        connectId: this._rendererAgeColorSwitch2,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.switchAttributes +
                            "\x3c/div\x3e"
                    }));
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    var a = this.getVisualVariableByType("colorInfo", null, this.authoringInfo.visualVariables);
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererColorOther, "display", ""), this._rendererColorOtherCheck.set("checked", !0)) : (this.defaultInfo = {
                        defaultSymbol: this.getDefaultSymbol(this.geometryType),
                        defaultLabel: this.i18n.other
                    }, t.set(this._rendererColorOther, "display", "none"), this._rendererColorOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererColorOtherSymbol) : (this.drawSymbol(this._rendererColorOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererColorOtherSymbol));
                    f.byId("rendererAgeColorTopField").innerHTML = this.attributeItem.alias;
                    f.byId("rendererAgeColorBottomField").innerHTML = this.attributeItem.alias;
                    "string" === typeof a.startTime && a.startTime === a.field ? (t.set(f.byId("rendererAgeColorTopFieldsSection"), "display", ""), t.set(f.byId("rendererAgeColorSwitch2"), "display", "none"), t.set(f.byId("rendererAgeColorMiddleFieldsToLabel"), "display", "")) : "string" === typeof a.endTime && a.endTime === a.field && (t.set(f.byId("rendererAgeColorBottomFieldsSection"), "display", ""), t.set(f.byId("rendererAgeColorSwitch2"), "display", ""), t.set(f.byId("rendererAgeColorMiddleFieldsFromLabel"),
                        "display", ""));
                    1 < this.countDateFields ? t.set(f.byId("rendererAgeColorFieldsSelect"), "display", "") : t.set(f.byId("rendererAgeColorFieldsSelect"), "display", "none");
                    "string" !== typeof a.startTime || "string" !== typeof a.endTime ? (t.set(f.byId("rendererAgeColorFieldsFixedDateTime"), "display", ""), "string" !== typeof a.startTime ? (this._rendererAgeColorFixedDate.set("value", new Date(a.startTime)), this._rendererAgeColorFixedTime.set("value", new Date(a.startTime))) : (this._rendererAgeColorFixedDate.set("value", new Date(a.endTime)),
                        this._rendererAgeColorFixedTime.set("value", new Date(a.endTime))), -1 < n.indexOf(["seconds", "minutes", "hours"], a.units) && t.set(f.byId("rendererAgeColorFieldsFixedTime"), "display", "")) : a.startTime === a.field ? this._rendererAgeColorFieldSelect.set("value", a.endTime) : this._rendererAgeColorFieldSelect.set("value", a.startTime);
                    this._rendererAgeColorUnits.set("value", a.units);
                    t.set(this._rendererColorInvertTitle, "display", "");
                    "ageColor" === this.getRendererStyle(this.renderer) ? ((a = this.renderer.authoringInfo ?
                            this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables) : null) && a.theme && this._rendererColorTheme.set("value", this.getThemeAlias(a.theme)), t.set(f.byId("rendererColorTheme"), "display", ""), this._rendererColorZoomLabel.innerHTML = this.i18n.zoomIn, t.set(this._rendererColorZoomTitle, "display", ""), this._rendererColorClassifyCheck.set("checked", !1), t.set(this._rendererColorClassifyContent, "display", "none"), t.set(this._rendererColorLegendClassesTitle, "display", "none"), this._rendererColorOtherTxt.innerHTML =
                        this.i18n.drawOthers) : "ageColorSize" === this.getRendererStyle(this.renderer) && ((a = this.renderer.authoringInfo ? this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables) : null) && a.theme && this._rendererColorTheme.set("value", this.getThemeAlias(a.theme)), t.set(this._rendererColorClassify, "display", "none"), t.set(this._rendererColorLegendClassesTitle, "display", "none"));
                    t.set(this._rendererColorRotationEditExpression, "display", "none");
                    t.set(this._rendererColorRotationFieldDescription,
                        "display", "none");
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || (a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType), this.drawRotationSymbol(a, this._rendererColorRotateRightSymbol, this._rendererColorRotateLeftSymbol), a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), this._rendererColorRotationCheck.set("checked",
                        a ? !0 : !1), a && (this._rendererColorRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererColorRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererColorRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererColorRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererColorRotationAttribute.set("value",
                        "customExprRotation"), t.set(this._rendererColorRotationEditExpression, "display", ""))), t.set(this._rendererColorRotationContent, "display", a ? "" : "none"));
                    var b = function(a) {
                        9 > e("ie") ? setTimeout(g.hitch(this, function() {
                            this.createColorInfoSlider(a).then(g.hitch(this, function() {
                                this.hideBusy();
                                this.adjustHeight()
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                        }), 1E3) : this.createColorInfoSlider(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    };
                    this.getParams().then(g.hitch(this, function(a) {
                        (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            (this.fLayer || this.layer).statisticsPlugin.getAgeStatistics({ startTime: a.startTime, endTime: a.endTime, units: a.units }).then(g.hitch(this, function(c) {
                                    a.statistics = this.checkStatistics(c.statistics, !1);
                                    dojo.hitch(this, b, a)()
                                }),
                                g.hitch(this, function(c) {
                                    this.handleError(c, "getAgeStatistics", !1);
                                    dojo.hitch(this, b, a)()
                                }))
                        }), g.hitch(this, function(c) {
                            this.handleError(c, "addPlugin", !1);
                            dojo.hitch(this, b, a)()
                        }))
                    }))
                },
                buildNewAgeColorRenderer: function(a) {
                    this.getParams().then(g.hitch(this, function(b) {
                        "fieldChange" === a ? delete b.units : "dateChange" === a && delete b.units;
                        this.buildAgeColorRenderer(b).then(g.hitch(this, function(a) {
                            this.hideBusy();
                            this.renderer = a.renderer;
                            this.renderer.authoringInfo = this.authoringInfo;
                            var b = this.getVisualVariableByType("colorInfo",
                                null, this.authoringInfo.visualVariables);
                            this._rendererAgeColorUnits.set("value", b.units);
                            this.updateColorSlider(null, a.statistics);
                            this.applyAgeColorRenderer(this.renderer)
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererColorStack", a) }))
                    }))
                },
                _onClickSwitch: function() {
                    this.disableAllEvents || (this.disableAllEvents = !0, "none" !== t.get(f.byId("rendererAgeColorTopFieldsSection"), "display") ? (t.set(f.byId("rendererAgeColorBottomFieldsSection"), "display", ""), t.set(f.byId("rendererAgeColorTopFieldsSection"),
                        "display", "none"), t.set(f.byId("rendererAgeColorSwitch2"), "display", ""), t.set(f.byId("rendererAgeColorMiddleFieldsFromLabel"), "display", ""), t.set(f.byId("rendererAgeColorMiddleFieldsToLabel"), "display", "none")) : (t.set(f.byId("rendererAgeColorTopFieldsSection"), "display", ""), t.set(f.byId("rendererAgeColorBottomFieldsSection"), "display", "none"), t.set(f.byId("rendererAgeColorSwitch2"), "display", "none"), t.set(f.byId("rendererAgeColorMiddleFieldsToLabel"), "display", ""), t.set(f.byId("rendererAgeColorMiddleFieldsFromLabel"),
                        "display", "none")), this.buildNewAgeColorRenderer(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3))
                },
                _onClickSwitch2: function() { this._onClickSwitch() },
                _onChangeFieldSelect: function(a) { this.disableAllEvents || ("fixedDate" === a ? t.set(f.byId("rendererAgeColorFieldsFixedDateTime"), "display", "") : t.set(f.byId("rendererAgeColorFieldsFixedDateTime"), "display", "none"), this.buildNewAgeColorRenderer("fieldChange")) },
                _onChangeFixedDate: function() { this.disableAllEvents || this.buildNewAgeColorRenderer("dateChange") },
                _onChangeFixedTime: function() { this.disableAllEvents || this.buildNewAgeColorRenderer() },
                _onChangeUnits: function(a) { this.disableAllEvents || (-1 < n.indexOf(["seconds", "minutes", "hours"], a) ? t.set(f.byId("rendererAgeColorFieldsFixedTime"), "display", "") : t.set(f.byId("rendererAgeColorFieldsFixedTime"), "display", "none"), this.buildNewAgeColorRenderer()) },
                _onClickLegendClasses: function() {},
                _onChangeDividedByAttribute: function() {},
                _onChangeClassify: function() {},
                _onChangeClassifyMethod: function() {},
                _onChangeClassifyClasses: function() {},
                _onChangeClassifyStdDevInterval: function() {},
                _onChangeColorPrecision: function() {},
                getParams: function() {
                    var a = new v,
                        b = {};
                    b.theme = this.getTheme();
                    b.showOthers = this._rendererColorOtherCheck.get("checked");
                    b.symbol = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                    b.rotationInfo = this.renderer.rotationInfo;
                    b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                    b.optimizeOutline =
                        this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                    b.units = this._rendererAgeColorUnits.get("value");
                    if ("none" !== t.get(f.byId("rendererAgeColorTopFieldsSection"), "display"))
                        if (b.startTime = this.attributeItem.name, "none" === t.get(f.byId("rendererAgeColorFieldsSelect"), "display")) b.endTime = this.getFixedDate();
                        else {
                            var c = this._rendererAgeColorFieldSelect.get("value");
                            b.endTime = "fixedDate" === c ? this.getFixedDate() : this._rendererAgeColorFieldSelect.get("value")
                        }
                    else b.endTime =
                        this.attributeItem.name, "none" === t.get(f.byId("rendererAgeColorFieldsSelect"), "display") ? b.startTime = this.getFixedDate() : (c = this._rendererAgeColorFieldSelect.get("value"), b.startTime = "fixedDate" === c ? this.getFixedDate() : this._rendererAgeColorFieldSelect.get("value"));
                    a.resolve(b);
                    return a
                },
                getFixedDate: function() {
                    var a = new Date(this._rendererAgeColorFixedDate.get("value")),
                        b = new Date(this._rendererAgeColorFixedTime.get("value"));
                    return (new Date(a.getFullYear(), a.getMonth(), a.getDate(), b.getHours(),
                        b.getMinutes(), 0, 0)).getTime()
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererColorStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererColorTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererColorFooter_links")).h + 10;
                        t.set(f.byId("rendererColorFooterDiv"), "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && t.set(f.byId("renderer-color-content"), "height", a + "px");
                        var g = 60;
                        n.forEach(m(".firstColumnLabel",
                            this.domNode), function(a) { g = Math.max(g, c.coords(a).w) });
                        var h = 40;
                        n.forEach(m(".firstColumnLabelAge", this.domNode), function(a) { h = Math.max(h, c.coords(a).w) });
                        var h = h + 26,
                            g = Math.max(g, h),
                            p = 40;
                        m(".toolsLabel").forEach(function(a) { p = Math.max(p, c.coords(a).w) });
                        m(".toolsColumnTD").style("width", p + 4 + "px");
                        b = c.coords(f.byId("leftContentStackContainer")).w;
                        a = b - g - 40;
                        0 < a && (t.set(this._rendererAgeColorUnits.domNode, "width", a + "px"), t.set(this._rendererAgeColorFieldSelect.domNode, "width", a + "px"), t.set(this._rendererColorTheme.domNode,
                            "width", a - 2 + "px"), (d = f.byId("widget_rendererColorThemeDropdown_dropdown")) && t.set(d, "width", a - 2 + "px"), d && m(".dijitMenuItem", d).style("width", a - 30 + "px"));
                        a = b - 35;
                        if (0 < a) {
                            b = 0;
                            if ("none" !== t.get(this._rendererColorRotationEditExpression, "display") || "none" !== t.get(this._rendererColorRotationFieldDescription, "display")) b = 30;
                            t.set(this._rendererColorRotationAttribute.domNode, "width", a - b - 21 + "px");
                            m(".dijitSelectLabel", this._rendererColorRotationAttribute.domNode).style("maxWidth", a - b - 51 + "px");
                            this.transparencySlider &&
                                t.set(this.transparencySlider.domNode, "width", a - 30 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", a - 15 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.AgeColor", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_AgeColorMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom dojo/Deferred dojo/dom-construct dojo/dom-style esri/lang esri/symbols/jsonUtils esri/renderers/smartMapping esri/styles/choropleth esri/plugins/FeatureLayerStatistics esri/dijit/ColorInfoSlider esri/dijit/ClassedColorSlider esri/renderers/SimpleRenderer esri/renderers/ClassBreaksRenderer arcgisonline/map/dijit/renderer/ColorGrid".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            return {
                buildAgeColorRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildAgeColorRendererGo(null, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildAgeColorRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildAgeColorRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildAgeColorRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() {!b.isRejected() && b.reject() }) })
                        } else this.buildAgeColorRendererGo(null,
                            a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildAgeColorRendererGo(null, a, b);
                    return b
                },
                buildAgeColorRendererGo: function(b, c, d) {
                    if (!this.scheme) {
                        var e, f = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                        if (f) {
                            var n = a.map(f.stops, function(a) { return a.color });
                            e = r.getMatchingSchemes({ theme: c.theme || "high-to-low", colors: n, geometryType: this.geometryType })
                        } else n =
                            a.map(this.renderer.infos, function(a) { return a.symbol.color }), (e = r.getMatchingSchemes({ theme: "high-to-low", colors: n, geometryType: this.geometryType })) && e.length || (e = r.getMatchingSchemes({ theme: "above-and-below", colors: n, geometryType: this.geometryType }));
                        e && e.length && (this.scheme = e[0])
                    }
                    var t, v = null;
                    this.renderer.visualVariables && "color" === this.getRendererType(this.renderer) && (t = this.getVisualVariablesExceptTypes([{ type: "colorInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.visualVariables),
                        v = this.renderer.authoringInfo && this.getVisualVariablesExceptTypes([{ type: "colorInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.authoringInfo.visualVariables));
                    var w = c.attributeItem || this.attributeItem;
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        c.startTime = c.startTime || w.name;
                        c.endTime = c.endTime || new Date;
                        p.createAgeInfo({ layer: this.fLayer || this.layer, startTime: c.startTime, endTime: c.endTime, units: c.units }).then(g.hitch(this, function(a) {
                            d.isRejected() ||
                                p.createColorRenderer({ layer: this.fLayer || this.layer, valueExpression: a.valueExpression, sqlExpression: a.statisticsQuery.sqlExpression, sqlWhere: a.statisticsQuery.sqlWhere, legendOptions: a.legendOptions, theme: c.theme || "high-to-low", minValue: c.minValue, maxValue: c.maxValue, basemap: this.getBasemapType(), scheme: this.scheme, optimizeOutline: h.isDefined(c.optimizeOutline) ? c.optimizeOutline : !0, showOthers: !0 }).then(g.hitch(this, function(e) {
                                    if (!d.isRejected()) {
                                        e.statistics = this.checkStatistics(e.statistics, !1);
                                        this.scheme = e.scheme;
                                        this.onCalculationsSource && e.statistics && this.onCalculationsSource(e.statistics);
                                        b && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                                        var g = {
                                            type: "colorInfo",
                                            minSliderValue: h.isDefined(c.minValue) ? c.minValue : e.statistics.min,
                                            maxSliderValue: h.isDefined(c.maxValue) ? c.maxValue : e.statistics.max,
                                            units: a.units,
                                            startTime: c.startTime.getTime ? c.startTime.getTime() : c.startTime,
                                            endTime: c.endTime.getTime ? c.endTime.getTime() : c.endTime,
                                            field: w.name,
                                            theme: c.theme || "high-to-low"
                                        };
                                        if (this.isMultiAttributesRenderer) {
                                            this.authoringInfo = this.authoringInfo || {};
                                            this.authoringInfo.visualVariables = this.authoringInfo.visualVariables || [];
                                            this.replaceVisualVariable("colorInfo", null, g, this.authoringInfo);
                                            f = this.getVisualVariableByType("colorInfo", null, e.renderer.visualVariables) || null;
                                            this.replaceVisualVariable("colorInfo", null, f, this.renderer);
                                            this.renderer.attributeField = f.field;
                                            this.renderer.valueExpression = f.valueExpression;
                                            if ("esriGeometryPolygon" ===
                                                this.geometryType) {
                                                var g = this.renderer.infos[0],
                                                    n = m.fromJson(g.symbol.toJson());
                                                g.symbol = this.convertFillToMarkerSymbol(n, n.style, n.outline);
                                                this.renderer.clearBreaks();
                                                this.renderer.addBreak(g)
                                            }
                                            e.renderer = this.renderer
                                        } else n = [], this.authoringInfo = this.authoringInfo || {}, this.authoringInfo.visualVariables && (n = this.getVisualVariablesExceptTypes(["sizeInfo", "colorInfo"], this.authoringInfo.visualVariables) || []), n.push(g), this.authoringInfo.visualVariables = n, t && (e.renderer.visualVariables ? e.renderer.setVisualVariables(e.renderer.visualVariables.concat(t)) :
                                            e.renderer.setVisualVariables(t), v && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(v) : v));
                                        e.renderer = this.updateRendererProperties(c, e.renderer);
                                        d.resolve({ renderer: e.renderer, statistics: e.statistics })
                                    }
                                }), g.hitch(this, function(a) { d.isRejected() || (this.handleError(a, "createAgeColorRenderer", !0), d.reject()) }))
                        }), g.hitch(this, function(a) { d.isRejected() || (this.handleError(a, "createAgeColorRenderer.createAgeInfo", !0), d.reject()) }))
                    }), g.hitch(this,
                        function(a) { d.isRejected() || (this.handleError(a, "getPlugin", !0), d.reject()) }))
                },
                applyAgeColorRenderer: function(a, b, c) {
                    b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    (b !== this.getRendererStyle(a) || c) && this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                buildAgeColorInfo: function(a, b) {
                    b = new d;
                    var c = a.attributeItem || this.attributeItem;
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            a.startTime = a.startTime || c.name;
                            a.endTime = a.endTime || new Date;
                            p.createAgeInfo({ layer: this.fLayer || this.layer, startTime: a.startTime, endTime: a.endTime, units: a.units }).then(g.hitch(this,
                                function(d) {
                                    b.isRejected() || p.createColorInfo({ layer: this.fLayer || this.layer, valueExpression: d.valueExpression, sqlExpression: d.statisticsQuery.sqlExpression, sqlWhere: d.statisticsQuery.sqlWhere, legendOptions: d.legendOptions, theme: a.theme || "high-to-low", basemap: this.getBasemapType(), scheme: a.scheme, statistics: a.statistics }).then(g.hitch(this, function(e) {
                                        if (!b.isRejected()) {
                                            var f = {
                                                visualVariables: [{
                                                    type: "colorInfo",
                                                    minSliderValue: h.isDefined(a.minValue) ? a.minValue : e.statistics.min,
                                                    maxSliderValue: h.isDefined(a.maxValue) ?
                                                        a.maxValue : e.statistics.max,
                                                    units: d.units,
                                                    startTime: a.startTime.getTime ? a.startTime.getTime() : a.startTime,
                                                    endTime: a.endTime.getTime ? a.endTime.getTime() : a.endTime,
                                                    field: c.name,
                                                    theme: a.theme || "high-to-low"
                                                }]
                                            };
                                            b.resolve({ colorInfo: e.colorInfo, statistics: e.statistics, authoringInfo: f, scheme: e.scheme })
                                        }
                                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "createColorInfo", !0), b.reject()) }))
                                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "createColorInfo.createAgeInfo", !0), b.reject()) }))
                        }),
                        g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getPlugin", !0), b.reject()) }));
                    return b
                },
                updateThemeOnColorRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    this.scheme = null;
                    var c = this.getRendererDataRange("colorInfo");
                    this.buildAgeColorRenderer(dojo.mixin(a, { minValue: c.min, maxValue: c.max })).then(g.hitch(this, function(c) {
                        b.isRejected() || (this.renderer = c.renderer, this.renderer.authoringInfo = this.authoringInfo, this.disableSliderChangeEvent(), this.updateColorSlider(),
                            c = this.getHandleInfo(a.theme), this.colorSlider && this.colorSlider.set("handles", c.handles), this.colorSlider && this.colorSlider.set("primaryHandle", c.primaryHandle), setTimeout(g.hitch(this, function() { this.enableColorSliderChangeEvent(a) }), 1E3), b.resolve(this.renderer))
                    }), g.hitch(this, function(a) { b.isRejected() || b.reject() }));
                    return b
                },
                getHistogram: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a.startTime = a.startTime || this.attributeItem.name;
                    a.endTime = a.endTime || new Date;
                    this.histogramInfo &&
                        this.histogramInfo.field === a.field && this.histogramInfo.valueExpression === a.valueExpression && this.histogramInfo.startTime === a.startTime && this.histogramInfo.endTime === a.endTime && this.histogramInfo.units === a.units && this.histogramInfo.minValue === a.minValue && this.histogramInfo.maxValue === a.maxValue ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            b.isRejected() || p.createAgeInfo({
                                layer: this.fLayer || this.layer,
                                startTime: a.startTime,
                                endTime: a.endTime,
                                units: a.units
                            }).then(g.hitch(this, function(c) {
                                b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram({ field: a.field, numBins: this.numHistogramBins, classificationMethod: "equal-interval", valueExpression: c.valueExpression, sqlExpression: c.histogramQuery.sqlExpression, sqlWhere: c.histogramQuery.sqlWhere, minValue: a.minValue, maxValue: a.maxValue }).then(g.hitch(this, function(c) {
                                    b.isRejected() || (this.histogramInfo = {
                                        histogram: c,
                                        field: a.field,
                                        valueExpression: a.valueExpression,
                                        startTime: a.startTime,
                                        endTime: a.endTime,
                                        units: a.units,
                                        minValue: a.minValue,
                                        maxValue: a.maxValue
                                    }, b.resolve(c))
                                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram", !1), b.reject()) }))
                            }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram.createAgeInfo", !1), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/AgeSize": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dijit/Tooltip dojo/store/Memory dojo/data/ObjectStore esri/lang esri/styles/basic esri/symbols/jsonUtils esri/renderers/jsonUtils esri/styles/size arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_SizeMixin arcgisonline/map/dijit/renderer/_AgeSizeMixin arcgisonline/map/dijit/renderer/_PredominanceMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_PrecisionMixin arcgisonline/map/dijit/renderer/_SizePanelMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Size.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y) {
            b = b([X, N], {
                declaredClass: "arcgisonline.map.dijit.renderer.AgeSize",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererSize",
                widgetsInTemplate: !0,
                templateString: y,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                sizeRendererGrid: null,
                origGalleryRenderer: null,
                isMultiAttributesRenderer: !1,
                attributeTypeIsDate: !1,
                constructor: function(a, b) {
                    g.mixin(this, K);
                    g.mixin(this, R);
                    g.mixin(this, P);
                    g.mixin(this, O);
                    g.mixin(this, S);
                    g.mixin(this, W);
                    g.mixin(this, U);
                    g.mixin(this, V);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.sizeSlider && this.sizeSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider &&
                        this.transparencySlider.destroy();
                    this.destroySizeRendererGrid();
                    this.destroyTooltips();
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(C.common);
                    g.mixin(this.i18n, C.rendererCommon);
                    g.mixin(this.i18n, C.rendererSizePanel);
                    g.mixin(this.i18n, C.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererSizePanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"),
                        "resize", this, "adjustHeight"));
                    a.connect(this._rendererSizeOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererSizeRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererSizeRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererSizeRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack(this.renderer) : leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererSizeFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererSizeHeader"),
                        "display", "none");
                    t.set(f.byId("rendererSizeDividedBy"), "display", "none");
                    t.set(this._rendererSizeGridDiv, "display", "none");
                    t.set(this._rendererSizeLegendClassesTitle, "display", "none");
                    t.set(this._rendererSizeClassify, "display", "none");
                    t.set(this._rendererSizeOtherCheckMsg, "paddingTop", "20px");
                    t.set(f.byId("rendererAgeSizeMiddleFieldsSection"), "display", "");
                    t.set(f.byId("rendererAgeSizeUnits"), "display", "");
                    var a = new Date;
                    this._rendererAgeSizeFixedDate.set("value", a);
                    this._rendererAgeSizeFixedTime.set("value",
                        a);
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = -1 < dojo.indexOf(["colorAgeSize", "uniqueAgeSize"], this.getRendererStyle(this.renderer));
                    this._rendererSizeLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererSizeLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererSizeField.innerHTML = this.i18n.age;
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    this.attributeTypeIsDate = this.attributeItem && "esriFieldTypeDate" === this.attributeItem.type;
                    this.scheme = null;
                    this.hasDynamic ? t.set(this._rendererSizeTransparency, "display", "none") : this.transparencySlider = this.createTransparencySlider("rendererSizeTransparencySlider");
                    this.createScaleSlider("rendererSizeScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    "esriGeometryPolygon" === this.geometryType ? t.set(this._rendererSizePolygonsTitle, "display",
                        "") : t.set(this._rendererSizePolygonsTitle, "display", "none");
                    a = this.i18n.minSizeInPixels.indexOf("${num}");
                    this._rendererSizeMinPart1.innerHTML = this.i18n.minSizeInPixels.substring(0, a);
                    this._rendererSizeMinPart2.innerHTML = this.i18n.minSizeInPixels.substring(a + 6);
                    a = this.i18n.maxSizeInPixels.indexOf("${num}");
                    this._rendererSizeMaxPart1.innerHTML = this.i18n.maxSizeInPixels.substring(0, a);
                    this._rendererSizeMaxPart2.innerHTML = this.i18n.maxSizeInPixels.substring(a + 6);
                    "esriGeometryPolyline" == this.geometryType ?
                        (this._rendererSizeMin.set("constraints", { min: 0, max: 18, places: 0 }), this._rendererSizeMax.set("constraints", { min: 0, max: 18, places: 0 })) : (this._rendererSizeMin.set("constraints", { min: 1, max: 120, places: 0 }), this._rendererSizeMax.set("constraints", { min: 1, max: 120, places: 0 }));
                    1 < this.countDateFields && this._rendererAgeSizeFieldSelect.setStore(this.attributesStore, this.i18n.fixedDate, { query: "(type:'esriFieldTypeDate' OR type:'fixedDate') AND NOT name:'" + this.attributeItem.name + "'" });
                    !this.hasNumericField || "esriGeometryPoint" !==
                        this.geometryType && "esriGeometryMultipoint" !== this.geometryType ? t.set(this._rendererSizeRotation, "display", "none") : (this._rendererSizeRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" }), t.set(this._rendererSizeRotation, "display", ""));
                    if (this.hasNumericField) {
                        var a =
                            this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererSizeAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererSizeAttributeTransparencyLabel_part3.innerHTML = a.substring(b + 8);
                        var c = this.getOpacityInfo();
                        c && c.field ? c.valueExpression ? this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = this.i18n.predominantPercentage : this.attributesStore.fetchItemByIdentity({
                            identity: c.field,
                            onItem: g.hitch(this, function(a) {
                                c.normalizationField ? this.attributesStore.fetchItemByIdentity({
                                    identity: c.normalizationField,
                                    onItem: g.hitch(this, function(b) { this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: a.alias || a.name, field2: b.alias || b.name }) })
                                }) : this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name
                            })
                        }) : this._rendererSizeAttributeTransparencyLabel_part2.innerHTML = c && c.valueExpression ? this.getRendererCustomExpression(null, "transparency").title : this.i18n.attributeValues
                    } else m(".rendererSizeHasAttributeTransparency").forEach(function(a) {
                        t.set(a,
                            "display", "none")
                    }), w.remove(f.byId("rendererSizeTransparencySliderDiv"), "esriLeadingPadding1");
                    this.updateUIWithRenderer();
                    this.createTooltips();
                    this.tooltips.push(new G({ connectId: this._rendererAgeSizeSwitch, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.switchAttributes + "\x3c/div\x3e" }));
                    this.tooltips.push(new G({ connectId: this._rendererAgeSizeSwitch2, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.switchAttributes + "\x3c/div\x3e" }));
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    var a =
                        this.getRendererStyle(this.renderer);
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    var b = this.getVisualVariableByType("sizeInfo", null, this.authoringInfo.visualVariables);
                    "esriGeometryPolygon" === this.geometryType && (this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ? this.drawTransparentSymbol(this._rendererSizePolygonSymbol) : (this.drawSymbol(this._rendererSizePolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol,
                        this._rendererSizePolygonSymbol)) : (this.renderer.backgroundFillSymbol = J.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererSizePolygonSymbol)));
                    var c = this.getSymbolFromClassedSizeRenderer(this.renderer);
                    this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === c.type ? c : this.switchSizeKeepSymbol(c, 28), null, null, null, 1);
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererSizeOther,
                        "display", ""), this._rendererSizeOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererSizeOther, "display", "none"), this._rendererSizeOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererSizeOtherSymbol) : (this.drawSymbol(this._rendererSizeOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol,
                        this._rendererSizeOtherSymbol));
                    f.byId("rendererAgeSizeTopField").innerHTML = this.attributeItem.alias;
                    f.byId("rendererAgeSizeBottomField").innerHTML = this.attributeItem.alias;
                    "string" === typeof b.startTime && b.startTime === b.field ? (t.set(f.byId("rendererAgeSizeTopFieldsSection"), "display", ""), t.set(f.byId("rendererAgeSizeSwitch2"), "display", "none"), t.set(f.byId("rendererAgeSizeMiddleFieldsToLabel"), "display", "")) : "string" === typeof b.endTime && b.endTime === b.field && (t.set(f.byId("rendererAgeSizeBottomFieldsSection"),
                        "display", ""), t.set(f.byId("rendererAgeSizeSwitch2"), "display", ""), t.set(f.byId("rendererAgeSizeMiddleFieldsFromLabel"), "display", ""));
                    1 < this.countDateFields ? t.set(f.byId("rendererAgeSizeFieldsSelect"), "display", "") : t.set(f.byId("rendererAgeSizeFieldsSelect"), "display", "none");
                    "string" !== typeof b.startTime || "string" !== typeof b.endTime ? (t.set(f.byId("rendererAgeSizeFieldsFixedDateTime"), "display", ""), "string" !== typeof b.startTime ? (this._rendererAgeSizeFixedDate.set("value", new Date(b.startTime)), this._rendererAgeSizeFixedTime.set("value",
                        new Date(b.startTime))) : (this._rendererAgeSizeFixedDate.set("value", new Date(b.endTime)), this._rendererAgeSizeFixedTime.set("value", new Date(b.endTime))), -1 < n.indexOf(["seconds", "minutes", "hours"], b.units) && t.set(f.byId("rendererAgeSizeFieldsFixedTime"), "display", "")) : b.startTime === b.field ? this._rendererAgeSizeFieldSelect.set("value", b.endTime) : this._rendererAgeSizeFieldSelect.set("value", b.startTime);
                    this._rendererAgeSizeUnits.set("value", b.units);
                    "esriGeometryPolygon" !== this.geometryType || "ageSize" !==
                        a && "colorAgeSize" !== a && "uniqueAgeSize" !== a ? (m(".sizingTypes").forEach(function(a) { t.set(a, "display", "none") }), m(".sizingTypes2").forEach(function(a) { w.remove(a, "esriLeadingMargin107") })) : ("object" === typeof this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables).minSize ? (this._rendererSizeAutomaticRadio.set("checked", !0), this.disableSizeInput()) : (this._rendererSizeManualRadio.set("checked", !0), this.enableSizeInput()), m(".sizingTypes").forEach(function(a) { t.set(a, "display", "") }),
                            m(".sizingTypes2").forEach(function(a) { w.add(a, "esriLeadingMargin107") }));
                    t.set(this._rendererSizeInvertTitle, "display", "");
                    this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn;
                    t.set(this._rendererSizeZoomTitle, "display", "");
                    a = this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables);
                    this._rendererSizeMin.set("value", "number" === typeof a.minSize ? Math.min(a.minSize, a.maxSize) : Math.min(a.minSize.stops[1].size, a.maxSize.stops[1].size));
                    this._rendererSizeMax.set("value", "number" ===
                        typeof a.maxSize ? Math.max(a.minSize, a.maxSize) : Math.max(a.minSize.stops[1].size, a.maxSize.stops[1].size));
                    this._rendererSizeClassifyCheck.set("checked", !1);
                    t.set(this._rendererSizeClassifyContent, "display", "none");
                    t.set(this._rendererSizeLegendClassesTitle, "display", "none");
                    this._rendererSizeOtherTxt.innerHTML = this.i18n.drawOthers;
                    t.set(this._rendererSizeRotationEditExpression, "display", "none");
                    t.set(this._rendererSizeRotationFieldDescription, "display", "none");
                    !this.hasNumericField || "esriGeometryPoint" !=
                        this.geometryType && "esriGeometryMultipoint" != this.geometryType || (c = this.getSymbolFromClassedSizeRenderer(this.renderer), this.drawRotationSymbol(c, this._rendererSizeRotateRightSymbol, this._rendererSizeRotateLeftSymbol), a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables), this._rendererSizeRotationCheck.set("checked", a ? !0 : !1), a && (this._rendererSizeRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererSizeRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererSizeRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererSizeRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererSizeRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererSizeRotationEditExpression, "display", ""))), t.set(this._rendererSizeRotationContent, "display", a ? "" : "none"));
                    var d =
                        function(a) {
                            9 > e("ie") ? setTimeout(g.hitch(this, function() {
                                this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                            }), 1E3) : this.createSizeInfoSlider(a).then(g.hitch(this, function() {
                                this.hideBusy();
                                this.adjustHeight()
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        };
                    this.getParams().then(g.hitch(this,
                        function(a) {
                            (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                                (this.fLayer || this.layer).statisticsPlugin.getAgeStatistics({ startTime: a.startTime, endTime: a.endTime, units: a.units }).then(g.hitch(this, function(b) {
                                    a.statistics = this.checkStatistics(b.statistics, !1);
                                    dojo.hitch(this, d, a)()
                                }), g.hitch(this, function(b) {
                                    this.handleError(b, "getAgeStatistics", !1);
                                    dojo.hitch(this, d, a)()
                                }))
                            }), g.hitch(this, function(b) {
                                this.handleError(b, "addPlugin", !1);
                                dojo.hitch(this,
                                    d, a)()
                            }))
                        }));
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                buildNewAgeSizeRenderer: function(a) {
                    this.getParams().then(g.hitch(this, function(b) {
                        "fieldChange" === a ? delete b.units : "dateChange" === a && delete b.units;
                        this.buildAgeSizeRenderer(b).then(g.hitch(this, function(a) {
                            this.hideBusy();
                            this.renderer = a.renderer;
                            this.renderer.authoringInfo = this.authoringInfo;
                            var b = this.getVisualVariableByType("sizeInfo", null, this.authoringInfo.visualVariables);
                            this._rendererAgeSizeUnits.set("value",
                                b.units);
                            this.updateSizeSlider(null, a.statistics);
                            this.applyAgeSizeRenderer(this.renderer)
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                    }))
                },
                updateClassifyInfo: function() {
                    var a = this.getRendererDataRange("sizeInfo");
                    this.hasDynamic || "esriGeometryPolygon" !== this.geometryType || (m(".sizingTypes").forEach(function(a) { t.set(a, "display", "") }), m(".sizingTypes2").forEach(function(a) { w.add(a, "esriLeadingMargin107") }));
                    this.getParams().then(g.hitch(this,
                        function(b) {
                            this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) && (b.minValue = a.min, b.maxValue = a.max);
                            this.buildAgeSizeRenderer(b).then(g.hitch(this, function(a) {
                                var c = a.renderer;
                                a = a.statistics;
                                this.renderer = c;
                                b.statistics = a;
                                a = this.getSymbolFromClassedSizeRenderer(this.renderer);
                                this.drawSymbol(this._rendererSizeSymbol, "simplelinesymbol" === a.type ? a : this.switchSizeKeepSymbol(a, 28), null, null, null, 1);
                                this.updateSizeUI();
                                this.applyAgeSizeRenderer(c);
                                w.remove(this._rendererSizeZoomIcon,
                                    "active");
                                this._rendererSizeZoomLabel.innerHTML = this.i18n.zoomIn;
                                this.createSizeInfoSlider(b).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }))
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererSizeStack", a) }))
                        }))
                },
                _onClickSwitch: function() {
                    this.disableAllEvents || (this.disableAllEvents = !0, "none" !== t.get(f.byId("rendererAgeSizeTopFieldsSection"), "display") ? (t.set(f.byId("rendererAgeSizeBottomFieldsSection"),
                        "display", ""), t.set(f.byId("rendererAgeSizeTopFieldsSection"), "display", "none"), t.set(f.byId("rendererAgeSizeSwitch2"), "display", ""), t.set(f.byId("rendererAgeSizeMiddleFieldsFromLabel"), "display", ""), t.set(f.byId("rendererAgeSizeMiddleFieldsToLabel"), "display", "none")) : (t.set(f.byId("rendererAgeSizeTopFieldsSection"), "display", ""), t.set(f.byId("rendererAgeSizeBottomFieldsSection"), "display", "none"), t.set(f.byId("rendererAgeSizeSwitch2"), "display", "none"), t.set(f.byId("rendererAgeSizeMiddleFieldsToLabel"),
                        "display", ""), t.set(f.byId("rendererAgeSizeMiddleFieldsFromLabel"), "display", "none")), this.buildNewAgeSizeRenderer(), setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3))
                },
                _onClickSwitch2: function() { this._onClickSwitch() },
                _onChangeFieldSelect: function(a) { this.disableAllEvents || ("fixedDate" === a ? t.set(f.byId("rendererAgeSizeFieldsFixedDateTime"), "display", "") : t.set(f.byId("rendererAgeSizeFieldsFixedDateTime"), "display", "none"), this.buildNewAgeSizeRenderer("fieldChange")) },
                _onChangeFixedDate: function() {
                    this.disableAllEvents ||
                        this.buildNewAgeSizeRenderer("dateChange")
                },
                _onChangeFixedTime: function() { this.disableAllEvents || this.buildNewAgeSizeRenderer() },
                _onChangeUnits: function(a) { this.disableAllEvents || (-1 < n.indexOf(["seconds", "minutes", "hours"], a) ? t.set(f.byId("rendererAgeSizeFieldsFixedTime"), "display", "") : t.set(f.byId("rendererAgeSizeFieldsFixedTime"), "display", "none"), this.buildNewAgeSizeRenderer()) },
                _onChangeDividedByAttribute: function() {},
                _onClickLegendClasses: function() {},
                _onChangeClassify: function(a) {},
                _onChangeClassifyMethod: function(a) {},
                _onChangeClassifyClasses: function(a) {},
                _onChangeClassifyStdDevInterval: function() {},
                _onChangeSizePrecision: function() {},
                getParams: function() {
                    var a = new v,
                        b = {};
                    b.showOthers = this._rendererSizeOtherCheck.get("checked");
                    b.symbol = this.getSymbolFromClassedSizeRenderer(this.renderer);
                    b.rotationInfo = this.renderer.rotationInfo;
                    b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                    b.backgroundFillSymbol = this.renderer.backgroundFillSymbol;
                    b.optimizeForScale = this._rendererSizeAutomaticRadio.get("checked") ? "visible-scale-range" : !0;
                    b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                    b.units = this._rendererAgeSizeUnits.get("value");
                    if ("none" !== t.get(f.byId("rendererAgeSizeTopFieldsSection"), "display"))
                        if (b.startTime = this.attributeItem.name, "none" === t.get(f.byId("rendererAgeSizeFieldsSelect"), "display")) b.endTime = this.getFixedDate();
                        else {
                            var c = this._rendererAgeSizeFieldSelect.get("value");
                            b.endTime = "fixedDate" === c ? this.getFixedDate() : this._rendererAgeSizeFieldSelect.get("value")
                        }
                    else b.endTime = this.attributeItem.name, "none" === t.get(f.byId("rendererAgeSizeFieldsSelect"), "display") ? b.startTime = this.getFixedDate() : (c = this._rendererAgeSizeFieldSelect.get("value"), b.startTime = "fixedDate" === c ? this.getFixedDate() : this._rendererAgeSizeFieldSelect.get("value"));
                    a.resolve(b);
                    return a
                },
                getFixedDate: function() {
                    var a = new Date(this._rendererAgeSizeFixedDate.get("value")),
                        b = new Date(this._rendererAgeSizeFixedTime.get("value"));
                    return (new Date(a.getFullYear(), a.getMonth(), a.getDate(), b.getHours(), b.getMinutes(), 0, 0)).getTime()
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererSizeStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererSizeTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererSizeFooter_links")).h + 10;
                        t.set(f.byId("rendererSizeFooterDiv"), "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && t.set(f.byId("renderer-size-content"),
                            "height", a + "px");
                        var g = 60;
                        n.forEach(m(".firstColumnLabel", this.domNode), function(a) { g = Math.max(g, c.coords(a).w) });
                        var h = 40;
                        n.forEach(m(".firstColumnLabelAge", this.domNode), function(a) { h = Math.max(h, c.coords(a).w) });
                        var h = h + 26,
                            g = Math.max(g, h),
                            p = 40;
                        m(".toolsLabel").forEach(function(a) { p = Math.max(p, c.coords(a).w) });
                        m(".toolsColumnTD").style("width", p + 4 + "px");
                        b = c.coords(f.byId("leftContentStackContainer")).w;
                        a = b - g - 40;
                        0 < a && (t.set(this._rendererAgeSizeUnits.domNode, "width", a + "px"), t.set(this._rendererAgeSizeFieldSelect.domNode,
                            "width", a + "px"));
                        a = b - 35;
                        if (0 < a) {
                            b = 0;
                            if ("none" !== t.get(this._rendererSizeRotationEditExpression, "display") || "none" !== t.get(this._rendererSizeRotationFieldDescription, "display")) b = 30;
                            t.set(this._rendererSizeRotationAttribute.domNode, "width", a - b - 21 + "px");
                            m(".dijitSelectLabel", this._rendererSizeRotationAttribute.domNode).style("maxWidth", a - b - 51 + "px");
                            this.transparencySlider && t.set(this.transparencySlider.domNode, "width", a - 30 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", a - 15 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.AgeSize", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_AgeSizeMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom dojo/Deferred dojo/dom-construct dojo/dom-style esri/lang esri/symbols/jsonUtils esri/renderers/smartMapping esri/plugins/FeatureLayerStatistics esri/dijit/SizeInfoSlider esri/dijit/ClassedSizeSlider esri/renderers/SimpleRenderer esri/renderers/ClassBreaksRenderer esri/symbols/SimpleMarkerSymbol esri/layers/FeatureLayer arcgisonline/map/dijit/renderer/SizeGrid".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G) {
            return {
                buildAgeSizeRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildAgeSizeRendererGo(null, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildAgeSizeRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildAgeSizeRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildAgeSizeRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { b.reject() }) })
                        } else this.buildAgeSizeRendererGo(null,
                            a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildAgeSizeRendererGo(null, a, b);
                    return b
                },
                buildAgeSizeRendererGo: function(a, b, c) {
                    var d;
                    this.renderer.visualVariables && "size" === this.getRendererType(this.renderer) && (d = this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), savedAuthVisVars = this.renderer.authoringInfo &&
                        this.getVisualVariablesExceptTypes([{ type: "sizeInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.authoringInfo.visualVariables));
                    var e = b.attributeItem || this.attributeItem;
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        b.startTime = b.startTime || e.name;
                        b.endTime = b.endTime || new Date;
                        p.createAgeInfo({ layer: this.fLayer || this.layer, startTime: b.startTime, endTime: b.endTime, units: b.units }).then(g.hitch(this, function(f) {
                            c.isRejected() || p.createSizeRenderer({
                                layer: this.fLayer ||
                                    this.layer,
                                valueExpression: f.valueExpression,
                                sqlExpression: f.statisticsQuery.sqlExpression,
                                sqlWhere: f.statisticsQuery.sqlWhere,
                                legendOptions: f.legendOptions,
                                basemap: this.getBasemapType(),
                                scheme: this.scheme,
                                optimizeForScale: b.optimizeForScale || "visible-scale-range",
                                optimizeOutline: h.isDefined(b.optimizeOutline) ? b.optimizeOutline : !0,
                                showOthers: !0
                            }).then(g.hitch(this, function(g) {
                                    if (!c.isRejected()) {
                                        g.statistics = this.checkStatistics(g.statistics, !1);
                                        this.scheme = g.scheme;
                                        this.onCalculationsSource && g.statistics &&
                                            this.onCalculationsSource(g.statistics);
                                        a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                                        var m = { type: "sizeInfo", minSliderValue: h.isDefined(b.minValue) ? b.minValue : g.statistics.min, maxSliderValue: h.isDefined(b.maxValue) ? b.maxValue : g.statistics.max, units: f.units, startTime: b.startTime.getTime ? b.startTime.getTime() : b.startTime, endTime: b.endTime.getTime ? b.endTime.getTime() : b.endTime, field: e.name };
                                        if (this.isMultiAttributesRenderer) this.authoringInfo =
                                            this.authoringInfo || {}, this.authoringInfo.visualVariables = this.authoringInfo.visualVariables || [], this.replaceVisualVariable("sizeInfo", null, m, this.authoringInfo), visVar = this.getVisualVariableByType("sizeInfo", null, g.renderer.visualVariables) || null, this.replaceVisualVariable("sizeInfo", null, visVar, this.renderer), this.renderer.authoringInfo = this.authoringInfo, g.renderer = this.renderer;
                                        else {
                                            var n = [];
                                            this.authoringInfo = this.authoringInfo || {};
                                            this.authoringInfo.visualVariables && (n = this.getVisualVariablesExceptTypes(["sizeInfo",
                                                "colorInfo"
                                            ], this.authoringInfo.visualVariables) || []);
                                            n.push(m);
                                            this.authoringInfo.visualVariables = n;
                                            d && (g.renderer.visualVariables ? g.renderer.setVisualVariables(g.renderer.visualVariables.concat(d)) : g.renderer.setVisualVariables(d), savedAuthVisVars && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(savedAuthVisVars) : savedAuthVisVars))
                                        }
                                        g.renderer = this.updateRendererProperties(b, g.renderer);
                                        c.resolve({ renderer: g.renderer, statistics: g.statistics })
                                    }
                                }),
                                g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createAgeColorRenderer", !0), c.reject()) }))
                        }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createAgeColorRenderer.createAgeInfo", !0), c.reject()) }))
                    }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "getPlugin", !0), c.reject()) }))
                },
                buildAgeSizeInfo: function(a, b) {
                    b = new d;
                    var c = a.attributeItem || this.attributeItem;
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        a.startTime =
                            a.startTime || c.name;
                        a.endTime = a.endTime || new Date;
                        p.createAgeInfo({ layer: this.fLayer || this.layer, startTime: a.startTime, endTime: a.endTime, units: a.units }).then(g.hitch(this, function(d) {
                            b.isRejected() || p.createSizeRenderer({
                                layer: this.fLayer || this.layer,
                                valueExpression: d.valueExpression,
                                sqlExpression: d.statisticsQuery.sqlExpression,
                                sqlWhere: d.statisticsQuery.sqlWhere,
                                legendOptions: d.legendOptions,
                                basemap: this.getBasemapType(),
                                scheme: a.scheme,
                                optimizeForScale: a.optimizeForScale || "visible-scale-range",
                                optimizeOutline: h.isDefined(a.optimizeOutline) ? a.optimizeOutline : !0,
                                showOthers: !0
                            }).then(g.hitch(this, function(e) {
                                if (!b.isRejected()) {
                                    e.statistics = this.checkStatistics(e.statistics, !1);
                                    var f = { visualVariables: [{ type: "sizeInfo", minSliderValue: h.isDefined(a.minValue) ? a.minValue : e.statistics.min, maxSliderValue: h.isDefined(a.maxValue) ? a.maxValue : e.statistics.max, units: d.units, startTime: a.startTime.getTime ? a.startTime.getTime() : a.startTime, endTime: a.endTime.getTime ? a.endTime.getTime() : a.endTime, field: c.name }] };
                                    b.resolve({ sizeInfo: this.getVisualVariableByType("sizeInfo", null, e.renderer.visualVariables), backgroundFillSymbol: e.renderer.backgroundFillSymbol, statistics: e.statistics, authoringInfo: f, scheme: e.scheme })
                                }
                            }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "buildAgeSizeInfo.createSizeRenderer", !0), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "buildAgeSizeInfo.createAgeInfo", !0), b.reject()) }))
                    }), g.hitch(this, function(a) {
                        b.isRejected() || (this.handleError(a,
                            "getPlugin", !0), b.reject())
                    }));
                    return b
                },
                applyAgeSizeRenderer: function(a) {
                    a.authoringInfo && (a.authoringInfo.classificationMethod ? a.classificationMethod = a.authoringInfo.classificationMethod : delete a.classificationMethod);
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    this.updateSizeRendererGrid();
                    !this.hasDynamic && b !== this.getRendererStyle(a) && this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value",
                        1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                getHistogram: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a.startTime = a.startTime || this.attributeItem.name;
                    a.endTime = a.endTime || new Date;
                    this.histogramInfo && this.histogramInfo.field ===
                        a.field && this.histogramInfo.valueExpression === a.valueExpression && this.histogramInfo.startTime === a.startTime && this.histogramInfo.endTime === a.endTime && this.histogramInfo.units === a.units && this.histogramInfo.minValue === a.minValue && this.histogramInfo.maxValue === a.maxValue ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            b.isRejected() || p.createAgeInfo({
                                layer: this.fLayer || this.layer,
                                startTime: a.startTime,
                                endTime: a.endTime,
                                units: a.units
                            }).then(g.hitch(this, function(c) {
                                b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram({ field: a.field, numBins: this.numHistogramBins, classificationMethod: "equal-interval", valueExpression: c.valueExpression, sqlExpression: c.histogramQuery.sqlExpression, sqlWhere: c.histogramQuery.sqlWhere, minValue: a.minValue, maxValue: a.maxValue }).then(g.hitch(this, function(c) {
                                    b.isRejected() || (this.histogramInfo = {
                                        histogram: c,
                                        field: a.field,
                                        valueExpression: a.valueExpression,
                                        startTime: a.startTime,
                                        endTime: a.endTime,
                                        units: a.units,
                                        minValue: a.minValue,
                                        maxValue: a.maxValue
                                    }, b.resolve(c))
                                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram", !1), b.reject()) }))
                            }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram.createAgeInfo", !1), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/Predominance": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dijit/TooltipDialog dijit/Tooltip dijit/Dialog dojo/store/Memory dojo/data/ObjectStore esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils esri/styles/type esri/styles/choropleth arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_PredominanceMixin arcgisonline/map/dijit/renderer/UniqueValuesGrid esri/renderers/SimpleRenderer esri/symbols/SimpleLineSymbol arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Predominance.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q) {
            b = b([z, I], {
                declaredClass: "arcgisonline.map.dijit.renderer.Predominance",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererPredominance",
                widgetsInTemplate: !0,
                templateString: Q,
                _rConnects: [],
                _rSubscriptions: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                origGalleryRenderer: null,
                predominanceRendererGrid: null,
                constructor: function(a, b) {
                    g.mixin(this, S);
                    g.mixin(this, U);
                    g.mixin(this, W);
                    g.mixin(this, V);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [], this._rSubscriptions = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyPredominanceRendererGrid();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    n.forEach(this.tooltips,
                        function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    n.forEach(this._rSubscriptions, a.unsubscribe);
                    delete this._rSubscriptions;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(u.common);
                    g.mixin(this.i18n, u.rendererCommon);
                    g.mixin(this.i18n, u.rendererUniqueValuesPanel);
                    g.mixin(this.i18n, u.rendererPredominancePanel);
                    g.mixin(this.i18n, u.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererPredominancePanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    a.connect(this._rendererPredominanceRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererPredominanceRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererPredominanceRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyPredominanceRendererGrid();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideFieldDescriptionPopup();
                    this.hideLegendPopup();
                    this._destroyPredominanceRendererGrid();
                    this.isMultiAttributesRenderer ? (this.portalPanel.updateAttributeDropdownsFromRenderer(this.renderer.authoringInfo.fields), leftPanel.switchToMultiAttributesRendererStack(this.renderer)) :
                        (this.portalPanel.updateAttributeDropdownsFromRenderer(this.renderer.authoringInfo.fields), leftPanel.switchToRendererStack(this.renderer))
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideFieldDescriptionPopup();
                    this.hideLegendPopup();
                    this._destroyPredominanceRendererGrid();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererPredominanceFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererPredominanceHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = "predominancesize" === this.getRendererStyle(this.renderer);
                    this._rendererPredominanceLayer.innerHTML =
                        B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererPredominanceLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererPredominanceField.innerHTML = this.i18n.predominantCategory;
                    this.scheme = null;
                    this.hasDynamic ? t.set(this._rendererPredominanceTransparency, "display", "none") : this.transparencySlider = this.createTransparencySlider("rendererPredominanceTransparencySlider");
                    this.createScaleSlider("rendererPredominanceScaleSlider").then(g.hitch(this,
                        function(a) { this.scaleSlider = a }));
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType ? t.set(this._rendererPredominanceRotation, "display", "none") : (this._rendererPredominanceRotationAttribute.setStore(this.attributesStore, "", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                            this.layer.objectIdField + "'"
                    }), t.set(this._rendererPredominanceRotation, "display", ""));
                    if (this.hasDynamic || this.isGeoRSS || this.isSL || !this.hasNumericField) m(".rendererPredominanceHasAttributeTransparency").forEach(function(a) { t.set(a, "display", "none") }), w.remove(f.byId("rendererPredominanceTransparencySliderDiv"), "esriLeadingPadding1");
                    else {
                        var a = this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererPredominanceAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererPredominanceAttributeTransparencyLabel_part3.innerHTML =
                            a.substring(b + 8);
                        a = this.getOpacityInfo();
                        this._rendererPredominanceAttributeTransparencyLabel_part2.innerHTML = a && a.valueExpression ? this.i18n.predominantPercentage : this.i18n.attributeValues
                    }
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this._buildUniqueValuesList() }), 1);
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    this.defaultInfo = this.renderer.defaultSymbol ? {
                        defaultSymbol: this.renderer.defaultSymbol,
                        defaultLabel: this.renderer.defaultLabel
                    } : { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other };
                    t.set(this._rendererPredominanceRotationEditExpression, "display", "none");
                    t.set(this._rendererPredominanceRotationFieldDescription, "display", "none");
                    if (this.hasNumericField && ("esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType)) {
                        var a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(a, this._rendererPredominanceRotateRightSymbol, this._rendererPredominanceRotateLeftSymbol);
                        a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables);
                        this._rendererPredominanceRotationCheck.set("checked", a ? !0 : !1);
                        a && (this._rendererPredominanceRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererPredominanceRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType &&
                            "arithmetic" !== a.type)), a.field ? (this._rendererPredominanceRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererPredominanceRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererPredominanceRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererPredominanceRotationEditExpression, "display", "")));
                        t.set(this._rendererPredominanceRotationContent, "display", a ? "" : "none")
                    }
                    this.adjustHeight();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                wrapTooltipText: function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" },
                createTooltips: function() {
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceTransparencyTitle, label: this.wrapTooltipText(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceScaleTitle, label: this.wrapTooltipText(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new F({
                        connectId: this._rendererPredominanceScaleSuggest,
                        label: this.wrapTooltipText(this.i18n.suggestTooltip)
                    }));
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceRotationText, label: this.wrapTooltipText(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceRotationAttribute.domNode, label: this.wrapTooltipText(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceRotationEditExpression, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this.tooltips.push(new F({ connectId: this._rendererPredominanceRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                onReorder: function(a, b) {
                    var c = this.renderer.rotationInfo,
                        d = this.renderer.visualVariables;
                    b = this.reorderPredominantCategoryInfos(a, b);
                    b.setRotationInfo(c);
                    this.removeRotationInfoVisualVariable(b);
                    d && d.length && b.setVisualVariables(d);
                    this.authoringInfo.fields = dojo.map(a, function(a) { return a.value });
                    this.applyPredominanceRenderer(b);
                    this._updatePredominanceRendererGrid(b)
                },
                onUpdateInfo: function(a, b) {
                    if (!J.isDefined(a.value) && this.renderer.defaultSymbol) this.renderer.defaultLabel = a.label;
                    else if (J.isDefined(a.value)) {
                        var c = [];
                        n.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                        n.forEach(c, function(a) { this.renderer.removeValue(a.value) }, this);
                        n.forEach(c, function(c) {
                            a.value === c.value ? this.renderer.addValue({ value: c.value, symbol: a.symbol, label: a.label }) : this.renderer.addValue({
                                value: c.value,
                                symbol: b ? this.setOutlineWidthOfSymbol(c.symbol,
                                    1) : c.symbol,
                                label: c.label
                            })
                        }, this)
                    }
                    if (this.hasNumericField && ("esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType)) {
                        var d = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(d, this._rendererPredominanceRotateRightSymbol, this._rendererPredominanceRotateLeftSymbol)
                    }
                    this.updatePredominanceRenderer(b);
                    this._updatePredominanceRendererGrid(this.renderer)
                },
                onUpdateDefault: function(a,
                    b) {
                    a ? (this.renderer.defaultSymbol = a.symbol, this.renderer.defaultLabel = a.label) : (delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel);
                    this.updatePredominanceRenderer(b);
                    this._updatePredominanceRendererGrid(this.renderer)
                },
                onUpdateSymbols: function(a, b, c) {
                    this.scheme = b || this.scheme;
                    this.updatePredominanceRenderer(c);
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || (a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol :
                        this.getDefaultSymbol(this.geometryType), this.drawRotationSymbol(a, this._rendererPredominanceRotateRightSymbol, this._rendererPredominanceRotateLeftSymbol));
                    this._updatePredominanceRendererGrid(this.renderer)
                },
                _onChangeRotation: function(a) { this.disableAllEvents || (t.set(this._rendererPredominanceRotationContent, "display", a ? "" : "none"), this.adjustHeight(), this.updateRotationInfo()) },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) {
                    this.disableAllEvents ||
                        a && this.updateRotationInfo()
                },
                updateRotationInfo: function() {
                    if (this._rendererPredominanceRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererPredominanceRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b = a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererPredominanceRotationAttribute.setStore(this.attributesStore, "", {
                                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                                            this.layer.objectIdField + "'"
                                    });
                                    this._rendererPredominanceRotationAttribute.set("value", "customExprRotation", !1);
                                    a = { valueExpression: a.valueExpression, valueExpressionTitle: a.valueExpressionTitle, rotationType: this._rendererPredominanceRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                    this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.setVisualVariables(c);
                                    this.applyPredominanceRenderer(this.renderer);
                                    this.updateUIWithRenderer()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", d.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo();
                                    this.updateUIWithRenderer()
                                }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                            })
                        });
                        else {
                            t.set(this._rendererPredominanceRotationEditExpression, "display", "none");
                            var a = { field: this._rendererPredominanceRotationAttribute.get("value"), type: this._rendererPredominanceRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic" };
                            this.getAttributeItemFromStore(this._rendererPredominanceRotationAttribute.get("value")).then(g.hitch(this, function(a) {
                                a && a.descriptionValue ? t.set(this._rendererPredominanceRotationFieldDescription, "display", "") : t.set(this._rendererPredominanceRotationFieldDescription,
                                    "display", "none")
                            }));
                            this.renderer.setRotationInfo(a);
                            this.removeRotationInfoVisualVariable();
                            this.applyPredominanceRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null), this.removeRotationInfoVisualVariable(), this.applyPredominanceRenderer(this.renderer), this.adjustHeight()
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                _buildUniqueValuesList: function() {
                    this.predominantCategoryInfos ? this._updatePredominanceRendererGrid() : this.getPredominantCategoryInfos().then(g.hitch(this,
                        function() {
                            this.hideBusy();
                            this._updatePredominanceRendererGrid()
                        }), g.hitch(this, function(a) {}), g.hitch(this, function(a) { this.showBusy("rendererPredominanceStack", a) }))
                },
                _updatePredominanceRendererGrid: function(b) {
                    b = b || this.renderer;
                    this.predominanceRendererGrid ? this.predominanceRendererGrid.updateGrid(b) : (this.predominanceRendererGrid = new C({
                        id: "predominanceGrid",
                        renderer: b,
                        defaultInfo: this.defaultInfo,
                        allUniqueValues: this.predominantCategoryInfos,
                        style: "position: relative; width: 100%; height:100%; overflow-y:hidden; overflow-x:hidden; padding:0;",
                        params: this.params
                    }, "predominanceGrid"), n.forEach(this._rSubscriptions, a.unsubscribe), delete this._rSubscriptions, this._rSubscriptions.push(a.subscribe("onReorderUniqueValues", g.hitch(this, "onReorder"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValue", g.hitch(this, "onUpdateInfo"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValueDefault", g.hitch(this, "onUpdateDefault"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValueSymbols", g.hitch(this, "onUpdateSymbols"))));
                    this.adjustHeight()
                },
                _destroyPredominanceRendererGrid: function() { this.predominanceRendererGrid && (n.forEach(this._rSubscriptions, a.unsubscribe), delete this._rSubscriptions, this.predominanceRendererGrid.destroy(), this.predominanceRendererGrid = null, f.byId("predominanceGrid") || x.create("div", { id: "predominanceGrid" }, f.byId("predominanceGridDiv"))) },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg = (new D({
                        id: "attributeTransparencyDlg",
                        style: "visibility:hidden;"
                    })).placeAt(document.body);
                    this.attributeTransparencyDlgContent = new y({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler = a.connect(this.attributeTransparencyDlg, "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new q({
                        attributesStore: this.attributesStore,
                        layer: this.fLayer || this.layer,
                        mapLayer: this.mapLayer,
                        showDateFields: this.showDateFields,
                        numHistogramBins: this.numHistogramBins,
                        savedRenderers: this.savedRenderers
                    }, "attributeTransparencyDlgContent");
                    this.attributeTransparencyDlg.set({ title: this.i18n.attributeTransparencyDlgTitleForPredominance, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler = a.subscribe("attribute-transparency-commit", g.hitch(this, function(a) {
                        this.hideAttributeTransparencyDlg();
                        a.opacityInfo && (this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo =
                            g.clone(a.authoringInfo), this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyPredominanceRenderer(this.renderer), this._rendererPredominanceAttributeTransparencyLabel_part2.innerHTML = this.i18n.predominantPercentage)
                    }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() { t.set(this.attributeTransparencyDlg.domNode, "visibility", "visible") }))
                },
                hideAttributeTransparencyDlg: function() { this.attributeTransparencyDlg && this.attributeTransparencyDlg.hide() },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler && a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency && this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    E.byId("attributeTransparencyDlg") && E.byId("attributeTransparencyDlg").destroy()
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel &&
                        "rendererPredominanceStack" === leftPanel.visibleStack) {
                        t.set(f.byId("renderer-predominance-bottom"), "overflowY", "none");
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererPredominanceHeader")).h,
                            d = c.coords(this._rendererPredominanceTop.domNode).h,
                            e = c.coords(f.byId("predominanceGridText")).h;
                        t.set(f.byId("predominanceGridDiv"), "height", "0px");
                        var g = f.byId("renderer-predominance-bottom").scrollHeight,
                            h = c.coords(f.byId("rendererPredominanceContentClose")).h,
                            n = c.coords(f.byId("rendererPredominanceFooter_links")).h +
                            10;
                        t.set(f.byId("rendererPredominanceFooterDiv"), "height", n + "px");
                        g = a - b - d - e - g - h - n - 13;
                        250 < g ? (t.set(f.byId("predominanceGridDiv"), "height", g + "px"), a = a - b - d - e - g - h - n - 27) : (t.set(f.byId("predominanceGridDiv"), "height", "250px"), a = a - b - d - e - 250 - h - n - 27);
                        t.set(f.byId("renderer-predominance-bottom"), "height", a + "px");
                        newWidth = c.coords(f.byId("leftContentStackContainer")).w - 16;
                        if (0 < newWidth) {
                            t.set(f.byId("predominanceGridDiv"), "width", newWidth + "px");
                            this.predominanceRendererGrid && this.predominanceRendererGrid.resize();
                            60 >= g && (newWidth -= 30);
                            a = 0;
                            if ("none" !== t.get(this._rendererPredominanceRotationEditExpression, "display") || "none" !== t.get(this._rendererPredominanceRotationFieldDescription, "display")) a = 30;
                            t.set(this._rendererPredominanceRotationAttribute.domNode, "width", newWidth - a - 40 + "px");
                            m(".dijitSelectLabel", this._rendererPredominanceRotationAttribute.domNode).style("maxWidth", newWidth - a - 70 + "px");
                            this.transparencySlider && t.set(this.transparencySlider.domNode, "width", this.hasDynamic ? newWidth - 30 : newWidth - 52 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", newWidth - 30 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Predominance", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/Relationship": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dijit/TooltipDialog dijit/Tooltip dijit/Dialog dojo/store/Memory dojo/data/ObjectStore esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils esri/styles/size esri/styles/relationship arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RelationshipMixin arcgisonline/map/dijit/renderer/UniqueValuesGrid esri/renderers/SimpleRenderer esri/symbols/SimpleLineSymbol arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Relationship.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q) {
            b = b([z, I], {
                declaredClass: "arcgisonline.map.dijit.renderer.Relationship",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererRelationship",
                widgetsInTemplate: !0,
                templateString: Q,
                _rConnects: [],
                _rSubscriptions: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                origGalleryRenderer: null,
                constructor: function(a,
                    b) {
                    g.mixin(this, S);
                    g.mixin(this, U);
                    g.mixin(this, W);
                    g.mixin(this, V);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [], this._rSubscriptions = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this._destroyRelationshipRendererGrid();
                    this.colorSlider && this.colorSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    n.forEach(this._rSubscriptions, a.unsubscribe);
                    delete this._rSubscriptions;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(u.common);
                    g.mixin(this.i18n, u.rendererCommon);
                    g.mixin(this.i18n, u.rendererUniqueValuesPanel);
                    g.mixin(this.i18n, u.rendererRelationshipPanel);
                    g.mixin(this.i18n, u.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererRelationshipPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    a.connect(this._rendererRelationshipOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererRelationshipRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererRelationshipRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererRelationshipRotationAttribute));
                    a.connect(this._rendererRelationshipDividedByField1Description, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererRelationshipDividedByField1Attribute));
                    a.connect(this._rendererRelationshipDividedByField2Description, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererRelationshipDividedByField2Attribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    a = [this.renderer.authoringInfo.field1.field, this.renderer.authoringInfo.field2.field];
                    this.isMultiAttributesRenderer ? (this.portalPanel.updateAttributeDropdownsFromRenderer(a), leftPanel.switchToMultiAttributesRendererStack(this.renderer)) : (this.portalPanel.updateAttributeDropdownsFromRenderer(a), leftPanel.switchToRendererStack(this.renderer))
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isMultiAttributesRenderer ? leftPanel.switchToMultiAttributesRendererStack() : leftPanel.switchToRendererStack()
                },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererRelationshipFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded &&
                        isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererRelationshipHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this.isMultiAttributesRenderer = "relationshipSize" === this.getRendererStyle(this.renderer);
                    this._rendererRelationshipLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name && (this._rendererRelationshipLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererRelationshipField.innerHTML =
                        this.i18n.relationship;
                    this.scheme = null;
                    this.hasDynamic ? t.set(this._rendererRelationshipTransparency, "display", "none") : this.transparencySlider = this.createTransparencySlider("rendererRelationshipTransparencySlider");
                    this.createScaleSlider("rendererRelationshipScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    this._rendererRelationshipDividedByField1Attribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" +
                            this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem.name + "'"
                    });
                    this._rendererRelationshipDividedByField2Attribute.setStore(this.attributesStore, "_" + this.i18n.none + "_", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'none') AND NOT name:'" + this.layer.objectIdField + "' AND NOT name:'" + this.attributeItem2.name + "'" });
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" !=
                        this.geometryType ? t.set(this._rendererRelationshipRotation, "display", "none") : (this._rendererRelationshipRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" }), t.set(this._rendererRelationshipRotation, "display", ""));
                    if (this.hasDynamic || this.isGeoRSS ||
                        this.isSL || !this.hasNumericField) m(".rendererRelationshipHasAttributeTransparency").forEach(function(a) { t.set(a, "display", "none") }), w.remove(f.byId("rendererRelationshipTransparencySliderDiv"), "esriLeadingPadding1");
                    else {
                        var a = this.i18n.setFromField,
                            b = a.indexOf("${field}");
                        this._rendererRelationshipAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererRelationshipAttributeTransparencyLabel_part3.innerHTML = a.substring(b + 8);
                        a = this.getOpacityInfo();
                        this._rendererRelationshipAttributeTransparencyLabel_part2.innerHTML =
                            a && a.valueExpression ? this.i18n.relationshipPercentage : this.i18n.attributeValues
                    }
                    this._fillRendererRelationshipFocus();
                    this._fillRendererRelationshipClassifications();
                    this._fillRendererRelationshipGridsize();
                    this.updateUIWithRenderer();
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    this._rendererRelationshipField1Label.innerHTML = this.attributeItem.displayName;
                    this._rendererRelationshipField2Label.innerHTML =
                        this.attributeItem2.displayName;
                    this.authoringInfo.field1.normalizationField && this._rendererRelationshipDividedByField1Attribute.set("value", this.authoringInfo.field1.normalizationField);
                    this.authoringInfo.field2.normalizationField && this._rendererRelationshipDividedByField2Attribute.set("value", this.authoringInfo.field2.normalizationField);
                    this.getAttributeItemFromStore(this._rendererRelationshipDividedByField1Attribute.get("value")).then(g.hitch(this, function(a) {
                        a && a.descriptionValue ? t.set(this._rendererRelationshipDividedByField1Description,
                            "display", "") : t.set(this._rendererRelationshipDividedByField1Description, "display", "none")
                    }));
                    this.getAttributeItemFromStore(this._rendererRelationshipDividedByField2Attribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererRelationshipDividedByField2Description, "display", "") : t.set(this._rendererRelationshipDividedByField2Description, "display", "none") }));
                    "esriGeometryPolygon" === this.geometryType && "relationshipSize" === this.getRendererStyle(this.renderer) && (this.renderer.backgroundFillSymbol ?
                        this.isSymbolTransparent(this.renderer.backgroundFillSymbol) ? (this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol), this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol2)) : (this.drawSymbol(this._rendererRelationshipPolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.drawSymbol(this._rendererRelationshipPolygonSymbol2, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererRelationshipPolygonSymbol),
                            this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererRelationshipPolygonSymbol2)) : (this.renderer.backgroundFillSymbol = K.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol), this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol2)), t.set(this._rendererRelationshipPolygonsTitle, "display", ""), t.set(this._rendererRelationshipPolygonsTitle2, "display", ""));
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererRelationshipOther, "display", ""), this._rendererRelationshipOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererRelationshipOther, "display", "none"), this._rendererRelationshipOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererRelationshipOtherSymbol) :
                        (this.drawSymbol(this._rendererRelationshipOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererRelationshipOtherSymbol));
                    t.set(this._rendererRelationshipRotationEditExpression, "display", "none");
                    t.set(this._rendererRelationshipRotationFieldDescription, "display", "none");
                    if (this.hasNumericField && ("esriGeometryPoint" === this.geometryType || "esriGeometryMultipoint" === this.geometryType)) {
                        var a = this.renderer.infos && this.renderer.infos.length ?
                            this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(a, this._rendererRelationshipRotateRightSymbol, this._rendererRelationshipRotateLeftSymbol);
                        a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables);
                        this._rendererRelationshipRotationCheck.set("checked", a ? !0 : !1);
                        a && (this._rendererRelationshipRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererRelationshipRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererRelationshipRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && t.set(this._rendererRelationshipRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererRelationshipRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererRelationshipRotationEditExpression, "display", "")));
                        t.set(this._rendererRelationshipRotationContent,
                            "display", a ? "" : "none")
                    }
                    this.getParams().then(g.hitch(this, function(a) {
                        this.createColorInfoSliders(a).then(g.hitch(this, function() {
                            this.hideBusy();
                            this.adjustHeight()
                        }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererRelationshipStack", a) }))
                    }));
                    this.adjustHeight();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                wrapTooltipText: function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" },
                createTooltips: function() {
                    this.tooltips.push(new F({
                        connectId: this._rendererRelationshipTransparencyTitle,
                        label: this.wrapTooltipText(this.i18n.transparencyTooltip)
                    }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipScaleTitle, label: this.wrapTooltipText(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipScaleSuggest, label: this.wrapTooltipText(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipRotationText, label: this.wrapTooltipText(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new F({
                        connectId: this._rendererRelationshipRotationAttribute.domNode,
                        label: this.wrapTooltipText(this.i18n.rotationFieldTooltip)
                    }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipLegendClassesTitle.domNode, label: this.wrapTooltipText(this.i18n.legendTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipLegendClassesTitle2.domNode, label: this.wrapTooltipText(this.i18n.classesTooltip) }));
                    this.tooltips.push(new F({
                        connectId: this._rendererRelationshipRotationEditExpression,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression +
                            "\x3c/div\x3e"
                    }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipDividedByField1Description, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this.tooltips.push(new F({ connectId: this._rendererRelationshipDividedByField2Description, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }));
                    this.tooltips.push(new F({
                        connectId: this._rendererRelationshipRotationFieldDescription,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" +
                            this.i18n.showDescription + "\x3c/div\x3e"
                    }))
                },
                _onToggleField1: function() {
                    -1 < this._rendererRelationshipField1LabelCheck.className.indexOf("subSectionClosed") ? (w.remove(this._rendererRelationshipField1LabelCheck, "subSectionClosed"), w.add(this._rendererRelationshipField1LabelCheck, "subSectionOpen"), t.set(this._rendererRelationshipField1, "display", "")) : (w.add(this._rendererRelationshipField1LabelCheck, "subSectionClosed"), w.remove(this._rendererRelationshipField1LabelCheck, "subSectionOpen"), t.set(this._rendererRelationshipField1,
                        "display", "none"))
                },
                _onToggleField2: function() {
                    -1 < this._rendererRelationshipField2LabelCheck.className.indexOf("subSectionClosed") ? (w.remove(this._rendererRelationshipField2LabelCheck, "subSectionClosed"), w.add(this._rendererRelationshipField2LabelCheck, "subSectionOpen"), t.set(this._rendererRelationshipField2, "display", "")) : (w.add(this._rendererRelationshipField2LabelCheck, "subSectionClosed"), w.remove(this._rendererRelationshipField2LabelCheck, "subSectionOpen"), t.set(this._rendererRelationshipField2,
                        "display", "none"))
                },
                _onChangeDividedByAttribute: function() {
                    this.disableAllEvents || (this.getAttributeItemFromStore(this._rendererRelationshipDividedByField1Attribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererRelationshipDividedByField1Description, "display", "") : t.set(this._rendererRelationshipDividedByField1Description, "display", "none") })), this.getAttributeItemFromStore(this._rendererRelationshipDividedByField2Attribute.get("value")).then(g.hitch(this, function(a) {
                        a &&
                            a.descriptionValue ? t.set(this._rendererRelationshipDividedByField2Description, "display", "") : t.set(this._rendererRelationshipDividedByField2Description, "display", "none")
                    })), this.adjustHeight(), this.getParams().then(g.hitch(this, function(a) {
                        this.buildRelationshipRenderer(a).then(g.hitch(this, function(b) {
                                this.renderer = b.renderer;
                                this.applyRelationshipRenderer(this.renderer, { scheme: this.scheme });
                                this.createColorInfoSliders(a).then(g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function() { this.hideBusy() }))
                            }),
                            g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererRelationshipStack", a) }))
                    })))
                },
                onReorder: function(a, b) {
                    var c = this.renderer.rotationInfo,
                        d = this.renderer.visualVariables;
                    b = this.reorderRelationshipCategoryInfos(a, b);
                    b.setRotationInfo(c);
                    this.removeRotationInfoVisualVariable(b);
                    d && d.length && b.setVisualVariables(d);
                    this.authoringInfo.fields = dojo.map(a, function(a) { return a.value });
                    this.applyRelationshipRenderer(b);
                    this._updateRelationshipRendererGrid(b)
                },
                onUpdateInfo: function(a,
                    b) {
                    if (!J.isDefined(a.value) && this.renderer.defaultSymbol) this.renderer.defaultLabel = a.label;
                    else if (J.isDefined(a.value)) {
                        var c = [];
                        n.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                        n.forEach(c, function(a) { this.renderer.removeValue(a.value) }, this);
                        n.forEach(c, function(c) { a.value === c.value ? this.renderer.addValue({ value: c.value, symbol: a.symbol, label: a.label }) : this.renderer.addValue({ value: c.value, symbol: b ? this.setOutlineWidthOfSymbol(c.symbol, 1) : c.symbol, label: c.label }) }, this)
                    }
                    if (this.hasNumericField &&
                        ("esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType)) {
                        var d = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(d, this._rendererRelationshipRotateRightSymbol, this._rendererRelationshipRotateLeftSymbol)
                    }
                    this.updateRelationshipRenderer(b);
                    this._updateRelationshipRendererGrid(this.renderer)
                },
                onUpdateDefault: function(a, b) {
                    a ? (this.renderer.defaultSymbol = a.symbol, this.renderer.defaultLabel =
                        a.label) : (delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel);
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererRelationshipOther, "display", ""), this._rendererRelationshipOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererRelationshipOther, "display", "none"), this._rendererRelationshipOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererRelationshipOtherSymbol) : (this.drawSymbol(this._rendererRelationshipOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererRelationshipOtherSymbol));
                    this.updateRelationshipRenderer(b);
                    this._updateRelationshipRendererGrid(this.renderer)
                },
                _onChangeRelationshipFocus: function() {
                    if (!this.disableAllEvents) {
                        var a = { focus: this._rendererRelationshipFocus.get("value") };
                        this.updateRelationshipRendererBreaks(a);
                        this.applyRelationshipRenderer(this.renderer)
                    }
                },
                _onChangeRelationshipGridsize: function() { this.disableAllEvents || (this._rendererRelationshipClassifyMethods.get("value") === this.i18n.classifyManualBreaks && this._rendererRelationshipClassifyMethods.set("value", this.i18n.classifyQuantile, !1), this.recreateRenderer().then(null, g.hitch(this, function() { this._rendererRelationshipGridsize.set("value", this.renderer.authoringInfo.numClasses, !1) }))) },
                _onChangeRelationshipClassifyMethod: function() {
                    this.disableAllEvents ||
                        this._rendererRelationshipClassifyMethods.get("value") !== this.i18n.classifyManualBreaks && this.recreateRenderer()
                },
                _onClickSymbols: function(a, b) {
                    a = R.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPolygon" === this.geometryType ? "esriGeometryPoint" : this.geometryType });
                    this.scheme = this.scheme || this.findRelationshipScheme(this.renderer, "default");
                    b = this.getSymbolFromRelationshipRenderer(this.renderer);
                    for (var c = [], d = !1, e = 0; e < this.renderer.infos.length; e++) "picturemarkersymbol" !==
                        this.renderer.infos[e].symbol.type && (d = !0), c.push(this.getSymbolColor(this.renderer.infos[e].symbol));
                    if (!d) c = g.clone(a.primaryScheme.colors), b = this.getDefaultSymbol(this.geometryType);
                    else if ("picturemarkersymbol" === b.type) {
                        for (e = 1; e < this.renderer.infos.length; e++)
                            if ("picturemarkersymbol" !== this.renderer.infos[e].symbol.type) { b = this.renderer.infos[e].symbol; break }
                            "picturemarkersymbol" === b.type && (b = this.getDefaultSymbol(this.geometryType))
                    }
                    d = null;
                    this.isMultiAttributesRenderer && (d = { symbolDisplayMode: "default" });
                    this.showSymbolStyler(b, { externalSizing: "relationshipSize" === this.getRendererStyle(this.renderer) ? !0 : !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: a, tabOptions: d, colorRamp: { colors: c, numStops: this.authoringInfo.numClasses, scheme: this.scheme } }, g.hitch(this, "onSymbolsChange"))
                },
                onSymbolsChange: function(a, b, c, d) {
                    if (a && b) {
                        this.scheme = c || this.scheme;
                        var e = a.toJson();
                        "esriPMS" != a.type || 0 != e.url.length && "http://" != e.url || (a = K.fromJson(this.getMarkerJson()));
                        c = {
                            colors: n.filter(c.colorsForClassBreaks,
                                function(a) { return a.numClasses === this.authoringInfo.numClasses }, this)[0].colors,
                            focus: this.authoringInfo.focus
                        };
                        if (1 !== b[0].a) {
                            var f = b[0].a;
                            n.forEach(c.colors, function(a) { n.forEach(a, function(a) { a.a = f }) })
                        }
                        this.updateRelationshipRendererBreaks(c);
                        var h = [];
                        n.forEach(this.renderer.infos, function(a) { h.push(g.clone(a)) });
                        n.forEach(h, function(a) { this.renderer.removeValue(a.value) }, this);
                        n.forEach(h, function(b) {
                            var c = K.fromJson(a.toJson()),
                                c = this.switchSymbolKeepColor(c, b.symbol);
                            this.renderer.addValue({
                                value: b.value,
                                symbol: d ? this.setOutlineWidthOfSymbol(c, 1) : c,
                                label: b.label
                            })
                        }, this);
                        !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || (b = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType), this.drawRotationSymbol(b, this._rendererRelationshipRotateRightSymbol, this._rendererRelationshipRotateLeftSymbol));
                        this.colorSliderField1.set("breakInfos", this.addSymbolsToBreakInfos(g.clone(this.renderer.authoringInfo.field1.classBreakInfos)));
                        this.colorSliderField2.set("breakInfos", this.addSymbolsToBreakInfos(g.clone(this.renderer.authoringInfo.field2.classBreakInfos)));
                        this.updateRelationshipRenderer(d);
                        this._updateRelationshipRendererGrid(this.renderer)
                    }
                },
                _onClickPolygons: function(a, b) {
                    a = O.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.renderer.backgroundFillSymbol, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: a },
                        g.hitch(this, "onPolygonSymbolChange"))
                },
                onPolygonSymbolChange: function(a, b, c, d) {
                    this.renderer.backgroundFillSymbol = K.fromJson(a.toJson());
                    this.renderer.backgroundFillSymbol ? this.isSymbolTransparent(this.renderer.backgroundFillSymbol) || (this.drawSymbol(this._rendererRelationshipPolygonSymbol, this.renderer.backgroundFillSymbol, null, null, null, 1), this.drawSymbol(this._rendererRelationshipPolygonSymbol2, this.renderer.backgroundFillSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol,
                        this._rendererRelationshipPolygonSymbol), this.updateBackgroundForAlmostWhite(this.renderer.backgroundFillSymbol, this._rendererRelationshipPolygonSymbol2)) : (this.renderer.backgroundFillSymbol = K.fromJson(this.transparentPolygonSymbolJson), this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol), this.drawTransparentSymbol(this._rendererRelationshipPolygonSymbol2));
                    this.updateRelationshipRenderer(d)
                },
                _onChangeOther: function(a) {
                    this.disableAllEvents || (a ? (t.set(this._rendererRelationshipOther,
                        "display", ""), this.renderer.defaultSymbol = this.defaultInfo.defaultSymbol, this.renderer.defaultLabel = this.defaultInfo.defaultLabel) : (t.set(this._rendererRelationshipOther, "display", "none"), delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel), this.applyRelationshipRenderer(this.renderer))
                },
                onClickOtherSymbol: function(a, b) {
                    b = O.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.defaultInfo.defaultSymbol, {
                        externalSizing: !1,
                        optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                        schemes: b
                    }, g.hitch(this, "onOtherSymbolChange", a))
                },
                onOtherSymbolChange: function(a, b, c, d, e) {
                    a = b.toJson();
                    "esriPMS" !== b.type || 0 !== a.url.length && "http://" !== a.url || (b = K.fromJson(this.getMarkerJson()));
                    this.defaultInfo.defaultSymbol = b;
                    this.renderer.defaultSymbol ? (this.renderer.defaultSymbol = K.fromJson(b.toJson()), t.set(this._rendererRelationshipOther, "display", ""), this._rendererRelationshipOtherCheck.set("checked", !0)) : (t.set(this._rendererRelationshipOther,
                        "display", "none"), this._rendererRelationshipOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererRelationshipOtherSymbol) : (this.drawSymbol(this._rendererRelationshipOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererRelationshipOtherSymbol));
                    this._updateRelationshipRendererGrid(this.renderer);
                    this.updateRelationshipRenderer(e);
                    this.adjustHeight()
                },
                _onClickLegendClasses: function() {
                    "none" === t.get(f.byId("renderer-relationship-content"), "display") ? (t.set(f.byId("renderer-relationship-content"), "display", ""), t.set(f.byId("renderer-relationship-legend-content"), "display", "none"), t.set(this._rendererRelationshipOtherDiv, "display", "")) : (t.set(f.byId("renderer-relationship-content"), "display", "none"), t.set(f.byId("renderer-relationship-legend-content"), "display", ""), t.set(this._rendererRelationshipOtherDiv, "display", "none"), this._updateRelationshipRendererGrid(this.renderer));
                    this.adjustHeight()
                },
                onColorSliderChange: function(a) {
                    this.disableAllEvents = !0;
                    this.authoringInfo && delete this.authoringInfo.classificationMethod;
                    this.renderer.authoringInfo && delete this.renderer.authoringInfo.classificationMethod;
                    this.renderer.classificationMethod = null;
                    this._rendererRelationshipClassifyMethods.set("value", this.getClassificationMethod(null));
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                _onChangeRotation: function(a) {
                    this.disableAllEvents || (t.set(this._rendererRelationshipRotationContent,
                        "display", a ? "" : "none"), this.adjustHeight(), this.updateRotationInfo())
                },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererRelationshipRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererRelationshipRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this,
                                function(a) {
                                    var b = a;
                                    a = this.clean(a);
                                    if (a.valueExpression) {
                                        this.disableAllEvents = !0;
                                        this._rendererRelationshipRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                                        this._rendererRelationshipRotationAttribute.set("value", "customExprRotation", !1);
                                        a = {
                                            valueExpression: a.valueExpression,
                                            valueExpressionTitle: a.valueExpressionTitle,
                                            rotationType: this._rendererRelationshipRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic",
                                            type: "rotationInfo"
                                        };
                                        this.renderer.setRotationInfo(null);
                                        var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                        c.push(a);
                                        this.renderer.setVisualVariables(c);
                                        this.applyRelationshipRenderer(this.renderer);
                                        this.updateUIWithRenderer()
                                    } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                        this.attributesStore.setValue(b,
                                            "valueExpression", a.expression);
                                        this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                        this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                        this.attributesStore.setValue(b, "displayName", d.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                        this.updateRotationInfo();
                                        this.updateUIWithRenderer()
                                    }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                                })
                        });
                        else {
                            t.set(this._rendererRelationshipRotationEditExpression, "display", "none");
                            var a = {
                                field: this._rendererRelationshipRotationAttribute.get("value"),
                                type: this._rendererRelationshipRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic"
                            };
                            this.getAttributeItemFromStore(this._rendererRelationshipRotationAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererRelationshipRotationFieldDescription, "display", "") : t.set(this._rendererRelationshipRotationFieldDescription, "display", "none") }));
                            this.renderer.setRotationInfo(a);
                            this.removeRotationInfoVisualVariable();
                            this.applyRelationshipRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null), this.removeRotationInfoVisualVariable(), this.applyRelationshipRenderer(this.renderer), this.adjustHeight()
                },
                _fillRendererRelationshipFocus: function() {
                    var a = function(a, b, c) { return "\x3chtml\x3e\x3cbody\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d'top'\x3e\x3cdiv class\x3d'" + c + "_focusTitle'\x3e" + a + "\x3c/div\x3e\x3cdiv class\x3d'" + c + "_focusMsg'\x3e" + b + "\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/body\x3e\x3c/html\x3e" };
                    this.focusData = [];
                    this.focusData.push({ name: this.i18n.focusHighHigh, key: "HH", label: a(this.i18n.focusHighHigh, this.i18n.focusHighHighMsg, this.baseClass) });
                    this.focusData.push({ name: this.i18n.focusHighLow, key: "HL", label: a(this.i18n.focusHighLow, this.i18n.focusHighLowMsg, this.baseClass) });
                    this.focusData.push({ name: this.i18n.focusLowHigh, key: "LH", label: a(this.i18n.focusLowHigh, this.i18n.focusLowHighMsg, this.baseClass) });
                    this.focusData.push({
                        name: this.i18n.focusLowLow,
                        key: "LL",
                        label: a(this.i18n.focusLowLow,
                            this.i18n.focusLowLowMsg, this.baseClass)
                    });
                    this.focusData.push({ name: this.i18n.focusNone, key: "none", label: a(this.i18n.focusNone, this.i18n.focusNoneMsg, this.baseClass) });
                    this.focusStore = new A({ data: this.focusData, idProperty: "key" });
                    this._rendererRelationshipFocus.set("store", this.focusStore);
                    this._rendererRelationshipFocus.set("labelAttr", "label");
                    this._rendererRelationshipFocus.set("labelType", "html");
                    this._rendererRelationshipFocus.textbox.readOnly = !0;
                    t.set(this._rendererRelationshipFocus.textbox,
                        "cursor", "pointer");
                    this._rendererRelationshipFocus.textbox.onclick = g.hitch(this, function() { this._rendererRelationshipFocus.loadDropDown() });
                    this._rendererRelationshipFocus.set("value", this.renderer.authoringInfo.focus ? this.renderer.authoringInfo.focus : "none");
                    r.after(this._rendererRelationshipFocus, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _fillRendererRelationshipGridsize: function() {
                    var a = function(a, b, c) {
                        return "\x3chtml\x3e\x3cbody\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d'top'\x3e\x3cdiv class\x3d'" +
                            c + "_gridsizeTitle'\x3e" + a + "\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/body\x3e\x3c/html\x3e"
                    };
                    this.gridsizeData = [];
                    this.gridsizeData.push({ name: this.i18n.gridsize2, key: 2, label: a(this.i18n.gridsize2, "", this.baseClass) });
                    this.gridsizeData.push({ name: this.i18n.gridsize3, key: 3, label: a(this.i18n.gridsize3, "", this.baseClass) });
                    this.gridsizeData.push({ name: this.i18n.gridsize4, key: 4, label: a(this.i18n.gridsize4, "", this.baseClass) });
                    this.gridsizeStore = new A({ data: this.gridsizeData, idProperty: "key" });
                    this._rendererRelationshipGridsize.set("store", this.gridsizeStore);
                    this._rendererRelationshipGridsize.set("labelAttr", "label");
                    this._rendererRelationshipGridsize.set("labelType", "html");
                    this._rendererRelationshipGridsize.textbox.readOnly = !0;
                    t.set(this._rendererRelationshipGridsize.textbox, "cursor", "pointer");
                    this._rendererRelationshipGridsize.textbox.onclick = g.hitch(this, function() { this._rendererRelationshipGridsize.loadDropDown() });
                    this.renderer.authoringInfo && this.renderer.authoringInfo.numClasses ?
                        this._rendererRelationshipGridsize.set("value", this.renderer.authoringInfo.numClasses) : this._rendererRelationshipGridsize.set("value", 3);
                    r.after(this._rendererRelationshipGridsize, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _fillRendererRelationshipClassifications: function() {
                    var a = function(a, b, c) { return "\x3chtml\x3e\x3cbody\x3e\x3cdiv class\x3d'" + c + "_classificationTitle'\x3e" + a + "\x3c/div\x3e\x3cdiv class\x3d'" + c + "_classificationMsg'\x3e" + b + "\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e" };
                    this.classificationData = [];
                    this.classificationData.push({ name: this.i18n.classifyNaturalBreaks, key: "natural-breaks", label: a(this.i18n.classifyNaturalBreaks, this.i18n.classifyNaturalBreaksMsg, this.baseClass) });
                    this.classificationData.push({ name: this.i18n.classifyEqualInterval, key: "equal-interval", label: a(this.i18n.classifyEqualInterval, this.i18n.classifyEqualIntervalMsg, this.baseClass) });
                    this.classificationData.push({
                        name: this.i18n.classifyQuantile,
                        key: "quantile",
                        label: a(this.i18n.classifyQuantile,
                            this.i18n.classifyQuantileMsg, this.baseClass)
                    });
                    this.classificationData.push({ name: this.i18n.classifyManualBreaks, key: "manual", label: a(this.i18n.classifyManualBreaks, this.i18n.classifyManualBreaksMsg, this.baseClass) });
                    this.classificationStore = new A({ data: this.classificationData, idProperty: "name" });
                    this._rendererRelationshipClassifyMethods.set("store", this.classificationStore);
                    this._rendererRelationshipClassifyMethods.set("labelAttr", "label");
                    this._rendererRelationshipClassifyMethods.set("labelType",
                        "html");
                    this._rendererRelationshipClassifyMethods.textbox.readOnly = !0;
                    t.set(this._rendererRelationshipClassifyMethods.textbox, "cursor", "pointer");
                    this._rendererRelationshipClassifyMethods.textbox.onclick = g.hitch(this, function() { this._rendererRelationshipClassifyMethods.loadDropDown() });
                    this.renderer.authoringInfo && this.renderer.authoringInfo.classificationMethod ? this._rendererRelationshipClassifyMethods.set("value", this.getClassificationMethod(this.fromClassificationMethodConstant(this.renderer.authoringInfo.classificationMethod))) :
                        this.renderer.authoringInfo ? this._rendererRelationshipClassifyMethods.set("value", this.i18n.classifyManualBreaks) : this._rendererRelationshipClassifyMethods.set("value", this.i18n.classifyQuantile);
                    r.after(this._rendererRelationshipClassifyMethods, "openDropDown", g.hitch(this, function() { this.adjustHeight() }))
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                _updateRelationshipRendererGrid: function(b) {
                    "none" !== t.get(f.byId("renderer-relationship-legend-content"), "display") && (b = b ||
                        this.renderer, this.relationshipRendererGrid ? this.relationshipRendererGrid.updateGrid(b) : (this.relationshipRendererGrid = new C({ id: "relationshipGrid", renderer: b, defaultInfo: this.defaultInfo, allUniqueValues: null, style: "position: relative; width: 100%; height:100%; overflow-y:hidden; overflow-x:hidden; padding:0;", params: this.params }, "relationshipGrid"), n.forEach(this._rSubscriptions, a.unsubscribe), delete this._rSubscriptions, this._rSubscriptions.push(a.subscribe("onReorderUniqueValues", g.hitch(this,
                            "onReorder"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValue", g.hitch(this, "onUpdateInfo"))), this._rSubscriptions.push(a.subscribe("onUpdateUniqueValueDefault", g.hitch(this, "onUpdateDefault")))), this.adjustHeight())
                },
                _destroyRelationshipRendererGrid: function() {
                    this.relationshipRendererGrid && (n.forEach(this._rSubscriptions, a.unsubscribe), delete this._rSubscriptions, this.relationshipRendererGrid.destroy(), this.relationshipRendererGrid = null, f.byId("relationshipGrid") || x.create("div", { id: "relationshipGrid" },
                        this._rendererRelationshipGridContainer))
                },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg = (new D({ id: "attributeTransparencyDlg", style: "visibility:hidden;" })).placeAt(document.body);
                    this.attributeTransparencyDlgContent = new y({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler = a.connect(this.attributeTransparencyDlg,
                        "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new q({ attributesStore: this.attributesStore, layer: this.fLayer || this.layer, mapLayer: this.mapLayer, showDateFields: this.showDateFields, numHistogramBins: this.numHistogramBins, savedRenderers: this.savedRenderers }, "attributeTransparencyDlgContent");
                    this.attributeTransparencyDlg.set({ title: this.i18n.attributeTransparencyDlgTitle, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler =
                        a.subscribe("attribute-transparency-commit", g.hitch(this, function(a) {
                            this.hideAttributeTransparencyDlg();
                            if (a.opacityInfo) this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo = g.clone(a.authoringInfo), this.authoringInfo = g.clone(this.renderer.authoringInfo), this.applyRelationshipRenderer(this.renderer), this.attributesStore.fetchItemByIdentity({
                                identity: a.opacityInfo.field || "customExprTrans",
                                onItem: g.hitch(this, function(b) {
                                    a.opacityInfo.normalizationField ?
                                        this.attributesStore.fetchItemByIdentity({ identity: a.opacityInfo.normalizationField, onItem: g.hitch(this, function(a) { this._rendererRelationshipAttributeTransparencyLabel_part2.innerHTML = d.substitute(this.i18n.setFromFieldDividedBy, { field1: b.alias || b.name, field2: a.alias || a.name }) }) }) : this._rendererRelationshipAttributeTransparencyLabel_part2.innerHTML = a.opacityInfo.field ? b.alias || b.name : a.opacityInfo.valueExpressionTitle || a.opacityInfo.legendOptions && a.opacityInfo.legendOptions.title
                                })
                            });
                            else {
                                var b =
                                    this.getVisualVariablesExceptType("opacityInfo", null, this.renderer.visualVariables);
                                this.renderer.setVisualVariables(b);
                                this.applyRelationshipRenderer(this.renderer);
                                this._rendererRelationshipAttributeTransparencyLabel_part2.innerHTML = this.i18n.attributeValues
                            }
                        }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() {
                        t.set(this.attributeTransparencyDlg.domNode,
                            "visibility", "visible")
                    }))
                },
                hideAttributeTransparencyDlg: function() { this.attributeTransparencyDlg && this.attributeTransparencyDlg.hide() },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler && a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency && this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    E.byId("attributeTransparencyDlg") && E.byId("attributeTransparencyDlg").destroy()
                },
                getParams: function() {
                    var a = new v,
                        b = {
                            field1: {},
                            field2: {}
                        };
                    this.attributesStore.fetchItemByIdentity({
                        identity: this._rendererRelationshipDividedByField1Attribute.get("value"),
                        onItem: g.hitch(this, function(c) {
                            c && "none" !== c.type[0] && (b.field1.normalizationField = c.name[0]);
                            this.attributesStore.fetchItemByIdentity({
                                identity: this._rendererRelationshipDividedByField2Attribute.get("value"),
                                onItem: g.hitch(this, function(c) {
                                    c && "none" !== c.type[0] && (b.field2.normalizationField = c.name[0]);
                                    b.focus = this._rendererRelationshipFocus.get("value");
                                    "none" === b.focus &&
                                        (b.focus = null);
                                    b.numClasses = parseInt(this._rendererRelationshipGridsize.get("value"));
                                    switch (this._rendererRelationshipClassifyMethods.get("value")) {
                                        case this.i18n.classifyNaturalBreaks:
                                            b.classificationMethod = "natural-breaks";
                                            break;
                                        case this.i18n.classifyEqualInterval:
                                            b.classificationMethod = "equal-interval";
                                            break;
                                        case this.i18n.classifyQuantile:
                                            b.classificationMethod = "quantile"
                                    }
                                    b.showOthers = this._rendererRelationshipOtherCheck.get("checked");
                                    b.symbol = this.renderer.infos && this.renderer.infos.length ?
                                        this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                                    b.rotationInfo = this.renderer.rotationInfo;
                                    b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                                    a.resolve(b)
                                })
                            })
                        })
                    });
                    return a
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererRelationshipStack" === leftPanel.visibleStack) {
                        t.set(f.byId("renderer-relationship-bottom"), "overflowY", "none");
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererRelationshipHeader")).h,
                            d = c.coords(this._rendererRelationshipTop.domNode).h,
                            e = c.coords(f.byId("rendererRelationshipContentClose")).h,
                            g = c.coords(f.byId("rendererRelationshipFooter_links")).h + 10;
                        t.set(f.byId("rendererRelationshipFooterDiv"), "height", g + "px");
                        a = a - b - d - e - g - 13;
                        t.set(f.byId("renderer-relationship-scrollContent"), "height", a + "px");
                        b = this.renderer.infos ? 30 * (this.renderer.infos.length + 1) : 100;
                        t.set(this._rendererRelationshipGridDiv, "height", b + 20 + "px");
                        t.set(this._rendererRelationshipGridContainer,
                            "height", b + "px");
                        b = c.coords(f.byId("leftContentStackContainer")).w;
                        newWidth = b - 35;
                        var h = 60;
                        n.forEach(m(".firstColumnLabel", this.domNode), function(a) { h = Math.max(h, c.coords(a).w) });
                        var p = 40;
                        m(".toolsLabel").forEach(function(a) { p = Math.max(p, c.coords(a).w) });
                        m(".toolsColumnTD2").style("width", p + 4 + "px");
                        var q = 60;
                        n.forEach(m(".firstColumnLabel2", this.domNode), function(a) { q = Math.max(q, c.coords(a).w) });
                        if (0 < newWidth) {
                            d = b - h - p - 42;
                            0 < d && (d = Math.max(d, 50), t.set(this._rendererRelationshipFocus.domNode, "width", d +
                                "px"), t.set(this._rendererRelationshipGridsize.domNode, "width", d + "px"), t.set(this._rendererRelationshipClassifyMethods.domNode, "width", d + "px"));
                            if (0 < b - q - 40) {
                                e = 0;
                                if ("none" !== t.get(this._rendererRelationshipDividedByField1Description, "display") || "none" !== t.get(this._rendererRelationshipDividedByField2Description, "display")) e = 30;
                                t.set(this._rendererRelationshipDividedByField1Attribute.domNode, "width", d - e + "px");
                                t.set(this._rendererRelationshipDividedByField2Attribute.domNode, "width", d - e + "px")
                            }
                            t.set(this._rendererRelationshipGridDiv,
                                "width", Math.max(b - p - 30, 180) + "px");
                            this.relationshipRendererGrid && this.relationshipRendererGrid.resize();
                            60 >= a && (newWidth -= 30);
                            a = 0;
                            if ("none" !== t.get(this._rendererRelationshipRotationEditExpression, "display") || "none" !== t.get(this._rendererRelationshipRotationFieldDescription, "display")) a = 30;
                            t.set(this._rendererRelationshipRotationAttribute.domNode, "width", newWidth - a - 21 + "px");
                            m(".dijitSelectLabel", this._rendererRelationshipRotationAttribute.domNode).style("maxWidth", newWidth - a - 51 + "px");
                            this.transparencySlider &&
                                t.set(this.transparencySlider.domNode, "width", this.hasDynamic ? newWidth - 30 : newWidth - 52 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", newWidth - 30 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Relationship", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_RelationshipMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/Deferred dojo/dom dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/relationship esri/renderers/smartMapping esri/tasks/query esri/tasks/QueryTask esri/tasks/UniqueValueDefinition esri/tasks/GenerateRendererParameters esri/tasks/GenerateRendererTask esri/tasks/StatisticDefinition esri/renderers/SimpleRenderer esri/renderers/UniqueValueRenderer esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/dijit/ClassedColorSlider esri/dijit/OpacitySlider".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J) {
            return {
                relationshipCategoryInfos: null,
                maxCount: 200,
                defaultColors: "#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" "),
                buildRelationshipRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildRelationshipRendererGo(!1, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c =
                                this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildRelationshipRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildRelationshipRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({
                                title: this.i18n.warning,
                                message: this.i18n.featureTypesAndTemplatesWarning,
                                choiceOneTitle: this.i18n.yesLabel,
                                choiceOneHandler: g.hitch(this, function() { this.buildRelationshipRendererGo(!0, a, b) }),
                                choiceTwoTitle: this.i18n.noLabel,
                                choiceTwoHandler: g.hitch(this, function() { b.reject() })
                            })
                        } else this.buildRelationshipRendererGo(null, a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildRelationshipRendererGo(null, a, b);
                    return b
                },
                buildRelationshipRendererGo: function(b, c, d) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    var e = c.attributeItem || this.attributeItem,
                        f = c.attributeItem2 || this.attributeItem2;
                    this.scheme = this.scheme || this.findRelationshipScheme(this.renderer, c.theme);
                    r.createRelationshipRenderer({
                        layer: this.fLayer || this.layer,
                        field1: { field: e.name, normalizationField: c.field1 && c.field1.normalizationField, minValue: c.field1 && c.field1.classBreakInfos ? c.field1.classBreakInfos[0].minValue : null, maxValue: c.field1 && c.field1.classBreakInfos ? c.field1.classBreakInfos[c.field1.classBreakInfos.length - 1].maxValue : null },
                        field2: { field: f.name, normalizationField: c.field2 && c.field2.normalizationField, minValue: c.field2 && c.field2.classBreakInfos ? c.field2.classBreakInfos[0].minValue : null, maxValue: c.field2 && c.field2.classBreakInfos ? c.field2.classBreakInfos[c.field2.classBreakInfos.length - 1].maxValue : null },
                        classificationMethod: c.classificationMethod || "quantile",
                        numClasses: c.numClasses || 3,
                        focus: arcgisonline.isEmpty(c) ? "HH" : c.focus,
                        theme: c.theme || "default",
                        basemap: this.getBasemapType(),
                        scheme: this.scheme,
                        showOthers: !0,
                        optimizeForScale: h.isDefined(c.optimizeForScale) ?
                            c.optimizeForScale : "visible-scale-range",
                        optimizeOutline: h.isDefined(c.optimizeOutline) ? c.optimizeOutline : !0
                    }).then(g.hitch(this, function(h) {
                        if (!d.isRejected()) {
                            this.scheme = h.scheme;
                            b && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                            var n = {
                                type: "relationship",
                                numClasses: c.numClasses || 3,
                                focus: arcgisonline.isEmpty(c) ? "HH" : c.focus,
                                field1: {
                                    field: e.name,
                                    normalizationField: c.field1 && c.field1.normalizationField,
                                    classBreakInfos: h.classBreaks.field1.classBreakInfos.map(function(a) {
                                        return {
                                            minValue: a.minValue,
                                            maxValue: a.maxValue
                                        }
                                    })
                                },
                                field2: { field: f.name, normalizationField: c.field2 && c.field2.normalizationField, classBreakInfos: h.classBreaks.field2.classBreakInfos.map(function(a) { return { minValue: a.minValue, maxValue: a.maxValue } }) }
                            };
                            c.theme && "default" !== c.theme && (n.theme = c.theme);
                            n.classificationMethod = c.classificationMethod ? this.getClassificationMethodConstant(c.classificationMethod) : "esriClassifyQuantile";
                            if (-1 < a.indexOf(["relationship", "relationshipSize"], this.getRendererStyle(this.renderer))) {
                                var p = this.getVisualVariablesExceptTypes([{
                                    type: "sizeInfo",
                                    target: "outline"
                                }], this.renderer.visualVariables);
                                p && (h.renderer.visualVariables ? h.renderer.setVisualVariables(h.renderer.visualVariables.concat(p)) : h.renderer.setVisualVariables(p));
                                this.authoringInfo && this.authoringInfo.visualVariables && (n.visualVariables = this.authoringInfo.visualVariables);
                                !(p = this.getVisualVariableByType("sizeInfo", null, h.renderer.visualVariables)) || this.attributeItem3 && this.sameFieldAs(this.attributeItem3, p.field, p.valueExpression, p.valueExpressionTitle) || (p = this.getVisualVariablesExceptTypes(["sizeInfo"],
                                    h.renderer.visualVariables), h.renderer.setVisualVariables(p), p = this.getVisualVariablesExceptTypes(["sizeInfo"], n.visualVariables), n.visualVariables = p, p = null);
                                if ("esriGeometryPolygon" === this.geometryType && p) {
                                    var r = m.fromJson(this.renderer.infos[0].symbol.toJson()),
                                        t = [];
                                    a.forEach(h.renderer.infos, function(a) { t.push(g.clone(a)) });
                                    a.forEach(t, function(a) { h.renderer.removeValue(a.value) }, this);
                                    a.forEach(t, function(a) {
                                        var b = m.fromJson(r.toJson());
                                        h.renderer.addValue({
                                            value: a.value,
                                            symbol: this.switchSymbolKeepColor(b,
                                                a.symbol),
                                            label: a.label
                                        })
                                    }, this);
                                    this.renderer.backgroundFillSymbol && (h.renderer.backgroundFillSymbol = this.renderer.backgroundFillSymbol)
                                }
                            }
                            this.authoringInfo = n;
                            h.renderer = this.updateRelationshipRendererProperties(c, h.renderer);
                            d.resolve(h)
                        }
                    }), g.hitch(this, function(e) {
                        d.isRejected() || (-1 < e.message.indexOf("incompatible class breaks") && !c.numClasses ? (c.focus = arcgisonline.isEmpty(c) ? "HH" : c.focus, c.numClasses = 2, this.buildRelationshipRendererGo(b, c, d)) : (this.attributeItem3 && this.showPredominance && -1 ===
                            a.indexOf(["relationshipSize", "predominance", "predominancesize"], this.getRendererStyle(this.renderer)) && (this.attributeItem.name === this.attributeItem3.name || this.attributeItem2.name === this.attributeItem3.name) || this.handleError(e, "createRelationshipRenderer", !0), d.reject()))
                    }))
                },
                updateRelationshipRendererBreaks: function(a) {
                    var b = a.attributeItem || this.attributeItem,
                        c = a.attributeItem2 || this.attributeItem2;
                    r.updateRelationshipRenderer({
                        renderer: this.renderer,
                        field1: {
                            field: b.name,
                            normalizationField: a.field1 &&
                                a.field1.normalizationField || this.authoringInfo.field1.normalizationField,
                            classBreakInfos: a.field1 && a.field1.classBreakInfos || this.authoringInfo.field1.classBreakInfos
                        },
                        field2: { field: c.name, normalizationField: a.field2 && a.field2.normalizationField || this.authoringInfo.field2.normalizationField, classBreakInfos: a.field2 && a.field2.classBreakInfos || this.authoringInfo.field2.classBreakInfos },
                        colors: a.colors || null,
                        numClasses: a.numClasses || this.authoringInfo.numClasses,
                        focus: "none" === (a.focus || this.authoringInfo.focus) ?
                            null : a.focus || this.authoringInfo.focus
                    });
                    var d = this.authoringInfo.visualVariables;
                    this.authoringInfo = {
                        type: "relationship",
                        numClasses: a.numClasses || this.authoringInfo.numClasses,
                        focus: "none" === (a.focus || this.authoringInfo.focus) ? null : a.focus || this.authoringInfo.focus,
                        field1: {
                            field: b.name,
                            normalizationField: a.field1 && a.field1.normalizationField || this.authoringInfo.field1.normalizationField,
                            classBreakInfos: (a.field1 && a.field1.classBreakInfos || this.authoringInfo.field1.classBreakInfos).map(function(a) {
                                return {
                                    minValue: a.minValue,
                                    maxValue: a.maxValue
                                }
                            })
                        },
                        field2: { field: c.name, normalizationField: a.field2 && a.field2.normalizationField || this.authoringInfo.field2.normalizationField, classBreakInfos: (a.field2 && a.field2.classBreakInfos || this.authoringInfo.field2.classBreakInfos).map(function(a) { return { minValue: a.minValue, maxValue: a.maxValue } }) }
                    };
                    a.theme && "default" !== a.theme ? this.authoringInfo.theme = a.theme : this.authoringInfo.theme && "default" !== this.authoringInfo.theme ? this.authoringInfo.theme = this.authoringInfo.theme : delete this.authoringInfo.theme;
                    a.classificationMethod ? this.authoringInfo.classificationMethod = this.getClassificationMethodConstant(a.classificationMethod) : this.authoringInfo.classificationMethod ? this.authoringInfo.classificationMethod = this.authoringInfo.classificationMethod : delete this.authoringInfo.classificationMethod;
                    d && (this.authoringInfo.visualVariables = d)
                },
                applyRelationshipRenderer: function(a) {
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    this.hasDynamic || "relationship" === b || (this.layer.setOpacity(1),
                        this.transparencySlider && this.transparencySlider.set("value", 0));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.types.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                updateRelationshipRenderer: function(b) {
                    if (h.isDefined(b) && "esriGeometryPolygon" === this.geometryType)
                        if (b) {
                            var c = [];
                            a.forEach(this.renderer.infos, function(a) { c.push(g.clone(a)) });
                            a.forEach(c, function(a) { this.renderer.removeValue(a.value) }, this);
                            a.forEach(c, function(a) { this.renderer.addValue({ value: a.value, symbol: this.setOutlineWidthOfSymbol(a.symbol, 1), label: a.label }) }, this);
                            this.portalPanel.lastUniqueDefaultSymbol = this.setOutlineWidthOfSymbol(this.portalPanel.lastUniqueDefaultSymbol, 1);
                            this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol, 1));
                            this.defaultInfo && this.defaultInfo.defaultSymbol && (this.defaultInfo.defaultSymbol =
                                this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, 1));
                            this.getSuggestedOutline().then(g.hitch(this, function(a) {
                                this.replaceVisualVariable("sizeInfo", "outline", a.widthInfo, this.renderer);
                                this.applyRelationshipRenderer(this.renderer)
                            }), g.hitch(this, function(a) {
                                a = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables);
                                this.renderer.setVisualVariables(a);
                                this.applyRelationshipRenderer(this.renderer)
                            }))
                        } else b = this.getVisualVariablesExceptTypes([{
                            type: "sizeInfo",
                            target: "outline"
                        }], this.renderer.visualVariables), this.renderer.setVisualVariables(b), this.applyRelationshipRenderer(this.renderer);
                    else this.applyRelationshipRenderer(this.renderer)
                },
                recreateRenderer: function(b) {
                    var c = new d;
                    b = b || {};
                    this.getParams().then(g.hitch(this, function(d) {
                        b = g.mixin(d, b);
                        this.buildRelationshipRenderer(b).then(g.hitch(this, function(d) {
                            a.forEach(this.renderer.infos, function(b) { a.forEach(d.renderer.infos, function(a) { b.value === a.value && (a.label = b.label) }) });
                            this.renderer = d.renderer;
                            this.applyRelationshipRenderer(this.renderer);
                            this.createColorInfoSliders(b).then(g.hitch(this, function() {
                                this.hideBusy();
                                this.adjustHeight()
                            }), g.hitch(this, function() { this.hideBusy() }));
                            c.resolve()
                        }), g.hitch(this, function() {
                            this.hideBusy();
                            c.reject()
                        }), g.hitch(this, function(a) { this.showBusy("rendererRelationshipStack", a) }))
                    }));
                    return c
                },
                updateRelationshipRendererProperties: function(a, b) {
                    b = b || this.renderer;
                    a = a || {};
                    a.showOthers ? (b.defaultSymbol = a.defaultSymbol, b.defaultLabel = a.defaultLabel) : a.showOthers ||
                        (delete b.defaultSymbol, delete b.defaultLabel);
                    a.rotationInfo && (b.setRotationInfo(a.rotationInfo), this.removeRotationInfoVisualVariable(b));
                    return b
                },
                createColorInfoSliders: function(a) {
                    var b = new d;
                    this.createColorInfoSliderField1(a).then(g.hitch(this, function() {
                        a.statistics = null;
                        this.createColorInfoSliderField2(a).then(g.hitch(this, function() { b.resolve() }), g.hitch(this, function() { b.reject() }))
                    }), g.hitch(this, function() { b.reject() }));
                    return b
                },
                createColorInfoSliderField1: function(a) {
                    this.destroyColorSlider(this.colorSliderField1,
                        "rendererRelationshipSliderField1", this._rendererRelationshipSliderField1Div);
                    var b = a.attributeItem || this.attributeItem,
                        c = this.renderer.authoringInfo.field1,
                        e = new d;
                    this.createColorInfoSlider(a, b, c, "rendererRelationshipSliderField1").then(g.hitch(this, function() {
                        this.colorSliderField1 = this.colorSlider;
                        e.resolve()
                    }), g.hitch(this, function(a) { e.reject() }));
                    return e
                },
                createColorInfoSliderField2: function(a) {
                    this.destroyColorSlider(this.colorSliderField2, "rendererRelationshipSliderField2", this._rendererRelationshipSliderField2Div);
                    var b = a.attributeItem2 || this.attributeItem2,
                        c = this.renderer.authoringInfo.field2,
                        e = new d;
                    this.createColorInfoSlider(a, b, c, "rendererRelationshipSliderField2").then(g.hitch(this, function() {
                        this.colorSliderField2 = this.colorSlider;
                        e.resolve()
                    }), g.hitch(this, function(a) { e.reject() }));
                    return e
                },
                createColorInfoSlider: function(a, b, c, e) {
                    var f = function(a, d) {
                            this.getHistogram(g.mixin(a, {
                                field: b.name,
                                normalizationField: c.normalizationField,
                                minValue: c.classBreakInfos[0].minValue,
                                maxValue: c.classBreakInfos[c.classBreakInfos.length -
                                    1].maxValue
                            })).then(g.hitch(this, function(f) {
                                d.isRejected() || (this.onCalculationsSource(f), this.colorSlider = new H({ breakInfos: this.addSymbolsToBreakInfos(g.clone(c.classBreakInfos)), classificationMethod: a.classificationMethod, normalizationType: "field", statistics: a.statistics, histogram: f, minValue: c.classBreakInfos[0].minValue, maxValue: c.classBreakInfos[c.classBreakInfos.length - 1].maxValue, showLabel: !0, showTick: !0, showHandles: !0, histogramWidth: 70 }, e), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a,
                                    this.colorSlider, b, c), d.resolve())
                            }), g.hitch(this, function(f) {
                                d.isRejected() || (this.colorSlider = new H({ breakInfos: this.addSymbolsToBreakInfos(g.clone(c.classBreakInfos)), classificationMethod: a.classificationMethod, normalizationType: "field", statistics: a.statistics, histogram: null, minValue: c.classBreakInfos[0].minValue, maxValue: c.classBreakInfos[c.classBreakInfos.length - 1].maxValue, showLabel: !0, showTick: !0, showHandles: !0, histogramWidth: 70 }, e), this.colorSlider.startup(), this.enableColorSliderChangeEvent(a,
                                    this.colorSlider, b, c), d.resolve())
                            }))
                        },
                        h = new d;
                    setTimeout(function() { h.progress(h) }, 1);
                    a = a || {};
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        h.isRejected() || (a.statistics ? (this.displayZeroFeaturesMsg(a.statistics.count), this.onCalculationsSource(a.statistics), g.hitch(this, f, a, h)()) : (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics({ field: b.name, normalizationType: c.normalizationField ? "field" : null, normalizationField: c.normalizationField }).then(g.hitch(this,
                            function(b) { h.isRejected() || (a.statistics = b, this.displayZeroFeaturesMsg(b.count), this.onCalculationsSource(b), g.hitch(this, f, a, h)()) }), g.hitch(this, function(b) { h.isRejected() || (this.handleError(b, "getFieldStatistics", !1), g.hitch(this, f, a, h)()) })))
                    }), g.hitch(this, function(a) { h.isRejected() || (this.handleError(a, "addPlugin", !1), h.reject()) }));
                    return h
                },
                enableColorSliderChangeEvent: function(a, b, c, d) {
                    b && (b.sliderChangeHandler = b.on("handle-value-change", g.hitch(this, function(a) {
                        a = a.breakInfos ? a.breakInfos :
                            a;
                        this.updateRelationshipRendererBreaks(c.name === this.authoringInfo.field1.field ? { field1: { classBreakInfos: a } } : { field2: { classBreakInfos: a } });
                        this.applyRelationshipRenderer(this.renderer);
                        this.onColorSliderChange()
                    })), b.sliderChangeHandler2 = b.on("data-value-change", g.hitch(this, function(a) {
                        a = a.breakInfos ? a.breakInfos : a;
                        this.updateRelationshipRendererBreaks(c.name === this.authoringInfo.field1.field ? { field1: { classBreakInfos: a } } : { field2: { classBreakInfos: a } });
                        this.applyRelationshipRenderer(this.renderer);
                        this.onColorSliderChange()
                    })))
                },
                disableSliderChangeEvent: function(a) { a && (a.sliderChangeHandler && a.sliderChangeHandler.remove(), a.sliderChangeHandler = null, a.sliderChangeHandler2 && a.sliderChangeHandler2.remove(), a.sliderChangeHandler2 = null) },
                getHistogram: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    this.histogramInfo && this.histogramInfo.field === a.field && "field" === this.histogramInfo.normalizationType && this.histogramInfo.normalizationField === a.normalizationField && this.histogramInfo.minValue ===
                        a.minValue && this.histogramInfo.maxValue === a.maxValue ? b.resolve(this.histogramInfo.histogram) : (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            b.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getHistogram({ field: a.field, numBins: this.numHistogramBins, classificationMethod: "equal-interval", normalizationType: a.normalizationField ? "field" : null, normalizationField: a.normalizationField, minValue: a.minValue, maxValue: a.maxValue }).then(g.hitch(this,
                                function(c) { b.isRejected() || (this.histogramInfo = { histogram: c, field: a.field, valueExpression: a.valueExpression, normalizationType: "field", normalizationField: a.normalizationField, minValue: a.minValue, maxValue: a.maxValue }, b.resolve(c)) }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHistogram", !1), b.reject()) }))
                        }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                },
                getHandleInfo: function(a, b) {
                    return {
                        handles: dojo.map(b, function(a, b) { return b }),
                        primaryHandle: null
                    }
                },
                destroyColorSlider: function(a, b, c) {
                    this.disableSliderChangeEvent(a);
                    a && a.destroy();
                    delete a;
                    f.byId(b) || e.create("div", { id: b }, c)
                },
                findRelationshipScheme: function(b, c) {
                    var d;
                    (c = a.filter(a.map(b.infos, function(a) { return a.symbol.color }), function(a) { return a })) && c.length && ((d = p.getMatchingSchemes({ theme: "default", numClasses: b.authoringInfo.numClasses || 3, colors: c, geometryType: this.geometryType })) && d.length || (d = p.getMatchingSchemes({
                        theme: "default",
                        numClasses: b.authoringInfo.numClasses ||
                            3,
                        colors: c,
                        geometryType: this.geometryType
                    })));
                    return d && d.length ? d[0] : null
                },
                updateOutlineWidthOnRelationshipRenderer: function(b) {
                    var c = this.renderer.infos;
                    this.renderer.clearBreaks();
                    a.forEach(c, function(a, c) { this.renderer.addBreak({ minValue: a.minValue, maxValue: a.maxValue, symbol: this.setOutlineWidthOfSymbol(a.symbol, b), label: a.label }) }, this);
                    this.renderer.defaultSymbol && (this.renderer.defaultSymbol = this.setOutlineWidthOfSymbol(this.renderer.defaultSymbol, b));
                    this.defaultInfo && this.defaultInfo.defaultSymbol &&
                        (this.defaultInfo.defaultSymbol = this.setOutlineWidthOfSymbol(this.defaultInfo.defaultSymbol, b))
                },
                addSymbolsToBreakInfos: function(b) {
                    var d, e;
                    a.forEach(this.renderer.infos, function(a) { "HH" === a.value ? d = a.symbol.color : "LL" === a.value && (e = a.symbol.color) });
                    var f = (d.r + d.g + d.b) / 3,
                        g = (e.r + e.g + e.b) / 3;
                    if (2 === b.length) b[1].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([f, f, f, 255]));
                    else if (3 === b.length) b[2].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([f, f, f, 255])), f =
                        (f + g) / 2, b[1].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([f, f, f, 255]));
                    else {
                        b[3].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([f, f, f, 255]));
                        var h = f + (g - f) / 3;
                        b[2].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([h, h, h, 255]));
                        h = f + 2 * (g - f) / 3;
                        b[1].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([h, h, h, 255]))
                    }
                    b[0].symbol = this.getDefaultSymbol("esriGeometryPolygon").setColor(new c([g, g, g, 255]));
                    return b
                },
                reorderRelationshipCategoryInfos: function(b,
                    c, d) {
                    for (var e = this.renderer; e.infos[0];) e.removeValue(e.infos[0].value);
                    a.forEach(b, g.hitch(this, function(a) { e.addValue({ value: a.value, label: a.label, symbol: a.symbol }) }));
                    return e
                },
                getRelationshipCategoryInfos: function() {
                    var a = new d;
                    setTimeout(function() { a.progress(a) }, 1);
                    if (this.relationshipCategoryInfos) a.resolve();
                    else {
                        var b = this.attributeItem,
                            c = this.attributeItem2,
                            e = this.attributeItem3,
                            f = this.attributeItem4,
                            h = this.attributeItem5,
                            m = [];
                        m.push({ label: b.alias, name: b.name });
                        m.push({ label: c.alias, name: c.name });
                        e && (m.push({ label: e.alias, name: e.name }), f && (m.push({ label: f.alias, name: f.name }), h && m.push({ label: h.alias, name: h.name })));
                        (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                            a.isRejected() || (this.fLayer || this.layer).statisticsPlugin.getRelationshipCategories({ fields: g.clone(this.renderer.authoringInfo.fields) }).then(g.hitch(this, function(b) { a.isRejected() || (this.relationshipCategoryInfos = b.relationshipCategoryInfos, a.resolve()) }), g.hitch(this, function(b) {
                                a.isRejected() ||
                                    (this.handleError(b, "getRelationshipCategories", !1), a.reject())
                            }))
                        }), g.hitch(this, function(b) { a.isRejected() || (this.handleError(b, "addPlugin", !1), a.reject()) }))
                    }
                    return a
                },
                getRelationshipParams: function() {
                    var a = new d,
                        b = {};
                    if (!this.attributeItem && this.renderer.authoringInfo && this.renderer.authoringInfo.fields) {
                        var c = this.renderer.authoringInfo.fields;
                        this.getAttributeItemFromStore(c[0]).then(g.hitch(this, function(a) {
                            b.attributeItem = a;
                            this.getAttributeItemFromStore(c[1]).then(g.hitch(this, function(a) {
                                b.attributeItem2 =
                                    a;
                                2 < c.length && this.getAttributeItemFromStore(c[2]).then(g.hitch(this, function(a) {
                                    b.attributeItem3 = a;
                                    3 < c.length && this.getAttributeItemFromStore(c[3]).then(g.hitch(this, function(a) {
                                        b.attributeItem4 = a;
                                        4 < c.length && this.getAttributeItemFromStore(c[4]).then(g.hitch(this, function(a) { b.attributeItem5 = a }))
                                    }))
                                }))
                            }))
                        }))
                    }
                    b.symbol = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                    b.rotationInfo = this.renderer.rotationInfo;
                    b.defaultSymbol = this.defaultInfo &&
                        this.defaultInfo.defaultSymbol;
                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                    b.optimizeForScale = this._rendererSizeAutomaticRadio && this._rendererSizeAutomaticRadio.get("checked") ? "visible-scale-range" : !0;
                    b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                    this.getVisualVariableByType("sizeInfo", null, this.renderer.visualVariables) && (b.includeSizeInfo = !0);
                    a.resolve(b);
                    return a
                },
                getSymbolFromRelationshipRenderer: function(a) {
                    var b;
                    if (a.infos &&
                        a.infos.length) {
                        var c = 0;
                        for (b = a.infos[c++].symbol; this.isSymbolTransparent(b) && c < a.infos.length;) b = a.infos[c++].symbol;
                        b || (b = a.infos[0].symbol)
                    } else b = this.getDefaultSymbol("esriGeometryPolygon" === this.geometryType ? "esriGeometryPoint" : this.geometryType);
                    return b
                },
                getFocus: function(a) {
                    switch (a) {
                        case "HH":
                            return this.i18n.focusHighHigh;
                        case "HL":
                            return this.i18n.focusHighLow;
                        case "LH":
                            return this.i18n.focusLowHigh;
                        case "LL":
                            return this.i18n.focusLowLow;
                        default:
                            return this.i18n.focusNone
                    }
                },
                getGridsize: function(a) {
                    switch (a) {
                        case 4:
                            return this.i18n.gridsize4;
                        case 3:
                            return this.i18n.gridsize3;
                        case 2:
                            return this.i18n.gridsize2;
                        default:
                            return this.i18n.gridsize3
                    }
                },
                getGridsizeNumber: function(a) {
                    switch (a) {
                        case this.i18n.gridsize4:
                            return 4;
                        case this.i18n.gridsize3:
                            return 3;
                        case this.i18n.gridsize2:
                            return 2;
                        default:
                            return 3
                    }
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/GalleryList": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct arcgisonline/map/dijit/renderer/GalleryListItem dijit/_Widget dijit/_Templated dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/map/dijit/renderer/templates/GalleryList.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p) {
            b = g([e, h], {
                declaredClass: "arcgisonline.map.dijit.renderer.GalleryList",
                baseClass: "esriAGORendererGallery",
                basePath: b.toUrl("arcgisonline/map/renderer"),
                widgetsInTemplate: !0,
                templateString: p,
                items: [],
                attributeType: null,
                attributeType2: null,
                constructor: function(a, b) {
                    this.id = a.id;
                    this.selectHandler = a.selectHandler;
                    this.optionsHandler = a.optionsHandler
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = m.common
                },
                destroy: function() {
                    this.destroyAllItems();
                    this.inherited(arguments)
                },
                destroyAllItems: function() {
                    a.forEach(this.items, function(a) { a.destroy() });
                    this.items = []
                },
                buildNewList: function(a, b, c, d) {
                    this.attributeType = c;
                    this.attributeType2 = d;
                    this.destroyAllItems();
                    switch (a) {
                        case "simple":
                            this.createListItem("simple");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            this.createListItem("unique");
                            this.createListItem("heatMap");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "type":
                            this.createListItem("unique");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            this.createListItem("heatMap");
                            this.createListItem("simple");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "color":
                        case "classedColor":
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c || "esriFieldTypeDate" === c ? (this.createListItem("unique"), this.createListItem("heatMap"), this.createListItem("simple")) : (this.createListItem("heatMap"), this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "ageColor":
                            this.createListItem("ageColor");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c || "esriFieldTypeDate" === c ? (this.createListItem("unique"), this.createListItem("heatMap"), this.createListItem("simple")) :
                                (this.createListItem("heatMap"), this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "size":
                        case "classedSize":
                            this.createListItem("size");
                            this.createListItem("ageSize");
                            this.createListItem("color");
                            this.createListItem("ageColor");
                            "esriFieldTypeString" === c || "esriFieldTypeDate" === c ? (this.createListItem("unique"), this.createListItem("heatMap"), this.createListItem("simple")) : (this.createListItem("heatMap"), this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "ageSize":
                            this.createListItem("ageSize");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("color");
                            "esriFieldTypeString" === c || "esriFieldTypeDate" ===
                                c ? (this.createListItem("unique"), this.createListItem("heatMap"), this.createListItem("simple")) : (this.createListItem("heatMap"), this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "heatMap":
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c ? (this.createListItem("unique"), this.createListItem("simple")) : (this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "predominance":
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c ? (this.createListItem("unique"), this.createListItem("simple")) : (this.createListItem("simple"),
                                this.createListItem("unique"));
                            this.createListItem("copyStyle");
                            break;
                        case "predominancesize":
                            this.createListItem("predominancesize");
                            this.createListItem("predominance");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c ? (this.createListItem("unique"), this.createListItem("simple")) : (this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("copyStyle");
                            break;
                        case "colorsize":
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("ratio");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("color");
                            this.createListItem("size", this.attributeType2);
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            this.createListItem("simple");
                            this.createListItem("unique");
                            this.createListItem("heatMap");
                            this.createListItem("copyStyle");
                            break;
                        case "ageColorSize":
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("colorsize");
                            this.createListItem("ratio");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("color");
                            this.createListItem("ageColor");
                            this.createListItem("size", this.attributeType2);
                            this.createListItem("ageSize");
                            this.createListItem("simple");
                            this.createListItem("unique");
                            this.createListItem("heatMap");
                            this.createListItem("copyStyle");
                            break;
                        case "colorAgeSize":
                            this.createListItem("colorAgeSize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorsize");
                            this.createListItem("ratio");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("color");
                            this.createListItem("ageColor");
                            this.createListItem("size");
                            this.createListItem("ageSize", this.attributeType2);
                            this.createListItem("simple");
                            this.createListItem("unique");
                            this.createListItem("heatMap");
                            this.createListItem("copyStyle");
                            break;
                        case "uniquesize":
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("unique");
                            this.createListItem("size", this.attributeType2);
                            this.createListItem("simple");
                            this.createListItem("color");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            this.createListItem("heatMap");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "uniqueAgeSize":
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("uniquesize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("colorsize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("unique");
                            this.createListItem("size");
                            this.createListItem("ageSize", this.attributeType2);
                            this.createListItem("simple");
                            this.createListItem("color");
                            this.createListItem("ageColor");
                            this.createListItem("heatMap");
                            this.createListItem("watercolor");
                            this.createListItem("ratio");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("copyStyle");
                            break;
                        case "watercolor":
                            this.createListItem("watercolor");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("ratio");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c ? (this.createListItem("unique"), this.createListItem("simple")) : (this.createListItem("simple"), this.createListItem("unique"));
                            this.createListItem("copyStyle");
                            break;
                        case "ratio":
                            this.createListItem("ratio");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c && this.createListItem("unique");
                            this.createListItem("simple");
                            c && "esriFieldTypeString" === c || this.createListItem("unique");
                            this.createListItem("copyStyle");
                            break;
                        case "relationship":
                            this.createListItem("relationship");
                            this.createListItem("relationshipSize");
                            this.createListItem("ratio");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c && this.createListItem("unique");
                            this.createListItem("simple");
                            c && "esriFieldTypeString" === c || this.createListItem("unique");
                            this.createListItem("copyStyle");
                            break;
                        case "relationshipSize":
                            this.createListItem("relationshipSize");
                            this.createListItem("relationship");
                            this.createListItem("ratio");
                            this.createListItem("colorsize");
                            this.createListItem("ageColorSize");
                            this.createListItem("colorAgeSize");
                            this.createListItem("predominance");
                            this.createListItem("predominancesize");
                            this.createListItem("uniquesize");
                            this.createListItem("uniqueAgeSize");
                            this.createListItem("watercolor");
                            this.createListItem("heatMap");
                            this.createListItem("color");
                            this.createListItem("size");
                            this.createListItem("ageColor");
                            this.createListItem("ageSize");
                            "esriFieldTypeString" === c && this.createListItem("unique");
                            this.createListItem("simple");
                            c && "esriFieldTypeString" === c || this.createListItem("unique");
                            this.createListItem("copyStyle");
                            break;
                        default:
                            this.createListItem("color"),
                                this.createListItem("size"), this.createListItem("ageColor"), this.createListItem("ageSize"), "esriFieldTypeString" === c && this.createListItem("unique"), this.createListItem("heatMap"), this.createListItem("simple"), "esriFieldTypeString" !== c && this.createListItem("unique"), this.createListItem("predominance"), this.createListItem("predominancesize"), this.createListItem("colorsize"), this.createListItem("ageColorSize"), this.createListItem("colorAgeSize"), this.createListItem("uniquesize"), this.createListItem("uniqueAgeSize"),
                                this.createListItem("watercolor"), this.createListItem("ratio"), this.createListItem("relationship"), this.createListItem("relationshipSize"), this.createListItem("copyStyle")
                    }
                },
                createListItem: function(a, b) {
                    b = b || this.attributeType;
                    var c = d.create("div", {});
                    d.place(c, this._galleryList, "last");
                    var e = "";
                    switch (a) {
                        case "unique":
                            "esriFieldTypeDate" === b && (e = "timeline");
                            break;
                        case "color":
                            "esriFieldTypeDate" === b && (e = "timeline");
                            break;
                        case "size":
                            "esriFieldTypeDate" === b && (e = "timeline");
                            break;
                        case "colorsize":
                            "esriFieldTypeDate" ===
                            b && (e = "timeline");
                            break;
                        case "colorAgeSize":
                            "esriFieldTypeDate" === b && (e = "timeline");
                            break;
                        case "uniquesize":
                            "esriFieldTypeDate" === b && (e = "timeline")
                    }
                    a = new f({ type: a, timeline: e, attributeType: b, attributeType2: this.attributeType2, tooltipText: this.getTooltipText(a), copyStyleLayers: this.copyStyleLayers, selectHandler: n.hitch(this, this.selectHandler, a), optionsHandler: n.hitch(this, this.optionsHandler, a), copyStyleLayersChangeHandler: this.copyStyleLayersChangeHandler }, c);
                    this.items.push(a)
                },
                getItem: function(b) {
                    var c =
                        a.filter(this.items, function(a) { return a.type === b });
                    return 0 < c.length ? c[0] : null
                },
                selectItem: function(a, b) {
                    (a = this.getItem(a)) && a.selectItem(b)
                },
                disableOptionsButton: function(a) {
                    (a = this.getItem(a)) && a.disableOptionsButton()
                },
                enableOptionsButton: function(a) {
                    (a = this.getItem(a)) && a.enableOptionsButton()
                },
                hideButtons: function(a) {
                    (a = this.getItem(a)) && a.hideButtons()
                },
                isItemVisible: function(a) { return (a = this.getItem(a)) && a.isVisible() },
                disableAllButtons: function() { a.forEach(this.items, function(a) { a.disableButtons() }) },
                resetTypeOptions: function() {
                    a.forEach(this.items, function(a) { a.reset() });
                    this.resetTypeOptionsClearCheck()
                },
                resetTypeOptionsClearCheck: function() { a.forEach(this.items, function(a) { a.clearCheck() }) },
                setGeometryType: function(b, c) {
                    a.forEach(b, function(a) {
                        (a = this.getItem(a)) && a.setGeometryType(c)
                    }, this)
                },
                setFieldInfo: function(a, b) { this.getItem(a).setFieldInfo(b) },
                setVisible: function(b) {
                    a.forEach(b, function(a) {
                        (a = this.getItem(a)) && a.setVisible()
                    }, this)
                },
                setCopyStyleLayers: function(a, b) {
                    this.copyStyleLayers =
                        a;
                    this.copyStyleLayersChangeHandler = b
                },
                getTooltipText: function(a) {
                    switch (a) {
                        case "color":
                            return "esriFieldTypeDate" === this.attributeType ? this.i18n.ColorDate_Tooltip : this.i18n.Color_Tooltip;
                        case "ageColor":
                            return this.i18n.ColorAge_Tooltip;
                        case "size":
                            return "predominancesize" === this.rendererStyle ? this.i18n.SizeForPredominanceTooltip : "esriFieldTypeDate" === this.attributeType ? this.i18n.SizeDate_Tooltip : this.i18n.Size_Tooltip;
                        case "ageSize":
                            return this.i18n.SizeAge_Tooltip;
                        case "simple":
                            return this.i18n.LocationTooltip;
                        case "unique":
                            return "esriFieldTypeDate" === this.attributeType ? this.i18n.TypeDate_Tooltip : this.i18n.Type_Tooltip;
                        case "heatMap":
                            return this.i18n.HeatMapTooltip;
                        case "predominance":
                            return this.i18n.PredominanceTooltip;
                        case "predominancesize":
                            return this.i18n.PredominanceSizeTooltip;
                        case "colorsize":
                            return "esriFieldTypeDate" === this.attributeType ? "esriFieldTypeDate" === this.attributeType2 ? this.i18n.ColorDate_SizeDate_Tooltip : this.i18n.ColorDate_Size_Tooltip : "esriFieldTypeDate" === this.attributeType2 ? this.i18n.Color_SizeDate_Tooltip :
                                this.i18n.Color_Size_Tooltip;
                        case "ageColorSize":
                            return "esriFieldTypeDate" === this.attributeType2 ? this.i18n.ColorAge_SizeDate_Tooltip : this.i18n.ColorAge_Size_Tooltip;
                        case "colorAgeSize":
                            return "esriFieldTypeDate" === this.attributeType ? this.i18n.ColorDate_SizeAge_Toooltip : this.i18n.Color_SizeAge_Tooltip;
                        case "uniquesize":
                            return "esriFieldTypeDate" === this.attributeType ? this.i18n.TypeDate_Size_Tooltip : "esriFieldTypeDate" === this.attributeType2 ? this.i18n.Type_SizeDate_Tooltip : this.i18n.Type_Size_Tooltip;
                        case "uniqueAgeSize":
                            return this.i18n.Type_SizeAge_Tooltip;
                        case "watercolor":
                            return "";
                        case "ratio":
                            return this.i18n.RatioTooltip;
                        case "relationship":
                            return this.i18n.Relationship_ToolTip;
                        case "relationshipSize":
                            return this.i18n.RelationshipSize_ToolTip;
                        case "copyStyle":
                            return this.i18n.CopyStyleTooltip
                    }
                }
            });
            n.setObject("arcgisonline.map.dijit.renderer.GalleryList", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/GalleryListItem": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/dom-style dojo/dom-class dojo/dom-construct dijit/Tooltip dijit/_Widget dijit/_Templated esri/lang dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/map/dijit/renderer/templates/GalleryListItem.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t) {
            b = g([p, r], {
                declaredClass: "arcgisonline.map.dijit.renderer.GalleryListItem",
                baseClass: "esriAGORendererGallery",
                basePath: b.toUrl("arcgisonline/map/renderer"),
                widgetsInTemplate: !0,
                templateString: t,
                type: null,
                timeline: "",
                constructor: function(a, b) {
                    this.type = a.type;
                    this.timeline = v.isDefined(a.timeline) ? a.timeline : "";
                    this.attributeType = a.attributeType;
                    this.attributeType2 = a.attributeType2;
                    this.tooltipText = a.tooltipText;
                    this.copyStyleLayers = a.copyStyleLayers;
                    this.selectHandler =
                        a.selectHandler;
                    this.optionsHandler = a.optionsHandler;
                    this.copyStyleLayersChangeHandler = a.copyStyleLayersChangeHandler
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = w.common;
                    n.mixin(this.i18n, w.rendererGalleryPanel)
                },
                postCreate: function() {
                    this.setTitle();
                    this.createTooltip();
                    "copyStyle" === this.type && (f.set(this._select, "display", "none"), f.set(this._selectCopyStyle, "display", ""))
                },
                destroy: function() {
                    this.tooltip && this.tooltip.destroy();
                    this.pageClickHandler && c.disconnect(this.pageClickHandler);
                    this.inherited(arguments)
                },
                setTitle: function() {
                    var a;
                    switch (this.type) {
                        case "simple":
                            a = this.i18n.location;
                            break;
                        case "unique":
                            a = "esriFieldTypeDate" === this.attributeType ? "rendererMultiAttributesPanel" === this.id ? this.i18n.typesShortForDate : this.i18n.types : "rendererMultiAttributesPanel" === this.id ? this.i18n.typesShort : this.i18n.types;
                            break;
                        case "color":
                            a = "esriFieldTypeDate" === this.attributeType ? "rendererMultiAttributesPanel" === this.id ? this.i18n.colorShortForDate : this.i18n.colorForDate : "rendererMultiAttributesPanel" ===
                                this.id ? this.i18n.colorShort : this.i18n.color;
                            break;
                        case "ageColor":
                            a = this.i18n.ageColor;
                            break;
                        case "size":
                            a = "esriFieldTypeDate" === this.attributeType ? "rendererMultiAttributesPanel" === this.id ? this.i18n.sizeShortForDate : this.i18n.sizeForDate : "rendererMultiAttributesPanel" === this.id ? this.i18n.sizeShort : this.i18n.size;
                            break;
                        case "ageSize":
                            a = this.i18n.ageSize;
                            break;
                        case "heatMap":
                            a = this.i18n.heatMap;
                            break;
                        case "predominance":
                            a = this.i18n.predominance;
                            break;
                        case "predominancesize":
                            a = this.i18n.predominanceSize;
                            break;
                        case "colorsize":
                            a = this.i18n.colorSize;
                            break;
                        case "ageColorSize":
                            a = this.i18n.ageColorSize;
                            break;
                        case "colorAgeSize":
                            a = this.i18n.colorAgeSize;
                            break;
                        case "uniquesize":
                            a = this.i18n.typeSize;
                            break;
                        case "uniqueAgeSize":
                            a = this.i18n.typeAgeSize;
                            break;
                        case "watercolor":
                            a = "Blended Style";
                            break;
                        case "ratio":
                            a = this.i18n.ratio;
                            break;
                        case "relationship":
                            a = this.i18n.relationship;
                            break;
                        case "relationshipSize":
                            a = this.i18n.relationshipSize;
                            break;
                        case "copyStyle":
                            a = this.i18n.copyStyle
                    }
                    this._titleText.innerHTML =
                        a
                },
                createTooltip: function() { this.tooltipText && (this.tooltip = new m({ connectId: this._thumb, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.tooltipText + "\x3c/div\x3e" })) },
                selectItem: function(a) {
                    f.set(this._title, "display", "");
                    f.set(this._select, "display", "none");
                    f.set(this._options, "display", "");
                    a ? f.set(this._check, "display", "none") : f.set(this._check, "display", "");
                    e.add(this._title, "checked")
                },
                disableButtons: function() {
                    this._selectButton.set("disabled", !0);
                    this._optionsButton.set("disabled", !0)
                },
                enableButtons: function() {
                    this._selectButton.set("disabled", !1);
                    this._optionsButton.set("disabled", !1)
                },
                hideButtons: function() {
                    f.set(this._select, "display", "none");
                    f.set(this._options, "display", "none");
                    f.set(this._thumb, "cursor", "auto")
                },
                isVisible: function() { return "none" !== f.set(this._root, "display") },
                disableOptionsButton: function() { this._optionsButton.set("disabled", !0) },
                enableOptionsButton: function() { this._optionsButton.set("disabled", !1) },
                reset: function() {
                    f.set(this._root, "display", "none"); - 1 < a.indexOf(["simple",
                        "unique", "color", "size"
                    ], this.type) && (e.remove(this._root, "point"), e.remove(this._root, "line"), e.remove(this._root, "polygon"));
                    this.enableButtons()
                },
                clearCheck: function() {
                    this._optionsButton.set("disabled", !1);
                    "copyStyle" === this.type ? f.set(this._selectCopyStyle, "display", "") : f.set(this._select, "display", "");
                    f.set(this._options, "display", "none");
                    f.set(this._check, "display", "none");
                    e.remove(this._title, "checked")
                },
                setGeometryType: function(a) { e.add(this._root, a) },
                setFieldInfo: function(a) {
                    a.length ? (this._field.innerHTML =
                        a, f.set(this._field, "display", "")) : (this._field.innerHTML = a, f.set(this._field, "display", "none"))
                },
                setVisible: function() { f.set(this._root, "display", "") },
                _onThumbClick: function(a) { "rendererSelectCopyStyleDiv" !== a.target.id && a.preventDefault(); if ("none" !== f.get(this._select, "display") || "none" !== f.get(this._options, "display")) "none" === f.get(this._options, "display") ? this._onSelect() : this._onOptions() },
                _onSelect: function(a) {
                    a && (a.preventDefault(), a.cancelBubble = !0, a.stopPropagation && a.stopPropagation());
                    this.selectHandler()
                },
                _onSelectCopyStyle: function(b) {
                    b && (b.preventDefault(), b.cancelBubble = !0, b.stopPropagation && b.stopPropagation());
                    "" === this._selectCopyStyleDropDown.innerHTML.trim() && a.forEach(this.copyStyleLayers, function(a) {
                        var b = h.create("a", { innerHTML: a.title, href: "JavaScript:void(0);", onclick: n.hitch(this, this._onSelectCopyStyleLayer, a.id) });
                        h.place(b, this._selectCopyStyleDropDown);
                        c.connect(b, "onclick", n.hitch(this, this._onSelectCopyStyleLayer, a.id))
                    }, this);
                    this.pageClickHandler = c.connect(this.ownerDocument.body,
                        "click", n.hitch(this, function(a) { f.set(this._selectCopyStyleDropDown, "display", "none") }));
                    f.set(this._selectCopyStyleDropDown, "display", "block")
                },
                _onSelectCopyStyleLayer: function(a, b) {
                    b.stopPropagation();
                    c.disconnect(this.pageClickHandler);
                    this.copyStyleLayersChangeHandler(a);
                    f.set(this._selectCopyStyleDropDown, "display", "none")
                },
                _onOptions: function(a) {
                    a && (a.preventDefault(), a.cancelBubble = !0, a.stopPropagation && a.stopPropagation());
                    this.optionsHandler()
                }
            });
            n.setObject("arcgisonline.map.dijit.renderer.GalleryListItem",
                b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/Simple": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/Evented dojo/on dojo/Deferred dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/dom-style dojo/dom-construct dojo/dom-class dojox/html/entities dijit/registry dijit/Tooltip dijit/Dialog esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_SimpleMixin arcgisonline/map/dijit/renderer/_OpacityMixin arcgisonline/map/dijit/renderer/_RendererMixin esri/renderers/SimpleRenderer esri/renderers/TemporalRenderer esri/symbols/SimpleLineSymbol arcgisonline/map/dijit/renderer/AttributeTransparencyDlg arcgisonline/map/dijit/renderer/AttributeTransparency dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Simple.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y) {
            b = b([X, N], {
                declaredClass: "arcgisonline.map.dijit.renderer.Simple",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererSimple",
                widgetsInTemplate: !0,
                templateString: y,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                streamPreviousSymbol: null,
                streamConnectLineSymbol: null,
                origGalleryRenderer: null,
                constructor: function(a,
                    b) {
                    g.mixin(this, M);
                    g.mixin(this, K);
                    g.mixin(this, P);
                    g.mixin(this, O);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.hideSymbolStyler();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(C.common);
                    g.mixin(this.i18n, C.rendererCommon);
                    g.mixin(this.i18n, C.rendererUniqueValuesPanel);
                    g.mixin(this.i18n, C.rendererSimplePanel);
                    g.mixin(this.i18n, C.rendererAttributeTransparencyDlg)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererSimplePanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                    a.connect(this._rendererSimpleSymbolTitle, "click", g.hitch(this, "onClickSymbol",
                        "main"));
                    a.connect(this._streamSymbolImage, "click", g.hitch(this, "onClickSymbol", "prevObs"));
                    a.connect(this._streamLineSymbolImage, "click", g.hitch(this, "onClickSymbol", "lineObs"));
                    a.connect(this._rendererSimpleRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererSimpleRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererSimpleRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(b) {
                    b.preventDefault();
                    this.hideSymbolStyler();
                    this.hideFieldDescriptionPopup();
                    this.hideLegendPopup();
                    this.isGeoRSS || this.isWFS || this.isSL ? (this.mapLayer._scaleChanged && (this.mapLayer.scaleChanged = !0), delete this.mapLayer._scaleChanged,
                            delete this.origRenderer.minScale, delete this.origRenderer.maxScale, this.mapLayer._opacityChanged && (this.mapLayer.opacityChanged = !0), delete this.mapLayer._opacityChanged, delete this.origRenderer.opacity, dojo.toJson(this.origRenderer.renderer) !== dojo.toJson(this.renderer.toJson()) && (this.mapLayer.rendererChanged = !0), a.publish("_onRendererUpdate", []), E.byId("rendererPanel").properClose = !0, isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()) :
                        leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    delete this.mapLayer._opacityChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    this.isGeoRSS || this.isWFS || this.isSL ? isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel() : leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererSimpleFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererSimpleHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this._rendererSimpleLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.layer.name && this.mapLayer.title !== this.layer.name && (this._rendererSimpleLayer.innerHTML +=
                        " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this.scheme = null;
                    this.transparencySlider = this.createTransparencySlider("rendererSimpleTransparencySlider");
                    this.createScaleSlider("rendererSimpleScaleSlider").then(dojo.hitch(this, function(a) { this.scaleSlider = a }));
                    this._rendererSimpleRotationAttribute.setStore(this.attributesStore, "", {
                        query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" +
                            this.layer.objectIdField + "'"
                    });
                    this.updateUIWithRenderer();
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    if (this.isSL && this.mapLayer.serviceInfo.timeInfo && this.mapLayer.serviceInfo.timeInfo.trackIdField) {
                        var a = this.i18n.drawPastObservations,
                            b = a.indexOf("${"),
                            c = a.indexOf("}");
                        m.byId("rendererStreamMsgPart1").innerHTML = a.substring(0, b);
                        m.byId("rendererStreamMsgPart2").innerHTML = a.substring(c + 1);
                        this.symbol = this.renderer.latestObservationRenderer ?
                            J.fromJson(this.renderer.latestObservationRenderer.symbol.toJson()) : J.fromJson(this.renderer.symbol.toJson());
                        this.renderer.observationRenderer ? (this.rendererStreamPreviousCheck.set("checked", !0), this.streamPreviousSymbol = J.fromJson(this.renderer.observationRenderer.symbol.toJson()), this.renderer.trackRenderer ? (this.rendererStreamConnectCheck.set("checked", !0), this.streamConnectLineSymbol = J.fromJson(this.renderer.trackRenderer.symbol.toJson())) : (this.rendererStreamConnectCheck.set("checked", !1), a =
                            A.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPolyline" }).primaryScheme, this.streamConnectLineSymbol = new W(W.STYLE_SOLID, new H(a.color), a.width))) : (this.rendererStreamPreviousCheck.set("checked", !1), this.rendererStreamConnectCheck.set("checked", !1), this.streamPreviousSymbol = J.fromJson(this.symbol.toJson()), this.streamPreviousSymbol.size = 2 * this.streamPreviousSymbol.size / 3, a = A.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: "esriGeometryPolyline" }).primaryScheme,
                            this.streamConnectLineSymbol = new W(W.STYLE_SOLID, new H(a.color), a.width));
                        this.mapLayer.layerDefinition && D.isDefined(this.mapLayer.layerDefinition.maximumTrackPoints) && 2 < this.mapLayer.layerDefinition.maximumTrackPoints ? this.rendererStreamMaxTrackPts.set("value", this.mapLayer.layerDefinition.maximumTrackPoints - 1) : 2 < this.mapLayer.layer.maximumTrackPoints ? this.rendererStreamMaxTrackPts.set("value", this.mapLayer.layer.maximumTrackPoints - 1) : this.rendererStreamMaxTrackPts.set("value", 5);
                        arcgisonline.map.symbol.drawSymbol(m.byId("panelStreamLineSymbolImage"),
                            this.streamConnectLineSymbol, this.template);
                        arcgisonline.map.symbol.drawSymbol(m.byId("panelStreamSymbolImage"), this.streamPreviousSymbol, this.template)
                    } else this.symbol = J.fromJson(this.renderer.symbol.toJson()), w.set(this._rendererSimpleStream, "display", "none");
                    if (this.hasDynamic && !this.newDMS || this.isGeoRSS || this.isWFS || this.isSL || !this.hasNumericField) v(".rendererSimpleHasAttributeTransparency").forEach(function(a) { w.set(a, "display", "none") }), x.remove(m.byId("rendererSimpleTransparencySliderDiv"),
                        "esriLeadingPadding1");
                    else {
                        a = this.i18n.setFromField;
                        b = a.indexOf("${field}");
                        this._rendererSimpleAttributeTransparencyLabel_part1.innerHTML = a.substring(0, b);
                        this._rendererSimpleAttributeTransparencyLabel_part3.innerHTML = a.substring(b + 8);
                        var d = this.getOpacityInfo();
                        d && d.field ? this.attributesStore.fetchItemByIdentity({
                            identity: d.field,
                            onItem: g.hitch(this, function(a) {
                                d.normalizationField ? this.attributesStore.fetchItemByIdentity({
                                    identity: d.normalizationField,
                                    onItem: g.hitch(this, function(b) {
                                        this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML =
                                            h.substitute(this.i18n.setFromFieldDividedBy, { field1: a.alias || a.name, field2: b.alias || b.name })
                                    })
                                }) : this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML = a.alias || a.name
                            })
                        }) : this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML = d && d.valueExpression ? this.getRendererCustomExpression(null, "transparency").title : this.i18n.attributeValues
                    }(this.isSL || this.isGeoRSS || this.isWFS) && w.set(this._rendererSimpleScaleSuggest, "display", "none");
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    this.isSymbolTransparent(this.symbol) ? this.drawTransparentSymbol(this._rendererSimpleSymbol) : (this.drawSymbol(this._rendererSimpleSymbol, this.symbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.symbol, this._rendererSimpleSymbol));
                    this.updateUIWithRenderer_Rotation()
                },
                updateUIWithRenderer_Rotation: function() {
                    this.disableAllEvents = !0;
                    w.set(this._rendererSimpleRotationEditExpression, "display", "none");
                    w.set(this._rendererSimpleRotationFieldDescription, "display", "none");
                    if (this.isGeoRSS ||
                        this.isWFS || !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType) w.set(this._rendererSimpleRotation, "display", "none");
                    else {
                        this.drawRotationSymbol(this.symbol, this._rendererSimpleRotateRightSymbol, this._rendererSimpleRotateLeftSymbol);
                        var a = this.renderer.rotationInfo || (this.renderer.latestObservationRenderer ? this.renderer.latestObservationRenderer.rotationInfo : null);
                        a || (a = this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables));
                        !a && this.renderer.latestObservationRenderer && (a = this.getVisualVariableByType("rotationInfo", null, this.renderer.latestObservationRenderer.visualVariables));
                        this._rendererSimpleRotationCheck.set("checked", a ? !0 : !1);
                        a && (this._rendererSimpleRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererSimpleRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererSimpleRotationAttribute.set("value",
                            a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) { a && a.descriptionValue && w.set(this._rendererSimpleRotationFieldDescription, "display", "") }))) : a.valueExpression && (this._rendererSimpleRotationAttribute.set("value", "customExprRotation"), w.set(this._rendererSimpleRotationEditExpression, "display", "")));
                        w.set(this._rendererSimpleRotation, "display", "");
                        w.set(this._rendererSimpleRotationContent, "display", a ? "" : "none")
                    }
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }),
                        1E3);
                    this.adjustHeight()
                },
                createTooltips: function() {
                    var a = function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" };
                    this.tooltips.push(new G({ connectId: this._rendererSimpleTransparencyTitle, label: a(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleTransparencyOverallTitle, label: a(this.i18n.overallTransparencyTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleTransparencyPerFeatureTitle, label: a(this.i18n.perFeaturesTransparencyTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleScaleTitle, label: a(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleScaleSuggest, label: a(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleRotationText, label: a(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleRotationAttribute.domNode, label: a(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new G({
                        connectId: this._rendererSimpleSymbol,
                        label: a(this.i18n.symbolsTooltip)
                    }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleSymbolText, label: a(this.i18n.symbolsTooltip) }));
                    this.tooltips.push(new G({ connectId: this.rendererStreamPreviousMsg, label: a(this.i18n.drawPastObservastionsTooltip) }));
                    this.tooltips.push(new G({ connectId: this.rendererStreamConnectObservationsMsg, label: a(this.i18n.connectObservationsTooltip) }));
                    this.tooltips.push(new G({
                        connectId: this._rendererSimpleRotationEditExpression,
                        label: "\x3cdiv class\x3d'galleryTooltip'\x3e" +
                            this.i18n.editExpression + "\x3c/div\x3e"
                    }));
                    this.tooltips.push(new G({ connectId: this._rendererSimpleRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                onUpdateSymbol: function(a, b) {
                    "prevObs" === a ? (this.streamPreviousSymbol = b, this.renderer.observationRenderer && (this.renderer.observationRenderer.symbol = J.fromJson(b.toJson())), this.drawSymbol(this._streamSymbolImage, this.streamPreviousSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.streamPreviousSymbol,
                        this._streamSymbolImage)) : "lineObs" === a ? (this.streamConnectLineSymbol = b, this.renderer.trackRenderer && (this.renderer.trackRenderer.symbol = J.fromJson(b.toJson())), this.drawSymbol(this._streamLineSymbolImage, this.streamConnectLineSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.streamConnectLineSymbol, this._streamLineSymbolImage)) : (this.symbol = b, this.renderer.latestObservationRenderer ? this.renderer.latestObservationRenderer.symbol = J.fromJson(b.toJson()) : this.renderer.symbol = J.fromJson(b.toJson()),
                        this.isSymbolTransparent(this.symbol) ? this.drawTransparentSymbol(this._rendererSimpleSymbol) : (this.drawSymbol(this._rendererSimpleSymbol, this.symbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.symbol, this._rendererSimpleSymbol)), this.isGeoRSS || this.isWFS || !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || this.drawRotationSymbol(this.symbol, this._rendererSimpleRotateRightSymbol, this._rendererSimpleRotateLeftSymbol));
                    this.applySimpleRenderer(this.renderer);
                    this.adjustHeight()
                },
                _onChangeRotation: function(a) { this.disableAllEvents || (w.set(this._rendererSimpleRotationContent, "display", a ? "" : "none"), this.adjustHeight(), this.updateRotationInfo()) },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererSimpleRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererSimpleRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b = a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererSimpleRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                                    this._rendererSimpleRotationAttribute.set("value", "customExprRotation", !1);
                                    a = { valueExpression: a.valueExpression, valueExpressionTitle: a.valueExpressionTitle, rotationType: this._rendererSimpleRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                    this.renderer.latestObservationRenderer ? (this.renderer.observationRenderer.setRotationInfo(null), this.renderer.latestObservationRenderer.setRotationInfo(null)) : this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.latestObservationRenderer ? (this.renderer.observationRenderer.setVisualVariables(c), this.renderer.latestObservationRenderer.setVisualVariables(c)) : this.renderer.setVisualVariables(c);
                                    this.applySimpleRenderer(this.renderer);
                                    this.updateUIWithRenderer_Rotation()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b, "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b,
                                        "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", h.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo();
                                    this.updateUIWithRenderer_Rotation()
                                }), g.hitch(this, function() { this.updateUIWithRenderer_Rotation() }))
                            })
                        });
                        else {
                            w.set(this._rendererSimpleRotationEditExpression, "display", "none");
                            if (this.hasDynamic && !this.newDMS) this.renderer.rotationType = this._rendererSimpleRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic",
                                this.renderer.rotationExpression = "[" + this._rendererSimpleRotationAttribute.get("value") + "]";
                            else {
                                var a = { field: this._rendererSimpleRotationAttribute.get("value"), rotationType: this._rendererSimpleRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic", type: "rotationInfo" };
                                this.getAttributeItemFromStore(this._rendererSimpleRotationAttribute.get("value")).then(g.hitch(this, function(a) {
                                    a && a.descriptionValue ? w.set(this._rendererSimpleRotationFieldDescription, "display", "") : w.set(this._rendererSimpleRotationFieldDescription,
                                        "display", "none")
                                }));
                                if (this.renderer.latestObservationRenderer) {
                                    this.renderer.observationRenderer.setRotationInfo(null);
                                    this.renderer.latestObservationRenderer.setRotationInfo(null);
                                    var b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.observationRenderer.visualVariables) || [];
                                    b.push(a);
                                    this.renderer.observationRenderer.setVisualVariables(b);
                                    b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.latestObservationRenderer.visualVariables) || [];
                                    b.push(a);
                                    this.renderer.latestObservationRenderer.setVisualVariables(b)
                                } else this.renderer.setRotationInfo(null), b = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [], b.push(a), this.renderer.setVisualVariables(b)
                            }
                            this.applySimpleRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.latestObservationRenderer ? (this.renderer.observationRenderer.setRotationInfo(null), this.renderer.latestObservationRenderer.setRotationInfo(null)) : this.renderer.setRotationInfo(null),
                        this.removeRotationInfoVisualVariable(), this.applySimpleRenderer(this.renderer), this.adjustHeight()
                },
                _onChangeStreamPrevious: function() { this.disableAllEvents || (this.rendererStreamPreviousCheck.get("checked") || this.rendererStreamConnectCheck.set("checked", !1), this.updateStreamSymbols()) },
                _onChangeStreamMaxTrackPts: function(a) { this.disableAllEvents || (this.rendererStreamPreviousCheck.get("checked") ? this.updateStreamSymbols() : this.rendererStreamPreviousCheck.set("checked", !0)) },
                _onChangeStreamConnect: function() {
                    this.disableAllEvents ||
                        (this.rendererStreamConnectCheck.get("checked") ? this.rendererStreamPreviousCheck.get("checked") ? this.updateStreamSymbols() : this.rendererStreamPreviousCheck.set("checked", !0) : this.updateStreamSymbols())
                },
                updateStreamSymbols: function() {
                    var a = this.renderer.latestObservationRenderer ? this.renderer.latestObservationRenderer.rotationInfo : this.renderer.rotationInfo,
                        b;
                    a || (b = this.getVisualVariableByType("rotationInfo", null, this.renderer.visualVariables));
                    a || b || !this.renderer.latestObservationRenderer || (b = this.getVisualVariableByType("rotationInfo",
                        null, this.renderer.latestObservationRenderer.visualVariables));
                    if (this.rendererStreamPreviousCheck.get("checked")) {
                        var c = new R(this.symbol);
                        a && c.setRotationInfo(a);
                        b && c.setVisualVariables([b]);
                        var d = new R(this.streamPreviousSymbol);
                        a && d.setRotationInfo(a);
                        b && d.setVisualVariables([b]);
                        this.rendererStreamConnectCheck.get("checked") ? (a = new R(this.streamConnectLineSymbol), this.renderer = new S(d, c, a, null)) : this.renderer = new S(d, c, null, null);
                        this.mapLayer.layerDefinition = this.mapLayer.layerDefinition || {};
                        this.mapLayer.layerDefinition.maximumTrackPoints = this.rendererStreamMaxTrackPts.get("value") + 1;
                        this.mapLayer.layer.setMaximumTrackPoints(this.mapLayer.layerDefinition.maximumTrackPoints);
                        this.mapLayer.maximumTrackPointsChanged = !0
                    } else this.renderer = new R(this.symbol), a && this.renderer.setRotationInfo(a), b && this.renderer.setVisualVariables([b]), this.mapLayer.layerDefinition && D.isDefined(this.mapLayer.layerDefinition.maximumTrackPoints) && 1 !== this.mapLayer.layerDefinition.maximumTrackPoints && (this.mapLayer.maximumTrackPointsChanged = !0, this.mapLayer.layerDefinition = this.mapLayer.layerDefinition || {}, this.mapLayer.layerDefinition.maximumTrackPoints = 1, this.mapLayer.layer.setMaximumTrackPoints(1));
                    this.applySimpleRenderer(this.renderer)
                },
                onClickSymbol: function(a, b) {
                    b = this.symbol;
                    "prevObs" === a ? b = this.streamPreviousSymbol : "lineObs" === a && (b = this.streamConnectLineSymbol);
                    var c = A.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(b, {
                        externalSizing: !1,
                        optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                        schemes: c
                    }, g.hitch(this, "onSymbolChange", a))
                },
                onSymbolChange: function(a, b, c, d, e) {
                    this.scheme = d || this.scheme;
                    c = b.toJson();
                    "esriPMS" != b.type || 0 != c.url.length && "http://" != c.url || (b = J.fromJson(this.getMarkerJson()));
                    e ? (b = this.setOutlineWidthOfSymbol(b, 1), this.getSuggestedOutline().then(g.hitch(this, function(a, b, c) {
                        this.replaceVisualVariable("sizeInfo", "outline", c.widthInfo, this.renderer);
                        this.onUpdateSymbol(a, b)
                    }, a, b), g.hitch(this, function(a, b, c) {
                        c = this.getVisualVariablesExceptTypes([{
                            type: "sizeInfo",
                            target: "outline"
                        }], this.renderer.visualVariables);
                        this.renderer.setVisualVariables(c);
                        this.onUpdateSymbol(a, b)
                    }, a, b))) : (e = this.getVisualVariablesExceptTypes([{ type: "sizeInfo", target: "outline" }], this.renderer.visualVariables), this.renderer.setVisualVariables(e), this.onUpdateSymbol(a, b))
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                _onClickAttributeTransparency: function() {
                    this.getVisualVariableByType("opacityInfo", null, this.renderer.visualVariables);
                    this.attributeTransparencyDlg =
                        (new F({ id: "attributeTransparencyDlg", style: "visibility:hidden;" })).placeAt(document.body);
                    this.attributeTransparencyDlgContent = new U({ id: "attributeTransparencyDlgContent", dialog: this.attributeTransparencyDlg, style: "width:100%;" });
                    this.attributeTransparencyDlgHideHandler = a.connect(this.attributeTransparencyDlg, "onHide", g.hitch(this, function() { this.destroyAttributeTransparencyDlg() }));
                    this.attributeTransparency = new V({
                        attributesStore: this.attributesStore,
                        layer: this.fLayer || this.layer,
                        mapLayer: this.mapLayer,
                        showDateFields: this.showDateFields,
                        numHistogramBins: this.numHistogramBins,
                        savedRenderers: this.savedRenderers
                    }, "attributeTransparencyDlgContent");
                    this.attributeTransparencyDlg.set({ title: this.i18n.attributeTransparencyDlgTitle, content: this.attributeTransparency });
                    this.attributeTransparencyCommitHandler = a.subscribe("attribute-transparency-commit", g.hitch(this, function(a) {
                        this.hideAttributeTransparencyDlg();
                        if (a.opacityInfo) this.replaceVisualVariable("opacityInfo", null, a.opacityInfo, this.renderer), this.renderer.authoringInfo =
                            a.authoringInfo, this.applySimpleRenderer(this.renderer), a.opacityInfo.field ? this.attributesStore.fetchItemByIdentity({
                                identity: a.opacityInfo.field || "customExprTrans",
                                onItem: g.hitch(this, function(b) {
                                    a.opacityInfo.normalizationField ? this.attributesStore.fetchItemByIdentity({ identity: a.opacityInfo.normalizationField, onItem: g.hitch(this, function(a) { this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML = h.substitute(this.i18n.setFromFieldDividedBy, { field1: b.alias || b.name, field2: a.alias || a.name }) }) }) :
                                        this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML = a.opacityInfo.field ? b.alias || b.name : this.getRendererCustomExpression(null, "transparency").title
                                })
                            }) : a.opacityInfo.valueExpression && (this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML = this.getRendererCustomExpression(null, "transparency").title);
                        else {
                            var b = this.getVisualVariablesExceptType("opacityInfo", null, this.renderer.visualVariables);
                            this.renderer.setVisualVariables(b);
                            this.applySimpleRenderer(this.renderer);
                            this._rendererSimpleAttributeTransparencyLabel_part2.innerHTML =
                                this.i18n.attributeValues
                        }
                    }));
                    this.attributeTransparencyStopHandler = a.subscribe("attribute-transparency-stop", g.hitch(this, function() { this.hideAttributeTransparencyDlg() }));
                    this.attributeTransparencyDlg.show().then(g.hitch(this, function() { w.set(this.attributeTransparencyDlg.domNode, "visibility", "visible") }))
                },
                hideAttributeTransparencyDlg: function() { this.attributeTransparencyDlg && this.attributeTransparencyDlg.hide() },
                destroyAttributeTransparencyDlg: function() {
                    this.attributeTransparencyDlgHideHandler &&
                        a.disconnect(this.attributeTransparencyDlgHideHandler);
                    this.attributeTransparencyDlgHideHandler = null;
                    this.attributeTransparencyCommitHandler && this.attributeTransparencyCommitHandler.remove();
                    this.attributeTransparencyCommitHandler = null;
                    this.attributeTransparencyStopHandler && this.attributeTransparencyStopHandler.remove();
                    this.attributeTransparencyStopHandler = null;
                    this.attributeTransparency && this.attributeTransparency.destroy();
                    this.attributeTransparency = null;
                    this.attributeTransparencyDlgContent && this.attributeTransparencyDlgContent.destroy();
                    this.attributeTransparencyDlgContent = null;
                    this.attributeTransparencyDlg && this.attributeTransparencyDlg.destroy();
                    this.attributeTransparencyDlg = null;
                    E.byId("attributeTransparencyDlg") && E.byId("attributeTransparencyDlg").destroy()
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel && "rendererSimpleStack" == leftPanel.visibleStack) {
                        a = c.coords(m.byId("leftContentStackContainer")).h;
                        var b = c.coords(m.byId("rendererSimpleHeader")).h,
                            d = c.coords(this._rendererSimpleTop.domNode).h,
                            e = c.coords(this._doneChangingButton.domNode).h -
                            5,
                            f = c.coords(m.byId("rendererSimpleFooter_links")).h + 10;
                        w.set(m.byId("rendererSimpleFooterDiv"), "height", f + "px");
                        a = a - b - d - e - f - 23;
                        0 < a && w.set(m.byId("renderer-simple-bottom"), "height", a + "px");
                        newWidth = c.coords(m.byId("leftContentStackContainer")).w - 16;
                        if (0 < newWidth) {
                            a = 0;
                            if ("none" !== w.get(this._rendererSimpleRotationEditExpression, "display") || "none" !== w.get(this._rendererSimpleRotationFieldDescription, "display")) a = 30;
                            w.set(this._rendererSimpleRotationAttribute.domNode, "width", newWidth - a - 38 + "px");
                            v(".dijitSelectLabel",
                                this._rendererSimpleRotationAttribute.domNode).style("maxWidth", newWidth - a - 68 + "px");
                            this.hasDynamic || this.isGeoRSS || this.isWFS || this.isSL ? this.transparencySlider && w.set(this.transparencySlider.domNode, "width", newWidth - 30 + "px") : this.transparencySlider && w.set(this.transparencySlider.domNode, "width", newWidth - 40 + "px");
                            this.scaleSlider && w.set(this.scaleSlider.domNode, "width", newWidth - 30 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Simple", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_SimpleMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/Deferred esri/lang esri/symbols/jsonUtils esri/styles/basic esri/renderers/SimpleRenderer".split(" "),
        function(b, g, n, a, c, d, f, e, h) {
            return {
                buildSimpleRenderer: function() {
                    var a = new c;
                    if (this.isFeatColl || this.isCSV || this.isSL || this.hasDynamic) this.buildSimpleRendererGo(null, a);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var b = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !b.canCreate && (b.canUpdate || b.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildSimpleRendererGo(!0, a) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ?
                                this.buildSimpleRendererGo(!0, a) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildSimpleRendererGo(!0, a) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { a.reject() }) })
                        } else this.buildSimpleRendererGo(null, a), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField,
                            delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildSimpleRendererGo(null, a);
                    return a
                },
                buildSimpleRendererGo: function(a, b) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    this.hasDynamic = arcgisonline.map.main.hasDynamicLayers(this.mapLayer);
                    a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0);
                    this.scheme || (this.scheme = e.getSchemes({
                        theme: "default",
                        basemap: this.getBasemapType(),
                        geometryType: this.geometryType
                    }).primaryScheme);
                    this.symbol = this.applySchemeToSymbol(this.symbol, this.scheme);
                    a = new h(this.symbol);
                    this.renderer.rotationInfo && (a.setRotationInfo(this.renderer.rotationInfo), this.removeRotationInfoVisualVariable(a));
                    delete this.authoringInfo;
                    this.hasDynamic ? b.resolve(a) : this.getSuggestedOutline().then(g.hitch(this, function(a, c) {
                        this.replaceVisualVariable("sizeInfo", "outline", c.widthInfo, a);
                        b.resolve(a)
                    }, a), g.hitch(this, function(a, c) {
                        c = this.getVisualVariablesExceptTypes([{
                            type: "sizeInfo",
                            target: "outline"
                        }, { type: "sizeInfo" }, { type: "colorInfo" }], a.visualVariables);
                        a.setVisualVariables(c);
                        b.resolve(a)
                    }, a))
                },
                applySimpleRenderer: function(a) {
                    var b;
                    b = this.isWFS ? "simple" : this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    !this.hasDynamic && "simple" !== b && this.scheme && d.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) ||
                        this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/HeatMap": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/TooltipDialog dijit/Tooltip esri/lang esri/styles/basic esri/styles/heatmap esri/symbols/jsonUtils esri/renderers/jsonUtils esri/dijit/HorizontalSlider esri/renderers/smartMapping arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_HeatMapMixin arcgisonline/map/dijit/renderer/_RendererMixin dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/HeatMap.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W) {
            b = b([R, S], {
                declaredClass: "arcgisonline.map.dijit.renderer.HeatMap",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererHeatMap",
                widgetsInTemplate: !0,
                templateString: W,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                origGalleryRenderer: null,
                constructor: function(a, b) {
                    g.mixin(this, M);
                    g.mixin(this, K);
                    g.mixin(this, P);
                    a && (a.containerNode &&
                        (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.heatMapSlider && this.heatMapSlider.destroy();
                    this.influenceSlider && this.influenceSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(O.common);
                    g.mixin(this.i18n, O.rendererCommon);
                    g.mixin(this.i18n, O.rendererHeatMapPanel)
                },
                postCreate: function() {
                    this.container.addChild(dijit.byId("rendererHeatMapPanel"));
                    this.loadConnections()
                },
                loadConnections: function() { this._rConnects.push(a.connect(dijit.byId("leftContentPanel"), "resize", this, "adjustHeight")) },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.hideSymbolStyler();
                    leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererHeatMapFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    isEmbedded && isEmbedded.isItemDetail && dojo.style(dojo.byId("rendererHeatMapHeader"), "display", "none");
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this._rendererHeatMapLayer.innerHTML = x.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId &&
                        this.mapLayer.title !== this.layer.name && (this._rendererHeatMapLayer.innerHTML += " - " + x.encode(this.layer.name.replace(/\_/g, " ")));
                    this._rendererHeatMapField.innerHTML = this.attributeItem ? this.attributeItem.alias : this.i18n.heatMap;
                    this.influenceSlider = new J({ labels: [this.i18n.smaller, this.i18n.larger], minimum: 1, maximum: 25, value: this.renderer.blurRadius || 10, intermediateChanges: !1, onChange: g.hitch(this, "onInfluenceSliderChange") }, "rendererHeatMapInfluenceSlider");
                    this.influenceSlider.startup();
                    this.transparencySlider =
                        this.createTransparencySlider("rendererHeatMapTransparencySlider");
                    this.createScaleSlider("rendererHeatMapScaleSlider").then(dojo.hitch(this, function(a) { this.scaleSlider = a }));
                    this.updateUIWithRenderer();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3);
                    this.createTooltips();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.influenceSlider.set("value", this.renderer.blurRadius || 10);
                    esriGeowConfig.isRightToLeft ? setTimeout(g.hitch(this, function() {
                        this.createHeatMapSlider({}).then(g.hitch(this,
                            function() { this.adjustHeight() }))
                    }), 500) : this.createHeatMapSlider({}).then(g.hitch(this, function() { this.adjustHeight() }))
                },
                createTooltips: function() {
                    var a = function(a) { return "\x3cdiv class\x3d'rendererTooltip'\x3e" + a + "\x3c/div\x3e" };
                    this.tooltips.push(new E({ connectId: this._rendererHeatMapInfluenceTitle, label: a(this.i18n.areaOfInfluenceTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererHeatMapWeightedText, label: a(this.i18n.weightedByTooltip) }));
                    this.tooltips.push(new E({
                        connectId: this._rendererHeatMapTransparencyTitle,
                        label: a(this.i18n.transparencyTooltip)
                    }));
                    this.tooltips.push(new E({ connectId: this._rendererHeatMapScaleTitle, label: a(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererHeatMapScaleSuggest, label: a(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new E({ connectId: this._rendererHeatMapSymbolsTitle, label: a(this.i18n.symbolsTooltip) }))
                },
                _onClickSymbols: function() {
                    if (!this.disableAllEvents) {
                        var a = D.getSchemes({ theme: "default", basemap: this.getBasemapType(), geometryType: this.geometryType }),
                            b = n.map(this.renderer.colorStops, function(a) { return a.color }),
                            c = [],
                            d = [];
                        n.forEach(b, function(a) { var b = "" + a.r + "," + a.g + "," + a.b; - 1 === n.indexOf(d, b) && (c.push(a), d.push(b)) });
                        this.showSymbolStyler(null, { externalSizing: !1, schemes: a, selected: { colors: c, scheme: this.scheme }, numStops: 0 }, g.hitch(this, "onSymbolsChange"))
                    }
                },
                onSymbolsChange: function(a, b, c) {
                    this.scheme = { colors: b, colorsForClassBreaks: [] };
                    L.applyHeatmapScheme({ renderer: this.renderer, scheme: this.scheme });
                    this.heatMapSlider.set("colorStops", g.clone(this.renderer.colorStops));
                    this.applyHeatMapRenderer(this.renderer)
                },
                onInfluenceSliderChange: function() {
                    this.disableAllEvents || this.getParams().then(g.hitch(this, function(a) {
                        this.updateRendererWithNewStatistics(a).then(g.hitch(this, function(a) {
                            this.renderer = a;
                            this.applyHeatMapRenderer(this.renderer)
                        }))
                    }))
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                getParams: function() {
                    var a = new r,
                        b = this.attributeItem ? {
                            field: -1 < n.indexOf(["esriFieldTypeSingle", "esriFieldTypeDouble", "esriFieldTypeInteger", "esriFieldTypeSmallInteger"],
                                this.attributeItem.type) ? this.attributeItem.name : null,
                            blurRadius: this.influenceSlider.get("value")
                        } : { blurRadius: this.influenceSlider.get("value") };
                    a.resolve(b);
                    return a
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererHeatMapStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererHeatMapTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererHeatMapFooter_links")).h + 10;
                        w.set(f.byId("rendererHeatMapFooterDiv"),
                            "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && w.set(f.byId("renderer-heatmap-content"), "height", a + "px");
                        newWidth = c.coords(f.byId("leftContentStackContainer")).w - 35;
                        0 < newWidth && (this.influenceSlider && w.set(this.influenceSlider.domNode, "width", newWidth - 35 + "px"), this.transparencySlider && w.set(this.transparencySlider.domNode, "width", newWidth - 35 + "px"), this.scaleSlider && w.set(this.scaleSlider.domNode, "width", newWidth - 35 + "px"));
                        var g = 40;
                        m(".toolsLabel").forEach(function(a) { g = Math.max(g, c.coords(a).w) });
                        m(".toolsColumnTD").style("width",
                            g + 10 + "px")
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.HeatMap", b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_HeatMapMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom dojo/Deferred dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/choropleth esri/renderers/smartMapping esri/plugins/FeatureLayerStatistics esri/dijit/HeatmapSlider esri/renderers/HeatmapRenderer".split(" "), function(b, g, n, a, c, d, f, e, h, m, p, r, v, w) {
        return {
            buildHeatMapRenderer: function(a) {
                var b =
                    new d;
                setTimeout(function() { b.progress(b) }, 1);
                a = a || {};
                if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildHeatMapRendererGo(null, a, b);
                else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                    if (this.isOwnerOfHostedFS) {
                        var c = this.layer.getEditCapabilities();
                        !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildHeatMapRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ?
                            this.buildHeatMapRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildHeatMapRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { b.reject() }) })
                    } else this.buildHeatMapRendererGo(null, a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField,
                        delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                else this.buildHeatMapRendererGo(null, a, b);
                return b
            },
            buildHeatMapRendererGo: function(a, b, c) {
                arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                this.hasDynamic = arcgisonline.map.main.hasDynamicLayers(this.mapLayer);
                p.createHeatmapRenderer({ layer: this.layer, basemap: this.getBasemapType(), blurRadius: null, field: b.field, scheme: this.scheme }).then(g.hitch(this, function(b) {
                    c.isRejected() || (this.scheme = b.scheme,
                        a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0), delete this.authoringInfo, c.resolve(b.renderer, b.statistics))
                }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createHeatmapRenderer", !0), c.reject()) }))
            },
            applyHeatMapRenderer: function(a) {
                var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                this.setRenderer(a);
                !this.hasDynamic && "heatMap" !== b && this.scheme && e.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity),
                    this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                this.updateLegendPopup();
                this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer)
            },
            createHeatMapSlider: function(a) {
                var b = new d;
                setTimeout(function() { b.progress(b) }, 1);
                a = a || {};
                this.createSlider = g.hitch(this, function() {
                    this.heatMapSlider =
                        new v({ colorStops: g.clone(this.renderer.colorStops) }, "rendererHeatMapSlider");
                    this.heatMapSlider.startup();
                    this.sliderChangeHandler = this.heatMapSlider.on("handle-value-change", g.hitch(this, function(a) {
                        this.renderer.setColorStops(a);
                        this.applyHeatMapRenderer(this.renderer)
                    }))
                });
                this.destroyHeatMapSlider();
                a.statistics ? this.createSlider(a) : this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                    b.isRejected() || this.layer.statisticsPlugin.getHeatmapStatistics({
                        blurRadius: a.blurRadius,
                        field: a.field
                    }).then(g.hitch(this, function(c) { b.isRejected() || (a.statistics = c, this.createSlider(a), b.resolve()) }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHeatmapStatistics", !1), b.reject()) }))
                }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                return b
            },
            updateRendererWithNewStatistics: function(a) {
                var b = new d;
                setTimeout(function() { b.progress(b) }, 1);
                this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                    b.isRejected() ||
                        this.layer.statisticsPlugin.getHeatmapStatistics({ blurRadius: a.blurRadius, field: a.field }).then(g.hitch(this, function(c) { b.isRejected() || (this.renderer.setField(a.field), this.renderer.setBlurRadius(a.blurRadius), this.renderer.setMinPixelIntensity(c.min), this.renderer.setMaxPixelIntensity(c.max), b.resolve(this.renderer)) }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "getHeatmapStatistics", !1), b.reject()) }))
                }), g.hitch(this, function(a) {
                    b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject())
                }));
                return b
            },
            destroyHeatMapSlider: function() {
                this.sliderChangeHandler && this.sliderChangeHandler.remove();
                this.sliderChangeHandler = null;
                this.heatMapSlider && this.heatMapSlider.destroy();
                c.byId("rendererHeatMapSlider") || f.create("div", { id: "rendererHeatMapSlider" }, c.byId("rendererHeatMapSliderDiv"))
            }
        }
    })
}, "esri/dijit/HeatmapSlider": function() {
    define("../kernel ../dijit/RendererSlider ../dijit/RendererSlider/sliderUtils dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/debounce dojo/dom-style dojo/Evented dojo/has dojox/gfx dojo/i18n!../nls/jsapi dojo/text!./HeatmapSlider/templates/HeatmapSlider.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t) {
            n = f([c, a, p], {
                declaredClass: "esri.dijit.HeatmapSlider",
                baseClass: "esriHeatmapSlider",
                templateString: t,
                rampWidth: 26,
                minSliderValue: 0,
                maxSliderValue: 1,
                showLabels: !0,
                showTicks: !0,
                showHandles: !0,
                _rampNode: null,
                _sliderHeight: null,
                _colorRampSurface: null,
                _surfaceRect: null,
                _updateTimer: null,
                constructor: function(a, b) {
                    this.inherited(arguments);
                    b && (this._updateTimeout = h(this._updateTimeout, 0))
                },
                postCreate: function() {
                    this.inherited(arguments);
                    this._setupDataDefaults()
                },
                startup: function() {
                    this.inherited(arguments);
                    this._slider = new g({ type: "HeatmapSlider", values: this.values, minimum: this.minSliderValue, maximum: this.maxSliderValue, precision: 2, showLabels: this.showLabels, showTicks: this.showTicks, showHandles: this.showHandles, minLabel: w.widgets.rendererSlider.low, maxLabel: w.widgets.rendererSlider.high }, this._sliderNode);
                    this._slider.startup();
                    this._rampNode = this._slider._sliderAreaRight;
                    this._sliderHeight = m.get(this._rampNode, "height") || 155;
                    this._createSVGSurfaces();
                    this._slider.on("slide",
                        e.hitch(this, function(a) {
                            this._updateColorStops(a.values[0], a.values[1]);
                            this._fillRamp()
                        }));
                    this._slider.on("change", e.hitch(this, function(a) {
                        this.set("values", [a.values[0], a.values[1]]);
                        this.emit("change", e.clone(this.colorStops))
                    }));
                    this._slider.on("handle-value-change", e.hitch(this, function(a) { this._updateRendererSlider() }));
                    this._slider.on("data-value-change", e.hitch(this, function(a) { this._updateRendererSlider() }));
                    this._slider.on("stop", e.hitch(this, function(a) {
                        this.emit("handle-value-change",
                            e.clone(this.colorStops))
                    }));
                    this.watch("colorStops", this._updateTimeout)
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._slider && this._slider.destroy()
                },
                _updateTimeout: function() { this._updateRendererSlider() },
                _updateRendererSlider: function() {
                    this.set("values", [this.colorStops[3].ratio, this.colorStops[this.colorStops.length - 1].ratio]);
                    this._slider.set("values", this.values);
                    this._slider._reset();
                    this._slider._updateRoundedLabels();
                    this._slider._generateMoveables();
                    this._clearRect();
                    this._createSVGSurfaces()
                },
                _setupDataDefaults: function() { this.set("values", [this.colorStops[3].ratio, this.colorStops[this.colorStops.length - 1].ratio]) },
                _createSVGSurfaces: function() {
                    this._colorRampSurface = v.createSurface(this._rampNode, this.rampWidth - 2, this._sliderHeight - 2);
                    m.set(this._colorRampSurface.rawNode, "border", "1px solid #888");
                    this._surfaceRect = this._colorRampSurface.createRect({ width: this.rampWidth, height: this._sliderHeight });
                    this._fillRamp()
                },
                _clearRect: function() { this._colorRampSurface.destroy() },
                _updateColorStops: function(a,
                    b) {
                    d.forEach(this.colorStops, e.hitch(this, function(c, d) {
                        var e = this.colorStops.length - 1;
                        2 < d && (c.ratio = a + (d - 3) / (e - 3) * (b - a), 3 === d && c.ratio < this.colorStops[2].ratio && (c.ratio = this.colorStops[2].ratio))
                    }))
                },
                _fillRamp: function() {
                    var a = this.colorStops.slice(0);
                    d.forEach(a, function(a) { a.offset = 1 - a.ratio });
                    a.reverse();
                    this._surfaceRect.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: this._sliderHeight / .99, colors: a })
                }
            });
            e.setObject("dijit.HeatmapSlider", n, b);
            return n
        })
}, "arcgisonline/map/dijit/renderer/Ratio": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/number dojo/aspect dojo/Deferred dojo/dom-class dojo/dom-style dojo/dom-construct dojox/html/entities dijit/registry dijit/TooltipDialog dijit/Tooltip dojo/store/Memory dojo/data/ObjectStore esri/lang esri/styles/basic esri/Color esri/symbols/jsonUtils esri/renderers/jsonUtils esri/styles/choropleth arcgisonline/map/dijit/renderer/_SymbolsMixin arcgisonline/map/dijit/renderer/_LabelsMixin arcgisonline/map/dijit/renderer/_ColorMixin arcgisonline/map/dijit/renderer/_RatioMixin arcgisonline/map/dijit/renderer/_RendererMixin arcgisonline/map/dijit/renderer/_PrecisionMixin esri/renderers/SimpleRenderer esri/symbols/SimpleLineSymbol dojo/i18n!arcgisonline/nls/arcgisonline dijit/_Widget dijit/_Templated dojo/text!arcgisonline/map/dijit/renderer/templates/Ratio.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u) {
            b = b([y, q], {
                declaredClass: "arcgisonline.map.dijit.renderer.Ratio",
                basePath: require.toUrl("arcgisonline/map/dijit/renderer"),
                baseClass: "esriAGORendererRatio",
                widgetsInTemplate: !0,
                templateString: u,
                _rConnects: [],
                tooltips: [],
                i18n: null,
                disableAllEvents: !0,
                container: null,
                subLayerId: null,
                mapLayer: null,
                layer: null,
                renderer: null,
                symbol: null,
                scheme: null,
                colorRendererGrid: null,
                origGalleryRenderer: null,
                constructor: function(a,
                    b) {
                    g.mixin(this, O);
                    g.mixin(this, R);
                    g.mixin(this, S);
                    g.mixin(this, W);
                    g.mixin(this, U);
                    g.mixin(this, V);
                    a && (a.containerNode && (this.container = a.containerNode), this.params = a.params, g.mixin(this, a.params), this._rConnects = [])
                },
                destroy: function() {
                    this.destroyBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.colorSlider && this.colorSlider.destroy();
                    this.scaleSlider && this.scaleSlider.destroy();
                    this.transparencySlider && this.transparencySlider.destroy();
                    this.destroyColorRendererGrid();
                    n.forEach(this.tooltips, function(a) { a.destroy() });
                    n.forEach(this._rConnects, a.disconnect);
                    delete this._rConnects;
                    this.inherited(arguments)
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.clone(N.common);
                    g.mixin(this.i18n, N.rendererCommon);
                    g.mixin(this.i18n, N.rendererColorPanel);
                    g.mixin(this.i18n, N.rendererRatioPanel)
                },
                postCreate: function() {
                    this.container.addChild(E.byId("rendererRatioPanel"));
                    this.loadConnections()
                },
                loadConnections: function() {
                    this._rConnects.push(a.connect(E.byId("leftContentPanel"),
                        "resize", this, "adjustHeight"));
                    this._rConnects.push(a.subscribe("onUpdateColor", g.hitch(this, "onUpdateInfo")));
                    a.connect(this._rendererRatioOtherSymbol, "click", g.hitch(this, "onClickOtherSymbol", "main"));
                    a.connect(this._rendererRatioRotationEditExpression, "click", g.hitch(this, "_onEditRotationExpressionClick"));
                    a.connect(this._rendererRatioRotationFieldDescription, "click", g.hitch(this, "onFieldDescriptionClick", this._rendererRatioRotationAttribute))
                },
                _onClose: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges();
                    arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                _onDone: function(a) {
                    a.preventDefault();
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    leftPanel.switchToRendererStack(this.renderer)
                },
                _onCancel: function(a) {
                    a.preventDefault();
                    delete this.mapLayer._scaleChanged;
                    this.hideBusy();
                    this.hideSymbolStyler();
                    this.hideLegendPopup();
                    this.hideFieldDescriptionPopup();
                    this.dismissRendererChanges(this.origGalleryRenderer);
                    leftPanel.switchToRendererStack()
                },
                _onChangeField: function() { leftPanel.switchToRendererStack() },
                startup: function() {
                    this.inherited(arguments);
                    isEmbedded || dojo.style(dojo.byId("rendererRatioFooterDiv"), "display", "");
                    this._init()
                },
                _init: function() {
                    this.origGalleryRenderer = this.buildCurrentRendererInfo();
                    this._rendererRatioLayer.innerHTML = B.encode(this.mapLayer.title.replace(/\_/g, " ")); - 1 !== this.subLayerId && this.mapLayer.title !== this.layer.name &&
                        (this._rendererRatioLayer.innerHTML += " - " + B.encode(this.layer.name.replace(/\_/g, " ")));
                    this.createTooltips();
                    if (this.renderer.authoringInfo) {
                        this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                        var a = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                        a && "percent" === a.style ? (w.add(this._rendererRatioStyleIcon, "percent"), this._rendererRatioField.innerHTML = d.substitute(this.i18n.percentTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias })) :
                            a && "percentTotal" === a.style ? (w.add(this._rendererRatioStyleIcon, "percentTotal"), this._rendererRatioField.innerHTML = d.substitute(this.i18n.percentTotalTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias })) : this._rendererRatioField.innerHTML = d.substitute(this.i18n.ratioTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias })
                    } else this._rendererRatioField.innerHTML = d.substitute(this.i18n.ratioTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias });
                    t.set(this._estimatedValuesMsg, "display", "none");
                    t.set(this._zeroFeaturesMsg, "display", "none");
                    t.set(this._rendererRatioGridDiv, "display", "none");
                    w.add(this._rendererRatioSymbols, "symbolIconRatioContinuous");
                    this.scheme = null;
                    this.hasDynamic ? t.set(this._rendererColorTransparency, "display", "none") : this.transparencySlider = this.createTransparencySlider("rendererRatioTransparencySlider");
                    this.createScaleSlider("rendererRatioScaleSlider").then(g.hitch(this, function(a) { this.scaleSlider = a }));
                    !this.hasNumericField ||
                        "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType ? t.set(this._rendererRatioRotation, "display", "none") : (this._rendererRatioRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" }), t.set(this._rendererRatioRotation, "display",
                            ""));
                    this.updateUIWithRenderer();
                    this.showLegendPopup()
                },
                updateUIWithRenderer: function() {
                    this.disableAllEvents = !0;
                    this.authoringInfo = g.clone(this.renderer.authoringInfo);
                    this.renderer.defaultSymbol ? (this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, t.set(this._rendererRatioOther, "display", ""), this._rendererRatioOtherCheck.set("checked", !0)) : (this.defaultInfo = { defaultSymbol: this.getDefaultSymbol(this.geometryType), defaultLabel: this.i18n.other }, t.set(this._rendererRatioOther,
                        "display", "none"), this._rendererRatioOtherCheck.set("checked", !1));
                    this.isSymbolTransparent(this.defaultInfo.defaultSymbol) ? this.drawTransparentSymbol(this._rendererRatioOtherSymbol) : (this.drawSymbol(this._rendererRatioOtherSymbol, this.defaultInfo.defaultSymbol, null, null, null, 1), this.updateBackgroundForAlmostWhite(this.defaultInfo.defaultSymbol, this._rendererRatioOtherSymbol));
                    this._rendererRatioZoomLabel.innerHTML = this.i18n.zoomIn;
                    this._rendererRatioOtherTxt.innerHTML = this.i18n.drawOthers;
                    t.set(this._rendererRatioRotationEditExpression,
                        "display", "none");
                    t.set(this._rendererRatioRotationFieldDescription, "display", "none");
                    if (this.hasNumericField && ("esriGeometryPoint" == this.geometryType || "esriGeometryMultipoint" == this.geometryType)) {
                        var a = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                        this.drawRotationSymbol(a, this._rendererRatioRotateRightSymbol, this._rendererRatioRotateLeftSymbol);
                        a = this.renderer.rotationInfo || this.getVisualVariableByType("rotationInfo", null,
                            this.renderer.visualVariables);
                        this._rendererRatioRotationCheck.set("checked", a ? !0 : !1);
                        a && (this._rendererRatioRotationClockwiseRadio.set("checked", !("arithmetic" === a.rotationType || "arithmetic" === a.type)), this._rendererRatioRotationCounterclockwiseRadio.set("checked", !("arithmetic" !== a.rotationType && "arithmetic" !== a.type)), a.field ? (this._rendererRatioRotationAttribute.set("value", a.field), this.getAttributeItemFromStore(a.field).then(g.hitch(this, function(a) {
                            a && a.descriptionValue && t.set(this._rendererRatioRotationFieldDescription,
                                "display", "")
                        }))) : a.valueExpression && (this._rendererRatioRotationAttribute.set("value", "customExprRotation"), t.set(this._rendererRatioRotationEditExpression, "display", "")));
                        t.set(this._rendererRatioRotationContent, "display", a ? "" : "none")
                    }
                    var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                    b && (b.legendOptions && !1 === b.legendOptions.showLegend ? this._rendererRatioLegendCheck.set("checked", !1) : this._rendererRatioLegendCheck.set("checked", !0));
                    this.colorSlider || (this.getParams().then(g.hitch(this,
                        function(a) {
                            9 > e("ie") ? setTimeout(g.hitch(this, function() {
                                this.createColorInfoSlider(a).then(g.hitch(this, function() {
                                    this.hideBusy();
                                    this.adjustHeight()
                                }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererRatioStack", a) }))
                            }), 1E3) : this.createColorInfoSlider(a).then(g.hitch(this, function() {
                                this.hideBusy();
                                this.adjustHeight()
                            }), g.hitch(this, function() { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererRatioStack", a) }))
                        })), b = this.getVisualVariableByType("colorInfo",
                        null, this.renderer.visualVariables), this.getStatistics({ field: b.field, normalizationType: "field", normalizationField: b.normalizationField }).then(g.hitch(this, function(a) {!H.isDefined(a.min) || !H.isDefined(a.max) || 1 <= a.min || 1 >= a.max ? t.set(this._rendererRatioCenterTitle, "display", "none") : 1 === b.stops[2].value && w.add(this._rendererRatioCenterIcon, "average") })));
                    this.adjustHeight();
                    setTimeout(g.hitch(this, function() { this.disableAllEvents = !1 }), 1E3)
                },
                wrapTooltipText: function(a) {
                    return "\x3cdiv class\x3d'rendererTooltip'\x3e" +
                        a + "\x3c/div\x3e"
                },
                createTooltips: function() {
                    this.tooltips.push(new F({ connectId: this._rendererRatioTransparencyTitle, label: this.wrapTooltipText(this.i18n.transparencyTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioScaleTitle, label: this.wrapTooltipText(this.i18n.visibleRangeTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioScaleSuggest, label: this.wrapTooltipText(this.i18n.suggestTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioRotationText, label: this.wrapTooltipText(this.i18n.rotateTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioRotationAttribute.domNode, label: this.wrapTooltipText(this.i18n.rotationFieldTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioSymbolsTitle, label: this.wrapTooltipText(this.i18n.symbolsTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioZoomTitle, label: this.wrapTooltipText(this.i18n.zoomTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioInvertTitle, label: this.wrapTooltipText(this.i18n.invertTooltip) }));
                    var a = "\x3cdiv\x3e" + this.i18n.headerTooltip + "\x3cdiv\x3e\x3cul\x3e\x3cli\x3e" + this.i18n.ratioTooltip + "\x3c/li\x3e\x3cli\x3e" + this.i18n.percentTotalTooltip + "\x3c/li\x3e\x3cli\x3e" + this.i18n.percentTooltip + "\x3c/li\x3e\x3c/ul\x3e";
                    this.tooltips.push(new F({ connectId: this._rendererRatioStyleTitle, label: this.wrapTooltipText(a) }));
                    a = "\x3cdiv\x3e" + this.i18n.headerCenterTooltip + "\x3cdiv\x3e\x3cul\x3e\x3cli\x3e" + this.i18n.centerEqualTooltip + "\x3c/li\x3e\x3cli\x3e" + this.i18n.centerMeanTooltip + "\x3c/li\x3e\x3c/ul\x3e";
                    this.tooltips.push(new F({ connectId: this._rendererRatioCenterTitle, label: this.wrapTooltipText(a) }));
                    this.otherTooltip = new F({ connectId: this._rendererRatioOtherTxt, label: this.wrapTooltipText(this.i18n.drawOthersTooltip) });
                    this.tooltips.push(this.otherTooltip);
                    this.tooltips.push(new F({ connectId: this._rendererRatioOtherSymbol, label: this.wrapTooltipText(this.i18n.otherSymbolTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioOtherSymbolText, label: this.wrapTooltipText(this.i18n.otherSymbolTooltip) }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioRotationEditExpression, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }));
                    this.tooltips.push(new F({ connectId: this._rendererRatioRotationFieldDescription, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.showDescription + "\x3c/div\x3e" }))
                },
                _onClickSymbols: function() {
                    var a = P.getSchemes({ theme: "above-and-below", basemap: this.getBasemapType(), geometryType: this.geometryType }),
                        b = this.getVisualVariableByType("colorInfo",
                            null, this.renderer.visualVariables);
                    if (!b) {
                        var c = P.getSchemes({ theme: "above-and-below", basemap: this.getBasemapType(), geometryType: this.geometryType });
                        a.secondarySchemes.push(c.primaryScheme);
                        a.secondarySchemes = a.secondarySchemes.concat(c.secondarySchemes)
                    }
                    var c = [],
                        d = 0;
                    if (b)
                        for (var e = b.stops, b = 0; b < e.length; b++) c.push(e[b].color);
                    else {
                        for (b = 0; b < this.renderer.infos.length; b++) c.push(this.renderer.infos[b].symbol.color);
                        d = this.renderer.infos.length
                    }
                    b = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol :
                        this.getDefaultSymbol(this.geometryType);
                    this.showSymbolStyler(b, { externalSizing: !1, optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables), schemes: a, colorRamp: { colors: c, numStops: d, scheme: this.scheme } }, g.hitch(this, "onSymbolsChange"))
                },
                onSymbolsChange: function(a, b, c, d) {
                    this.scheme = c || this.scheme;
                    this.updateSymbolOnColorRenderer({ symbol: a, colors: b });
                    !this.hasNumericField || "esriGeometryPoint" != this.geometryType && "esriGeometryMultipoint" != this.geometryType || this.drawRotationSymbol(a, this._rendererRatioRotateRightSymbol,
                        this._rendererRatioRotateLeftSymbol);
                    this.updateColorRenderer(d, this._rendererRatioOtherSymbol)
                },
                _onClickLegendClasses: function() {
                    -1 === this._rendererRatioLegendClassesIcon.className.indexOf("active") ? (w.add(this._rendererRatioLegendClassesIcon, "active"), this._rendererRatioLegendClassesText.innerHTML = this.i18n.classes, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.classesTooltip)), t.set(this._rendererColorSliderDiv, "display", "none"), t.set(this._rendererRatioGridDiv, "display",
                        ""), this.updateColorRendererGrid()) : (w.remove(this._rendererColorLegendClassesIcon, "active"), this._rendererRatioLegendClassesText.innerHTML = this.i18n.legend, this.legendClassesTooltip.set("label", this.wrapTooltipText(this.i18n.legendTooltip)), t.set(this._rendererRatioSliderDiv, "display", ""), t.set(this._rendererRatioGridDiv, "display", "none"))
                },
                _onClickZoom: function() {
                    !this.disableAllEvents && this.colorSlider && (this.colorSlider.get("zoomOptions") ? (this.zoomOutSlider(), w.remove(this._rendererRatioZoomIcon,
                        "active"), this._rendererRatioZoomLabel.innerHTML = this.i18n.zoomIn) : this.getParams().then(g.hitch(this, function(a) {
                        this.zoomInSlider(a).then(g.hitch(this, function(a) {
                            this.hideBusy();
                            w.add(this._rendererRatioZoomIcon, "active");
                            this._rendererRatioZoomLabel.innerHTML = this.i18n.zoomOut
                        }), g.hitch(this, function(a) { this.hideBusy() }), g.hitch(this, function(a) { this.showBusy("rendererRatioStack", a) }))
                    })))
                },
                clearZoom: function() {
                    "color" !== this.getRendererStyle(this.renderer) && "ratio" !== this.getRendererStyle(this.renderer) ||
                        !this.colorSlider || (this.colorSlider.get("zoomOptions") && this.zoomOutSlider(), w.remove(this._rendererRatioZoomIcon, "active"), this._rendererRatioZoomLabel.innerHTML = this.i18n.zoomIn)
                },
                _onClickInvert: function() {
                    if (!this.disableAllEvents) {
                        this.invertColor();
                        var a = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables);
                        this.colorSlider && this.colorSlider.set("colorInfo", g.clone(a));
                        this.applyColorRenderer(this.renderer)
                    }
                },
                invertColor: function(a) {
                    a = this.getVisualVariableByType("colorInfo",
                        null, this.renderer.visualVariables);
                    for (var b = a.stops.length - 1, c = Math.floor(b / 2), d = 0; d <= c; d++) {
                        var e = a.stops[d].color;
                        a.stops[d].color = a.stops[b - d].color;
                        a.stops[b - d].color = e
                    }
                    b = this.getVisualVariablesExceptTypes([{ type: "colorInfo" }], this.renderer.visualVariables) || [];
                    b.push(a);
                    this.renderer.setVisualVariables(b)
                },
                _onClickStyle: function() {
                    if (!this.disableAllEvents) {
                        var a = this.getVisualVariableByType("colorInfo", null, this.authoringInfo.visualVariables);
                        a && "ratio" === a.style ? (this.switchStyleOnSlider("percentTotal"),
                            a.style = "percentTotal", this.colorSlider.set("showRatioLabels", "percentTotal"), w.remove(this._rendererRatioStyleIcon, "percent"), w.add(this._rendererRatioStyleIcon, "percentTotal"), this._rendererRatioField.innerHTML = d.substitute(this.i18n.percentTotalTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias })) : a && "percentTotal" === a.style ? (this.switchStyleOnSlider("percent"), a.style = "percent", this.colorSlider.set("showRatioLabels", "percent"), w.remove(this._rendererRatioStyleIcon, "percentTotal"),
                            w.add(this._rendererRatioStyleIcon, "percent"), this._rendererRatioField.innerHTML = d.substitute(this.i18n.percentTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias })) : (this.switchStyleOnSlider("ratio"), a.style = "ratio", this.colorSlider.set("showRatioLabels", null), w.remove(this._rendererRatioStyleIcon, "percent"), w.remove(this._rendererRatioStyleIcon, "percentTotal"), this._rendererRatioField.innerHTML = d.substitute(this.i18n.ratioTitle, { field1: this.attributeItem.alias, field2: this.attributeItem2.alias }));
                        this.replaceVisualVariable("colorInfo", null, a, this.authoringInfo);
                        this.applyColorRenderer(this.renderer)
                    }
                },
                _onClickCenter: function() { this.colorSlider && (this.clearZoom(), 1 === this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables).stops[2].value ? (this.centerHandlesOnSlider("average"), w.remove(this._rendererRatioCenterIcon, "average")) : (this.centerHandlesOnSlider("equal"), w.add(this._rendererRatioCenterIcon, "average"))) },
                _onChangeOther: function(a) {
                    this.disableAllEvents || (a ? (t.set(this._rendererRatioOther,
                        "display", ""), this.renderer.defaultSymbol = this.defaultInfo.defaultSymbol, this.renderer.defaultLabel = this.defaultInfo.defaultLabel) : (t.set(this._rendererRatioOther, "display", "none"), delete this.renderer.defaultSymbol, delete this.renderer.defaultLabel), this.applyColorRenderer(this.renderer))
                },
                onClickOtherSymbol: function(a, b) {
                    b = P.getSchemes({ theme: "above-and-below", basemap: this.getBasemapType(), geometryType: this.geometryType });
                    this.showSymbolStyler(this.defaultInfo.defaultSymbol, {
                        externalSizing: !1,
                        optimizeOutline: this.hasOptimizeOutline(this.renderer.visualVariables),
                        schemes: b
                    }, g.hitch(this, "onOtherSymbolChange", a))
                },
                onOtherSymbolChange: function(a, b, c, d, e) {
                    a = b.toJson();
                    "esriPMS" !== b.type || 0 !== a.url.length && "http://" !== a.url || (b = M.fromJson(this.getMarkerJson()));
                    this.defaultInfo.defaultSymbol = b;
                    this.renderer.defaultSymbol && (this.renderer.defaultSymbol = M.fromJson(b.toJson()));
                    this.updateColorRenderer(e, this._rendererRatioOtherSymbol);
                    this.adjustHeight()
                },
                _onChangeRotation: function(a) {
                    this.disableAllEvents || (t.set(this._rendererRatioRotationContent, "display", a ? "" :
                        "none"), this.adjustHeight(), this.updateRotationInfo())
                },
                _onChangeRotationAttribute: function(a) { this.disableAllEvents || this.updateRotationInfo() },
                _onChangeRotationDirection: function(a) { this.disableAllEvents || a && this.updateRotationInfo() },
                updateRotationInfo: function() {
                    if (this._rendererRatioRotationCheck.get("checked"))
                        if ("customExprRotation" === this._rendererRatioRotationAttribute.get("value")) this.attributesStore.fetchItemByIdentity({
                            identity: "customExprRotation",
                            onItem: g.hitch(this, function(a) {
                                var b =
                                    a;
                                a = this.clean(a);
                                if (a.valueExpression) {
                                    this.disableAllEvents = !0;
                                    this._rendererRatioRotationAttribute.setStore(this.attributesStore, "", { query: "(type:'esriFieldTypeSingle' OR type:'esriFieldTypeDouble' OR type:'esriFieldTypeInteger' OR type:'esriFieldTypeSmallInteger' OR type:'rotationExpr' OR (type:'separator' AND name:'expressionSeparator')) AND NOT name:'" + this.layer.objectIdField + "'" });
                                    this._rendererRatioRotationAttribute.set("value", "customExprRotation", !1);
                                    a = {
                                        valueExpression: a.valueExpression,
                                        valueExpressionTitle: a.valueExpressionTitle,
                                        rotationType: this._rendererRatioRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic",
                                        type: "rotationInfo"
                                    };
                                    this.renderer.setRotationInfo(null);
                                    var c = this.getVisualVariablesExceptTypes([{ type: "rotationInfo" }], this.renderer.visualVariables) || [];
                                    c.push(a);
                                    this.renderer.setVisualVariables(c);
                                    this.applyColorRenderer(this.renderer);
                                    this.updateUIWithRenderer()
                                } else this.onClickExpressionEditor().then(g.hitch(this, function(a) {
                                    this.attributesStore.setValue(b,
                                        "valueExpression", a.expression);
                                    this.attributesStore.setValue(b, "valueExpressionReturnType", a.returnType);
                                    this.attributesStore.setValue(b, "valueExpressionTitle", a.title);
                                    this.attributesStore.setValue(b, "displayName", d.substitute(this.i18n.customExpression, { name: a.title || this.i18n.custom }));
                                    this.updateRotationInfo()
                                }), g.hitch(this, function() { this.updateUIWithRenderer() }))
                            })
                        });
                        else {
                            t.set(this._rendererRatioRotationEditExpression, "display", "none");
                            var a = {
                                field: this._rendererRatioRotationAttribute.get("value"),
                                type: this._rendererRatioRotationClockwiseRadio.get("checked") ? "geographic" : "arithmetic"
                            };
                            this.getAttributeItemFromStore(this._rendererRatioRotationAttribute.get("value")).then(g.hitch(this, function(a) { a && a.descriptionValue ? t.set(this._rendererRatioRotationFieldDescription, "display", "") : t.set(this._rendererRatioRotationFieldDescription, "display", "none") }));
                            this.renderer.setRotationInfo(a);
                            this.removeRotationInfoVisualVariable();
                            this.applyColorRenderer(this.renderer);
                            this.adjustHeight()
                        }
                    else this.renderer.setRotationInfo(null),
                        this.removeRotationInfoVisualVariable(), this.applyColorRenderer(this.renderer), this.adjustHeight()
                },
                onColorSliderChange: function(a) {},
                onUpdateInfo: function(a, b) {
                    if ("_default_" === a.minValue) this.renderer.defaultLabel = a.label, this.renderer.defaultSymbol = a.symbol, this.defaultInfo = { defaultSymbol: this.renderer.defaultSymbol, defaultLabel: this.renderer.defaultLabel }, this.updateColorRenderer(b, this._rendererRatioOtherSymbol);
                    else {
                        var c = this.renderer.infos;
                        this.renderer.clearBreaks();
                        n.forEach(c, function(b,
                            c) { a.minValue === b.minValue && a.maxValue === b.maxValue ? this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: a.symbol, label: a.label }) : this.renderer.addBreak({ minValue: b.minValue, maxValue: b.maxValue, symbol: b.symbol, label: b.label }) }, this);
                        this.updateColorRenderer(b, this._rendererRatioOtherSymbol);
                        this.updateColorSlider()
                    }
                },
                _onChangeColorPrecision: function() {
                    if (!this.disableAllEvents) {
                        var a = this._rendererRatioPrecision.get("value");
                        "select" !== a && (this.updateValues(parseFloat(a)), this.applyColorRenderer(this.renderer),
                            "block" === t.get(this._rendererColorGridDiv, "display") && this.updateColorRendererGrid(), this.updateColorSlider(), this.onColorSliderChange("precisionChange"))
                    }
                },
                _onChangeLegend: function(a) {
                    this.updateLegendProperty(this.renderer, "colorInfo", a);
                    this.applyColorRenderer(this.renderer)
                },
                _onClickScaleSuggest: function() { this.suggestScale(this.scaleSlider) },
                getParams: function() {
                    var a = new v,
                        b = { normalizationType: "field" };
                    b.normalizationField = this.attributeItem2.name;
                    b.theme = "above-and-below";
                    b.showOthers = this._rendererRatioOtherCheck.get("checked");
                    b.symbol = this.renderer.infos && this.renderer.infos.length ? this.renderer.infos[0].symbol : this.getDefaultSymbol(this.geometryType);
                    b.rotationInfo = this.renderer.rotationInfo;
                    b.defaultSymbol = this.defaultInfo && this.defaultInfo.defaultSymbol;
                    b.defaultLabel = this.defaultInfo && this.defaultInfo.defaultLabel;
                    b.optimizeOutline = this.getVisualVariableByType("sizeInfo", "outline", this.renderer.visualVariables) ? !0 : !1;
                    var c = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                    c &&
                        "percent" === c.style ? b.showRatioLabels = "percent" : c && "percentTotal" === c.style && (b.showRatioLabels = "percentTotal");
                    b.colorSliderDivId = "rendererRatioSlider";
                    a.resolve(b);
                    return a
                },
                adjustHeight: function(a) {
                    if ("undefined" !== typeof leftPanel && "rendererRatioStack" === leftPanel.visibleStack) {
                        a = c.coords(f.byId("leftContentStackContainer")).h;
                        var b = c.coords(f.byId("rendererRatioTop")).h,
                            d = c.coords(this._doneChangingButton.domNode).h - 5,
                            e = c.coords(f.byId("rendererRatioFooter_links")).h + 10;
                        t.set(f.byId("rendererRatioFooterDiv"),
                            "height", e + "px");
                        a = a - b - d - e - 18;
                        0 < a && t.set(f.byId("renderer-ratio-content"), "height", a + "px");
                        var g = 60;
                        n.forEach(m(".firstColumnLabel", this.domNode), function(a) { g = Math.max(g, c.coords(a).w) });
                        var h = 40;
                        m(".toolsLabel").forEach(function(a) { h = Math.max(h, c.coords(a).w) });
                        m(".toolsColumnTD").style("width", h + 4 + "px");
                        a = c.coords(f.byId("leftContentStackContainer")).w;
                        t.set(this._rendererRatioGridDiv, "width", a - h - 42 + "px");
                        this.colorRendererGrid && this.colorRendererGrid.resize();
                        newWidth = a - 35;
                        if (0 < newWidth) {
                            a = 0;
                            if ("none" !== t.get(this._rendererRatioRotationEditExpression, "display") || "none" !== t.get(this._rendererRatioRotationFieldDescription, "display")) a = 30;
                            t.set(this._rendererRatioRotationAttribute.domNode, "width", newWidth - a - 21 + "px");
                            m(".dijitSelectLabel", this._rendererRatioRotationAttribute.domNode).style("maxWidth", newWidth - a - 51 + "px");
                            this.transparencySlider && t.set(this.transparencySlider.domNode, "width", newWidth - 15 + "px");
                            this.scaleSlider && t.set(this.scaleSlider.domNode, "width", newWidth - 15 + "px")
                        }
                    }
                }
            });
            g.setObject("arcgisonline.map.dijit.renderer.Ratio",
                b);
            return b
        })
}, "arcgisonline/map/dijit/renderer/_RatioMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/dom dojo/Deferred dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/basic esri/numberUtils esri/renderers/smartMapping esri/styles/choropleth esri/plugins/FeatureLayerStatistics esri/dijit/ColorInfoSlider esri/dijit/ClassedColorSlider esri/renderers/SimpleRenderer esri/renderers/ClassBreaksRenderer esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol arcgisonline/map/dijit/renderer/ColorGrid".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A) {
            return {
                buildRatioRenderer: function(a) {
                    var b = new f;
                    setTimeout(function() { b.progress(b) }, 1);
                    a = a || {};
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildRatioRendererGo(null, a, b);
                    else if ("esri.renderer.UniqueValueRenderer" === this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildRatioRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildRatioRendererGo(!0, a, b) : arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildRatioRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() {!b.isRejected() && b.reject() }) })
                        } else this.buildRatioRendererGo(null,
                            a, b), this.mapLayer.layerDefinition && (delete this.mapLayer.layerDefinition.typeIdField, delete this.mapLayer.layerDefinition.types, delete this.mapLayer.layerDefinition.templates);
                    else this.buildRatioRendererGo(null, a, b);
                    return b
                },
                buildRatioRendererGo: function(a, b, c) {
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    var d = b.attributeItem || this.attributeItem,
                        e = b.attributeItem2 || this.attributeItem2,
                        f, m = null;
                    this.renderer.visualVariables && "ratio" === this.getRendererType(this.renderer) && (f = this.getVisualVariablesExceptTypes([{ type: "colorInfo" },
                        { type: "sizeInfo", target: "outline" }
                    ], this.renderer.visualVariables), m = this.renderer.authoringInfo && this.getVisualVariablesExceptTypes([{ type: "colorInfo" }, { type: "sizeInfo", target: "outline" }], this.renderer.authoringInfo.visualVariables));
                    v.createColorRenderer({
                        layer: this.fLayer || this.layer,
                        field: this.hasAttributeCustomExpression(d) ? null : d.name,
                        valueExpression: this.hasAttributeCustomExpression(d) ? d.valueExpression : null,
                        valueExpressionTitle: d.valueExpressionTitle,
                        normalizationType: "field",
                        normalizationField: e.name,
                        theme: "above-and-below",
                        basemap: this.getBasemapType(),
                        optimizeOutline: !0,
                        showOthers: !0
                    }).then(g.hitch(this, function(d) {
                        c.isRejected() || (this.scheme = d.scheme, this.onCalculationsSource && d.statistics && this.onCalculationsSource(d.statistics), a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0), this.authoringInfo = {
                            visualVariables: [{
                                type: "colorInfo",
                                minSliderValue: h.isDefined(b.minValue) ? b.minValue : d.statistics.min,
                                maxSliderValue: h.isDefined(b.maxValue) ?
                                    b.maxValue : d.statistics.max,
                                theme: "above-and-below",
                                style: "ratio"
                            }]
                        }, f && (d.renderer.visualVariables ? d.renderer.setVisualVariables(d.renderer.visualVariables.concat(f)) : d.renderer.setVisualVariables(f), m && (this.authoringInfo.visualVariables = this.authoringInfo.visualVariables ? this.authoringInfo.visualVariables.concat(m) : m)), d.renderer = this.updateRendererProperties(b, d.renderer), c.resolve({ renderer: d.renderer, statistics: d.statistics }))
                    }), g.hitch(this, function(a) {
                        c.isRejected() || (this.handleError(a, "createRatioRenderer", !0), c.reject())
                    }))
                },
                applyRatioRenderer: function(a, b) {
                    a.authoringInfo && (a.authoringInfo.classificationMethod ? a.classificationMethod = a.authoringInfo.classificationMethod : delete a.classificationMethod);
                    b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    !this.hasDynamic && "ratio" !== b && this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value", 1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) ||
                        this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                },
                switchStyleOnSlider: function(a) {
                    this.updateStopLabels(a);
                    this.updateColorSlider(this.renderer);
                    this.applyColorRenderer(this.renderer)
                },
                centerHandlesOnSlider: function(a) {
                    var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                        c = this.getVisualVariableByType("colorInfo",
                            null, this.renderer.authoringInfo.visualVariables),
                        d = c.style && "percent" === c.style,
                        e = c.style && "percentTotal" === c.style;
                    this.getStatistics({ field: b.field, normalizationType: "field", normalizationField: b.normalizationField }).then(g.hitch(this, function(c) {
                        var f;
                        if ("average" === a) {
                            var g = c.avg,
                                h = Math.max(g - c.stddev, c.min);
                            f = Math.min(g + c.stddev, c.max);
                            f = r.round([h, f]);
                            h = f[0];
                            f = f[1];
                            f = [Math.max(h, c.min), Math.max(h + (g - h) / 2, c.min), g, Math.min(g + (f - g) / 2, c.max), Math.min(f, c.max)]
                        } else {
                            var h = Math.max(1 - c.stddev, c.min);
                            f = Math.min(1 + c.stddev, c.max);
                            f = r.round([h, f]);
                            h = f[0];
                            f = f[1];
                            f = [Math.max(h, c.min), Math.max(h + (1 - h) / 2, c.min), 1, Math.min(1 + (f - 1) / 2, c.max), Math.min(f, c.max)]
                        }
                        f = r.round(f);
                        b.stops[0].value = f[0];
                        b.stops[0].label = "\x3c " + this.getStopLabel(f[0], d, e);
                        b.stops[1].value = f[1];
                        b.stops[1].label = null;
                        b.stops[2].value = f[2];
                        b.stops[2].label = this.getStopLabel(f[2], d, e);
                        b.stops[3].value = f[3];
                        b.stops[3].label = null;
                        b.stops[4].value = f[4];
                        b.stops[4].label = "\x3e " + this.getStopLabel(f[4], d, e);
                        this.replaceVisualVariable("colorInfo",
                            null, b, this.renderer);
                        this.updateColorSlider(this.renderer);
                        this.applyColorRenderer(this.renderer)
                    }))
                },
                updateStopLabels: function(a) {
                    var b = this.getVisualVariableByType("colorInfo", null, this.renderer.visualVariables),
                        c = this.getVisualVariableByType("colorInfo", null, this.renderer.authoringInfo.visualVariables);
                    a = a || c.style;
                    "percent" === a ? (b.stops[0].label = "\x3c " + this.getStopLabel(b.stops[0].value, !0, !1), b.stops[2].label = this.getStopLabel(b.stops[2].value, !0, !1), b.stops[4].label = "\x3e " + this.getStopLabel(b.stops[4].value, !0, !1)) : "percentTotal" === a ? (b.stops[0].label = "\x3c " + this.getStopLabel(b.stops[0].value, !1, !0), b.stops[2].label = this.getStopLabel(b.stops[2].value, !1, !0), b.stops[4].label = "\x3e " + this.getStopLabel(b.stops[4].value, !1, !0)) : (b.stops[0].label = "\x3c " + this.getStopLabel(b.stops[0].value, !1, !1), b.stops[2].label = this.getStopLabel(b.stops[2].value, !1, !1), b.stops[4].label = "\x3e " + this.getStopLabel(b.stops[4].value, !1, !1));
                    this.replaceVisualVariable("colorInfo", null, b, this.renderer)
                },
                getStopLabel: function(a,
                    b, c) { return c ? "" + this.formatNumber(arcgisonline.map.main.roundValue(a / (1 + a) * 100, 100)) + "%" : b ? "" + this.formatNumber(arcgisonline.map.main.roundValue(100 * a, 100)) + "%" : "" + this.formatNumber(arcgisonline.map.main.roundValue(a, 100)) },
                getStatistics: function(a) {
                    var b = new f;
                    (this.fLayer || this.layer).addPlugin("esri/plugins/FeatureLayerStatistics").then(g.hitch(this, function() {
                        (this.fLayer || this.layer).statisticsPlugin.getFieldStatistics(a).then(g.hitch(this, function(a) { b.isRejected() || b.resolve(a) }), g.hitch(this,
                            function(c) { b.isRejected() || (this.handleError(c, "getFieldStatistics", !1), g.hitch(this, createWidget, a, b)()) }))
                    }), g.hitch(this, function(a) { b.isRejected() || (this.handleError(a, "addPlugin", !1), b.reject()) }));
                    return b
                }
            }
        })
}, "arcgisonline/map/dijit/renderer/_WatercolorMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/Deferred dojo/dom dojo/dom-construct esri/lang esri/symbols/jsonUtils esri/styles/basic esri/styles/type esri/renderers/smartMapping esri/tasks/query esri/tasks/QueryTask esri/tasks/UniqueValueDefinition esri/tasks/GenerateRendererParameters esri/tasks/GenerateRendererTask esri/tasks/StatisticDefinition esri/renderers/SimpleRenderer esri/renderers/UniqueValueRenderer esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/dijit/OpacitySlider".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J) {
            return {
                buildWatercolorRenderer: function(a) {
                    var b = new d;
                    setTimeout(function() { b.progress(b) }, 1);
                    if (this.isFeatColl || this.isCSV || this.hasDynamic) this.buildWatercolorRendererGo(!1, a, b);
                    else if ("UniqueValueRenderer" !== this.renderer.declaredClass)
                        if (this.isOwnerOfHostedFS) {
                            var c = this.layer.getEditCapabilities();
                            !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ?
                                this.buildWatercolorRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildWatercolorRendererGo(!0, a, b) : (c = arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(), c.show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this.buildWatercolorRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { b.reject() }) }))
                        } else this.buildWatercolorRendererGo(!1,
                            a, b);
                    else this.attributeItem.name !== this.renderer.attributeField ? this.isOwnerOfHostedFS ? (c = this.layer.getEditCapabilities(), !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildWatercolorRendererGo(!0, a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildWatercolorRendererGo(!0, a, b) : (c = arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(), c.show({
                        title: this.i18n.warning,
                        message: this.i18n.featureTypesAndTemplatesWarning,
                        choiceOneTitle: this.i18n.yesLabel,
                        choiceOneHandler: g.hitch(this, function() { this._onSaveRendererGo(!0, a, b) }),
                        choiceTwoTitle: this.i18n.noLabel,
                        choiceTwoHandler: g.hitch(this, function() {})
                    }))) : this.buildWatercolorRendererGo(!1, a, b) : this.isOwnerOfHostedFS ? (c = this.layer.getEditCapabilities(), !this.layer.isEditable() || !c.canCreate && (c.canUpdate || c.canDelete) || this.mapLayer.featureTemplatesChanged || this.mapLayer._featureTemplatesChanged ? this.buildWatercolorRendererGo(!0,
                        a, b) : arcgisonline.map.edit.hasDefaultTypesAndTemplates(this.layer) ? this.buildWatercolorRendererGo(!0, a, b) : (c = arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(), c.show({ title: this.i18n.warning, message: this.i18n.featureTypesAndTemplatesWarning, choiceOneTitle: this.i18n.yesLabel, choiceOneHandler: g.hitch(this, function() { this._onSaveRendererGo(!0, a, b) }), choiceTwoTitle: this.i18n.noLabel, choiceTwoHandler: g.hitch(this, function() { this._onSaveRendererGo(!1, a, b) }) }))) : this.buildWatercolorRendererGo(!1,
                        a, b);
                    return b
                },
                buildWatercolorRendererGo: function(a, b, c) {
                    b = b || {};
                    arcgisonline.map.dynLayer.checkDynamicLayers(this.mapLayer);
                    this.hasDynamic = arcgisonline.map.main.hasDynamicLayers(this.mapLayer);
                    var d = b.attributeItem2 || this.attributeItem2,
                        e = b.attributeItem3 || this.attributeItem3,
                        f = b.attributeItem4 || this.attributeItem4,
                        h = b.attributeItem5 || this.attributeItem5,
                        m = [];
                    m.push((b.attributeItem || this.attributeItem).name);
                    m.push(d.name);
                    e && (m.push(e.name), f && (m.push(f.name), h && m.push(h.name)));
                    var n = null;
                    dojo.forEach(this.layer.fields,
                        function(a) { "TADULTBASE" === a.name && (n = a.name) });
                    v.createBlendRenderer({ layer: this.fLayer || this.layer, blendedFields: m, normalizationField: n, theme: "default", basemap: this.getBasemapType(), useStdDev: !0, showOthers: !0, minOpacity: .3, maxOpacity: 1, markers: !1 }).then(g.hitch(this, function(b) {
                        c.isRejected() || (a && (arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(this.mapLayer.layer), this.mapLayer._featureTemplatesChanged = !0), delete this.authoringInfo, this.defaultInfo = {
                            defaultSymbol: b.renderer.defaultSymbol,
                            defaultLabel: b.renderer.defaultLabel
                        }, delete b.renderer.defaultSymbol, delete b.renderer.defaultLabel, c.resolve(b.renderer))
                    }), g.hitch(this, function(a) { c.isRejected() || (this.handleError(a, "createTypeRenderer", !0), c.reject()) }))
                },
                applyWatercolorRenderer: function(a) {
                    var b = this.getRendererStyle((this.fLayer || this.layer).renderer);
                    this.setRenderer(a);
                    !this.hasDynamic && "watercolor" !== b && this.scheme && h.isDefined(this.scheme.opacity) && (this.layer.setOpacity(this.scheme.opacity), this.transparencySlider && this.transparencySlider.set("value",
                        1 - this.scheme.opacity));
                    (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.isCSV) && arcgisonline.map.main.markMapAsChanged("onRendererChange");
                    this.isOwnerOfHostedFS && !this.layer.templates.length && arcgisonline.map.edit.createTypesAndTemplatesOnLayer(this.layer);
                    this.updateLegendPopup()
                }
            }
        })
}, "arcgisonline/map/dijit/ManageTemplates": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,dijit/Menu,dijit/form/CheckBox,dijit/form/Button,dijit/form/TextBox,dijit/form/ValidationTextBox,dijit/layout/BorderContainer,dijit/layout/ContentPane,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/FeatureTypeDlg,arcgisonline/sharing/dijit/dialog/FeatureTemplateDlg"],
        function(b, g, n) {
            b.provide("arcgisonline.map.dijit.ManageTemplates");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dijit.Menu");
            b.require("dijit.form.CheckBox");
            b.require("dijit.form.Button");
            b.require("dijit.form.TextBox");
            b.require("dijit.form.ValidationTextBox");
            b.require("dijit.layout.BorderContainer");
            b.require("dijit.layout.ContentPane");
            b.require("arcgisonline.sharing.util");
            b.require("arcgisonline.sharing.dijit.dialog.FeatureTypeDlg");
            b.require("arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg");
            b.declare("arcgisonline.map.dijit.ManageTemplates", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e\r\n  \x3cdiv id\x3d"manageTemplatesContentHeader" class\x3d"panel panel_left" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n      \x3cA href\x3d"JavaScript:void(0);" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\r\n        \x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\r\n      \x3c/A\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"manageTemplatesTitle" class\x3d"esriFloatLeading" style\x3d"font-weight:bold;"\x3e\r\n      ${i18n.manageTemplatesPanelTitle}\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; border-bottom: #333 thin solid; height:1px;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"manageTemplatesContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;position:relative;" class\x3d"scrollPane"\x3e\r\n    \x3cdiv id\x3d"manageTemplates-main"\x3e\r\n      \x3cdiv id\x3d"manageTemplates-layer"\x3e\r\n        \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd id\x3d"mgTmplCol1" nowrap\x3e\r\n                \x3clabel\x3e\r\n                  ${i18n.layerLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd id\x3d"mgTmplCol2"\x3e\r\n                \x26nbsp;\r\n              \x3c/td\x3e\r\n              \x3ctd id\x3d"mgTmplCol3"\x3e\r\n                \x3cselect dojoType\x3d"dijit.form.ComboBox" dojoAttachPoint\x3d"manageTemplatesLayer" id\x3d"manageTemplatesLayer" class\x3d"dijitComboBoxNonEditable"\x3e\r\n                \x3c/select\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"manageTemplates-tree" style\x3d"overflow-x:hidden;overflow-y:auto;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"manageTemplates-buttonsDiv"\x3e\r\n      \x3ccenter\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite light" dojoAttachPoint\x3d"newFeatureType" dojoAttachEvent\x3d"onClick:_addNewFeatureType" style\x3d"display:none;"\x3e\r\n          \x3cspan\x3e${i18n.addNewTypeBtn}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" dojoAttachPoint\x3d"saveButton" dojoAttachEvent\x3d"onClick:_updateFeatureService"\x3e\r\n          \x3cspan\x3e${i18n.saveChangesBtn}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/center\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"manageTemplatesContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"manageTemplatesSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"typeMenu" dojoType\x3d"dijit.Menu" style\x3d"display: none;"\x3e\r\n    \x3cdiv id\x3d"typeMenu.moveUp" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconMoveUp"\x3e\r\n      ${i18n.moveUp}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"typeMenu.moveDown" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconMoveDown"\x3e\r\n      ${i18n.moveDown}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"typeMenu.remove" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateRemove"\x3e\r\n      ${i18n.remove}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"typeMenu.newTemplate" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateNew"\x3e\r\n      ${i18n.newTemplate}\r\n    \x3c/div\x3e\r\n     \x3cdiv id\x3d"typeMenu.properties" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateProperties"\x3e\r\n      ${i18n.properties}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"templateMenu" dojoType\x3d"dijit.Menu" style\x3d"display: none;"\x3e\r\n    \x3cdiv id\x3d"templateMenu.moveUp" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconMoveUp"\x3e\r\n      ${i18n.moveUp}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"templateMenu.moveDown" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconMoveDown"\x3e\r\n      ${i18n.moveDown}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"templateMenu.copy" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateCopy"\x3e\r\n      ${i18n.copy}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"templateMenu.remove" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateRemove"\x3e\r\n      ${i18n.remove}\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"templateMenu.properties" dojoType\x3d"dijit.MenuItem" iconclass\x3d"iconTemplateProperties"\x3e\r\n      ${i18n.properties}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                i18n: null,
                container: null,
                mapLayer: null,
                mapLayerPos: 0,
                menuOpen: !1,
                _eventConnections: [],
                constructor: function(a, b) { null != a && a.containerNode && (this.container = a.containerNode) },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").viewer.main);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").tocPanel);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline",
                        "arcgisonline").manageTemplatesPanel)
                },
                postCreate: function() {
                    this.container.addChild(g.byId("manageTemplatesPanel"));
                    this.manageTemplatesLayer.textbox.readOnly = !0;
                    b.style(this.manageTemplatesLayer.textbox, "cursor", "pointer");
                    this.manageTemplatesLayer.textbox.onclick = b.hitch(this, function() { this.manageTemplatesLayer.loadDropDown() });
                    this.loadConnections()
                },
                loadConnections: function() {
                    b.connect(g.byId("leftContentPanel"), "resize", this, "adjustHeight");
                    b.connect(this.manageTemplatesLayer, "onChange", this,
                        "newLayer");
                    if (esri.isTouchEnabled) {
                        var a = b.query(".scrollPane", this.domNode)[0],
                            a = esri.setScrollable(a);
                        this._eventConnections.push(a[0], a[1])
                    }
                    this._eventConnections.push(b.connect(this._closeBtn, "onclick", b.hitch(this, "_onClose", !1)));
                    b.connect(g.byId("typeMenu"), "onClose", this, "onMenuClose");
                    b.connect(g.byId("templateMenu"), "onClose", this, "onMenuClose");
                    b.connect(g.byId("typeMenu.moveUp"), "onClick", this, "moveUpType");
                    b.connect(g.byId("typeMenu.moveDown"), "onClick", this, "moveDownType");
                    b.connect(g.byId("typeMenu.remove"),
                        "onClick", this, "removeType");
                    b.connect(g.byId("typeMenu.newTemplate"), "onClick", this, "newTemplate");
                    b.connect(g.byId("typeMenu.properties"), "onClick", this, "featureTypeProperties");
                    b.connect(g.byId("templateMenu.moveUp"), "onClick", this, "moveUpTemplate");
                    b.connect(g.byId("templateMenu.moveDown"), "onClick", this, "moveDownTemplate");
                    b.connect(g.byId("templateMenu.copy"), "onClick", this, "copyTemplate");
                    b.connect(g.byId("templateMenu.remove"), "onClick", this, "removeTemplate");
                    b.connect(g.byId("templateMenu.properties"),
                        "onClick", this, "templateProperties");
                    b.subscribe("onFeatureTypeChanges", this, "onFeatureTypeChanges")
                },
                destroy: function() {
                    this.inherited(arguments);
                    b.forEach(this._eventConnections, b.disconnect);
                    this._eventConnections = []
                },
                loadContent: function() {
                    isEmbedded || b.style(b.byId("manageTemplatesContentFooter"), "display", "");
                    this.loadLayers();
                    setTimeout(function() { g.byId("manageTemplatesPanel").adjustHeight() }, 100)
                },
                loadLayers: function() {
                    for (var a = new b.data.ItemFileWriteStore({ data: { identifier: "pos", items: [] } }),
                            c = arcgisonline.sharing.util.getUser(), d = null, f = arcgisonline.map.main.mapLayers.length - 1; 0 <= f; f--) {
                        var e = arcgisonline.map.main.mapLayers[f];
                        if (e.layer && e.layer instanceof esri.layers.FeatureLayer && e.itemId && e.layer.isEditable() && (arcgisonline.sharing.util.isHostedService(e.layer.url) || e.itemCard && -1 < b.indexOf(e.itemCard.typeKeywords, "providerSDS")))
                            if (!e.itemCard || "update" !== e.itemCard.itemControl && "admin" !== e.itemCard.itemControl) arcgisonline.map.mapUtil.checkFSItemAccess(e, b.hitch(this, function() {
                                if (e.itemOwner &&
                                    e.itemOwner === c.email) {
                                    var b = this.shortenTitle(e);
                                    a.newItem({ name: b, pos: f });
                                    d = d || b
                                }
                            }));
                            else {
                                var g = this.shortenTitle(e);
                                a.newItem({ name: g, pos: f });
                                d = d || g
                            }
                    }
                    this.manageTemplatesLayer.set("store", a);
                    this.manageTemplatesLayer.set("value", d)
                },
                newLayer: function(a) { this.displayLayer() },
                displayLayer: function() {
                    var a = this.manageTemplatesLayer.get("value");
                    this.manageTemplatesLayer.store.fetch({
                        query: {},
                        onComplete: b.hitch(this, function(b) {
                            for (var c = 0; c < b.length; c++)
                                if (this.manageTemplatesLayer.store.getValue(b[c],
                                        "name") == a) { this.mapLayerPos = this.manageTemplatesLayer.store.getValue(b[c], "pos"); break }
                        })
                    });
                    this.mapLayer = arcgisonline.map.main.mapLayers[this.mapLayerPos];
                    this.mapLayer.featureTemplatesChanged || this.mapLayer.rendererChanged || this.mapLayer.scaleChanged ? this.saveButton.set("disabled", !1) : this.saveButton.set("disabled", !0);
                    this.buildLayerTree()
                },
                buildLayerTree: function() {
                    b.byId("manageTemplates-tree").innerHTML = "";
                    b.style(b.byId("manageTemplates-tree"), "position", "relative");
                    var a = this.mapLayer.layer.renderer;
                    "esri.renderer.SimpleRenderer" == a.declaredClass || "esri.renderer.ClassBreaksRenderer" == a.declaredClass || "esri.renderer.HeatmapRenderer" == a.declaredClass || "esri.renderer.UniqueValueRenderer" == a.declaredClass && a.authoringInfo && "predominance" === a.authoringInfo.type ? (b.style(this.newFeatureType.domNode, "display", "none"), this.adjustHeight(), this.buildTemplatesTree()) : (b.style(this.newFeatureType.domNode, "display", ""), this.adjustHeight(), this.buildTypesTree())
                },
                buildTemplatesTree: function() {
                    var a = b.byId("manageTemplates-tree");
                    b.forEach(this.mapLayer.layer.templates, function(b, d) { this.buildTemplate(b, d, null, a) }, this)
                },
                buildTypesTree: function() {
                    var a = b.byId("manageTemplates-tree");
                    b.forEach(this.mapLayer.layer.types, function(b, d) { this.buildType(b, d, a) }, this)
                },
                buildTemplate: function(a, c, d, f) {
                    var e = this.mapLayerPos + (esri.isDefined(d) ? "_" + d + "_" : "_") + c;
                    f = b.create("div", { id: e, "class": esri.isDefined(d) ? "manageTemplates_level2 esriLeadingMargin27" : "manageTemplates_level1" }, f);
                    b.connect(f, "onmouseover", b.hitch(this, "onTemplateMouseOver",
                        e));
                    b.connect(f, "onmouseout", b.hitch(this, "onTemplateMouseOut", e));
                    f = b.create("table", { cellpadding: 0, cellspacing: 0 }, f);
                    f = b.create("tbody", {}, f);
                    f = b.create("tr", {}, f);
                    if (esri.isDefined(d)) g = b.create("td", { valign: "top", width: "10" }, f), b.create("div", { style: "width:10px;" }, g);
                    else {
                        var g = b.create("td", { valign: "top", width: "20" }, f),
                            g = b.create("div", { style: "width:30px;height:30px;" }, g);
                        this.mapLayer.layer.renderer.symbol ? this.drawSymbol(g, this.mapLayer.layer.renderer.symbol, 30, 30) : this.mapLayer.layer.renderer.defaultSymbol ?
                            this.drawSymbol(g, this.mapLayer.layer.renderer.defaultSymbol, 30, 30) : this.drawSymbol(g, this._getDefaultSymbol(this.mapLayer.layer.geometryType), 30, 30)
                    }
                    g = b.create("td", { nowrap: "true" }, f);
                    b.create("span", { innerHTML: n.html.entities.encode(a.name.replace(/\_/g, " ")), "class": "esriLeadingMargin1" }, g);
                    g = b.create("td", { width: "18" }, f);
                    a = b.create("div", { id: e + "_menu", "class": "esriFloatTrailing calciteContextMenu", style: "display:none;width:10px;" }, g);
                    a = b.create("a", { href: "JavaScript:void(0);" }, a);
                    b.connect(a,
                        "onclick", b.hitch(this, "onTemplateMenuClick", e, d, c));
                    b.style(b.byId(e + "_menu"), "display", "none")
                },
                buildType: function(a, c, d) {
                    var f = this.mapLayerPos + "_" + c,
                        e = b.create("div", { id: f, "class": "manageTemplates_level1" }, d);
                    d = b.create("div", { id: f + "_row" }, e);
                    b.connect(d, "onmouseover", b.hitch(this, "onTypeMouseOver", f));
                    b.connect(d, "onmouseout", b.hitch(this, "onTypeMouseOut", f));
                    d = b.create("table", { cellpadding: 0, cellspacing: 0 }, d);
                    d = b.create("tbody", {}, d);
                    d = b.create("tr", {}, d);
                    for (var g = b.create("td", {
                            valign: "top",
                            width: "20"
                        }, d), g = b.create("div", { style: "width:30px;height:30px;" }, g), m = !1, p = 0; p < this.mapLayer.layer.renderer.infos.length; p++) {
                        var r = this.mapLayer.layer.renderer.infos[p];
                        if (r.value == a.id) {
                            this.drawSymbol(g, r.symbol, 30, 30);
                            m = !0;
                            break
                        }
                    }
                    m || (this.mapLayer.layer.renderer.defaultSymbol ? this.drawSymbol(g, this.mapLayer.layer.renderer.defaultSymbol, 30, 30) : this.drawSymbol(g, this._getDefaultSymbol(this.mapLayer.layer.geometryType), 30, 30));
                    g = b.create("td", { nowrap: "true" }, d);
                    b.create("span", {
                        innerHTML: n.html.entities.encode(a.name.replace(/\_/g,
                            " ")),
                        "class": "esriLeadingMargin1 manageTemplates_types"
                    }, g);
                    g = b.create("td", { width: "18" }, d);
                    d = b.create("div", { id: f + "_menu", "class": "esriFloatTrailing calciteContextMenu", style: "display:none;" }, g);
                    d = b.create("a", { href: "JavaScript:void(0);" }, d);
                    b.connect(d, "onclick", b.hitch(this, "onTypeMenuClick", f, c));
                    b.style(b.byId(f + "_menu"), "display", "none");
                    b.forEach(a.templates, function(a, b) { this.buildTemplate(a, b, c, e) }, this)
                },
                onTemplateMouseOver: function(a) { b.style(b.byId(a + "_menu"), "display", "inline") },
                onTemplateMouseOut: function(a) {
                    this.menuOpen ||
                        b.style(b.byId(a + "_menu"), "display", "none")
                },
                onTypeMouseOver: function(a) { b.style(b.byId(a + "_menu"), "display", "inline") },
                onTypeMouseOut: function(a) { this.menuOpen || b.style(b.byId(a + "_menu"), "display", "none") },
                onTemplateMenuClick: function(a, c, d) {
                    this.menuOpen = !0;
                    this.typePos = c;
                    this.templatePos = d;
                    var f;
                    f = esri.isDefined(c) ? this.mapLayer.layer.types[c].templates : this.mapLayer.layer.templates;
                    c = g.byId("templateMenu");
                    b.forEach(c.getChildren(), function(a) {
                        -1 < a.id.indexOf("templateMenu.moveUp") && 0 === d ? a.set("disabled", !0) : -1 < a.id.indexOf("templateMenu.moveDown") && d === f.length - 1 ? a.set("disabled", !0) : a.set("disabled", !1)
                    }, this);
                    c = b.coords(b.byId(a + "_menu"));
                    a = { target: b.byId(a + "_menu"), pageX: c.x, pageY: c.y };
                    a.preventDefault = a.stopPropagation = function() {};
                    g.byId("templateMenu")._openMyself(a)
                },
                onTypeMenuClick: function(a, c) {
                    this.menuOpen = !0;
                    this.typePos = c;
                    this.templatePos = null;
                    var d = this.mapLayer.layer.types,
                        f = g.byId("typeMenu");
                    b.forEach(f.getChildren(), function(a) {
                        -1 < a.id.indexOf("typeMenu.moveUp") && 0 === c ? a.set("disabled", !0) : -1 < a.id.indexOf("typeMenu.moveDown") && c === d.length - 1 ? a.set("disabled", !0) : -1 < a.id.indexOf("typeMenu.remove") && 1 === d.length ? a.set("disabled", !0) : a.set("disabled", !1)
                    }, this);
                    f = b.coords(b.byId(a + "_menu"));
                    a = { target: b.byId(a + "_menu"), pageX: f.x, pageY: f.y };
                    a.preventDefault = a.stopPropagation = function() {};
                    g.byId("typeMenu")._openMyself(a)
                },
                onMenuClose: function() {
                    if (this.menuOpen) {
                        var a = this.mapLayerPos + "_" + (esri.isDefined(this.typePos) ? this.typePos + "_" : "") + (esri.isDefined(this.templatePos) ? this.templatePos +
                            "_" : "");
                        b.style(b.byId(a + "menu"), "display", "none");
                        this.menuOpen = !1
                    }
                },
                onFeatureTypeChanges: function() {
                    this.saveButton.set("disabled", !1);
                    this.buildLayerTree();
                    this.mapLayer.featureTemplatesChanged = !0;
                    b.publish("onLayerUpdate", [""])
                },
                _onClose: function(a, b) {
                    b.preventDefault();
                    arcgisonline.map.leftPanel.openLeftEditPanel();
                    setTimeout(function() { g.byId("editPanel").recreateEditor() }, 0)
                },
                moveUpType: function() {
                    var a = this.mapLayer.layer.types[this.typePos];
                    this.mapLayer.layer.types[this.typePos] = this.mapLayer.layer.types[this.typePos -
                        1];
                    this.mapLayer.layer.types[this.typePos - 1] = a;
                    this.mapLayer.layer._typesDirty = !0;
                    this.onFeatureTypeChanges()
                },
                moveDownType: function() {
                    var a = this.mapLayer.layer.types[this.typePos];
                    this.mapLayer.layer.types[this.typePos] = this.mapLayer.layer.types[this.typePos + 1];
                    this.mapLayer.layer.types[this.typePos + 1] = a;
                    this.mapLayer.layer._typesDirty = !0;
                    this.onFeatureTypeChanges()
                },
                removeType: function() {
                    var a = this.mapLayer.layer.types.splice(this.typePos, 1)[0];
                    this.mapLayer.layer._typesDirty = !0;
                    for (var b = 0; b < this.mapLayer.layer.renderer.infos.length; b++) {
                        var d =
                            this.mapLayer.layer.renderer.infos[b];
                        if (d.value == a.id) {
                            this.mapLayer.layer.renderer.removeValue(d.value);
                            this.mapLayer.layer.refresh();
                            break
                        }
                    }
                    this.onFeatureTypeChanges()
                },
                newTemplate: function() {
                    var a = new esri.layers.FeatureTemplate;
                    a.description = "";
                    a.name = this.i18n.newTemplate;
                    var c = {};
                    b.forEach(this.mapLayer.layer.fields, function(a) { a.editable && (c[a.name] = null, !1 === a.nullable && (c[a.name] = "esriFieldTypeString" === a.type ? " " : 0)) });
                    esri.isDefined(this.typePos) && (c[this.mapLayer.layer.typeIdField] = this.mapLayer.layer.types[this.typePos].id);
                    var d = new esri.Graphic({ attributes: c });
                    a.prototype = d;
                    var f = null;
                    esri.isDefined(this.typePos) && (f = this.mapLayer.layer.types[this.typePos]);
                    arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg.prototype.statics.getInstance().show({
                        layer: this.mapLayer.layer,
                        type: f,
                        template: a,
                        okHandler: b.hitch(this, function(a) {
                            esri.isDefined(this.typePos) ? (f.templates.push(a), this.mapLayer.layer._typesDirty = !0) : (this.mapLayer.layer.templates.push(a), this.updateTemplates(this.mapLayer.layer, this.mapLayer.layer.templates));
                            this.onFeatureTypeChanges()
                        })
                    })
                },
                moveUpTemplate: function() {
                    if (esri.isDefined(this.typePos)) {
                        var a = this.mapLayer.layer.types[this.typePos],
                            b = a.templates[this.templatePos];
                        a.templates[this.templatePos] = a.templates[this.templatePos - 1];
                        a.templates[this.templatePos - 1] = b
                    } else a = this.mapLayer.layer.templates, b = a[this.templatePos], a[this.templatePos] = a[this.templatePos - 1], a[this.templatePos - 1] = b, this.updateTemplates(this.mapLayer.layer, a);
                    this.onFeatureTypeChanges()
                },
                moveDownTemplate: function() {
                    if (esri.isDefined(this.typePos)) {
                        var a =
                            this.mapLayer.layer.types[this.typePos],
                            b = a.templates[this.templatePos];
                        a.templates[this.templatePos] = a.templates[this.templatePos + 1];
                        a.templates[this.templatePos + 1] = b
                    } else a = this.mapLayer.layer.templates, b = a[this.templatePos], a[this.templatePos] = a[this.templatePos + 1], a[this.templatePos + 1] = b, this.updateTemplates(this.mapLayer.layer, a);
                    this.onFeatureTypeChanges()
                },
                copyTemplate: function() {
                    var a = null,
                        c;
                    esri.isDefined(this.typePos) ? (a = this.mapLayer.layer.types[this.typePos], c = b.clone(a.templates[this.templatePos])) :
                        c = b.clone(this.mapLayer.layer.templates[this.templatePos]);
                    c.name = c.name + " - " + this.i18n.copy;
                    arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg.prototype.statics.getInstance().show({
                        layer: this.mapLayer.layer,
                        type: a,
                        template: c,
                        okHandler: b.hitch(this, function(b) {
                            esri.isDefined(this.typePos) ? (a.templates.push(b), this.mapLayer.layer._typesDirty = !0) : (this.mapLayer.layer.templates.push(b), this.updateTemplates(this.mapLayer.layer, this.mapLayer.layer.templates));
                            this.onFeatureTypeChanges()
                        })
                    })
                },
                removeTemplate: function() {
                    if (esri.isDefined(this.typePos)) this.mapLayer.layer.types[this.typePos].templates.splice(this.templatePos,
                        1), this.mapLayer.layer._typesDirty = !0;
                    else {
                        var a = this.mapLayer.layer.templates;
                        a.splice(this.templatePos, 1);
                        this.updateTemplates(this.mapLayer.layer, a)
                    }
                    this.onFeatureTypeChanges()
                },
                templateProperties: function() {
                    arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg.prototype.statics.getInstance().show({
                        layer: this.mapLayer.layer,
                        type: esri.isDefined(this.typePos) ? this.mapLayer.layer.types[this.typePos] : null,
                        template: esri.isDefined(this.typePos) ? this.mapLayer.layer.types[this.typePos].templates[this.templatePos] : this.mapLayer.layer.templates[this.templatePos],
                        okHandler: b.hitch(this, function(a) { this.onFeatureTypeChanges() })
                    })
                },
                _addNewFeatureType: function() { arcgisonline.sharing.dijit.dialog.FeatureTypeDlg.prototype.statics.getInstance().show({ mapLayer: this.mapLayer, okHandler: b.hitch(this, function(a) { this.onFeatureTypeChanges() }) }) },
                featureTypeProperties: function() {
                    arcgisonline.sharing.dijit.dialog.FeatureTypeDlg.prototype.statics.getInstance().show({
                        mapLayer: this.mapLayer,
                        featureTypePos: this.typePos,
                        okHandler: b.hitch(this,
                            function(a) { this.onFeatureTypeChanges() })
                    })
                },
                _updateFeatureService: function() {
                    arcgisonline.map.itemData.updateFeatureService(this.mapLayer);
                    this.saveButton.set("disabled", !0)
                },
                drawSymbol: function(a, c, d, f) {
                    a = n.gfx.createSurface(a, d, f);
                    c = esri.symbol.getShapeDescriptors(c);
                    c = a.createShape(c.defaultShape).setFill(c.fill).setStroke(c.stroke);
                    var e = { dx: d / 2, dy: f / 2 },
                        g = c.getBoundingBox(),
                        m = g.width,
                        g = g.height;
                    if (m > d || g > f) d = ((d < f ? d : f) - 5) / (m > g ? m : g), b.mixin(e, { xx: d, yy: d });
                    c.applyTransform(e);
                    return a
                },
                updateTypeIdField: function(a,
                    c) {
                    a.typeIdField = c;
                    if (a._collection) {
                        var d;
                        d = 9 > b.isIE ? b.json.parse(a._json) : JSON.parse(a._json);
                        d.layerDefinition ? d.layerDefinition.typeIdField = c : d.typeIdField = c;
                        a._json = 9 > b.isIE ? b.json.stringify(d) : JSON.stringify(d)
                    }
                },
                updateTemplates: function(a, c) {
                    a.templates = c;
                    if (a._collection) {
                        var d;
                        d = 9 > b.isIE ? b.json.parse(a._json) : JSON.parse(a._json);
                        d.layerDefinition ? d.layerDefinition.templates = c : d.templates = c;
                        a._json = 9 > b.isIE ? b.json.stringify(d) : JSON.stringify(d)
                    }
                },
                _getDefaultSymbol: function(a) {
                    return "esriGeometryPoint" ==
                        a ? new esri.symbol.SimpleMarkerSymbol : "esriGeometryPolyline" == a ? new esri.symbol.SimpleLineSymbol : "esriGeometryPolygon" == a ? new esri.symbol.SimpleFillSymbol : null
                },
                shortenTitle: function(a) {
                    var b = a.title;
                    if (-1 < b.indexOf(" - ")) {
                        a = a.url;
                        var d = a.indexOf("/FeatureServer");
                        if (-1 == d) return b;
                        a = a.substring(0, d);
                        a = a.substring(a.lastIndexOf("/") + 1, a.length);
                        b.startsWith(a + " - ") && (b = b.substring((a + " - ").length, b.length))
                    }
                    return b
                },
                adjustHeight: function(a) {
                    if ("undefined" != typeof leftPanel && "manageTemplatesStack" ==
                        leftPanel.visibleStack) {
                        var c = b.coords(b.byId("leftPanelDiv")).h,
                            d = b.coords(b.byId("manageTemplatesContentHeader")).h;
                        a = b.coords(b.byId("manageTemplatesSiteFooter_links")).h + 10;
                        var f = b.coords(b.byId("manageTemplates-buttonsDiv")).h || 66,
                            e = b.coords(b.byId("manageTemplates-layer")).h,
                            c = c - d - a - 15;
                        b.style(b.byId("manageTemplatesContentFooter"), "height", a + "px");
                        b.style(b.byId("manageTemplatesContentPane"), "height", c + "px");
                        b.style(b.byId("manageTemplates-tree"), "height", c - f - e - 10 + "px");
                        a = b.coords(b.byId("leftContentStackContainer")).w -
                            15;
                        0 < a && (f = b.style(b.byId("mgTmplCol1"), "width"), e = b.style(b.byId("mgTmplCol2"), "width"), b.style(b.byId("widget_manageTemplatesLayer"), "width", (0 < a - (f + e + 6) ? a - (f + e + 6) : 0) + "px"))
                    }
                }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/FeatureTypeDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/DateTextBox,dijit/form/TextBox,dijit/form/NumberTextBox,esri/dijit/SymbolStyler"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.FeatureTypeDlg");
        b.require("dijit.Dialog");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dijit.form.DateTextBox");
        b.require("dijit.form.TextBox");
        b.require("dijit.form.NumberTextBox");
        b.require("esri.dijit.SymbolStyler");
        b.declare("arcgisonline.sharing.dijit.dialog.FeatureTypeDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"featureType-dialog" title\x3d"${i18n.featureTypeDlgTitle}" execute\x3d""\x3e\r\n  \t\x3cdiv style\x3d"padding:10px 10px;"\x3e${i18n.titleMsg}\x3c/div\x3e\r\n    \x3ctable cellspacing\x3d"10" class\x3d"esriTrailingMargin2"\x3e\r\n    \t\x3ctbody\x3e\r\n\t\t    \x3ctr\x3e\r\n\t\t    \t\x3ctd\x3e\r\n\t\t        \x3clabel\x3e${i18n.labelLabel}\x3c/label\x3e\r\n\t\t      \x3c/td\x3e\r\n\t\t      \x3ctd width\x3d"270"\x3e\r\n\t\t        \x3cdiv dojoAttachPoint\x3d"featureTypeLabel" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" required\x3d"true" style\x3d"width:270px; padding:2px;"\x3e\x3c/div\x3e\r\n\t\t      \x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t    \x3ctr\x3e\r\n\t\t      \x3ctd\x3e\r\n\t\t        \x3clabel\x3e${i18n.attributeLabel}\x3c/label\x3e\r\n\t\t      \x3c/td\x3e\r\n\t\t      \x3ctd width\x3d"270"\x3e\r\n\t\t      \t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" width\x3d"270"\x3e\r\n\t\t      \t\t\x3ctr\x3e\r\n\t\t      \t\t\t\x3ctd nowrap\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"featureTypeAttributeField"\x3e\x3c/div\x3e\r\n\t\t      \t\t\t\x3c/td\x3e\r\n                \x3ctd width\x3d"5"\x3e\r\n                  \x26nbsp;\r\n                \x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"featureTypeAttributeNonEditable" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"featureTypeAttributeText" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:100%; padding:2px; display:none;"\x3e\x3c/div\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"featureTypeAttributeNumber" dojotype\x3d"dijit.form.NumberTextBox" style\x3d"width:100%; padding:2px; display:none;"\x3e\x3c/div\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"featureTypeAttributeDate" dojotype\x3d"dijit.form.DateTextBox" style\x3d"width:100%; padding:2px; display:none;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t      \t\t\x3c/tr\x3e\r\n\t\t      \t\x3c/table\x3e\r\n\t\t      \x3c/td\x3e\r\n\t\t    \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3clabel style\x3d"line-height:32px;"\x3e${i18n.symbolLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"featureTypeSymbolStylerDivContainer"\x3e\r\n              \x3cdiv id\x3d"featureTypeSymbolStylerDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\r\n    \x3cbr /\x3e\r\n    \x3cbutton dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n\t  \x3cbutton dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e${i18n.done}\x3c/button\x3e\r\n    \x3cbr /\x3e\x26nbsp;  \r\n    \x3cbr /\x3e\x26nbsp;  \r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
            i18n: null,
            statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.FeatureTypeDlg); return this._instance } },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.clone(b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").featureTypeDlg)
            },
            show: function(a) {
                this.mapLayer =
                    a.mapLayer;
                this.layer = a.mapLayer.layer;
                this.okHandler = a.okHandler;
                esri.isDefined(a.featureTypePos) ? this.featureType = this.mapLayer.layer.types[a.featureTypePos] : this.featureType = null;
                var c = esri.styles.basic.getSchemes({ theme: "default", basemap: "topo", geometryType: this.layer.geometryType }),
                    d = this._getDefaultSymbol(this.layer.geometryType);
                if (this.featureType)
                    for (a = 0; a < this.layer.renderer.infos.length; a++) {
                        var f = this.layer.renderer.infos[a];
                        if (f.value == this.featureType.id) {
                            d = esri.symbol.fromJson(f.symbol.toJson());
                            break
                        }
                    }
                this.symbolOptions && (this.symbolOptions.destroy(), this.symbolOptions = null, b.create("div", { id: "featureTypeSymbolStylerDiv" }, b.byId("featureTypeSymbolStylerDivContainer")));
                this.symbolOptions || (this.symbolOptions = new esri.dijit.SymbolStyler({ portalUrl: esriGeowConfig.restBaseUrl }, "featureTypeSymbolStylerDiv"), this.symbolOptions.startup());
                this.symbolOptions.edit(d, { externalSizing: !1, schemes: c });
                this.featureTypeAttributeField.innerHTML = this.layer.renderer.attributeField;
                b.style(this.featureTypeAttributeNonEditable,
                    "display", "none");
                b.style(this.featureTypeAttributeText.domNode, "display", "none");
                b.style(this.featureTypeAttributeNumber.domNode, "display", "none");
                b.style(this.featureTypeAttributeDate.domNode, "display", "none");
                if (this.featureType) this.featureTypeLabel.set("value", this.featureType.name), this.featureTypeAttributeNonEditable.innerHTML = this.featureType.id, b.style(this.featureTypeAttributeNonEditable, "display", "");
                else
                    for (this.featureTypeLabel.set("value", ""), this.featureTypeAttributeText.set("value",
                            ""), this.featureTypeAttributeNumber.set("value", ""), this.featureTypeAttributeDate.set("value", ""), a = 0; a < this.layer.fields.length; a++)
                        if (c = this.layer.fields[a], c.name === this.layer.renderer.attributeField) {
                            this.featureTypeAttribute = "esriFieldTypeInteger" === c.type || "esriFieldTypeSmallInteger" === c.type || "esriFieldTypeDouble" === c.type || "esriFieldTypeSingle" === c.type ? this.featureTypeAttributeNumber : "esriFieldTypeDate" === c.type ? this.featureTypeAttributeDate : this.featureTypeAttributeText;
                            this.featureTypeAttributeFieldType =
                                c.type;
                            b.style(this.featureTypeAttribute.domNode, "display", "");
                            break
                        }
                g.byId("featureType-dialog").show()
            },
            hide: function() { g.byId("featureType-dialog").hide() },
            onDoneClick: function(a) {
                var c = this.symbolOptions.getStyle().symbol;
                if (!("picturemarkersymbol" === c.type && 8 > c.url.length)) {
                    if (this.featureType) this.featureType.name = this.featureTypeLabel.get("value") || this.featureType.name, this.layer.renderer._values && this.layer.renderer._values[this.featureType.id] ? (this.layer.renderer._values[this.featureType.id] =
                        c, b.forEach(this.layer.renderer.infos, function(a) { a.value === this.featureType.id && (a.symbol = c, a.label = this.featureType.name) }, this)) : (this.layer.renderer.removeValue(this.featureType.id), this.layer.renderer.addValue({ value: this.featureType.id, label: this.featureType.name, symbol: c }));
                    else {
                        a = this.featureTypeAttribute.get("value");
                        if (!a) {
                            var d = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                            d.show({
                                title: this.i18n.errorDlgTitle,
                                message: b.string.substitute(this.i18n.errors.badValue, { field: this.layer.renderer.attributeField })
                            });
                            return
                        }
                        "esriFieldTypeDate" === this.featureTypeAttributeFieldType && (a = a.getTime());
                        for (d = 0; d < this.layer.renderer.infos.length; d++)
                            if (this.layer.renderer.infos[d].value == a) {
                                d = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                                d.show({ title: this.i18n.errorDlgTitle, message: b.string.substitute(this.i18n.errors.valueAlreadyExists, { attr: a }) });
                                return
                            }
                        var f = this.featureTypeLabel.get("value") || "" + a;
                        this.featureTypeLabel.set("value", f);
                        var e =
                            this.layer.renderer.attributeField,
                            d = new esri.layers.FeatureType;
                        d.id = a;
                        d.name = f;
                        var g = new esri.layers.FeatureTemplate;
                        g.description = f;
                        g.name = f;
                        var m = {};
                        m[e] = a;
                        b.forEach(this.layer.fields, function(a) { a.name !== e && a.editable && (m[a.name] = null, !1 === a.nullable && (m[a.name] = "esriFieldTypeString" === a.type ? " " : 0)) });
                        var n = new esri.Graphic({ attributes: m });
                        g.prototype = n;
                        d.templates = [g];
                        this.layer.addType(d);
                        this.layer.renderer.addValue({ value: a, label: f, symbol: c })
                    }
                    this.layer.refresh();
                    this.okHandler && this.okHandler(d);
                    this.hide()
                }
            },
            onCancelClick: function(a) {
                b.publish("onSymbolChangeCancel", []);
                this.hide()
            },
            _getDefaultSymbol: function(a) { return "esriGeometryPoint" == a ? new esri.symbol.SimpleMarkerSymbol : "esriGeometryPolyline" == a ? new esri.symbol.SimpleLineSymbol : "esriGeometryPolygon" == a ? new esri.symbol.SimpleFillSymbol : null }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/FeatureTemplateDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,esri/dijit/AttributeInspector"], function(b,
        g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg");
        b.require("dijit.Dialog");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("esri.dijit.AttributeInspector");
        b.declare("arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"template-dialog" title\x3d"${i18n.featureTemplateDlgTitle}" execute\x3d""\x3e\r\n    \x3cdiv style\x3d"padding:10px 10px;"\x3e\r\n      ${i18n.titleMsg}\r\n    \x3c/div\x3e\r\n    \x3ctable cellspacing\x3d"10" width\x3d"100%"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel\x3e\r\n              ${i18n.nameLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd width\x3d"270"\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"templateName" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" required\x3d"true" style\x3d"width:270px; padding:2px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3clabel\x3e\r\n              ${i18n.descriptionLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd width\x3d"270"\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"templateDescription" dojotype\x3d"dijit.form.Textarea" style\x3d"width:100%; padding:2px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3clabel style\x3d"line-height:32px;"\x3e\r\n              ${i18n.drawingToolLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3ctable\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv style\x3d"background-color: #FFF; border: 1px solid #BBB; padding:4px;"\x3e\r\n                      \x3cdiv dojoAttachPoint\x3d"templateDrawingTool"\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3ca dojoAttachPoint\x3d"templateDrawingToolOptions" href\x3d"JavaScript:void(0);" style\x3d"text-decoration: none;"\x3e\r\n                      \x3cdiv dojoAttachPoint\x3d"templateDrawingToolArrow" class\x3d"dijitReset dijitInline esriArrows" style\x3d"cursor: pointer;"\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/a\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv style\x3d"padding:10px;"\x3e\r\n      ${i18n.valuesMsg}\r\n    \x3c/div\x3e\r\n    \x3c!-- we need padding right for the vertical scrollbars --\x3e\r\n    \x3cdiv dojotype\x3d"dijit.layout.BorderContainer" design\x3d"headline" gutters\x3d"false" style\x3d"height:160px; margin:10px 5px 10px 20px; padding-right:18px; overflow-y:auto;overflow-x:auto;"\x3e\r\n      \x3cdiv dojoType\x3d"dijit.layout.ContentPane" id\x3d"templateFieldsDiv" region\x3d"top"\x3e\r\n        \x3cdiv id\x3d"attributeInspectorDiv"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cbutton dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e\r\n      ${i18n.cancel}\r\n    \x3c/button\x3e\r\n    \x3cbutton dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e\r\n      ${i18n.done}\r\n    \x3c/button\x3e\r\n    \x3cbr/\x3e\r\n    \x26nbsp; \r\n    \x3cbr/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
            i18n: null,
            statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg); return this._instance } },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.clone(b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").featureTemplateDlg)
            },
            show: function(a) {
                this.attributeInspector &&
                    (this.attributeInspector.destroy(), this.attributeInspector = null);
                this.layer = a.layer;
                this.type = a.type;
                this.template = a.template;
                this.origTemplate = b.clone(a.template);
                this.okHandler = a.okHandler;
                this.templateName.set("value", this.template.name);
                this.templateDescription.set("value", this.template.description);
                this.fillDrawingToolOptions();
                this.fillTemplateFields();
                this.setCurrentDrawingTool();
                b.style(b.byId("templateFieldsDiv"), "width", "382px");
                g.byId("template-dialog").show();
                a = b.query(".atiAttributes",
                    g.byId("template-dialog").domNode)[0];
                b.forEach(a.childNodes, function(a) { "TABLE" === a.tagName && (a = b.coords(a).w, b.style(b.byId("templateFieldsDiv"), "width", a + 18 + "px")) })
            },
            hide: function() {
                this.attributeInspector.destroy();
                this.attributeInspector = null;
                g.byId("template-dialog").hide()
            },
            fillDrawingToolOptions: function() {
                var a;
                "esriGeometryPoint" === this.layer.geometryType ? (this.templateDrawingTool.className = "toolbarIcon pointIcon", this.drawingTool = esri.layers.FeatureTemplate.TOOL_POINT, a = [{
                    label: this.i18n.pointLbl,
                    iconClass: "toolbarIcon pointIcon",
                    onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_POINT, "toolbarIcon pointIcon")
                }], b.style(this.templateDrawingToolArrow, "display", "none")) : ("esriGeometryPolyline" === this.layer.geometryType ? (this.templateDrawingTool.className = "toolbarIcon polylineIcon", this.drawingTool = esri.layers.FeatureTemplate.TOOL_POLYLINE, a = [{
                    label: this.i18n.freehandPolylineLbl,
                    iconClass: "toolbarIcon freehandPolylineIcon",
                    onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_FREEHAND,
                        "toolbarIcon freehandPolylineIcon")
                }, { label: this.i18n.polylineLbl, iconClass: "toolbarIcon polylineIcon", onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_POLYLINE, "toolbarIcon polylineIcon") }]) : (this.templateDrawingTool.className = "toolbarIcon polygonIcon", this.drawingTool = esri.layers.FeatureTemplate.TOOL_POLYGON, a = [{
                    label: this.i18n.freehandPolygonLbl,
                    iconClass: "toolbarIcon freehandPolygonIcon",
                    onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_FREEHAND,
                        "toolbarIcon freehandPolygonIcon")
                }, { label: this.i18n.circleLbl, iconClass: "toolbarIcon circleIcon", onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_CIRCLE, "toolbarIcon circleIcon") }, { label: this.i18n.rectangleLbl, iconClass: "toolbarIcon rectangleIcon", onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_RECTANGLE, "toolbarIcon rectangleIcon") }, {
                    label: this.i18n.polygonLbl,
                    iconClass: "toolbarIcon polygonIcon",
                    onClick: b.hitch(this, "switchDrawingTool", esri.layers.FeatureTemplate.TOOL_POLYGON,
                        "toolbarIcon polygonIcon")
                }]), b.style(this.templateDrawingToolArrow, "display", ""));
                a = new arcgisonline.sharing.dijit.TextMenu({ triggerNode: this.templateDrawingToolOptions, labelNode: this.templateDrawingToolOptions, textMenuItems: a });
                b.addClass(a.menu.domNode, "templateDrawingToolPopup")
            },
            setCurrentDrawingTool: function() {
                this.template.drawingTool && (this.drawingTool = this.template.drawingTool, this.templateDrawingTool.className = "esriGeometryPoint" === this.layer.geometryType ? "toolbarIcon pointIcon" : "esriGeometryPolyline" ===
                    this.layer.geometryType ? this.template.drawingTool === esri.layers.FeatureTemplate.TOOL_FREEHAND ? "toolbarIcon freehandPolylineIcon" : "toolbarIcon polylineIcon" : this.template.drawingTool === esri.layers.FeatureTemplate.TOOL_FREEHAND ? "toolbarIcon freehandPolygonIcon" : this.template.drawingTool === esri.layers.FeatureTemplate.TOOL_CIRCLE ? "toolbarIcon circleIcon" : this.template.drawingTool === esri.layers.FeatureTemplate.TOOL_RECTANGLE ? "toolbarIcon rectangleIcon" : "toolbarIcon polygonIcon")
            },
            fillTemplateFields: function() {
                b.byId("attributeInspectorDiv") ||
                    b.create("div", { id: "attributeInspectorDiv" }, b.byId("templateFieldsDiv"));
                this.attributeInspector = new esri.dijit.AttributeInspector({ featureLayer: this.layer }, "attributeInspectorDiv");
                b.style(this.attributeInspector.layerName, "display", "none");
                this.attributeInspector.showFeature(this.template.prototype, this.layer);
                b.style(this.attributeInspector.editButtons, "display", "none");
                this.attributeInspector._attachmentEditor && b.style(this.attributeInspector._attachmentEditor.domNode, "display", "none");
                if (this.type)
                    for (var a =
                            b.query(".atiField", this.attributeInspector.domNode), c = 0; c < a.length; c++) {
                        var d = a[c],
                            f = d.parentElement;
                        if (f.parentElement.childNodes[0].innerHTML === this.layer.typeIdField) {
                            b.style(d, "display", "none");
                            b.create("span", { innerHTML: this.type.id }, f);
                            break
                        }
                    }
                b.connect(this.attributeInspector, "onAttributeChange", b.hitch(this, function(a, b, c) {
                    a = !1;
                    if (!esri.isDefined(c) || isNaN(c))
                        for (var d = 0; d < this.layer.fields.length; d++) {
                            var e = this.layer.fields[d];
                            if (e.name === b) {
                                e.nullable || "esriFieldTypeDouble" !== e.type && "esriFieldTypeSingle" !==
                                    e.type && "esriFieldTypeInteger" !== e.type && "esriFieldTypeSmallInteger" !== e.type || (a = !0, this.attributeInspector.showFeature(this.template.prototype, this.layer));
                                break
                            }
                        }
                    a || (this.template.prototype.attributes[b] = c)
                }))
            },
            switchDrawingTool: function(a, b) {
                this.drawingTool = a;
                this.templateDrawingTool.className = b
            },
            onDoneClick: function(a) {
                if (a = this.templateName.get("value")) {
                    var c = 0;
                    if (this.type)
                        for (var d = 0; d < this.type.templates.length; d++) this.type.templates[d].name === a && c++;
                    else
                        for (d = 0; d < this.layer.templates.length; d++) this.layer.templates[d].name ===
                            a && c++;
                    1 < c ? (c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({ title: this.i18n.errorDlgTitle, message: b.string.substitute(this.i18n.errors.nameAlreadyExists, { name: a }) })) : (this.template.description = this.templateDescription.get("value"), this.template.name = a, this.template.drawingTool = this.drawingTool, this.okHandler && this.okHandler(this.template), this.hide())
                } else c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({
                    title: this.i18n.errorDlgTitle,
                    message: this.i18n.errors.badValue
                })
            },
            onCancelClick: function(a) {
                this.template.prototype = this.origTemplate.prototype;
                this.hide()
            }
        })
    })
}, "arcgisonline/map/dijit/RendererLabels": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!esri/arcadeProfiles/labelingProfile,esri/ArcadeExpression,dijit/_Widget,dijit/_Templated,dijit/ColorPalette,esri/symbols/TextSymbol,esri/dijit/FontAlignment,arcgisonline/sharing/dijit/dialog/GeneralDlg"], function(b, g, n) {
        b.provide("arcgisonline.map.dijit.RendererLabels");
        b.require("esri/arcadeProfiles/labelingProfile");
        b.require("esri/ArcadeExpression");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dijit.ColorPalette");
        b.require("esri.symbols.TextSymbol");
        b.require("esri.dijit.FontAlignment");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.declare("arcgisonline.map.dijit.RendererLabels", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e\r\n  \r\n  \x3cdiv id\x3d"rendererLabelsContentHeader" class\x3d"panel panel_left" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"display:none;"\x3e\r\n    \x3cdiv id\x3d"rendererLabelsHeaderButtons" class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n      \x3ca href\x3d"JavaScript:void(0);" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"rendererLabelsContentTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n      ${i18n.rendererLabelsPanelTitle}\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_rendererLabelsLayerName" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both; display:none;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; border-bottom: #aeaeae thin solid; height:1px;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3cdiv id\x3d"rendererLabelsContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.layout.ContentPane" region\x3d"center" id\x3d"rendererLabelsPane" style\x3d"padding-top:10px;overflow-y:auto;"\x3e\r\n      \x3cdiv style\x3d"padding: 10px 0;"\x3e\r\n        \x3cinput dojoAttachPoint\x3d"_rendererLabelsCheck" dojotype\x3d"dijit.form.CheckBox"  dojoAttachEvent\x3d"onChange:_onChangeRendererLabelsCheck" value\x3d"on" type\x3d"checkbox" /\x3e\r\n        \x3clabel\x3e\r\n          ${i18n.labelFeatures}\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"rendererLabelsOptions"\x3e\r\n      \x3ctable style\x3d"width:100%"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr style\x3d"width:100%"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n                \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                  ${i18n.textLabel}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:100%"\x3e\r\n              \x3cdiv style\x3d"clear:both;"\x3e\r\n                \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cselect class\x3d"rendererInput" dojoAttachPoint\x3d"_rendererLabelsAttribute" dojoAttachEvent\x3d"onChange:_onChangeAttribute" dojotype\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                      \x3c/select\x3e\r\n                    \x3c/td\x3e\x3ctd\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_rendererLabelsEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n\r\n          \x3ctr style\x3d"width:100%"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n                \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                  ${i18n.fontLabel}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:100%"\x3e\r\n              \x3cdiv style\x3d"clear:both;"\x3e\r\n                \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cselect class\x3d"rendererInput" dojoAttachPoint\x3d"_rendererLabelsFont" dojoAttachEvent\x3d"onChange:_onChangeFont" dojotype\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3coption dir\x3d"ltr" value\x3d"Arial"\x3eArial\x3c/option\x3e\r\n                        \x3coption dir\x3d"ltr" value\x3d"Arial Unicode MS"\x3eArial Unicode MS\x3c/option\x3e\r\n                      \x3c/select\x3e\r\n                    \x3c/td\x3e\x3ctd\x3e\r\n                  \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n\r\n          \x3ctr\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x26nbsp;\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3ctable style\x3d"padding: 5px 0"\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cselect class\x3d"rendererInput" class\x3d"calcite light" style\x3d"padding-right: 5px;" dojoAttachPoint\x3d"_rendererLabelsFontSizes" dojoAttachEvent\x3d"onChange:_onChangeRendererLabelsFontSize" dojoType\x3d"dijit.form.Select"\x3e\r\n                      \x3coption value\x3d"5" selected\x3d"selected"\x3e5\x3c/option\x3e\r\n                      \x3coption value\x3d"6" selected\x3d"selected"\x3e6\x3c/option\x3e\r\n                      \x3coption value\x3d"7" selected\x3d"selected"\x3e7\x3c/option\x3e\r\n                      \x3coption value\x3d"8" selected\x3d"selected"\x3e8\x3c/option\x3e\r\n                      \x3coption value\x3d"9" selected\x3d"selected"\x3e9\x3c/option\x3e\r\n                      \x3coption value\x3d"10" selected\x3d"selected"\x3e10\x3c/option\x3e\r\n                      \x3coption value\x3d"11" selected\x3d"selected"\x3e11\x3c/option\x3e\r\n                      \x3coption value\x3d"12" selected\x3d"selected"\x3e12\x3c/option\x3e\r\n                      \x3coption value\x3d"13" selected\x3d"selected"\x3e13\x3c/option\x3e\r\n                      \x3coption value\x3d"14" selected\x3d"selected"\x3e14\x3c/option\x3e\r\n                      \x3coption value\x3d"15" selected\x3d"selected"\x3e15\x3c/option\x3e\r\n                      \x3coption value\x3d"16" selected\x3d"selected"\x3e16\x3c/option\x3e\r\n                      \x3coption value\x3d"18" selected\x3d"selected"\x3e18\x3c/option\x3e\r\n                      \x3coption value\x3d"20" selected\x3d"selected"\x3e20\x3c/option\x3e\r\n                      \x3coption value\x3d"24" selected\x3d"selected"\x3e24\x3c/option\x3e\r\n                      \x3coption value\x3d"28" selected\x3d"selected"\x3e28\x3c/option\x3e\r\n                      \x3coption value\x3d"32" selected\x3d"selected"\x3e32\x3c/option\x3e\r\n                      \x3coption value\x3d"36" selected\x3d"selected"\x3e36\x3c/option\x3e\r\n                      \x3coption value\x3d"40" selected\x3d"selected"\x3e40\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv class\x3d"rendererLabelsFontButton"\x3e\r\n                      \x3cbutton dojoAttachPoint\x3d"_rendererLabelsFontBoldButton" dojotype\x3d"dijit.form.ToggleButton" type\x3d"button" dojoAttachEvent\x3d"onClick:_onClickRendererLabelsFontBold"\x3e\r\n                        \x3cspan style\x3d"font-weight: bold;"\x3e${i18n.boldAbbr}\x3c/span\x3e\r\n                      \x3c/button\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv class\x3d"rendererLabelsFontButton"\x3e\r\n                      \x3cbutton dojoAttachPoint\x3d"_rendererLabelsFontItalicButton"  dojotype\x3d"dijit.form.ToggleButton" type\x3d"button" dojoAttachEvent\x3d"onClick:_onClickRendererLabelsFontItalic"\x3e\r\n                        \x3cspan style\x3d"font-style: italic;"\x3e${i18n.italicAbbr}\x3c/span\x3e\r\n                      \x3c/button\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv class\x3d"rendererLabelsFontButton"\x3e\r\n                      \x3cbutton dojoAttachPoint\x3d"_rendererLabelsFontUnderlineButton" dojotype\x3d"dijit.form.ToggleButton" type\x3d"button" dojoAttachEvent\x3d"onClick:_onClickRendererLabelsFontUnderline"\x3e\r\n                        \x3cspan style\x3d"text-decoration: underline;"\x3e${i18n.underlineAbbr}\x3c/span\x3e\r\n                      \x3c/button\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv dojoAttachPoint\x3d"_rendererLabelsTextColor" dojoAttachEvent\x3d"onClick:_onClickRendererLabelsTextColor" class\x3d"RendererLabelsTextColorBox"\x3e\x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr id\x3d"rendererLabelsHaloSection"\x3e\r\n            \x3ctd\x3e\r\n              \x26nbsp;\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3ctable\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd colspan\x3d"2"\x3e\r\n                    \x3cinput dojoAttachPoint\x3d"_rendererLabelsHaloCheck" dojotype\x3d"dijit.form.CheckBox"  dojoAttachEvent\x3d"onChange:_onChangeRendererLabelsHaloCheck" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                    \x3clabel\x3e\r\n                      ${i18n.halo}\r\n                    \x3c/label\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x26nbsp;\x26nbsp;\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3ctable style\x3d"padding: 5px 0"\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput" class\x3d"calcite light" style\x3d"padding-right: 5px;" dojoAttachPoint\x3d"_rendererLabelsHaloSizes" dojoAttachEvent\x3d"onChange:_onChangeRendererLabelsHaloSize" dojoType\x3d"dijit.form.Select"\x3e\r\n                            \x3coption value\x3d"1" selected\x3d"selected"\x3e1\x3c/option\x3e\r\n                            \x3coption value\x3d"2"\x3e2\x3c/option\x3e\r\n                            \x3coption value\x3d"3"\x3e3\x3c/option\x3e\r\n                            \x3coption value\x3d"4"\x3e4\x3c/option\x3e\r\n                            \x3coption value\x3d"5"\x3e5\x3c/option\x3e\r\n                            \x3coption value\x3d"6"\x3e6\x3c/option\x3e\r\n                            \x3coption value\x3d"7"\x3e7\x3c/option\x3e\r\n                            \x3coption value\x3d"8"\x3e8\x3c/option\x3e\r\n                            \x3coption value\x3d"9"\x3e9\x3c/option\x3e\r\n                            \x3coption value\x3d"10"\x3e10\x3c/option\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cdiv dojoAttachPoint\x3d"_rendererLabelsHaloColor" dojoAttachEvent\x3d"onClick:_onClickRendererLabelsHaloColor" class\x3d"RendererLabelsTextColorBox"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr dojoAttachPoint\x3d"_rendererLabelsAlignmentSectionTitle" style\x3d"display:none;"\x3e\r\n            \x3ctd nowrap colspan\x3d"2"\x3e\r\n              \x3cdiv style\x3d"padding: 10px 0 5px 0;"\x3e\r\n                \x3clabel\x3e\r\n                  ${i18n.alignmentLabel}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr dojoAttachPoint\x3d"_rendererLabelsAlignmentSectionPoint" style\x3d"display:none;"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x26nbsp;\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cdiv dojoAttachPoint\x3d"_rendererLabelsAlignment" dojotype\x3d"esri.dijit.FontAlignment"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr dojoAttachPoint\x3d"_rendererLabelsAlignmentSectionLine" style\x3d"display:none;"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x26nbsp;\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"linePlacement" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_rendererLabelsAlignmentLineAbove" checked\x3d"checked" dojoAttachEvent\x3d"onClick:_onRendererLabelsAlignmentLineChange"/\x3e\r\n                  \x3clabel for\x3d"linePlacement:above"\x3e\r\n                    ${i18n.aboveLine}\r\n                  \x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"linePlacement" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_rendererLabelsAlignmentLineOn" dojoAttachEvent\x3d"onClick:_onRendererLabelsAlignmentLineChange" /\x3e\r\n                  \x3clabel for\x3d"linePlacement:on"\x3e\r\n                    ${i18n.onLine}\r\n                  \x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"linePlacement" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_rendererLabelsAlignmentLineBelow" dojoAttachEvent\x3d"onClick:_onRendererLabelsAlignmentLineChange" /\x3e\r\n                  \x3clabel for\x3d"linePlacement:below"\x3e\r\n                    ${i18n.belowLine}\r\n                  \x3c/label\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr dojoAttachPoint\x3d"_rendererLabelsRangeSectionTitle"\x3e\r\n            \x3ctd nowrap colspan\x3d"2"\x3e\r\n              \x3cdiv style\x3d"padding: 10px 0 5px 0;"\x3e\r\n                \x3clabel\x3e\r\n                  ${i18n.rangeLabel}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr dojoAttachPoint\x3d"_rendererLabelsRangeSection"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x26nbsp;\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding:10px 0;"\x3e\r\n                \x3cdiv id\x3d"rendererLabelsScaleSlider"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv id\x3d"rendererLabelsContentBottom" dojoType\x3d"dijit.layout.BorderContainer" region\x3d"bottom" gutters\x3d"false" design\x3d"headline" style\x3d"height:80px;padding:0; margin:0px;"\x3e\r\n\r\n    \x3cdiv id\x3d"rendererLabelsContentButtons" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"padding:9px 5px 1px 5px;margin-top:5px;"\x3e\r\n      \x3cdiv id\x3d"rendererLabelsContentButtonsCenter" align\x3d"center"\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" class\x3d"calcite blue" type\x3d"button" dojoAttachEvent\x3d"onClick:_onOK" dojoAttachPoint\x3d"_okButton"\x3e\r\n          \x3cspan\x3e${i18n.ok}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" class\x3d"calcite transparent" type\x3d"button" dojoAttachEvent\x3d"onClick:_onCancel"\x3e\r\n          \x3cspan\x3e${i18n.cancel}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"rendererLabelsContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"padding: 0 5px 0 5px; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"rendererLabelsSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv dojoAttachPoint\x3d"textColorTooltip" dojotype\x3d"dijit.TooltipDialog" title\x3d"" style\x3d"display:none; width:265px;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cA class\x3d"textColorPaletteClose" dojoAttachPoint\x3d"textColorTooltipClose" href\x3d"JavaScript:void(0);" title\x3d"${i18n.close}"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"textColorPalette" style\x3d"margin-top: 7px;" dojotype\x3d"dijit.ColorPalette" palette\x3d"7x10" dojoAttachEvent\x3d"onChange:_onColorSelection"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"haloColorTooltip" dojotype\x3d"dijit.TooltipDialog" title\x3d"" style\x3d"display:none; width:265px;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cA class\x3d"textColorPaletteClose" dojoAttachPoint\x3d"haloColorTooltipClose" href\x3d"JavaScript:void(0);" title\x3d"${i18n.close}"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"haloColorPalette" style\x3d"margin-top: 7px;" dojotype\x3d"dijit.ColorPalette" palette\x3d"7x10" dojoAttachEvent\x3d"onChange:_onHaloColorSelection"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
            _rConnects: null,
            _tooltips: [],
            i18n: null,
            disableAllEvents: !0,
            container: null,
            subLayerId: null,
            mapLayer: null,
            layer: null,
            originalLabelingInfo: null,
            originalShowLabels: null,
            labelingInfo: null,
            scaleSlider: null,
            textSymbol: null,
            defaultTextSymbol: { type: "esriTS", color: [51, 51, 51, 255], backgroundColor: null, borderLineColor: null, rightToLeft: !1, angle: 0, xoffset: 0, yoffset: 0, kerning: !0, font: { family: "Arial", size: 9.75, style: "normal", weight: "bold", decoration: "none" } },
            _dateFormats: [{
                value: '{"dateFormat":"shortDate", "timezone":"utc"}',
                label: "12/21/1997"
            }, { value: '{"dateFormat":"longMonthDayYear", "timezone":"utc"}', label: "December 21, 1997" }, { value: '{"dateFormat":"dayShortMonthYear", "timezone":"utc"}', label: "21 Dec 1997" }, { value: '{"dateFormat":"longDate", "timezone":"utc"}', label: "Sunday, December 21, 1997" }, { value: '{"dateFormat":"shortDateShortTime", "timezone":"utc"}', label: "12/21/1997 6:00 PM" }, { value: '{"dateFormat":"shortDateShortTime24", "timezone":"utc"}', label: "12/21/1997 18:00" }, {
                value: '{"dateFormat":"longMonthYear", "timezone\':"utc"}',
                label: "December 1997"
            }, { value: '{"dateFormat":"shortMonthYear", "timezone":"utc"}', label: "Dec 1997" }, { value: '{"dateFormat":"year", "timezone":"utc"}', label: "1997" }, { value: '{"dateFormat":"shortDateLE", "timezone":"utc"}', label: "21/12/1997" }, { value: '{"dateFormat":"shortDateLEShortTime", "timezone":"utc"}', label: "21/12/1997 6:00 PM" }, { value: '{"dateFormat":"shortDateLEShortTime24", "timezone":"utc"}', label: "21/12/1997 18:00" }],
            _numberFormats: [{ value: '{"places":0, "digitSeparator":true}', label: "0 decimal places" },
                { value: '{"places":1, "digitSeparator":true}', label: "1 decimal place" }, { value: '{"places":2, "digitSeparator":true}', label: "2 decimal places" }, { value: '{"places":3, "digitSeparator":true}', label: "3 decimal places" }, { value: '{"places":4, "digitSeparator":true}', label: "4 decimal places" }, { value: '{"places":5, "digitSeparator":true}', label: "5 decimal places" }, { value: '{"places":6, "digitSeparator":true}', label: "6 decimal places" }
            ],
            _labelPlacementLookupPoint: {
                "top,center": "esriServerPointLabelPlacementBelowCenter",
                "top,left": "esriServerPointLabelPlacementBelowRight",
                "top,right": "esriServerPointLabelPlacementBelowLeft",
                "baseline,center": "esriServerPointLabelPlacementAboveCenter",
                "baseline,left": "esriServerPointLabelPlacementAboveRight",
                "baseline,right": "esriServerPointLabelPlacementAboveLeft",
                "middle,center": "esriServerPointLabelPlacementCenterCenter",
                "middle,left": "esriServerPointLabelPlacementCenterRight",
                "middle,right": "esriServerPointLabelPlacementCenterLeft"
            },
            _labelPlacementLookupLine: {
                "top,center": "esriServerLinePlacementAboveAlong",
                "baseline,center": "esriServerLinePlacementBelowAlong",
                "middle,center": "esriServerLinePlacementCenterAlong"
            },
            constructor: function(a, b) {
                a && (a.containerNode && (this.container = a.containerNode), this.subLayerId = a.subLayerId, this.mapLayer = a.mapLayer, this.isFeatCol = arcgisonline.map.featColl.isFeatureCollection(this.mapLayer), this.isCSV = this.mapLayer.layer instanceof esri.layers.CSVLayer, this.isWFS = this.mapLayer.layer instanceof esri.layers.WFSLayer, this.supportsDynLyrs = (this.isDMS = this.mapLayer.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer) && this.mapLayer.layer.supportsDynamicLayers, this.hasDynamic = arcgisonline.map.main.hasDynamicLayers(this.mapLayer), this._rConnects = [])
            },
            destroy: function() {
                g.popup.close(this.textColorTooltip);
                b.forEach(this._rConnects, b.disconnect);
                delete this._rConnects;
                b.forEach(this._tooltips, function(a) { a.destroy() });
                this.inherited(arguments)
            },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.clone(b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").rendererPanel);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").rendererLabelsPanel)
            },
            postCreate: function() {
                this.container.addChild(g.byId("rendererLabelsPanel"));
                this.loadConnections()
            },
            loadConnections: function() {
                this._rConnects.push(b.connect(g.byId("leftContentPanel"), "resize", this, "adjustHeight"));
                this._rConnects.push(b.connect(this.textColorTooltipClose,
                    "onclick", b.hitch(this, function(a) {
                        a.preventDefault();
                        g.popup.close(this.textColorTooltip)
                    })));
                this._rConnects.push(b.connect(this.haloColorTooltipClose, "onclick", b.hitch(this, function(a) {
                    a.preventDefault();
                    g.popup.close(this.haloColorTooltip)
                })));
                this._rConnects.push(b.connect(this._rendererLabelsAlignment, "onchange", b.hitch(this, "_onChangeRendererLabelsAlignment")));
                this._rConnects.push(b.connect(this._closeBtn, "onclick", this, "_onCancel"));
                this._rConnects.push(b.connect(this._rendererLabelsEditExpression,
                    "click", b.hitch(this, "_onEditExpressionClick")));
                this._tooltips.push(new g.Tooltip({ connectId: this._rendererLabelsEditExpression, label: "\x3cdiv class\x3d'galleryTooltip'\x3e" + this.i18n.editExpression + "\x3c/div\x3e" }))
            },
            startup: function() {
                this.inherited(arguments);
                isEmbedded ? isEmbedded.isItemDetail || (b.style(b.byId("rendererLabelsContentHeader"), "display", ""), b.style(this._rendererLabelsLayerName, "display", "")) : (b.style(b.byId("rendererLabelsContentFooter"), "display", ""), b.style(b.byId("rendererLabelsContentHeader"),
                    "display", ""), b.style(this._rendererLabelsLayerName, "display", ""));
                this._init()
            },
            _init: function(a) {
                this.disableAllEvents = !0;
                10 > b.isIE && b.style(b.byId("rendererLabelsHaloSection"), "display", "none");
                this._rendererLabelsLayerName.innerHTML = arcgisonline.map.main.getLayerTitle(this.mapLayer, this.subLayerId);
                this.isHosted = !1;
                this.mapLayer.layer instanceof esri.layers.GeoRSSLayer ? (-1 == this.subLayerId && (this.subLayerId = 0), this.layer = this.mapLayer.layer.getFeatureLayers()[this.subLayerId]) : this.supportsDynLyrs ?
                    this.hasDynamic ? b.forEach(this.mapLayer.layer.dynamicLayerInfos, function(a) { a.id === this.subLayerId && b.forEach(this.mapLayer.layersInfo.layers, function(b) { b.id === a.source.mapLayerId && (this.layer = b) }, this) }, this) : b.forEach(this.mapLayer.layersInfo.layers, function(a) { a.id === this.subLayerId && (this.layer = a) }, this) : this.mapLayer.layer ? (this.layer = this.mapLayer.layer, this.isHosted = arcgisonline.sharing.util.isHostedService(this.layer.url)) : this.layer = this.mapLayer.layers[this.subLayerId];
                this.cimVersion =
                    0;
                if (this.mapLayer.serviceInfo && this.mapLayer.serviceInfo.cimVersion) {
                    var c = this.mapLayer.serviceInfo.cimVersion.split(".");
                    this.cimVersion = parseFloat(1 === c.length ? this.mapLayer.serviceInfo.cimVersion : c[0] + "." + c[1])
                }
                this.geometryType = this.layer.geometryType;
                "esriGeometryPolygon" === this.geometryType || "esriGeometryMultipoint" === this.geometryType ? (b.style(this._rendererLabelsAlignmentSectionTitle, "display", "none"), b.style(this._rendererLabelsAlignmentSectionPoint, "display", "none"), b.style(this._rendererLabelsAlignmentSectionLine,
                    "display", "none")) : "esriGeometryPoint" === this.geometryType ? (b.style(this._rendererLabelsAlignmentSectionTitle, "display", ""), b.style(this._rendererLabelsAlignmentSectionPoint, "display", ""), b.style(this._rendererLabelsAlignmentSectionLine, "display", "none")) : (b.style(this._rendererLabelsAlignmentSectionTitle, "display", ""), b.style(this._rendererLabelsAlignmentSectionPoint, "display", "none"), b.style(this._rendererLabelsAlignmentSectionLine, "display", ""));
                this.scaleSlider = new esri.dijit.VisibleScaleRangeSlider({
                    map: arcgisonline.map.main.map,
                    layer: this.supportsDynLyrs ? this.mapLayer.layer : this.layer,
                    region: esriGeowConfig.self.region
                }, "rendererLabelsScaleSlider");
                this.scaleSlider.startup();
                this.scaleSlider.on("scale-range-change", b.hitch(this, function(a) { this.disableAllEvents || this._onSaveLabelingInfo() }));
                this.labelingInfo = this.layer.labelingInfo;
                this.supportsDynLyrs && (this.labelingInfo = (c = arcgisonline.map.dynLayer.getDrawingInfoForLabels(this.mapLayer, this.subLayerId)) && c.labelingInfo && c.labelingInfo[0] ? [new esri.layers.LabelClass(c.labelingInfo[0])] :
                    null, this.originalShowLabels = c ? c.showLabels : null);
                this.originalLabelingInfo = null;
                if (this.labelingInfo) {
                    if (this.labelingInfo.length) {
                        c = this.labelingInfo[0].symbol.font.family;
                        if (-1 === b.indexOf(["Arial Unicode MS", "Arial"], c)) {
                            var d = document.createElement("option");
                            d.text = c;
                            d.value = c;
                            this._rendererLabelsFont.addOption(d)
                        }
                        this._rendererLabelsFont.set("value", c)
                    }
                    this.originalLabelingInfo = b.map(this.labelingInfo, function(a) { return new esri.layers.LabelClass(b.clone(a.toJson())) })
                }
                this.originalShowLabels =
                    this.supportsDynLyrs ? this.originalShowLabels : this.mapLayer.showLabels;
                (this.isFeatCol || this.isWFS) && this.mapLayer.itemId && (this.originalShowLabels = arcgisonline.map.labels.hasLayer(this.layer));
                this.updateUIWithLabelingInfo(a)
            },
            updateUIWithLabelingInfo: function(a) {
                if (this.labelingInfo) {
                    this.labelingClass = this.labelingInfo[0];
                    if (!this.labelingClass.labelExpressionInfo || !this.labelingClass.labelExpressionInfo.value) {
                        var c = /^(\s*\[[^\]]+\]\s*)+$/i;
                        this.labelingClass.labelExpression && !c.test(this.labelingClass.labelExpression) &&
                            (c = this.getDisplayField(), this.labelingClass.labelExpression = "[" + c + "]", this.labelingClass.labelExpressionInfo = { expression: "$feature." + c })
                    }
                    this.textSymbol = this.labelingClass.symbol;
                    "esriGeometryPoint" === this.geometryType ? this._rendererLabelsAlignment.setValue(esri.valueOf(this._labelPlacementLookupPoint, this.labelingClass.toJson().labelPlacement)) : "esriGeometryPolyline" === this.geometryType && (c = esri.valueOf(this._labelPlacementLookupLine, this.labelingClass.toJson().labelPlacement), "top,center" === c ?
                        (this._rendererLabelsAlignmentLineOn.set("checked", !1), this._rendererLabelsAlignmentLineBelow.set("checked", !1), this._rendererLabelsAlignmentLineAbove.set("checked", !0)) : "middle,center" === c ? (this._rendererLabelsAlignmentLineAbove.set("checked", !1), this._rendererLabelsAlignmentLineBelow.set("checked", !1), this._rendererLabelsAlignmentLineOn.set("checked", !0)) : (this._rendererLabelsAlignmentLineAbove.set("checked", !1), this._rendererLabelsAlignmentLineOn.set("checked", !1), this._rendererLabelsAlignmentLineBelow.set("checked", !0)));
                    this.textSymbol.haloSize && this.textSymbol.haloColor ? (this._rendererLabelsHaloCheck.set("checked", !0), this._rendererLabelsHaloSizes.set("value", this.textSymbol.haloSize), c = this.textSymbol.haloColor.toHex(), b.style(this._rendererLabelsHaloColor, "background", c)) : (this._rendererLabelsHaloCheck.set("checked", !1), this._rendererLabelsHaloSizes.set("value", 1), b.style(this._rendererLabelsHaloColor, "background", "#FFFFFF"))
                } else this.textSymbol = new esri.symbols.TextSymbol(this.defaultTextSymbol), -1 < b.indexOf("ja zh-cn zh-hk zh-tw ko hi th".split(" "),
                    b.locale) && (this.textSymbol.font.weight = esri.symbol.Font.WEIGHT_NORMAL), c = this.getDisplayField(), this._rendererLabelsAttribute.set("value", this.getDisplayField()), "esriGeometryPoint" === this.geometryType ? this._rendererLabelsAlignment.setValue("baseline,left") : "esriGeometryPolyline" === this.geometryType && this._rendererLabelsAlignmentLineAbove.set("checked", !0), this._rendererLabelsHaloCheck.set("checked", !1), this._rendererLabelsHaloSizes.set("value", 1), b.style(this._rendererLabelsHaloColor, "background",
                    "#FFFFFF");
                this.createFieldInfosStore();
                b.style(this._rendererLabelsEditExpression, "display", "none");
                if (this.labelingClass && this.labelingClass.labelExpression) {
                    var d = this.labelingClass.labelExpression;
                    this._rendererLabelsAttribute.set("value", d.substring(1, d.length - 1))
                } else if (this.labelingClass && this.labelingClass.labelExpressionInfo && this.labelingClass.labelExpressionInfo.value) d = this.labelingClass.labelExpressionInfo.value, 0 === d.indexOf("{") && 0 === d.lastIndexOf("{") && d.indexOf("}") === d.length - 1 ?
                    this._rendererLabelsAttribute.set("value", d.substring(1, d.length - 1)) : 0 === d.indexOf("DomainName($feature,") && 10 === d.lastIndexOf("(") && -1 === d.indexOf("{") && d.indexOf(")") === d.length - 1 ? this._rendererLabelsAttribute.set("value", d.substring(21, d.length - 2)) : this._rendererLabelsAttribute.set("value", "customExpr");
                else if (this.labelingClass && this.labelingClass.labelExpressionInfo && this.labelingClass.labelExpressionInfo.expression)
                    if (c = this.labelingClass.labelExpressionInfo.expression, c.startsWith("$feature.")) {
                        var d =
                            c.substring(9),
                            f = b.some(this.layer.fields, function(a) { return a.name === d });
                        f ? this._rendererLabelsAttribute.set("value", d) : (this._rendererLabelsAttribute.set("value", "customExpr"), b.style(this._rendererLabelsEditExpression, "display", ""))
                    } else c.startsWith('$feature["') ? (d = c.substring(10, c.length - 2), (f = b.some(this.layer.fields, function(a) { return a.name === d })) ? this._rendererLabelsAttribute.set("value", d) : -1 < c.indexOf("DomainName($feature,") ? (d = c.substring(10, c.indexOf('"]')), (f = b.some(this.layer.fields,
                        function(a) { return a.name === d })) && c === '$feature["' + d + '"]\nDomainName($feature,"' + d + '")' ? this._rendererLabelsAttribute.set("value", d) : (this._rendererLabelsAttribute.set("value", "customExpr"), b.style(this._rendererLabelsEditExpression, "display", ""))) : (this._rendererLabelsAttribute.set("value", "customExpr"), b.style(this._rendererLabelsEditExpression, "display", ""))) : c.startsWith("DomainName($feature,") ? (d = c.substring(21), d = d.substring(0, d.length - 2), (f = b.some(this.layer.fields, function(a) {
                        return a.name ===
                            d
                    })) ? this._rendererLabelsAttribute.set("value", d) : (this._rendererLabelsAttribute.set("value", "customExpr"), b.style(this._rendererLabelsEditExpression, "display", ""))) : (this._rendererLabelsAttribute.set("value", "customExpr"), b.style(this._rendererLabelsEditExpression, "display", ""));
                else this._rendererLabelsAttribute.set("value", this.getDisplayField());
                "embeddedCancel" === a ? (this._rendererLabelsCheck.set("checked", this.labelingInfo ? !0 : !1), b.style(b.byId("rendererLabelsOptions"), "display", this.labelingInfo ?
                    "" : "none")) : this._rendererLabelsCheck.set("checked", !0);
                this._rendererLabelsFont.set("value", this.textSymbol.font.family);
                this._rendererLabelsFontSizes.set("value", "" + Math.round(this.textSymbol.font.size));
                this._rendererLabelsFontUnderlineButton.set("checked", "underline" === this.textSymbol.font.decoration);
                b.style(this._rendererLabelsTextColor, "background", this.textSymbol.color.toHex());
                "Arial Unicode MS" === this.textSymbol.font.family ? (this._rendererLabelsFontBoldButton.set("checked", !1), this._rendererLabelsFontItalicButton.set("checked", !1), this._rendererLabelsFontBoldButton.set("disabled", !0), this._rendererLabelsFontItalicButton.set("disabled", !0)) : (this._rendererLabelsFontBoldButton.set("checked", this.textSymbol.font.weight === esri.symbol.Font.WEIGHT_BOLD), this._rendererLabelsFontItalicButton.set("checked", this.textSymbol.font.style === esri.symbol.Font.STYLE_ITALIC));
                this.scaleSlider.set({
                    minScale: this.labelingClass && esri.isDefined(this.labelingClass.minScale) ? this.labelingClass.minScale : 0,
                    maxScale: this.labelingClass && esri.isDefined(this.labelingClass.maxScale) ?
                        this.labelingClass.maxScale : 0
                });
                this.adjustHeight();
                setTimeout(b.hitch(this, function() {
                    this.disableAllEvents = !1;
                    this._onSaveLabelingInfo()
                }), 500)
            },
            getDisplayField: function() {
                if (this.layer.displayField) return this.layer.displayField;
                for (var a = null, b = null, d = null, f = 0; f < this.layer.fields.length; f++) {
                    var e = this.layer.fields[f];
                    if ("name" === e.name.toLowerCase()) return e.name;
                    !a && -1 < e.name.toLowerCase().indexOf("name") ? a = e.name : b || "esriFieldTypeString" !== e.type ? d || "esriFieldTypeDouble" !== e.type && "esriFieldTypeInteger" !==
                        e.type || (d = e.name) : b = e.name
                }
                if (a) return a;
                if (b) return b;
                if (d) return d;
                for (f = 0; f < this.layer.fields.length; f++)
                    if (e = this.layer.fields[f], "esriFieldTypeGeometry" !== e.type) return e.name;
                return ""
            },
            getPopupInfo: function() {
                this.popupInfo = {};
                if (arcgisonline.map.featColl.isFeatureCollection(this.mapLayer) || this.layer instanceof esri.layers.CSVLayer) {
                    if (this.mapLayer.layers)
                        for (var a = 0; a < this.mapLayer.layers.length; a++) {
                            if (a === this.subLayerId) {
                                this.popupInfo = this.mapLayer.layers[a].__popupInfo ? this.mapLayer.layers[a].__popupInfo :
                                    this.mapLayer.layers[a].toJson().popupInfo;
                                break
                            }
                        } else this.popupInfo = this.mapLayer.popupInfo ? this.mapLayer.popupInfo : this.mapLayer.layer.toJson().popupInfo;
                    this.popupInfo || (this.popupInfo = {})
                } else -1 == this.subLayerId && (this.popupInfo = this.mapLayer.popupInfo ? this.mapLayer.popupInfo : {})
            },
            createFieldInfosStore: function() {
                if (!this._fieldInfosStore) {
                    var a = this.layer.fields;
                    this.getPopupInfo();
                    var c = this.popupInfo.fieldInfos;
                    this.mapLayer.thematicGroup && this.mapLayer.thematicGroup.fieldNames && this.mapLayer.thematicGroup.fieldNames.length &&
                        (a = b.filter(a, function(a) { return b.some(this.mapLayer.thematicGroup.fieldNames, function(b) { return b === a.name }, this) }, this));
                    var d = [],
                        f = 0,
                        e, g = { esriFieldTypeDouble: 1, esriFieldTypeSingle: 1 },
                        m = { esriFieldTypeInteger: 1, esriFieldTypeSmallInteger: 1 },
                        p = { esriFieldTypeDate: 1 };
                    c && c.length ? b.forEach(a, b.hitch(this, function(a, h) {
                        if (b.some(c, b.hitch(this, function(b, c) { f = c; return a.name === b.fieldName }))) {
                            e = c[f];
                            var n = b.mixin({}, e),
                                n = b.mixin(n, {
                                    isEditable: !1 === a.editable ? !1 : esri._isDefined(e.isEditable) ? e.isEditable : a.editable
                                });
                            esri.isDefined(e.format) && (n = b.mixin(n, { format: b.json.stringify(e.format) }));
                            n.label = arcgisonline.sharing.util.htmlEncode(n.label || a.alias || a.name);
                            h = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1;
                            d.push(b.mixin({ _fieldType: a.type, _hasDomain: h, _pos: f, _inChart: !1 }, n))
                        } else {
                            h = esri.isDefined(a.domain) ? a.domain && "codedvalue" == a.domain.type.toLowerCase() : !1;
                            n = null;
                            h || (a.type in m ? n = this._numberFormats[0].value : a.type in g ? n = this._numberFormats[2].value : a.type in
                                p && 10 <= this.mapLayer.layer.version && (n = this._dateFormats[4].value));
                            var r = "esriFieldTypeString" === a.type || h ? "textbox" : null;
                            d.push({ fieldName: a.name, label: arcgisonline.sharing.util.htmlEncode(a.alias || a.name), isEditable: a.editable || !1, tooltip: null, visible: !1, format: n, stringFieldOption: r, _fieldType: a.type, _hasDomain: h, _pos: 9999, _inChart: !1 })
                        }
                    })) : (d = [], b.forEach(a, b.hitch(this, function(a, c) {
                        if ("esriFieldTypeGeometry" !== a.type) {
                            var e = a.name.toLowerCase(),
                                f = esri.isDefined(a.domain) ? a.domain && "codedvalue" ==
                                a.domain.type.toLowerCase() : !1,
                                h = { subclass: 0, rings_ok: 0, rings_nok: 0 },
                                n = "esriFieldTypeOID" !== a.type && "esriFieldTypeGlobalID" !== a.type && "esriFieldTypeGeometry" !== a.type,
                                n = (n = n && !(e in h) && !(-1 < e.indexOf("area") || -1 < e.indexOf("length") || -1 < e.indexOf("perimeter"))) && e.lastIndexOf("_i", e.length - 2) !== e.length - 2,
                                e = null;
                            f || (a.type in m ? e = this._numberFormats[0].value : a.type in g ? e = this._numberFormats[2].value : a.type in p && 10 <= this.mapLayer.layer.version && (e = this._dateFormats[4].value));
                            h = "esriFieldTypeString" ===
                                a.type || f ? "textbox" : null;
                            d.push(b.mixin({}, { fieldName: a.name, label: arcgisonline.sharing.util.htmlEncode(a.alias || a.name), isEditable: a.editable || !1, tooltip: null, visible: n, format: e, stringFieldOption: h, _pos: c, _inChart: !1, _hasDomain: f, _fieldType: a.type, _editable: a.editable }))
                        }
                    })));
                    if (!this.isWFS && (!this.supportsDynLyrs || this.supportsDynLyrs && 10.5 < this.mapLayer.layer.version && 1.4 <= this.cimVersion)) {
                        d.push({ fieldName: "expressionSeparator", label: "", type: "separator" });
                        var r;
                        if (this.labelingClass && !this.labelingClass.labelExpression)
                            if (this.labelingClass.labelExpressionInfo &&
                                this.labelingClass.labelExpressionInfo.expression)
                                if (r = this.labelingClass.labelExpressionInfo.expression, r.startsWith("$feature.")) {
                                    var v = r.substring(9),
                                        a = b.some(a, function(a) { return a.name === v });
                                    a || (r = this.labelingClass.labelExpressionInfo.expression)
                                } else r.startsWith('$feature["') ? (v = r.substring(10, r.length - 2), a = b.some(this.layer.fields, function(a) { return a.name === v }), a || (-1 < r.indexOf("DomainName($feature,") ? (v = r.substring(10, r.indexOf('"]')), a = b.some(this.layer.fields, function(a) {
                                    return a.name ===
                                        v
                                }), a && r === '$feature["' + v + '"]\nDomainName($feature,"' + v + '")' || (r = this.labelingClass.labelExpressionInfo.expression)) : r = this.labelingClass.labelExpressionInfo.expression)) : r.startsWith("DomainName($feature,") ? (v = r.substring(21, r.length - 2), a = b.some(a, function(a) { return a.name === v }), a || (r = this.labelingClass.labelExpressionInfo.expression)) : r = this.labelingClass.labelExpressionInfo.expression;
                        else this.labelingClass.labelExpressionInfo && this.labelingClass.labelExpressionInfo.value && (v = this.labelingClass.labelExpressionInfo.value,
                            0 !== v.indexOf("{") || 0 !== v.lastIndexOf("{") || v.indexOf("}") !== v.length - 1) && (r = this.convertTemplatedStringToArcade(v));
                        d.push({ fieldName: "customExpr", label: this.labelingClass && this.labelingClass.name ? b.string.substitute(this.i18n.customExpression, { name: this.labelingClass.name }) : r ? b.string.substitute(this.i18n.customExpression, { name: this.i18n.custom }) : this.i18n.newExpression, expression: r, expressionTitle: this.labelingClass && this.labelingClass.name })
                    }
                    this._fieldInfosStore = new n.data.AndOrWriteStore({
                        data: {
                            label: "label",
                            identifier: "fieldName",
                            items: d
                        }
                    });
                    this._rendererLabelsAttribute.setStore(this._fieldInfosStore, "", {})
                }
            },
            _onChangeAttribute: function() {
                var a = this._rendererLabelsAttribute.get("value");
                "customExpr" === a ? (this._fieldInfosStore.fetchItemByIdentity({
                    identity: a,
                    onItem: b.hitch(this, function(a) {
                        a.expression && a.expression[0] ? (b.style(this._rendererLabelsEditExpression, "display", ""), this._onSaveLabelingInfo()) : this.onClickExpressionEditor().then(b.hitch(this, function(c) {
                            this._fieldInfosStore.setValue(a, "expression",
                                c.expression);
                            this._fieldInfosStore.setValue(a, "expressionTitle", c.title);
                            this._fieldInfosStore.setValue(a, "label", b.string.substitute(this.i18n.customExpression, { name: c.title || this.i18n.custom }));
                            this._onChangeAttribute();
                            this.updateUIWithLabelingInfo()
                        }), b.hitch(this, function() { this.updateUIWithLabelingInfo() }))
                    })
                }), this._onSaveLabelingInfo()) : (this._onSaveLabelingInfo(), b.style(this._rendererLabelsEditExpression, "display", "none"));
                this.adjustHeight()
            },
            _onChangeFont: function() {
                "Arial Unicode MS" ===
                this._rendererLabelsFont.get("value") ? (this._rendererLabelsFontBoldButton.set("checked", !1), this._rendererLabelsFontItalicButton.set("checked", !1), this._rendererLabelsFontBoldButton.set("disabled", !0), this._rendererLabelsFontItalicButton.set("disabled", !0)) : (this._rendererLabelsFontBoldButton.set("checked", this.textSymbol.font.weight === esri.symbol.Font.WEIGHT_BOLD), this._rendererLabelsFontItalicButton.set("checked", this.textSymbol.font.style === esri.symbol.Font.STYLE_ITALIC), this._rendererLabelsFontBoldButton.set("disabled", !1), this._rendererLabelsFontItalicButton.set("disabled", !1));
                this._onSaveLabelingInfo()
            },
            _onSaveLabelingInfo: function(a) {
                if ("rendererLabelsStack" === arcgisonline.map.leftPanel.getLeftContentPanelStack())
                    if (this._rendererLabelsCheck.get("checked")) {
                        var c = this._rendererLabelsAttribute.get("value");
                        "customExpr" === c ? this._fieldInfosStore.fetchItemByIdentity({ identity: c, onItem: b.hitch(this, function(a) { a.expression[0] && this.saveLabelingInfo(c, a.expression[0], a.expressionTitle[0]) }) }) : this._fieldInfosStore.fetchItemByIdentity({
                            identity: c,
                            onItem: b.hitch(this, function(a) { this._fieldInfosStore.getValue(a, "_hasDomain") ? this.saveLabelingInfo("customExpr", '$feature["' + c + '"]\nDomainName($feature,"' + c + '")') : this.saveLabelingInfo(c, '$feature["' + c + '"]') })
                        })
                    } else this.supportsDynLyrs ? arcgisonline.map.dynLayer.removeLabelingInfo(this.mapLayer, this.subLayerId) : (delete this.mapLayer.showLabels, arcgisonline.map.labels.removeLabelsForLayer(this.layer))
            },
            saveLabelingInfo: function(a, c, d) {
                this.supportsDynLyrs && (10.5 >= this.mapLayer.layer.version || 1.4 >
                    this.cimVersion) ? c = { labelExpression: "[" + a + "]", useCodedValues: !0, maxScale: 0, minScale: 0 } : (c = { labelExpressionInfo: { expression: c }, name: d, useCodedValues: !0, maxScale: 0, minScale: 0 }, "customExpr" !== a && (c.labelExpressionInfo.value = "{" + a + "}"));
                if (!this.supportsDynLyrs) {
                    a = [];
                    for (var f = c.labelExpressionInfo.expression.indexOf("$feature.", f); - 1 < f;) d = c.labelExpressionInfo.expression.indexOf(" ", f), -1 === d ? (a.push(c.labelExpressionInfo.expression.substring(f + 9)), f = -1) : (a.push(c.labelExpressionInfo.expression.substring(f +
                        9, d)), f = c.labelExpressionInfo.expression.indexOf("$feature.", d));
                    for (f = c.labelExpressionInfo.expression.indexOf("$feature[", f); - 1 < f;) d = c.labelExpressionInfo.expression.indexOf("]", f), a.push(c.labelExpressionInfo.expression.substring(f + 10, d - 1)), f = c.labelExpressionInfo.expression.indexOf("$feature[", d);
                    for (f = c.labelExpressionInfo.expression.indexOf("DomainName($feature,", f); - 1 < f;) d = c.labelExpressionInfo.expression.indexOf(")", f), a.push(c.labelExpressionInfo.expression.substring(f + 21, d - 1)), f = c.labelExpressionInfo.expression.indexOf("DomainName($feature,",
                        d);
                    var e = arcgisonline.map.popup.getPopupInfo(this.mapLayer);
                    e || (e = this.isWFS ? arcgisonline.map.popup.getDefaultPopupInfo({ name: this.mapLayer.title, fields: this.mapLayer.layer.fields }, !1, this.mapLayer.layer) : this.isFeatCol ? arcgisonline.map.featColl.generateDefaultPopupInfo(this.layer.toJson()) : arcgisonline.map.popup.getDefaultPopupInfo(this.mapLayer.serviceInfo, !1, this.layer));
                    var g = [],
                        m = !1;
                    b.forEach(a, function(a) {
                        var c = b.filter(e.fieldInfos, function(b) { return b.fieldName === a });
                        c.length && (c = c[0], c.format &&
                            (c.format.dateFormat || esri.isDefined(c.format.places) || esri.isDefined(c.format.digitSeparator)) ? (m = !0, g.push({ fieldName: a, format: c.format })) : g.push({ fieldName: a }))
                    });
                    m && (c.fieldInfos = g)
                }
                c.minScale = this.scaleSlider.minScale;
                c.maxScale = this.scaleSlider.maxScale;
                f = new esri.layers.LabelClass(c);
                this.textSymbol.font.family = this._rendererLabelsFont.get("value");
                this.textSymbol.font.size = parseInt(this._rendererLabelsFontSizes.get("value"));
                this.textSymbol.font.weight = this._rendererLabelsFontBoldButton.get("checked") ?
                    esri.symbol.Font.WEIGHT_BOLD : esri.symbol.Font.WEIGHT_NORMAL;
                this.textSymbol.font.style = this._rendererLabelsFontItalicButton.get("checked") ? esri.symbol.Font.STYLE_ITALIC : esri.symbol.Font.STYLE_NORMAL;
                this.textSymbol.font.decoration = this._rendererLabelsFontUnderlineButton.get("checked") ? "underline" : "none";
                this._rendererLabelsHaloCheck.get("checked") ? (a = b.style(this._rendererLabelsHaloColor, "backgroundColor"), this.textSymbol.setHaloColor(new b.Color(a)), this.textSymbol.setHaloSize(this._rendererLabelsHaloSizes.get("value"))) :
                    (this.textSymbol.setHaloSize(0), this.textSymbol.setHaloColor(null));
                if ("esriGeometryPoint" === this.geometryType || "esriGeometryPolyline" === this.geometryType) "esriGeometryPoint" === this.geometryType ? f.labelPlacement = this._labelPlacementLookupPoint[this._rendererLabelsAlignment.getValue()] : this._rendererLabelsAlignmentLineAbove.get("checked") ? f.labelPlacement = this._labelPlacementLookupLine["top,center"] : this._rendererLabelsAlignmentLineOn.get("checked") ? f.labelPlacement = this._labelPlacementLookupLine["middle,center"] :
                    f.labelPlacement = this._labelPlacementLookupLine["baseline,center"];
                else if ("esriGeometryPolygon" === this.geometryType || "esriGeometryMultipoint" === this.geometryType) f.labelPlacement = "esriServerPolygonPlacementAlwaysHorizontal";
                f.symbol = this.textSymbol;
                this.labelingInfo = [f];
                this.isFeatCol || this.isCSV || this.isWFS || (this.mapLayer.showLabels = !0);
                this.supportsDynLyrs ? arcgisonline.map.dynLayer.applyLabelingInfo(this.mapLayer, this.subLayerId, [f.toJson()], !0) : (this.layer.setLabelingInfo(this.labelingInfo),
                    arcgisonline.map.labels.updateLabelsForLayer(this.layer))
            },
            _onCancel: function(a) {
                a.preventDefault();
                this.supportsDynLyrs ? arcgisonline.map.dynLayer.applyLabelingInfo(this.mapLayer, this.subLayerId, this.originalLabelingInfo && this.originalShowLabels ? [this.originalLabelingInfo[0].toJson()] : null, this.originalShowLabels) : (this.originalLabelingInfo ? this.layer.setLabelingInfo(this.originalLabelingInfo) : this.layer.setLabelingInfo(null), this.originalShowLabels ? this.mapLayer.showLabels = !0 : delete this.mapLayer.showLabels,
                    this.mapLayer.showLabels || (this.isFeatCol || this.isCSV || this.isWFS) && arcgisonline.map.labels.hasLayer(this.layer) ? arcgisonline.map.labels.updateLabelsForLayer(this.layer) : arcgisonline.map.labels.removeLabelsForLayer(this.layer));
                isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
            },
            _onOK: function(a) {
                a.preventDefault();
                a = (this.originalLabelingInfo && this.originalLabelingInfo.length ? b.toJson(this.originalLabelingInfo[0].toJson()) :
                    "") === (this.labelingInfo && this.labelingInfo.length ? b.toJson(this.labelingInfo[0].toJson()) : "");
                var c = this.mapLayer.showLabels;
                this.supportsDynLyrs && (c = (c = arcgisonline.map.dynLayer.getDrawingInfoForLabels(this.mapLayer, this.subLayerId)) ? c.showLabels : null);
                if (!(this.isFeatCol || a && c === this.originalShowLabels) || this.isFeatCol && this.mapLayer.itemId && (!a || this.originalShowLabels !== arcgisonline.map.labels.hasLayer(this.layer))) this.mapLayer.rendererChanged = !0;
                arcgisonline.map.main.markMapAsChanged("labels");
                isEmbedded && isEmbedded.isItemDetail ? arcgisonline.map.leftPanel.openLeftLegendPanel() : arcgisonline.map.leftPanel.openLeftTOCPanel()
            },
            _onChangeRendererLabelsCheck: function() { this.disableAllEvents || (this._rendererLabelsCheck.get("checked") ? b.style(b.byId("rendererLabelsOptions"), "display", "") : b.style(b.byId("rendererLabelsOptions"), "display", "none"), this._onSaveLabelingInfo()) },
            _onChangeRendererLabelsText: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo()) },
            _onChangeRendererLabelsFontSize: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo()) },
            _onClickRendererLabelsFontBold: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo()) },
            _onClickRendererLabelsFontItalic: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo()) },
            _onClickRendererLabelsFontUnderline: function() {
                this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo())
            },
            _onClickRendererLabelsTextColor: function(a) { g.popup.open({ popup: this.textColorTooltip, around: a.target }) },
            _onColorSelection: function(a) {
                g.popup.close(this.textColorTooltip);
                var c = new b.Color(a);
                b.style(this._rendererLabelsTextColor, "background", a);
                this.textSymbol.color.setColor(c.toRgba());
                this._rendererLabelsCheck.set("checked", !0);
                this._onSaveLabelingInfo()
            },
            _onChangeRendererLabelsAlignment: function() {
                this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo())
            },
            _onRendererLabelsAlignmentLineChange: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), setTimeout(b.hitch(this, function() { this._onSaveLabelingInfo() }), 100)) },
            _onChangeRendererLabelsHaloCheck: function() { this.disableAllEvents || (this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo()) },
            _onChangeRendererLabelsHaloSize: function() {
                this.disableAllEvents || (this._rendererLabelsHaloCheck.set("checked", !0), this._rendererLabelsCheck.set("checked", !0), this._onSaveLabelingInfo())
            },
            _onClickRendererLabelsHaloColor: function(a) { g.popup.open({ popup: this.haloColorTooltip, around: a.target }) },
            _onHaloColorSelection: function(a) {
                g.popup.close(this.haloColorTooltip);
                b.style(this._rendererLabelsHaloColor, "background", new b.Color(a));
                this._rendererLabelsHaloCheck.set("checked", !0);
                this._rendererLabelsCheck.set("checked", !0);
                this._onSaveLabelingInfo()
            },
            _onEditExpressionClick: function() {
                this._fieldInfosStore.fetchItemByIdentity({
                    identity: "customExpr",
                    onItem: b.hitch(this,
                        function(a) {
                            this.onClickExpressionEditor({ expression: a.expression[0], title: a.expressionTitle[0] }).then(b.hitch(this, function(c) {
                                this._fieldInfosStore.setValue(a, "expression", c.expression);
                                this._fieldInfosStore.setValue(a, "expressionTitle", c.title);
                                this._fieldInfosStore.setValue(a, "label", b.string.substitute(this.i18n.customExpression, { name: c.title || this.i18n.custom }));
                                this._onSaveLabelingInfo();
                                this.updateUIWithLabelingInfo()
                            }), b.hitch(this, function() { this.updateUIWithLabelingInfo() }))
                        })
                })
            },
            onClickExpressionEditor: function(a) {
                var c =
                    new b.Deferred;
                b.byId("expressionEditorDlg") ? this.destroyExpressionEditorDlg() : b.create("div", { id: "expressionEditorDlg" }, document.body);
                this.expressionEditorCommitHandler = b.subscribe("expression-commit", b.hitch(this, function(a) {
                    var d = new esri.ArcadeExpression({ expression: a.expression, returnType: a.returnType, profile: esri.arcadeProfiles.labelingProfile });
                    esri.arcadeProfiles.labelingProfile.initialize([d]).then(b.hitch(this, function() {
                        this.destroyExpressionEditorDlg();
                        c.resolve(a)
                    }), b.hitch(this, function() {
                        this.destroyExpressionEditorDlg();
                        c.resolve(a)
                    }))
                }));
                this.expressionEditorCancelHandler = b.subscribe("expression-cancel", b.hitch(this, function() {
                    this.destroyExpressionEditorDlg();
                    c.reject()
                }));
                this.expressionEditor = new arcgisonline.map.dijit.renderer.ExpressionEditor({
                    mapLayer: this.mapLayer,
                    layer: this.layer,
                    subLayerId: this.subLayerId,
                    expression: a && a.expression,
                    expressionTitle: a && a.title,
                    defaultExpressionScript: "// " + this.i18n.defaultExpressionScript_line1 + "\n// " + this.i18n.defaultExpressionScript_line2 + '\n// $feature.name + " " + $feature.status\n\n',
                    showViewScale: !1,
                    type: "labels"
                }, "expressionEditorDlg");
                this.expressionEditor.startup();
                return c
            },
            destroyExpressionEditorDlg: function() {
                this.expressionEditorCommitHandler && this.expressionEditorCommitHandler.remove();
                this.expressionEditorCommitHandler = null;
                this.expressionEditorCancelHandler && this.expressionEditorCancelHandler.remove();
                this.expressionEditorCancelHandler = null;
                this.expressionEditor && this.expressionEditor.destroy();
                this.expressionEditor = null;
                b.byId("expressionEditorDlg") && document.body.removeChild(b.byId("expressionEditorDlg"))
            },
            _getLayerFields: function() { if (this.hasDynamic) { b.forEach(this.mapLayer.layer.dynamicLayerInfos, function(a) { a.id === this.subLayerId && (layerInfo = a) }, this); var a = this.layer.fields; return this.mapLayer.thematicGroup && this.mapLayer.thematicGroup.fieldNames && this.mapLayer.thematicGroup.fieldNames.length ? b.filter(a, function(a) { return b.some(this.mapLayer.thematicGroup.fieldNames, function(b) { return b === a.name }, this) }, this) : a } return this.layer.fields },
            _formatToken: function(a) { return a && a.length ? "{" + a + "}" : "" },
            getMarkerJson: function() {
                var a = this.markerJson;
                a.url = arcgisonline.sharing.util.getRedSphereUrl();
                return a
            },
            _checkSymbol: function(a, c) {
                if ("simplemarkersymbol" !== a.type && "simplelinesymbol" !== a.type && "simplefillsymbol" !== a.type || !a.color) return a;
                var d = a.color.toRgba();
                0 === d[3] && (!a.outline || a.outline && (0 === a.outline.width || a.outline.color && 0 === a.outline.color.toRgba()[3])) && (c ? 0 === c.color.toRgba()[3] && (!c.outline || c.outline && (0 === c.outline.width || c.outline.color && 0 === c.outline.color.toRgba()[3])) ? a.setColor(new b.Color([d[0],
                    d[1], d[2], 1
                ])) : a = c : a.setColor(new b.Color([d[0], d[1], d[2], 1])));
                return a
            },
            convertTemplatedStringToArcade: function(a) { return a ? (new esri.layers.LabelClass({ labelExpressionInfo: { value: a } })).toJson().labelExpressionInfo.expression : "" },
            adjustHeight: function(a) {
                if ("undefined" != typeof leftPanel && "rendererLabelsStack" == leftPanel.visibleStack) {
                    g.byId("rendererLabelsContentBottom").resize();
                    a = b.coords(b.byId("leftPanelDiv")).h;
                    var c = b.coords(b.byId("rendererLabelsContentHeader")).h,
                        d = b.coords(b.byId("rendererLabelsSiteFooter_links")).h +
                        9,
                        f = b.coords(b.byId("rendererLabelsContentButtonsCenter")).h;
                    b.style(b.byId("rendererLabelsContentFooter"), "height", d + "px");
                    b.style(b.byId("rendererLabelsContentButtons"), "height", f + "px");
                    b.style(b.byId("rendererLabelsContentBottom"), "height", f + d + 16 + "px");
                    b.style(b.byId("rendererLabelsContentPane"), "height", a - (c + d + f + 32) + "px");
                    a = b.coords(b.byId("leftContentStackContainer")).w;
                    c = b.coords(b.query(".firstColumnDiv", this.domNode)[0]).w;
                    25 < a - c && b.style(this.scaleSlider.domNode, "width", a - c - 25 + "px");
                    d = 0;
                    "none" !== b.style(this._rendererLabelsEditExpression, "display") && (d = 30);
                    b.style(this._rendererLabelsAttribute.domNode, "width", a - c - d - 25 + "px");
                    b.style(this._rendererLabelsFont.domNode, "width", a - c - d - 25 + "px")
                }
            }
        })
    })
}, "dijit/ColorPalette": function() {
    define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "), function(b, g, n, a, c, d, f,
        e, h, m, p) {
        var r = h("dijit.ColorPalette", [n, a, c], {
            palette: "7x10",
            _palettes: {
                "7x10": ["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "), "lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "), "silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "), "gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),
                    "dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "), "darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "), "black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")
                ],
                "3x4": [
                    ["white", "lime", "green", "blue"],
                    ["silver", "yellow", "fuchsia", "navy"],
                    ["gray", "red", "purple", "black"]
                ]
            },
            templateString: g,
            baseClass: "dijitColorPalette",
            _dyeFactory: function(a, b, c, d) {
                return new this._dyeClass(a,
                    b, c, d)
            },
            buildRendering: function() {
                this.inherited(arguments);
                this._dyeClass = h(r._Color, { palette: this.palette });
                this._preparePalette(this._palettes[this.palette], f.getLocalization("dojo", "colors", this.lang))
            }
        });
        r._Color = h("dijit._Color", e, {
            template: "\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e",
            hcTemplate: "\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
            _imagePaths: { "7x10": b.toUrl("./themes/a11y/colors7x10.png"), "3x4": b.toUrl("./themes/a11y/colors3x4.png") },
            constructor: function(a, b, c, d) {
                this._title = d;
                this._row = b;
                this._col = c;
                this.setColor(e.named[a])
            },
            getValue: function() { return this.toHex() },
            fillCell: function(a, b) {
                b = p.substitute(d("highcontrast") ? this.hcTemplate : this.template, {
                    color: this.toHex(),
                    blankGif: b,
                    alt: this._title,
                    title: this._title,
                    image: this._imagePaths[this.palette].toString(),
                    left: -20 * this._col - 5,
                    top: -20 * this._row - 5,
                    size: "7x10" == this.palette ?
                        "height: 145px; width: 206px" : "height: 64px; width: 86px"
                });
                m.place(b, a)
            }
        });
        return r
    })
}, "dijit/_PaletteMixin": function() {
    define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "), function(b, g, n, a, c, d, f, e, h, m, p) {
        return b("dijit._PaletteMixin", e, {
            defaultTimeout: 500,
            timeoutChangeRate: .9,
            value: "",
            _selectedCell: -1,
            tabIndex: "0",
            cellClass: "dijitPaletteCell",
            dyeClass: null,
            _dyeFactory: function(a) {
                return new("string" ==
                    typeof this.dyeClass ? d.getObject(this.dyeClass) : this.dyeClass)(a)
            },
            _preparePalette: function(b, e) {
                this._cells = [];
                var g = this._blankGif;
                this.own(f(this.gridNode, h, d.hitch(this, "_onCellClick")));
                for (var m = 0; m < b.length; m++)
                    for (var n = a.create("tr", { tabIndex: "-1", role: "row" }, this.gridNode), r = 0; r < b[m].length; r++) {
                        var v = b[m][r];
                        if (v) {
                            var G = this._dyeFactory(v, m, r, e[v]),
                                v = a.create("td", { "class": this.cellClass, tabIndex: "-1", title: e[v], role: "gridcell" }, n);
                            G.fillCell(v, g);
                            v.idx = this._cells.length;
                            this._cells.push({
                                node: v,
                                dye: G
                            })
                        }
                    }
                this._xDim = b[0].length;
                this._yDim = b.length;
                var F = { UP_ARROW: -this._xDim, DOWN_ARROW: this._xDim, RIGHT_ARROW: this.isLeftToRight() ? 1 : -1, LEFT_ARROW: this.isLeftToRight() ? -1 : 1 },
                    D;
                for (D in F) this.own(p.addKeyListener(this.domNode, { keyCode: c[D], ctrlKey: !1, altKey: !1, shiftKey: !1 }, this, function() { var a = F[D]; return function(b) { this._navigateByKey(a, b) } }(), this.timeoutChangeRate, this.defaultTimeout))
            },
            postCreate: function() {
                this.inherited(arguments);
                this._setCurrent(this._cells[0].node)
            },
            focus: function() { m.focus(this._currentFocus) },
            _onCellClick: function(a) {
                for (var b = a.target;
                    "TD" != b.tagName;) {
                    if (!b.parentNode || b == this.gridNode) return;
                    b = b.parentNode
                }
                var c = this._getDye(b).getValue();
                this._setCurrent(b);
                m.focus(b);
                this._setValueAttr(c, !0);
                a.stopPropagation();
                a.preventDefault()
            },
            _setCurrent: function(a) {
                "_currentFocus" in this && g.set(this._currentFocus, "tabIndex", "-1");
                (this._currentFocus = a) && g.set(a, "tabIndex", this.tabIndex)
            },
            _setValueAttr: function(a, b) {
                0 <= this._selectedCell && n.remove(this._cells[this._selectedCell].node, this.cellClass +
                    "Selected");
                this._selectedCell = -1;
                if (a)
                    for (var c = 0; c < this._cells.length; c++)
                        if (a == this._cells[c].dye.getValue()) {
                            this._selectedCell = c;
                            n.add(this._cells[c].node, this.cellClass + "Selected");
                            break
                        }
                this._set("value", 0 <= this._selectedCell ? a : null);
                if (b || void 0 === b) this.onChange(a)
            },
            onChange: function() {},
            _navigateByKey: function(a, b) {-1 != b && (a = this._currentFocus.idx + a, a < this._cells.length && -1 < a && (a = this._cells[a].node, this._setCurrent(a), this.defer(d.hitch(m, "focus", a)))) },
            _getDye: function(a) { return this._cells[a.idx].dye }
        })
    })
},
"esri/dijit/FontAlignment": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/has ../kernel dojo/_base/array dojo/query dojo/dom-class dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FontAlignment.html".split(" "), function(b, g, n, a, c, d, f, e, h, m, p, r) {
        b = g([h, m, p], {
            declaredClass: "esri.dijit.FontAlignment",
            templateString: r,
            widgetsInTemplate: !0,
            value: null,
            _imageUrl: b.toUrl("./images/positionSprite.png"),
            destroy: function() { this.inherited(arguments) },
            setValue: function(a) {
                this.value = a;
                var b = f("button", this.domNode);
                d.forEach(b, function(b) { b.value === a ? e.add(b, "selectedFontAlignment") : e.remove(b, "selectedFontAlignment") })
            },
            getValue: function() { return this.value },
            changeValue: function(a) {
                var b = f("button", this.domNode);
                d.forEach(b, function(a) { e.remove(a, "selectedFontAlignment") });
                e.add(a.currentTarget, "selectedFontAlignment");
                this.value = a.currentTarget.value;
                this.emit("change", { value: this.value })
            }
        });
        n.setObject("dijit.FontAlignment", b, c);
        return b
    })
},
"arcgisonline/map/dijit/VectorFieldRenderer": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,esri/dijit/VectorFieldRenderer"], function(b, g, n) {
        b.provide("arcgisonline.map.dijit.VectorFieldRenderer");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("esri.dijit.VectorFieldRenderer");
        b.declare("arcgisonline.map.dijit.VectorFieldRenderer", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e \r\n    \x3cdiv id\x3d"vectorFieldRendererContentHeader" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" class\x3d"panel panel_left"\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing" style\x3d"padding:0;"\x3e\r\n            \x3ca href\x3d"#" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\r\n            \x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/A\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"vectorFieldRendererContentTitle" class\x3d"esriFloatLeading" style\x3d"font-weight:bold;"\x3e\r\n            ${i18n.vectorFieldRendererDefaultTitle}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both; border-bottom: #333 thin solid; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"vectorFieldRendererContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;position:relative;" class\x3d"scrollPane"\x3e\r\n        \x3cp id\x3d"vectorFieldRendererPanelTitle" style\x3d"margin:4px 0px 10px 0px;"\x3e\r\n            ${i18n.vectorFieldRendererPanelTitle}\r\n        \x3c/p\x3e\r\n        \x3cdiv style\x3d"width:100%;" id\x3d"vectorFieldRenderer-main"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv id\x3d"vectorFieldRendererContentButtons" style\x3d"padding:5px;"\x3e\r\n      \x3ccenter\x3e \r\n        \x3cbutton dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_applyVectorFieldRenderer" class\x3d"calcite blue"\x3e\r\n            ${i18n.applyLabel}\r\n        \x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_resetVectorFieldRenderer" class\x3d"calcite light"\x3e\r\n            ${i18n.resetLabel}\r\n        \x3c/button\x3e         \r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"submit" dojoAttachPoint\x3d"_closeVectorFieldRenderer" class\x3d"calcite transparent"\x3e\r\n              ${i18n.closeLabel}\r\n        \x3c/button\x3e\r\n      \x3c/center\x3e\r\n    \x3c/div\x3e\r\n   \r\n    \x3cdiv id\x3d"vectorFieldRendererContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e \r\n      \x3cdiv class\x3d"footer" id\x3d"vectorFieldRendererSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
            i18n: null,
            mapLayer: null,
            vectorFieldRenderer: null,
            container: null,
            numCurrentLegendRequests: 0,
            intervalTimer: null,
            needsRefresh: !1,
            _eventConnections: [],
            constructor: function(a, b) { a && (a.containerNode && (this.container = a.containerNode), this.subLayerId = a.subLayerId, this.mapLayer = a.mapLayer) },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").vectorFieldRendererPanel)
            },
            postCreate: function() {
                this.container.addChild(g.byId("vectorFieldRendererPanel"));
                isEmbedded || b.style(b.byId("vectorFieldRendererContentFooter"), "display", "");
                this.loadConnections()
            },
            loadConnections: function() {
                b.connect(g.byId("leftContentPanel"), "resize", this, "adjustHeight");
                b.connect(this._closeBtn, "onclick", b.hitch(this, "_onClose", !1));
                b.connect(this._closeVectorFieldRenderer, "onClick", b.hitch(this, "_onClose", !1));
                b.connect(this._applyVectorFieldRenderer, "onClick", b.hitch(this, "_onApply"));
                b.connect(this._resetVectorFieldRenderer,
                    "onClick", b.hitch(this, "_onReset"));
                if (esri.isTouchEnabled) {
                    var a = b.query(".scrollPane", this.domNode)[0],
                        a = esri.setScrollable(a);
                    this._eventConnections.push(a[0], a[1])
                }
            },
            destroy: function() {
                this.inherited(arguments);
                b.forEach(this._eventConnections, b.disconnect)
            },
            loadContent: function() {
                this.loadVectorFieldRenderer();
                setTimeout(function() { g.byId("vectorFieldRendererPanel").adjustHeight() }, 100)
            },
            loadVectorFieldRenderer: function() {
                this.vectorFieldRenderer = new esri.dijit.VectorFieldRenderer({
                    layer: this.mapLayer.layer,
                    map: arcgisonline.map.main.map,
                    hideApplyButton: !0
                }, "vectorFieldRenderer-main");
                this._changeDialogTitle(this.mapLayer);
                this.vectorFieldRenderer.startup()
            },
            _setMapLayerAttr: function(a) {
                this.inherited(arguments);
                this.mapLayer = a;
                this._changeDialogTitle(this.mapLayer);
                this.vectorFieldRenderer && this.vectorFieldRenderer.set("layer", this.mapLayer.layer)
            },
            _onApply: function() {
                this.mapLayer.rendererChanged = !0;
                b.publish("onVectorFieldRendererApply");
                b.publish("_onRendererUpdate", [])
            },
            _onReset: function() {
                this.mapLayer.rendererChanged = !0;
                b.publish("onVectorFieldRendererReset");
                b.publish("_onRendererUpdate", [])
            },
            _updateVectorFieldRenderer: function(a) {!leftPanel || "undefined" != typeof leftPanel && "vectorFieldRendererstack" === leftPanel.visiblestack ? (this.vectorFieldRenderer && this.vectorFieldRenderer.set("layer", a), this.needsRefresh = !1) : this.needsrefresh = !0 },
            _onClose: function(a, c) {
                c.preventDefault();
                b.byId("vectorFieldRendererContentPane").scrollTop = 0;
                a && this.save();
                arcgisonline.map.leftPanel.openLeftTOCPanel()
            },
            _changeDialogTitle: function(a) {
                var c =
                    b.byId("vectorFieldRendererPanelTitle");
                c && a && a.title && (c.innerHTML = this.i18n.vectorFieldRendererPanelTitle + " " + a.title)
            },
            adjustHeight: function(a) {
                if ("undefined" != typeof leftPanel && "vectorFieldRendererStack" == leftPanel.visibleStack) {
                    a = b.coords(b.byId("leftPanelDiv")).h;
                    var c = b.coords(b.byId("vectorFieldRendererContentHeader")).h,
                        d = b.coords(b.byId("vectorFieldRendererSiteFooter_links")).h + 25,
                        f = d + b.coords(b.byId("vectorFieldRendererContentButtons")).h;
                    b.style(b.byId("vectorFieldRendererContentFooter"),
                        "height", d + "px");
                    b.style(b.byId("vectorFieldRendererContentPane"), "height", a - (c + f) + "px")
                }
            }
        })
    })
}, "esri/dijit/VectorFieldRenderer": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/i18n!../nls/jsapi dojo/text!./templates/VectorFieldRenderer.html dojo/store/Memory dojo/data/ObjectStore dojo/has dojo/query dojo/dom-style dojo/dom-construct ../kernel ../renderers/VectorFieldRenderer ../Color ../lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojox/form/HorizontalRangeSlider dojox/gfx require dijit/form/FilteringSelect dijit/form/RadioButton dijit/form/Select ./ColorPicker dijit/form/DropDownButton dijit/TitlePane dijit/form/NumberTextBox dijit/form/Button".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J) {
            d = b([B, E, G], {
                templateString: d,
                declaredClass: "esri.dijit.VectorFieldRenderer",
                widgetsInTemplate: !0,
                layer: null,
                map: null,
                _rendererTypes: "simpleScalar singleArrow windBarbs beaufort oceanCurrentKnots oceanCurrentMps classifiedArrow".split(" "),
                _rendererTypeData: [],
                _vfrObject: null,
                _defaultVFRName: "classifiedArrow",
                propertiesChanged: !0,
                resetAvailable: !0,
                constructor: function(a) {
                    b.safeMixin(this, a);
                    this._i18n = c;
                    this._setupDefaults()
                },
                startup: function(a) {
                    this.inherited(arguments);
                    var b = this;
                    this._arrowSymbolButtonNode = m(".dijitButtonNode", m(".esriVFRColorButton")[0])[0];
                    this.symbolColorPicker.onColorChange = function(a) {
                        b._updateArrowSymbolButton();
                        b.propertiesChanged = !0
                    };
                    n.subscribe("onVectorFieldRendererApply", g.hitch(this, "_onClickApplyVectorFieldRenderer"));
                    n.subscribe("onVectorFieldRendererReset", g.hitch(this, "_onClickResetVectorFieldRenderer"));
                    this.startupCalled = !0
                },
                postCreate: function(a) {
                    this.inherited(arguments);
                    var b = this;
                    this.advancedSettingsPane.set("title", this._i18n.widgets.vectorFieldRenderer.advancedOptionsTitle);
                    this.minMagnitudeInput.set("invalidMessage", this._i18n.widgets.vectorFieldRenderer.invalidNumberMessage);
                    this.maxMagnitudeInput.set("invalidMessage", this._i18n.widgets.vectorFieldRenderer.invalidNumberMessage);
                    p.set(this.symbolColorPicker.dap_transparencySection, "display", "none");
                    this._popuplateRendererList();
                    this._createTileSizeSlider();
                    this._createSymbolSizeSlider();
                    this.hideApplyButton && p.set(this.applyButton.domNode, "display", "none");
                    if (this.layer.loaded) this._loadVFRArguments();
                    else this.layer.on("load",
                        function() { b._loadVFRArguments() })
                },
                _setLayerAttr: function(a) {
                    if (a && this.startupCalled) {
                        var b = this;
                        this.layer = a;
                        this.inherited(arguments);
                        this.advancedSettingsPane.set("open", !1);
                        if (this.layer.loaded) this._loadVFRArguments();
                        else this.layer.on("load", function() { b._loadVFRArguments() })
                    }
                },
                _addRendererTypeToList: function(a, b, c, d) {
                    var e = {};
                    e.label = "\x3chtml\x3e\x3cbody\x3e\x3csection\x3e\x3ctable\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cb\x3e" + a + "\x3cb\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cimg src\x3d'" +
                        d + "' height\x3d'90' width\x3d'90'\x3e\x3c/td\x3e\x3ctd\x3e\x3cp style\x3d'white-space:pre-wrap;width:35ex;'\x3e\x3ci\x3e" + b + "\x3c/i\x3e\x3c/p\x3e\x3ctd\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/section\x3e\x3c/body\x3e\x3c/html\x3e";
                    e.name = a;
                    e.desc = b;
                    e.id = c;
                    this._rendererTypeData.push(e)
                },
                _popuplateRendererList: function() {
                    var b = this;
                    a.forEach(this._rendererTypes, function(a) {
                        var c = b._i18n.widgets.vectorFieldRenderer[a + "LabelTitle"],
                            d = b._i18n.widgets.vectorFieldRenderer[a + "Desc"],
                            e = J.toUrl("./images/vfr_" + a +
                                ".png");
                        b._addRendererTypeToList(c, d, a, e)
                    });
                    this._rendererTypeStore = new f({ data: this._rendererTypeData });
                    this.rendererTypeSelect.set("store", this._rendererTypeStore);
                    this.rendererTypeSelect.set("labelAttr", "label");
                    this.rendererTypeSelect.set("labelType", "html")
                },
                _createTileSizeSlider: function() {
                    var a = this,
                        b = [],
                        c, d = r.create("div");
                    this.symbolDensitySliderDiv.appendChild(d);
                    for (c = 0; 80 > c; c++) 0 === c ? b.push(this._i18n.widgets.vectorFieldRenderer.sparseTileSizeAlias) : 79 === c ? b.push(this._i18n.widgets.vectorFieldRenderer.denseTileSizeAlias) :
                        b.push("");
                    new D({ labels: b, labelStyle: "font-size: 75%" }, d);
                    this._symbolDensitySlider = new F({ value: .02, minimum: .01, maximum: .05, intermediateChanges: !1, discreteValues: 81, style: "width: 100%", onChange: function(b) { a._setPropertiesChanged() } }, this.symbolDensitySliderDiv)
                },
                _createSymbolSizeSlider: function() {
                    var a = this,
                        b = [],
                        c, d = r.create("div");
                    this.symbolSizeSliderDiv.appendChild(d);
                    for (c = 0; 100 > c; c++) 0 === c ? b.push(this._i18n.widgets.vectorFieldRenderer.minSymbolSizeAlias) : 99 === c ? b.push(this._i18n.widgets.vectorFieldRenderer.maxSymbolSizeAlias) :
                        b.push("");
                    new D({ labels: b, labelStyle: "font-size: 75%" }, d);
                    this._symbolSizeSlider = new A({ value: [20, 80], minimum: 0, maximum: 100, discreteValues: 101, intermediateChanges: !1, style: "width: 100%", onChange: function(b) { a._setPropertiesChanged() } }, this.symbolSizeSliderDiv)
                },
                _selectRendererStyle: function(a) {
                    "singleArrow" === a ? this._showColorPickerButton() : this._hideColorPickerButton();
                    this._refreshOutputUnitSelect();
                    this.layer.getFlowRepresentation() || ("beaufort" === a || "windBarbs" === a ? this.flowAngleSelect.set("value",
                        "FLOW_FROM") : "oceanCurrent" === a && this.flowAngleSelect.set("value", "FLOW_TO"));
                    this.propertiesChanged = !0
                },
                _showColorPickerButton: function() {
                    var a = this.singleArrowDefaultColor;
                    this.layer.renderer && this.layer.renderer.renderer && this.layer.renderer.renderer.defaultSymbol && this.layer.rendererStyle == w.STYLE_SINGLE_ARROW && this.layer.renderer.renderer.defaultSymbol.color;
                    this.symbolColorPicker.set("color", a);
                    p.set(this.colorPickerButton.domNode, "display", "block")
                },
                _hideColorPickerButton: function() {
                    p.set(this.colorPickerButton.domNode,
                        "display", "none")
                },
                _setupDefaults: function() { this.singleArrowDefaultColor = new t([0, 92, 230]) },
                _loadVFRArguments: function() {
                    if (!this.layer || !this.layer.renderer) return 0;
                    this._loadVFRStyle();
                    this._loadSymbolSizeValues();
                    this._loadTileSizeValue();
                    this._loadMinMaxValues();
                    this._loadAngleDirection();
                    this._loadColor();
                    this._loadUnits()
                },
                _loadVFRStyle: function() {
                    switch (this.layer.renderer.style) {
                        case w.STYLE_SCALAR:
                            this.rendererTypeSelect.set("value", this._rendererTypes[0]);
                            break;
                        case w.STYLE_SINGLE_ARROW:
                            this.rendererTypeSelect.set("value",
                                this._rendererTypes[1]);
                            this._loadColor();
                            break;
                        case w.STYLE_BEAUFORT_KN:
                        case w.STYLE_BEAUFORT_METER:
                        case w.STYLE_BEAUFORT_MILE:
                        case w.STYLE_BEAUFORT_FEET:
                        case w.STYLE_BEAUFORT_KM:
                            this.rendererTypeSelect.set("value", this._rendererTypes[3]);
                            break;
                        case w.STYLE_OCEAN_CURRENT_M:
                            this.rendererTypeSelect.set("value", this._rendererTypes[5]);
                            break;
                        case w.STYLE_OCEAN_CURRENT_KN:
                            this.rendererTypeSelect.set("value", this._rendererTypes[4]);
                            break;
                        case w.STYLE_CLASSIFIED_ARROW:
                            this.rendererTypeSelect.set("value",
                                this._rendererTypes[6]);
                            break;
                        case w.STYLE_WIND_BARBS:
                            this.rendererTypeSelect.set("value", this._rendererTypes[2]);
                            break;
                        default:
                            this.rendererTypeSelect.set("value", this._rendererTypes[1])
                    }
                },
                _loadSymbolSizeValues: function() {
                    var b = 20,
                        c = 80,
                        d;
                    a.forEach(this.layer.renderer.visualVariables, function(a) { "sizeInfo" === a.type && (d = a) });
                    d && d.minSize && d.maxSize && this.layer.graphics.length && (b = d.minSize / this.layer.symbolTileSize * 100, c = d.maxSize / this.layer.symbolTileSize * 100);
                    this._symbolSizeSlider.set("value", [b,
                        c
                    ])
                },
                _loadTileSizeValue: function() { this._symbolDensitySlider.set("value", this.layer.symbolTileSize ? 1 / this.layer.symbolTileSize : .02) },
                _loadMinMaxValues: function() {
                    var b;
                    a.forEach(this.layer.renderer.visualVariables, function(a) { "sizeInfo" === a.type && (b = a) });
                    this.minMagnitudeInput.set("value", b && x.isDefined(b.minDataValue) ? b.minDataValue : "");
                    this.maxMagnitudeInput.set("value", b && x.isDefined(b.maxDataValue) ? b.maxDataValue : "")
                },
                _loadAngleDirection: function() {
                    var a = this.layer.getFlowRepresentation(),
                        b = "FLOW_FROM",
                        b = a ? a == w.FLOW_TO ? "FLOW_TO" : "FLOW_FROM" : this.layer.renderer.flowRepresentation == w.FLOW_TO ? "FLOW_TO" : "FLOW_FROM";
                    this.flowAngleSelect.set("value", b)
                },
                _loadColor: function() { this.layer.renderer && this.layer.renderer.renderer && this.layer.renderer.renderer.defaultSymbol && this.startupCalled && (this.symbolColorPicker.set("color", this.layer.renderer.renderer.defaultSymbol.color), this._updateArrowSymbolButton()) },
                _loadUnits: function() {
                    this.layer.vectorFieldPixelFilter && (this.layer.vectorFieldPixelFilter.inputUnit ?
                        this.inputDataUnitSelect.set("value", this.layer.vectorFieldPixelFilter.inputUnit) : this.inputDataUnitSelect.set("value", "NO_UNIT"), this.layer.vectorFieldPixelFilter.outputUnit && this.outputDataUnitSelect.set("value", this.layer.vectorFieldPixelFilter.outputUnit))
                },
                _onOutputUnitChange: function(a) {
                    this.dataValueRangeUnit.innerHTML = a && "NO_UNIT" != a ? " in \x3cstrong\x3e" + this._i18n.widgets.vectorFieldRenderer[a] + "\x3c/strong\x3e." : ".";
                    this.propertiesChanged = !0
                },
                _onClickApplyVectorFieldRenderer: function() {
                    if (this.propertiesChanged) {
                        var a =
                            w.STYLE_SINGLE_ARROW,
                            b, c, d, e, f, g, h;
                        d = Math.floor(1 / this._symbolDensitySlider.value);
                        b = H.px2pt(this._symbolSizeSlider.value[0] / 100 * d);
                        c = H.px2pt(this._symbolSizeSlider.value[1] / 100 * d);
                        e = isNaN(this.minMagnitudeInput.value) ? null : this.minMagnitudeInput.value;
                        f = isNaN(this.maxMagnitudeInput.value) ? null : this.maxMagnitudeInput.value;
                        g = w[this.flowAngleSelect.value];
                        "singleArrow" == this.rendererTypeSelect.value ? a = w.STYLE_SINGLE_ARROW : "simpleScalar" == this.rendererTypeSelect.value ? a = w.STYLE_SCALAR : "beaufort" == this.rendererTypeSelect.value ?
                            "esriKnots" == this.outputDataUnitSelect.value ? a = w.STYLE_BEAUFORT_KN : "esriMetersPerSecond" == this.outputDataUnitSelect.value ? a = w.STYLE_BEAUFORT_METER : "esriMilesPerHour" == this.outputDataUnitSelect.value ? a = w.STYLE_BEAUFORT_MILE : "esriKilometersPerHour" == this.outputDataUnitSelect.value && (a = w.STYLE_BEAUFORT_KM) : "oceanCurrentKnots" == this.rendererTypeSelect ? a = w.STYLE_OCEAN_CURRENT_KN : "oceanCurrentMps" == this.rendererTypeSelect ? a = w.STYLE_OCEAN_CURRENT_M : "classifiedArrow" == this.rendererTypeSelect ? a = w.STYLE_CLASSIFIED_ARROW :
                            "windBarbs" == this.rendererTypeSelect && (a = w.STYLE_WIND_BARBS);
                        this.symbolColorPicker && this.symbolColorPicker.color && (h = this.layer.renderer._getDefaultSymbol(new t(this.symbolColorPicker.color)));
                        var m = "NO_UNIT" !== this.inputDataUnitSelect.value ? this.inputDataUnitSelect.value : "",
                            n = "NO_UNIT" !== this.outputDataUnitSelect.value ? this.outputDataUnitSelect.value : "";
                        this.layer.vectorFieldPixelFilter.setUnits(m, n);
                        this.layer.rendererStyle = a;
                        var p = [];
                        p.push({
                            type: "sizeInfo",
                            minSize: b,
                            maxSize: c,
                            minDataValue: e,
                            maxDataValue: f
                        });
                        a = new w({ style: a, visualVariables: p, flowRepresentation: g, singleArrowSymbol: h || null, outputUnit: n, inputUnit: m });
                        this.layer.setRenderer(a);
                        this.layer.symbolTileSize !== d ? (this.layer.symbolTileSize = d, this.layer.refresh()) : this.layer.redraw();
                        this._loadVFRStyle();
                        this.propertiesChanged = !1;
                        this.resetAvailable = !0
                    }
                },
                _onClickResetVectorFieldRenderer: function() {
                    if (this.layer && (this.propertiesChanged || this.resetAvailable)) {
                        var a = this;
                        this.layer.symbolTileSize = 50;
                        this.layer.setVectorRendererStyle(w.STYLE_SINGLE_ARROW);
                        var b = Math.floor(1 / this._symbolDensitySlider.value);
                        this.layer.vectorFieldPixelFilter && this.layer.vectorFieldPixelFilter.setUnits(null, null);
                        this.layer.symbolTileSize !== b ? this.layer.refresh() : this.layer.redraw();
                        this._loadVFRArguments();
                        this.resetAvailable = this.propertiesChanged = !1;
                        setTimeout(function() { a.propertiesChanged = !1 }, 500)
                    }
                },
                _updateArrowSymbolButton: function(a) {
                    this._arrowSymbolButtonNode.innerHTML = "";
                    var b = H.createSurface(this._arrowSymbolButtonNode, 24, 24);
                    a = b.createShape({ type: "path", path: "M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z" }).setFill(a ?
                        a : this.symbolColorPicker.color);
                    b.getDimensions();
                    var c = { dx: 0, dy: 0 },
                        d = a.getBoundingBox(),
                        e = d.width,
                        d = d.height;
                    if (24 > e || 24 > d) e = (e + 5) / 24, g.mixin(c, { xx: e, yy: e });
                    a.applyTransform(c);
                    return b
                },
                _onInputUnitChange: function(a) {
                    "NO_UNIT" != a || "beaufort" == this.rendererTypeSelect.value || "oceanCurrent" == this.rendererTypeSelect.value ? this.outputDataUnitSelect.set("disabled", !1) : (this.outputDataUnitSelect.set("value", "NO_UNIT"), this.outputDataUnitSelect.set("disabled", !0));
                    this.propertiesChanged = !0
                },
                _refreshOutputUnitSelect: function() {
                    this._outputUnits = [];
                    "oceanCurrentMps" != this.rendererTypeSelect.value && this._outputUnits.push({ id: "esriKnots", label: this._i18n.widgets.vectorFieldRenderer.esriKnots });
                    "oceanCurrentKnots" != this.rendererTypeSelect.value && "windBarbs" != this.rendererTypeSelect.value && (this._outputUnits.push({ id: "esriMetersPerSecond", label: this._i18n.widgets.vectorFieldRenderer.esriMetersPerSecond }), "oceanCurrentMps" != this.rendererTypeSelect.value && (this._outputUnits.push({ id: "esriKilometersPerHour", label: this._i18n.widgets.vectorFieldRenderer.esriKilometersPerHour }),
                        this._outputUnits.push({ id: "esriMilesPerHour", label: this._i18n.widgets.vectorFieldRenderer.esriMilesPerHour }), "beaufort" != this.rendererTypeSelect.value && (this._outputUnits.push({ id: "esriFeetPerSecond", label: this._i18n.widgets.vectorFieldRenderer.esriFeetPerSecond }), this._outputUnits.push({ id: "NO_UNIT", label: " ", selected: !0 }))));
                    var a = new f({ data: this._outputUnits }),
                        a = new e({ objectStore: a });
                    this.outputDataUnitSelect.set("store", a);
                    this.layer && this.layer.vectorFieldPixelFilter && this.layer.vectorFieldPixelFilter.outputUnit ?
                        this.outputDataUnitSelect.set("value", this.layer.vectorFieldPixelFilter.outputUnit) : "oceanCurrentKnots" === this.rendererTypeSelect.value || "beaufort" === this.rendererTypeSelect.value ? this.outputDataUnitSelect.set("value", "esriKnots") : "oceanCurrentMps" === this.rendererTypeSelect.value && this.outputDataUnitSelect.set("value", "esriMetersPerSecond")
                },
                _setPropertiesChanged: function() { this.propertiesChanged = !0 }
            });
            g.setObject("dijit.VectorFieldRenderer", d, v);
            return d
        })
}, "dijit/TitlePane": function() {
    define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/fx dojo/has dojo/_base/kernel dojo/keys ./_CssStateMixin ./_TemplatedMixin ./layout/ContentPane dojo/text!./templates/TitlePane.html ./_base/manager ./a11yclick".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t) {
            g = g("dijit.TitlePane", [v, r, p], {
                title: "",
                _setTitleAttr: { node: "titleNode", type: "innerHTML" },
                open: !0,
                toggleable: !0,
                tabIndex: "0",
                duration: t.defaultDuration,
                baseClass: "dijitTitlePane",
                templateString: w,
                doLayout: !1,
                _setTooltipAttr: { node: "focusNode", type: "attribute", attribute: "title" },
                buildRendering: function() {
                    this.inherited(arguments);
                    n.setSelectable(this.titleNode, !1)
                },
                postCreate: function() {
                    this.inherited(arguments);
                    this.toggleable && this._trackMouseState(this.titleBarNode,
                        this.baseClass + "Title");
                    var a = this.hideNode,
                        b = this.wipeNode;
                    this._wipeIn = f.wipeIn({ node: b, duration: this.duration, beforeBegin: function() { a.style.display = "" } });
                    this._wipeOut = f.wipeOut({ node: b, duration: this.duration, onEnd: function() { a.style.display = "none" } })
                },
                _setOpenAttr: function(a, c) {
                    b.forEach([this._wipeIn, this._wipeOut], function(a) { a && "playing" == a.status() && a.stop() });
                    c ? this[a ? "_wipeIn" : "_wipeOut"].play() : this.hideNode.style.display = this.wipeNode.style.display = a ? "" : "none";
                    if (this._started)
                        if (a) this._onShow();
                        else this.onHide();
                    this.containerNode.setAttribute("aria-hidden", a ? "false" : "true");
                    this.focusNode.setAttribute("aria-pressed", a ? "true" : "false");
                    this._set("open", a);
                    this._setCss()
                },
                _setToggleableAttr: function(b) {
                    this.focusNode.setAttribute("role", b ? "button" : "heading");
                    b ? (this.focusNode.setAttribute("aria-controls", this.id + "_pane"), this.focusNode.setAttribute("tabIndex", this.tabIndex), this.focusNode.setAttribute("aria-pressed", this.open)) : (a.remove(this.focusNode, "aria-controls"), a.remove(this.focusNode,
                        "tabIndex"), a.remove(this.focusNode, "aria-pressed"));
                    this._set("toggleable", b);
                    this._setCss()
                },
                _setContentAttr: function(a) { this.open && this._wipeOut && "playing" != this._wipeOut.status() ? (this._wipeIn && "playing" == this._wipeIn.status() && this._wipeIn.stop(), d.setMarginBox(this.wipeNode, { h: d.getMarginBox(this.wipeNode).h }), this.inherited(arguments), this._wipeIn ? this._wipeIn.play() : this.hideNode.style.display = "") : this.inherited(arguments) },
                toggle: function() { this._setOpenAttr(!this.open, !0) },
                _setCss: function() {
                    var a =
                        this.titleBarNode || this.focusNode,
                        b = this._titleBarClass;
                    this._titleBarClass = this.baseClass + "Title" + (this.toggleable ? "" : "Fixed") + (this.open ? "Open" : "Closed");
                    c.replace(a, this._titleBarClass, b || "");
                    c.replace(a, this._titleBarClass.replace("TitlePaneTitle", ""), (b || "").replace("TitlePaneTitle", ""));
                    this.arrowNodeInner.innerHTML = this.open ? "-" : "+"
                },
                _onTitleKey: function(a) { a.keyCode == m.DOWN_ARROW && this.open && (this.containerNode.focus(), a.preventDefault()) },
                _onTitleClick: function() { this.toggleable && this.toggle() },
                setTitle: function(a) {
                    h.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.", "", "2.0");
                    this.set("title", a)
                }
            });
            e("dojo-bidi") && g.extend({
                _setTitleAttr: function(a) {
                    this._set("title", a);
                    this.titleNode.innerHTML = a;
                    this.applyTextDir(this.titleNode)
                },
                _setTooltipAttr: function(b) {
                    this._set("tooltip", b);
                    this.textDir && (b = this.enforceTextDirWithUcc(null, b));
                    a.set(this.focusNode, "title", b)
                },
                _setTextDirAttr: function(a) {
                    this._created && this.textDir != a && (this._set("textDir", a), this.set("title",
                        this.title), this.set("tooltip", this.tooltip))
                }
            });
            return g
        })
}, "arcgisonline/sharing/utilShare": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/ShareCheckDlg,arcgisonline/sharing/dijit/dialog/ConfirmDialog,dojo/json,dojo/string"], function(b, g, n) {
        b.provide("arcgisonline.sharing.utilShare");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.require("arcgisonline.sharing.dijit.dialog.ShareCheckDlg");
        b.require("arcgisonline.sharing.dijit.dialog.ConfirmDialog");
        b.require("dojo.json");
        b.require("dojo.string");
        arcgisonline.sharing.utilShare = {
            itemCards: [],
            ownerGroups: [],
            waitHandler: null,
            i18n: b.i18n.getLocalization("arcgisonline", "arcgisonline"),
            _isEmpty: function(a) { return a ? b.json.stringify(a) === b.json.stringify({}) : !1 },
            checkWebMapContent: function(a) {
                var c = function(a) {
                    var b = {};
                    b.webMapId = a.webMapId;
                    b.mainItemCard = a.webMapItemCard;
                    delete b.mainItemCard.needsUpdate;
                    b.mainItemSharing = a.webMapItemSharing;
                    b.mainConfig = a.webMapConfig;
                    b.itemCards = a.itemCards || {};
                    for (var c in b.itemCards) delete b.itemCards[c].needsUpdate;
                    b.itemsSharing = {};
                    b.newAccess = a.newAccess;
                    b.needUpdateHandler = a.needUpdateHandler;
                    b.dontNeedUpdateHandler = a.dontNeedUpdateHandler;
                    b.confirmItemControl = a.confirmItemControl;
                    arcgisonline.sharing.utilShare.getMainItemCard(b)
                };
                a.useTimer ? (arcgisonline.sharing.utilShare.waitHandler && clearTimeout(arcgisonline.sharing.utilShare.waitHandler), arcgisonline.sharing.utilShare.waitHandler = setTimeout(b.hitch(this, function() {
                    arcgisonline.sharing.utilShare.waitHandler =
                        null;
                    c(a)
                }), 2E3)) : c(a)
            },
            checkWebAppContent: function(a) {
                var b = {};
                b.webAppId = a.webAppId;
                b.mainItemCard = a.webAppItemCard;
                b.mainItemSharing = a.webAppItemSharing;
                b.mainConfig = a.webAppConfig;
                b.itemCards = a.itemCards || {};
                b.itemsSharing = {};
                arcgisonline.sharing.utilShare.getMainItemCard(b)
            },
            getMainItemCard: function(a) {
                var c = function(a) {
                    a.newAccess ? (a.mainItemSharing = a.newAccess, arcgisonline.sharing.utilShare.getMainConfig(a)) : "private" !== a.mainItemCard.access && ("shared" === a.mainItemCard.access ? arcgisonline.sharing.utilShare.getMainSharingInfo(a) :
                        arcgisonline.sharing.utilShare.getMainConfig(a))
                };
                a.mainItemCard ? c(a) : arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl + "content/items/" + (a.webMapId || a.webAppId)).then(b.hitch(this, function(a, b) {
                    a.mainItemCard = b;
                    c(a);
                    return !0
                }, a), b.hitch(this, function(a) { return a }))
            },
            getMainSharingInfo: function(a) {
                if (a.mainItemSharing) arcgisonline.sharing.utilShare.getMainConfig(a);
                else {
                    var c = arcgisonline.sharing.util.getUser(),
                        c = esriGeowConfig.restBaseUrl + "content/users/" + c.email;
                    a.mainItemCard.ownerFolder &&
                        (c += "/" + a.mainItemCard.ownerFolder);
                    var c = c + ("/items/" + (a.webMapId || a.webAppId)),
                        d = arcgisonline.sharing.util.getToken();
                    esri.request({
                        url: c + (d ? "?f\x3djson\x26token\x3d" + d : "?f\x3djson"),
                        callbackParamName: "callback",
                        load: b.hitch(this, function(a, b) {
                            a.mainItemSharing = b.sharing;
                            arcgisonline.sharing.utilShare.getMainConfig(a)
                        }, a),
                        error: b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.getMainConfig(a) }, a)
                    }, { disableIdentityLookup: !0 })
                }
            },
            getMainConfig: function(a) {
                if (a.mainConfig) a.webMapId ? arcgisonline.sharing.utilShare.readWebMapConfig(a) :
                    arcgisonline.sharing.utilShare.readWebAppConfig(a);
                else return arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl + "content/items/" + (a.webMapId || a.webAppId) + "/data", b.hitch(this, function(a, b, f) {
                    a.mainConfig = b;
                    a.webMapId ? arcgisonline.sharing.utilShare.readWebMapConfig(a) : arcgisonline.sharing.utilShare.readWebAppConfig(a)
                }, a), b.hitch(this, function(a, b) {}))
            },
            checkForItemSharing: function(a) {
                if (a.newAccess && "shared" !== a.newAccess.access || !a.newAccess && "shared" !== a.mainItemCard.access) arcgisonline.sharing.utilShare.checkAccessOfItems(a);
                else {
                    var c = [],
                        d;
                    for (d in a.itemCards) { var f = a.itemCards[d]; "shared" !== f.access && "org" !== f.access || !f.ownerFolder && null !== f.ownerFolder || c.push(arcgisonline.sharing.utilShare.getItemSharingInfo(f)) }
                    c.length ? (new b.DeferredList(c)).addCallback(b.hitch(this, function(a, c) {
                        b.forEach(c, function(b) {
                            b = b[1];
                            a.itemsSharing[b.item.id] = b.sharing
                        }, this);
                        arcgisonline.sharing.utilShare.checkAccessOfItems(a)
                    }, a)) : arcgisonline.sharing.utilShare.checkAccessOfItems(a)
                }
            },
            checkAccessOfItems: function(a) {
                var c = arcgisonline.sharing.util.getUser(),
                    d = a.newAccess ? a.newAccess.access : a.mainItemCard.access,
                    f = [],
                    e;
                for (e in a.itemCards) { var g = a.itemCards[e]; "shared" === d && "public" !== g.access && a.mainItemSharing && void 0 !== g.ownerFolder && c.email !== g.owner && f.push(arcgisonline.sharing.utilShare.getOwnerGroups(g, a)) }
                f.length ? (new b.DeferredList(f)).addCallback(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare._checkAccessOfItems(a) }, a)) : arcgisonline.sharing.utilShare._checkAccessOfItems(a)
            },
            _checkAccessOfItems: function(a) {
                var c = !1,
                    d = a.newAccess ?
                    a.newAccess.access : a.mainItemCard.access,
                    f = [],
                    e;
                for (e in a.itemCards) {
                    var g = a.itemCards[e],
                        m = g.access,
                        n = !1;
                    a.containsPremiumContent = this._isPremiumContent(g);
                    if ("public" === d && "public" !== m) n = !0;
                    else if ("org" === d && "public" !== m && "org" !== m) n = !0;
                    else if ("shared" === d && "private" === m) n = !0;
                    else if ("shared" !== d || "shared" !== m && "org" !== m) a.itemCards[e].needsUpdate = !1;
                    else if (a.mainItemSharing)
                        if (a.itemsSharing[e] && void 0 !== g.ownerFolder) {
                            for (var m = a.mainItemSharing.groups, r = a.itemsSharing[e].groups, v = !1, w = 0; w <
                                m.length; w++)
                                if (-1 === b.indexOf(r, m[w])) { v = n = !0; break }
                            v || delete a.itemCards[e]
                        } else n = !0;
                    else n = !0;
                    (n && a.webAppId || "Web Map" === g.type || "Web Scene" === g.type) && f.push(arcgisonline.sharing.utilShare.checkWebMapInWebApp(g.id, a));
                    c = c || n
                }
                var t = function(a, b) {
                    var c = b.newAccess ? b.newAccess.access : b.mainItemCard.access;
                    a ? b.needUpdateHandler ? b.needUpdateHandler(b) : arcgisonline.sharing.dijit.dialog.ShareCheckDlg.prototype.statics.getInstance().show(b) : "public" === c && "Web Map" === b.mainItemCard.type && b.containsPremiumContent ?
                        this._showPremiumContentDlg(b) : b.dontNeedUpdateHandler && b.dontNeedUpdateHandler(b)
                }.bind(this);
                f.length ? (new b.DeferredList(f)).addCallback(b.hitch(this, function(d) {
                    b.forEach(d, function(a) { 1 < a.length && esri.isDefined(a[1]) && (c = c || a[1]) }, this);
                    t(c, a)
                })) : this._isEmpty(a.itemCards) ? a.dontNeedUpdateHandler && a.dontNeedUpdateHandler(a) : t(c, a)
            },
            _isPremiumContent: function(a) { a = a.typeKeywords || []; return -1 < a.indexOf("Requires Subscription") || -1 < a.indexOf("Requires Credits") },
            _showPremiumContentDlg: function(a) {
                -1 <
                    document.location.href.indexOf("viewer.html") || (a = esriGeowConfig.helpBase + esriGeowConfig.helpMap["120001307"], this._premiumContentDlg || (this._premiumContentDlg = new arcgisonline.sharing.dijit.dialog.ConfirmDialog({ showCancel: !1, buttonOk: this.i18n.common.ok, style: { width: "200px" } }), this._premiumContentDlg.show({
                        message: b.string.substitute('${i18n.shareMapDlg.premiumLayerMsg} \x3ca href\x3d"${helpLinkPremium}" target\x3d"_blank"\x3e${i18n.shareMapDlg.premiumLayerMsgLearnMore}\x3c/a\x3e', {
                            i18n: this.i18n,
                            helpLinkPremium: a
                        }),
                        title: this.i18n.common.premiumcontent
                    }).then(function(a) {
                        this._premiumContentDlg.hide();
                        this._premiumContentDlg = null
                    }.bind(this))))
            },
            readWebMapConfig: function(a) {
                var c = !1,
                    d = [],
                    f = a.mainConfig.operationalLayers;
                a.mainConfig.tables && a.mainConfig.tables.length && (f = f.concat(a.mainConfig.tables));
                for (var e = f.length - 1; 0 <= e; e--) {
                    var g = f[e];
                    if (g.itemId) c = !0, a.itemCards[g.itemId] || d.push(arcgisonline.sharing.utilShare.getItemCard(g.itemId)), ("ArcGISTiledMapServiceLayer" === g.layerType || "ArcGISTiledElevationServiceLayer" ===
                        g.layerType || "ArcGISSceneServiceLayer" === g.layerType) && g.layers && g.layers.length && b.forEach(g.layers, b.hitch(this, function(b) { b.layerItemId && !a.itemCards[b.layerItemId] && d.push(arcgisonline.sharing.utilShare.getItemCard(b.layerItemId)) }));
                    else if ("GroupLayer" === g.layerType)
                        for (var m = f[e], n = m.layers.length - 1; 0 <= n; n--) g = m.layers[n], g.itemId && (c = !0, a.itemCards[g.itemId] || d.push(arcgisonline.sharing.utilShare.getItemCard(g.itemId)));
                    g.layers && b.forEach(g.layers, function(b) {
                        b.layerItemId && !a.itemCards[b.layerItemId] &&
                            d.push(arcgisonline.sharing.utilShare.getItemCard(b.layerItemId))
                    })
                }
                for (e = a.mainConfig.baseMap.baseMapLayers.length - 1; 0 <= e; e--) f = a.mainConfig.baseMap.baseMapLayers[e], f.itemId && (c = !0, a.itemCards[f.itemId] || d.push(arcgisonline.sharing.utilShare.getItemCard(f.itemId)));
                if (a.mainConfig.baseMap.elevationLayers)
                    for (e = a.mainConfig.baseMap.elevationLayers.length - 1; 0 <= e; e--) f = a.mainConfig.baseMap.elevationLayers[e], f.itemId && (c = !0, a.itemCards[f.itemId] || d.push(arcgisonline.sharing.utilShare.getItemCard(f.itemId)));
                d.length ? (c = new b.DeferredList(d), c.addCallback(b.hitch(this, function(a, c) {
                    b.forEach(c, function(b) {
                        b = b[1];
                        b.id && (a.itemCards[b.id] = b)
                    }, this);
                    var d = [],
                        e = [];
                    b.forEach(c, function(c) { c = c[1];!c.id || "Map Service" != c.type && "Scene Service" !== c.type || !b.indexOf(c.typeKeywords, "Hosted Service") || a.itemCards[g.itemId].data || (d.push(arcgisonline.sharing.utilShare.getItemData(c.id)), e.push(c.id)) }, this);
                    d.length ? (c = new b.DeferredList(d), c.addCallback(b.hitch(this, function(a, c) {
                        b.forEach(c, function(c, d) {
                                d = a.itemCards[e[d]];
                                d.data = c[1];
                                var f = [];
                                d.data.layers && b.forEach(d.data.layers, function(b) { b.layerItemId && (a.itemCards[b.layerItemId] || f.push(arcgisonline.sharing.utilShare.getItemCard(b.layerItemId))) });
                                f.length ? (c = new b.DeferredList(f), c.addCallback(b.hitch(this, function(a, c) {
                                    b.forEach(c, function(b) {
                                        b = b[1];
                                        b.id && (a.itemCards[b.id] = b)
                                    }, this);
                                    arcgisonline.sharing.utilShare.checkForItemSharing(a)
                                }, a)), c.addErrback(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.checkForItemSharing(a) }, a))) : arcgisonline.sharing.utilShare.checkForItemSharing(a)
                            },
                            this)
                    }, a)), c.addErrback(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.checkForItemSharing(a) }, a))) : arcgisonline.sharing.utilShare.checkForItemSharing(a)
                }, a)), c.addErrback(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.checkForItemSharing(a) }, a))) : c ? arcgisonline.sharing.utilShare.checkForItemSharing(a) : a.dontNeedUpdateHandler && a.dontNeedUpdateHandler(a)
            },
            readWebAppConfig: function(a) {
                if (a.mainConfig.values && a.mainConfig.values.webmap || a.mainConfig.map && a.mainConfig.map.itemId ||
                    a.mainConfig.values && a.mainConfig.values.webscene) {
                    var c = [];
                    a.mainConfig && (a.mainConfig.values ? a.mainConfig.values.webscene ? c = a.mainConfig.values.webscene.split(",") : a.mainConfig.values.webmap && (c = a.mainConfig.values.webmap.split(",")) : c = a.mainConfig.map && a.mainConfig.map.itemId ? [a.mainConfig.map.itemId] : []);
                    var d = [];
                    b.forEach(c, function(b) { a.itemCards[b] || d.push(arcgisonline.sharing.utilShare.getItemCard(b)) });
                    d.length ? (new b.DeferredList(d)).addCallback(b.hitch(this, function(a, c) {
                        b.forEach(c, function(b) {
                            b =
                                b[1];
                            a.itemCards[b.id] = b
                        }, this);
                        arcgisonline.sharing.utilShare.checkForItemSharing(a)
                    }, a)) : hasItem && arcgisonline.sharing.utilShare.checkForItemSharing(a)
                }
            },
            checkWebMapInWebApp: function(a, c) {
                var d = new b.Deferred,
                    f = { access: c.mainItemCard.access };
                c.mainItemSharing && c.mainItemSharing.groups && (f.groups = c.mainItemSharing.groups);
                arcgisonline.sharing.utilShare.checkWebMapContent({
                    webMapId: a,
                    webMapItemCard: c.itemCards[a],
                    newAccess: f,
                    needUpdateHandler: b.hitch(this, function(a, b, c, d) {
                        a.itemCards[b].webMapInfo =
                            d;
                        c.resolve(!0)
                    }, c, a, d),
                    dontNeedUpdateHandler: b.hitch(this, function(a, b) { a.resolve(!1) }, d)
                });
                return d
            },
            getItemCard: function(a, c) {
                c = c || new b.Deferred;
                if ("inProgress" === arcgisonline.sharing.utilShare.itemCards[a]) setTimeout(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.getItemCard(a, b) }, a, c), 1E3);
                else if (arcgisonline.sharing.utilShare.itemCards[a]) delete arcgisonline.sharing.utilShare.itemCards[a].needsUpdate, c.callback(arcgisonline.sharing.utilShare.itemCards[a]);
                else {
                    arcgisonline.sharing.utilShare.itemCards[a] =
                        "inProgress";
                    var d = esriGeowConfig.restBaseUrl + "content/items/" + a,
                        f = arcgisonline.sharing.util.getToken();
                    esri.request({
                        url: d + (f ? "?f\x3djson\x26token\x3d" + f : "?f\x3djson"),
                        callbackParamName: "callback",
                        load: b.hitch(this, function(b, d) {
                            arcgisonline.sharing.utilShare.itemCards[a] = b;
                            c.callback(b)
                        }),
                        error: b.hitch(this, function(b, d) {
                            delete arcgisonline.sharing.utilShare.itemCards[a];
                            c.errback(b)
                        })
                    }, { disableIdentityLookup: !0 })
                }
                return c
            },
            getItemData: function(a, c) {
                c = c || new b.Deferred;
                if (arcgisonline.sharing.utilShare.itemCards[a] &&
                    "inProgress" === arcgisonline.sharing.utilShare.itemCards[a].data) setTimeout(b.hitch(this, function(a, b) { arcgisonline.sharing.utilShare.getItemData(a, b) }, a, c), 1E3);
                else if (arcgisonline.sharing.utilShare.itemCards[a] && arcgisonline.sharing.utilShare.itemCards[a].data) c.callback(arcgisonline.sharing.utilShare.itemCards[a].data);
                else {
                    arcgisonline.sharing.utilShare.itemCards[a].data = "inProgress";
                    var d = esriGeowConfig.restBaseUrl + "content/items/" + a + "/data",
                        f = arcgisonline.sharing.util.getToken();
                    esri.request({
                        url: d +
                            (f ? "?f\x3djson\x26token\x3d" + f : "?f\x3djson"),
                        callbackParamName: "callback",
                        load: b.hitch(this, function(b, d) {
                            arcgisonline.sharing.utilShare.itemCards[a].data = b;
                            c.callback(b)
                        }),
                        error: b.hitch(this, function(b, d) {
                            delete arcgisonline.sharing.utilShare.itemCards[a].data;
                            c.errback(b)
                        })
                    }, { disableIdentityLookup: !0 })
                }
                return c
            },
            getItemSharingInfo: function(a) {
                var b = esriGeowConfig.restBaseUrl + "content/users/" + a.owner;
                a.ownerFolder && (b += "/" + a.ownerFolder);
                b += "/items/" + a.id;
                a = arcgisonline.sharing.util.getToken();
                return esri.request({
                    url: b +
                        (a ? "?f\x3djson\x26token\x3d" + a : "?f\x3djson"),
                    callbackParamName: "callback"
                }, { disableIdentityLookup: !0 })
            },
            getOwnerGroups: function(a, c) {
                var d = new b.Deferred;
                arcgisonline.sharing.utilShare.ownerGroups[a.owner] ? d.callback() : arcgisonline.sharing.geow.Community.getProfile(a.owner, function(c) {
                    c = b.map(c.groups, function(a) { return a.id });
                    arcgisonline.sharing.utilShare.ownerGroups[a.owner] = c;
                    d.callback()
                }, function() { d.callback() });
                return d
            }
        }
    })
}, "arcgisonline/sharing/dijit/dialog/ShareCheckDlg": function() {
    define(["dojo",
        "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/util"
    ], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.ShareCheckDlg");
        b.require("dijit.Dialog");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("arcgisonline.sharing.util");
        b.declare("arcgisonline.sharing.dijit.dialog.ShareCheckDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"shareCheck-dialog" title\x3d"${i18n.shareChecksDlgTitle}" execute\x3d""\x3e\r\n    \x3cstyle type\x3d"text/css"\x3e\r\n      .esri .dojoxGridHeader .dojoxGridCellFocus, .esri .dojoxGridHeader .dojoxGridCell {\r\n        border-bottom: 1px solid #CCC;\r\n      }\r\n    \x3c/style\x3e\r\n    \x3cspan dojoAttachPoint\x3d"shareCheckTopMsg"\x3e\x3c/span\x3e\r\n    \x3cdiv dojotype\x3d"dijit.layout.BorderContainer" design\x3d"headline" gutters\x3d"false" style\x3d"width:100%; height:120px; margin:20px 0 10px 0;"\x3e\r\n      \x3cdiv dojoType\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"shareCheckGrid" region\x3d"top" style\x3d"height:118px;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cspan dojoAttachPoint\x3d"shareCheckBottomMsg"\x3e\x3c/span\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"editableLayerDiv" style\x3d"clear:both; display:none; background-color:rgba(240, 201, 206, 1); border:2px solid rgb(255, 0, 0); margin-top:10px; padding:8px;"\x3e\r\n      \x3cspan dojoAttachPoint\x3d"editableLayerMsg"\x3e\x3c/span\x3e\r\n      \x3ca dojoAttachPoint\x3d"editableLayerHelpLink" href\x3d"JavaScript:void(0);" dojoAttachEvent\x3d"onClick:onLearnHowClick"\x3e\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"editableLayerCheckDiv" style\x3d"clear:both; display:none;margin-top:10px;"\x3e\r\n      \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${i18n.enableBudgetContinue}\r\n          \x3c/td\x3e\x3ctd width\x3d"10"\x3e\r\n            \x26nbsp;\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_editableLayerCheckYes" data-dojo-attach-event\x3d"onClick:_editableLayerCheck" name\x3d"editableLayerCheck"/\x3e\x3cspan\x3e${i18n.yesLabel}\x3c/span\x3e\r\n          \x3c/td\x3e\x3ctd width\x3d"10"\x3e\r\n            \x26nbsp;\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_editableLayerCheckNo" data-dojo-attach-event\x3d"onClick:_editableLayerCheck" name\x3d"editableLayerCheck" checked/\x3e\x3cspan\x3e${i18n.noLabel}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing clearfix leader-1" style\x3d"padding-top:5px; padding-bottom:5px;"\x3e\r\n      \x3cbutton dojoAttachEvent\x3d"onClick:onCancelClick" dojoAttachPoint\x3d"exitButton" class\x3d"jevent cancel btn-two right" dojoType\x3d"dijit.form.Button"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n      \x3cbutton dojoAttachPoint\x3d"shareGridUpdateButton" dojoAttachEvent\x3d"onClick:onUpdateClick" class\x3d"jevent primary right" dojoType\x3d"dijit.form.Button"\x3e\r\n        ${i18n.UpdateSharingBtn}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
            grid: null,
            gridId: "shareCheckGridNode",
            statics: {
                _instance: null,
                getInstance: function() {
                    this._instance && g.byId("shareCheckGridNode") && g.byId("shareCheckGridNode").destroy();
                    null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.ShareCheckDlg);
                    return this._instance
                }
            },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").myOrganization.creditsTab);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").shareCheckDlg)
            },
            show: function(a) {
                var c = b.hitch(this, function(a, c, d) {
                    var f = !1,
                        g = !1;
                    if (("public" === a || "org" === a) && void 0 !== d.ownerFolder) return { userCanUpdate: !0, hasItemWithKnownGroupDetails: f, unknownGroupDetails: g };
                    if ("shared" === a)
                        if (void 0 !== d.ownerFolder) {
                            f = !0;
                            a = this.info.itemsSharing[e] ? this.info.itemsSharing[e].groups : [];
                            d = arcgisonline.sharing.utilShare.ownerGroups[d.owner];
                            for (var h = 0; h < c.length; h++)
                                if (-1 === b.indexOf(a, c[h]) &&
                                    (!esri.isDefined(d) || esri.isDefined(d) && -1 < b.indexOf(d, c[h]))) return { userCanUpdate: !0, hasItemWithKnownGroupDetails: f, unknownGroupDetails: g }
                        } else g = !0;
                    return { userCanUpdate: !1, hasItemWithKnownGroupDetails: f, unknownGroupDetails: g }
                });
                this.info = a;
                a = !1;
                var d = this.info.mainItemCard.access,
                    f = "Web Scene" === this.info.mainItemCard.type,
                    e;
                for (e in this.info.itemCards) {
                    var h = this.info.itemCards[e],
                        m = this.info.mainItemSharing ? this.info.mainItemSharing.groups : [];
                    if (!1 === h.needsUpdate) {
                        if (h.webMapInfo) {
                            for (var n in h.webMapInfo.itemCards) {
                                var r =
                                    c(d, m, h.webMapInfo.itemCards[n]);
                                a = r.userCanUpdate;
                                0 - r.unknownGroupDetails;
                                if (a) break
                            }
                            if (a) break
                        }
                    } else if (r = c(d, m, h), a = r.userCanUpdate, 0 - r.unknownGroupDetails, a) break
                }
                a ? (this.shareCheckTopMsg.innerHTML = this.info.webMapId ? f ? this.i18n.textTopWebScene : this.i18n.textTopWebmap : this.i18n.textTopWebapp, this.shareCheckBottomMsg.innerHTML = this.info.webMapId ? f ? this.i18n.textBottomWebScene : this.i18n.textBottomWebmap : this.i18n.textBottomWebapp, b.style(this.shareGridUpdateButton.domNode, "display", ""), this.exitButton.set("label",
                    this.i18n.cancel)) : (this.shareCheckTopMsg.innerHTML = this.info.webMapId ? f ? this.i18n.textTopWebScene : this.i18n.textTopWebmap : this.i18n.textTopWebapp, this.shareCheckBottomMsg.innerHTML = "", b.style(this.shareGridUpdateButton.domNode, "display", "none"), this.exitButton.set("label", this.i18n.ok));
                this.shareGridUpdateButton.set("disabled", !1);
                b.style(this.editableLayerDiv, "display", "none");
                b.style(this.editableLayerCheckDiv, "display", "none");
                this.checkEditableLayers();
                g.byId("shareCheck-dialog").show()
            },
            displayLayers: function() {
                var a =
                    b.create("table", { border: "1", style: "width: 100%; height: 100%" }, this.shareCheckItemsDiv),
                    c = b.create("tbody", {}, a),
                    c = b.create("tr", {}, c);
                b.create("span", { innerHTML: this.i18n.titleItem }, b.create("td", {}, c));
                b.create("span", { innerHTML: this.i18n.titleOwner }, b.create("td", {}, c));
                for (var d in this.info.itemCards) {
                    var f = this.info.itemCards[d],
                        c = b.create("tr", {}, a);
                    b.create("span", { innerHTML: f.title }, b.create("td", {}, c));
                    b.create("span", { innerHTML: f.owner }, b.create("td", {}, c))
                }
            },
            checkEditableLayers: function() {
                var a =
                    function(a, d) {
                        for (var e in a) {
                            var f = a[e];
                            f && !1 !== f.needsUpdate && "Feature Service" === f.type && ("admin" === f.itemControl || "update" === f.itemControl) && -1 < b.indexOf(f.typeKeywords, "Hosted Service") && (d.push(arcgisonline.sharing.util.getJson(f.url + "/layers")), c.push(f))
                        }
                    };
                if ("public" === this.info.mainItemCard.access) {
                    var c = [],
                        d = [];
                    a(this.info.itemCards, d);
                    for (var f in this.info.itemCards) {
                        var e = this.info.itemCards[f];
                        e.webMapInfo && a(e.webMapInfo.itemCards, d)
                    }
                    d.length ? (new b.DeferredList(d)).addCallback(b.hitch(this,
                        function(a) {
                            b.forEach(a, function(a, d) {
                                a[1].layers && a[1].layers.length && a[1].layers[0] && -1 < a[1].layers[0].capabilities.indexOf("Editing") && (c[d].isEditable = !0, this.editableLayerMsg.innerHTML = "* " + this.i18n.layerIsEditable + " \x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA href\x3d'" + (esriGeowConfig.helpBase + esriGeowConfig.helpMap["120001293"]) + "' target\x3d'_blank'\x3e" + this.i18n.learnHow + "\x3c/a\x3e\x3c/span\x3e", this.shareGridUpdateButton.set("disabled", !0), b.style(this.editableLayerDiv,
                                    "display", ""), b.style(this.editableLayerCheckDiv, "display", ""))
                            }, this);
                            this.createGrid()
                        })) : this.createGrid()
                } else this.createGrid()
            },
            _editableLayerCheck: function() { this.shareGridUpdateButton.set("disabled", !this._editableLayerCheckYes.get("checked")) },
            createGrid: function() {
                var a = [
                        [{ name: this.i18n.titleLayer, field: "name", width: "210px" }, { name: this.i18n.titleOwner, field: "owner", width: "210px" }]
                    ],
                    c = [],
                    d;
                for (d in this.info.itemCards) {
                    var f = this.info.itemCards[d];
                    !1 !== f.needsUpdate && c.push({
                        id: f.id,
                        name: f.title +
                            (f.isEditable && "public" === this.info.mainItemCard.access ? " *" : ""),
                        owner: f.owner
                    });
                    if (f.webMapInfo)
                        for (var e in f.webMapInfo.itemCards) {
                            var h = f.webMapInfo.itemCards[e];
                            c.push({ id: h.id, name: h.title + (h.isEditable && "public" === this.info.mainItemCard.access ? " *" : ""), owner: h.owner })
                        }
                }
                this.memory = new b.store.Memory({ data: c, idProperty: "id" });
                this.store = new b.data.ObjectStore({ objectStore: this.memory });
                this.grid = new n.grid.DataGrid({
                    store: this.store,
                    structure: a,
                    id: this.gridId,
                    style: { border: "1px #CCC solid" },
                    selectionMode: "none"
                }, b.create("div", null, this.shareCheckGrid.domNode));
                this.grid.startup();
                g.byId("shareCheck-dialog").resize();
                esri.isTouchEnabled && (this.gridScrollBox = this.grid.views.views[0].scrollboxNode, esri.setScrollable(this.gridScrollBox))
            },
            updateSharing: function() {
                var a = this.info.mainItemCard.access,
                    c = [];
                if ("public" === a || "org" === a)
                    for (var d in this.info.itemCards) {
                        if (a = this.info.itemCards[d], void 0 !== a.ownerFolder && !1 !== a.needsUpdate && c.push(this.shareItemByID(a)), a.webMapInfo)
                            for (var f in a.webMapInfo.itemCards) {
                                var e =
                                    a.webMapInfo.itemCards[f];
                                void 0 !== e.ownerFolder && c.push(this.shareItemByID(e))
                            }
                    } else {
                        var g = this.info.mainItemSharing ? this.info.mainItemSharing.groups : [],
                            c = [];
                        for (d in this.info.itemCards) {
                            a = this.info.itemCards[d];
                            if (void 0 !== a.ownerFolder && !1 !== a.needsUpdate) {
                                var m = "",
                                    n = "",
                                    r = this.info.itemsSharing[d] ? this.info.itemsSharing[d].groups : [],
                                    v = arcgisonline.sharing.utilShare.ownerGroups[a.owner];
                                b.forEach(g, function(a) {
                                    -1 === b.indexOf(r, a) && (!esri.isDefined(v) || esri.isDefined(v) && -1 < b.indexOf(v, a)) && (m +=
                                        n + a, n = ",")
                                }, this);
                                m.length && c.push(this.shareItemByID(a, m))
                            }
                            if (a.webMapInfo)
                                for (f in a.webMapInfo.itemCards) e = a.webMapInfo.itemCards[f], void 0 !== e.ownerFolder && (n = m = "", r = a.webMapInfo.itemsSharing[f] ? a.webMapInfo.itemsSharing[f].groups : [], v = arcgisonline.sharing.utilShare.ownerGroups[e.owner], b.forEach(g, function(a) {-1 === b.indexOf(r, a) && (!esri.isDefined(v) || esri.isDefined(v) && -1 < b.indexOf(v, a)) && (m += n + a, n = ",") }, this), m.length && c.push(this.shareItemByID(e, m)))
                        }
                    }
                c.length ? (new b.DeferredList(c)).addCallback(b.hitch(this,
                    function(a) {
                        b.forEach(a, function(a) {
                            a = a[1];
                            a.itemId && delete arcgisonline.sharing.utilShare.itemCards[a.itemId]
                        });
                        setTimeout(function() {
                            b.publish("onShareUpdate", null);
                            b.publish("shareCheckDlg/update")
                        }, 100);
                        this.hide()
                    })) : this.hide()
            },
            shareItemByID: function(a, c) {
                var d = this.info.mainItemCard.access,
                    d = { everyone: "public" === d, account: "org" === d || "org" === a.access, confirmItemControl: this.info && this.info.confirmItemControl ? !0 : !1 };
                c && (d.groups = c);
                var f = new b.Deferred;
                arcgisonline.sharing.geow.Content.shareItemByID(a,
                    d, b.hitch(this, function(a) { f.callback(a) }), b.hitch(this, function(a) { f.errback(a) }));
                return f
            },
            onLearnHowClick: function() {},
            onUpdateClick: function() { this.updateSharing() },
            onCancelClick: function() { this.hide() },
            hide: function() {
                this.store.close();
                delete this.store;
                delete this.memory;
                this.grid.destroy();
                delete this.grid;
                this.grid = this.store = this.memory = null;
                g.byId("shareCheck-dialog").hide()
            }
        })
    })
}, "arcgisonline/sharing/geow/Search": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!arcgisonline/sharing/util"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.geow.Search");
            b.require("arcgisonline.sharing.util");
            arcgisonline.sharing.geow.Search = {
                util: arcgisonline.sharing.util,
                searchByItemId: function(a, c, d) { this.util.getJson(esriGeowConfig.restBaseUrl + "search?q\x3did:" + a, b.hitch(this, c), b.hitch(this, d)) },
                searchByItemType: function(a, c, d, f, e, g) {
                    a = esriGeowConfig.restBaseUrl + 'search?q\x3dtype:"' + a + '"';
                    0 < c && (a += "\x26num\x3d" + c);
                    0 < d && (a += "\x26start\x3d" + d);
                    f && (a += "\x26sortField\x3d" + f);
                    this.util.getJson(a, b.hitch(this,
                        e), b.hitch(this, g))
                },
                searchByQuery: function(a, c, d, f, e, g) {
                    a = esriGeowConfig.restBaseUrl + "search?q\x3d" + a;
                    0 < c && (a += "\x26num\x3d" + c);
                    0 < d && (a += "\x26start\x3d" + d);
                    f && (a += "\x26sortField\x3d" + f);
                    this.util.getJson(a, b.hitch(this, e), b.hitch(this, g))
                }
            }
        })
}, "arcgisonline/sharing/dijit/Error": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/dom-attr dojo/dom-construct dojo/io-query dojo/string dijit/_WidgetBase dijit/_TemplatedMixin ../../esriGeowConfig ../util ../geow/Account dojo/i18n!../../nls/arcgisonline dojo/text!./templates/Error.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v) {
            return b("arcgisonline.sharing.dijit.Error", [f, e], {
                declaredClass: "arcgisonline.sharing.dijit.Error",
                templateString: v,
                _isSingleTenant: !1,
                i18n: null,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = g.mixin({}, r.common);
                    g.mixin(this.i18n, r.errorPage);
                    g.mixin(this.i18n, r.errorWidget)
                },
                startup: function() {
                    this._isSingleTenant = void 0 !== h.isMultiTenant && null !== h.isMultiTenant && !1 === h.isMultiTenant;
                    var b = c.queryToObject(window.location.search.slice(1)).c;
                    null != b && 0 < b.length ? (n.set("error-message", "innerHTML", this.findMessage(b)), 0 < this.findTitle(b).length && n.set("item-title", "innerHTML", this.findTitle(b)), "UseWebAdaptor" !== b && "WebAdaptorRequired" !== b || p.getSelf(function(c) {
                        var e = g.clone(c.portalHostname); - 1 !== e.indexOf(":") && (e = e.substring(0, e.indexOf(":")) + e.substring(e.lastIndexOf("/")));
                        e = e.toLowerCase();
                        n.set("item-title", "innerHTML", this.findTitle(b));
                        var f = location.protocol + "//" + m.cleanPorts(e) + "/home",
                            f = "\x3cspan\x3e" + f.replace("/arcgis/",
                                "/webadaptorname/") + "\x3c/span\x3e";
                        if ("UseWebAdaptor" === b) a.create("div", { className: "leader-1", innerHTML: d.substitute("\x3cbr\x3e" + this.i18n.webAdaptorUrl, { webAdaptorUrl: f }) }, "error-message");
                        else {
                            var h = c.helpMap && c.helpMap.m || {};
                            a.create("div", { className: "leader-1", innerHTML: d.substitute(this.i18n.webAdaptorNotConfigured, { startLink: '\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"' + (c.helpBase + (h["120000807"] || "")) + '" target\x3d"_blank"\x3e', endLink: "\x3c/a\x3e\x3c/span\x3e" }) }, "error-message");
                            a.create("div", { className: "leader-1", innerHTML: d.substitute(this.i18n.webAdaptorCompleteInstallation, { webAdaptorUrl: f }) }, "error-message");
                            c.portalHostname && (-1 < c.portalHostname.indexOf(":7080/") || -1 < c.portalHostname.indexOf(":7443/")) ? a.create("div", { className: "leader-1", innerHTML: d.substitute(this.i18n.createSiteNotUsingWebAdaptor, { startLink: '\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"' + (c.helpBase + (h["120001042"] || "")) + '" target\x3d"_blank"\x3e', endLink: "\x3c/a\x3e\x3c/span\x3e" }) }, "error-message") :
                                a.create("div", { className: "leader-1", innerHTML: d.substitute(this.i18n.notUsingWebAdaptor, { currentPortalUrl: "https://" + e + "/home" }) }, "error-message")
                        }
                    }.bind(this))) : (n.set("item-title", "innerHTML", this.findTitle("default")), n.set("error-message", "innerHTML", this.findMessage("default")))
                },
                findMessage: function(a) {
                    switch (a) {
                        case "InvalidItem":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.itemNotFound + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.invalidItem + "\x3c/div\x3e";
                        case "AccessDeniedResource":
                            return "\x3cdiv class\x3d'leader-1'\x3e" +
                                this.i18n.accessDeniedResource + "\x3c/div\x3e";
                        case "InvalidGroup":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.invalidGroup + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.goTo + "\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'groups.html'\x3e" + this.i18n.myGroups + "\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e";
                        case "InvalidOrganization":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.invalidOrganization + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.goTo + "\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'groups.html'\x3e" +
                                this.i18n.myGroups + "\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e";
                        case "AccessDeniedOrganization":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.accessDeniedOrganization + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.goTo + "\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'content.html'\x3e" + this.i18n.myContent + "\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e";
                        case "NoGroupEditPermission":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.noGroupEditPermission + "\x3c/div\x3e";
                        case "SSLRequired":
                            return a = h.baseUrl.replace("http:",
                                "https:") + h.signin, "\x3cdiv class\x3d'leader-1'\x3e" + d.substitute(this.i18n.securityEnabled, [this._isSingleTenant ? this.i18n.portal : this.i18n.organization]) + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'" + a + "'\x3e" + this.i18n.signIn + "\x3c/a\x3e\x3c/span\x3e\x3c/div\x3e";
                        case "WebAdaptorRequired":
                            return "";
                        case "UseWebAdaptor":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.useWebAdaptor + "\x3c/div\x3e";
                        case "PortalSignIn":
                            return a = d.substitute(this.i18n.portalOnceResolved, { linkStart: "\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'" + h.baseUrl + "'\x3e", linkEnd: "\x3c/a\x3e\x3c/span\x3e" }), "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.signInSoftAuth + "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + a + "\x3c/div\x3e";
                        case "PortalCreateAccount":
                            return a = d.substitute(this.i18n.portalOnceResolved, { linkStart: "\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'" + h.baseUrl + "'\x3e", linkEnd: "\x3c/a\x3e\x3c/span\x3e" }), "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.createAccountSoftAuth +
                                "\x3c/div\x3e\x3cdiv class\x3d'leader-1'\x3e" + a + "\x3c/div\x3e";
                        case "AccountDisabled":
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.accountDisabledError + "\x3c/div\x3e";
                        default:
                            return "\x3cdiv class\x3d'leader-1'\x3e" + this.i18n.defaultError + "\x3c/div\x3e"
                    }
                },
                findTitle: function(a) {
                    switch (a) {
                        case "InvalidItem":
                            return this.i18n.notFound;
                        case "InvalidGroup":
                            return this.i18n.groupNotFound;
                        case "InvalidOrganization":
                            return this.i18n.invalidOrganization;
                        case "AccessDeniedOrganization":
                            return this.i18n.insuffPriv;
                        case "NoGroupEditPermission":
                            return this.i18n.noEdit;
                        case "SSLRequired":
                            return this.i18n.sslRequired;
                        case "WebAdaptorRequired":
                            return this.i18n.webAdaptorNextSteps;
                        case "UseWebAdaptor":
                            return this.i18n.webAdaptorRequired;
                        case "PortalSignIn":
                            return this.i18n.signInError;
                        case "PortalCreateAccount":
                            return this.i18n.createAccountError;
                        case "AccountDisabled":
                            return this.i18n.accountDisabled;
                        default:
                            return this.i18n.itemTitle
                    }
                }
            })
        })
}, "arcgisonline/sharing/dijit/BasemapGalleryGrid": function() {
    define(["dojo",
        "dijit", "dojox", "dojo/require!arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/BasemapGallery,arcgisonline/sharing/util"
    ], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.BasemapGalleryGrid");
        b.require("arcgisonline.sharing.geow.Content");
        b.require("arcgisonline.sharing.geow.Community");
        b.require("arcgisonline.sharing.dijit.BasemapGallery");
        b.require("arcgisonline.sharing.util");
        b.declare("arcgisonline.sharing.dijit.BasemapGalleryGrid", [g._Widget,
            g._Templated, g._KeyNavContainer
        ], {
            _gallery: null,
            groupId: null,
            groupQuery: null,
            sortField: null,
            sortOrder: null,
            lastOpenBlurCall: null,
            templateString: '\x3cdiv\x3e\r\n    \x3cdiv\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"padding-top:8px;"\x3e\r\n            \x3cspan id\x3d"basemap-galleryLabel" style\x3d"font-weight: bold;"\x3e\r\n            ${i18n.selectBasemap}\r\n            \x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing esriTrailingMargin1" style\x3d"padding-top:5px;"\x3e\r\n            \x3cA id\x3d"basemap-galleryClose" href\x3d"JavaScript:void(0);" title\x3d"${i18n.close}" alt\x3d"${i18n.close}"\x3e\r\n            \x3c/A\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv style\x3d"padding-right:10px; padding-left:10px;"\x3e\x3chr/\x3e\x3c/div\x3e\r\n    \x3cdiv id\x3d"containerNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
            i18n: null,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").basemapGalleryGrid)
            },
            postCreate: function() {
                this.inherited(arguments);
                b.connect(b.byId("basemap-galleryClose"), "onclick", this, "close")
            },
            onBlur: function(a) {
                this.inherited(arguments);
                if (!esri.isTouchEnabled) {
                    var b = 5E3;
                    this.lastOpenBlurCall && (b = (new Date).getTime() - this.lastOpenBlurCall.getTime());
                    550 > b || (this.lastOpenBlurCall = new Date, this.hide())
                }
            },
            open: function() {
                var a = 5E3;
                this.lastOpenBlurCall && (a = (new Date).getTime() - this.lastOpenBlurCall.getTime());
                550 > a || (this.lastOpenBlurCall = new Date, "block" === b.style(b.byId("basemap-gallery"), "display") ? this.hide() : (null === this._gallery ? this.init() : b.style(b.byId("basemap-gallery"), "display", "block"), setTimeout(function() { g.focus.focus(b.byId("basemap-gallery")) }, 0)))
            },
            close: function() {
                esri.isTouchEnabled ? this.hide() : setTimeout(b.hitch(this, function() { g.focus.focus(this.buttonNode) }),
                    0)
            },
            hide: function(a) {
                b.style(b.byId("basemap-gallery"), "display", "none");
                setTimeout(b.hitch(this, function() { this.button && this.button.set("checked", !1) }), 500)
            },
            init: function() {
                this._gallery = new arcgisonline.sharing.dijit.BasemapGallery({ id: this.id + "_Gallery", showNodeLabels: !0 }, b.create("div", null, this.domNode));
                this._gallery.startup();
                this.button = g.byId("webmap-basemap");
                this.buttonNode = this.button.domNode;
                if (isEmbedded && isEmbedded.isItemDetail) {
                    this.button = null;
                    this.buttonNode = b.byId("webmap-basemap2");
                    var a = b.coords(this.buttonNode);
                    b.style(b.byId("basemap-gallery"), "left", a.x + a.w + 10 + "px");
                    b.style(b.byId("basemap-gallery"), "top", "20px")
                } else a = b.coords(this.buttonNode), esriGeowConfig.isRightToLeft ? b.style(b.byId("basemap-gallery"), "left", a.x + a.w - 382 + "px") : b.style(b.byId("basemap-gallery"), "left", a.x - 4 + "px"), b.style(b.byId("basemap-gallery"), "top", a.y + a.h + "px");
                this.groupQuery && 0 < this.groupQuery.length && arcgisonline.sharing.geow.Community.searchGroups(this.groupQuery, b.hitch(this, this._handleGetGroup),
                    b.hitch(this, this._handleGetGroup));
                b.byId("basemap-gallery").tabIndex = 0;
                b.style(b.byId("basemap-gallery"), "display", "block")
            },
            _getItems: function() {
                var a = { q: "group:" + this.groupId + ' AND (type:"web map" -type:"web mapping application")', sortField: this.sortField, num: "50" };
                this.sortOrder && (a.sortOrder = this.sortOrder);
                arcgisonline.sharing.geow.Content.search(esriGeowConfig.restBaseUrl + "search", a, b.hitch(this, this._handleGetItems), b.hitch(this, this._handleGetItems))
            },
            _setGroupIdAttr: function(a) {
                null !==
                    a && 0 !== a.length && (this.groupId = a, this._getItems())
            },
            _handleGetItems: function(a, c) {
                a.results && 0 < a.results.length ? (a = a.results, esri.isDefined(this.sortOrder) || (a = a.sort(function(a, b) {
                    a = a.title.toLowerCase();
                    b = b.title.toLowerCase();
                    return a == b ? 0 : a < b ? -1 : 1
                })), b.attr(this._gallery, "items", a)) : b.attr(this._gallery, "items", [])
            },
            _handleGetGroup: function(a, c) {
                a && 0 < a.total ? (a.results[0].sortField && (this.sortField = a.results[0].sortField), this.sortOrder = a.results[0].sortOrder ? a.results[0].sortOrder : null, this._setGroupIdAttr(a.results[0].id)) :
                    (b.empty(this._gallery.flowContainer), this._gallery.flowContainer.appendChild(b.create("div", { innerHTML: this.i18n.noBasemapsFound, style: "position:relative;top:50px;text-align:center;" })))
            }
        })
    })
}, "arcgisonline/sharing/dijit/BasemapGallery": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,dojo/NodeList-fx,dijit/layout/ContentPane,arcgisonline/sharing/util,arcgisonline/sharing/dijit/_Empty,arcgisonline/sharing/geow/QueryReadStore"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.BasemapGallery");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dojo.NodeList-fx");
        b.require("dijit.layout.ContentPane");
        b.require("arcgisonline.sharing.util");
        b.require("arcgisonline.sharing.dijit._Empty");
        b.require("arcgisonline.sharing.geow.QueryReadStore");
        b.declare("arcgisonline.sharing.dijit.BasemapGallery", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv dojoAttachPoint\x3d"containerNode" style\x3d"clear:both; min-height:100px;"\x3e\r\n  \x3cdiv class\x3d"galleryBackground"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\r\n      \x3cdiv class\x3d"throb-loading"\x3e\x3cdiv class\x3d"throb-loading-text"\x3e${i18n.loadingShort}\x3c/div\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
            showNodeLabels: !0,
            fadeOutOtherNodes: !0,
            animFadeOut: !0,
            unfocusedOpacity: .5,
            flowContainer: null,
            nodeClass: "galleryNode",
            thumbClass: "galleryThumbnail",
            messageClass: "galleryMessage",
            _galleryFadeIn: null,
            _galleryFadeOut: null,
            _galleryFadeOutTotal: null,
            noResultsMessage: null,
            items: null,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").arcGISServerServices;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").emptyStates)
            },
            postCreate: function() {
                this._galleryFadeIn = b.animateProperty({ node: this.flowContainer, properties: { opacity: 1 } });
                this._galleryFadeOut = b.animateProperty({ node: this.flowContainer, properties: { opacity: this.unfocusedOpacity } });
                this._galleryFadeOutTotal = b.animateProperty({ node: this.flowContainer, properties: { opacity: 0 } })
            },
            _setItemsAttr: function(a) {
                this.items = this.includeNode ? b.filter(a, this.includeNode) : a;
                this._loadItems(a)
            },
            _loadItems: function(a) {
                this._galleryFadeIn.stop();
                this._galleryFadeOut.stop();
                this._galleryFadeOutTotal.onEnd =
                    b.hitch(this, function(a) {
                        b.empty(this.flowContainer);
                        0 < a.length ? (b.forEach(a, b.hitch(this, function(a, b) {
                            a.id || (a.id = b);
                            this.flowContainer.appendChild(this._buildNodeLayout(a))
                        })), b.create("br", { style: { clear: "both" } }, this.flowContainer)) : (a = b.string.substitute(arcgisonline.sharing.dijit._Empty, { message: this.i18n.noContentAvailable, width: 96 }), b.create("div", { innerHTML: a }, this.flowContainer));
                        this._galleryFadeIn.play();
                        this._galleryFadeOut.onEnd = null
                    }, a);
                this._galleryFadeOutTotal.play()
            },
            _buildNodeLayout: function(a) {
                var c =
                    b.create("div", { id: "galleryNode_" + a.id, "class": this.nodeClass });
                b.addClass(c, "mini");
                var d = b.create("a", { href: "#" }, c);
                b.connect(d, "onclick", b.hitch(this, "onNodeClick", a));
                b.create("img", { "class": this.thumbClass, src: a.thumbnail ? this._getThumbailUrl(a) : arcgisonline.sharing.util.relativeToExplicitUrl("images/transparent.gif") }, d);
                this.showNodeLabels && (d = b.create("div", { "class": "galleryLabelContainer" }, c), a = a.title || "", b.create("span", { innerHTML: a, alt: a, title: a }, d));
                return c
            },
            _getThumbailUrl: function(a) {
                var b =
                    arcgisonline.sharing.util.getToken();
                return esriGeowConfig.restBaseUrl + "content/items/" + a.id + "/info/" + a.thumbnail + (b ? "?token\x3d" + b : "")
            },
            onNodeClick: function(a, b) {
                b.preventDefault();
                arcgisonline.map.save_open.switchBaseMapWithWebMap(a);
                g.byId("basemap-gallery").close()
            }
        })
    })
}, "arcgisonline/sharing/dijit/ProfilePopup": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!arcgisonline/sharing/dijit/views,arcgisonline/sharing/geow/Community,dijit/layout/ContentPane,esri/Evented,dijit/_OnDijitClickMixin,dijit/a11y,dijit/a11yclick"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.ProfilePopup");
            b.require("arcgisonline.sharing.dijit.views");
            b.require("arcgisonline.sharing.geow.Community");
            b.require("dijit.layout.ContentPane");
            b.require("esri.Evented");
            b.require("dijit._OnDijitClickMixin");
            b.require("dijit.a11y");
            b.require("dijit.a11yclick");
            b.declare("arcgisonline.sharing.dijit.ProfilePopup", [g.layout.ContentPane, g._OnDijitClickMixin, esri.Evented], {
                "class": "profilePopup",
                _lastTrigger: null,
                _resizeConnect: null,
                _blurConnect: null,
                _profileContentPane: null,
                animateShowHide: !0,
                fadeDuration: 300,
                onHide: function() {},
                onShow: function() {},
                statics: {
                    cache: [],
                    _instance: null,
                    getInstance: function() { null === this._instance && (this._instance = new arcgisonline.sharing.dijit.ProfilePopup, this._instance.startup()); return this._instance },
                    showProfilePopup: function(a) {
                        var c = arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();
                        null !== c && c.showProfile(b.attr(a.currentTarget, "owner"), a.currentTarget)
                    }
                },
                postCreate: function() {
                    this.inherited(arguments);
                    b.style(this.domNode, { position: "absolute", top: "-1000px", left: "-1000px", opacity: 0 });
                    b.attr(this.domNode, "tabIndex", 0);
                    this.fadeIn = b.fadeIn({ node: this.domNode, duration: this.fadeDuration, onEnd: function() { g.focus(this.domNode) } });
                    this.fadeOut = b.fadeOut({ node: this.domNode, duration: this.fadeDuration, onEnd: b.hitch(this, "_afterFade") })
                },
                startup: function() {
                    this.inherited(arguments);
                    var a = b.create("div", { style: { position: "relative", top: 0, left: 0 } }, this.domNode);
                    this._profileContentPane = new g.layout.ContentPane({ style: { overflow: "hidden" } });
                    this._profileContentPane.placeAt(a);
                    a = b.create("span", { role: "button", tabIndex: 0, "class": "dijitDialogCloseIcon", title: arcgisonline.sharing.dijit.views.profile.i18n().close, style: { position: "absolute", top: "-5px" } }, a);
                    b.style(a, esriGeowConfig.isRightToLeft ? { left: "-5px" } : { right: "-5px" });
                    this.own(g.a11yclick(a, b.hitch(this, function(a) {
                        a.preventDefault();
                        this.hide()
                    })), b.connect(this.domNode, "onkeypress", b.hitch(this, "_tabFence")))
                },
                _getFocusItems: function() {
                    var a = g.a11y._getTabNavigable(this.domNode);
                    this._firstFocusItem =
                        a.lowest || a.first || this.closeButtonNode || this.domNode;
                    this._lastFocusItem = a.last || a.highest || this._firstFocusItem
                },
                _tabFence: function(a) {
                    if (a.keyCode == b.keys.TAB) {
                        this._getFocusItems();
                        var c = a.target;
                        this._firstFocusItem == this._lastFocusItem ? (a.stopPropagation(), a.preventDefault()) : c == this._firstFocusItem && a.shiftKey ? (g.focus(this._lastFocusItem), a.stopPropagation(), a.preventDefault()) : c != this._lastFocusItem || a.shiftKey || (g.focus(this._firstFocusItem), a.stopPropagation(), a.preventDefault())
                    } else a.keyCode ==
                        b.keys.ESCAPE && (this.hide(), a.stopPropagation(), a.preventDefault())
                },
                showProfile: function(a, c) {
                    this._lastTrigger = c;
                    var d = arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a];
                    d && null !== d ? (this._profileContentPane.set("content", d), a = arcgisonline.sharing.dijit.views.profile.medium(d, { showThumb: !0, showProfilePopup: !0, align: "left" }), this._placeNextTo(a, c)) : (arcgisonline.sharing.geow.Community.getProfile(a, b.hitch(this, this._handleGetProfile), b.hitch(this, this._handleGetProfile)), this._profileContentPane.set("content",
                        b.create("span", { innerHTML: "loading..." })))
                },
                showProfileFromPopup: function(a, c) {
                    b.style(this.domNode, { zIndex: 1E3, opacity: 1 });
                    this.showProfile(a, c)
                },
                _handleGetProfile: function(a, b) { a && (b = arcgisonline.sharing.dijit.views.profile.medium(a, { showThumb: !0, showProfilePopup: !0, align: "left" }), arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a.username] = a, this._placeNextTo(b, this._lastTrigger)) },
                _placeNextTo: function(a, b) {
                    g.placeOnScreenAroundNode(this.domNode, b, esriGeowConfig.isRightToLeft ? { BR: "TR", BL: "TL", TR: "BR", TL: "BL" } : { BL: "TL", BR: "TR", TL: "BL", TR: "BR" });
                    this._profileContentPane.set("content", a);
                    this.show()
                },
                _afterFade: function() {
                    b.style(this.domNode, { top: "-1000px", left: "-1000px" });
                    this.onHide()
                },
                show: function(a) {
                    this.isShowing = !0;
                    this.animateShowHide ? (this.fadeOut.stop(), this.fadeIn.play()) : (b.style(this.domNode, "display", "block"), g.focus(this.domNode));
                    this._clearConnects();
                    this._resizeConnect = b.connect(window, "onresize", this, this.hide);
                    this.onShow();
                    g.focus(this.domNode)
                },
                hide: function() {
                    this._clearConnects();
                    this.animateShowHide ? (this.fadeIn.stop(), this.fadeOut.play()) : (b.style(this.domNode, "display", "none"), this.onHide())
                },
                _clearConnects: function() {
                    null !== this._resizeConnect && (b.disconnect(this._resizeConnect), this._resizeConnect = null);
                    null !== this._blurConnect && (b.disconnect(this._blurConnect), this._blurConnect = null)
                }
            })
        })
}, "arcgisonline/sharing/dijit/RasterFunctionEditor": function() {
    define("dojo/dom-class dojo/string dojo/on dojo/topic dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/_TemplatedMixin dijit/Dialog esri/domUtils ../../pages/dijit/Overlay dojo/text!./templates/RasterFunctionEditor.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t) {
            return c("arcgisonline.sharing.dijit.RasterFunctionEditor", [e, m, v], {
                baseClass: "esriRFxEditorContainer",
                user: null,
                constructor: function(a, b) {
                    this.user = a && a.user;
                    this.parent = a && a.parent;
                    this.item = a && a.item;
                    this.domNode = b;
                    this.overlayContents = g.substitute(w, { i18n: t });
                    this.destroyOnClose = this.showActionBar = !1
                },
                postCreate: function() {
                    this.inherited(arguments);
                    this._iframe = this.domNode.querySelector("iframe");
                    this._passiveOverlay = this.domNode.querySelector(".passive-overlay");
                    this._closeBtn = this.domNode.querySelector(".close-btn");
                    b.add(this.domNode, "overlay--top")
                },
                startup: function() {
                    this.inherited(arguments);
                    var a = this.user,
                        b = this.item ? this.item.id : null,
                        a = esriGeowConfig.rasterFunctionEditor + "?locale\x3d" + dojo.locale + "\x26portalUrl\x3d" + esriGeowConfig.restBaseUrl + "\x26username\x3d" + a.username + "\x26userId\x3d" + a.accountId + "\x26token\x3d" + a.token;
                    b && (a = a + "\x26itemId\x3d" + b);
                    this._iframe.src = a;
                    this._showLoadingDialog();
                    this._attachListeners()
                },
                destroy: function() { this._detachAnalysisToolListeners() },
                activate: function() {
                    b.remove(this.domNode, "passive");
                    this._iframe.contentWindow.postMessage(JSON.stringify({ action: "activate" }), "*")
                },
                deactivate: function() {
                    b.add(this.domNode, "passive");
                    this._iframe.contentWindow.postMessage(JSON.stringify({ action: "deactivate" }), "*")
                },
                onLoad: function() {
                    this._closeLoadingDialog();
                    this.showOnStart && this.open()
                },
                run: function(b) {
                    "analysisStack" !== arcgisonline.map.leftPanel.getLeftContentPanelStack() && (arcgisonline.map.dijit.toc.analysis.configureAnalysis(), a.publish("Analysis/ShowAnalysis"));
                    this.applyRFxTool ? this.applyRFxTool.set("rasterFunction", b) : b && this.parent && (this.parent.analysisTool.openApplyRFxTool(b, !0), this.applyRFxTool = leftPanel.toolPanel.get("currentTool"), this._detachAnalysisToolListeners(), this._attachAnalysisToolListeners());
                    this.deactivate()
                },
                open: function() {
                    this._iframe.contentWindow.postMessage(JSON.stringify({ action: "reset", itemId: this.item ? this.item.id : null }), "*");
                    this.inherited(arguments);
                    this._sendMapInfo();
                    this.activate()
                },
                close: function(a) {
                    this.inherited(arguments);
                    this.item = void 0;
                    this._iframe.contentWindow.postMessage(JSON.stringify({ action: "close" }), "*");
                    this._detachAnalysisToolListeners();
                    a && this.applyRFxTool && this.applyRFxTool._onClose(!0);
                    setTimeout(d.hitch(this, this._attachAnalysisToolListeners), 0)
                },
                _sendMapInfo: function() {
                    var a = [],
                        b = [];
                    f.forEach(arcgisonline.map.main.mapLayers, function(c) {
                        var d = c.layer,
                            e = d && d.url;
                        d && (e && -1 < e.toLowerCase().indexOf("/imageserver") ? a.push({
                            id: d.id,
                            name: d.name || c.title,
                            url: e,
                            renderingRule: d.renderingRule && d.renderingRule.toJson(),
                            mosaicRule: d.mosaicRule && d.mosaicRule.toJson()
                        }) : "esri.layers.FeatureLayer" === d.declaredClass && b.push({ id: d.id, name: d.name, url: e }))
                    });
                    var c = arcgisonline.map.main.map.extent;
                    this._iframe.contentWindow.postMessage(JSON.stringify({ action: "info", layers: { imageService: a, feature: b }, extent: c && c.toJson() }), "*")
                },
                _closeLoadingDialog: function() { this._loadingDialog && this._loadingDialog.hide() },
                _showLoadingDialog: function() {
                    this._loadingDialog || (this._loadingDialog = new p({
                        title: t.common.loading,
                        content: "\x3cdiv\x3e\x3cdiv\x3e" +
                            t.common.loadingRFxEditor + "\x3c/div\x3e\x3cdiv class\x3d'throb-loading'\x3e\x3c/div\x3e\x3c/div\x3e"
                    }));
                    this._loadingDialog.show()
                },
                _detachAnalysisToolListeners: function() { this.applyRFxTool && this._analysisHandles && f.forEach(this._analysisHandles, function(a) { a && a.remove && a.remove() }, this) },
                _attachAnalysisToolListeners: function() {
                    this.applyRFxTool && (this._analysisHandles = [], this._analysisHandles.push(this.applyRFxTool.on("close", d.hitch(this, this.close, !1))), this._analysisHandles.push(this.applyRFxTool.on("start",
                        d.hitch(this, this.close, !1))))
                },
                _setParentAttr: function(a) { a !== this.parent && (this.parent = a, this.applyRFxTool = null) },
                _setItemAttr: function(a) { this.item = a },
                _attachListeners: function() {
                    window.addEventListener("message", d.hitch(this, function(a) { if (a.source && a.source === this._iframe.contentWindow) { a = a.data; try { a = JSON.parse(a); "close" === a.action && this.close(!0); if ("loaded" === a.action) this.onLoad(); "run" === a.action && this.run(a.rft) } catch (B) {} } }), !1);
                    this.own(n(this._passiveOverlay, "click", d.hitch(this, this.activate)),
                        n(this._closeBtn, "click", d.hitch(this, this.close)), a.subscribe("onLayerUpdate", this._sendMapInfo.bind(this)), a.subscribe("_onRendererUpdate", this._sendMapInfo.bind(this)), a.subscribe("onMosaicRuleApply", this._sendMapInfo.bind(this)), a.subscribe("onMosaicRuleReset", this._sendMapInfo.bind(this)))
                }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/AddLayerFromFileDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/form/TextBox,dijit/form/CheckBox,dijit/form/Button,dijit/InlineEditBox,dijit/Dialog,dijit/_Widget,dijit/_Templated,dojo/io/iframe,dojox/data/CsvStore,dojox/data/XmlStore,dojox/xml/DomParser,dojox/encoding/base64,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/dialog/GeneralDlg"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg");
            b.require("dijit.form.TextBox");
            b.require("dijit.form.CheckBox");
            b.require("dijit.form.Button");
            b.require("dijit.InlineEditBox");
            b.require("dijit.Dialog");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dojo.io.iframe");
            b.require("dojox.data.CsvStore");
            b.require("dojox.data.XmlStore");
            b.require("dojox.xml.DomParser");
            b.require("dojox.encoding.base64");
            b.require("arcgisonline.sharing.dijit.HelpManager");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.declare("arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"add-layer-file-dialog" title\x3d"${i18n.addLayerFromFileDlgTitle}" execute\x3d""\x3e\r\n    \x3cform id\x3d"add-layer-file-form" enctype\x3d"multipart/form-data" name\x3d"add-layer-file-form" action\x3d"" method\x3d"post" onSubmit\x3d"return false;"\x3e\r\n      \x3cdiv id\x3d"add-layer-file-msg" class\x3d"esriTrailingPadding1"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"ie_msg" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\r\n          \x3cbr/\x3e\r\n          ${i18n.ieMsg}\r\n        \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"margin-top: 1.5em;"\x3e\r\n        \x3ctable cellspacing\x3d"5" style\x3d"margin-top:0.25em 0 0.2em 0;"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel for\x3d"add-layer-file-file"\x3e\r\n                  ${i18n.fileLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"file" id\x3d"add-layer-file-file" name\x3d"file" size\x3d"40" onpropertychange\x3d"dijit.byId(\'addLayerFromFileDlg\').onFileInputPropertyChange();" style\x3d"margin:0 1px 0 1px;"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3cdiv id\x3d"add-layer-shapefile" style\x3d"padding-top:10px;padding-bottom:10px;display:none;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"option" dojotype\x3d"dijit.form.RadioButton" id\x3d"option:generalize" checked\x3d"checked"/\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n            \x3clabel for\x3d"option:generalize"\x3e\r\n              ${i18n.generalize}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both;padding-top:5px;"\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"option" dojotype\x3d"dijit.form.RadioButton" id\x3d"option:original"/\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n            \x3clabel for\x3d"option:original"\x3e\r\n              ${i18n.keepOrig}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"add-layer-file-tip" class\x3d"esriItemLinks" style\x3d"margin-top:15px;display:none;"\x3e\r\n          \x3cspan\x3e${i18n.tip}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top: 1em;"\x3e\r\n          \x3cdiv class\x3d"esriItemLinks esriFloatLeading" style\x3d"margin-top:5px;"\x3e\r\n            \x3cA id\x3d"helpLink" href\x3d"" target\x3d"_blank" style\x3d"line-height: 20px;"\x3e\x3c/A\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing" style\x3d"clear:both;"\x3e\r\n          \x3cspan id\x3d"add-layer-file-loading" style\x3d"display:none;"\x3e${i18n.importing}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n          \x3cbutton id\x3d"button_add-layer-file" class\x3d"primary" type\x3d"submit" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.importLayerBtn} \r\n          \x3c/button\x3e\r\n          \x3cbutton id\x3d"button_add-layer-file-cancel" dojoAttachEvent\x3d"onClick:hide" class\x3d"jevent cancel" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both; width: 100%; height:1px;"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                defaultTextFile: "",
                defaultTextUrl: "http://",
                layerType: "csv",
                helpMgr: null,
                statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg({ id: "addLayerFromFileDlg" })); return this._instance } },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                    b.mixin(this.i18n,
                        b.i18n.getLocalization("arcgisonline", "arcgisonline").viewer.fileImport);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").addLayerFromFileDlg);
                    this.defaultTextFile = this.i18n.enterLocation
                },
                postCreate: function() {
                    this.helpMgr = arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance();
                    this.loadConnections()
                },
                show: function() {
                    g.byId("button_add-layer-file").set("disabled", !1);
                    g.byId("button_add-layer-file-cancel").set("disabled", !1);
                    b.style(b.byId("add-layer-file-loading"),
                        "display", "none");
                    b.byId("add-layer-file-file").value = "";
                    arcgisonline.sharing.util.getUser();
                    var a = "\x3cspan\x3e" + this.i18n.headerText + "\x3c/span\x3e",
                        a = a + "\x3cul class\x3d'esriLeadingPadding26'\x3e";
                    esri.isDefined(esriGeowConfig.self) && !1 === esriGeowConfig.self.supportsHostedServices || (a += "  \x3cli\x3e" + this.i18n.shpText + "\x3c/li\x3e");
                    a += "  \x3cli\x3e" + this.i18n.csvText + "\x3c/li\x3e";
                    a += "  \x3cli\x3e" + this.i18n.gpxText + "\x3c/li\x3e";
                    a += "  \x3cli\x3e" + this.i18n.geoJsonText + "\x3c/li\x3e";
                    a += "\x3c/ul\x3e";
                    b.byId("add-layer-file-msg").innerHTML = a;
                    g.byId("add-layer-file-dialog").show()
                },
                clear: function() {
                    b.byId("add-layer-file-file").value = "";
                    b.style(b.byId("add-layer-shapefile"), "display", "none");
                    b.style(b.byId("add-layer-file-tip"), "display", "none")
                },
                loadConnections: function() {
                    b.query(".jevent").connect("onclick", function(a) { a.preventDefault() });
                    b.connect(g.byId("add-layer-file-dialog"), "hide", this, "clear");
                    b.connect(b.byId("add-layer-file-form"), "onkeydown", this, "onKeyDown");
                    b.connect(b.byId("add-layer-file-form"),
                        "onsubmit", b.hitch(this, function(a) {
                            a.preventDefault();
                            a.target.data ? this.handleUserSelection(a.target.data.files) : this.handleUserSelection(a.target.file.files)
                        }));
                    b.connect(b.byId("add-layer-file-form"), "onchange", b.hitch(this, function(a) {
                        -1 < b.trim(b.byId("add-layer-file-file").value.toLowerCase()).indexOf(".zip") ? (b.style(b.byId("add-layer-shapefile"), "display", ""), b.isIE || b.isSafari || b.style(b.byId("add-layer-file-tip"), "display", "none")) : (b.style(b.byId("add-layer-shapefile"), "display", "none"),
                            b.style(b.byId("add-layer-file-tip"), "display", ""))
                    }));
                    8 >= b.isIE && b.style(b.byId("ie_msg"), "display", "inline")
                },
                onFileInputPropertyChange: function() {
                    if (10 > b.isIE) {
                        var a = b.trim(b.byId("add-layer-file-file").value.toLowerCase());
                        0 == a.length ? b.style(b.byId("add-layer-shapefile"), "display", "none") : -1 < a.indexOf(".zip") ? b.style(b.byId("add-layer-shapefile"), "display", "") : b.style(b.byId("add-layer-shapefile"), "display", "none")
                    }
                },
                hide: function() {
                    arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().hide();
                    g.byId("add-layer-file-dialog").hide()
                },
                onKeyDown: function(a) {
                    var c;
                    window.event ? c = a.keyCode : a.which && (c = a.which);
                    13 == c && b.byId("add-layer-file-form").submit()
                },
                handleUserSelection: function(a) {
                    0 == b.trim(b.byId("add-layer-file-file").value).length ? arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: this.i18n.errors.needFile }) : (g.byId("button_add-layer-file").set("disabled", !0), g.byId("button_add-layer-file-cancel").set("disabled", !0), b.style(b.byId("add-layer-file-loading"), "display", b.IE ? "inline" : ""), esri.isDefined(esriGeowConfig.self) && !1 !== esriGeowConfig.self.supportsHostedServices && a && 1 === a.length && -1 !== (a[0].name || a[0].fileName).indexOf(".zip") ? this.handleFile(a[0]) : a && 1 === a.length && "undefined" !== typeof FileReader ? this.handleFile(a[0]) : (b.byId("add-layer-file-file").name = "data", esri.request({
                        url: esriGeowConfig.reflectorUrl,
                        form: b.byId("add-layer-file-form"),
                        content: { f: "json" },
                        callbackParamName: "callback.html",
                        handleAs: "json",
                        load: b.hitch(this, function(a) { a.error ? this.errorFunc(a.error) : this.handleFile(a) }),
                        error: b.hitch(this, "errorFunc")
                    })))
                },
                handleFile: function(a) {
                    var c = (a.type || a.contentType || " ").toLowerCase(),
                        d = a.name || a.fileName;
                    if (10 > b.isIE) var f = d.split("\\"),
                        d = f[f.length - 1];
                    var e = d,
                        d = d.toLowerCase(),
                        h = !0;
                    if (esri.isDefined(esriGeowConfig.self) && !1 !== esriGeowConfig.self.supportsHostedServices && -1 !== d.indexOf(".zip")) {
                        var m = e.split(".");
                        a = {};
                        arcgisonline.map.main.map.extent.spatialReference.wkid ? a.wkid = arcgisonline.map.main.map.extent.spatialReference.wkid :
                            a.wkt = arcgisonline.map.main.map.extent.spatialReference.wkt;
                        a = { name: m[0], targetSR: a, maxRecordCount: 1E3, enforceInputFileSizeLimit: !0, enforceOutputJsonSizeLimit: !0, locationType: "none" };
                        g.byId("option:generalize").get("checked") ? (c = esri.geometry.getExtentForScale(arcgisonline.map.main.map, 4E4), c = c.getWidth() / arcgisonline.map.main.map.width, a.generalize = !0, a.maxAllowableOffset = c, c /= 10) : (c = esri.geometry.getExtentForScale(arcgisonline.map.main.map, 400), c = c.getWidth() / arcgisonline.map.main.map.width);
                        for (f =
                            0; 1 > c;) c *= 10, f++;
                        a.reducePrecision = !0;
                        a.numberOfDigitsAfterDecimal = f;
                        a.maxRecordCount = 4E3;
                        a = { filetype: "shapefile", publishParameters: b.json.stringify(a), f: "json", "callback.html": "textarea" };
                        var p = function(a) {
                            var c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
                                d = this.i18n.errors.cantImportShp,
                                e = this.i18n.errorDlgTitle;
                            a.message && (-1 < a.message.indexOf("maximum number of records allowed") || -1 < a.message.indexOf("Exceeded response size") || -1 < a.message.indexOf("input shapefile exceeds")) ||
                                a.details && a.details[0] && -1 < a.details[0].indexOf("File exceeds the max size") ? (e = this.i18n.notice, a = arcgisonline.sharing.util.getUser(), arcgisonline.sharing.util.isPortal() || a && a.accountId ? (a = "\x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA href\x3d'" + (esriGeowConfig.helpBase + esriGeowConfig.helpMap["120000902"]) + "' target\x3d'_blank'\x3e" + esri.i18nBundle.viewer.fileImport.hostedLayerTitle + "\x3c/A\x3e\x3c/span\x3e", d = esri.i18nBundle.viewer.fileImport.tooManyFeaturesOrg, d = b.string.substitute(d, { hostedLayer: a })) : (a = "\x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA href\x3d'" + (esriGeowConfig.helpBase + esriGeowConfig.helpMap["120001297"]) + "' target\x3d'_blank'\x3e" + esri.i18nBundle.viewer.fileImport.subscriptionTitle + "\x3c/A\x3e\x3c/span\x3e", d = esri.i18nBundle.viewer.fileImport.tooManyFeaturesAnon, d = b.string.substitute(d, { subscription: a }))) : a.message && -1 < a.message.indexOf("missing prj file") ? d += " " + this.i18n.errors.missingPrj : a.message && -1 < a.message.indexOf("Invalid shapefile") &&
                                (d += " " + this.i18n.errors.notValidShp);
                            c.show({ title: e, message: d });
                            g.byId("button_add-layer-file").set("disabled", !1);
                            g.byId("button_add-layer-file-cancel").set("disabled", !1);
                            b.style(b.byId("add-layer-file-loading"), "display", "none")
                        };
                        b.byId("add-layer-file-file").name = "file";
                        c = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/");
                        c += "content/features/generate";
                        (f = arcgisonline.sharing.util.getToken()) && (c += "?token\x3d" + f);
                        esri.request({
                            url: c,
                            content: a,
                            form: b.byId("add-layer-file-form"),
                            handleAs: "json",
                            load: b.hitch(this, function(a) {
                                !a || a.error ? b.hitch(this, p, a ? a.error : {})() : arcgisonline.map.fileImport.processShapefile(m[0], a.featureCollection, b.hitch(this, function() {
                                    b.style(b.byId("add-layer-file-loading"), "display", "none");
                                    this.hide()
                                }))
                            }),
                            error: b.hitch(this, p)
                        });
                        h = null
                    } else if (-1 !== c.indexOf("text/") || -1 !== d.indexOf(".txt") || -1 !== d.indexOf(".csv") || -1 !== d.indexOf(".gpx"))
                        if (a.data) a = this.bytesToString(n.encoding.base64.decode(a.data)), -1 !== d.indexOf(".gpx") ? (a = a.replace(/[\r\n]/g, " "), h = arcgisonline.map.fileImport.processGpxData(a, e)) : h = arcgisonline.map.fileImport.processCsvData(a, e);
                        else {
                            var r = new FileReader;
                            r.onload = function() { h = -1 !== d.indexOf(".gpx") ? arcgisonline.map.fileImport.processGpxData(r.result, e) : arcgisonline.map.fileImport.processCsvData(r.result, e) };
                            r.readAsText(a)
                        }
                    else -1 !== d.indexOf(".geojson") || -1 !== d.indexOf(".json") ? (m = e.split("."), a = {}, arcgisonline.map.main.map.extent.spatialReference.wkid ? a.wkid = arcgisonline.map.main.map.extent.spatialReference.wkid :
                        a.wkt = arcgisonline.map.main.map.extent.spatialReference.wkt, a = { name: m[0], targetSR: a, enforceInputFileSizeLimit: !0, enforceOutputJsonSizeLimit: !0, locationType: "none", maxRecordCount: 4E3 }, a = { filetype: "geojson", publishParameters: b.json.stringify(a), f: "json", "callback.html": "textarea" }, p = function(a) {
                            var c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
                                d = this.i18n.errors.cantImportGeoJson,
                                e = this.i18n.errorDlgTitle;
                            if (a.message && -1 < a.message.indexOf("maximum number of records allowed") ||
                                -1 < a.message.indexOf("Exceeded response size") || -1 < a.message.indexOf("input shapefile exceeds") || a.details && a.details[0] && -1 < a.details[0].indexOf("File exceeds the max size")) e = this.i18n.notice, a = arcgisonline.sharing.util.getUser(), arcgisonline.sharing.util.isPortal() || a && a.accountId ? (a = "\x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA href\x3d'" + (esriGeowConfig.helpBase + esriGeowConfig.helpMap["120000902"]) + "' target\x3d'_blank'\x3e" + esri.i18nBundle.viewer.fileImport.hostedLayerTitle +
                                "\x3c/A\x3e\x3c/span\x3e", d = esri.i18nBundle.viewer.fileImport.tooManyFeaturesOrg, d = b.string.substitute(d, { hostedLayer: a })) : (a = "\x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA href\x3d'" + (esriGeowConfig.helpBase + esriGeowConfig.helpMap["120001297"]) + "' target\x3d'_blank'\x3e" + esri.i18nBundle.viewer.fileImport.subscriptionTitle + "\x3c/A\x3e\x3c/span\x3e", d = esri.i18nBundle.viewer.fileImport.tooManyFeaturesAnon, d = b.string.substitute(d, { subscription: a }));
                            c.show({ title: e, message: d });
                            g.byId("button_add-layer-file").set("disabled", !1);
                            g.byId("button_add-layer-file-cancel").set("disabled", !1);
                            b.style(b.byId("add-layer-file-loading"), "display", "none")
                        }, b.byId("add-layer-file-file").name = "file", c = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/"), c += "content/features/generate", (f = arcgisonline.sharing.util.getToken()) && (c += "?token\x3d" + f), esri.request({
                            url: c,
                            content: a,
                            form: b.byId("add-layer-file-form"),
                            handleAs: "json",
                            load: b.hitch(this, function(a) {
                                !a || a.error ? b.hitch(this,
                                    p, a ? a.error : {})() : arcgisonline.map.fileImport.processShapefile(m[0], a.featureCollection, b.hitch(this, function() {
                                    b.style(b.byId("add-layer-file-loading"), "display", "none");
                                    this.hide()
                                }), "geojson")
                            }),
                            error: b.hitch(this, p)
                        }), h = null) : (a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c = this.i18n.errors.unkownFileType, esri.isDefined(esriGeowConfig.self) && !1 === esriGeowConfig.self.supportsHostedServices && (c = b.string.substitute(this.i18n.errors.fileCannotBeAddedToPortal, { fileName: e })),
                        a.show({ title: this.i18n.errorDlgTitle, message: c }), h = !1);
                    !0 === h ? this.hide() : !1 === h && (g.byId("button_add-layer-file").set("disabled", !1), g.byId("button_add-layer-file-cancel").set("disabled", !1), b.style(b.byId("add-layer-file-loading"), "display", "none"))
                },
                bytesToString: function(a) {
                    var b = 0,
                        d = [],
                        f = a.length,
                        e, g, m, n;
                    for ("239,187,191" == a.slice(0, 3) && (b = 3); b < f; b++) e = a[b], 128 > e ? d.push(String.fromCharCode(e)) : 194 <= e && 224 > e ? (g = a[++b], d.push(String.fromCharCode(((e & 31) << 6) + (g & 63)))) : 224 <= e && 240 > e ? (g = a[++b], m =
                        a[++b], d.push(String.fromCharCode(((e & 255) << 12) + ((g & 63) << 6) + (m & 63)))) : 240 <= e && 245 > e && (g = a[++b], m = a[++b], n = a[++b], e = ((e & 7) << 18) + ((g & 63) << 12) + ((m & 63) << 6) + (n & 63), e -= 65536, d.push(String.fromCharCode((e >> 10) + 55296, (e & 1023) + 56320)));
                    return d.join("")
                },
                errorFunc: function(a) {
                    g.byId("button_add-layer-file").set("disabled", !1);
                    g.byId("button_add-layer-file-cancel").set("disabled", !1);
                    b.style(b.byId("add-layer-file-loading"), "display", "none");
                    arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({
                        title: this.i18n.errorDlgTitle,
                        message: this.i18n.errors.importError
                    })
                }
            })
        })
}, "dijit/InlineEditBox": function() {
    define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/i18n dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/when ./a11yclick ./focus ./_Widget ./_TemplatedMixin ./_WidgetsInTemplateMixin ./_Container ./form/Button ./form/_TextBoxMixin ./form/TextBox dojo/text!./templates/InlineEditBox.html dojo/i18n!./nls/common".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L) {
            G = a("dijit._InlineEditor", [E, G, F], {
                templateString: L,
                contextRequire: b,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.messages = h.getLocalization("dijit", "common", this.lang);
                    g.forEach(["buttonSave", "buttonCancel"], function(a) { this[a] || (this[a] = this.messages[a]) }, this)
                },
                buildRendering: function() {
                    this.inherited(arguments);
                    var a = "string" == typeof this.editor ? r.getObject(this.editor) || b(this.editor) : this.editor,
                        c = this.sourceStyle,
                        d = "line-height:" + c.lineHeight + ";",
                        h = e.getComputedStyle(this.domNode);
                    g.forEach(["Weight", "Family", "Size", "Style"], function(a) { h["font" + a] != c["font" + a] && (d += "font-" + a + ":" + c["font" + a] + ";") }, this);
                    g.forEach("marginTop marginBottom marginLeft marginRight position left top right bottom float clear display".split(" "), function(a) { this.domNode.style[a] = c[a] }, this);
                    var m = this.inlineEditBox.width;
                    "100%" == m ? (d += "width:100%;", this.domNode.style.display = "block") : d += "width:" + (m + (Number(m) == m ? "px" : "")) + ";";
                    m = r.delegate(this.inlineEditBox.editorParams, { style: d, dir: this.dir, lang: this.lang, textDir: this.textDir });
                    this.editWidget = new a(m, this.editorPlaceholder);
                    this.inlineEditBox.autoSave && (this.saveButton.destroy(), this.cancelButton.destroy(), this.saveButton = this.cancelButton = null, f.destroy(this.buttonContainer))
                },
                postCreate: function() {
                    this.inherited(arguments);
                    var a = this.editWidget;
                    this.inlineEditBox.autoSave ? this.own(n.after(a, "onChange", r.hitch(this, "_onChange"), !0), v(a, "keydown", r.hitch(this, "_onKeyDown"))) : "intermediateChanges" in a && (a.set("intermediateChanges", !0), this.own(n.after(a, "onChange", r.hitch(this, "_onIntermediateChange"), !0)), this.saveButton.set("disabled", !0))
                },
                startup: function() {
                    this.editWidget.startup();
                    this.inherited(arguments)
                },
                _onIntermediateChange: function() { this.saveButton.set("disabled", this.getValue() == this._resetValue || !this.enableSave()) },
                destroy: function() {
                    this.editWidget.destroy(!0);
                    this.inherited(arguments)
                },
                getValue: function() {
                    var a = this.editWidget;
                    return String(a.get("displayedValue" in a || "_getDisplayedValueAttr" in a ? "displayedValue" :
                        "value"))
                },
                _onKeyDown: function(a) { this.inlineEditBox.autoSave && this.inlineEditBox.editing && !a.altKey && !a.ctrlKey && (a.keyCode == p.ESCAPE ? (a.stopPropagation(), a.preventDefault(), this.cancel(!0)) : a.keyCode == p.ENTER && "INPUT" == a.target.tagName && (a.stopPropagation(), a.preventDefault(), this._onChange())) },
                _onBlur: function() {
                    this.inherited(arguments);
                    this.inlineEditBox.autoSave && this.inlineEditBox.editing && (this.getValue() == this._resetValue ? this.cancel(!1) : this.enableSave() && this.save(!1))
                },
                _onChange: function() {
                    this.inlineEditBox.autoSave &&
                        this.inlineEditBox.editing && this.enableSave() && B.focus(this.inlineEditBox.displayNode)
                },
                enableSave: function() { return this.editWidget.isValid ? this.editWidget.isValid() : !0 },
                focus: function() {
                    this.editWidget.focus();
                    this.editWidget.focusNode && (B._onFocusNode(this.editWidget.focusNode), "INPUT" == this.editWidget.focusNode.tagName && this.defer(function() { H.selectInputText(this.editWidget.focusNode) }))
                }
            });
            E = a("dijit.InlineEditBox" + (w("dojo-bidi") ? "_NoBidi" : ""), E, {
                editing: !1,
                autoSave: !0,
                buttonSave: "",
                buttonCancel: "",
                renderAsHtml: !1,
                editor: J,
                editorWrapper: G,
                editorParams: {},
                disabled: !1,
                onChange: function() {},
                onCancel: function() {},
                width: "100%",
                value: "",
                noValueIndicator: 6 >= w("ie") ? "\x3cspan style\x3d'font-family: wingdings; text-decoration: underline;'\x3e\x26#160;\x26#160;\x26#160;\x26#160;\x26#x270d;\x26#160;\x26#160;\x26#160;\x26#160;\x3c/span\x3e" : "\x3cspan style\x3d'text-decoration: underline;'\x3e\x26#160;\x26#160;\x26#160;\x26#160;\x26#x270d;\x26#160;\x26#160;\x26#160;\x26#160;\x3c/span\x3e",
                constructor: function() {
                    this.editorParams = {}
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.displayNode = this.srcNodeRef;
                    this.own(v(this.displayNode, x, r.hitch(this, "_onClick")), v(this.displayNode, "mouseover, focus", r.hitch(this, "_onMouseOver")), v(this.displayNode, "mouseout, blur", r.hitch(this, "_onMouseOut")));
                    this.displayNode.setAttribute("role", "button");
                    this.displayNode.getAttribute("tabIndex") || this.displayNode.setAttribute("tabIndex", 0);
                    this.value || "value" in this.params || (this.value = r.trim(this.renderAsHtml ? this.displayNode.innerHTML :
                        this.displayNode.innerText || this.displayNode.textContent || ""));
                    this.value || (this.displayNode.innerHTML = this.noValueIndicator);
                    d.add(this.displayNode, "dijitInlineEditBoxDisplayMode")
                },
                setDisabled: function(a) {
                    m.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.", "", "2.0");
                    this.set("disabled", a)
                },
                _setDisabledAttr: function(a) {
                    this.domNode.setAttribute("aria-disabled", a ? "true" : "false");
                    a ? this.displayNode.removeAttribute("tabIndex") : this.displayNode.setAttribute("tabIndex",
                        0);
                    d.toggle(this.displayNode, "dijitInlineEditBoxDisplayModeDisabled", a);
                    this._set("disabled", a)
                },
                _onMouseOver: function() { this.disabled || d.add(this.displayNode, "dijitInlineEditBoxDisplayModeHover") },
                _onMouseOut: function() { d.remove(this.displayNode, "dijitInlineEditBoxDisplayModeHover") },
                _onClick: function(a) { this.disabled || (a && (a.stopPropagation(), a.preventDefault()), this._onMouseOut(), this.defer("edit")) },
                edit: function() {
                    if (!this.disabled && !this.editing) {
                        this._set("editing", !0);
                        this._savedTabIndex =
                            c.get(this.displayNode, "tabIndex") || "0";
                        if (!this.wrapperWidget) {
                            var a = f.create("span", null, this.domNode, "before");
                            this.wrapperWidget = new("string" == typeof this.editorWrapper ? r.getObject(this.editorWrapper) : this.editorWrapper)({
                                value: this.value,
                                buttonSave: this.buttonSave,
                                buttonCancel: this.buttonCancel,
                                dir: this.dir,
                                lang: this.lang,
                                tabIndex: this._savedTabIndex,
                                editor: this.editor,
                                inlineEditBox: this,
                                sourceStyle: e.getComputedStyle(this.displayNode),
                                save: r.hitch(this, "save"),
                                cancel: r.hitch(this, "cancel"),
                                textDir: this.textDir
                            }, a);
                            this.wrapperWidget._started || this.wrapperWidget.startup();
                            this._started || this.startup()
                        }
                        var b = this.wrapperWidget;
                        d.add(this.displayNode, "dijitOffScreen");
                        d.remove(b.domNode, "dijitOffScreen");
                        e.set(b.domNode, { visibility: "visible" });
                        c.set(this.displayNode, "tabIndex", "-1");
                        var g = b.editWidget,
                            h = this;
                        t(g.onLoadDeferred, r.hitch(b, function() {
                            g.set("displayedValue" in g || "_setDisplayedValueAttr" in g ? "displayedValue" : "value", h.value);
                            this.defer(function() {
                                b.saveButton && b.saveButton.set("disabled",
                                    "intermediateChanges" in g);
                                this.focus();
                                this._resetValue = this.getValue()
                            })
                        }))
                    }
                },
                _onBlur: function() { this.inherited(arguments) },
                destroy: function() {
                    this.wrapperWidget && !this.wrapperWidget._destroyed && (this.wrapperWidget.destroy(), delete this.wrapperWidget);
                    this.inherited(arguments)
                },
                _showText: function(a) {
                    var b = this.wrapperWidget;
                    e.set(b.domNode, { visibility: "hidden" });
                    d.add(b.domNode, "dijitOffScreen");
                    d.remove(this.displayNode, "dijitOffScreen");
                    c.set(this.displayNode, "tabIndex", this._savedTabIndex);
                    a &&
                        B.focus(this.displayNode)
                },
                save: function(a) {
                    if (!this.disabled && this.editing) {
                        this._set("editing", !1);
                        var b = this.wrapperWidget.getValue();
                        this.set("value", b);
                        this._showText(a)
                    }
                },
                setValue: function(a) { m.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.", "", "2.0"); return this.set("value", a) },
                _setValueAttr: function(a) {
                    a = r.trim(a);
                    var b = this.renderAsHtml ? a : a.replace(/&/gm, "\x26amp;").replace(/</gm, "\x26lt;").replace(/>/gm, "\x26gt;").replace(/"/gm, "\x26quot;").replace(/\n/g,
                        "\x3cbr\x3e");
                    this.displayNode.innerHTML = this.editorParams && "password" === this.editorParams.type ? "********" : b || this.noValueIndicator;
                    this._set("value", a);
                    this._started && this.defer(function() { this.onChange(a) })
                },
                getValue: function() { m.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.", "", "2.0"); return this.get("value") },
                cancel: function(a) {!this.disabled && this.editing && (this._set("editing", !1), this.defer("onCancel"), this._showText(a)) }
            });
            w("dojo-bidi") && (E = a("dijit.InlineEditBox",
                E, {
                    _setValueAttr: function() {
                        this.inherited(arguments);
                        this.applyTextDir(this.displayNode)
                    }
                }));
            E._InlineEditor = G;
            return E
        })
}, "arcgisonline/sharing/dijit/dialog/AddLayerFromUrlDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/form/TextBox,dijit/form/CheckBox,dijit/form/Button,dijit/InlineEditBox,dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/CustomRequestParameters,arcgisonline/sharing/dijit/SelectLayers,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/ExtentDlg,arcgisonline/sharing/util"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg");
            b.require("dijit.form.TextBox");
            b.require("dijit.form.CheckBox");
            b.require("dijit.form.Button");
            b.require("dijit.InlineEditBox");
            b.require("dijit.Dialog");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("arcgisonline.sharing.dijit.HelpManager");
            b.require("arcgisonline.sharing.dijit.CustomRequestParameters");
            b.require("arcgisonline.sharing.dijit.SelectLayers");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.require("arcgisonline.sharing.dijit.dialog.ExtentDlg");
            b.require("arcgisonline.sharing.util");
            b.declare("arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv class\x3d"widgetContainer" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"add-layer-url-dialog" title\x3d"${i18n.addLayerFromUrlDlgTitle}" execute\x3d""\x3e\r\n    \x3cform id\x3d"add-layer-url-form" enctype\x3d"multipart/form-data" name\x3d"add-layer-url-form" action\x3d"" method\x3d"post" onSubmit\x3d"return false;"\x3e\r\n\r\n      \x3cspan\x3e${i18n.msg}\x3c/span\x3e\r\n\r\n      \x3cdiv style\x3d"margin-top: 1.5em; margin-left:0.70em; margin-right:0.5em;"\x3e\r\n        \x3cdiv style\x3d"clear:both; margin-bottom: 0; margin-left:0.3em; "\x3e\r\n          \x3cselect dojoAttachPoint\x3d"layerTypeSelect" class\x3d"wideselect"  dojoType\x3d"dijit.form.Select" \x3e\r\n            \x3coption value\x3d"arcgis" selected\x3e${i18n.arcgis}\x3c/option\x3e\r\n            \x3coption value\x3d"wms"\x3e${i18n.wms}\x3c/option\x3e\r\n            \x3coption value\x3d"wmts"\x3e${i18n.wmts}\x3c/option\x3e\r\n            \x3coption value\x3d"wfs"\x3e${i18n.wfs}\x3c/option\x3e\r\n            \x3coption value\x3d"webTiled"\x3e${i18n.webTiled}\x3c/option\x3e\r\n            \x3coption value\x3d"kml"\x3e${i18n.kml}\x3c/option\x3e\r\n            \x3coption value\x3d"geoRSS"\x3e${i18n.geoRSS}\x3c/option\x3e\r\n            \x3coption value\x3d"csv"\x3e${i18n.csv}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv id\x3d"add-layer-url" style\x3d"clear:both;"\x3e\r\n          \x3ctable cellpadding\x3d"0" cellspacing\x3d"5" style\x3d"margin-top:0.25em 0 0.2em 0;"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr style\x3d"height:1px;"\x3e\r\n                \x3c!-- to fix styling issues ---\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv style\x3d"width:100%; height:1px;"\x3e\x26nbsp;\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-webTiled-help" style\x3d"display:none;"\x3e\r\n                \x3ctd colspan\x3d"2"\x3e${!i18n.webTiledUrlHelp}\x3cbr/\x3e\x26nbsp;\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap valign\x3d"top"\x3e\x3clabel for\x3d"add-layer-url-url"\x3e${i18n.urlLabel}\x3c/label\x3e\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-url" dojoAttachEvent\x3d"onChange:onChangeUrl" intermediateChanges\x3d"true" name\x3d"url" dojotype\x3d"dijit.form.TextBox" dir\x3d"ltr" trim\x3d"true" required\x3d"true" style\x3d"width: 100%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-options" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-basemap" class\x3d"esriFloatLeading" style\x3d"padding-bottom:10px;"\x3e\r\n                    \x3cinput id\x3d"add-layer-url-basemap-check" dojotype\x3d"dijit.form.CheckBox" dojoAttachEvent\x3d"onChange:onChangeGISBasemap" checked\x3d"false" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                    \x3clabel for\x3d"add-layer-url-basemap-check"\x3e ${i18n.useAsBasemap} \x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-customParams" class\x3d"esriFloatTrailing"\x3e\r\n                    \x3cdiv class\x3d"esriItemLinks"\x3e\x3ca id\x3d"add-layer-url-customParamsText" dojoAttachEvent\x3d"onClick:toggleCustomParams" href\x3d"JavaScript:void(0);"\x3e${i18n.addCustomParameters}\x3c/A\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-imagery-label" style\x3d"display:none;"\x3e\r\n                \x3ctd width\x3d"100%" colspan\x3d"2"\x3e\r\n                  \x3cdiv\x3e${i18n.addImageryAs}\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-imagery-options" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%" colspan\x3d"2"\x3e\r\n                  \x3cdiv style\x3d"clear:both; padding-bottom:10px; margin-right: 10px;" class\x3d"dijitInline"\x3e\r\n                    \x3cinput class\x3d"esriFloatLeading" type\x3d"radio" name\x3d"imageryLayerType" dojotype\x3d"dijit.form.RadioButton" id\x3d"imageryLayerType:dynamic"/\x3e\r\n                    \x3clabel class\x3d"esriFloatLeading" for\x3d"imageryLayerType:dynamic"\x3e\r\n                      \x26nbsp;${i18n.dynamicImagery}\r\n                    \x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                  \x3cdiv style\x3d"clear:both; padding-bottom:10px;" class\x3d"dijitInline"\x3e\r\n                    \x3cinput class\x3d"esriFloatLeading" type\x3d"radio" name\x3d"imageryLayerType" dojotype\x3d"dijit.form.RadioButton" id\x3d"imageryLayerType:tiled" checked\x3d"checked"/\x3e\r\n                    \x3clabel class\x3d"esriFloatLeading" for\x3d"imageryLayerType:tiled"\x3e\r\n                      \x26nbsp;${i18n.tiledImagery}\r\n                    \x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-gis" style\x3d"display:none;"\x3e\r\n                \x3ctd width\x3d"100%" colspan\x3d"2"\x3e\r\n                  \x3clabel\x3e ${i18n.chooseLayer} \x3c/label\x3e\r\n                  \x3cselect dojoAttachPoint\x3d"gisLayerSelect" dojoAttachEvent\x3d"onChange:setGISService" style\x3d"width:100%;margin-top:4px;" maxHeight\x3d"150" dojoType\x3d"dijit.form.Select" \x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-customParamsGridDiv" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-customParamsGridText" style\x3d"padding:3px 0;"\x3e${i18n.customParametersMsg}\x3c/div\x3e\r\n                  \x3cdiv style\x3d"height:150px; margin-bottom:10px"\x3e\r\n                    \x3cdiv id\x3d"add-layer-url-customParamsGrid"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr id\x3d"add-layer-url-browseLayers-options"\x3e\r\n                \x3ctd colspan\x3d"2" width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-browseLayers" class\x3d"esriFloatLeading"\x3e\r\n                    \x3cbutton dojoAttachEvent\x3d"onClick:getLayers" dojoAttachPoint\x3d"browseLayersButton" disabled\x3d"true" class\x3d"secondary" dojotype\x3d"dijit.form.Button"\x3e\r\n                      ${i18n.browserForMoreLayersBtn}\r\n                    \x3c/button\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr id\x3d"add-layer-url-getLayers-options"\x3e\r\n                \x3ctd colspan\x3d"2" width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-getLayers" class\x3d"esriFloatLeading"\x3e\r\n                    \x3cbutton dojoAttachEvent\x3d"onClick:getLayers" dojoAttachPoint\x3d"getLayersButton" class\x3d"secondary" dojotype\x3d"dijit.form.Button"\x3e\r\n                      ${i18n.getLayersBtn}\r\n                    \x3c/button\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr id\x3d"add-layer-url-wms" style\x3d"display:none;"\x3e\r\n                \x3ctd colspan\x3d"2" width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-wms-layers"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \r\n              \x3ctr id\x3d"add-layer-url-wmts" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x3clabel\x3e${i18n.layerLabel}\x3c/label\x3e\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cselect dojoAttachPoint\x3d"wmtsLayerSelect" dojoAttachEvent\x3d"onChange:setWMTSLayer" style\x3d"width: 100%" maxHeight\x3d"200"  dojoType\x3d"dijit.form.Select" \x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-layer-options"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-layer-basemap" class\x3d"esriFloatLeading"\x3e\r\n                    \x3cinput id\x3d"add-layer-url-layer-basemap-check" dojotype\x3d"dijit.form.CheckBox" dojoAttachEvent\x3d"onChange:onChangeBasemap" checked\x3d"false" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                    \x3clabel for\x3d"add-layer-url-layer-basemap-check"\x3e ${i18n.useAsBasemap} \x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-wmts-tileMatrixMsg" style\x3d"display:none;"\x3e\r\n                \x3ctd colspan\x3d"2"\x3e\x3cdiv dojoAttachPoint\x3d"wmtsTileMatrixMsg" style\x3d"margin-top:10px;"\x3e${i18n.tileMatrixMsg}\x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-wmts-tileMatrix" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x3clabel\x3e${i18n.tileMatrixLabel}\x3c/label\x3e\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cselect dojoAttachPoint\x3d"wmtsTileMatrixSelect" style\x3d"width: 100%" maxHeight\x3d"200"  dojoType\x3d"dijit.form.Select" \x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr id\x3d"add-layer-url-wfs" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x3clabel\x3e${i18n.layerLabel}\x3c/label\x3e\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cselect dojoAttachPoint\x3d"wfsLayerSelect" dojoAttachEvent\x3d"onChange:setWFSLayer" style\x3d"width: 100%" maxHeight\x3d"200"  dojoType\x3d"dijit.form.Select" \x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-wfs-geometryTypeMsg" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\x3cdiv style\x3d"padding-top:10px;"\x3e${i18n.wfsGeometryTypeMsg}\x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-wfs-geometryType" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cselect dojoAttachPoint\x3d"wfsGeometryTypeSelect" dojoAttachEvent\x3d"onChange:setWFSGeometryType" dojoType\x3d"dijit.form.Select" \x3e\r\n                    \x3coption value\x3d"-1" selected\x3e${i18n.chooseWFSGeometryType}\x3c/option\x3e                  \r\n                    \x3coption value\x3d"esriGeometryPoint"\x3e${i18n.points}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriGeometryPolyline"\x3e${i18n.lines}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriGeometryPolygon"\x3e${i18n.polygons}\x3c/option\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-wfs-advanced" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\r\n                  \x3cdiv class\x3d"esriItemLinks" style\x3d"padding-top:5px;"\x3e\x3ca id\x3d"add-layer-url-wfs-advancedText" dojoAttachEvent\x3d"onClick:toggleWFSAdvancedOptions" href\x3d"JavaScript:void(0);"\x3e${i18n.showAvancedOptions}\x3c/A\x3e\x3c/div\x3e\r\n                  \x3cdiv id\x3d"add-layer-url-wfs-advancedOptions" style\x3d"display:none;padding-top:5px;"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv data-dojo-attach-point\x3d"_wfsAdvancedOptionsMaxFeatures" dojotype\x3d"dijit.form.NumberTextBox" constraints\x3d"{min:1,max:30000,places:0,pattern:\'####\'}" value\x3d"3000" required\x3d"true" style\x3d"width: 40px; padding:2px;"\x3e\x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            ${i18n.maxFeatures}\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cinput data-dojo-attach-point\x3d"_wfsAdvancedOptionsSwapXY" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            ${i18n.swapXY}\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv id\x3d"add-layer-url-webTiled" style\x3d"display:none; clear:both; padding-top:5px;"\x3e\r\n          \x3ctable cellpadding\x3d"0" cellspacing\x3d"5" border\x3d"0" width\x3d"100%"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap\x3e\x3cspan\x3e${i18n.title}\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd width\x3d"100%"\x3e\x3cdiv id\x3d"add-layer-url-webTiled-title" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width: 100%; padding:2px;"\x3e\x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap\x3e\x3cspan\x3e${i18n.credits}\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\x3cdiv id\x3d"add-layer-url-webTiled-credits" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width: 100%; padding:2px;"\x3e\x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-webTiled-subdomains-input" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x3cspan\x3e${i18n.subdomains}\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\x3cdiv id\x3d"add-layer-url-webTiled-subdomains" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width: 100%; padding:2px;"\x3e\x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr id\x3d"add-layer-url-webTiled-subdomains-help" style\x3d"display:none;"\x3e\r\n                \x3ctd nowrap\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\x3cspan\x3e${i18n.webTiledSubdomainsHelp}\x3c/span\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\x3cspan\x3e${i18n.extent}\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                \x3cdiv id\x3d"add-layer-url-webTiled-extent-valid" style\x3d"display:none;"\x3e\r\n                  \x3ctable\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e${i18n.left}:\x3c/td\x3e\r\n                      \x3ctd align\x3d"right" nowrap\x3d"nowrap"\x3e\x3cspan id\x3d"add-layer-url-webTiled-extent-left"\x3e\x3c/span\x3e\x3c/td\x3e\r\n                      \x3ctd style\x3d"width: 2em;"\x3e\x3c/td\x3e\r\n                      \x3ctd\x3e${i18n.right}:\x3c/td\x3e\r\n                      \x3ctd align\x3d"right" nowrap\x3d"nowrap"\x3e\x3cspan id\x3d"add-layer-url-webTiled-extent-right"\x3e\x3c/span\x3e\x3c/td\x3e\r\n                      \x3ctd rowspan\x3d"3" style\x3d"width: 2em;"\x3e\x3c/td\x3e\r\n                      \x3ctd rowspan\x3d"3"\x3e\r\n                      \x3cbutton dojoAttachEvent\x3d"onClick:setExtent" class\x3d"jevent" dojotype\x3d"dijit.form.Button"\x3e\r\n                        ${i18n.setTileCoverage}\r\n                      \x3c/button\x3e\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd colspan\x3d"5" style\x3d"line-height:5px;"\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e${i18n.top}:\x3c/td\x3e\r\n                      \x3ctd align\x3d"right" nowrap\x3d"nowrap"\x3e\x3cspan id\x3d"add-layer-url-webTiled-extent-top"\x3e\x3c/span\x3e\x3c/td\x3e\r\n                      \x3ctd\x3e\x3c/td\x3e\r\n                      \x3ctd\x3e${i18n.bottom}:\x3c/td\x3e\r\n                      \x3ctd align\x3d"right" nowrap\x3d"nowrap"\x3e\x3cspan id\x3d"add-layer-url-webTiled-extent-bottom"\x3e\x3c/span\x3e\x3c/td\x3e\r\n                      \x3ctd\x3e\x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv id\x3d"add-layer-url-webTiled-extent-none" style\x3d"display:block;"\x3e\r\n                  \x3cbutton dojoAttachEvent\x3d"onClick:setExtent" class\x3d"jevent" dojotype\x3d"dijit.form.Button"\x3e\r\n                    ${i18n.setTileCoverage}\r\n                  \x3c/button\x3e\r\n                \x3c/div\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv id\x3d"add-layer-bing" style\x3d"display:none; clear:both; padding-top:5px; padding-left:2px;"\x3e\r\n          \x3cdiv style\x3d"clear:both;"\x3e\r\n            \x3cinput class\x3d"esriFloatLeading" type\x3d"radio" name\x3d"bingType" dojotype\x3d"dijit.form.RadioButton" id\x3d"bingType:streets" checked\x3d"checked"/\x3e\r\n            \x3clabel class\x3d"esriFloatLeading" for\x3d"bingType:streets"\x3e\r\n              \x26nbsp;${i18n.bingStreets}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both; padding-top:5px;"\x3e\r\n            \x3cinput class\x3d"esriFloatLeading" type\x3d"radio" name\x3d"bingType" dojotype\x3d"dijit.form.RadioButton" id\x3d"bingType:imagery"/\x3e\r\n            \x3clabel class\x3d"esriFloatLeading" for\x3d"bingType:imagery"\x3e\r\n              \x26nbsp;${i18n.bingImagery}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both; padding-top:5px;"\x3e\r\n            \x3cinput class\x3d"esriFloatLeading" type\x3d"radio" name\x3d"bingType" dojotype\x3d"dijit.form.RadioButton" id\x3d"bingType:hybrid"/\x3e\r\n            \x3clabel class\x3d"esriFloatLeading" for\x3d"bingType:hybrid"\x3e\r\n              \x26nbsp;${i18n.bingHybrid}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv id\x3d"add-layer-note-div" style\x3d"margin-bottom: 0.2em;"\x3e\r\n          \x3cdiv class\x3d"esriItemLinks" style\x3d"margin-top:1em;"\x3e\r\n            \x3clabel id\x3d"add-layer-note"\x3e\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv id\x3d"add-layer-http-warning" style\x3d"margin-top:1em;display:none;padding:0.375rem 0.375rem;color:rgba(0, 0, 0, 0.75);background-color:#f3ded7;border:1px solid #e4a793;"\x3e${i18n.httpWarning}\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriFloatTrailing" style\x3d"margin-top: 1em;"\x3e\r\n          \x3cspan id\x3d"add-layer-url-loading" style\x3d"display:none;"\x3e${i18n.adding}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n          \x3cspan id\x3d"add-layer-url-capabilities" style\x3d"display:none;"\x3e${i18n.gettingCapabilities}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n          \x3cbutton type\x3d"submit" dojoAttachPoint\x3d"addButton" class\x3d"primary" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.addLayerBtn}\r\n          \x3c/button\x3e\r\n          \x3cbutton dojoAttachEvent\x3d"onClick:hide" dojoAttachPoint\x3d"cancelButton" class\x3d"jevent cancel" type\x3d"cancel" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv style\x3d"clear:both; width: 100%; height:1px;"\x3e\x3c/div\x3e\r\n\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                defaultArcGISTextUrl: "",
                defaultTextUrl: "",
                layerType: "arcgis",
                onExtentHandler: null,
                wfsService: null,
                wfsLayerParams: null,
                wmtsLayer: null,
                wmtsParameters: null,
                userTypingTimeout: null,
                helpMgr: null,
                util: arcgisonline.sharing.util,
                statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg); return this._instance } },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline",
                        "arcgisonline").common);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").viewer.wms);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").itemProperties);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").arcGISServerServices);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").addLayerFromUrlDlg);
                    this.defaultTextUrl = this.defaultArcGISTextUrl =
                        this.i18n.enterUrl
                },
                postCreate: function() {
                    this.helpMgr = arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance();
                    this.loadConnections();
                    g.byId("add-layer-url-url").set("value", this.defaultArcGISTextUrl);
                    if (esriGeowConfig.self.bingKey) {
                        var a = new esri.virtualearth.VETiledLayer({ bingMapsKey: esriGeowConfig.self.bingKey, mapStyle: esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL });
                        b.connect(a, "onLoad", b.hitch(this, function() { this.layerTypeSelect.addOption({ value: "bing", label: this.i18n.bing }) }));
                        b.connect(a, "onError", function() { delete esriGeowConfig.self.bingKey })
                    }
                },
                destroy: function() {
                    this.customRequestParams && this.customRequestParams.destroy();
                    this.customRequestParams = null;
                    this.selectLayers && this.selectLayers.destroy();
                    this.selectLayers = null;
                    this.inherited(arguments)
                },
                show: function() {
                    this.updateLayerType();
                    b.style(b.byId("add-layer-url-loading"), "display", "none");
                    b.style(b.byId("add-layer-url-capabilities"), "display", "none");
                    g.byId("add-layer-url-basemap-check").set("checked", !1);
                    this.cancelButton.set("disabled", !1);
                    esriGeowConfig.self.isPortal && b.style(b.byId("add-layer-note-div"), "display", "none");
                    g.byId("add-layer-url-dialog").show();
                    this.adjustDlg()
                },
                clear: function() { "arcgis" === this.layerTypeSelect.get("value") ? g.byId("add-layer-url-url").set("value", this.defaultArcGISTextUrl) : g.byId("add-layer-url-url").set("value", this.defaultTextUrl) },
                loadConnections: function() {
                    b.query(".jevent").connect("onclick", function(a) { a.preventDefault() });
                    b.connect(g.byId("add-layer-url-dialog"), "hide", this, "clear");
                    b.connect(b.byId("add-layer-url-url"),
                        "onfocus", this, "onFocus");
                    b.connect(b.byId("add-layer-url-form"), "onsubmit", this, "addLayer");
                    b.connect(b.byId("add-layer-url-form"), "onkeydown", this, "onKeyDown");
                    b.connect(this.layerTypeSelect, "onChange", b.hitch(this, "updateLayerType"));
                    b.subscribe("layerAddFailed", b.hitch(this, function() {
                        this.addButton.set("disabled", !1);
                        this.cancelButton.set("disabled", !1);
                        b.style(b.byId("add-layer-url-loading"), "display", "none");
                        b.style(b.byId("add-layer-url-capabilities"), "display", "none")
                    }))
                },
                updateLayerType: function() {
                    var a =
                        this.layerTypeSelect.get("value");
                    this.layerType = a;
                    this.addButton.set("disabled", !0);
                    b.style(b.byId("add-layer-url-webTiled"), "display", "none");
                    b.style(b.byId("add-layer-url-webTiled-help"), "display", "none");
                    b.style(b.byId("add-layer-url-customParams"), "display", "none");
                    b.style(b.byId("add-layer-url-customParamsGridDiv"), "display", "none");
                    b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters;
                    b.style(b.byId("add-layer-url-options"), "display", "none");
                    b.style(b.byId("add-layer-url-customParamsGridDiv"),
                        "display", "none");
                    b.style(b.byId("add-layer-url-browseLayers-options"), "display", "none");
                    b.style(b.byId("add-layer-url-getLayers-options"), "display", "none");
                    b.style(b.byId("add-layer-url-wms"), "display", "none");
                    b.style(b.byId("add-layer-url-wfs"), "display", "none");
                    b.style(b.byId("add-layer-url-wmts"), "display", "none");
                    b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", "none");
                    b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none");
                    b.style(b.byId("add-layer-url-gis"), "display",
                        "none");
                    b.style(b.byId("add-layer-url-layer-options"), "display", "none");
                    g.byId("add-layer-url-url").set("value", this.defaultTextUrl);
                    g.byId("add-layer-url-basemap-check").set("disabled", !1);
                    b.style(b.byId("add-layer-url"), "display", "");
                    b.style(b.byId("add-layer-bing"), "display", "none");
                    b.style(b.byId("add-layer-http-warning"), "display", "none");
                    this.customRequestParams && this.customRequestParams.destroy();
                    this.customRequestParams = null;
                    this.selectLayers && this.selectLayers.destroy();
                    this.selectLayers =
                        null;
                    if ("wfs" === a || "wms" === a || "wmts" === a) this.clearWFSLayersSelect(), this.clearWMTSLayersSelect(), this.clearWMTSTileMatrixSelect(), b.byId("add-layer-note").innerHTML = this.i18n.ogcHelp, b.style(b.byId("add-layer-url-customParams"), "display", ""), "wms" === a ? (b.byId("add-layer-url-customParamsGridText").innerHTML = this.i18n.customParametersMsg, b.style(b.byId("add-layer-url-basemap"), "display", "")) : ("wfs" === a ? (this._wfsAdvancedOptionsMaxFeatures.set("value", 3E3), this._wfsAdvancedOptionsSwapXY.set("checked", !1), b.byId("add-layer-url-customParamsGridText").innerHTML = this.i18n.customParametersSingleMsg, b.style(b.byId("add-layer-url-wfs-advancedOptions"), "display", "none")) : b.byId("add-layer-url-customParamsGridText").innerHTML = this.i18n.customParametersMsg, b.style(b.byId("add-layer-url-basemap"), "display", "none")), b.style(b.byId("add-layer-url-getLayers-options"), "display", ""), this.getLayersButton.set("disabled", !0), b.style(b.byId("add-layer-url-options"), "display", "");
                    else if ("webTiled" === a) b.byId("add-layer-note").innerHTML =
                        this.i18n.webTiledHelp, g.byId("add-layer-url-webTiled-title").set("value", ""), g.byId("add-layer-url-webTiled-credits").set("value", ""), g.byId("add-layer-url-webTiled-subdomains").set("value", ""), b.byId("add-layer-url-webTiled-extent-left").innerHTML = "", b.byId("add-layer-url-webTiled-extent-right").innerHTML = "", b.byId("add-layer-url-webTiled-extent-top").innerHTML = "", b.byId("add-layer-url-webTiled-extent-bottom").innerHTML = "", b.style(b.byId("add-layer-url-webTiled-extent-none"), "display", b.IE ? "inline" :
                            ""), b.style(b.byId("add-layer-url-webTiled-extent-valid"), "display", "none"), b.style(b.byId("add-layer-url-options"), "display", ""), b.style(b.byId("add-layer-url-basemap"), "display", ""), b.style(b.byId("add-layer-url-webTiled-subdomains-input"), "display", "none"), b.style(b.byId("add-layer-url-webTiled-subdomains-help"), "display", "none"), b.style(b.byId("add-layer-url-webTiled"), "display", b.IE ? "inline" : ""), b.style(b.byId("add-layer-url-webTiled-help"), "display", b.IE ? "inline" : "");
                    else if ("kml" === a) {
                        var c =
                            setInterval(b.hitch(this, function() { this.helpMgr.isLoaded() && (clearInterval(c), b.byId("add-layer-note").innerHTML = b.string.substitute(this.i18n.kmlHelp, { linkStart: "\x3cA href\x3d'" + this.helpMgr.getHelpUrl("120000471") + "' target\x3d'_blank'\x3e", linkEnd: "\x3c/A\x3e" })) }), 200);
                        b.style(b.byId("add-layer-url-options"), "display", "none")
                    } else "geoRSS" === a ? (b.byId("add-layer-note").innerHTML = this.i18n.geoRSSHelp, b.style(b.byId("add-layer-url-options"), "display", "none")) : "csv" === a ? (b.byId("add-layer-note").innerHTML =
                        this.i18n.csvHelp, b.style(b.byId("add-layer-url-options"), "display", "none")) : "bing" === a ? (b.byId("add-layer-note").innerHTML = "", b.style(b.byId("add-layer-url-options"), "display", "none"), b.style(b.byId("add-layer-url"), "display", "none"), b.style(b.byId("add-layer-bing"), "display", b.IE ? "inline" : ""), this.addButton.set("disabled", !1)) : (g.byId("add-layer-url-url").set("value", this.defaultArcGISTextUrl), b.byId("add-layer-note").innerHTML = "", b.style(b.byId("add-layer-url-options"), "display", ""), b.style(b.byId("add-layer-url-basemap"),
                        "display", ""), "arcgis" === a && (b.style(b.byId("add-layer-url-browseLayers-options"), "display", ""), this.getLayersButton.set("disabled", !0), this.clearGISLayersSelect()));
                    this.adjustDlg()
                },
                hide: function() {
                    arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().hide();
                    g.byId("add-layer-url-dialog").hide()
                },
                onKeyDown: function(a) {
                    var b;
                    window.event ? b = a.keyCode : a.which && (b = a.which);
                    13 != b || this.addButton.get("disabled") || this.addLayer(a)
                },
                addLayer: function(a) {
                    a.preventDefault();
                    arcgisonline.map.main.markMapAsChanged("AddLayerFromUrlDlg-addLayer");
                    b.style(b.byId("add-layer-url-loading"), "display", b.IE ? "inline" : "");
                    this.addButton.set("disabled", !0);
                    this.cancelButton.set("disabled", !0);
                    a = g.byId("imageryLayerType:dynamic").get("checked");
                    var c = g.byId("add-layer-url-url").get("value");
                    if (".kml" == c.toLowerCase().match(".kml$") || ".kmz" == c.toLowerCase().match(".kmz$")) arcgisonline.map.kml.addKMLLayer(c, null, b.hitch(this, function() {
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        this.hide()
                    }), b.hitch(this, function() { this.hide() }));
                    else if ("csv" == this.layerType || ".csv" == c.toLowerCase().match(".csv$") || ".txt" == c.toLowerCase().match(".txt$")) arcgisonline.map.fileImport.addCSVByReferenceLayer(c), "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel(), this.hide();
                    else if ("geoRSS" == this.layerType) arcgisonline.map.geoRSS.addGeoRSSLayer(c), "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel(),
                        this.hide();
                    else if ("webTiled" == this.layerType)(a = this.checkCanAddWebMerctorWebTiledLayer()) ? (c = c.replace(/{subdomain}/i, "{subDomain}"), c = c.replace(/{level}/i, "{level}"), c = c.replace(/{col}/i, "{col}"), c = c.replace(/{row}/i, "{row}"), (a = this.checkWebTiledProperties()) ? g.byId("add-layer-url-basemap-check").get("checked") ? arcgisonline.map.webTile.addWebTiledUrlAsBasemap(c, a, b.hitch(this, function() {
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        this.hide()
                    }), b.hitch(this, function() { this.hide() })) : arcgisonline.map.webTile.addWebTiledLayer(c, a, b.hitch(this, function() {
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        this.hide()
                    }), b.hitch(this, function() { this.hide() })) : (b.style(b.byId("add-layer-url-loading"), "display", "none"), this.addButton.set("disabled", !1), this.cancelButton.set("disabled", !1))) : (b.style(b.byId("add-layer-url-loading"), "display", "none"), this.addButton.set("disabled", !1), this.cancelButton.set("disabled", !1));
                    else if ("arcgis" == this.layerType) {
                        -1 !== c.toLowerCase().indexOf("token\x3d") && (this.util.isHostedService(c) || -1 !== c.indexOf("arcgis.com") && -1 !== c.indexOf("//utility")) && (c = this._stripParameters(c, ["token"]));
                        if (g.byId("add-layer-url-basemap-check").get("checked")) {
                            if (-1 < c.toLowerCase().indexOf("/featureserver") || -1 < c.toLowerCase().indexOf("/streamserver")) {
                                a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                                a.show({
                                    title: this.i18n.errorDlgTitle,
                                    message: this.i18n.errors.cantUseAsBasemap
                                });
                                b.style(b.byId("add-layer-url-loading"), "display", "none");
                                this.addButton.set("disabled", !1);
                                this.cancelButton.set("disabled", !1);
                                return
                            }
                            if (-1 < c.indexOf("/MapServer/") && c.lastIndexOf("/") != c.length - 1) {
                                a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                                a.show({ title: this.i18n.errorDlgTitle, message: this.i18n.errors.cantUseLayerAsBasemap });
                                b.style(b.byId("add-layer-url-loading"), "display", "none");
                                this.addButton.set("disabled", !1);
                                this.cancelButton.set("disabled", !1);
                                return
                            } - 1 < c.indexOf("/VectorTileServer") ? (c = arcgisonline.map.main.decodeUrl(c), arcgisonline.map.vectorTile.checkSupport().then(b.hitch(this, function(a) { a ? (a = arcgisonline.map.main.getTitleFromUrl(c), arcgisonline.map.main.basemapTitle = a, -1 === c.indexOf("root.json") && (c += (c.endsWith("/") ? "" : "/") + "resources/styles/root.json"), arcgisonline.map.vectorTile.addVectorTileAsBaseLayer({ styleUrl: c }, null, null, null, !0), this.hide()) : (b.publish("layerAddFailed", []), arcgisonline.map.vectorTile.displayErrorMessage({ title: c })) }))) :
                                arcgisonline.map.save_open.switchBaseMapByUrl(c)
                        } else -1 < c.indexOf("/VectorTileServer") ? (c = arcgisonline.map.main.decodeUrl(c), arcgisonline.map.vectorTile.checkSupport().then(b.hitch(this, function(a) { a ? (-1 === c.indexOf("root.json") && (c += (c.endsWith("/") ? "" : "/") + "resources/styles/root.json"), arcgisonline.map.vectorTile.addVectorTileLayer(c), this.hide()) : (b.publish("layerAddFailed", []), arcgisonline.map.vectorTile.displayErrorMessage({ title: c })) }))) : (c = arcgisonline.map.main.decodeUrl(c), -1 < c.indexOf("/dynamicLayer") &&
                            (c = c.substring(0, c.indexOf("/dynamicLayer"))), -1 < c.indexOf("/ImageServer") && this._imageServiceInfo && this._imageServiceInfo.url === c ? (this._imageServiceInfo.serviceInfo._preferDynamicImageryLayer = a, arcgisonline.map.save_open.addServiceByUrl(c, null, null, this._imageServiceInfo.serviceInfo)) : arcgisonline.map.save_open.addServiceByUrl(c, null));
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        this.hide()
                    } else "wfs" === this.layerType ? (c = this._stripParameters(c, ["version", "service", "request", "layer", "typename"]), a = arcgisonline.sharing.util.urlToObject(document.URL), "all" === this.wfsLayerParams && a.query && a.query.dev ? this.addAsWFS() : this.wfsLayerParams && c.startsWith(this.wfsLayerParams.url) ? (this.wfsLayerParams.maxFeatures = this._wfsAdvancedOptionsMaxFeatures.get("value"), this.wfsLayerParams.swapXY = this._wfsAdvancedOptionsSwapXY.get("checked"), this.addAsWFS()) : this.isArcGISWFS().then(b.hitch(this, "addAsArcGISService"), b.hitch(this, "getWFSInfo"))) : "wms" === this.layerType ?
                        this.isArcGISWMS().then(b.hitch(this, "addAsArcGISService"), b.hitch(this, "addAsWMS")) : "wmts" === this.layerType ? this.ArcGISServiceParamsForWMTS && this.ArcGISServiceParamsForWMTS.wmtsUrl === c ? this.addAsArcGISService(this.ArcGISServiceParamsForWMTS) : this.addAsWMTS() : "bing" == this.layerType ? (a = this.checkCanAddWebMerctorWebTiledLayer()) ? (a = { operationalLayers: [], baseMap: { title: "Bing Maps Road", baseMapLayers: [{ visibility: !0, opacity: 1, type: "BingMapsRoad" }] } }, g.byId("bingType:imagery").get("checked") ? (a.baseMap.title =
                            "Bing Maps Aerial", a.baseMap.baseMapLayers[0].type = "BingMapsAerial", a.baseMap.baseMapLayers[0].layerType = "BingMapsAerial") : g.byId("bingType:hybrid").get("checked") && (a.baseMap.title = "Bing Maps Hybrid", a.baseMap.baseMapLayers[0].type = "BingMapsHybrid", a.baseMap.baseMapLayers[0].layerType = "BingMapsHybrid"), arcgisonline.map.save_open.switchOrRecreateBasemap(a), "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel(), this.hide()) : (b.style(b.byId("add-layer-url-loading"),
                            "display", "none"), this.addButton.set("disabled", !1), this.cancelButton.set("disabled", !1)) : arcgisonline.map.kml.addKMLLayer(c, null, b.hitch(this, function() {
                            "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                            this.hide()
                        }), b.hitch(this, function() { this.hide() }))
                },
                onChangeUrl: function(a) {
                    "bing" !== this.layerTypeSelect.get("value") && (b.style(b.byId("add-layer-url-loading"), "display", "none"), b.style(b.byId("add-layer-url-capabilities"), "display",
                        "none"), b.style(b.byId("add-layer-url-wfs-advanced"), "display", "none"), b.style(b.byId("add-layer-url-wfs-geometryType"), "display", "none"), b.style(b.byId("add-layer-url-wfs-geometryTypeMsg"), "display", "none"), b.style(b.byId("add-layer-url-imagery-label"), "display", "none"), b.style(b.byId("add-layer-url-imagery-options"), "display", "none"), g.byId("imageryLayerType:tiled").set("checked", !0), this.addButton.set("disabled", !0), clearTimeout(this.userTypingTimeout), this.userTypingTimeout = setTimeout(b.hitch(this,
                        function() {
                            this.userTypingTimeout = null;
                            this.processUrl(a)
                        }), 1E3))
                },
                processUrl: function(a) {
                    a.startsWith("https://") ? b.style(b.byId("add-layer-http-warning"), "display", "none") : !arcgisonline.sharing.util.isPortal() && a.startsWith("http://") && 7 < a.length && b.style(b.byId("add-layer-http-warning"), "display", "");
                    a && a !== this.defaultArcGISTextUrl && a !== this.defaultTextUrl && 8 < a.length ? (a.endsWith("/") && (a = a.substring(0, a.length - 1), g.byId("add-layer-url-url").textbox.value = a), a.startsWith("http://") || a.startsWith("https://") ?
                        "wms" === this.layerType ? (b.style(b.byId("add-layer-url-wms"), "display", "none"), this.isArcGISWMS().then(b.hitch(this, function() { this.addButton.set("disabled", !1) }), b.hitch(this, function() {
                            this.getLayersButton.set("disabled", !1);
                            this.addButton.set("disabled", !1)
                        }))) : "wfs" === this.layerType ? (b.style(b.byId("add-layer-url-wfs"), "display", "none"), this.isArcGISWFS().then(b.hitch(this, "addAsArcGISServiceLater"), b.hitch(this, function() {
                            this.getLayersButton.set("disabled", !1);
                            this.addButton.set("disabled", !0)
                        }))) :
                        "wmts" === this.layerType ? (g.byId("add-layer-url-basemap-check").set("disabled", !1), b.style(b.byId("add-layer-url-wmts"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none"), b.style(b.byId("add-layer-url-layer-options"), "display", "none"), this.isArcGISWMTS().then(b.hitch(this, "addAsArcGISServiceLater"), b.hitch(this, function() {
                            this.getLayersButton.set("disabled", !1);
                            this.addButton.set("disabled", !0)
                        }))) :
                        "webTiled" === this.layerType ? (-1 < a.toLowerCase().indexOf("{subdomain}") ? (b.style(b.byId("add-layer-url-webTiled-subdomains-input"), "display", b.IE ? "inline" : ""), b.style(b.byId("add-layer-url-webTiled-subdomains-help"), "display", b.IE ? "inline" : "")) : (b.style(b.byId("add-layer-url-webTiled-subdomains-input"), "display", "none"), b.style(b.byId("add-layer-url-webTiled-subdomains-help"), "display", "none")), this.addButton.set("disabled", !1)) : (this.addButton.set("disabled", !1), b.style(b.byId("add-layer-url-gis"),
                            "display", "none"), "arcgis" === this.layerType && (this.browseLayersButton.set("disabled", !1), b.style(b.byId("add-layer-url-browseLayers-options"), "display", ""), -1 < a.indexOf("/ImageServer") && this.checkTiledImageService(a))) : (a = "https://" + a, g.byId("add-layer-url-url").set("value", a))) : ("arcgis" === this.layerType && (this.gisLayerSelectUrl !== g.byId("add-layer-url-url").get("value") && (this.browseLayersButton.set("disabled", !0), b.style(b.byId("add-layer-url-gis"), "display", "none"), b.style(b.byId("add-layer-url-browseLayers-options"),
                        "display", "")), -1 < a.indexOf("/ImageServer") && this.checkTiledImageService(a)), this.addButton.set("disabled", !0))
                },
                getLayers: function() {
                    "wms" === this.layerType ? (b.style(b.byId("add-layer-url-wms"), "display", "none"), this.getWMSInfo()) : "wfs" === this.layerType ? (b.style(b.byId("add-layer-url-wfs"), "display", "none"), this.getWFSInfo()) : "wmts" === this.layerType ? (g.byId("add-layer-url-layer-basemap-check").set("disabled", !1), b.style(b.byId("add-layer-url-wmts"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"),
                        "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none"), b.style(b.byId("add-layer-url-layer-options"), "display", "none"), this.getWMTSInfo()) : "arcgis" === this.layerType && (b.style(b.byId("add-layer-url-gis"), "display", "none"), this.getGISServerInfo())
                },
                setExtent: function() {
                    var a = arcgisonline.sharing.dijit.dialog.ExtentDlg.prototype.statics.getInstance(),
                        c = b.byId("add-layer-url-webTiled-extent-left").innerHTML,
                        d = b.byId("add-layer-url-webTiled-extent-bottom").innerHTML,
                        f = b.byId("add-layer-url-webTiled-extent-right").innerHTML,
                        e = b.byId("add-layer-url-webTiled-extent-top").innerHTML;
                    c && d && f && e ? a.show([
                        [parseFloat(c), parseFloat(d)],
                        [parseFloat(f), parseFloat(e)]
                    ]) : a.show([
                        [-180, -90],
                        [180, 90]
                    ]);
                    this.onExtentHandler || (this.onExtentHandler = b.subscribe("extent/update", b.hitch(this, "onExtentUpdate")))
                },
                onExtentUpdate: function(a) {
                    b.byId("add-layer-url-webTiled-extent-left").innerHTML = a[0][0];
                    b.byId("add-layer-url-webTiled-extent-bottom").innerHTML = a[0][1];
                    b.byId("add-layer-url-webTiled-extent-right").innerHTML = a[1][0];
                    b.byId("add-layer-url-webTiled-extent-top").innerHTML =
                        a[1][1];
                    b.style(b.byId("add-layer-url-webTiled-extent-none"), "display", "none");
                    b.style(b.byId("add-layer-url-webTiled-extent-valid"), "display", b.IE ? "inline" : "")
                },
                checkTiledImageService: function(a) {
                    a = arcgisonline.map.main.decodeUrl(a);
                    var c = b.hitch(this, function(c) {
                            if ("arcgis" === this.layerTypeSelect.get("value")) {
                                var d = g.byId("add-layer-url-url").get("value");
                                a === arcgisonline.map.main.decodeUrl(d) && (g.byId("add-layer-url-basemap-check").get("checked") || "Raster" !== c.cacheType || -1 !== c.capabilities.toLowerCase().indexOf("tilesonly") ?
                                    (b.style(b.byId("add-layer-url-imagery-label"), "display", "none"), b.style(b.byId("add-layer-url-imagery-options"), "display", "none")) : (b.style(b.byId("add-layer-url-imagery-label"), "display", ""), b.style(b.byId("add-layer-url-imagery-options"), "display", "")), this.addButton.set("disabled", !1), this._imageServiceInfo = { url: a, serviceInfo: c })
                            }
                        }),
                        d = b.hitch(this, function() {
                            if ("arcgis" === this.layerTypeSelect.get("value")) {
                                var c = g.byId("add-layer-url-url").get("value");
                                a === arcgisonline.map.main.decodeUrl(c) &&
                                    b.publish("layerAddFailed", []);
                                this._imageServiceInfo = null
                            }
                        });
                    arcgisonline.map.layer.getServiceInfo(a, null, c, d)
                },
                checkWebTiledProperties: function() {
                    var a = {},
                        c = g.byId("add-layer-url-webTiled-title").get("value"),
                        d = g.byId("add-layer-url-webTiled-credits").get("value"),
                        f = !1; - 1 < g.byId("add-layer-url-url").get("value").toLowerCase().indexOf("{subdomain}") && !g.byId("add-layer-url-webTiled-subdomains").get("value") && (f = !0);
                    if (!c || !d || f) return arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({
                        title: this.i18n.errorDlgTitle,
                        message: f ? this.i18n.errors.needWebTiledProps2 : this.i18n.errors.needWebTiledProps
                    }), null;
                    a.title = c;
                    a.copyright = d;
                    if (c = g.byId("add-layer-url-webTiled-subdomains").get("value")) a.subDomains = c.split(","), a.subDomains = b.map(a.subDomains, function(a) { return b.trim(a) });
                    var c = b.byId("add-layer-url-webTiled-extent-left").innerHTML,
                        d = b.byId("add-layer-url-webTiled-extent-bottom").innerHTML,
                        f = b.byId("add-layer-url-webTiled-extent-right").innerHTML,
                        e = b.byId("add-layer-url-webTiled-extent-top").innerHTML;
                    c && d &&
                        f && e && (c = new esri.geometry.Extent(parseFloat(c), parseFloat(d), parseFloat(f), parseFloat(e), new esri.SpatialReference({ wkid: 4326 })), a.fullExtent = esri.geometry.geographicToWebMercator(c));
                    return a
                },
                onChangeBasemap: function() {
                    if ("wmts" === this.layerType && this.wmtsLayer) {
                        var a = g.byId("add-layer-url-url").get("value");
                        a && a !== this.defaultTextUrl && a !== this.defaultArcGISTextUrl && (a = this.wmtsLayerSelect.get("value"), -1 !== a && this.setWMTSLayer(a))
                    }
                },
                onChangeGISBasemap: function() {
                    if ("arcgis" === this.layerType) {
                        var a =
                            g.byId("add-layer-url-url").get("value");
                        if (this._imageServiceInfo && this._imageServiceInfo.url === arcgisonline.map.main.decodeUrl(a)) {
                            var a = g.byId("add-layer-url-basemap-check").get("checked"),
                                c = this._imageServiceInfo.serviceInfo;
                            a || "Raster" !== c.cacheType || -1 !== c.capabilities.toLowerCase().indexOf("tilesonly") ? (b.style(b.byId("add-layer-url-imagery-label"), "display", "none"), b.style(b.byId("add-layer-url-imagery-options"), "display", "none")) : (b.style(b.byId("add-layer-url-imagery-label"), "display", ""),
                                b.style(b.byId("add-layer-url-imagery-options"), "display", ""))
                        }
                    }
                },
                isArcGISWFS: function() {
                    var a, c = g.byId("add-layer-url-url").get("value"),
                        d = c.toLowerCase(),
                        f = new b.Deferred,
                        e = function(d, e, g) {
                            a = e;
                            f.callback({ url: a, wfsUrl: c, serviceInfo: d });
                            b.style(b.byId("add-layer-url-customParams"), "display", "none");
                            b.style(b.byId("add-layer-url-customParamsGridDiv"), "display", "none");
                            b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters
                        },
                        h = function(a) { f.errback(null) },
                        m = d.indexOf("/mapserver/"); -
                    1 < d.indexOf("/arcgis/services/") && -1 < m ? (a = c.substring(0, m + 10), a = a.replace("/arcgis/services/", "/arcgis/rest/services/"), arcgisonline.map.layer.getServiceInfo(a, null, b.hitch(this, e), h)) : f.errback(null);
                    return f
                },
                isArcGISWMTS: function() {
                    var a, c = g.byId("add-layer-url-url").get("value"),
                        d = c.toLowerCase(),
                        f = d.indexOf("/1.0.0/wmtscapabilities.xml"); - 1 < f && (c = c.substring(0, f), d = c.toLowerCase(), g.byId("add-layer-url-url").set("value", c));
                    var e = new b.Deferred,
                        f = function(d, f, g) {
                            d && !d.layers && e.errback(null);
                            a = f;
                            e.callback({ url: a, wmtsUrl: c, serviceInfo: d });
                            b.style(b.byId("add-layer-url-customParams"), "display", "none");
                            b.style(b.byId("add-layer-url-customParamsGridDiv"), "display", "none");
                            b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters
                        },
                        h = function(a, b) { e.errback(null) },
                        m = d.indexOf("/mapserver/"),
                        n = d.indexOf("/imageserver/"); - 1 < d.indexOf("/rest/services/") && (-1 < m || -1 < n) ? (a = c.substring(0, -1 < m ? m + 10 : n + 12), arcgisonline.map.layer.getServiceInfo(a, null, f, h)) : e.errback(null);
                    return e
                },
                isArcGISWMS: function() {
                    var a, c = g.byId("add-layer-url-url").get("value");
                    (esriGeowConfig.allSSL || "https:" == location.protocol) && arcgisonline.sharing.util.supportsHttps(c) && (c = c.replace("http:", "https:"));
                    var d = c.toLowerCase(),
                        f = new b.Deferred,
                        e = function(c, d, e) {
                            a = d;
                            f.callback({ url: a, serviceInfo: c });
                            b.style(b.byId("add-layer-url-customParams"), "display", "none");
                            b.style(b.byId("add-layer-url-customParamsGridDiv"), "display", "none");
                            b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters
                        },
                        h = function(a) { f.errback(null) },
                        m = d.indexOf("/mapserver/wmsserver"),
                        n = d.indexOf("/imageserver/wmsserver"),
                        r = d.indexOf("/wmsserver"); - 1 < d.indexOf("/services/") && (-1 < m || -1 < n || -1 < r) ? (a = -1 < m || -1 < n ? c.substring(0, -1 < m ? m + 10 : n + 12) : c.substring(0, r) + "/MapServer", -1 === d.indexOf("/rest/services/") && (a = a.replace("/services/", "/rest/services/")), arcgisonline.map.layer.getServiceInfo(a, null, e, h)) : f.errback(null);
                    return f
                },
                addAsArcGISService: function(a) {
                    g.byId("add-layer-url-basemap-check").get("checked") ? arcgisonline.map.save_open.switchBaseMapByUrl(a.url,
                        a.serviceInfo) : arcgisonline.map.save_open.addServiceByUrl(a.url, null, !1, a.serviceInfo);
                    "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                    this.hide()
                },
                addAsArcGISServiceLater: function(a) { this.addButton.set("disabled", !1); "wmts" === this.layerType && (this.ArcGISServiceParamsForWMTS = a) },
                toggleCustomParams: function() {
                    var a = b.byId("add-layer-url-customParamsGridDiv");
                    "none" === b.style(a, "display") ? (b.style(a, "display", ""), this.customRequestParams ||
                            (a = {}, "wfs" === this.layerType && (a = { onlyCustomParameters: !0 }), this.customRequestParams = new arcgisonline.sharing.dijit.CustomRequestParameters(a, b.create("div", {}, "add-layer-url-customParamsGrid")), this.customRequestParams.startup(), this.customRequestParams.on("changed", b.hitch(this, function() {
                                if ("wms" === this.layerType && this.wmsLayer || "wmts" === this.layerType && this.wmtsLayer || "wfs" === this.layerType && this.wfsService) {
                                    var a = g.byId("add-layer-url-url").get("value");
                                    if (a && a !== this.defaultTextUrl && a !== this.defaultArcGISTextUrl) {
                                        var d;
                                        "wms" === this.layerType ? (d = this.wmsLayer.customParameters, this.addButton.set("disabled", !1)) : "wmts" === this.layerType ? d = this.wmtsLayer.customParameters : "wfs" === this.layerType && (d = this.wfsService.customParameters);
                                        if ((a = this.customRequestParams.getCustomParameters()) && d !== a.customParameters || (!a || !a.customParameters) && d) b.style(b.byId("add-layer-url-wms"), "display", "none"), b.style(b.byId("add-layer-url-wfs"), "display", "none"), b.style(b.byId("add-layer-url-wmts"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"),
                                            "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none"), b.style(b.byId("add-layer-url-layer-options"), "display", "none"), b.style(b.byId("add-layer-url-wfs-advanced"), "display", "none"), b.style(b.byId("add-layer-url-wfs-geometryType"), "display", "none"), b.style(b.byId("add-layer-url-wfs-geometryTypeMsg"), "display", "none"), this.getLayersButton.set("disabled", !1), this.wfsService = this.wmtsLayer = this.wmsLayer = null
                                    }
                                }
                            }))), b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.hideCustomParameters) :
                        (b.style(a, "display", "none"), b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters);
                    this.adjustDlg()
                },
                getWMSInfo: function() {
                    var a = g.byId("add-layer-url-url").get("value"),
                        c = null,
                        d = esri.urlToObject(a);
                    if (d && d.query)
                        for (var f in d.query)
                            if ("layers" === f.toLowerCase()) { c = d.query[f].split(","); break }
                    a = this._stripParameters(a, "service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
                    d = {};
                    if (f = this.customRequestParams &&
                        this.customRequestParams.getCustomParameters()) {
                        var e = [];
                        if (f.customParameters)
                            for (parameter in d.customParameters = f.customParameters, f.customParameters) e.push(parameter);
                        if (f.customLayerParameters)
                            for (parameter in d.customLayerParameters = f.customLayerParameters, f.customLayerParameters) e.push(parameter);
                        e.length && (a = this._stripParameters(a, e))
                    }
                    this.wmsLayer = new esri.layers.WMSLayer(a, d);
                    d = function(c) {
                        this.getLayersButton.set("disabled", !0);
                        this.addButton.set("disabled", !0);
                        arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({
                            title: esri.i18nBundle.generalDlg.errorDlgTitle,
                            message: b.string.substitute(this.i18n.invalidUrl, { url: a })
                        })
                    };
                    this.onError && b.disconnect(this.onError);
                    this.onError = b.connect(this.wmsLayer, "onError", b.hitch(this, d));
                    if (!this.wmsLayer.loaded && this.wmsLayer.loadError) d(this.wmsLayer.loadError);
                    else if (this.wmsLayer.loaded) this.onWMSLayerLoadHandler(c);
                    else b.connect(this.wmsLayer, "onLoad", b.hitch(this, "onWMSLayerLoadHandler", c))
                },
                onWMSLayerLoadHandler: function(a) {
                    arcgisonline.map.wms.organizeLayerStructure(this.wmsLayer);
                    b.style(b.byId("add-layer-url-wms"),
                        "display", "");
                    this.selectLayers && this.selectLayers.destroy();
                    this.selectLayers = new arcgisonline.sharing.dijit.SelectLayers({}, b.create("div", {}, "add-layer-url-wms-layers"));
                    this.selectLayers.startup(this.wmsLayer.layerInfos, a, !0);
                    this.selectLayers.on("changed", b.hitch(this, function() {
                        var a = this.selectLayers ? this.selectLayers.getSelectedLayers() : [];
                        this.wmsLayer && !a.length ? this.addButton.set("disabled", !0) : this.addButton.set("disabled", !1)
                    }));
                    this.getLayersButton.set("disabled", !0);
                    this.adjustDlg()
                },
                addAsWMS: function() {
                    var a = g.byId("add-layer-url-url").get("value"),
                        c = null,
                        d = null,
                        f = this.selectLayers ? this.selectLayers.getSelectedLayers() : [];
                    if (this.wmsLayer && f.length) d = arcgisonline.map.wms.buildConfig(this.wmsLayer, !0), d.layerInfos = f, c = [f[0].name], d.getMapURL = d.mapUrl, d.getFeatureInfoURL = d.featureInfoUrl, d.featureInfoFormat = d.featureInfoFormat, d.extent = new esri.geometry.Extent(d.extent[0][0], d.extent[0][1], d.extent[1][0], d.extent[1][1], new esri.SpatialReference({ wkid: 4326 }));
                    else if ((f = esri.urlToObject(a)) &&
                        f.query)
                        for (var e in f.query)
                            if ("layers" === e.toLowerCase()) { c = f.query[e].split(","); break }
                    a = this._stripParameters(a, "service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
                    if (e = this.customRequestParams && this.customRequestParams.getCustomParameters()) {
                        f = [];
                        if (e.customParameters)
                            for (parameter in e.customParameters) f.push(parameter);
                        if (e.customLayerParameters)
                            for (parameter in e.customLayerParameters) f.push(parameter);
                        f.length &&
                            (a = this._stripParameters(a, f))
                    }
                    g.byId("add-layer-url-basemap-check").get("checked") ? arcgisonline.map.wms.addWMSUrlAsBasemap(a, { resourceInfo: d, customParameters: e && e.customParameters, customLayerParameters: e && e.customLayerParameters }, b.hitch(this, function() {
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        this.hide()
                    }), b.hitch(this, function() {
                        b.style(b.byId("add-layer-url-loading"), "display", "none");
                        this.addButton.set("disabled", !0);
                        this.cancelButton.set("disabled", !1)
                    })) : (a = this._stripParameters(a, ["version"]), arcgisonline.map.wms.addWMSService({ url: a, visibleLayers: c, resourceInfo: d, customParameters: e && e.customParameters, customLayerParameters: e && e.customLayerParameters }, "urlDlg", b.hitch(this, function() {
                            "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                            this.hide()
                        }), b.hitch(this, function() { this.hide() })), "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() &&
                        arcgisonline.map.leftPanel.openLeftTOCPanel());
                    a = b.byId("add-layer-url-customParamsGridDiv");
                    b.style(a, "display", "none");
                    b.byId("add-layer-url-customParamsText").innerHTML = this.i18n.addCustomParameters;
                    this.customRequestParams && this.customRequestParams.destroy();
                    this.customRequestParams = null;
                    this.selectLayers && this.selectLayers.destroy();
                    this.selectLayers = null
                },
                addAsWMTS: function() {
                    g.byId("add-layer-url-url").get("value");
                    if (g.byId("add-layer-url-layer-basemap-check").get("checked") || !arcgisonline.map.main.sameSpatialReference(this.wmtsParameters.tileInfo.spatialReference,
                            arcgisonline.map.main.map.spatialReference)) {
                        var a = this.addCustomParametersToWMTSInfo(this.wmtsParameters);
                        arcgisonline.map.webTile.addWebTiledUrlAsBasemap(this.wmtsParameters.templateUrl, a, b.hitch(this, function() {
                            "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                            this.hide()
                        }), b.hitch(this, function() { this.hide() }))
                    } else a = this.addCustomParametersToWMTSInfo(this.wmtsParameters), arcgisonline.map.webTile.addWebTiledLayer(this.wmtsParameters.templateUrl,
                        a, b.hitch(this, function() {
                            "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                            this.hide()
                        }), b.hitch(this, function() { this.hide() })), "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel()
                },
                getWMTSInfo: function() {
                    var a = g.byId("add-layer-url-url").get("value");
                    b.style(b.byId("add-layer-url-capabilities"), "display", b.IE ? "inline" : "");
                    var c = {},
                        d = arcgisonline.sharing.util.urlToObject(a);
                    if (d.query) {
                        var f, e, h;
                        for (h in d.query) "service" === h.toLowerCase() ? f = h : "request" === h.toLowerCase() && (e = h);
                        f && e && d.query[f] && "wmts" === d.query[f].toLowerCase() && d.query[e] && "getcapabilities" === d.query[e].toLowerCase() && (c = { serviceMode: "KVP" })
                    }
                    a = this._stripParameters(a, "version service request layer style format tilematrixset tilematrix tilerow tilecol".split(" "));
                    (d = this.customRequestParams && this.customRequestParams.getCustomParameters()) && (d.customParameters || d.customLayerParameters) && (d.customParameters &&
                        (c.customParameters = d.customParameters), d.customLayerParameters && (c.customLayerParameters = d.customLayerParameters));
                    this.wmtsLayer = new esri.layers.WMTSLayer(a, c);
                    var m = function(a) {
                            b.style(b.byId("add-layer-url-capabilities"), "display", "none");
                            this.clearWMTSLayersSelect();
                            this.wmtsLayerSelect.addOption({ label: this.i18n.chooseWMTSLayer, value: -1 });
                            0 < a.layers.length && (b.forEach(a.layers, function(a, b) { this.wmtsLayerSelect.addOption({ label: a.title || a.identifier, value: "" + b }) }, this), b.style(b.byId("add-layer-url-wmts"),
                                "display", ""), b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none"), b.style(b.byId("add-layer-url-layer-options"), "display", ""), this.getLayersButton.set("disabled", !0), 1 == a.layers.length && this.wmtsLayerSelect.set("value", 0), this.adjustDlg())
                        },
                        n = function(d) {
                            b.disconnect(e);
                            r && b.disconnect(r);
                            this.wmtsLayer = null;
                            if (c.serviceMode) b.style(b.byId("add-layer-url-capabilities"), "display", "none"), arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({
                                title: esri.i18nBundle.generalDlg.errorDlgTitle,
                                message: b.string.substitute(this.i18n.errors.invalidWMTSUrl, { url: a })
                            });
                            else {
                                c.serviceMode = "KVP";
                                this.wmtsLayer = new esri.layers.WMTSLayer(a, c);
                                var e = b.connect(this.wmtsLayer, "onError", b.hitch(this, n));
                                this.wmtsLayer.loaded ? m(this.wmtsLayer) : b.connect(this.wmtsLayer, "onLoad", b.hitch(this, m))
                            }
                        };
                    b.connect(this.wmtsLayer, "onError", b.hitch(this, n));
                    var r = null;
                    this.wmtsLayer.loaded ? m(this.wmtsLayer) : r = b.connect(this.wmtsLayer, "onLoad", b.hitch(this, m))
                },
                clearWMTSLayersSelect: function() {
                    var a = this.wmtsLayerSelect.getOptions();
                    b.forEach(a, function(a) { this.wmtsLayerSelect.removeOption(a) }, this)
                },
                clearWMTSTileMatrixSelect: function() {
                    var a = this.wmtsTileMatrixSelect.getOptions();
                    b.forEach(a, function(a) { this.wmtsTileMatrixSelect.removeOption(a) }, this)
                },
                setWMTSLayer: function(a) {
                    a = parseInt(a); - 1 < a ? this.buildWMTSParameters(this.wmtsLayer.layers[a]) : (delete this.wmtsParameters, b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", "none"), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none"), g.byId("add-layer-url-layer-basemap-check").set("disabled", !1), this.addButton.set("disabled", !0))
                },
                buildWMTSParameters: function(a) {
                    b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", "none");
                    b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", "none");
                    var c = "";
                    this.wmtsLayer.copyright && "none" !== this.wmtsLayer.copyright.toLowerCase() && (c = this.wmtsLayer.copyright, 180 < this.wmtsLayer.copyright.length && (c = this.wmtsLayer.copyright.substring(0, 180) + esri.i18nBundle.viewer.shortenedTextEnding));
                    var d = {
                            id: "WMTS_" + Math.floor(10001 * Math.random()),
                            visibility: !0,
                            opacity: 1,
                            identifier: a.identifier,
                            gcsExtent: a.gcsExtent,
                            description: a.description,
                            title: a.title,
                            copyright: c
                        },
                        f = arcgisonline.map.main.defaultService.layer.tileInfo;
                    b.forEach(a.tileMatrixSetInfos, function(c) {
                        if (!d.templateUrl) {
                            if (96 != c.tileInfo.dpi) {
                                for (var e = 0; e < c.tileInfo.lods.length; e++) {
                                    var g = c.tileInfo.lods[e];
                                    g.scale = 96 * g.scale / c.tileInfo.dpi
                                }
                                c.tileInfo.dpi = 96
                            }
                            arcgisonline.map.main.sameSpatialReference(c.tileInfo.spatialReference, arcgisonline.map.main.map.spatialReference) && (!f || f && arcgisonline.map.main.sameTilingScheme(c.tileInfo,
                                arcgisonline.map.main.defaultService.layer.tileInfo)) && (d.fullExtent = c.fullExtent, b.some(arcgisonline.map.wms._WEB_MERCATOR, function(a) { return a === c.tileInfo.spatialReference.wkid }) ? (a.gcsExtent = a.gcsExtent.intersects(new esri.geometry.Extent(-179, -89, 179, 89, new esri.SpatialReference({ wkid: 4326 }))), d.fullExtent = esri.geometry.geographicToWebMercator(a.gcsExtent)) : d.fullExtent = 4326 === c.tileInfo.spatialReference.wkid ? a.gcsExtent : c.fullExtent, d.minScale = c.tileInfo.lods[0].scale, d.maxScale = c.tileInfo.lods[c.tileInfo.lods.length -
                                1].scale, d.tileInfo = c.tileInfo, this.wmtsLayer.resourceUrls = a.resourceUrls, e = -1 < b.indexOf(a.formats, "image/png") ? "image/png" : a.formats[0], d.templateUrl = this.wmtsLayer.getTileUrlTemplate({ identifier: a.identifier, tileMatrixSet: c.tileMatrixSet, format: e }), d.wmtsInfo = { url: this.wmtsLayer.url, layerIdentifier: a.identifier, tileMatrixSet: c.tileMatrixSet })
                        }
                    }, this);
                    g.byId("add-layer-url-layer-basemap-check").get("checked") ? d.templateUrl ? (this.wmtsParameters = d, this.addButton.set("disabled", !1)) : (c = function(a) {
                        arcgisonline.map.save_open.checkIfOpLayersFitToNewBasemap(a.tileInfo.spatialReference, { tileInfo: a.tileInfo }) ? (this.wmtsParameters = a, this.addButton.set("disabled", !1)) : (delete this.wmtsParameters, this.addButton.set("disabled", !0))
                    }, 1 === a.tileMatrixSetInfos.length ? this.useTileMatrixSet(a.tileMatrixSetInfos[0], d, a, b.hitch(this, c)) : (this.clearWMTSTileMatrixSelect(), b.forEach(a.tileMatrixSetInfos, function(a, b) { this.wmtsTileMatrixSelect.addOption({ label: a.tileMatrixSet, value: "" + b }) }, this), this.wmtsTileMatrixSelectHandler && b.disconnect(this.wmtsTileMatrixSelectHandler), this.wmtsTileMatrixSelectHandler =
                        b.connect(this.wmtsTileMatrixSelect, "onChange", b.hitch(this, "setWMTSTileMatrix", a.tileMatrixSetInfos, d, a, b.hitch(this, c))), this.wmtsTileMatrixSelect.set("value", 0), !0 === g.byId("add-layer-url-layer-basemap-check").get("disabled") && b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", ""), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", ""), this.adjustDlg())) : (c = function(c) {
                        c.templateUrl ? (this.wmtsParameters = c, this.addButton.set("disabled", !1)) : (delete this.wmtsParameters, this.addButton.set("disabled", !0), arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(this.i18n.errors.wmtsDoesntAlign, { url: g.byId("add-layer-url-url").get("value"), layer: a.title || a.identifier }) }))
                    }, d.templateUrl ? b.hitch(this, c, d)() : 0 === arcgisonline.map.main.numOperationalLayers() && "defaultBasemap" === arcgisonline.map.main.mapLayers[0].id ? (g.byId("add-layer-url-layer-basemap-check").set("checked", !0), g.byId("add-layer-url-layer-basemap-check").set("disabled", !0), 1 === a.tileMatrixSetInfos.length ? this.useTileMatrixSet(a.tileMatrixSetInfos[0], d, a, b.hitch(this, c)) : (this.clearWMTSTileMatrixSelect(), b.forEach(a.tileMatrixSetInfos, function(a, b) { this.wmtsTileMatrixSelect.addOption({ label: a.tileMatrixSet, value: "" + b }) }, this), this.wmtsTileMatrixSelectHandler && b.disconnect(this.wmtsTileMatrixSelectHandler), this.wmtsTileMatrixSelectHandler = b.connect(this.wmtsTileMatrixSelect, "onCchange", b.hitch(this, this.setWMTSTileMatrix, a.tileMatrixSetInfos, d, a, b.hitch(this, c))),
                        this.wmtsTileMatrixSelect.set("value", 0), b.style(b.byId("add-layer-url-wmts-tileMatrixMsg"), "display", ""), b.style(b.byId("add-layer-url-wmts-tileMatrix"), "display", ""), this.adjustDlg())) : b.hitch(this, c, d)())
                },
                useTileMatrixSet: function(a, c, d, f) {
                    c.fullExtent = a.fullExtent;
                    b.some(arcgisonline.map.wms._WEB_MERCATOR, function(b) { return b === a.tileInfo.spatialReference.wkid }) ? (d.gcsExtent = d.gcsExtent.intersects(new esri.geometry.Extent(-179, -89, 179, 89, new esri.SpatialReference({ wkid: 4326 }))), c.fullExtent =
                        esri.geometry.geographicToWebMercator(d.gcsExtent)) : c.fullExtent = 4326 === a.tileInfo.spatialReference.wkid ? d.gcsExtent : a.fullExtent;
                    c.minScale = a.tileInfo.lods[0].scale;
                    c.maxScale = a.tileInfo.lods[a.tileInfo.lods.length - 1].scale;
                    c.tileInfo = a.tileInfo;
                    this.wmtsLayer.resourceUrls = d.resourceUrls;
                    var e = -1 < b.indexOf(d.formats, "image/png") ? "image/png" : d.formats[0];
                    c.templateUrl = this.wmtsLayer.getTileUrlTemplate({ identifier: d.identifier, tileMatrixSet: a.tileMatrixSet, format: e });
                    c.wmtsInfo = {
                        url: this.wmtsLayer.url,
                        layerIdentifier: d.identifier,
                        tileMatrixSet: a.tileMatrixSet
                    };
                    f(c)
                },
                setWMTSTileMatrix: function(a, b, d, f, e) { e = parseInt(e); - 1 < e && this.useTileMatrixSet(a[e], b, d, f) },
                addCustomParametersToWMTSInfo: function(a) {
                    var c = this.customRequestParams && this.customRequestParams.getCustomParameters();
                    if (c) {
                        if (c.customParameters || c.customLayerParameters) a = b.clone(a);
                        c.customParameters && (a.wmtsInfo.customParameters = c.customParameters);
                        c.customLayerParameters && (a.wmtsInfo.customLayerParameters = c.customLayerParameters)
                    }
                    return a
                },
                addAsWFS: function(a) {
                    a = a || this.wfsLayerParams;
                    if ("all" === a) {
                        var c = function(c) {
                                for (var d = c; d < Math.min(c + 5, this.wfsService.layers.length); d++) {
                                    a = this.wfsService.layers[d];
                                    var e = arcgisonline.map.main.map.spatialReference.wkid;
                                    if (-1 === g && arcgisonline.map.main.map.spatialReference.latestWkid) {
                                        var f = arcgisonline.map.main.map.spatialReference.latestWkid,
                                            g = b.indexOf(this.wfsLayerParams.spatialReferences, f); - 1 < g && (e = f)
                                    }
                                    if (-1 === b.indexOf(a.spatialReferences, e) && -1 === b.indexOf(arcgisonline.map.wms._GCS, e) &&
                                        !arcgisonline.map.main.map.spatialReference.isWebMercator()) break;
                                    var g = b.indexOf(a.spatialReferences, e); - 1 < g && (f = b.filter(a.spatialReferences, function(a) { return a !== e }), a.spatialReferences = f, a.spatialReferences.unshift(e), -1 < b.indexOf(a.spatialReferences, e) ? a.wkid = e : -1 < b.indexOf(arcgisonline.map.wms._GCS, e) ? a.wkid = 4326 : arcgisonline.map.main.map.spatialReference.isWebMercator() && (a.wkid = 3857));
                                    f = this.wfsService.toJson();
                                    a.url = f.url;
                                    a.version = f.version;
                                    this.addAsWFS(a)
                                }
                            },
                            d = 0;
                        b.hitch(this, c, d)();
                        var f =
                            setInterval(b.hitch(this, function() {
                                d += 5;
                                d < this.wfsService.layers.length - 1 ? b.hitch(this, c, d)() : clearInterval(f)
                            }), 5E3)
                    } else {
                        var e = { url: a.url, title: a.title, wfsInfo: { version: a.version, name: a.name, maxFeatures: a.maxFeatures, swapXY: a.swapXY, supportedSpatialReferences: a.spatialReferences }, layerDefinition: { geometryType: a.geometryType, spatialReference: { wkid: a.wkid } } };
                        a.extent && 4 === a.extent.length && (e.wfsInfo.gcsExtent = new esri.geometry.Extent(a.extent[0], a.extent[1], a.extent[2], a.extent[3]));
                        var g = this.customRequestParams &&
                            this.customRequestParams.getCustomParameters();
                        g && g.customParameters && (e.wfsInfo.customParameters = g.customParameters);
                        arcgisonline.map.wfs.addWFSLayer(e).then(b.hitch(this, function() {
                            "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                            this.hide()
                        }), b.hitch(this, function() { this.hide() }));
                        "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel();
                        b.style(b.byId("add-layer-url-wfs-advancedOptions"),
                            "display", "none");
                        b.byId("add-layer-url-wfs-advancedText").innerHTML = this.i18n.showAvancedOptions;
                        this.customRequestParams && this.customRequestParams.destroy();
                        this.customRequestParams = null
                    }
                },
                getWFSInfo: function() {
                    var a = g.byId("add-layer-url-url").get("value");
                    b.style(b.byId("add-layer-url-capabilities"), "display", b.IE ? "inline" : "");
                    var c = "2.0.0",
                        d, f = arcgisonline.sharing.util.urlToObject(a.toLowerCase());
                    f.query && f.query.version && (c = f.query.version);
                    f.query && (f.query.typeName || f.query.typename) && (d =
                        f.query.typeName || f.query.typename);
                    var a = this._stripParameters(a, ["version", "service", "request", "layer", "typename"]),
                        e = function(c) {
                            this.wfsLayerParams && this.wfsLayerParams.name ? (c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(this.i18n.errors.cantAddWFS, { title: this.wfsLayerParams.title || this.wfsLayerParams.name }) })) : "2.0.0" === this.wfsService.toJson().version ? (c = { version: "1.1.0", url: a },
                                this.getWFSInfoInitialize(c, null, e)) : "1.1.0" === this.wfsService.toJson().version ? (c = { version: "1.0.0", url: a }, this.getWFSInfoInitialize(c, null, e)) : (b.style(b.byId("add-layer-url-capabilities"), "display", "none"), c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.showWide({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(this.i18n.errors.invalidWFSUrl, { url: a }) }))
                        },
                        c = { version: c, url: a };
                    (f = this.customRequestParams && this.customRequestParams.getCustomParameters()) &&
                    f.customParameters && (c.customParameters = f.customParameters);
                    delete this.wfsLayerParams;
                    this.wfsService = new esri.layers.WFSLayer;
                    b.connect(this.wfsService, "onError", b.hitch(this, e));
                    this.getWFSInfoInitialize(c, d, b.hitch(this, e))
                },
                getWFSInfoInitialize: function(a, c, d) {
                    this.wfsService.initialize(a, b.hitch(this, function(a) {
                        if ((this.wfsService.layers = a) && a.length) {
                            this.clearWFSLayersSelect();
                            this.wfsLayerSelect.addOption({ label: this.i18n.chooseWMTSLayer, value: -1 });
                            var d = arcgisonline.sharing.util.urlToObject(document.URL);
                            d.query && d.query.dev && this.wfsLayerSelect.addOption({ label: "*** All (" + a.length + ") ***", value: -2 });
                            b.forEach(a, function(a, b) { this.wfsLayerSelect.addOption({ label: a.title || a.name, value: "" + b }) }, this);
                            b.style(b.byId("add-layer-url-wfs"), "display", "");
                            this.getLayersButton.set("disabled", !0);
                            1 === a.length ? this.wfsLayerSelect.set("value", 0) : c && (d = c.indexOf(":"), -1 < d && (c = c.substring(d + 1)), b.forEach(a, function(a, b) { c === a.name.toLowerCase() && this.wfsLayerSelect.set("value", b) }, this))
                        } else arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({
                            title: esri.i18nBundle.generalDlg.errorDlgTitle,
                            message: b.string.substitute(this.i18n.errors.wfsNoLayers, { url: this.wfsService.toJson().url })
                        });
                        this.adjustDlg()
                    }));
                    b.style(b.byId("add-layer-url-capabilities"), "display", "none")
                },
                clearWFSLayersSelect: function() {
                    var a = this.wfsLayerSelect.getOptions();
                    b.forEach(a, function(a) { this.wfsLayerSelect.removeOption(a) }, this)
                },
                toggleWFSAdvancedOptions: function() {
                    var a = b.byId("add-layer-url-wfs-advancedOptions");
                    "none" === b.style(a, "display") ? (b.style(a, "display", ""), b.byId("add-layer-url-wfs-advancedText").innerHTML =
                        this.i18n.hideAvancedOptions) : (b.style(a, "display", "none"), b.byId("add-layer-url-wfs-advancedText").innerHTML = this.i18n.showAvancedOptions);
                    this.adjustDlg()
                },
                setWFSLayer: function(a) {
                    a = parseInt(a);
                    if (-2 === a) this.wfsLayerParams = "all", this.addButton.set("disabled", !1);
                    else if (-1 < a) {
                        this.wfsLayerParams = this.wfsService.layers[a];
                        var c = arcgisonline.map.main.map.spatialReference.wkid,
                            d = b.indexOf(this.wfsLayerParams.spatialReferences, c);
                        if (-1 === d && arcgisonline.map.main.map.spatialReference.latestWkid) {
                            var f =
                                arcgisonline.map.main.map.spatialReference.latestWkid,
                                d = b.indexOf(this.wfsLayerParams.spatialReferences, f); - 1 < d && (c = f)
                        } - 1 < d ? (this.wfsLayerParams.wkid = c, d = b.filter(this.wfsLayerParams.spatialReferences, function(a) { return a !== c }), this.wfsLayerParams.spatialReferences = d, this.wfsLayerParams.spatialReferences.unshift(c)) : (d = b.indexOf(arcgisonline.map.wms._GCS, c), -1 < d ? this.wfsLayerParams.wkid = 4326 : arcgisonline.map.main.map.spatialReference.isWebMercator() && (this.wfsLayerParams.wkid = -1 < b.indexOf(this.wfsLayerParams.spatialReferences,
                            3857) ? 3857 : 4326));
                        this.wfsLayerParams.wkid ? (this.wfsLayerParams = this.wfsService.layers[a], a = this.wfsService.toJson(), this.wfsLayerParams.url = a.url, this.wfsLayerParams.version = a.version, this.wfsService.selectLayer({ layerName: this.wfsLayerParams.name, mode: "snapshot" }, b.hitch(this, function(a) {
                            "esriGeometryComplex" == this.wfsService.geometryType ? (this.wfsGeometryTypeSelect.set("value", this.i18n.chooseWFSGeometryType), b.style(b.byId("add-layer-url-wfs-geometryType"), "display", ""), b.style(b.byId("add-layer-url-wfs-geometryTypeMsg"),
                                "display", "")) : (this.wfsLayerParams.geometryType = this.wfsService.geometryType, this.addButton.set("disabled", !1));
                            this.adjustDlg()
                        })), b.style(b.byId("add-layer-url-wfs-advanced"), "display", "")) : arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(this.i18n.errors.wfsLayerDoesntAlign, { layer: this.wfsLayerParams.title }) })
                    } else b.style(b.byId("add-layer-url-wfs-advanced"), "display", "none")
                },
                setWFSGeometryType: function(a) {
                    -1 ==
                        a ? (delete this.wfsLayerParams.geometryType, this.addButton.set("disabled", !0)) : (this.wfsLayerParams.geometryType = a, this.addButton.set("disabled", !1))
                },
                getGISServerInfo: function(a) {
                    var c = new b.Deferred,
                        d = a || g.byId("add-layer-url-url").get("value"),
                        d = this.checkUrl(d);
                    if (null != d) {
                        a || (this.gisLayerSelectUrl = d, g.byId("add-layer-url-url").textbox.value = d);
                        var f = b.connect(esri.id, "onDialogCancel", b.hitch(this, function(a) {
                                h && clearTimeout(h);
                                b.disconnect(f);
                                e || (e = !0)
                            })),
                            e = !1,
                            h = setTimeout(b.hitch(this, function(a) {
                                if (!esri.id.isBusy() &&
                                    this.lastUrl === a)
                                    if (e = !0, -1 === a.toLowerCase().indexOf("/arcgis/") && -1 < a.toLowerCase().indexOf("/rest/services")) {
                                        var b = a.indexOf("/rest/services");
                                        a = a.substring(0, b) + "/arcgis" + a.substring(b, a.length);
                                        this.getGISServerInfo(a)
                                    } else -1 < a.toLowerCase().indexOf("/arcgis/rest/services/") && (b = a.lastIndexOf("/"), a = a.substring(0, b), this.getGISServerInfo(a))
                            }, d), 1E4);
                        a = d;
                        d = "";
                        arcgisonline.sharing.util.isHostedService(a) && (d = arcgisonline.sharing.util.getToken(), a += d ? (-1 == a.indexOf("?") ? "?" : "\x26") + "token\x3d" +
                            d : "");
                        esri.request({
                            url: a + (-1 == a.indexOf("?") ? "?" : "\x26") + "f\x3djson",
                            callbackParamName: "callback",
                            load: b.hitch(this, function(a, d, g) {
                                    h && clearTimeout(h);
                                    f && b.disconnect(f);
                                    if (!e) {
                                        if (d.services) this.searchGISServerFolders(d.folders, a), this.clearGISLayersSelect(), this.addGISServicesToList(d.services, a), this.addButton.set("disabled", !0), b.style(b.byId("add-layer-url-gis"), "display", ""), b.style(b.byId("add-layer-url-browseLayers-options"), "display", "none");
                                        else if (null !== d.description && (-1 < a.indexOf("?") &&
                                                (a = a.substring(0, a.indexOf("?"))), d = a.lastIndexOf("/"), d = a.substring(d + 1, a.length), "mapserver" == d.toLowerCase() || "imageserver" == d.toLowerCase() || "featureserver" == d.toLowerCase())) {
                                            d = a.lastIndexOf("/");
                                            a = a.substring(0, d);
                                            d = a.lastIndexOf("/");
                                            for (a = a.substring(0, d); !a.endsWith("/services");) d = a.lastIndexOf("/"), a = a.substring(0, d);
                                            this.getGISServerInfo(a).then(b.hitch(this, function() {
                                                this.gisLayerSelect.set("value", this.gisLayerSelectUrl, !1);
                                                this.setGISService(this.gisLayerSelectUrl)
                                            }))
                                        }
                                        c.callback()
                                    }
                                },
                                a),
                            error: b.hitch(this, function(a, c, d) {
                                h && clearTimeout(h);
                                f && b.disconnect(f);
                                if (!e) {
                                    if ("https:" === document.location.protocol && 0 === a.indexOf("http:")) return a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), a.show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: this.i18n.error.badUrl }), null;
                                    if (-1 == a.toLowerCase().indexOf("/arcgis/") && -1 < a.toLowerCase().indexOf("/rest/services")) c = a.indexOf("/rest/services"), a = a.substring(0, c) + "/arcgis" + a.substring(c, a.length), this.getGISServerInfo(a);
                                    else if (-1 < a.toLowerCase().indexOf("/arcgis/rest/services"))
                                        if (c = a.lastIndexOf("/"), a = a.substring(0, c), -1 < a.toLowerCase().indexOf("/arcgis/rest/services")) this.getGISServerInfo(a);
                                        else return a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), a.show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: this.i18n.error.noResponse }), null;
                                    else return a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), a.show({
                                        title: esri.i18nBundle.generalDlg.errorDlgTitle,
                                        message: this.i18n.error.noResponse
                                    }), null
                                }
                            }, a)
                        });
                        return c
                    }
                },
                searchGISServerFolders: function(a, c) {
                    if (a)
                        for (var d = function(a, b, c) {
                                this.searchGISServerFolders(b.folders, a);
                                this.addGISServicesToList(b.services, a);
                                this.gisLayerSelect.set("value", this.gisLayerSelectUrl, !1)
                            }, f = 0, e = 0; e < a.length; e++) {
                            var g = c + "/" + a[e];
                            esri.request({
                                url: g + "?f\x3djson",
                                callbackParamName: "callback",
                                load: b.hitch(this, function(c, e, g) { e.error && "" != e.error ? f != a.length - 1 && f++ : b.hitch(this, d, c, e, g)() }, g),
                                error: b.hitch(this, function(b,
                                    c, d) { f != a.length - 1 && f++ }, g)
                            })
                        }
                },
                addGISServicesToList: function(a, c) {
                    b.forEach(a, function(a) {
                        if ("mapserver" == a.type.toLowerCase() || "imageserver" == a.type.toLowerCase() || "featureserver" == a.type.toLowerCase()) {
                            var b = a.name,
                                d = "",
                                g = b.lastIndexOf("/"); - 1 < g && (d = b.substring(0, g), b = b.substring(g + 1, b.length));
                            this.gisLayerSelect.addOption({ label: a.name + ("featureserver" == a.type.toLowerCase() ? " (Feature Service)" : ""), name: b, value: c + "/" + b + "/" + a.type, url: this.baseUrl, type: a.type, folder: d })
                        }
                    }, this)
                },
                setGISService: function(a) {
                    g.byId("add-layer-url-url").textbox.value =
                        a;
                    this.addButton.set("disabled", !1); - 1 < a.toLowerCase().indexOf("/featureserver") ? (g.byId("add-layer-url-basemap-check").set("checked", !1), g.byId("add-layer-url-basemap-check").set("disabled", !0)) : g.byId("add-layer-url-basemap-check").set("disabled", !1);
                    b.style(b.byId("add-layer-url-imagery-label"), "display", "none");
                    b.style(b.byId("add-layer-url-imagery-options"), "display", "none"); - 1 < a.indexOf("/ImageServer") && this.checkTiledImageService(a)
                },
                clearGISLayersSelect: function() {
                    var a = this.gisLayerSelect.getOptions();
                    b.forEach(a, function(a) { this.gisLayerSelect.removeOption(a) }, this);
                    a = b.query(".dijitSelectLabel", this.gisLayerSelect.domNode);
                    a.length && (a[0].innerHTML = "")
                },
                checkUrl: function(a) {
                    var b = a.toLowerCase(); - 1 == b.indexOf("http://") && -1 == b.indexOf("https://") && (a = "https://" + a, b = a.toLowerCase());
                    var d = b.indexOf("//"),
                        d = b.indexOf("/", d + 2); - 1 == d ? (a += "/arcgis/rest/services", b = a.toLowerCase()) : d == b.length - 1 && (a += "arcgis/rest/services", b = a.toLowerCase());
                    var f = b.indexOf("/arcgis", d);
                    f == b.length - 7 ? (a += "/rest/services",
                        b = a.toLowerCase()) : f == b.length - 8 && (a += "rest/services", b = a.toLowerCase());
                    f = b.indexOf("/server", d);
                    b.endsWith("/server") ? (a += "/rest/services", b = a.toLowerCase()) : b.endsWith("/server/") && (a += "rest/services", b = a.toLowerCase());
                    var f = b.indexOf("/rest/services", d),
                        e = b.indexOf("/services", d),
                        d = b.indexOf("/rest", d); - 1 == f && -1 < e ? (a = a.substring(0, e) + "/rest/services" + a.substring(e + 9), b = a.toLowerCase()) : -1 == f && -1 < d && (a = a.substring(0, d) + "/rest/services" + a.substring(d + 5), b = a.toLowerCase());
                    if (-1 == b.indexOf("/rest/services")) return arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({
                        title: esri.i18nBundle.generalDlg.errorDlgTitle,
                        message: this.i18n.error.notServerUrl
                    }), null;
                    d = b.lastIndexOf("/");
                    f = b.substring(d + 1, b.length);
                    "mapserver" != f && "imageserver" != f && "featureserver" != f && "wmsserver" !== f && (e = a.substring(0, d), d = e.lastIndexOf("/"), f = e.substring(d + 1, e.length).toLowerCase(), "mapserver" == f || "imageserver" == f || "featureserver" == f) && (a = e);
                    b = b.indexOf("/rest/services");
                    this.baseUrl = a.substring(0, b + 14);
                    return a
                },
                checkCanAddWebMerctorWebTiledLayerToBasemap: function() {
                    var a = (new esri.layers.OpenStreetMapLayer).tileInfo;
                    (a = arcgisonline.map.webTile.checkIfFitsToNewService(arcgisonline.map.main.mapLayers[0],
                        new esri.SpatialReference({ wkid: 102100 }), a)) || arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().showWide({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(this.i18n.errors.webTiledLayerDoesntAlign, { url: g.byId("add-layer-url-url").get("value") }) });
                    return a
                },
                checkCanAddWebMerctorWebTiledLayer: function() {
                    if (g.byId("add-layer-url-basemap-check").get("checked") || "bing" == this.layerType) {
                        var a = new esri.layers.OpenStreetMapLayer;
                        return arcgisonline.map.save_open.checkIfOpLayersFitToNewBasemap(new esri.SpatialReference({ wkid: 102100 }), { tileInfo: a.tileInfo })
                    }
                    return this.checkCanAddWebMerctorWebTiledLayerToBasemap()
                },
                _stripParameters: function(a, c) {
                    a = esri.urlToObject(a);
                    qs = [];
                    for (var d in a.query) - 1 === b.indexOf(c, d.toLowerCase()) && qs.push(d + "\x3d" + a.query[d]);
                    return a.path + (qs.length ? "?" + qs.join("\x26") : "")
                },
                onFocus: function() {
                    var a = g.byId("add-layer-url-url").get("value");
                    a != this.defaultTextUrl && a != this.defaultArcGISTextUrl || g.byId("add-layer-url-url").set("value", "")
                },
                adjustDlg: function() { g.registry.byId("add-layer-url-dialog").resize() }
            })
        })
},
"arcgisonline/sharing/dijit/SelectLayers": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,dojo/Evented,dgrid/OnDemandGrid,dgrid/Selection,dgrid/selector,dgrid/editor,dojo/store/Observable,dojo/store/Memory"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.SelectLayers");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dojo.Evented");
        b.require("dgrid.OnDemandGrid");
        b.require("dgrid.Selection");
        b.require("dgrid.selector");
        b.require("dgrid.editor");
        b.require("dojo.store.Observable");
        b.require("dojo.store.Memory");
        b.declare("arcgisonline.sharing.dijit.SelectLayers", [g._Widget, g._Templated, b.Evented], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv\x3e\r\n  \x3cdiv id\x3d"${id}.selectLayersGrid" class\x3d"selectLayersGrid"\x3e\x3c/div\x3e                \r\n\x3c/div\x3e\r\n',
            baseClass: "esriAGOSelectLayers",
            i18n: null,
            grid: null,
            data: [],
            store: null,
            constructor: function(a, b) {},
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.clone(b.i18n.getLocalization("arcgisonline",
                    "arcgisonline").common);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").SelectLayers)
            },
            postCreate: function() { this.loadConnections() },
            destroy: function() {
                this.grid.destroy();
                this.inherited(arguments)
            },
            loadConnections: function() {},
            startup: function(a, c, d) {
                this.layerInfos = a;
                this.data = b.map(a, function(a, b) { return { id: b, name: a.name, label: a.title } });
                this.columns = {};
                this.columns.check = dgrid.selector({ className: "checkCell", label: "" });
                this.columns.label = dgrid.editor({
                    className: "labelCell",
                    field: "label",
                    name: this.i18n.layers,
                    label: this.i18n.layers,
                    sortable: !0
                }, "text", "click");
                this.store = new b.store.Observable(new b.store.Memory({ data: this.data, idProperty: "id" }));
                this.grid = new(b.declare([dgrid.OnDemandGrid, dgrid.Selection]))({ columns: this.columns, store: this.store, sort: [{ attribute: "label" }], className: "selectLayersGrid", style: "height: 100px;", allowSelectAll: !0, selectionMode: "none", showHeader: !0 }, this.id + ".selectLayersGrid");
                d && this.grid.selectAll();
                this.grid.on("dgrid-select", b.hitch(this,
                    function(a) { this.emit("changed", {}) }));
                this.grid.on("dgrid-deselect", b.hitch(this, function(a) { this.emit("changed", {}) }));
                this.grid.on("dgrid-datachange", b.hitch(this, function(a) { this.emit("changed", {}) }));
                this.grid.on("dgrid-editor-hide", b.hitch(this, function(a) {
                    a.cell.row.data.label = a.editor.value;
                    this.emit("changed", {})
                }))
            },
            getSelectedLayers: function() {
                var a = [],
                    c;
                for (c in this.grid.selection)
                    if (this.grid.selection[c]) {
                        var d = this.grid.store.get(c);
                        b.forEach(this.layerInfos, function(b) {
                            b.name === d.name &&
                                (b.title = d.label, a.push(b))
                        })
                    }
                return a
            }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/ExtentDlg": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/on dojo/topic dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../DefineExtent dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/ExtentDlg.html".split(" "), function(b, g, n, a, c, d, f, e, h, m, p, r, v) {
        var w = g("arcgisonline.sharing.dijit.dialog.ExtentDlg", [e, h, m], {
            declaredClass: "arcgisonline.sharing.dijit.dialog.ExtentDlg",
            basePath: b.toUrl("arcgisonline/sharing/dijit/dialog"),
            templateString: v,
            widgetsInTemplate: !0,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = n.mixin({}, r.common);
                this.i18n = n.mixin(this.i18n, r.viewer.geocode);
                this.i18n = n.mixin(this.i18n, r.generalDlg);
                this.i18n = n.mixin(this.i18n, r.extentDlg)
            },
            postCreate: function() {
                this.inherited(arguments);
                this._loadConnections()
            },
            _loadConnections: function() {
                this.own(a(this._cancelBtn, "click", n.hitch(this, "_cancelBtnClick")), a(this._okBtn, "click",
                    n.hitch(this, "_okBtnClick")), c.subscribe("define-extent/update", n.hitch(this, "_publish")))
            },
            _cancelBtnClick: function(a) {
                a.preventDefault();
                this._extentDialog.hide()
            },
            _okBtnClick: function(a) {
                a.preventDefault();
                this.setExtent()
            },
            hide: function() {
                this._defineExtent._destroyMap();
                this._extentDialog.hide()
            },
            show: function(a) {
                this._defineExtent || (this._defineExtent = new p({ id: "defineExtent" }, this._extentContainer), this._defineExtent.startup());
                this._defineExtent.set("extent", a);
                this._extentDialog.show()
            },
            setExtent: function() {
                var a = this._defineExtent.get("extent");
                a && this._publish(a);
                this.hide()
            },
            _publish: function(a) { c.publish("extent/update", a) }
        });
        w.prototype.statics = { getInstance: function() { this._instance || (this._instance = new w); return this._instance } };
        return w
    })
}, "arcgisonline/sharing/dijit/DefineExtent": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/query dojo/on dojo/number dojo/topic esri/dijit/Search esri/map esri/layers/ImageParameters esri/layers/ArcGISTiledMapServiceLayer esri/geometry/Extent esri/geometry/Point esri/geometry/webMercatorUtils esri/SpatialReference esri/symbols/SimpleLineSymbol esri/toolbars/draw esri/graphic esri/dijit/Popup dijit/Dialog dijit/form/Button dijit/form/TextBox dijit/layout/BorderContainer dijit/layout/ContentPane dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../../map/core/projectExtent ../../map/utils/clipOnHorizon ../../map/utils/createExtentSearchOptions ../util ../../pages/pageUtil ../../pages/utils/dom ../../esriGeowConfig ./dialog/GeneralDlg dojo/i18n!../../nls/arcgisonline dojo/text!./templates/DefineExtent.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q) {
            return g([S, W, U], {
                declaredClass: "arcgisonline.sharing.dijit.DefineExtent",
                basePath: b.toUrl("arcgisonline/sharing/dijit"),
                templateString: Q,
                widgetsInTemplate: !0,
                numberPattern: "#.#",
                _setExtentAttr: function(a) {
                    (this.extent = a) && 2 === a.length && 2 === a[0].length && 2 === a[1].length ? (this._initMap(a), this._extentTop.set("value", r.format(Math.round(1E3 * this.extent[1][1]) / 1E3, this.numberPattern)), this._extentLeft.set("value",
                        r.format(Math.round(1E3 * this.extent[0][0]) / 1E3, this.numberPattern)), this._extentRight.set("value", r.format(Math.round(1E3 * this.extent[1][0]) / 1E3, this.numberPattern)), this._extentBottom.set("value", r.format(Math.round(1E3 * this.extent[0][1]) / 1E3, this.numberPattern))) : (this._initMap(null), this._extentTop.set("value", ""), this._extentLeft.set("value", ""), this._extentRight.set("value", ""), this._extentBottom.set("value", ""))
                },
                _getExtentAttr: function() {
                    var a = [
                            [],
                            []
                        ],
                        b = this._extentTop.get("value"),
                        c = this._extentLeft.get("value"),
                        d = this._extentBottom.get("value"),
                        e = this._extentRight.get("value"),
                        f = r.parse(b),
                        g = r.parse(c),
                        h = r.parse(d),
                        m = r.parse(e);
                    if (this._isValidExtentInput(b, c, e, d, f, g, m, h)) {
                        a[1][1] = f;
                        a[0][0] = g;
                        a[1][0] = m;
                        a[0][1] = h;
                        if (this._isValidWGS84Extent(a)) return a;
                        y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorRange + "\x3cbr\x3e" + this.i18n.error.errorValueBigger })
                    } else y.createSpecifiedDialog(z).show({
                        title: this.i18n.errorDlgTitle,
                        message: this.i18n.error.errorUseNumeric + "\x3cbr/\x3e" +
                            this.i18n.error.errorRange + "\x3cbr\x3e" + this.i18n.error.errorValueBigger
                    })
                },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = n.mixin({}, I.common);
                    this.i18n = n.mixin(this.i18n, I.viewer.geocode);
                    this.i18n = n.mixin(this.i18n, I.generalDlg);
                    this.i18n = n.mixin(this.i18n, I.extentDlg)
                },
                postCreate: function() {
                    this.symbol = new A(A.STYLE_SOLID, new c([255, 0, 0]), 2);
                    this.defaultExtent = new E(-121, 21.72, -76, 61.28, new D({ wkid: 4326 }));
                    this._loadConnections()
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._destroyMap()
                },
                _loadConnections: function() {
                    var a = n.hitch(this, "_checkRange");
                    this.own(p(this._extentTop, "blur", a), p(this._extentLeft, "blur", a), p(this._extentRight, "blur", a), p(this._extentBottom, "blur", a), p(this._buttonSetExtent, "click", n.hitch(this, "_toggleMapNavigation")))
                },
                _isValidWGS84Extent: function(b) {
                    b = [b[0].join(","), b[1].join(",")].join();
                    b = a.map(b.split(","), function(a) { return parseFloat(a) });
                    return -90 <= b[3] && 90 >= b[3] && -180 <= b[2] && 180 >= b[2] && -180 <= b[0] && 180 >= b[0] && -90 <= b[1] && 90 >= b[1] &&
                        b[2] > b[0] && b[3] > b[1]
                },
                _isValidExtentInput: function(a, b, c, d, e, f, g, h) { return !(0 === a.length || 0 === b.length || 0 === c.length || 0 === d.length || isNaN(e) || isNaN(f) || isNaN(g) || isNaN(h)) },
                _destroyMap: function() {
                    if (this.map) {
                        try { this.map.destroy() } catch (Y) {}
                        var a = this.map.infoWindow;
                        a && a.destroy();
                        this.map = null
                    }
                    if (this.geocoder) {
                        try { this.geocoder.destroy() } catch (Y) {}
                        this.geocoder = null
                    }
                    d.byId("extent-map-container") && e.empty(d.byId("extent-map-container"))
                },
                _setProjectedExtent: function(a) {
                    a = C(a[0]);
                    p.once(this.map,
                        "extent-change", n.hitch(this, "_drawBoundingBox", a));
                    this.map.setExtent(a, !0)
                },
                _drawBoundingBox: function(a) { this._drawBox(a) },
                _checkRange: function(a) {
                    if (a) {
                        var b = a.target.value,
                            c = r.parse(b);
                        a = a.target.id;
                        var d = !1;
                        if ("extent-left" === a) {
                            if (0 === b.length || isNaN(c)) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorLonNotNumber }), d = !0;
                            else if (-180 > c || 180 < c) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorRangeLong }), d = !0;
                            d && (this.extent && 2 === this.extent.length && 2 == this.extent[0].length && 2 === this.extent[1].length ? this._extentLeft.set("value", r.format(Math.round(1E3 * this.extent[0][0]) / 1E3, this.numberPattern)) : this._extentLeft.set("value", ""))
                        } else if ("extent-right" === a) {
                            if (0 === b.length || isNaN(c)) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorLonNotNumber }), d = !0;
                            else if (-180 > c || 180 < c) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorRangeLong }),
                                d = !0;
                            d && (this.extent && 2 === this.extent.length && 2 === this.extent[0].length && 2 === this.extent[1].length ? this._extentRight.set("value", r.format(Math.round(1E3 * this.extent[1][0]) / 1E3, this.numberPattern)) : this._extentRight.set("value", ""))
                        } else if ("extent-top" === a) {
                            if (0 === b.length || isNaN(c)) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorLatNotNumber }), d = !0;
                            else if (-90 > c || 90 < c) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorRangeLat }),
                                d = !0;
                            d && (this.extent && 2 === this.extent.length && 2 === this.extent[0].length && 2 === this.extent[1].length ? this._extentTop.set("value", r.format(Math.round(1E3 * this.extent[1][1]) / 1E3, this.numberPattern)) : this._extentTop.set("value", ""))
                        } else {
                            if (0 === b.length || isNaN(c)) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorLatNotNumber }), d = !0;
                            else if (-90 > c || 90 < c) y.createSpecifiedDialog(z).show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.errorRangeLat }), d = !0;
                            d &&
                                (this.extent && 2 == this.extent.length && 2 == this.extent[0].length && 2 == this.extent[1].length ? this._extentBottom.set("value", r.format(Math.round(1E3 * this.extent[0][1]) / 1E3, this.numberPattern)) : this._extentBottom.set("value", ""))
                        }
                        null != this.map && 0 < this._extentTop.get("value").length && 0 < this._extentLeft.get("value").length && 0 < this._extentRight.get("value").length && 0 < this._extentBottom.get("value").length ? (b = [
                                [],
                                []
                            ], b[1][1] = r.parse(this._extentTop.get("value")), b[0][0] = r.parse(this._extentLeft.get("value")),
                            b[1][0] = r.parse(this._extentRight.get("value")), b[0][1] = r.parse(this._extentBottom.get("value")), this._isValidWGS84Extent(b) ? (b = new E(b[0][0], b[0][1], b[1][0], b[1][1], new D({ wkid: 4326 })), V(b, this.map.spatialReference, n.hitch(this, "_setProjectedExtent"), null, this.map)) : this._deleteBox()) : null != this.map && this._deleteBox()
                    }
                },
                _initMap: function(a) {
                    var b = this.defaultExtent,
                        c;
                    null != a && (b = new E(a[0][0], a[0][1], a[1][0], a[1][1], new D({ wkid: 4326 })));
                    if (this.map) {
                        if (null != a) p.once(this.map, "extent-change", n.hitch(this,
                            "_drawBoundingBox", b));
                        this.map.setExtent(b, !0)
                    } else this.map = new t("extent-map-container", { showAttribution: !1, wrapAround180: !1, center: [-31, 10], zoom: 1 }), c = new x, c.format = "png24", c = new B(u.extentService, { imageParameters: c }), this.map.addLayer(c), null != a && this.own(this.map.on("load", n.hitch(this, "_onMapLoad", b))), this.own(c.on("update", n.hitch(this, "_onUpdate"))), this.toolbar = new H(this.map, { showTooltips: !1 }), this.own(this.toolbar.on("draw-complete", n.hitch(this, "_onDrawEnd"))), this.mapNavigation = !0,
                        f.set(this._buttonSetExtent, "innerHTML", this.i18n.drawExtent), this.geocoder || (a = X(this.map), a.showInfoWindowOnSelect = !1, this.geocoder = new w(a, e.create("div", { id: "extentSearch" }, this._extentSearchContainer, "only")), this.geocoder.startup(), this.own(this.geocoder.on("select-result", n.hitch(this, "_onSearchResult"))))
                },
                _onMapLoad: function(a) {
                    m(".action.zoomTo").forEach(q.hideNode);
                    V(a, this.map.spatialReference, n.hitch(this, "_setProjectedExtent"), null, this.map)
                },
                _drawBox: function(a) {
                    this.map.graphics.clear();
                    null !== a && this.map.graphics.add(new J(a, this.symbol))
                },
                _deleteBox: function() { this.map.graphics.clear() },
                _onUpdate: function() { this.map.reposition() },
                _toggleMapNavigation: function() { this.mapNavigation ? (this.toolbar.activate(H.EXTENT), this.map.showZoomSlider(), this.mapNavigation = !1, f.set(this._buttonSetExtent, "innerHTML", this.i18n.enableMapPanning)) : (this.toolbar.deactivate(), this.map.enableMapNavigation(), this.mapNavigation = !0, f.set(this._buttonSetExtent, "innerHTML", this.i18n.drawExtent)) },
                _onSearchResult: function(a) {
                    if (a.result) {
                        a =
                            a.result;
                        var b = a.feature.geometry,
                            c = a.extent,
                            f, g;
                        "polygon" === b.type ? (f = b.getExtent().expand(1.1), g = b.getCentroid()) : "polyline" === b.type ? (f = b.getExtent().expand(1.1), g = b.getPoint(0, 0)) : "multipoint" === b.type ? (f = b.getExtent().expand(1.1), g = b.getPoint(0)) : (f = c || arcgisonline.map.main.map.extent.centerAt(b).expand(.0625), g = b);
                        this._deleteBox();
                        this.popup || (this.popup = new L(null, e.create("div", { "class": "blueTheme" }, d.byId("extentMapDiv"))), this.popup.resize(150, 100), this.popup.map = this.map);
                        this.popup.setContent("\x3cdiv\x3e\x3cspan\x3e" +
                            a.name + "\x3c/span\x3e\x3c/div\x3e");
                        p.once(this.map, "extent-change", n.hitch(this, function() {
                            this._drawBox(f);
                            this.popup.show(g);
                            setTimeout(n.hitch(this, function() { this.popup.hide() }), 3E3)
                        }));
                        this.map.setExtent(f, !0);
                        a = f;
                        4326 !== f.spatialReference.wkid && (a = F.webMercatorToGeographic(f));
                        this._extentTop.set("value", r.format(Math.round(1E3 * a.ymax) / 1E3, this.numberPattern));
                        this._extentLeft.set("value", r.format(Math.round(1E3 * a.xmin) / 1E3, this.numberPattern));
                        this._extentRight.set("value", r.format(Math.round(1E3 *
                            a.xmax) / 1E3, this.numberPattern));
                        this._extentBottom.set("value", r.format(Math.round(1E3 * a.ymin) / 1E3, this.numberPattern));
                        this.extent = [
                            [],
                            []
                        ];
                        this.extent[1][1] = parseFloat(a.ymax);
                        this.extent[0][0] = parseFloat(a.xmin);
                        this.extent[1][0] = parseFloat(a.xmax);
                        this.extent[0][1] = parseFloat(a.ymin);
                        v.publish("define-extent/change", a)
                    }
                },
                _onDrawEnd: function(a) {
                    var b;
                    this._deleteBox();
                    .01 > a.width && (b = .01, a = new E(a.xmin - b, a.ymin, a.xmin + b, a.ymax, new D({ wkid: 4326 })));
                    .01 > a.height && (b = .01, a = new E(a.xmin, a.ymin - b, a.xmax,
                        a.ymin + b, new D({ wkid: 4326 })));
                    a = C(a.geographicGeometry);
                    p.once(this.map, "extent-change", n.hitch(this, "_drawBoundingBox", a));
                    this.map.setExtent(a, !0);
                    b = a;
                    4326 !== a.spatialReference.wkid && (b = F.webMercatorToGeographic(a));
                    this._extentTop.set("value", r.format(Math.round(1E3 * b.ymax) / 1E3, this.numberPattern));
                    this._extentLeft.set("value", r.format(Math.round(1E3 * b.xmin) / 1E3, this.numberPattern));
                    this._extentRight.set("value", r.format(Math.round(1E3 * b.xmax) / 1E3, this.numberPattern));
                    this._extentBottom.set("value",
                        r.format(Math.round(1E3 * b.ymin) / 1E3, this.numberPattern));
                    this.extent = [
                        [],
                        []
                    ];
                    this.extent[1][1] = parseFloat(b.ymax);
                    this.extent[0][0] = parseFloat(b.xmin);
                    this.extent[1][0] = parseFloat(b.xmax);
                    this.extent[0][1] = parseFloat(b.ymin);
                    v.publish("define-extent/change", b)
                }
            })
        })
}, "esri/dijit/Search": function() {
    define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q, T) {
            function Y(a, b) { a && b && (a._layer = b, a._sourceLayer = b) }
            g = g([F, D, A, c], {
                declaredClass: "esri.dijit.Search",
                templateString: G,
                reHostedFS: /https?:\/\/services.*\.arcgis\.com/i,
                constructor: function(a, c) {
                    this.css = {
                        searchGroup: "searchGroup",
                        searchInput: "searchInput",
                        searchInputGroup: "searchInputGroup",
                        searchBtn: "searchBtn",
                        searchSubmit: "searchSubmit",
                        searchIcon: "searchIcon esri-icon-search",
                        searchButtonText: "searchButtonText",
                        searchToggle: "searchToggle",
                        searchToggleIcon: "searchIcon esri-icon-down-arrow",
                        searchMenu: "searchMenu",
                        searchMenuHeader: "menuHeader",
                        searchClear: "searchClear",
                        searchClearIcon: "searchIcon esri-icon-close searchClose",
                        searchSpinner: "searchIcon esri-icon-loading-indicator searchSpinner",
                        searchSourceName: "sourceName",
                        suggestionsMenu: "suggestionsMenu",
                        sourcesMenu: "sourcesMenu",
                        activeSource: "active",
                        hasValue: "hasValue",
                        hasButtonMode: "hasButtonMode",
                        hasMultipleSources: "hasMultipleSources",
                        showSuggestions: "showSuggestions",
                        showSources: "showSources",
                        showNoResults: "showNoResults",
                        searchLoading: "searchLoading",
                        latLonHeader: "searchLatLongHeader",
                        searchMoreResults: "moreResults",
                        searchMoreResultsList: "resultsList",
                        searchMoreResultsHeader: "moreHeader",
                        searchMoreResultsItem: "moreItem",
                        searchMoreResultsListHeader: "popupHeader",
                        searchShowMoreResults: "showMoreResults",
                        searchNoResultsMenu: "noResultsMenu",
                        searchNoResultsBody: "noResultsBody",
                        searchNoResultsHeader: "noResultsHeader",
                        searchNoValueIcon: "noValueIcon esri-icon-notice-triangle",
                        searchNoValueText: "noValueText",
                        searchNoResultsText: "noResultsText",
                        searchExpandContainer: "searchExpandContainer",
                        searchAnimateContainer: "searchAnimate",
                        searchExpanded: "searchExpanded",
                        searchCollapsed: "searchCollapsed",
                        searchClearFloat: "searchClearFloat"
                    };
                    this._allIndex = "all";
                    this._objectIdIdentifier = "_objectId";
                    this._deferreds = [];
                    this._sourceNames = [];
                    this.defaultSource = {
                        locator: new z("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),
                        singleLineFieldName: "SingleLine",
                        outFields: ["Addr_type",
                            "Match_addr", "StAddr", "City"
                        ],
                        name: E.widgets.Search.main.esriLocatorName,
                        localSearchOptions: { minScale: 3E5, distance: 5E4 },
                        placeholder: E.widgets.Search.main.placeholder,
                        highlightSymbol: (new S(b.toUrl("./Search/images/search-pointer.png"), 36, 36)).setOffset(9, 18)
                    };
                    this.options = {
                        map: null,
                        theme: "arcgisSearch",
                        visible: !0,
                        value: "",
                        allPlaceholder: "",
                        sources: [this.defaultSource],
                        activeSourceIndex: 0,
                        suggestionDelay: 150,
                        enableSourcesMenu: !0,
                        enableSuggestionsMenu: !0,
                        enableInfoWindow: !0,
                        showInfoWindowOnSelect: !0,
                        enableSuggestions: !0,
                        enableButtonMode: !1,
                        autoNavigate: !0,
                        autoSelect: !0,
                        addLayersFromMap: !1,
                        zoomScale: 1E3,
                        graphicsLayer: null,
                        enableHighlight: !0,
                        highlightGraphic: null,
                        enableLabel: !1,
                        labelSymbol: (new C).setColor(new Q([181, 56, 46, .9])).setFont(new X("14px", X.STYLE_NORMAL, X.VARIANT_NORMAL, X.WEIGHT_BOLD, "Arial")),
                        labelGraphic: null,
                        infoTemplate: new M(E.widgets.Search.main.searchResult, '\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
                        searchResults: null,
                        suggestResults: null,
                        selectedResult: null,
                        magicKey: null,
                        selectedFeatureId: null,
                        expanded: !1,
                        maxLength: 128,
                        maxResults: 6,
                        maxSuggestions: 6,
                        locationToAddressDistance: 1500,
                        minCharacters: 1,
                        enableSearchingAll: !0
                    };
                    a = n.mixin({}, this.options, a);
                    this.set(a);
                    this._updateActiveSource();
                    this._i18n = E;
                    this._defaultSR = new P(4326);
                    this.domNode = c
                },
                startup: function() {
                    this.inherited(arguments);
                    this.sources || (this.sources = []);
                    this._mapLoaded().then(n.hitch(this, this._init))
                },
                postCreate: function() {
                    var a =
                        this;
                    this.inherited(arguments);
                    this._moreResultsId = this.id + "_more_results";
                    this.own(e(this.submitNode, H, n.hitch(this, this._searchButton)));
                    this.own(e(this.sourcesBtnNode, H, n.hitch(this, this._toggleSourcesMenu)));
                    this.own(e(this.inputNode, H, n.hitch(this, this._inputClick)));
                    this.own(e(this.clearNode, H, n.hitch(this, this._clearButton)));
                    this.own(e(this.formNode, "submit", n.hitch(this, function(a) {
                        a.preventDefault();
                        this._cancelSuggest();
                        this.search()
                    })));
                    this.own(e(this.inputNode, "keyup", n.hitch(this, function(a) { this._inputKey(a) })));
                    this.own(e(this.sourcesBtnNode, "keyup", n.hitch(this, function(a) { this._sourceBtnKey(a) })));
                    this.own(e(this.suggestionsNode, "li:click, li:keyup", function(b) { a._suggestionsEvent(b, this) }));
                    this.own(e(this.sourcesNode, "li:click, li:keyup", function(b) { a._sourcesEvent(b, this) }));
                    this.own(e(this.inputNode, "input, paste", n.hitch(this, function() { this._suggestDelay() })));
                    this.map && this.map.infoWindow && this.map.infoWindow.domNode && this.enableInfoWindow && (this.own(e(this.map.infoWindow.domNode, "#" + this._moreResultsId +
                        "_show:click", n.hitch(this, function(a) { this._showMoreResultsClick(a) }))), this.own(e(this.map.infoWindow.domNode, "#" + this._moreResultsId + "_list li a:click", n.hitch(this, function(a) { this._moreResultsClick(a) }))), this.own(e(this.map.infoWindow.domNode, "#" + this._moreResultsId + " [data-switch-coordinates]:click", n.hitch(this, function(a) { this._switchCoordinatesClick(a) }))));
                    this.value && this._checkStatus();
                    this._hideMenus();
                    this._updateVisible();
                    this._insertSources(this.sources);
                    this._setPlaceholder(this.activeSourceIndex);
                    this._updateButtonMode(this.enableButtonMode);
                    this.toggle(this.expanded)
                },
                destroy: function() {
                    this.clear();
                    x.empty(this.domNode);
                    this.inherited(arguments)
                },
                clear: function() {
                    this.clearGraphics();
                    v.get(this.inputNode, "value") && v.set(this.inputNode, "value", "");
                    this._changeAttrValue("value", "");
                    this.set("searchResults", null);
                    this.set("suggestResults", null);
                    this.set("selectedResult", null);
                    this.set("magicKey", null);
                    this.set("selectedFeatureId", null);
                    w.remove(this.containerNode, this.css.hasValue);
                    v.set(this.clearNode,
                        "title", "");
                    this._hideMenus();
                    this._closePopup();
                    this._hideLoading();
                    this.emit("clear-search")
                },
                show: function() { t.set(this.domNode, "display", "block") },
                hide: function() { t.set(this.domNode, "display", "none") },
                expand: function() { this.enableButtonMode && (w.add(this.containerNode, this.css.searchExpanded), w.remove(this.containerNode, this.css.searchCollapsed), this._hideMenus(), this.set("expanded", !0)) },
                collapse: function() {
                    this.enableButtonMode && (w.remove(this.containerNode, this.css.searchExpanded), w.add(this.containerNode,
                        this.css.searchCollapsed), this._hideMenus(), this.set("expanded", !1))
                },
                toggle: function(a) { this.enableButtonMode && ("undefined" === typeof a && (a = !this.expanded), a ? this.expand() : this.collapse()) },
                search: function(a) {
                    var b = new d;
                    this._mapLoaded().then(n.hitch(this, function() {
                        this._searchDeferred(a).then(n.hitch(this, function(a) {
                            var c = a.results;
                            this.set("searchResults", c);
                            0 === a.numResults && (this._noResults(a.value), this._showNoResultsMenu());
                            this._hideLoading();
                            this.emit("search-results", a);
                            this._selectFirstResult(c,
                                a.activeSourceIndex);
                            b.resolve(c)
                        }), n.hitch(this, function(a) { b.reject(a) }))
                    }));
                    return b.promise
                },
                suggest: function(a) {
                    var b = new d;
                    this._mapLoaded().then(n.hitch(this, function() {
                        this._suggestDeferred(a).then(n.hitch(this, function(a) {
                            if (a) {
                                var c = a.results;
                                this.set("suggestResults", c);
                                this._insertSuggestions(c, a.value);
                                this.emit("suggest-results", a);
                                b.resolve(c)
                            }
                        }), n.hitch(this, function(a) { b.reject(a) }))
                    }));
                    return b.promise
                },
                select: function(a) {
                    var b = this._getDefaultSymbol(a),
                        c = this.labelSymbol,
                        d, e = this.sources,
                        f = this.activeSourceIndex,
                        g = this.enableHighlight,
                        h = this.enableLabel,
                        m = this.autoNavigate,
                        p = this.showInfoWindowOnSelect,
                        q = this.enableInfoWindow,
                        r = this.infoTemplate,
                        t = a.feature ? new O(a.feature.toJson()) : null,
                        u = t ? a.feature._sourceLayer : null;
                    Y(t, u);
                    if (f === this._allIndex) {
                        var v = this._getSourceIndexOfResult(a);
                        null !== v && (d = e[v], f = v)
                    } else d = e[f];
                    d && (d.hasOwnProperty("highlightSymbol") && (b = d.highlightSymbol), d.hasOwnProperty("labelSymbol") && (c = d.labelSymbol), d.hasOwnProperty("enableHighlight") && (g = d.enableHighlight),
                        d.hasOwnProperty("enableLabel") && (h = d.enableLabel), d.hasOwnProperty("autoNavigate") && (m = d.autoNavigate), d.hasOwnProperty("showInfoWindowOnSelect") && (p = d.showInfoWindowOnSelect), d.hasOwnProperty("enableInfoWindow") && (q = d.enableInfoWindow), d.hasOwnProperty("infoTemplate") ? r = d.infoTemplate : d.featureLayer && d.featureLayer.infoTemplate && (r = d.featureLayer.infoTemplate));
                    this._hideMenus();
                    this._hideLoading();
                    if (t) {
                        var e = this.highlightGraphic,
                            w = this.graphicsLayer,
                            v = this.labelGraphic,
                            x = n.mixin({}, t.attributes, { searchTheme: this.theme, searchResult: this._searchResultHTML(a), searchMoreResults: this.css.searchMoreResults, searchMoreResultsItem: this.css.searchMoreResultsItem, searchMoreResultsId: this._moreResultsId, searchMoreResultsHtml: this._moreResultsHTML(a) }),
                            y = null;
                        q && (y = r);
                        v ? (v.setGeometry(t.geometry), v.setAttributes(x), v.setSymbol(c), c && "textsymbol" === c.type && v.symbol.setText(a.name)) : (v = new O(t.geometry, c, x), Y(v, u), c && "textsymbol" === c.type && v.symbol.setText(a.name), h && (w ? w.add(v) : this.map && this.map.graphics &&
                            this.map.graphics.add(v)));
                        e ? (e.setGeometry(t.geometry), e.setAttributes(x), e.setInfoTemplate(y), e.setSymbol(b)) : (e = new O(t.geometry, b, x, y), Y(e, u), g && (w ? w.add(e) : this.map && this.map.graphics && this.map.graphics.add(e)));
                        e && e.symbol && "textsymbol" === e.symbol.type && e.symbol.setText(a.name);
                        this.map && this.map.infoWindow && q && p && (this.map.infoWindow.setFeatures([e]), b = this._getPointFromGeometry(e.geometry), this.map.infoWindow.show(b));
                        this.map && m && a && a.hasOwnProperty("extent") && "function" === typeof this.map.setExtent &&
                            this.map.setExtent(a.extent, !0);
                        this.set("highlightGraphic", e);
                        this.set("labelGraphic", v)
                    }
                    this.set("selectedResult", a);
                    this.emit("select-result", { result: a, source: d, sourceIndex: f })
                },
                focus: function() { J.focus(this.inputNode) },
                blur: function() {
                    this.inputNode.blur();
                    J.curNode && J.curNode.blur()
                },
                clearGraphics: function() {
                    var a = this.highlightGraphic,
                        b = this.graphicsLayer,
                        c = this.labelGraphic;
                    a && (b ? b.remove(a) : this.map && this.map.graphics && this.map.graphics.remove(a));
                    c && (b ? b.remove(c) : this.map && this.map.graphics &&
                        this.map.graphics.remove(c));
                    this.set("labelGraphic", null);
                    this.set("highlightGraphic", null)
                },
                _mapLoaded: function() {
                    var a = new d;
                    if (this.map)
                        if (this.map.loaded) a.resolve();
                        else e.once(this.map, "load", n.hitch(this, function() { a.resolve() }));
                    else a.resolve();
                    return a.promise
                },
                _init: function() {
                    this._getMapLayers().then(n.hitch(this, function() {
                        this.set("loaded", !0);
                        this.emit("load")
                    }))
                },
                _clearButton: function() {
                    this.clear();
                    J.focus(this.inputNode)
                },
                _error: function(a) {
                    return Error(this.declaredClass + " " +
                        a)
                },
                _searchDeferred: function(a) {
                    var b = new d,
                        c = this.value,
                        e = this.activeSourceIndex;
                    a && a.hasOwnProperty("index") && (e = a.index);
                    this._showLoading();
                    this._hideMenus();
                    this._closePopup();
                    this.clearGraphics();
                    var f = { magicKey: this.magicKey, text: c };
                    a ? "string" === typeof a ? (f.text = a, a = this._searchQueries(f)) : a = "object" === typeof a && a.hasOwnProperty("magicKey") ? this._searchQueries(a) : "object" === typeof a && a.hasOwnProperty("geometry") ? this._searchQueries({ geometry: a }) : "object" === typeof a && a.hasOwnProperty(this._objectIdIdentifier) ?
                        this._searchQueries(a) : "object" === typeof a && "point" === a.type ? this._searchQueries({ point: a }) : a instanceof Array && 2 === a.length ? this._searchQueries({ latlon: a }) : this._searchQueries(f) : a = this._searchQueries(f);
                    a.always(n.hitch(this, function(a) {
                        a = this._formatResults(a, e, c);
                        b.resolve(a)
                    }));
                    return b.promise
                },
                _suggestDeferred: function(a) {
                    var b = new d;
                    this._deferreds.push(b);
                    a || (a = this.value);
                    var c = this.activeSourceIndex;
                    this._suggestQueries({ text: a }).always(n.hitch(this, function(d) {
                        var e;
                        if (d)
                            for (var f = 0; f <
                                d.length; f++) d[f] && (e = !0);
                        e ? (d = this._formatResults(d, c, a), b.resolve(d)) : b.resolve()
                    }));
                    return b.promise
                },
                _getDefaultSymbol: function(a) {
                    var b, c, d, e;
                    this.map && (e = this.map.getBasemap());
                    e || (e = "topo");
                    a && a.feature && a.feature.geometry && (d = a.feature.geometry.type);
                    "polyline" === d ? d = "line" : "circle" === d || "extent" === d ? d = "polygon" : "multipoint" === d && (d = "point");
                    if (d) {
                        if (a = T.getSchemes({ theme: "default", basemap: e, geometryType: d })) c = a.primaryScheme;
                        if (c) {
                            c.color && c.hasOwnProperty("opacity") && (c.color.a = c.opacity);
                            b = c;
                            a = c.color;
                            c = c.size;
                            var f;
                            switch (d) {
                                case "point":
                                    f = new W;
                                    f.setColor(a);
                                    f.setSize(null !== c ? c : b.size);
                                    d = new U;
                                    d.setColor(b.outline.color);
                                    d.setWidth(b.outline.width);
                                    f.setOutline(d);
                                    break;
                                case "line":
                                    f = new U;
                                    f.setColor(a);
                                    f.setWidth(null !== c ? c : b.width);
                                    break;
                                case "polygon":
                                    f = new V, f.setColor(a), d = new U, d.setColor(b.outline.color), d.setWidth(b.outline.width), f.setOutline(d)
                            }
                            b = f
                        }
                    }
                    return b
                },
                _selectFirstResult: function(a, b) {
                    if (this.autoSelect && a) {
                        var c;
                        b === this._allIndex ? c = this._getFirstResult(a) : a[b] &&
                            a[b][0] && (c = a[b][0]);
                        c && this.select(c)
                    }
                },
                _getSourceIndexOfResult: function(a) {
                    var b = this.searchResults;
                    if (b)
                        for (var c in b)
                            if (b[c] && b[c].length)
                                for (var d = 0; d < b[c].length; d++)
                                    if (b[c][d] === a) return parseInt(c, 10);
                    return null
                },
                _getFirstResult: function(a) {
                    if (a)
                        for (var b in a)
                            if (a[b] && a[b][0]) return a[b][0];
                    return !1
                },
                _onFocus: function() {
                    this.map && "function" === typeof this.map.disableKeyboardNavigation && this.map.disableKeyboardNavigation();
                    this.emit("focus");
                    this.inherited(arguments)
                },
                _onBlur: function() {
                    this._hideMenus();
                    this.map && "function" === typeof this.map.enableKeyboardNavigation && this.map.enableKeyboardNavigation();
                    this.enableButtonMode && this.loaded && this.collapse();
                    this.emit("blur");
                    this.inherited(arguments)
                },
                _getMapLayers: function() {
                    var a = new d;
                    if (this.addLayersFromMap && this.map) {
                        var b = [],
                            c = this.map.graphicsLayerIds;
                        if (c && c.length) {
                            for (var e = 0; e < c.length; e++) {
                                var f = this.map.getLayer(c[e]);
                                f && b.push(this._featureLayerLoaded(f))
                            }
                            R(b).always(n.hitch(this, function(b) {
                                for (var c, d = this.sources, e = 0; e < b.length; e++) b[e] &&
                                    b[e].loaded && "Feature Layer" === b[e].type && (d.push({ featureLayer: b[e], enableSuggestions: !0 }), c = !0);
                                c && this.set("sources", d);
                                a.resolve()
                            }))
                        } else a.resolve()
                    } else a.resolve();
                    return a.promise
                },
                _switchCoordinatesClick: function(a) { a.preventDefault(); if (a = v.get(a.target, "data-switch-coordinates")) this._cancelSuggest(), this.set("value", a), this.search() },
                _moreResultsClick: function(a) {
                    a.preventDefault();
                    var b = a.target;
                    a = parseInt(v.get(b, "data-source-index"), 10);
                    var b = parseInt(v.get(b, "data-index"), 10),
                        c = this.searchResults;
                    c && c[a] && (a = c[a][b]) && this.select(a)
                },
                _showMoreResultsClick: function(a) {
                    a.preventDefault();
                    if (a = r.byId(this._moreResultsId)) {
                        w.toggle(a, this.css.searchShowMoreResults);
                        var b = r.byId(this._moreResultsId + "_show");
                        b && (w.contains(a, this.css.searchShowMoreResults) ? v.set(b, "textContent", E.widgets.Search.main.hideMoreResults) : v.set(b, "textContent", E.widgets.Search.main.showMoreResults))
                    }
                },
                _featureLayerLoaded: function(a) {
                    var b = new d;
                    if (a.loaded) b.resolve(a);
                    else if (a.loadError) b.reject(this._error("Layer failed to load."));
                    else {
                        var c, f;
                        c = e.once(a, "load", n.hitch(this, function() {
                            f.remove();
                            b.resolve(a)
                        }));
                        f = e.once(a, "error", n.hitch(this, function() {
                            c.remove();
                            b.reject(this._error("Layer could not be loaded."))
                        }))
                    }
                    return b.promise
                },
                _getObjectSize: function(a) {
                    var b = 0,
                        c;
                    for (c in a) a.hasOwnProperty(c) && b++;
                    return b
                },
                _sourcesEvent: function(b, c) {
                    var d = v.get(c, "data-index"),
                        e = h("li", this.sourcesNode);
                    c = a.indexOf(e, c);
                    d !== this._allIndex && (d = parseInt(d, 10));
                    "click" === b.type || b.keyCode === f.ENTER ? (this.set("activeSourceIndex", d),
                        J.focus(this.inputNode), this._hideSourcesMenu()) : b.keyCode === f.UP_ARROW ? (b.stopPropagation(), b.preventDefault(), b = c - 1, 0 > b ? J.focus(this.sourcesBtnNode) : J.focus(e[b])) : b.keyCode === f.DOWN_ARROW ? (b.stopPropagation(), b.preventDefault(), b = c + 1, b >= e.length ? J.focus(this.sourcesBtnNode) : J.focus(e[b])) : b.keyCode === f.ESCAPE && (this._hideSourcesMenu(), J.focus(this.inputNode))
                },
                _suggestionsEvent: function(b, c) {
                    var d = v.get(c, "data-source-index"),
                        e = parseInt(v.get(c, "data-index"), 10),
                        g = h("li", this.suggestionsNode),
                        m = this.sources;
                    c = a.indexOf(g, c);
                    d !== this._allIndex && (d = parseInt(d, 10));
                    var n;
                    this._clearQueryTimeout();
                    "click" === b.type || b.keyCode === f.ENTER ? ((g = this.suggestResults) && g[d] && g[d][e] && (n = g[d][e]), n && (n.index = d, m[d].featureLayer ? (d = m[d].featureLayer.objectIdField, n[this._objectIdIdentifier] = n.feature.attributes[d], this.set("value", this._getSuggestionName(n)), this.set("selectedFeatureId", n.feature.attributes[d])) : n.magicKey && n.text && (this.set("value", n.text), this.set("magicKey", n.magicKey)), this.search(n),
                        J.focus(this.inputNode))) : b.keyCode === f.BACKSPACE || b.keyCode === f.DELETE ? J.focus(this.inputNode) : b.keyCode === f.UP_ARROW ? (b.stopPropagation(), b.preventDefault(), n = c - 1, 0 > n ? J.focus(this.inputNode) : J.focus(g[n])) : b.keyCode === f.DOWN_ARROW ? (b.stopPropagation(), b.preventDefault(), n = c + 1, n >= g.length ? J.focus(this.inputNode) : J.focus(g[n])) : b.keyCode === f.ESCAPE && (this._hideMenus(), J.focus(this.inputNode))
                },
                _getResultName: function(a) {
                    var b;
                    a.hasOwnProperty("name") && null !== a.name && (b = a.name.toString());
                    b || (b = E.widgets.Search.main.untitledResult);
                    return b
                },
                _getSuggestionName: function(a) {
                    var b;
                    a.hasOwnProperty("name") && null !== a.name && (b = a.name.toString());
                    a = a.text || b;
                    a || (a = E.widgets.Search.main.untitledResult);
                    return a
                },
                _searchResultHTML: function(a) {
                    var b = "";
                    if (a.feature && a.feature.attributes && a.feature.attributes.Addr_type && "LatLong" === a.feature.attributes.Addr_type) {
                        var c = a.name.split(" "),
                            d, e;
                        2 === c.length && (d = c[0], e = c[1]);
                        e && d ? (a = parseFloat(d), e = parseFloat(e), c = e + ", " + a, b += '\x3cdiv class\x3d"' + this.css.searchMoreResultsItem + '"\x3e', b += '\x3cdiv class\x3d"' +
                            this.css.latLonHeader + '"\x3e' + E.widgets.Search.main.lonlat + "\x3c/div\x3e", b = b + (a + ", " + e) + "\x3c/div\x3e" + ('\x3cdiv class\x3d"' + this.css.searchMoreResultsItem + '"\x3e'), a === e || 90 < a || -90 > a || 180 < e || -180 > e || (b += '\x3cdiv class\x3d"' + this.css.latLonHeader + '"\x3e' + E.widgets.Search.main.reverseLonLatHeader + "\x3c/div\x3e", b = b + ('\x3ca data-switch-coordinates\x3d"' + c + '" tabindex\x3d"0" href\x3d"#"\x3e' + c + "\x3c/a\x3e") + "\x3c/div\x3e")) : b = a.name
                    } else b = a.name;
                    return b
                },
                _moreResultsHTML: function(a) {
                    var b = "",
                        c = "",
                        d = this.searchResults,
                        e = this.sources,
                        f = 0;
                    if (d) {
                        var c = c + ('\x3cdiv class\x3d"' + this.css.searchMoreResultsItem + '"\x3e'),
                            c = c + ('\x3ca href\x3d"#" id\x3d"' + this._moreResultsId + '_show"\x3e' + E.widgets.Search.main.showMoreResults + "\x3c/a\x3e"),
                            c = c + "\x3c/div\x3e" + ('\x3cdiv class\x3d"' + this.css.searchMoreResultsList + '"\x3e'),
                            c = c + ('\x3cdiv id\x3d"' + this._moreResultsId + '_list"\x3e'),
                            g;
                        for (g in d)
                            if (d[g]) {
                                var h = d[g].length;
                                if (h) {
                                    var m = 1 === h && d[g][0] === a;
                                    if (1 < this._getObjectSize(d) && !m) var n = this._getSourceName(g),
                                        c = c + ('\x3cdiv class\x3d"' + this.css.searchMoreResultsListHeader + '"\x3e' + n + "\x3c/div\x3e");
                                    if (h && !m) {
                                        c += "\x3cul\x3e";
                                        n = e[g].maxResults || this.maxResults;
                                        for (m = 0; m < h && m < n; ++m)
                                            if (d[g][m] !== a) {
                                                var p = this._getResultName(d[g][m]),
                                                    c = c + ('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"' + m + '" data-source-index\x3d"' + g + '" href\x3d"#"\x3e' + p + "\x3c/a\x3e\x3c/li\x3e");
                                                f++
                                            }
                                        c += "\x3c/ul\x3e"
                                    }
                                }
                            }
                        c += "\x3c/div\x3e\x3c/div\x3e"
                    }
                    f && (b += c);
                    return b
                },
                _validField: function(a, b) { return a.getField(b) },
                _validFields: function(a, b) {
                    if (a &&
                        b && b.length) {
                        for (var c = 0; c < b.length; c++)
                            if (!this._validField(a, b[c])) return !1;
                        return !0
                    }
                    return !1
                },
                _getCodedName: function(a, b) {
                    if (a && a.length)
                        for (var c = 0, d = a.length; c < d; c++) { var e = a[c]; if (e.code === b) return e.name }
                },
                _getCodedValue: function(a, b, c) {
                    if (a && a.length)
                        for (var d = 0, e = a.length; d < e; d++) {
                            var f = a[d],
                                g = f.name,
                                h = b;
                            c || (g = g.toLowerCase(), h = h.toLowerCase());
                            if (g === h) return f.code
                        }
                    return !1
                },
                _whereClause: function(a, b, c, d) {
                    var e = null;
                    if (a) {
                        var f = "";
                        this.reHostedFS.test(b.url) && this._containsNonLatinCharacter(a) &&
                            (f = "N");
                        if (c && c.length)
                            for (var g = 0, h = c.length; g < h; g++) {
                                var m = "",
                                    n = a.replace(/\'/g, "''"),
                                    m = c[g],
                                    p = b.getField(m),
                                    q = b.getDomain(m);
                                q && "codedValue" === q.type && (n = this._getCodedValue(q.codedValues, n, d));
                                !1 !== n && (p = p.type, "esriFieldTypeString" === p || "esriFieldTypeDate" === p ? m = d ? m + " \x3d " + f + "'" + n + "'" : "UPPER(" + m + ") LIKE " + f + "'%" + n.toUpperCase() + "%'" : "esriFieldTypeOID" === p || "esriFieldTypeSmallInteger" === p || "esriFieldTypeInteger" === p || "esriFieldTypeSingle" === p || "esriFieldTypeDouble" === p ? (n = parseFloat(n), m = isNaN(n) ?
                                    !1 : m + " \x3d " + n) : m = m + " \x3d " + n, m && (e = e ? e + " or " : "", e += m))
                            }
                    }
                    return e
                },
                _suggest: function(b) {
                    b || (b = { index: this.activeSourceIndex, text: this.value });
                    var c = new d,
                        e = b.index,
                        f = this.sources[e],
                        g = this.enableSuggestions;
                    f.hasOwnProperty("enableSuggestions") && (g = f.enableSuggestions);
                    var h = 0,
                        m;
                    b.hasOwnProperty("text") && b.text && (m = n.trim(b.text), h = b.text.length);
                    b = f.minCharacters || this.minCharacters;
                    if (g && m && h >= b && this._supportsPagination(f)) {
                        var p = "";
                        f.prefix && (p += f.prefix);
                        p += m;
                        f.suffix && (p += f.suffix);
                        var q =
                            this._defaultSR;
                        this.map && (q = this.map.spatialReference);
                        g = {};
                        f.locator ? (f.categories && (g.categories = f.categories), f.locator.outSpatialReference = q, this.map && f.localSearchOptions && f.localSearchOptions.hasOwnProperty("distance") && f.localSearchOptions.hasOwnProperty("minScale") && (h = this._getScale(), !f.localSearchOptions.minScale || h && h <= parseFloat(f.localSearchOptions.minScale)) && (g.location = this.map.extent.getCenter(), g.distance = f.localSearchOptions.distance), g.text = p, f.useMapExtent && this.map && this.map.extent &&
                                (g.searchExtent = this.map.extent), f.searchExtent && (g.searchExtent = f.searchExtent), g.maxSuggestions = f.maxSuggestions || this.maxSuggestions, f.sourceCountry && (g.countryCode = f.sourceCountry), f.countryCode && (g.countryCode = f.countryCode), f.locator.suggestLocations(g).then(n.hitch(this, function(a) { c.resolve(a) }), n.hitch(this, function(a) {
                                    a || (a = this._error("Locator suggestLocations could not be performed."));
                                    c.reject(a)
                                }))) : f.featureLayer ? this._featureLayerLoaded(f.featureLayer).then(n.hitch(this, function() {
                                var b =
                                    this._getDisplayField(f),
                                    d = f.searchFields || [b],
                                    g = [];
                                f.suggestionTemplate ? f.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g, function(a, b) { g.push(b) }) : g = [b]; - 1 === a.indexOf(g, f.featureLayer.objectIdField) && g.push(f.featureLayer.objectIdField);
                                var b = this._validField(f.featureLayer, b),
                                    h = this._validFields(f.featureLayer, g),
                                    m = this._validFields(f.featureLayer, d);
                                if (b && h && m) {
                                    b = new I;
                                    f.hasOwnProperty("suggestQueryParams") && n.mixin(b, f.suggestQueryParams);
                                    b.outSpatialReference = q;
                                    b.returnGeometry = !1;
                                    b.num = f.maxSuggestions ||
                                        this.maxSuggestions;
                                    b.outFields = g;
                                    f.useMapExtent && this.map && this.map.extent && (b.geometry = this.map.extent);
                                    f.searchExtent && (b.geometry = f.searchExtent);
                                    var r;
                                    if (d = this._whereClause(p, f.featureLayer, d, !1)) b.where = d, r = !0;
                                    r ? f.featureLayer.queryFeatures(b, n.hitch(this, function(a) {
                                        var b;
                                        (a = a.features) && (b = this._hydrateResults(a, e, !0));
                                        c.resolve(b)
                                    }), n.hitch(this, function(a) {
                                        a || (a = this._error("FeatureLayer queryFeatures errored with suggestions"));
                                        c.reject(a)
                                    })) : c.resolve()
                                } else c.reject(this._error("Invalid FeatureLayer field"))
                            })) :
                            c.reject(this._error("Invalid source"))
                    } else c.resolve();
                    return c.promise
                },
                _supportsPagination: function(a) {
                    var b;
                    a.locator ? b = !0 : a.featureLayer && a.featureLayer.advancedQueryCapabilities && a.featureLayer.advancedQueryCapabilities.supportsPagination && (b = !0);
                    return b
                },
                _suggestQueries: function(a) {
                    var b = this.sources,
                        c = this.activeSourceIndex,
                        d = [],
                        e;
                    if (c === this._allIndex)
                        for (c = 0; c < b.length; c++) e = a, e.index = c, e = this._suggest(e), d.push(e);
                    else a.index = c, e = this._suggest(a), d.push(e);
                    return R(d)
                },
                _getPointFromGeometry: function(a) {
                    var b;
                    switch (a.type) {
                        case "extent":
                            b = a.getCenter();
                            break;
                        case "multipoint":
                            b = a.getPoint(0);
                            break;
                        case "point":
                            b = a;
                            break;
                        case "polygon":
                            b = a.getCentroid();
                            break;
                        case "polyline":
                            b = a.getPoint(0, 0)
                    }
                    return b
                },
                _searchQueries: function(a) {
                    a.hasOwnProperty("index") || (a.index = this.activeSourceIndex);
                    var b = [],
                        c;
                    if (a.index === this._allIndex)
                        for (var d = this.sources, e = 0; e < d.length; e++) c = a, c.index = e, c = this._search(c), b.push(c);
                    else a = this._search(a), b.push(a);
                    return R(b)
                },
                _searchButton: function() {
                    this.enableButtonMode &&
                        !this.expanded ? (this.expand(), J.focus(this.inputNode)) : (this._cancelSuggest(), this.search())
                },
                _search: function(a) {
                    a || (a = { text: this.value, magicKey: null, geometry: null, point: null, index: this.activeSourceIndex, latlon: null });
                    this.selectedFeatureId && (a.text = null, a[this._objectIdIdentifier] = this.selectedFeatureId);
                    var b, c = new d,
                        e = a.index,
                        f = this.sources[e],
                        g;
                    a.hasOwnProperty("text") && a.text && (g = n.trim(a.text));
                    if (f) {
                        var h = "";
                        f.prefix && !a.magicKey && (h += f.prefix);
                        h += g;
                        f.suffix && !a.magicKey && (h += f.suffix);
                        var m =
                            this._defaultSR;
                        this.map && (m = this.map.spatialReference);
                        if (f.locator)
                            if (a.hasOwnProperty("text") && g) {
                                var p = {};
                                f.categories && (p.categories = f.categories);
                                f.locationType && (p.locationType = f.locationType);
                                m && (f.locator.outSpatialReference = m);
                                if (this.map && f.localSearchOptions && f.localSearchOptions.hasOwnProperty("distance") && f.localSearchOptions.hasOwnProperty("minScale")) {
                                    var q = this._getScale();
                                    if (!f.localSearchOptions.minScale || q && q <= parseFloat(f.localSearchOptions.minScale)) p.location = this.map.extent.getCenter(),
                                        p.distance = f.localSearchOptions.distance
                                }
                                p.address = {};
                                p.maxLocations = f.maxResults || this.maxResults;
                                f.useMapExtent && this.map && this.map.extent && (p.searchExtent = this.map.extent);
                                f.searchExtent && (p.searchExtent = f.searchExtent);
                                f.sourceCountry && (p.countryCode = f.sourceCountry);
                                f.countryCode && (p.countryCode = f.countryCode);
                                a.magicKey && (p.magicKey = a.magicKey);
                                f.singleLineFieldName ? p.address[f.singleLineFieldName] = h : p.address["Single Line Input"] = h;
                                f.outFields && (p.outFields = f.outFields);
                                f.locator.addressToLocations(p).then(n.hitch(this,
                                    function(a) {
                                        a = this._hydrateResults(a, e, !1);
                                        c.resolve(a)
                                    }), n.hitch(this, function(a) {
                                    a || (a = this._error("Locator addressToLocations could not be performed"));
                                    c.reject(a)
                                }))
                            } else a.geometry ? (b = this._getPointFromGeometry(a.geometry.geometry)) ? this._reverseGeocodePoint(e, b).then(function(a) { c.resolve(a) }, function(a) { c.reject(a) }) : c.reject(this._error("Invalid point to reverse geocode")) : a.point ? this._reverseGeocodePoint(e, a.point).then(function(a) { c.resolve(a) }, function(a) { c.reject(a) }) : a.latlon ? (p = new N(a.latlon,
                                this._defaultSR), this._reverseGeocodePoint(e, p).then(function(a) { c.resolve(a) }, function(a) { c.reject(a) })) : a.hasOwnProperty("text") && !g ? c.resolve([]) : c.reject(this._error("Invalid query type for Locator"));
                        else f.featureLayer ? this._featureLayerLoaded(f.featureLayer).then(n.hitch(this, function() {
                            var d = this._getDisplayField(f),
                                p = f.searchFields || [d],
                                d = this._validField(f.featureLayer, d),
                                q = this._validFields(f.featureLayer, p);
                            if (d && q) {
                                d = new I;
                                f.hasOwnProperty("searchQueryParams") && n.mixin(d, f.searchQueryParams);
                                m && (d.outSpatialReference = m, q = this.map && this.map.getMaxResolution() || 1 / u.getUnitValueForSR(m)) && (d.maxAllowableOffset = q);
                                d.returnGeometry = !0;
                                f.outFields && (d.outFields = f.outFields);
                                var r;
                                a.hasOwnProperty(this._objectIdIdentifier) || (this._supportsPagination(f) && (d.num = f.maxResults || this.maxResults), f.useMapExtent && this.map && this.map.extent && (d.geometry = this.map.extent), f.searchExtent && (d.geometry = f.searchExtent), r = f.exactMatch);
                                a.hasOwnProperty("text") && g ? (p = this._whereClause(h, f.featureLayer, p, r)) ?
                                    (d.where = p, p = !0) : p = !1 : a.hasOwnProperty(this._objectIdIdentifier) ? (d.objectIds = [a[this._objectIdIdentifier]], p = !0) : a.geometry ? (d.geometry = a.geometry, p = !0) : a.point ? (d.geometry = a.point, p = !0) : a.latlon ? (b = new N(a.latlon, this._defaultSR), d.geometry = b, p = !0) : (a.hasOwnProperty("text") && !g ? c.resolve([]) : c.reject(this._error("Invalid query type for FeatureLayer")), p = !1);
                                p ? f.featureLayer.queryFeatures(d, n.hitch(this, function(a) {
                                    a = a.features;
                                    var b;
                                    a && (b = this._hydrateResults(a, e, !1));
                                    c.resolve(b)
                                }), n.hitch(this,
                                    function(a) {
                                        a || (a = this._error("FeatureLayer queryFeatures could not be performed"));
                                        c.reject(a)
                                    })) : c.resolve()
                            } else c.reject(this._error("Invalid FeatureLayer field"))
                        })) : c.reject(this._error("Invalid source"))
                    } else c.reject(this._error("Source is undefined"));
                    return c.promise
                },
                _clearQueryTimeout: function() { this._queryTimer && clearTimeout(this._queryTimer) },
                _formatResults: function(a, b, c) {
                    c = { activeSourceIndex: b, value: c, numResults: 0, numErrors: 0, errors: null, results: null };
                    var d = {},
                        e = {};
                    if (a)
                        if (b === this._allIndex)
                            for (b =
                                0; b < a.length; b++) a[b] && (a[b] instanceof Error ? (d[b] = a[b], c.numErrors++) : (e[b] = a[b], c.numResults += a[b].length));
                        else a[0] && (a[0] instanceof Error ? (d[b] = a[0], c.numErrors++) : (e[b] = a[0], c.numResults += a[0].length));
                    c.numErrors && (c.errors = d);
                    c.numResults && (c.results = e);
                    return c
                },
                _reverseGeocodePoint: function(a, b) {
                    var c = new d,
                        e = this.sources[a];
                    if (b && e) {
                        var f = e.locationToAddressDistance || this.locationToAddressDistance;
                        e.locator.outSpatialReference = this._defaultSR;
                        this.map && (e.locator.outSpatialReference = this.map.spatialReference);
                        e.locator.locationToAddress(b, f, n.hitch(this, function(b) {
                            b = this._hydrateResults([b], a, !1);
                            c.resolve(b)
                        }), n.hitch(this, function(a) {
                            a || (a = this._error("Locator locationToAddress could not be performed"));
                            c.reject(a)
                        }))
                    } else c.reject(this._error("No point or source defined for reverse geocoding"));
                    return c.promise
                },
                _cancelDeferreds: function() {
                    if (this._deferreds && this._deferreds.length)
                        for (var a = 0; a < this._deferreds.length; a++) this._deferreds[a].cancel(this.declaredClass + " cancelling request");
                    this._deferreds = []
                },
                _sourceBtnKey: function(a) {
                    if (a) {
                        var b = h("li", this.sourcesNode);
                        a.keyCode === f.UP_ARROW ? (a.stopPropagation(), a.preventDefault(), this._showSourcesMenu(), (a = b.length) && J.focus(b[a - 1])) : a.keyCode === f.DOWN_ARROW && (a.stopPropagation(), a.preventDefault(), this._showSourcesMenu(), b[0] && J.focus(b[0]))
                    }
                },
                _inputKey: function(a) {
                    if (a) {
                        var b = h("li", this.suggestionsNode),
                            c = this.suggestResults;
                        if (a.keyCode === f.TAB || a.keyCode === f.ESCAPE) this._cancelSuggest(), this._hideMenus();
                        else if (a.keyCode === f.UP_ARROW) a.stopPropagation(),
                            a.preventDefault(), this._cancelSuggest(), c && this._showSuggestionsMenu(), (a = b.length) && J.focus(b[a - 1]);
                        else if (a.keyCode === f.DOWN_ARROW) a.stopPropagation(), a.preventDefault(), this._cancelSuggest(), c && this._showSuggestionsMenu(), b[0] && J.focus(b[0]);
                        else {
                            if (a.ctrlKey || a.metaKey || a.keyCode === f.copyKey || a.keyCode === f.LEFT_ARROW || a.keyCode === f.RIGHT_ARROW || a.keyCode === f.ENTER) return a;
                            this._suggestDelay()
                        }
                    }
                },
                _cancelSuggest: function() {
                    this._cancelDeferreds();
                    this._clearQueryTimeout()
                },
                _suggestDelay: function() {
                    this._cancelSuggest();
                    this._changeValue();
                    this._queryTimer = setTimeout(n.hitch(this, function() { this.suggest() }), this.suggestionDelay)
                },
                _changeValue: function() {
                    this.set("magicKey", null);
                    this.set("selectedFeatureId", null);
                    this._changeAttrValue("value", this.inputNode.value);
                    this._checkStatus()
                },
                _inputClick: function() {
                    this._hideSourcesMenu();
                    this._hideNoResultsMenu()
                },
                _getSourceName: function(a) { return this._sourceNames[a] },
                _loadSources: function(b) {
                    b = a.filter(b, function(a) { return !!a.featureLayer });
                    b = a.map(b, function(a) { return this._featureLayerLoaded(a.featureLayer) },
                        this);
                    return R(b)
                },
                _createSourceNameMap: function(b) {
                    return this._loadSources(b).then(n.hitch(this, function() {
                        var c = a.map(b, function(a) { return a.name || a.featureLayer && a.featureLayer.name || E.widgets.Search.main.untitledSource });
                        this._preventDuplicateSourceNames(b, c);
                        return c
                    }))
                },
                _getDuplicateSourceNameIndexes: function(b) {
                    var c = {},
                        d = [];
                    a.forEach(b, function(a, e) { c.hasOwnProperty(a) ? (-1 === d.indexOf(c[a]) && d.push(c[a]), d.push(e)) : b.lastIndexOf(a) !== e && (c[a] = e) });
                    return d
                },
                _preventDuplicateSourceNames: function(b,
                    c) {
                    if (c && 1 < c.length) {
                        var d = this._getDuplicateSourceNameIndexes(c);
                        a.forEach(d, function(a) { c[a] += this._getFieldsString(b[a]) }, this)
                    }
                },
                _getFieldsString: function(a) {
                    var b = "",
                        c = a.featureLayer;
                    if (c) {
                        a = a.searchFields || [this._getDisplayField(a)];
                        for (var d = 0; d < a.length; d++) var b = 0 === d ? b + ": " : b + ", ",
                            e = a[d],
                            f = c.getFieldLabel(e),
                            b = b + (f || e)
                    }
                    return b
                },
                _splitResult: function(a, b) { b = p.escapeString(b); return a.replace(new RegExp("(^|)(" + b + ")(|$)", "ig"), "$1|$2|$3").split("|") },
                _insertSuggestions: function(a, b) {
                    if (this.enableSuggestionsMenu &&
                        this.suggestionsNode) {
                        this._hideSourcesMenu();
                        this._hideNoResultsMenu();
                        var c, d = this.sources;
                        if (a) {
                            c = x.create("div");
                            for (var e in a)
                                if (a[e] && a[e].length) {
                                    var f = this._getSourceName(e);
                                    1 < d.length && this.activeSourceIndex === this._allIndex && x.create("div", { className: this.css.searchMenuHeader, textContent: f }, c);
                                    for (var f = x.create("ul", { role: "menu" }, c), g = d[e].maxSuggestions || this.maxSuggestions, h = 0; h < a[e].length && h < g; ++h)
                                        for (var m = x.create("li", { "data-index": h, "data-source-index": e, role: "menuitem", tabindex: 0 },
                                                f), n = this._getSuggestionName(a[e][h]), n = this._splitResult(n, b), p = n.length, q = 0; q < p; q++) {
                                            var r = n[q];
                                            r.toLowerCase() === b.toLowerCase() ? x.create("strong", { textContent: r }, m) : (r = document.createTextNode(r), x.place(r, m))
                                        }
                                }
                        }
                        c ? (x.place(c, this.suggestionsNode, "only"), this._showSuggestionsMenu()) : (x.empty(this.suggestionsNode), this._hideSuggestionsMenu())
                    }
                },
                _insertSources: function(a) {
                    if (this.enableSourcesMenu && a && 1 < a.length) {
                        var b, c, d = this.activeSourceIndex,
                            e = x.create("ul", { role: "menu" });
                        this.enableSearchingAll &&
                            (b = "", d === this._allIndex && (b = "active"), x.create("li", { "data-index": this._allIndex, role: "menuitem", className: b, tabIndex: 0, textContent: E.widgets.Search.main.all }, e));
                        for (c = 0; c < a.length; c++) {
                            b = "";
                            c === d && (b = this.css.activeSource);
                            var f = this._getSourceName(c);
                            x.create("li", { "data-index": c, role: "menuitem", className: b, tabIndex: 0, textContent: f }, e)
                        }
                        w.add(this.containerNode, this.css.hasMultipleSources);
                        x.place(e, this.sourcesNode, "only")
                    } else w.remove(this.containerNode, this.css.hasMultipleSources), x.empty(this.sourcesNode)
                },
                _showLoading: function() { w.add(this.containerNode, this.css.searchLoading) },
                _hideLoading: function() { w.remove(this.containerNode, this.css.searchLoading) },
                _checkStatus: function() { this.value ? (w.add(this.containerNode, this.css.hasValue), v.set(this.clearNode, "title", E.widgets.Search.main.clearButtonTitle)) : this.clear() },
                _closePopup: function() { this.enableInfoWindow && this.map && this.map.infoWindow && this.map.infoWindow.hide() },
                _noResults: function(a) {
                    var b;
                    a && (b = n.trim(a));
                    var c = x.create("div", { className: this.css.searchNoResultsBody });
                    a && b ? (x.create("div", { className: this.css.searchNoResultsHeader, textContent: E.widgets.Search.main.noResults }, c), x.create("div", { className: this.css.searchNoResultsText, textContent: L.substitute({ value: '"' + a + '"' }, E.widgets.Search.main.noResultsFound) }, c)) : (a = x.create("div", {}, c), x.create("span", { "aria-hidden": "true", className: this.css.searchNoValueIcon }, a), x.create("span", { className: this.css.searchNoValueText, textContent: E.widgets.Search.main.emptyValue }, a));
                    x.place(c, this.noResultsMenuNode, "only")
                },
                _hideMenus: function() {
                    this._hideSourcesMenu();
                    this._hideSuggestionsMenu();
                    this._hideNoResultsMenu()
                },
                _hideNoResultsMenu: function() { w.remove(this.containerNode, this.css.showNoResults) },
                _showNoResultsMenu: function() {
                    this._hideSourcesMenu();
                    this._hideSuggestionsMenu();
                    w.add(this.containerNode, this.css.showNoResults)
                },
                _hideSourcesMenu: function() { w.remove(this.containerNode, this.css.showSources) },
                _hideSuggestionsMenu: function() { w.remove(this.containerNode, this.css.showSuggestions) },
                _showSourcesMenu: function() {
                    this._hideSuggestionsMenu();
                    this._hideNoResultsMenu();
                    w.add(this.containerNode, this.css.showSources)
                },
                _showSuggestionsMenu: function() {
                    this._hideSourcesMenu();
                    this._hideNoResultsMenu();
                    w.add(this.containerNode, this.css.showSuggestions)
                },
                _toggleSourcesMenu: function() {
                    this._hideSuggestionsMenu();
                    this._hideNoResultsMenu();
                    w.toggle(this.containerNode, this.css.showSources)
                },
                _getFirstStringField: function(a) {
                    if (a && (a = a.fields) && a.length)
                        for (var b = 0; b < a.length; b++) { var c = a[b]; if ("esriFieldTypeString" === c.type) return c.name }
                    return ""
                },
                _getDisplayField: function(a) { return a.displayField || a.featureLayer.displayField || this._getFirstStringField(a.featureLayer) },
                _validLocation: function(a) { return a && "number" === typeof a.x && "number" === typeof a.y },
                _validExtent: function(a) { return a && "number" === typeof a.xmin && "number" === typeof a.ymin && "number" === typeof a.xmax && "number" === typeof a.ymax },
                _hydrateResult: function(a, b, c) {
                    var d = {},
                        e = this._defaultSR,
                        f;
                    b = this.sources[b];
                    this.map && (e = this.map.spatialReference);
                    if (a.hasOwnProperty("text") && a.hasOwnProperty("magicKey")) return a;
                    if (a.hasOwnProperty("geometry")) f = new O(a.toJson()), d.feature = f, (f = d.feature.geometry) && f.setSpatialReference(e);
                    else if (a.hasOwnProperty("location") && this._validLocation(a.location)) {
                        var g = new N(a.location.x, a.location.y, e);
                        f = {};
                        a.hasOwnProperty("attributes") && (f = a.attributes);
                        a.hasOwnProperty("address") && "object" === typeof a.address && n.mixin(f, a.address);
                        a.hasOwnProperty("score") && (f.score = a.score);
                        d.feature = new O(g, null, f, null)
                    }!d.feature && c && (f = {}, a.hasOwnProperty("attributes") && (f = a.attributes),
                        a.hasOwnProperty("score") && (f.score = a.score), d.feature = new O(null, null, f, null));
                    if (d.feature) {
                        if (a.hasOwnProperty("extent") && this._validExtent(a.extent)) d.extent = new y(a.extent), d.extent.setSpatialReference(e);
                        else if (d.feature && d.feature.geometry) switch (d.feature.geometry.type) {
                            case "extent":
                                d.extent = d.feature.geometry;
                                break;
                            case "multipoint":
                                d.extent = q.getDenormalizedExtent(d.feature.geometry);
                                break;
                            case "polygon":
                                d.extent = q.getDenormalizedExtent(d.feature.geometry);
                                break;
                            case "polyline":
                                d.extent =
                                    q.getDenormalizedExtent(d.feature.geometry);
                                break;
                            case "point":
                                this.map ? (e = this.zoomScale, b && b.zoomScale && (e = b.zoomScale), this._getScale() > e ? d.extent = u.getExtentForScale(this.map, e).centerAt(d.feature.geometry) : d.extent = this.map.extent.centerAt(d.feature.geometry)) : d.extent = new y({ xmin: d.feature.geometry.x - .25, ymin: d.feature.geometry.y - .25, xmax: d.feature.geometry.x + .25, ymax: d.feature.geometry.y + .25, spatialReference: this._defaultSR })
                        } else d.extent = null;
                        d.name = "";
                        b.featureLayer ? b.suggestionTemplate &&
                            c ? d.name = L.substitute(a.attributes, b.suggestionTemplate) : b.searchTemplate ? d.name = L.substitute(a.attributes, b.searchTemplate) : (f = this._getDisplayField(b), c = b.featureLayer.getField(f), e = b.featureLayer.getDomain(f), f && a.hasOwnProperty("attributes") && a.attributes.hasOwnProperty(f) && (a = a.attributes[f], e && "codedValue" === e.type ? d.name = this._getCodedName(e.codedValues, a) : c && "esriFieldTypeDate" === c.type && !isNaN(a) ? d.name = B.format(new Date(a)) : d.name = a)) : a.address && b.searchTemplate ? d.name = L.substitute(a.address,
                                b.searchTemplate) : a.hasOwnProperty("name") ? d.name = a.name : a.hasOwnProperty("attributes") && "object" === typeof a.attributes && a.attributes.LongLabel ? d.name = a.attributes.LongLabel : a.hasOwnProperty("attributes") && "object" === typeof a.attributes && a.attributes.Match_addr ? (d.name = a.attributes.Match_addr, a.attributes.Addr_type && "POI" === a.attributes.Addr_type && a.attributes.StAddr && a.attributes.City ? d.name += " - " + a.attributes.StAddr + ", " + a.attributes.City : a.attributes.Addr_type && "POI" === a.attributes.Addr_type &&
                                a.attributes.City && (d.name += " - " + a.attributes.City)) : a.hasOwnProperty("address") && "string" === typeof a.address ? d.name = a.address : a.hasOwnProperty("address") && "object" === typeof a.address && a.address.hasOwnProperty("Address") ? a.address.hasOwnProperty("Match_addr") ? d.name = a.address.Match_addr : a.address.hasOwnProperty("Address") && (d.name = a.address.Address) : d.feature && d.feature.geometry && (d.name = d.feature.geometry.x + "," + d.feature.geometry.y);
                        b.featureLayer && d.feature && Y(d.feature, b.featureLayer);
                        return d
                    }
                },
                _getScale: function() {
                    var a;
                    this.map && "function" === typeof this.map.getScale && (a = this.map.getScale());
                    return a
                },
                _hydrateResults: function(a, b, c, d) {
                    d = [];
                    var e = 0;
                    if (a && a.length)
                        for (e; e < a.length; e++) {
                            var f = this._hydrateResult(a[e], b, c);
                            f && d.push(f)
                        }
                    return d
                },
                _containsNonLatinCharacter: function(a) {
                    for (var b = 0; b < a.length; b++)
                        if (255 < a.charCodeAt(b)) return !0;
                    return !1
                },
                _setPlaceholder: function(a) {
                    var b = "",
                        c = this.sources[a];
                    a === this._allIndex ? b = this.allPlaceholder || E.widgets.Search.main.allPlaceholder : c && c.placeholder &&
                        (b = c.placeholder);
                    var d = E.widgets.Search.main.all;
                    c && (d = this._getSourceName(a));
                    v.set(this.sourceNameNode, "textContent", d);
                    v.set(this.inputNode, "placeholder", b);
                    v.set(this.inputNode, "title", b)
                },
                _updateActiveSource: function() {
                    var a = this.sources,
                        b = this.activeSourceIndex,
                        c;
                    a && a[b] && (c = a[b]);
                    c ? this.set("activeSource", c) : this.set("activeSource", null)
                },
                _updateVisible: function() { this.visible ? this.show() : this.hide() },
                _updateButtonMode: function(a) {
                    a ? (w.toggle(this.containerNode, this.css.searchExpanded, this.expanded),
                        w.toggle(this.containerNode, this.css.searchCollapsed, !this.expanded), w.add(this.containerNode, this.css.hasButtonMode)) : (w.remove(this.containerNode, this.css.searchExpanded), w.remove(this.containerNode, this.css.searchCollapsed), w.remove(this.containerNode, this.css.hasButtonMode))
                },
                _setDefaultActiveSourceIndex: function(a) { a && 1 === a.length || !this.enableSearchingAll ? this.set("activeSourceIndex", 0) : this.set("activeSourceIndex", this._allIndex) },
                _setEnableSourcesMenuAttr: function(a) {
                    this._set("enableSourcesMenu",
                        a);
                    this._created && this._insertSources(this.sources)
                },
                _setEnableSearchingAllAttr: function(a) {
                    this._set("enableSearchingAll", a);
                    this._created && (this._setDefaultActiveSourceIndex(this.sources), this._hideMenus(), this._insertSources(this.sources))
                },
                _setSourcesAttr: function(a) {
                    this._createSourceNameMap(a).then(n.hitch(this, function(b) {
                        this._sourceNames = b;
                        this._created && (this._setDefaultActiveSourceIndex(a), this._hideMenus(), this._insertSources(a))
                    }));
                    this._set("sources", a)
                },
                _setAllPlaceholderAttr: function(a) {
                    this._set("allPlaceholder",
                        a);
                    this._created && this._setPlaceholder(this.activeSourceIndex)
                },
                _setActiveSourceIndexAttr: function(a) {
                    this._set("activeSourceIndex", a);
                    this._updateActiveSource();
                    this._created && (this._setPlaceholder(a), this._hideMenus(), this._insertSources(this.sources))
                },
                _setMaxLengthAttr: function(a) {
                    this._set("maxLength", a);
                    this._created && v.set(this.inputNode, "maxLength", a)
                },
                _setValueAttr: function(a) {
                    this.set("magicKey", null);
                    this.set("selectedFeatureId", null);
                    this._set("value", a);
                    this._created && (v.set(this.inputNode,
                        "value", a), this._checkStatus())
                },
                _setVisibleAttr: function(a) {
                    this._set("visible", a);
                    this._created && this._updateVisible()
                },
                _setEnableButtonModeAttr: function(a) {
                    this._set("enableButtonMode", a);
                    this._created && this._updateButtonMode(a)
                },
                _setThemeAttr: function(a) {
                    this._created && (w.remove(this.domNode, this.theme), w.add(this.domNode, a));
                    this._set("theme", a)
                }
            });
            n.setObject("dijit.Search", g, K);
            return g
        })
}, "esri/tasks/locator": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p) {
            b = b(m, {
                declaredClass: "esri.tasks.Locator",
                _eventMap: { "address-to-locations-complete": ["addresses"], "addresses-to-locations-complete": ["addresses"], "location-to-address-complete": ["address"], "suggest-locations-complete": ["suggestions"] },
                constructor: function(a) {
                    this._geocodeHandler = g.hitch(this, this._geocodeHandler);
                    this._geocodeAddressesHandler = g.hitch(this, this._geocodeAddressesHandler);
                    this._reverseGeocodeHandler = g.hitch(this, this._reverseGeocodeHandler);
                    this.registerConnectEvents()
                },
                outSpatialReference: null,
                setOutSpatialReference: function(a) { this.outSpatialReference = a },
                _geocodeHandler: function(a, b, c, d, e) {
                    try {
                        var f = a.candidates,
                            g;
                        b = [];
                        var h, m = f.length,
                            n = a.spatialReference,
                            r;
                        for (h = 0; h < m; h++) {
                            g = f[h];
                            if (r = g.location) r.spatialReference = n;
                            b[h] = new p(g)
                        }
                        this._successHandler([b], "onAddressToLocationsComplete", c, e)
                    } catch (H) { this._errorHandler(H, d, e) }
                },
                _geocodeAddressesHandler: function(a, b, c, d, e) {
                    try {
                        var f = a.locations;
                        b = [];
                        var g, h = f.length,
                            m = a.spatialReference,
                            n;
                        for (g = 0; g < h; g++) {
                            if (n =
                                f[g].location) n.spatialReference = m;
                            b[g] = new p(f[g])
                        }
                        this._successHandler([b], "onAddressesToLocationsComplete", c, e)
                    } catch (A) { this._errorHandler(A, d, e) }
                },
                addressToLocations: function(b, d, f, m, n) {
                    var p, r, t, v, w, x, H, J;
                    b.address && (m = f, f = d, d = b.outFields, n = b.searchExtent, J = b.countryCode, p = b.magicKey, r = b.distance, H = b.categories, b.location && this.normalization && (t = b.location.normalize()), v = b.locationType, w = b.maxLocations, x = b.forStorage, b = b.address);
                    n && (n = n.shiftCentralMeridian());
                    var L = this.outSpatialReference;
                    b = this._encode(g.mixin({}, this._url.query, b, { f: "json", outSR: L && c.toJson(L.toJson()), outFields: d && d.join(",") || null, searchExtent: n && c.toJson(n.toJson()), category: H && H.join(",") || null, countryCode: J || null, magicKey: p || null, distance: r || null, location: t || null, locationType: v || null, maxLocations: w || null, forStorage: x || null }));
                    var M = this._geocodeHandler,
                        K = this._errorHandler,
                        P = new a(h._dfdCanceller);
                    P._pendingDfd = e({
                        url: this._url.path + "/findAddressCandidates",
                        content: b,
                        callbackParamName: "callback",
                        load: function(a,
                            b) { M(a, b, f, m, P) },
                        error: function(a) { K(a, m, P) }
                    });
                    return P
                },
                suggestLocations: function(b) {
                    var d;
                    d = new a(h._dfdCanceller);
                    b.hasOwnProperty("location") && this.normalization && (b.location = b.location.normalize());
                    b.searchExtent && (b.searchExtent = b.searchExtent.shiftCentralMeridian());
                    b = this._encode(g.mixin({}, this._url.query, {
                        f: "json",
                        text: b.text,
                        maxSuggestions: b.maxSuggestions,
                        searchExtent: b.searchExtent && c.toJson(b.searchExtent.toJson()),
                        category: b.categories && b.categories.join(",") || null,
                        countryCode: b.countryCode ||
                            null,
                        location: b.location || null,
                        distance: b.distance || null
                    }, { f: "json" }));
                    b = e({ url: this._url.path + "/suggest", content: b, callbackParamName: "callback" });
                    d._pendingDfd = b;
                    b.then(g.hitch(this, function(a) {
                        a = a.suggestions || [];
                        this.onSuggestLocationsComplete(a);
                        d.resolve(a)
                    }), g.hitch(this, function(a) {
                        this._errorHandler(a);
                        d.reject(a)
                    }));
                    return d
                },
                addressesToLocations: function(b, d, f) {
                    var m = this.outSpatialReference,
                        p = [],
                        r = b.categories,
                        v = b.locationType,
                        w = b.countryCode;
                    n.forEach(b.addresses, function(a, b) { p.push({ attributes: a }) });
                    b = this._encode(g.mixin({}, this._url.query, { category: r && r.join(",") || null, locationType: v || null, sourceCountry: w || null }, { addresses: c.toJson({ records: p }) }, { f: "json", outSR: m && c.toJson(m.toJson()) }));
                    var F = this._geocodeAddressesHandler,
                        D = this._errorHandler,
                        A = new a(h._dfdCanceller);
                    A._pendingDfd = e({ url: this._url.path + "/geocodeAddresses", content: b, callbackParamName: "callback", load: function(a, b) { F(a, b, d, f, A) }, error: function(a) { D(a, f, A) } });
                    return A
                },
                _reverseGeocodeHandler: function(a, b, c, d, e) {
                    try {
                        var f = new p({
                            address: a.address,
                            location: a.location,
                            score: 100
                        });
                        this._successHandler([f], "onLocationToAddressComplete", c, e)
                    } catch (E) { this._errorHandler(E, d, e) }
                },
                locationToAddress: function(b, d, f, m) {
                    b && this.normalization && (b = b.normalize());
                    var n = this.outSpatialReference;
                    b = this._encode(g.mixin({}, this._url.query, { outSR: n && c.toJson(n.toJson()), location: b && c.toJson(b.toJson()), distance: d, f: "json" }));
                    var p = this._reverseGeocodeHandler,
                        r = this._errorHandler,
                        t = new a(h._dfdCanceller);
                    t._pendingDfd = e({
                        url: this._url.path + "/reverseGeocode",
                        content: b,
                        callbackParamName: "callback",
                        load: function(a, b) { p(a, b, f, m, t) },
                        error: function(a) { r(a, m, t) }
                    });
                    return t
                },
                onSuggestLocationsComplete: function() {},
                onAddressToLocationsComplete: function() {},
                onAddressesToLocationsComplete: function() {},
                onLocationToAddressComplete: function() {}
            });
            g.setObject("tasks.Locator", b, f);
            return b
        })
}, "esri/tasks/AddressCandidate": function() {
    define(["dojo/_base/declare", "dojo/_base/lang", "dojo/has", "../kernel", "../geometry/Point"], function(b, g, n, a, c) {
        b = b(null, {
            declaredClass: "esri.tasks.AddressCandidate",
            constructor: function(a) {
                g.mixin(this, a);
                this.location = new c(this.location)
            }
        });
        g.setObject("tasks.AddressCandidate", b, a);
        return b
    })
}, "esri/toolbars/draw": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M) {
            var K = b(t, {
                declaredClass: "esri.toolbars.Draw",
                _eventMap: { "draw-complete": !0, "draw-end": ["geometry"] },
                constructor: function(a, b) {
                    this.markerSymbol = new x(x.STYLE_SOLID, 10, new B(B.STYLE_SOLID, new c([255, 0, 0]), 2), new c([0, 0, 0, .25]));
                    this.lineSymbol = new B(B.STYLE_SOLID, new c([255, 0, 0]), 2);
                    this.fillSymbol = new E(E.STYLE_SOLID, new B(B.STYLE_SOLID, new c([255, 0, 0]), 2), new c([0, 0, 0, .25]));
                    this._points = [];
                    this._mouse = !f("esri-touch") && !f("esri-pointer");
                    this._defaultOptions = { showTooltips: !0, drawTime: 75, tolerance: 8, tooltipOffset: 15 };
                    this._options = g.mixin(g.mixin({}, this._defaultOptions), b || {});
                    if (e("ios") || e("android")) this._options.showTooltips = !1;
                    this._onKeyDownHandler = g.hitch(this, this._onKeyDownHandler);
                    this._onMouseDownHandler = g.hitch(this, this._onMouseDownHandler);
                    this._onMouseUpHandler = g.hitch(this, this._onMouseUpHandler);
                    this._onClickHandler = g.hitch(this, this._onClickHandler);
                    this._onMouseMoveHandler = g.hitch(this, this._onMouseMoveHandler);
                    this._onMouseDragHandler = g.hitch(this, this._onMouseDragHandler);
                    this._onDblClickHandler = g.hitch(this, this._onDblClickHandler);
                    this._updateTooltip = g.hitch(this, this._updateTooltip);
                    this._hideTooltip = g.hitch(this, this._hideTooltip);
                    this._redrawGraphic = g.hitch(this, this._redrawGraphic)
                },
                _geometryType: null,
                respectDrawingVertexOrder: !1,
                setRespectDrawingVertexOrder: function(a) { this.respectDrawingVertexOrder = a },
                setMarkerSymbol: function(a) { this.markerSymbol = a },
                setLineSymbol: function(a) { this.lineSymbol = a },
                setFillSymbol: function(a) { this.fillSymbol = a },
                activate: function(b, c) {
                    this._geometryType && this.deactivate();
                    var d = this.map,
                        e = a.connect,
                        h = K;
                    this._options = g.mixin(g.mixin({}, this._options), c || {});
                    d.navigationManager.setImmediateClick(!1);
                    switch (b) {
                        case h.ARROW:
                        case h.LEFT_ARROW:
                        case h.RIGHT_ARROW:
                        case h.UP_ARROW:
                        case h.DOWN_ARROW:
                        case h.TRIANGLE:
                        case h.CIRCLE:
                        case h.ELLIPSE:
                        case h.RECTANGLE:
                            this._deactivateMapTools(!0, !1, !1, !0);
                            this._onClickHandler_connect = e(d, "onClick", this._onClickHandler);
                            this._mouse ?
                                (this._onMouseDownHandler_connect = e(d, "onMouseDown", this._onMouseDownHandler), this._onMouseDragHandler_connect = e(d, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = e(d, "onMouseUp", this._onMouseUpHandler)) : (this._onMouseDownHandler_connect = e(d, "onMouseDragStart", this._onMouseDownHandler), this._onMouseDragHandler_connect = e(d, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = e(d, "onMouseDragEnd", this._onMouseUpHandler));
                            f("esri-touch") && (this._onMouseDownHandler2_connect =
                                e(d, "onSwipeStart", this._onMouseDownHandler), this._onMouseDragHandler2_connect = e(d, "onSwipeMove", this._onMouseDragHandler), this._onMouseUpHandler2_connect = e(d, "onSwipeEnd", this._onMouseUpHandler));
                            break;
                        case h.POINT:
                            this._onClickHandler_connect = e(d, "onClick", this._onClickHandler);
                            break;
                        case h.LINE:
                        case h.EXTENT:
                        case h.FREEHAND_POLYLINE:
                        case h.FREEHAND_POLYGON:
                            this._deactivateMapTools(!0, !1, !1, !0);
                            this._mouse ? (this._onMouseDownHandler_connect = e(d, "onMouseDown", this._onMouseDownHandler), this._onMouseDragHandler_connect =
                                e(d, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = e(d, "onMouseUp", this._onMouseUpHandler)) : (this._onMouseDownHandler_connect = e(d, "onMouseDragStart", this._onMouseDownHandler), this._onMouseDragHandler_connect = e(d, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = e(d, "onMouseDragEnd", this._onMouseUpHandler));
                            f("esri-touch") && (this._onMouseDownHandler2_connect = e(d, "onSwipeStart", this._onMouseDownHandler), this._onMouseDragHandler2_connect = e(d, "onSwipeMove",
                                this._onMouseDragHandler), this._onMouseUpHandler2_connect = e(d, "onSwipeEnd", this._onMouseUpHandler));
                            break;
                        case h.POLYLINE:
                        case h.POLYGON:
                        case h.MULTI_POINT:
                            d.navigationManager.setImmediateClick(!0);
                            this._onClickHandler_connect = e(d, "onClick", this._onClickHandler);
                            this._onDblClickHandler_connect = e(d, "onDblClick", this._onDblClickHandler);
                            this._dblClickZoom = d.isDoubleClickZoom;
                            d.disableDoubleClickZoom();
                            break;
                        default:
                            return
                    }
                    this._onKeyDown_connect = e(d, "onKeyDown", this._onKeyDownHandler);
                    this._redrawConnect =
                        e(d, "onExtentChange", this._redrawGraphic);
                    this._geometryType = b;
                    this._toggleTooltip(!0);
                    d.snappingManager && "freehandpolyline" !== this._geometryType && "freehandpolygon" !== this._geometryType && (d.snappingManager._startSelectionLayerQuery(), d.snappingManager._setUpSnapping());
                    this.onActivate(this._geometryType)
                },
                deactivate: function() {
                    var b = this.map;
                    this._clear();
                    var c = a.disconnect;
                    c(this._onMouseMoveHandler_connect);
                    c(this._onMouseDownHandler_connect);
                    c(this._onMouseDragHandler_connect);
                    c(this._onMouseUpHandler_connect);
                    c(this._onMouseDownHandler2_connect);
                    c(this._onMouseDragHandler2_connect);
                    c(this._onMouseUpHandler2_connect);
                    c(this._onClickHandler_connect);
                    c(this._onDblClickHandler_connect);
                    c(this._onKeyDown_connect);
                    c(this._redrawConnect);
                    this._onMouseDownHandler_connect = this._onMouseMoveHandler_connect = this._onMouseDragHandler_connect = this._onMouseUpHandler_connect = this._onMouseDownHandler2_connect = this._onMouseDragHandler2_connect = this._onMouseUpHandler2_connect = this._onClickHandler_connect = this._onDblClickHandler_connect =
                        this._onKeyDown_connect = this._redrawConnect = null;
                    b.snappingManager && (b.snappingManager._stopSelectionLayerQuery(), b.snappingManager._killOffSnapping());
                    switch (this._geometryType) {
                        case K.CIRCLE:
                        case K.ELLIPSE:
                        case K.TRIANGLE:
                        case K.ARROW:
                        case K.LEFT_ARROW:
                        case K.RIGHT_ARROW:
                        case K.UP_ARROW:
                        case K.DOWN_ARROW:
                        case K.RECTANGLE:
                        case K.LINE:
                        case K.EXTENT:
                        case K.FREEHAND_POLYLINE:
                        case K.FREEHAND_POLYGON:
                            this._activateMapTools(!0, !1, !1, !0);
                            break;
                        case K.POLYLINE:
                        case K.POLYGON:
                        case K.MULTI_POINT:
                            this._dblClickZoom &&
                                b.enableDoubleClickZoom()
                    }
                    c = this._geometryType;
                    this._geometryType = null;
                    b.navigationManager.setImmediateClick(!1);
                    this._toggleTooltip(!1);
                    this.onDeactivate(c)
                },
                _clear: function() {
                    this._graphic && this.map.graphics.remove(this._graphic, !0);
                    this._graphic = null;
                    this.map.snappingManager && this.map.snappingManager._setGraphic(null);
                    this._points = []
                },
                finishDrawing: function() {
                    var b, c = this._points,
                        d = this.map.spatialReference,
                        e = K,
                        c = c.slice(0, c.length);
                    switch (this._geometryType) {
                        case e.POLYLINE:
                            if (!this._graphic ||
                                2 > c.length) return;
                            b = new A(d);
                            b.addPath([].concat(c));
                            break;
                        case e.POLYGON:
                            if (!this._graphic || 3 > c.length) return;
                            b = new H(d);
                            c = [].concat(c, [c[0].offset(0, 0)]);
                            H.prototype.isClockwise(c) || this.respectDrawingVertexOrder || c.reverse();
                            b.addRing(c);
                            break;
                        case e.MULTI_POINT:
                            b = new J(d), n.forEach(c, function(a) { b.addPoint(a) })
                    }
                    a.disconnect(this._onMouseMoveHandler_connect);
                    this._clear();
                    this._setTooltipMessage(0);
                    this._drawEnd(b)
                },
                _drawEnd: function(a) {
                    if (a) {
                        var b = this.map.spatialReference,
                            c;
                        this.onDrawEnd(a);
                        b && (b.isWebMercator() ? c = D.webMercatorToGeographic(a, !0) : 4326 === b.wkid && (c = F.fromJson(a.toJson())));
                        this.onDrawComplete({ geometry: a, geographicGeometry: c })
                    }
                },
                _normalizeRect: function(a, b, c) {
                    var d = a.x;
                    a = a.y;
                    var e = b.x;
                    b = b.y;
                    return { x: Math.min(d, e), y: Math.max(a, b), width: Math.abs(d - e), height: Math.abs(a - b), spatialReference: c }
                },
                _onMouseDownHandler: function(a) {
                    this._dragged = !1;
                    var b;
                    this.map.snappingManager && (b = this.map.snappingManager._snappingPoint);
                    var c = b || a.mapPoint,
                        d = K;
                    b = this.map;
                    var e = b.spatialReference;
                    this._points.push(c.offset(0, 0));
                    switch (this._geometryType) {
                        case d.LINE:
                            this._graphic = b.graphics.add(new G(new A({
                                paths: [
                                    [
                                        [c.x, c.y],
                                        [c.x, c.y]
                                    ]
                                ],
                                spatialReference: e
                            }), this.lineSymbol), !0);
                            b.snappingManager && b.snappingManager._setGraphic(this._graphic);
                            break;
                        case d.FREEHAND_POLYLINE:
                            this._oldPoint = a.screenPoint;
                            c = new A(e);
                            c.addPath(this._points);
                            this._graphic = b.graphics.add(new G(c, this.lineSymbol), !0);
                            b.snappingManager && b.snappingManager._setGraphic(this._graphic);
                            break;
                        case d.CIRCLE:
                        case d.ELLIPSE:
                        case d.TRIANGLE:
                        case d.ARROW:
                        case d.LEFT_ARROW:
                        case d.RIGHT_ARROW:
                        case d.UP_ARROW:
                        case d.DOWN_ARROW:
                        case d.RECTANGLE:
                        case d.FREEHAND_POLYGON:
                            this._oldPoint =
                                a.screenPoint, c = new H(e), c.addRing(this._points), this._graphic = b.graphics.add(new G(c, this.fillSymbol), !0), b.snappingManager && b.snappingManager._setGraphic(this._graphic)
                    }
                    f("esri-touch") && a.preventDefault();
                    if (1 === this._points.length) this.onDrawStart()
                },
                _onMouseMoveHandler: function(a) {
                    var b;
                    this.map.snappingManager && (b = this.map.snappingManager._snappingPoint);
                    a = b || a.mapPoint;
                    b = this._graphic.geometry;
                    switch (this._geometryType) {
                        case K.POLYLINE:
                        case K.POLYGON:
                            var c = this._points.length,
                                d = !!b.getPoint(0,
                                    c);
                            a = a.offset(0, 0);
                            d ? b.setPoint(0, c, a) : b.insertPoint(0, c, a);
                            this._graphic.setGeometry(b)
                    }
                },
                _onMouseDragHandler: function(a) {
                    if (this._graphic || this._points.length)
                        if (f("esri-touch") && !this._points.length) a.preventDefault();
                        else {
                            this._dragged = !0;
                            var b;
                            this.map.snappingManager && (b = this.map.snappingManager._snappingPoint);
                            var c = this._points[0],
                                d = b || a.mapPoint,
                                e = this.map,
                                h = e.spatialReference;
                            b = this._graphic;
                            var m = K,
                                n = e.toScreen(c),
                                p = e.toScreen(d),
                                r = [],
                                r = p.x - n.x,
                                p = p.y - n.y,
                                t = Math.sqrt(r * r + p * p);
                            switch (this._geometryType) {
                                case m.CIRCLE:
                                    this._hideTooltip();
                                    b.geometry = H.createCircle({ center: n, r: t, numberOfPoints: 60, map: e });
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.ELLIPSE:
                                    this._hideTooltip();
                                    b.geometry = H.createEllipse({ center: n, longAxis: r, shortAxis: p, numberOfPoints: 60, map: e });
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.TRIANGLE:
                                    this._hideTooltip();
                                    r = [
                                        [0, -t],
                                        [.8660254037844386 * t, .5 * t],
                                        [-.8660254037844386 * t, .5 * t],
                                        [0, -t]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.ARROW:
                                    this._hideTooltip();
                                    c = p / t;
                                    e = r / t;
                                    d = .25 * e * t;
                                    h = .25 * t / (p / r);
                                    t *=
                                        .25 * c;
                                    r = [
                                        [r, p],
                                        [r - d * (1 + 24 / h), p + 24 * e - t],
                                        [r - d * (1 + 12 / h), p + 12 * e - t],
                                        [-12 * c, 12 * e],
                                        [12 * c, -12 * e],
                                        [r - d * (1 - 12 / h), p - 12 * e - t],
                                        [r - d * (1 - 24 / h), p - 24 * e - t],
                                        [r, p]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.LEFT_ARROW:
                                    this._hideTooltip();
                                    r = 0 >= r ? [
                                        [r, 0],
                                        [.75 * r, p],
                                        [.75 * r, .5 * p],
                                        [0, .5 * p],
                                        [0, -.5 * p],
                                        [.75 * r, -.5 * p],
                                        [.75 * r, -p],
                                        [r, 0]
                                    ] : [
                                        [0, 0],
                                        [.25 * r, p],
                                        [.25 * r, .5 * p],
                                        [r, .5 * p],
                                        [r, -.5 * p],
                                        [.25 * r, -.5 * p],
                                        [.25 * r, -p],
                                        [0, 0]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.RIGHT_ARROW:
                                    this._hideTooltip();
                                    r = 0 <= r ? [
                                        [r, 0],
                                        [.75 * r, p],
                                        [.75 * r, .5 * p],
                                        [0, .5 * p],
                                        [0, -.5 * p],
                                        [.75 * r, -.5 * p],
                                        [.75 * r, -p],
                                        [r, 0]
                                    ] : [
                                        [0, 0],
                                        [.25 * r, p],
                                        [.25 * r, .5 * p],
                                        [r, .5 * p],
                                        [r, -.5 * p],
                                        [.25 * r, -.5 * p],
                                        [.25 * r, -p],
                                        [0, 0]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.UP_ARROW:
                                    this._hideTooltip();
                                    r = 0 >= p ? [
                                        [0, p],
                                        [-r, .75 * p],
                                        [-.5 * r, .75 * p],
                                        [-.5 * r, 0],
                                        [.5 * r, 0],
                                        [.5 * r, .75 * p],
                                        [r, .75 * p],
                                        [0, p]
                                    ] : [
                                        [0, 0],
                                        [-r, .25 * p],
                                        [-.5 * r, .25 * p],
                                        [-.5 * r, p],
                                        [.5 * r, p],
                                        [.5 * r, .25 * p],
                                        [r, .25 * p],
                                        [0, 0]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.DOWN_ARROW:
                                    this._hideTooltip();
                                    r = 0 <= p ? [
                                        [0, p],
                                        [-r, .75 * p],
                                        [-.5 * r, .75 * p],
                                        [-.5 * r, 0],
                                        [.5 * r, 0],
                                        [.5 * r, .75 * p],
                                        [r, .75 * p],
                                        [0, p]
                                    ] : [
                                        [0, 0],
                                        [-r, .25 * p],
                                        [-.5 * r, .25 * p],
                                        [-.5 * r, p],
                                        [.5 * r, p],
                                        [.5 * r, .25 * p],
                                        [r, .25 * p],
                                        [0, 0]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.RECTANGLE:
                                    this._hideTooltip();
                                    r = [
                                        [0, 0],
                                        [r, 0],
                                        [r, p],
                                        [0, p],
                                        [0, 0]
                                    ];
                                    b.geometry = this._toPolygon(r, n.x, n.y);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.LINE:
                                    b.setGeometry(g.mixin(b.geometry, {
                                        paths: [
                                            [
                                                [c.x, c.y],
                                                [d.x, d.y]
                                            ]
                                        ]
                                    }));
                                    break;
                                case m.EXTENT:
                                    b && e.graphics.remove(b, !0);
                                    b = new L(this._normalizeRect(c, d, h));
                                    b._originOnly = !0;
                                    this._graphic = e.graphics.add(new G(b, this.fillSymbol), !0);
                                    e.snappingManager && e.snappingManager._setGraphic(this._graphic);
                                    break;
                                case m.FREEHAND_POLYLINE:
                                    this._hideTooltip();
                                    if (!1 === this._canDrawFreehandPoint(a)) { f("esri-touch") && a.preventDefault(); return }
                                    this._points.push(a.mapPoint.offset(0, 0));
                                    b.geometry._insertPoints([d.offset(0, 0)], 0);
                                    b.setGeometry(b.geometry);
                                    break;
                                case m.FREEHAND_POLYGON:
                                    this._hideTooltip();
                                    if (!1 === this._canDrawFreehandPoint(a)) { f("esri-touch") && a.preventDefault(); return }
                                    this._points.push(a.mapPoint.offset(0, 0));
                                    b.geometry._insertPoints([d.offset(0, 0)], 0);
                                    b.setGeometry(b.geometry)
                            }
                            f("esri-touch") && a.preventDefault()
                        }
                },
                _canDrawFreehandPoint: function(a) {
                    if (!this._oldPoint) return !1;
                    var b = this._oldPoint.x - a.screenPoint.x,
                        c = this._oldPoint.y - a.screenPoint.y,
                        d = this._options.tolerance;
                    if ((0 > b ? -1 * b : b) < d && (0 > c ? -1 * c : c) < d) return !1;
                    b = new Date;
                    if (b - this._startTime < this._options.drawTime) return !1;
                    this._startTime = b;
                    this._oldPoint = a.screenPoint;
                    return !0
                },
                _onMouseUpHandler: function(a) {
                    if (this._dragged && this._graphic) {
                        0 === this._points.length && this._points.push(a.mapPoint.offset(0, 0));
                        var b;
                        this.map.snappingManager && (b = this.map.snappingManager._snappingPoint);
                        var c = this._points[0];
                        b = b || a.mapPoint;
                        var d = this.map.spatialReference,
                            e = K,
                            g;
                        switch (this._geometryType) {
                            case e.CIRCLE:
                            case e.ELLIPSE:
                            case e.TRIANGLE:
                            case e.ARROW:
                            case e.LEFT_ARROW:
                            case e.RIGHT_ARROW:
                            case e.UP_ARROW:
                            case e.DOWN_ARROW:
                            case e.RECTANGLE:
                                g =
                                    this._graphic.geometry;
                                break;
                            case e.LINE:
                                g = new A({
                                    paths: [
                                        [
                                            [c.x, c.y],
                                            [b.x, b.y]
                                        ]
                                    ],
                                    spatialReference: d
                                });
                                break;
                            case e.EXTENT:
                                g = (new L(this._normalizeRect(c, b, d))).getExtent();
                                break;
                            case e.FREEHAND_POLYLINE:
                                g = new A(d);
                                g.addPath([].concat(this._points, [b.offset(0, 0)]));
                                break;
                            case e.FREEHAND_POLYGON:
                                g = new H(d), c = [].concat(this._points, [b.offset(0, 0), this._points[0].offset(0, 0)]), H.prototype.isClockwise(c) || this.respectDrawingVertexOrder || c.reverse(), g.addRing(c)
                        }
                        f("esri-touch") && a.preventDefault();
                        this._clear();
                        this._drawEnd(g)
                    } else this._clear()
                },
                _onClickHandler: function(b) {
                    var c;
                    this.map.snappingManager && (c = this.map.snappingManager._snappingPoint);
                    c = c || b.mapPoint;
                    b = this.map;
                    var d = b.toScreen(c),
                        e = K;
                    this._points.push(c.offset(0, 0));
                    switch (this._geometryType) {
                        case e.POINT:
                            this.onDrawStart();
                            this._drawEnd(c.offset(0, 0));
                            this._setTooltipMessage(0);
                            break;
                        case e.POLYLINE:
                            1 === this._points.length ? (c = new A(b.spatialReference), c.addPath(this._points), this._graphic = b.graphics.add(new G(c, this.lineSymbol), !0), b.snappingManager &&
                                b.snappingManager._setGraphic(this._graphic), this._onMouseMoveHandler_connect = a.connect(b, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry._insertPoints([c.offset(0, 0)], 0), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol));
                            break;
                        case e.POLYGON:
                            1 === this._points.length ? (c = new H(b.spatialReference), c.addRing(this._points), this._graphic = b.graphics.add(new G(c, this.fillSymbol), !0), b.snappingManager && b.snappingManager._setGraphic(this._graphic),
                                this._onMouseMoveHandler_connect = a.connect(b, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry._insertPoints([c.offset(0, 0)], 0), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol));
                            break;
                        case e.MULTI_POINT:
                            c = this._points;
                            1 === c.length ? (d = new J(b.spatialReference), d.addPoint(c[c.length - 1]), this._graphic = b.graphics.add(new G(d, this.markerSymbol), !0), b.snappingManager && b.snappingManager._setGraphic(this._graphic), this.onDrawStart()) : (this._graphic.geometry.addPoint(c[c.length -
                                1]), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));
                            break;
                        case e.ARROW:
                            this._addShape([
                                [0, 0],
                                [-24, 24],
                                [-24, 12],
                                [-96, 12],
                                [-96, -12],
                                [-24, -12],
                                [-24, -24],
                                [0, 0]
                            ], d.x, d.y);
                            break;
                        case e.LEFT_ARROW:
                            this._addShape([
                                [0, 0],
                                [24, 24],
                                [24, 12],
                                [96, 12],
                                [96, -12],
                                [24, -12],
                                [24, -24],
                                [0, 0]
                            ], d.x, d.y);
                            break;
                        case e.RIGHT_ARROW:
                            this._addShape([
                                [0, 0],
                                [-24, 24],
                                [-24, 12],
                                [-96, 12],
                                [-96, -12],
                                [-24, -12],
                                [-24, -24],
                                [0, 0]
                            ], d.x, d.y);
                            break;
                        case e.UP_ARROW:
                            this._addShape([
                                [0, 0],
                                [-24, 24],
                                [-12, 24],
                                [-12, 96],
                                [12, 96],
                                [12, 24],
                                [24, 24],
                                [0, 0]
                            ], d.x, d.y);
                            break;
                        case e.DOWN_ARROW:
                            this._addShape([
                                [0, 0],
                                [-24, -24],
                                [-12, -24],
                                [-12, -96],
                                [12, -96],
                                [12, -24],
                                [24, -24],
                                [0, 0]
                            ], d.x, d.y);
                            break;
                        case e.TRIANGLE:
                            this._addShape([
                                [0, -48],
                                [41.56921938165306, 24],
                                [-41.56921938165306, 24],
                                [0, -48]
                            ], d.x, d.y);
                            break;
                        case e.RECTANGLE:
                            this._addShape([
                                [0, -96],
                                [96, -96],
                                [96, 0],
                                [0, 0],
                                [0, -96]
                            ], d.x - 48, d.y + 48);
                            break;
                        case e.CIRCLE:
                            this._clear();
                            this.onDrawStart();
                            this._drawEnd(H.createCircle({ center: d, r: 48, numberOfPoints: 60, map: b }));
                            break;
                        case e.ELLIPSE:
                            this._clear(),
                                this.onDrawStart(), this._drawEnd(H.createEllipse({ center: d, longAxis: 48, shortAxis: 24, numberOfPoints: 60, map: b }))
                    }
                    this._setTooltipMessage(this._points.length)
                },
                _addShape: function(a, b, c) {
                    this._setTooltipMessage(0);
                    this._clear();
                    this.onDrawStart();
                    this._drawEnd(this._toPolygon(a, b, c))
                },
                _toPolygon: function(a, b, c) {
                    var d = this.map,
                        e = new H(d.spatialReference);
                    e.addRing(n.map(a, function(a) { return d.toMap({ x: a[0] + b, y: a[1] + c }) }));
                    return e
                },
                _onDblClickHandler: function(b) {
                    var c, d = this._points,
                        e = this.map.spatialReference,
                        g = K;
                    f("esri-touch") && d.push(b.mapPoint);
                    var h = d[d.length - 1],
                        m = d[d.length - 2],
                        d = h && m && h.x === m.x && h.y === m.y ? d.slice(0, d.length - 1) : d.slice(0, d.length);
                    switch (this._geometryType) {
                        case g.POLYLINE:
                            if (!this._graphic || 2 > d.length) {
                                a.disconnect(this._onMouseMoveHandler_connect);
                                this._clear();
                                this._onClickHandler(b);
                                return
                            }
                            c = new A(e);
                            c.addPath([].concat(d));
                            break;
                        case g.POLYGON:
                            if (!this._graphic || 2 > d.length) {
                                a.disconnect(this._onMouseMoveHandler_connect);
                                this._clear();
                                this._onClickHandler(b);
                                return
                            }
                            c = new H(e);
                            b = [].concat(d, [d[0].offset(0, 0)]);
                            H.prototype.isClockwise(b) || this.respectDrawingVertexOrder || b.reverse();
                            c.addRing(b);
                            break;
                        case g.MULTI_POINT:
                            c = new J(e), n.forEach(d, function(a) { c.addPoint(a) })
                    }
                    a.disconnect(this._onMouseMoveHandler_connect);
                    this._clear();
                    this._setTooltipMessage(0);
                    this._drawEnd(c)
                },
                _onKeyDownHandler: function(b) { b.keyCode === h.ESCAPE && (a.disconnect(this._onMouseMoveHandler_connect), this._clear(), this._setTooltipMessage(0)) },
                _toggleTooltip: function(b) {
                    this._options.showTooltips && (b ?
                        this._tooltip || (this._tooltip = m.create("div", { "class": "esriMapTooltip" }, this.map.container), r.isBodyLtr() || p.set(this._tooltip, "direction", "rtl"), this._tooltip.style.display = "none", this._tooltip.style.position = "fixed", this._setTooltipMessage(0), this._onTooltipMouseEnterHandler_connect = a.connect(this.map, "onMouseOver", this._updateTooltip), this._onTooltipMouseLeaveHandler_connect = a.connect(this.map, "onMouseOut", this._hideTooltip), this._onTooltipMouseMoveHandler_connect = a.connect(this.map, "onMouseMove",
                            this._updateTooltip)) : this._tooltip && (a.disconnect(this._onTooltipMouseEnterHandler_connect), a.disconnect(this._onTooltipMouseLeaveHandler_connect), a.disconnect(this._onTooltipMouseMoveHandler_connect), m.destroy(this._tooltip), this._tooltip = null))
                },
                _hideTooltip: function() {
                    var a = this._tooltip;
                    a && (a.style.display = "none")
                },
                _setTooltipMessage: function(a) {
                    var b = this._tooltip;
                    if (b) {
                        var c = "";
                        switch (this._geometryType) {
                            case K.POINT:
                                c = M.toolbars.draw.addPoint;
                                break;
                            case K.ARROW:
                            case K.LEFT_ARROW:
                            case K.RIGHT_ARROW:
                            case K.UP_ARROW:
                            case K.DOWN_ARROW:
                            case K.TRIANGLE:
                            case K.RECTANGLE:
                            case K.CIRCLE:
                            case K.ELLIPSE:
                                c =
                                    M.toolbars.draw.addShape;
                                break;
                            case K.LINE:
                            case K.EXTENT:
                            case K.FREEHAND_POLYLINE:
                            case K.FREEHAND_POLYGON:
                                c = M.toolbars.draw.freehand;
                                break;
                            case K.POLYLINE:
                            case K.POLYGON:
                                c = M.toolbars.draw.start;
                                1 === a ? c = M.toolbars.draw.resume : 2 <= a && (c = M.toolbars.draw.complete);
                                break;
                            case K.MULTI_POINT:
                                c = M.toolbars.draw.addMultipoint, 1 <= a && (c = M.toolbars.draw.finish)
                        }
                        b.innerHTML = c
                    }
                },
                _updateTooltip: function(a) {
                    var b = this._tooltip;
                    if (b) {
                        var c;
                        a.clientX || a.pageY ? (c = a.clientX, a = a.clientY) : (c = a.clientX + d.body().scrollLeft -
                            d.body().clientLeft, a = a.clientY + d.body().scrollTop - d.body().clientTop);
                        b.style.display = "none";
                        p.set(b, { left: c + this._options.tooltipOffset + "px", top: a + "px" });
                        b.style.display = ""
                    }
                },
                _redrawGraphic: function(a, b, c, d) {
                    (c || this.map.wrapAround180) && (a = this._graphic) && a.setGeometry(a.geometry)
                },
                onActivate: function() {},
                onDeactivate: function() {},
                onDrawComplete: function() {},
                onDrawStart: function() {},
                onDrawEnd: function() {}
            });
            g.mixin(K, {
                POINT: "point",
                MULTI_POINT: "multipoint",
                LINE: "line",
                EXTENT: "extent",
                POLYLINE: "polyline",
                POLYGON: "polygon",
                FREEHAND_POLYLINE: "freehandpolyline",
                FREEHAND_POLYGON: "freehandpolygon",
                ARROW: "arrow",
                LEFT_ARROW: "leftarrow",
                RIGHT_ARROW: "rightarrow",
                UP_ARROW: "uparrow",
                DOWN_ARROW: "downarrow",
                TRIANGLE: "triangle",
                CIRCLE: "circle",
                ELLIPSE: "ellipse",
                RECTANGLE: "rectangle"
            });
            g.setObject("toolbars.Draw", K, v);
            return K
        })
}, "esri/toolbars/_toolbar": function() {
    define(["dojo/_base/declare", "dojo/_base/lang", "dojo/has", "../kernel", "../Evented"], function(b, g, n, a, c) {
        b = b([c], {
            declaredClass: "esri.toolbars._Toolbar",
            constructor: function(a) { this.map = a },
            _cursors: { move: "pointer", "move-v": "pointer", "move-gv": "pointer", box0: "nw-resize", box1: "n-resize", box2: "ne-resize", box3: "e-resize", box4: "se-resize", box5: "s-resize", box6: "sw-resize", box7: "w-resize", box8: "pointer" },
            _deactivateMapTools: function(a, b, c, g) {
                var d = this.map;
                a && (this._mapNavState = { isDoubleClickZoom: d.isDoubleClickZoom, isClickRecenter: d.isClickRecenter, isPan: d.isPan, isRubberBandZoom: d.isRubberBandZoom, isKeyboardNavigation: d.isKeyboardNavigation, isScrollWheelZoom: d.isScrollWheelZoom },
                    d.disableDoubleClickZoom(), d.disableClickRecenter(), d.disablePan(), d.disableRubberBandZoom(), d.disableKeyboardNavigation());
                b && d.hideZoomSlider();
                c && d.hidePanArrows();
                g && d.graphics.disableMouseEvents()
            },
            _activateMapTools: function(a, b, c, g) {
                var d = this.map,
                    e = this._mapNavState;
                a && e && (e.isDoubleClickZoom && d.enableDoubleClickZoom(), e.isClickRecenter && d.enableClickRecenter(), e.isPan && d.enablePan(), e.isRubberBandZoom && d.enableRubberBandZoom(), e.isKeyboardNavigation && d.enableKeyboardNavigation(), e.isScrollWheelZoom &&
                    d.enableScrollWheelZoom());
                b && d.showZoomSlider();
                c && d.showPanArrows();
                g && d.graphics.enableMouseEvents()
            },
            _deactivateScrollWheel: function() {
                var a = this.map;
                this._scrollWheelState = { isScrollWheelZoom: a.isScrollWheelZoom, isScrollWheelPan: a.isScrollWheelPan };
                a.disableScrollWheelZoom();
                a.disableScrollWheelPan()
            },
            _activateScrollWheel: function() {
                var a = this.map,
                    b = this._scrollWheelState;
                b && (b.isScrollWheelZoom && a.enableScrollWheelZoom(), b.isScrollWheelPan && a.enableScrollWheelPan())
            }
        });
        g.setObject("toolbars._Toolbar",
            b, a);
        return b
    })
}, "arcgisonline/map/utils/clipOnHorizon": function() { define(["./contains"], function(b) { return function(g) { b([102113, 102100, 3857], g.spatialReference.wkid) && (g.xmin = Math.max(g.xmin, -20037507), g.xmax = Math.min(g.xmax, 20037507), g.ymin = Math.max(g.ymin, -19971868), g.ymax = Math.min(g.ymax, 19971868)); return g } }) }, "arcgisonline/map/utils/createExtentSearchOptions": function() {
    define("dojo/_base/lang dojo/_base/array esri/lang esri/tasks/locator ../../esriGeowConfig ../../sharing/util dojo/i18n!../../nls/arcgisonline".split(" "),
        function(b, g, n, a, c, d, f) {
            function e() {
                var e = b.clone(((c && c.self || {}).helperServices || {}).geocode || []),
                    m = !1;
                n.isDefined(c.geocodeAutoComplete) && (m = c.geocodeAutoComplete);
                g.forEach(e, b.hitch(this, function(b) {
                    b.enableSuggestions = !0 === b.suggest && m ? !0 : !1;
                    delete b.suggest;
                    var c = d.isEsriWorldGeocoder(b);
                    if (c || b.enableSuggestions) c && (b.name = b.name || f.common.esriWorldGeocoder, b.enableSuggestions = m, b.placefinding = b.batch = b.esri = !0, b.outFields = ["Match_addr", "Addr_type", "StAddr", "City"]), b.placeholder = b.placeholder ||
                        f.viewer.findLocationText, b.singleLineFieldName = b.singleLineFieldName || "SingleLine", b.highlightSymbol = null, b.localSearchOptions = { minScale: 3E5, distance: 5E4 };
                    b.locator = new a(b.url)
                }));
                return e = g.filter(e, function(a) { return n.isDefined(a.singleLineFieldName) && n.isDefined(a.placefinding) && a.placefinding })
            }
            return function(a, b) {
                var d = n.isDefined(c.geocodeAutoComplete) ? c.geocodeAutoComplete : !1,
                    f = e();
                a = {
                    map: a,
                    enableSuggestions: d,
                    minCharacters: 0,
                    maxResults: 5,
                    suggestionDelay: 100,
                    value: b || null,
                    autoNavigate: !1,
                    activeSourceIndex: "all",
                    sources: [].concat(f)
                };
                1 === a.sources.length && delete a.activeSourceIndex;
                return a
            }
        })
}, "arcgisonline/sharing/dijit/dialog/BrowseLayersDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,arcgisonline/sharing/util,arcgisonline/sharing/dijit/LayersGrid,dijit/_Widget,dijit/_Templated"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg");
        b.require("dijit.Dialog");
        b.require("arcgisonline.sharing.util");
        b.require("arcgisonline.sharing.dijit.LayersGrid");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.declare("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"browse-layers-dialog" title\x3d"${i18n.title}" execute\x3d""\x3e\r\n    \x3cdiv class\x3d"esriBrowseOptions clearfix"\x3e\r\n      \x3cdiv id\x3d"browse-layers-esri-div" class\x3d"esriBrowseOption" style\x3d"display:none;"\x3e\r\n        \x3cinput id\x3d"browse-layers-esri" dojoAttachPoint\x3d"_onlyEsriCheck" data-dojo-attach-event\x3d"onChange:onEsriCheckChanged" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n        \x3clabel for\x3d"browse-layers-esri"\x3e${i18n.showEsriLayersOnly}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"browse-layers-extent-div"  class\x3d"esriBrowseOption"\x3e\r\n        \x3cinput id\x3d"browse-layers-extent" dojoAttachPoint\x3d"_mapExtentCheck" data-dojo-attach-event\x3d"onChange:onExtentCheckChanged" dojotype\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox" /\x3e\r\n        \x3clabel for\x3d"addContent-within-map"\x3e${i18n.withinMapArea}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"formNode" class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n      \x3cdiv class\x3d"clearfix"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:250px; margin:10px 8px 0;" id\x3d"browse-layers-category-div"\x3e\r\n            \x3cselect id\x3d"browse-layers-category-select" dojoAttachPoint\x3d"_categorySelect" dojoType\x3d"dijit.form.Select" sortByLabel\x3d"false" maxHeight\x3d\'350\' style\x3d"width:240px;"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"search-div" class\x3d"search esriFloatTrailing" style\x3d"width:250px;"\x3e\r\n            \x3cdiv id\x3d"search-form" style\x3d"position:relative;"\x3e\r\n              \x3cinput class\x3d"esriSearchBox" type\x3d"text" dojoType\x3d"dijit.form.TextBox" trim\x3d"true" id\x3d"browse-layers-search-box" dojoAttachPoint\x3d"searchText" dojoAttachEvent\x3d"onKeyPress:_onSearchKeyPress,onFocus:_onSearchBoxFocus,onBlur:_onSearchBoxBlur" alt\x3d"${i18n.searchFor}" title\x3d"${i18n.searchFor}" /\x3e\r\n              \x3cbutton class\x3d"esriLeadingMargin13 esriSearchButton" id\x3d"search-box_submit" alt\x3d"${i18n.searchTitle}" title\x3d"${i18n.searchTitle}" dojoAttachPoint\x3d"searchButton" dojoAttachEvent\x3d"onclick:_onSearchClick"\x3e\x26nbsp;\x26nbsp;\x3c/button\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriBrowseLayersExtent" id\x3d"browse-layers-extent"\x3e\r\n        \x3cdiv style\x3d"position:relative; width:570px;" class\x3d"clearfix" dojoAttachPoint\x3d"esriMapLayersGallery" id\x3d"esriMapLayersGallery" dojoType\x3d"arcgisonline.sharing.dijit.LayersGrid" galleryNodes\x3d"8"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"submitButtons dijitDialogPaneActionBar esriPositionRight0"\x3e\r\n      \x3cinput id\x3d"browse-layers-close" dojoType\x3d"dijit.form.Button" name\x3d"cancel" class\x3d"cancel esriFloatTrailing" type\x3d"button" dojoAttachEvent\x3d"onClick:onClose" label\x3d"${i18n.close}"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
            statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.BrowseLayersDlg); return this._instance } },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").search);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").BrowseLayersDlg);
                this.searchBoxTip =
                    this.i18n.searchBoxTip
            },
            postCreate: function() {
                esriGeowConfig.self.isPortal || b.style(b.byId("browse-layers-esri-div"), "display", "");
                var a = [];
                a.push({ label: this.i18n.categoryAll, category: this.i18n.categoryAll, subCategory: null, tagsQuery: "" });
                a.push({ label: this.i18n.categoryImagery, category: this.i18n.categoryImagery, subCategory: null, tagsQuery: "tags:imagery" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryBasemapImagery,
                    category: this.i18n.categoryImagery,
                    subCategory: this.i18n.subCategoryBasemapImagery,
                    tagsQuery: "tags:baseimagery"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryMultiSpectral, category: this.i18n.categoryImagery, subCategory: this.i18n.subCategoryMultiSpectral, tagsQuery: "tags:multispectral" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryTemporal, category: this.i18n.categoryImagery, subCategory: this.i18n.subCategoryTemporal, tagsQuery: "tags:temporal" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryEvent,
                    category: this.i18n.categoryImagery,
                    subCategory: this.i18n.subCategoryEvent,
                    tagsQuery: "tags:event_imagery"
                });
                a.push({ label: this.i18n.categoryBasemaps, category: this.i18n.categoryBasemaps, subCategory: null, tagsQuery: "tags:basemaps" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryEsriBasemaps, category: this.i18n.categoryBasemaps, subCategory: this.i18n.subCategoryEsriBasemaps, tagsQuery: "tags:esri_basemap" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryPartnerBasemaps,
                    category: this.i18n.categoryBasemaps,
                    subCategory: this.i18n.subCategoryPartnerBasemaps,
                    tagsQuery: "tags:partner_basemap"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryUserBasemaps, category: this.i18n.categoryBasemaps, subCategory: this.i18n.subCategoryUserBasemaps, tagsQuery: "tags:user_basemap" });
                a.push({ label: this.i18n.categoryHistoricalMaps, category: this.i18n.categoryHistoricalMaps, subCategory: null, tagsQuery: "tags:historical" });
                a.push({
                    label: this.i18n.categoryDemographics,
                    category: this.i18n.categoryDemographics,
                    subCategory: null,
                    tagsQuery: "tags:demographics"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryIncome, category: this.i18n.categoryDemographics, subCategory: this.i18n.subCategoryIncome, tagsQuery: "tags:income" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategorySpending, category: this.i18n.categoryDemographics, subCategory: this.i18n.subCategorySpending, tagsQuery: "tags:spending OR tags:behaviors" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" +
                        this.i18n.subCategoryPopulation,
                    category: this.i18n.categoryDemographics,
                    subCategory: this.i18n.subCategoryPopulation,
                    tagsQuery: "tags:population OR tags:housing"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryBusiness, category: this.i18n.categoryDemographics, subCategory: this.i18n.subCategoryBusiness, tagsQuery: "tags:business OR tags:jobs" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryPoverty,
                    category: this.i18n.categoryDemographics,
                    subCategory: this.i18n.subCategoryPoverty,
                    tagsQuery: 'tags:"at risk" OR tags:poverty'
                });
                a.push({ label: this.i18n.categoryLandscape, category: this.i18n.categoryLandscape, subCategory: null, tagsQuery: "tags:landscape" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryAgriculture, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategoryAgriculture, tagsQuery: "tags:agriculture" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryClimate,
                    category: this.i18n.categoryLandscape,
                    subCategory: this.i18n.subCategoryClimate,
                    tagsQuery: "tags:climate OR tags:weather"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryEcology, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategoryEcology, tagsQuery: "tags:ecology" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategorySpecies, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategorySpecies, tagsQuery: "tags:species" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryDisturbance,
                    category: this.i18n.categoryLandscape,
                    subCategory: this.i18n.subCategoryDisturbance,
                    tagsQuery: "tags:disturbance"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryElevation, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategoryElevation, tagsQuery: "tags:elevation" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryLand, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategoryLand, tagsQuery: "tags:landcover" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" +
                        this.i18n.subCategoryHazards,
                    category: this.i18n.categoryLandscape,
                    subCategory: this.i18n.subCategoryHazards,
                    tagsQuery: "tags:hazards"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategorySoils, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategorySoils, tagsQuery: "tags:soils OR tags:geology" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategorySubsurface, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategorySubsurface, tagsQuery: "tags:subsurface" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryWater, category: this.i18n.categoryLandscape, subCategory: this.i18n.subCategoryWater, tagsQuery: "tags:water" });
                a.push({ label: this.i18n.subCategoryOceans, category: this.i18n.subCategoryOceans, subCategory: null, tagsQuery: "tags:oceans" });
                a.push({ label: this.i18n.categoryEarthObservations, category: this.i18n.categoryEarthObservations, subCategory: null, tagsQuery: 'tags:"earth observations"' });
                a.push({
                    label: this.i18n.categoryUrbanSystems,
                    category: this.i18n.categoryUrbanSystems,
                    subCategory: null,
                    tagsQuery: "tags:urban"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategory3DCities, category: this.i18n.categoryUrbanSystems, subCategory: this.i18n.subCategory3DCities, tagsQuery: "tags:3D" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryMovement, category: this.i18n.categoryUrbanSystems, subCategory: this.i18n.subCategoryMovement, tagsQuery: "tags:movement" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryParcels,
                    category: this.i18n.categoryUrbanSystems,
                    subCategory: this.i18n.subCategoryParcels,
                    tagsQuery: "tags:parcels"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryPeople, category: this.i18n.categoryUrbanSystems, subCategory: this.i18n.subCategoryPeople, tagsQuery: "tags:people" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryPlanning, category: this.i18n.categoryUrbanSystems, subCategory: this.i18n.subCategoryPlanning, tagsQuery: "tags:planning" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" +
                        this.i18n.subCategoryPublic,
                    category: this.i18n.categoryUrbanSystems,
                    subCategory: this.i18n.subCategoryPublic,
                    tagsQuery: "tags:public"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryWork, category: this.i18n.categoryUrbanSystems, subCategory: this.i18n.subCategoryWork, tagsQuery: "tags:work" });
                a.push({ label: this.i18n.categoryTransportation, category: this.i18n.categoryTransportation, subCategory: null, tagsQuery: "tags:transportation" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" +
                        this.i18n.subCategoryAccessibility,
                    category: this.i18n.categoryTransportation,
                    subCategory: this.i18n.subCategoryAccessibility,
                    tagsQuery: "tags:accessibility"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryInfrastructure, category: this.i18n.categoryTransportation, subCategory: this.i18n.subCategoryInfrastructure, tagsQuery: "tags:infrastructure" });
                a.push({
                    label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryLogistics,
                    category: this.i18n.categoryTransportation,
                    subCategory: this.i18n.subCategoryLogistics,
                    tagsQuery: "tags:logistics"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryTraffic, category: this.i18n.categoryTransportation, subCategory: this.i18n.subCategoryTraffic, tagsQuery: "tags:traffic" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryTransit, category: this.i18n.categoryTransportation, subCategory: this.i18n.subCategoryTransit, tagsQuery: "tags:transit" });
                a.push({
                    label: this.i18n.categoryBoundaries,
                    category: this.i18n.categoryBoundaries,
                    subCategory: null,
                    tagsQuery: "tags:boundaries"
                });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryBoundaries, category: this.i18n.categoryBoundaries, subCategory: this.i18n.subCategoryBoundaries, tagsQuery: "tags:boundaries" });
                a.push({ label: "\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;" + this.i18n.subCategoryPlaces, category: this.i18n.categoryBoundaries, subCategory: this.i18n.subCategoryPlaces, tagsQuery: "tags:places" });
                this._categoriesStore = new n.data.AndOrWriteStore({
                    data: {
                        label: "label",
                        identifier: "label",
                        items: a
                    }
                });
                a = this._categoriesStore.getIdentity(a[0]);
                this._categorySelect.setStore(this._categoriesStore, a);
                this._categorySelectHandler = b.connect(this._categorySelect, "onChange", b.hitch(this, "doSearch"))
            },
            destroy: function() {
                b.disconnect(this._categorySelectHandler);
                this._categoriesStore.close();
                this.inherited(arguments)
            },
            doSearch: function() {
                var a = this.searchText.getValue();
                a && -1 < a.indexOf("*") ? (arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({
                    title: this.i18n.errorLabel,
                    message: this.i18n.error.wildCardSearchError
                }), this.searchText.focus()) : (a && a.length && (a = '"' + a + '"'), a += ' -typekeywords:"Elevation 3D Layer"', a += ' -tags:"mature support"', this.isProvisionedListings ? this.esriMapLayersGallery.refresh(a, !1) : (arcgisonline.map.role.isAllowed("add_require_credits") || (a += ' -typekeywords:"Requires Credits"'), this._onlyEsriCheck.get("checked") && (a += ' (owner:"esri" OR owner:"esri_dm")'), this._getItemFromStore(this._categoriesStore, this._categorySelect.get("value"), b.hitch(this,
                    function(b) {
                        (b = this._categoriesStore.getValue(b, "tagsQuery")) && b.length && (a += (a ? " AND " : "") + "(" + b + ")");
                        this.esriMapLayersGallery.refresh(a, this._mapExtentCheck.get("checked"))
                    }))))
            },
            _onSearchClick: function(a) {
                b.stopEvent(a);
                null != a && a.prefentDefault && a.preventDefault();
                this.doSearch()
            },
            _onSearchBoxFocus: function(a) {},
            _onSearchBoxBlur: function(a) { this.searchText.getValue() },
            _onSearchKeyPress: function(a) {
                a.keyCode == b.keys.ENTER && (b.stopEvent(a), this._onSearchClick(a));
                this.onSearchFieldKeyPress(a)
            },
            onSearchFieldKeyPress: function(a) {},
            onEsriCheckChanged: function() { this.doSearch() },
            onExtentCheckChanged: function() { this.doSearch() },
            _getItemFromStore: function(a, b, d) { a.fetchItemByIdentity({ identity: b, onItem: d }) },
            show: function(a) {
                this.params = a || {};
                (this.isProvisionedListings = this.params.isProvisionedListings) ? (g.byId("browse-layers-dialog").set("title", this.i18n.provisionedListingsTitle), b.style(b.byId("browse-layers-esri-div"), "display", "none"), b.style(b.byId("browse-layers-extent-div"), "display",
                    "none"), b.style(b.byId("browse-layers-category-div"), "display", "none"), b.style(b.byId("search-div"), "display", "none"), a = arcgisonline.sharing.util.getUser(), this.esriMapLayersGallery.provisionedListings = !0, this.esriMapLayersGallery.searchQuery = esriGeowConfig.restBaseUrl + "community/users/" + a.email + "/provisionedListings") : (g.byId("browse-layers-dialog").set("title", this.i18n.title), b.style(b.byId("browse-layers-extent-div"), "display", ""), b.style(b.byId("browse-layers-category-div"), "display", ""), b.style(b.byId("search-div"),
                    "display", ""), delete this.esriMapLayersGallery.provisionedListings, this.esriMapLayersGallery.searchQuery = esriGeowConfig.restBaseUrl + "search");
                this.doSearch();
                g.byId("browse-layers-dialog").show()
            },
            onClose: function() { g.byId("browse-layers-dialog").hide() }
        })
    })
}, "arcgisonline/sharing/dijit/LayersGrid": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/dijit/views,arcgisonline/sharing/util,dojo/mouse"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.LayersGrid");
            b.require("arcgisonline.sharing.geow.Content");
            b.require("arcgisonline.sharing.geow.Community");
            b.require("arcgisonline.sharing.dijit.Gallery");
            b.require("arcgisonline.sharing.dijit.views");
            b.require("arcgisonline.sharing.util");
            b.require("dojo.mouse");
            b.declare("arcgisonline.sharing.dijit.LayersGrid", [g._Widget, g._Templated], {
                _gallery: null,
                itemsGroupIds: null,
                groupQuery: null,
                searchQuery: null,
                galleryNodes: 4,
                showThumbnail: !0,
                templateString: "\x3cdiv dojoAttachPoint\x3d'containerNode' class\x3d'itemsGallery'\x3e\x3c/div\x3e",
                textMenus: [],
                i18n: null,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").itemLinks);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").templatesGridWidget);
                    this.init()
                },
                init: function() {
                    (this.groupQuery = esriGeowConfig.self.livingAtlasGroupQuery) && arcgisonline.sharing.geow.Community.searchGroups(encodeURIComponent(this.groupQuery),
                        b.hitch(this, this._handleGetGroup), b.hitch(this, this._handleGetGroup));
                    this.searchQuery = esriGeowConfig.restBaseUrl + "search"
                },
                _getItems: function(a, c, d) {
                    if (d) {
                        this._gallery.clear("\x3cp class\x3d'esriItemLinks'\x3e\x3cspan\x3e" + this.i18n.searching + "\x3c/span\x3e\x3c/p\x3e");
                        var f;
                        if (this.provisionedListings) f = { sortField: null, num: "100" };
                        else {
                            var e = "",
                                g = "";
                            b.forEach(this.itemsGroupIds, function(a) {
                                e += g + "group:" + a;
                                g = " OR "
                            });
                            f = { q: "(" + e + ")" + d + (a ? " AND " + a : ""), sortField: null, num: "100" }
                        }
                        arcgisonline.map.role.isAllowed("add_require_credits") ||
                            (f.q += ' -typekeywords:"Requires Credits"');
                        this.sortOrder && (f.sortOrder = this.sortOrder);
                        if (!esri.isDefined(c) || c) {
                            var m = function(a, c) {
                                    f.bbox = arcgisonline.map.main.extentToString(a[0]);
                                    arcgisonline.sharing.geow.Content.search(this.searchQuery, f, b.hitch(this, this._handleItemsResponse), b.hitch(this, this._handleItemsResponse))
                                },
                                n = function() { arcgisonline.sharing.geow.Content.search(this.searchQuery, f, b.hitch(this, this._handleItemsResponse), b.hitch(this, this._handleItemsResponse)) },
                                r = arcgisonline.map.main.map.extent;
                            r.spatialReference._isWrappable() ? esri.geometry.normalizeCentralMeridian([r], null, b.hitch(this, function(a) {
                                if (a[0].rings) {
                                    var c = (new esri.geometry.Polygon(r.spatialReference)).addRing(a[0].rings[0]).getExtent();
                                    a = (new esri.geometry.Polygon(r.spatialReference)).addRing(a[0].rings[1]).getExtent();
                                    r = c.getWidth() > a.getWidth() ? c : a
                                } else r = a[0];
                                arcgisonline.map.main.projectExtent(r, new esri.SpatialReference({ wkid: 4326 }), b.hitch(this, m), b.hitch(this, n))
                            })) : arcgisonline.map.main.projectExtent(r, new esri.SpatialReference({ wkid: 4326 }),
                                b.hitch(this, m), b.hitch(this, n))
                        } else arcgisonline.sharing.geow.Content.search(this.searchQuery, f, b.hitch(this, this._handleItemsResponse), b.hitch(this, this._handleItemsResponse))
                    } else d = ' (type:"Map Service" OR type:"Image Service" OR type:"Feature Service" OR type:"WMS" OR type:"WFS" OR type:"WMTS" OR type:"KML" OR type:"Vector Tile Service") ', this.supportedTypesList = "Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML;Vector Tile Service".split(";"), arcgisonline.map.vectorTile.checkSupport().then(b.hitch(this,
                        function(a, b, c) {
                            c || (d = ' (type:"Map Service" OR type:"Image Service" OR type:"Feature Service" OR type:"WMS" OR type:"WFS" OR type:"WMTS" OR type:"KML") ', this.supportedTypesList = "Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML".split(";"));
                            this._getItems(a, b, d)
                        }, a, c))
                },
                refresh: function(a, b) { this.itemsGroupIds && this._getItems(a, b) },
                postCreate: function() {
                    this._gallery = new arcgisonline.sharing.dijit.Gallery({
                        id: this.id + "_Gallery",
                        nodesPerPage: this.galleryNodes,
                        showNodeLabels: !0,
                        showToolTip: !1,
                        noResultsMessage: "\x3cp class\x3d'esriItemLinks'\x3e\x3cspan\x3e" + this.i18n.noItemsToDisplay + "\x3c/span\x3e\x3c/p\x3e"
                    }, b.create("div", null, this.domNode));
                    this._user = arcgisonline.sharing.util.getUser();
                    var a = this;
                    b.mixin(this._gallery, {
                        _buildNodeLayout: function(c, d) {
                            var f = b.create("div", { id: "galleryNode_" + c.id, "class": this.nodeClass, style: "position:relative;" });
                            b.addClass(f, d ? "large" : "small");
                            if (this.showNodeLabels) {
                                d = b.create("div", { "class": "galleryLabelContainer" }, f);
                                var e = c.title || "";
                                b.create("span", { innerHTML: e, alt: e, title: e }, d)
                            }
                            arcgisonline.sharing.util.getGalleryMainLinkInfo(c);
                            d = b.create("a", { href: "JavaScript:void(0);" }, f);
                            b.create("img", { "class": this.thumbClass, src: c.thumbnail ? this._getThumbailUrl(c) : arcgisonline.sharing.util.relativeToExplicitUrl("images/transparent.gif") }, d);
                            b.create("br", null, f);
                            var e = b.create("div", { "class": "linksDiv" }, f),
                                e = b.create("div", { "class": "esriItemLinks" }, e),
                                g = b.create("div", { "class": "esriFloatLeading" }, e),
                                g = b.create("a", { style: "text-decoration: none;" }, g);
                            b.create("span", { innerHTML: this.i18n.addToViewer }, g);
                            b.create("div", { "class": "dijitReset dijitInline esriArrows" }, g);
                            var m = [];
                            m.push({ label: this.i18n.asLayer, onClick: b.hitch(this, function(a) { arcgisonline.map.save_open.openServiceItemCards(a, !1); "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel() }, c.id) });
                            "Map Service" != c.type && "Image Service" != c.type && "WMS" != c.type && "WMTS" != c.type && "Vector Tile Service" != c.type || m.push({
                                label: this.i18n.asBasemap,
                                onClick: b.hitch(this, function(a) { arcgisonline.map.save_open.openBaseMapServiceItemCard(a); "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel() }, c.id)
                            });
                            g = new arcgisonline.sharing.dijit.TextMenu({ triggerNode: g, labelNode: g, textMenuItems: m });
                            a.textMenus.push(g);
                            b.create("span", { innerHTML: "\x26nbsp;", style: "width:0;" }, e);
                            e = c.snippet || "";
                            145 < e.length && (e = e.substring(0, 140) + "...");
                            e = b.create("div", {
                                id: "tooltip" + c.id,
                                className: "layersGridTooltip",
                                innerHTML: '\x3cp class\x3d"title ellipsis"\x3e' + c.title + "\x3c/p\x3e\x3cp\x3e" + e + "\x3c/p\x3e",
                                onclick: b.hitch(this, function(a) { arcgisonline.map.save_open.openServiceItemCards(a, !1); "contentStack" != arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftTOCPanel() }, c.id)
                            }, f, "first");
                            (g = arcgisonline.sharing.geow.Content._getPremiumItemNode(c)) && b.place(g, b.create("p", {}, e, "last"));
                            var n = function(a) {
                                    (a = b.byId(a)) && b.style(a, { opacity: 0, display: "none" })
                                },
                                r = function(c, d) {
                                    c =
                                        b.byId(c);
                                    esri.show(c);
                                    var e = b.coords(c);
                                    d = b.coords(b.byId(d).parentNode);
                                    esriGeowConfig.isRightToLeft && e.x + e.l < d.x + d.l ? (b.style(c, "right", "auto"), b.style(c, "left", 10 > b.isIE ? "10px" : "0")) : e.w + e.x > d.w + d.x && (b.style(c, "left", "auto"), b.style(c, "right", 10 > b.isIE ? "10px" : "0"));
                                    b.fadeIn({ node: c }).play();
                                    b.forEach(a.textMenus, function(a) { a.hide() })
                                };
                            /ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase()) ? b.connect(d, "onclick", function() {
                                var a = b.byId("tooltip" +
                                    c.id);
                                a && "block" === b.getStyle(a, "display") ? n("tooltip" + c.id) : r("tooltip" + c.id, "galleryNode_" + c.id);
                                b.query(".layersGridTooltip").forEach(function(a) { a.id !== "tooltip" + c.id && n(a.id) })
                            }) : (b.connect(d, b.mouse.enter, function() {
                                b.query(".layersGridTooltip").forEach(function(a) { n(a.id) });
                                r("tooltip" + c.id, "galleryNode_" + c.id)
                            }), b.connect(e, b.mouse.leave, function() { n("tooltip" + c.id) }));
                            return f
                        }
                    });
                    this._gallery.startup()
                },
                _getPremiumIcon: function(a) {
                    return (a = arcgisonline.sharing.geow.Content._getPremiumItemNode(a)) ?
                        b.place(a, b.create("p", {})) : ""
                },
                _setGroupIdsAttr: function(a) { 0 !== a.length && (this.pageCount = 0, this.itemsGroupIds = a, this._getItems()) },
                _handleItemsResponse: function(a, c) {
                    c = [];
                    for (var d = a.results || a.provisionedListings, f = 0; f < d.length; f++) a = d[f], this.provisionedListings ? -1 === a.type.indexOf("Application") && "Web Map" !== a.type && (-1 < b.indexOf(this.supportedTypesList, a.type) && -1 === b.indexOf(a.typeKeywords, "Elevation 3D Layer") && -1 === b.indexOf(a.tags, "mature support") && (a.id = a.id || a.itemId, a.url && c.push(a)),
                            arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl + "content/items/" + (a.id || a.itemId) + "/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward", b.hitch(this, function(a, c) { c && c.total && (b.forEach(c.relatedItems, function(c) {-1 < b.indexOf(this.supportedTypesList, c.type) && -1 === b.indexOf(c.typeKeywords, "Elevation 3D Layer") && -1 === b.indexOf(c.tags, "mature support") && (c.id = c.id || c.itemId, c.url && a.push(c)) }, this), b.attr(this._gallery, "items", a)) }, c), b.hitch(this, function() {}))) :
                        a.url && c.push(a);
                    b.attr(this._gallery, "items", c)
                },
                _handleGetGroup: function(a, c) { a && 0 < a.total && (this.itemsGroupIds = b.map(a.results, function(a) { return a.id }), this._setGroupIdsAttr(this.itemsGroupIds)) },
                nextPage: function() { this._gallery.nextPage() },
                prevPage: function() { this._gallery.prevPage() }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/FieldsDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/i18n!arcgisonline/nls/arcgisonline", "dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dojo/i18n,arcgisonline/map/main"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.FieldsDlg");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dijit.form.Button");
            b.require("dojo.i18n");
            b.requireLocalization("arcgisonline", "arcgisonline");
            b.require("arcgisonline.map.main");
            b.declare("arcgisonline.sharing.dijit.dialog.FieldsDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: b.cache("arcgisonline.sharing.dijit.dialog", "templates/FieldsDlg.html", '\x3cdiv dojoAttachPoint\x3d"containerNode" dojoType\x3d"dijit.layout.BorderContainer" design\x3d"headline" region\x3d"center"\x3e\r\n  \x3cdiv dojoType\x3d"dijit.layout.ContentPane"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"readOnlyText" style\x3d"display:none;padding-bottom: 15px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"infoText" style\x3d"padding-bottom: 15px;"\x3e\r\n      \x3cspan\x3e${i18n.msg}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_fieldsDiv" style\x3d"min-height:180px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"submitButtons dijitDialogPaneActionBar esriFloatTrailing" style\x3d"margin-top:20px;"\x3e\r\n      \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"primary" id\x3d"applyFilterButton" dojoAttachEvent\x3d"onClick:onApply" label\x3d"${i18n.apply}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"cancel" dojoAttachEvent\x3d"onClick:onClose" label\x3d"${i18n.close}"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'),
                baseClass: "esriAGOFieldsDialog",
                fieldCheckboxes: null,
                allCheckbox: null,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").GeneralDlg);
                    this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").FieldsDlg)
                },
                startup: function() {
                    this.inherited(arguments);
                    this._loadConnections()
                },
                destroy: function() {
                    this.allCheckbox.destroy();
                    b.forEach(this.fieldCheckboxes, function(a) { a.destroy() });
                    this.inherited(arguments)
                },
                _loadConnections: function() { this._dlgConnect = b.connect(this.dialog, "hide", b.hitch(this, function() { this.destroy() })) },
                start: function(a, c) {
                    this.mapLayer = a;
                    this.fields = c;
                    div = b.create("div", { style: "border-top: 1px #444 solid; border-left: 1px #444 solid; border-right: 1px #444 solid;" });
                    var d = b.create("table", {}, div),
                        f = b.create("tbody", {}, d),
                        e = b.create("tr", {}, f);
                    this.allCheckbox = new g.form.CheckBox({
                        name: "all",
                        value: "all",
                        checked: !1,
                        onChange: b.hitch(this, function(a) { b.forEach(this.fieldCheckboxes, function(b) { b.get("disabled") || b.set("checked", a) }) })
                    }, b.create("div", {}, b.create("td", {}, e)));
                    this.allCheckbox.startup();
                    b.create("td", { innerHTML: "\x26nbsp;\x26nbsp;" + this.i18n.fieldName }, e);
                    b.place(div, this._fieldsDiv, "only");
                    div = b.create("div", { style: "overflow-y: auto; border: 1px #444 solid; max-height:200px;" });
                    d = b.create("table", {}, div);
                    f = b.create("tbody", {}, d);
                    this.fieldCheckboxes = [];
                    b.forEach(c, function(c) {
                        e = b.create("tr", {}, f);
                        var d = new g.form.CheckBox({ name: c.name, value: c.name, checked: !1 !== c.visible }, b.create("div", {}, b.create("td", {}, e)));
                        d.startup();
                        this.fieldCheckboxes.push(d);
                        b.create("td", { innerHTML: "\x26nbsp;\x26nbsp;" + (c.alias || c.name) }, e);
                        if (c.name === a.layer.objectIdField || !1 === c.nullable && !c.defaultValue || -1 < b.indexOf(["esriFieldTypeOID", "esriFieldTypeGlobalID", "esriFieldTypeGeometry"], c.type)) d.set("checked", !0), d.set("disabled", !0)
                    }, this);
                    arcgisonline.map.itemData.getRelatedTSForFS(a).then(b.hitch(this,
                        function(a) { a && a.length && (this.readOnlyText.innerHTML = "\x3cHR\x3e\x3cb\x3e" + b.string.substitute(this.i18n.readOnlyMsg, { layerName: a[0].title }) + "\x3c/b\x3e\x3cHR\x3e", b.style(this.readOnlyText, "display", ""), b.style(this.infoText, "display", "none"), this.allCheckbox.set("disabled", !0), b.forEach(this.fieldCheckboxes, function(a) { a.set("disabled", !0) }), g.byId("applyFilterButton").set("disabled", !0)) }), b.hitch(this, function() {}));
                    b.place(div, this._fieldsDiv)
                },
                onClose: function() {
                    b.style(this.dialog.domNode,
                        "display", "none");
                    this.dialog && this.dialog.hide()
                },
                onApply: function() {
                    b.forEach(this.fields, function(a, b) { a.visible = this.fieldCheckboxes[b].get("checked") }, this);
                    b.publish("onServiceFieldsChanged", [this.mapLayer, this.fields]);
                    this.dialog.hide()
                }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/MapNotesDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/_Widget,dijit/_Templated,dojox/html/entities,dijit/Dialog"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.MapNotesDlg");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dojox.html.entities");
        b.require("dijit.Dialog");
        b.declare("arcgisonline.sharing.dijit.dialog.MapNotesDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"mapnotes-title-dialog" dojoAttachPoint\x3d"_mapNotesDialog" dojoAttachEvent\x3d"onkeydown:_handleKeyDown"title\x3d"${i18n.addMapNotes}" execute\x3d""\x3e\r\n    \x3cdiv\x3e\r\n      \x3ctable\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd height\x3d"30"\x3e\r\n              \x3clabel class\x3d"long" for\x3d"mapnotes-title"\x3e${i18n.nameLabel}\x3c/label\x3e\r\n        \t\x3c/td\x3e\r\n\t\t\t\x3ctd\x3e\r\n\t\t\t  \x3cdiv id\x3d"mapnotes-title" dojoAttachPoint\x3d"_mapNotesTitle" name\x3d"mapnotes-title" dojotype\x3d"dijit.form.TextBox" maxLength\x3d"100" trim\x3d"true" required\x3d"true" style\x3d"padding:2px 0 2px 0;"\x3e\x3c/div\x3e\r\n\t\t\t \x3c/td\x3e\r\n           \x3c/tr\x3e\r\n           \x3ctr\x3e\r\n             \x3ctd height\x3d"30"\x3e\r\n               \x3clabel class\x3d"long" for\x3d"mapnotes-title"\x3e${i18n.templateLabel}\x3c/label\x3e\r\n             \x3c/td\x3e\r\n             \x3ctd\x3e\r\n\t\t\t   \x3cselect dojoType\x3d"arcgisonline.sharing.dijit.ComboBox" class\x3d"arrowSpaceMedium" dojoAttachEvent\x3d"onChange:newTemplate" dojoAttachPoint\x3d"_mapTemplatesCombo" id\x3d"mapnotes-templates" \x3e\x3c/select\x3e\r\n             \x3c/td\x3e\r\n           \x3c/tr\x3e\r\n           \x3ctr\x3e\r\n             \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n             \x3ctd\x3e\r\n               \x3cdiv dojoAttachPoint\x3d"_mapNoteDescInput" id\x3d"mapnotes-template-description" style\x3d"width:290px;"\x3e\x3c/div\x3e\r\n             \x3c/td\x3e\r\n           \x3c/tr\x3e\r\n         \x3c/tbody\x3e\r\n       \x3c/table\x3e\r\n     \x3cdiv style\x3d"clear:both;margin-top:5px;"\x3e\r\n     \x3c/div\x3e\r\n     \x3cbutton type\x3d"cancel" dojotype\x3d"dijit.form.Button" class\x3d"cancel" dojoAttachEvent\x3d"onClick:_handleCancelBtnClick" style\x3d"float:right;"\x3e${i18n.cancel}\x3c/button\x3e\r\n     \x3cbutton id\x3d"mapnotes-create" dojotype\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:createMapNotesLayer" class\x3d"primary"  style\x3d"float:right;"\x3e${i18n.create}\x3c/button\x3e\r\n     \x3cdiv style\x3d"clear:both;"\x3e\r\n     \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
            allTitles: "",
            template: null,
            i18n: null,
            _mapNotesDialog: null,
            _mapNoteDescInput: null,
            _mapNotesTitle: null,
            statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.MapNotesDlg); return this._instance } },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.clone(b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").viewer);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline",
                    "arcgisonline").generalDlg);
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").mapNotesDlg)
            },
            postCreate: function() {
                this.getTemplates();
                9 == b.isIE && b.connect(this._mapNotesDialog, "hide", b.hitch(this, function() { this._mapTemplatesCombo.closeDropDown() }))
            },
            show: function(a) {
                this.setTitle();
                this._mapNotesDialog.show()
            },
            setTitle: function() {
                this.allTitles = "||";
                b.forEach(arcgisonline.map.main.mapLayers, function(a) { this.allTitles += a.title + "||" }, this);
                this.allTitles = this.allTitles.toLowerCase();
                if (-1 == this.allTitles.indexOf("||" + this.i18n.mapNotes.toLowerCase() + "||")) this._mapNotesTitle.set("value", this.i18n.mapNotes);
                else {
                    for (var a = 1; - 1 < this.allTitles.indexOf("||" + this.i18n.mapNotes.toLowerCase() + " " + a + "||");) a++;
                    this._mapNotesTitle.set("value", this.i18n.mapNotes + " " + a)
                }
            },
            _handleCancelBtnClick: function(a) {
                a.preventDefault();
                this._mapNotesDialog.hide()
            },
            hide: function() { this._mapNotesDialog.hide() },
            createMapNotesLayer: function(a) {
                a.preventDefault();
                (a = b.trim(this._mapNotesTitle.get("value"))) &&
                0 < a.length && (-1 < this.allTitles.indexOf("||" + a.toLowerCase() + "||") ? arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.mapNotesLyrName, message: this.i18n.error.sameName }) : (arcgisonline.map.mapNotes.getMapNotesConfig(this.template.id, a), this.hide()))
            },
            getTemplates: function() {
                arcgisonline.sharing.geow.Community.searchGroups(encodeURIComponent(esriGeowConfig.layerTemplatesGroupQuery), b.hitch(this, function(a, b) { a && a.results && 0 < a.results.length && this.getTemplatesItems(a.results[0].id) }),
                    b.hitch(this, function(a, b) {}))
            },
            getTemplatesItems: function(a) {
                a = esriGeowConfig.restBaseUrl + "search?num\x3d50\x26q\x3dgroup:" + a + encodeURIComponent(' AND type:"Feature Collection Template"');
                var c = function(a, b) { arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.notAdded }) };
                arcgisonline.sharing.util.getJson(a, b.hitch(this, function(a, f) {
                    if (a.results && 0 < a.results.length) {
                        this._mapTemplatesCombo.set("fetchProperties", { sort: [{ attribute: "sortName", descending: !1 }] });
                        var d = [],
                            g = 0;
                        b.forEach(a.results, function(a, b) {
                            d.push({ name: a.title, sortName: a.name, id: a.id, description: a.description });
                            a.title == this.i18n.mapNotes && (g = b)
                        }, this);
                        a = new b.data.ItemFileWriteStore({ data: { identifier: "id", items: d } });
                        this._mapTemplatesCombo.set("store", a);
                        this._mapTemplatesCombo.set("value", d[g].name)
                    } else c(a, f)
                }), b.hitch(this, c))
            },
            newTemplate: function(a) {
                this._mapTemplatesCombo.store.fetch({
                    query: {},
                    onComplete: b.hitch(this, function(c) {
                        for (var d =
                                0; d < c.length; d++)
                            if (c[d].name == a) {
                                this.template = c[d];
                                b.attr(this._mapNoteDescInput, "innerHTML", this.template.description);
                                break
                            }
                    })
                })
            },
            _handleKeyDown: function(a) {
                var b;
                window.event ? b = a.keyCode : a.which && (b = a.which);
                13 == b && this.createMapNotesLayer(a)
            }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/OpenMapDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,arcgisonline/sharing/dijit/dialog/GeneralDlg,dijit/_Widget,dijit/_Templated"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.OpenMapDlg");
        b.require("dijit.Dialog");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.declare("arcgisonline.sharing.dijit.dialog.OpenMapDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_dialog" id\x3d"open-map-dialog" title\x3d"${i18n.title}"\x3e\r\n    \x3cdiv id\x3d"open-map-dialog-content"\x3e\r\n    \x3cdiv style\x3d"margin-bottom: 10px;"\x3e${i18n.unsavedChangesMsg}\x3c/div\x3e\r\n      \x3ctable class\x3d"table-layout" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd valign\x3d"top"\x3e\x3cdiv\x3e${i18n.titleLabel}\x3c/div\x3e\x3c/td\x3e\r\n            \x3ctd width\x3d"5"\x3e\x26nbsp;\x3c/td\x3e\r\n            \x3ctd\x3e\x3cdiv id\x3d"open-map-dialog-title"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr id\x3d"open-map-dialog-layersRow"\x3e\r\n            \x3ctd valign\x3d"top"\x3e\x3cdiv id\x3d"open-map-dialog-layersLabel"\x3e\x3c/div\x3e\x3c/td\x3e\r\n            \x3ctd width\x3d"5"\x3e\x26nbsp;\x3c/td\x3e\r\n            \x3ctd\x3e\x3cdiv id\x3d"open-map-dialog-layers"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr id\x3d"open-map-dialog-tablesRow"\x3e\r\n            \x3ctd valign\x3d"top"\x3e\x3cdiv id\x3d"open-map-dialog-tablesLabel"\x3e\x3c/div\x3e\x3c/td\x3e\r\n            \x3ctd width\x3d"5"\x3e\x26nbsp;\x3c/td\x3e\r\n            \x3ctd\x3e\x3cdiv id\x3d"open-map-dialog-tables"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n      \x3cdiv style\x3d"margin-top: 10px;"\x3e${i18n.openAnotherMapQtn}\x3c/div\x3e\r\n      \x3cbr /\x3e\r\n      \x3cdiv style\x3d"float: right;" class\x3d"clearfix"\x3e\r\n         \x3cbutton id\x3d"button_open-map-no" class\x3d"action-bar-btn jevent cancel right btn-two" dojoType\x3d"dijit.form.Button"\x3e${i18n.notOpen}\x3c/button\x3e\r\n         \x3cbutton id\x3d"button_open-map-yes" class\x3d"padding-right-half jevent primary right" dojoType\x3d"dijit.form.Button"\x3e${i18n.yesOpen}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
            handler: null,
            newMapUrl: "",
            i18n: null,
            statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.OpenMapDlg); return this._instance } },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").openMapDlg)
            },
            postCreate: function() { this.loadConnections() },
            show: function(a, c, d, f, e) {
                this.newMapUrl = a;
                a = document.getElementById("webmap-title-text") &&
                    document.getElementById("webmap-title-text").innerHTML;
                b.byId("open-map-dialog-title").innerHTML = a || e || c && c.t || this.i18n.untitled;
                var h = [];
                c ? b.forEach(c.operationalLayers, function(a) { h.push(a.title) }) : d && b.forEach(d, function(a) { "user" !== a.type && "mapNotes" !== a.type || h.push(a.title) });
                if (0 === h.length) b.style(b.byId("open-map-dialog-layersRow"), "display", "none");
                else {
                    if (1 === h.length) b.byId("open-map-dialog-layersLabel").innerHTML = this.i18n.layerLabel, b.byId("open-map-dialog-layers").innerHTML = h[0];
                    else {
                        b.byId("open-map-dialog-layersLabel").innerHTML =
                            this.i18n.layersLabel;
                        var m = "",
                            n = "";
                        b.forEach(h, function(a) {
                            m += n + a;
                            n = ", "
                        });
                        b.byId("open-map-dialog-layers").innerHTML = m
                    }
                    b.style(b.byId("open-map-dialog-layersRow"), "display", "")
                }
                var r = [];
                c ? b.forEach(c.tables, function(a) { r.push(a.title) }) : f && b.forEach(f, function(a) { r.push(a.title) });
                0 === r.length ? b.style(b.byId("open-map-dialog-tablesRow"), "display", "none") : (1 === r.length ? (b.byId("open-map-dialog-tablesLabel").innerHTML = this.i18n.tableLabel, b.byId("open-map-dialog-tables").innerHTML = r[0]) : (b.byId("open-map-dialog-tablesLabel").innerHTML =
                    this.i18n.tablesLabel, n = m = "", b.forEach(r, function(a) {
                        m += n + a;
                        n = ", "
                    }), b.byId("open-map-dialog-tables").innerHTML = m), b.style(b.byId("open-map-dialog-tablesRow"), "display", ""));
                g.byId("open-map-dialog").show()
            },
            loadConnections: function() {
                b.query(".jevent").connect("onclick", function(a) { a.preventDefault() });
                b.query("#button_open-map-no").connect("onclick", function() { g.byId("open-map-dialog").hide() });
                b.query("#button_open-map-yes").connect("onclick", b.hitch(this, "submitRequest"))
            },
            submitRequest: function(a) {
                document.location =
                    this.newMapUrl
            },
            hide: function() { g.byId("open-map-dialog").hide() }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/QueryLayerDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/i18n!arcgisonline/nls/arcgisonline", "dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dojox/widget/Standby,dojo/data/ItemFileWriteStore,dojo/i18n,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/main"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.QueryLayerDlg");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dijit.form.Button");
        b.require("dojox.widget.Standby");
        b.require("dojo.data.ItemFileWriteStore");
        b.require("dojo.i18n");
        b.requireLocalization("arcgisonline", "arcgisonline");
        b.require("arcgisonline.sharing.util");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.require("arcgisonline.map.main");
        b.declare("arcgisonline.sharing.dijit.dialog.QueryLayerDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: b.cache("arcgisonline.sharing.dijit.dialog",
                "templates/QueryLayerDlg.html", '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n    \x3cspan\x3e${i18n.header}\x3c/span\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_queryLayerChoiceDiv" style\x3d"display:none; margin-top:10px; margin-bottom:12px;"\x3e\r\n      \x3cdiv style\x3d"margin-bottom:15px;"\x3e\r\n        ${i18n.choiceMsg}\r\n      \x3c/div\x3e\r\n      \x3cinput dojoType\x3d"dijit.form.RadioButton" id\x3d"choice:item" name\x3d"choice" value\x3d"item" dojoAttachEvent\x3d"onClick:_onClickChoiceItem" checked\x3d"checked" /\x3e\r\n      \x3clabel\x3e\r\n        ${i18n.choiceItems}\r\n      \x3c/label\x3e\r\n\t\t\t\x3cspan\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n      \x3cinput dojoType\x3d"dijit.form.RadioButton" id\x3d"choice:url" name\x3d"choice" value\x3d"url" dojoAttachEvent\x3d"onClick:_onClickChoiceUrl" /\x3e\r\n      \x3clabel\x3e\r\n        ${i18n.choiceUrl}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_queryLayerUrlMsgDiv" style\x3d"display:none; margin-top:10px; margin-bottom:10px;"\x3e\r\n      \x3cdiv\x3e\r\n        ${i18n.urlMsg}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_queryLayerItemsDiv" style\x3d"display:none;"\x3e\r\n      \x3ctable\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd style\x3d"vertical-align:top;"\x3e\r\n              \x3clabel style\x3d"margin-top:10px;"\x3e\r\n                ${i18n.itemLabel}\r\n              \x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cdiv\x3e\r\n                \x3cselect class\x3d"queryLayerInput" dojoAttachPoint\x3d"_queryLayerItem" dojoAttachEvent\x3d"onChange:_onChangeQueryItem" dojotype\x3d"dijit.form.FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3coption value\x3d"-1" selected\x3d"selected"\x3e${i18n.selectItem}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv dojoAttachPoint\x3d"_querLayerOrgItemsDiv" style\x3d"display:none;"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_querLayerOrgItems" dojotype\x3d"dijit.form.CheckBox" dojoAttachEvent\x3d"onClick:_onClickOrgItems" checked\x3d"false" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel\x3e\r\n                  ${i18n.includeOrgItems}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel for\x3d"queryLayerUrl"\x3e\r\n                ${i18n.layerLabel}\r\n              \x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cselect class\x3d"queryLayerInput" dojoAttachPoint\x3d"_queryItemLayer" dojoAttachEvent\x3d"onChange:_onChangeQueryServiceLayer" dojoType\x3d"dijit.form.FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false" disabled\x3d"true"\x3e\r\n                \x3coption value\x3d"-1" selected\x3d"selected"\x3e${i18n.selectLayer}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"_queryLayerUrlDiv" style\x3d"display:none;"\x3e\r\n    \x3ctable\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"vertical-align:top;"\x3e\r\n            \x3clabel style\x3d"margin-top:10px;"\x3e\r\n              ${i18n.urlLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv class\x3d"queryLayerInput" dojoAttachPoint\x3d"_queryLayerUrl" dojotype\x3d"dijit.form.TextBox" dir\x3d"ltr" trim\x3d"true" value\x3d"" dojoAttachEvent\x3d"onFocus:_onFocusLayerUrl, onBlur:_onBlurLayerUrl, onChange:_onChangeLayerUrl" style\x3d"margin-bottom:0;"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv style\x3d"font-size:smaller;"\x3e\r\n              ${i18n.enterUrl}\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel for\x3d"queryLayerUrl"\x3e\r\n              ${i18n.layerLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cselect class\x3d"queryLayerInput" dojoAttachPoint\x3d"_queryUrlLayer" dojoAttachEvent\x3d"onChange:_onChangeQueryServiceLayer" dojoType\x3d"dijit.form.FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false" disabled\x3d"true"\x3e\r\n              \x3coption value\x3d"-1" selected\x3d"selected"\x3e${i18n.selectLayer}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"submitButtons dijitDialogPaneActionBar esriFloatTrailing" style\x3d"margin-top:10px;"\x3e\r\n    \x3cspan dojoAttachPoint\x3d"spinnerNode" style\x3d"display:none"\x3e\x3c/span\x3e\r\n    \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"submit" class\x3d"primary" dojoAttachPoint\x3d"_submitButton" dojoAttachEvent\x3d"onClick:onOk" label\x3d"${i18n.title}"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"cancel" dojoAttachEvent\x3d"onClick:onCancel" label\x3d"${i18n.cancel}"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'),
            baseClass: "esriAGOQueryLayerForm",
            _lastChangedTime: (new Date).getTime(),
            lastQuery: "",
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").errorWidget);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").GeneralDlg);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").addLayerFromUrlDlg);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").QueryLayerDlg)
            },
            startup: function() {
                this.inherited(arguments);
                this._loadConnections();
                this._util = arcgisonline.sharing.util
            },
            enable: function(a, b) {
                this.inherited(arguments);
                esri.hide(this.spinnerNode)
            },
            disable: function(a, c) {
                this.inherited(arguments);
                b.attr(this.spinnerNode, "innerHTML", c || this.i18n.pleaseWait);
                b.style(this.spinnerNode, "display", "inline-block")
            },
            onCancel: function() { this.dialog && this.dialog.hide() },
            onOk: function(a) {
                a.preventDefault();
                a = this.layersInfo.layers[0];
                if (1 < this.layersInfo.layers.length)
                    for (var c = 0; c < this.layersInfo.layers.length; c++)
                        if (this.layersInfo.layers[c].id === this.layerId) { a = this.layersInfo.layers[c]; break }
                var d = { id: this.sublayerId, layerUrl: this.layerUrl + "/" + this.layerId, _layerInfo: a, popupInfo: arcgisonline.map.popup.getDefaultPopupInfo(a, !1, null) };
                this.layerItemId && (d.layerItemId = this.layerItemId);
                this.mapLayer.itemLayers = this.mapLayer.itemLayers || [];
                var f = !1;
                b.forEach(this.mapLayer.itemLayers, function(a) {
                    a.id ===
                        this.sublayerId && (delete a.layerItemId, b.mixin(a, d), f = !0)
                }, this);
                f || this.mapLayer.itemLayers.push(d);
                arcgisonline.map.popup.addPopupLayer(this.mapLayer, this.sublayerId);
                this.mapLayer.popupChanged = !0;
                b.publish("onLayerUpdate", ["reopen"]);
                this.dialog.hide()
            },
            start: function(a, c) {
                this.mapLayer = a;
                this.sublayerId = c;
                this.user && this._util.isHostedService(this.mapLayer.url) ? (b.style(this._queryLayerUrlDiv, "display", "none"), b.style(this._queryLayerUrlMsgDiv, "display", "none"), b.style(this._queryLayerChoiceDiv,
                    "display", 10 > b.isIE ? "inline" : ""), b.style(this._queryLayerItemsDiv, "display", 10 > b.isIE ? "inline" : ""), b.byId("choice:item").checked = !0, this.user.accountId ? (this._querLayerOrgItems.set("checked", !1), b.style(this._querLayerOrgItemsDiv, "display", 10 > b.isIE ? "inline" : "")) : b.style(this._querLayerOrgItemsDiv, "display", "none"), this._getAllFSItems()) : (b.style(this._queryLayerChoiceDiv, "display", "none"), b.style(this._queryLayerItemsDiv, "display", "none"), b.style(this._queryLayerUrlMsgDiv, "display", 10 > b.isIE ? "inline" :
                    ""), b.style(this._queryLayerUrlDiv, "display", 10 > b.isIE ? "inline" : ""))
            },
            _loadConnections: function() {
                this.user = arcgisonline.sharing.util.getUser();
                this._dlgConnect = b.connect(this.dialog, "hide", b.hitch(this, function() { this.destroy() }));
                this._submitButton.set("disabled", !0)
            },
            _getAllFSItems: function() {
                this.disable(null, this.i18n.pleaseWaitForFSItems);
                this.lastQuery = 'type:"Feature Service"';
                this.user ? this.user.accountId && this._querLayerOrgItems.get("checked") ? this.lastQuery += " orgid:" + this.user.accountId :
                    this.lastQuery += ' owner:"' + this.user.email + '"' : this._errorHandleFSItems();
                arcgisonline.sharing.geow.Search.searchByQuery(this.lastQuery, 100, 1, "title", b.hitch(this, "_handleFSItems"), b.hitch(this, "_errorHandleFSItems"))
            },
            _errorHandleFSItems: function() {
                this.enable();
                arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: this.i18n.defaultError })
            },
            _handleFSItems: function(a) {
                this.enable();
                if (a.results && 0 != a.results.length) 1 === a.start ? (c =
                    b.map(a.results, b.hitch(this, function(a, b) { return { name: a.title || this.i18n.noTitle, id: b + 1, url: a.url, itemId: a.id } })), c.splice(0, 0, { name: this.i18n.selectItem, id: -1 }), this.fsItemsStore = new b.data.ItemFileWriteStore({ data: { label: "name", identifier: "id", items: c } })) : b.forEach(a.results, b.hitch(this, function(b, c) { this.fsItemsStore.newItem({ name: b.title || this.i18n.noTitle, id: c + a.start + 1, url: b.url, itemId: b.id }) })), this._queryLayerItem.set("store", this.fsItemsStore), -1 < a.nextStart && arcgisonline.sharing.geow.Search.searchByQuery(this.lastQuery,
                    100, a.nextStart, "title", b.hitch(this, "_handleFSItems"), b.hitch(this, "_errorHandleFSItems"));
                else {
                    var c = [{ name: this.i18n.selectItem, id: -1 }];
                    this.fsItemsStore = new b.data.ItemFileWriteStore({ data: { label: "name", identifier: "id", items: c } });
                    this._queryLayerItem.set("store", this.fsItemsStore);
                    arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.noFSItems })
                }
            },
            _getAllSublayers: function(a, c, d) {
                this.layersStore = new b.data.ItemFileWriteStore({
                    data: {
                        label: "name",
                        identifier: "id",
                        items: [{ name: this.i18n.selectLayer, id: -1 }]
                    }
                });
                "hosted" === d ? (this._queryItemLayer.set("store", this.layersStore), this._queryItemLayer.set("disabled", !0)) : (this._queryUrlLayer.set("store", this.layersStore), this._queryUrlLayer.set("disabled", !0));
                this.disable(null, this.i18n.pleaseWaitForLayers);
                arcgisonline.map.layer.getServiceInfo(a, null, b.hitch(this, "_handleServiceInfo", d), b.hitch(this, function(a, c) {
                    setTimeout(b.hitch(this, function() { this.enable() }), 0);
                    this._queryLayerUrl.set("value",
                        "");
                    this._queryItemLayer.set("disabled", !0);
                    this._queryUrlLayer.set("disabled", !0);
                    a = "hosted" === d && this.user ? b.string.substitute(this.i18n.error.itemNotAvailable, { title: c }) : b.string.substitute(this.i18n.error.serviceNotAvailable, { url: a });
                    arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: a })
                }, a, c))
            },
            _handleServiceInfo: function(a, c, d) {
                this.enable();
                c.layers ? c.capabilities && -1 === c.capabilities.toLowerCase().indexOf("query") ? (a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
                    a.show({ title: this.i18n.errorDlgTitle, message: b.string.substitute(this.i18n.error.cantUseService, { url: this.layerUrl }) })) : (this.serviceInfo = c, d = b.map(c.layers, b.hitch(this, function(a, b) { return { name: a.name, id: b + 1, layerId: a.id } })), d = d.sort(function(a, b) {
                    a = a.name.toLowerCase();
                    b = b.name.toLowerCase();
                    return a == b ? 0 : a < b ? -1 : 1
                }), 1 < c.layers.length && d.splice(0, 0, { name: this.i18n.selectLayer, id: -1 }), this.layersStore = new b.data.ItemFileWriteStore({ data: { label: "name", identifier: "id", items: d } }), "hosted" === a ? (this._queryItemLayer.set("disabled", !1), this._queryItemLayer.set("store", this.layersStore), this._queryItemLayer.set("value", 1 === c.layers.length ? 1 : -1)) : (this._queryUrlLayer.set("disabled", !1), this._queryUrlLayer.set("store", this.layersStore), this._queryUrlLayer.set("value", 1 === c.layers.length ? 1 : -1))) : "Feature Layer" === c.type ? (this.serviceInfo = null, this.layerUrl = d.substring(0, d.lastIndexOf("/")), this.layerId = parseInt(d.substring(d.lastIndexOf("/") + 1)), d = [{ name: c.name, id: 1, layerId: this.layerId }], this.layersStore = new b.data.ItemFileWriteStore({
                    data: {
                        label: "name",
                        identifier: "id",
                        items: d
                    }
                }), "hosted" === a ? (this._queryItemLayer.set("disabled", !1), this._queryItemLayer.set("store", this.layersStore), this._queryItemLayer.set("value", 1)) : (this._queryUrlLayer.set("disabled", !1), this._queryUrlLayer.set("store", this.layersStore), this._queryUrlLayer.set("value", 1)), c.capabilities && -1 === c.capabilities.toLowerCase().indexOf("query") ? this._handleLayerInfo({ layers: [] }) : this._handleLayerInfo({ layers: [c] })) : (a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
                    a.show({ title: this.i18n.errorDlgTitle, message: b.string.substitute(this.i18n.error.invalidUrl, { url: d }) }))
            },
            _handleLayerInfo: function(a) {
                this.enable();
                a && a.layers && a.layers.length ? (this.layersInfo = a, this._submitButton.set("disabled", !1)) : arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.errorDlgTitle, message: b.string.substitute(this.i18n.error.cantUseLayer, { title: this.layerName ? this.layerName : this.layerUrl + "/" + this.layerId }) })
            },
            _onChangeQueryItem: function(a) {
                this._submitButton.set("disabled", !0); - 1 === a ? (this.layersStore = new b.data.ItemFileWriteStore({ data: { label: "name", identifier: "id", items: [{ name: this.i18n.selectLayer, id: -1 }] } }), this._queryItemLayer.set("store", this.layersStore), this._queryItemLayer.set("disabled", !0)) : this.fsItemsStore.fetchItemByIdentity({
                    identity: a,
                    onItem: b.hitch(this, function(a) {
                        this.layerUrl = a.url.toString();
                        this.layerItemId = a.itemId.toString();
                        this.layersInfo = null;
                        this._getAllSublayers(this.layerUrl, a.name.toString(), "hosted")
                    })
                })
            },
            _onChangeQueryServiceLayer: function(a) {
                this._submitButton.set("disabled", !0); - 1 !== a && this.layersStore.fetchItemByIdentity({
                    identity: a,
                    onItem: b.hitch(this, function(a) {
                        this.layerId = a.layerId[0];
                        this.layerName = a.name[0];
                        this.disable(null, this.i18n.pleaseWaitForLayerInfo);
                        this.layersInfo ? this._handleLayerInfo(this.layersInfo) : arcgisonline.map.main.getLayerInfoForQueryFromUrl(this.layerUrl, this.serviceInfo, this.layerId, b.hitch(this, "_handleLayerInfo"))
                    })
                })
            },
            _onChangeLayerUrl: function() {
                var a = this._queryLayerUrl.get("value");
                a.length && (a.startsWith("http://") || a.startsWith("https://") ||
                    (a = "http://" + a, this._queryLayerUrl.set("value", a)), this.layerUrl = a, this.layersInfo = null, this._queryUrlLayer.set("disabled", !0), this._getAllSublayers(this.layerUrl, null, "url"))
            },
            _onClickChoiceItem: function() {
                b.style(this._queryLayerUrlDiv, "display", "none");
                b.style(this._queryLayerItemsDiv, "display", 10 > b.isIE ? "inline" : "")
            },
            _onClickChoiceUrl: function() {
                b.style(this._queryLayerItemsDiv, "display", "none");
                b.style(this._queryLayerUrlDiv, "display", 10 > b.isIE ? "inline" : "")
            },
            _onClickOrgItems: function() { this._getAllFSItems() },
            _onBlurLayerUrl: function() {},
            _onFocusLayerUrl: function() { this._queryLayerUrl.get("value") === this.i18n.enterUrl && this._queryLayerUrl.set("value", "") }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/ShareMapDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/utilShare,dijit/Dialog,arcgisonline/sharing/dijit/TemplatesGrid,arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/HelpManager,dijit/form/Textarea,dijit/_Widget,dijit/_Templated,dijit/Tooltip,dijit/layout/StackContainer,dojo/store/Memory,dojo/data/ObjectStore,arcgisonline/sharing/dijit/ShareOptions,arcgisonline/sharing/dijit/ComboBox,esri/basemaps,esri/dijit/Search,esri/dijit/Tags,dojo/on,dojo/mouse,arcgisonline/pages/utils/tooltips,arcgisonline/sharing/dijit/dialog/BrowseItemsDlg,arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer,arcgisonline/sharing/dijit/dialog/ConfirmDialog,arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg,arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin,arcgisonline/sharing/dijit/CopyToClipboard,esri/arcgis/utils,esri/tasks/PrintTask,esri/tasks/PrintParameters,esri/tasks/PrintTemplate,esri/request"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.ShareMapDlg");
            b.require("arcgisonline.sharing.util");
            b.require("arcgisonline.sharing.utilShare");
            b.require("dijit.Dialog");
            b.require("arcgisonline.sharing.dijit.TemplatesGrid");
            b.require("arcgisonline.sharing.geow.Content");
            b.require("arcgisonline.sharing.geow.Community");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");
            b.require("arcgisonline.sharing.dijit.HelpManager");
            b.require("dijit.form.Textarea");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dijit.Tooltip");
            b.require("dijit.layout.StackContainer");
            b.require("dojo.store.Memory");
            b.require("dojo.data.ObjectStore");
            b.require("arcgisonline.sharing.dijit.ShareOptions");
            b.require("arcgisonline.sharing.dijit.ComboBox");
            b.require("esri.basemaps");
            b.require("esri.dijit.Search");
            b.require("esri.dijit.Tags");
            b.require("dojo.on");
            b.require("dojo.mouse");
            b.require("arcgisonline.pages.utils.tooltips");
            b.require("arcgisonline.sharing.dijit.dialog.BrowseItemsDlg");
            b.require("arcgisonline.sharing.dijit.dialog.PluginConfigurableAppsViewer");
            b.require("arcgisonline.sharing.dijit.dialog.ConfirmDialog");
            b.require("arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg");
            b.require("arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin");
            b.require("arcgisonline.sharing.dijit.CopyToClipboard");
            b.require("esri.arcgis.utils");
            b.require("esri.tasks.PrintTask");
            b.require("esri.tasks.PrintParameters");
            b.require("esri.tasks.PrintTemplate");
            b.require("esri.request");
            b.declare("arcgisonline.sharing.dijit.dialog.ShareMapDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" class\x3d"${baseClass}" id\x3d"share-map-dialog" title\x3d"${i18n.share}" execute\x3d"" style\x3d"width:900px;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.StackContainer" id\x3d"share-map-stack" data-dojo-attach-point\x3d"_stackContainer" data-dojo-props\x3d"doLayout:false"\x3e\r\n      \x3cdiv id\x3d"galleryTabs" style\x3d"display:none;" class\x3d"galleryTabs"\x3e\r\n        \x3ca id\x3d"configurableTab" class\x3d"selected" href\x3d"JavaScript:void(0);"\x3e${i18n.configurableApps}\x3c/a\x3e\r\n        \x3ca id\x3d"appBuilderTab" href\x3d"JavaScript:void(0);"\x3e\x3c/a\x3e\r\n        \x3ca id\x3d"opDashboardTab" href\x3d"JavaScript:void(0);"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- all options --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackAllOptions" class\x3d"share-map-stack-stack"\x3e\r\n        \x3cdiv id\x3d"share-map-is-public" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"paddingBottom10"\x3e\r\n            \x3clabel\x3e\r\n              ${i18n.selectToShare}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-make-public" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"paddingBottom10"\x3e\r\n            \x3clabel style\x3d"font-weight:bold;"\x3e\r\n              ${i18n.chooseWhoCanView}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-text-public-note"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-premium" style\x3d"display:none;"\x3e\x3cspan class\x3d"esriItemLinks"\x3e${i18n.premiumLayerMsg}\x26nbsp;\x3cA id\x3d"share-map-premium-link" href\x3d"JavaScript:void(0)" target\x3d"_blank"\x3e${i18n.premiumLayerMsgLearnMore}\x3c/A\x3e\x3c/span\x3e\x3c/div\x3e\r\n          \x3c!--\r\n          \x3cdiv style\x3d"padding-top:15px;padding-bottom:15px;"\x3e\r\n          \x3cinput id\x3d"share-map-share-everyone" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" value\x3d"off" type\x3d"checkbox"/\x3e\r\n          \x3clabel id\x3d"share-map-label" for\x3d"share-map-share-everyone"\x3e\r\n          Share with everyone (public).\r\n          \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          --\x3e\r\n          \x3cdiv style\x3d"" data-dojo-type\x3d"arcgisonline.sharing.dijit.ShareOptions" data-dojo-attach-point\x3d"shareOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-not-public" style\x3d"display:none;padding-bottom:15px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-text-not-public-note"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"height:20px;"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d""\x3e\r\n          \x3clabel style\x3d"font-weight:bold;"\x3e\r\n            ${i18n.linkToMap}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"linkTypeDiv" class\x3d"paddingLeading15 paddingTop10 paddingBottom10" style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"linkType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"linkType:map" /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:50px;"\x3e\r\n            \x3clabel for\x3d"linkType:map"\x3e\r\n              ${i18n.mapLabel}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"linkType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"linkType:presentation" checked\x3d"checked"/\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:100px;"\x3e\r\n            \x3clabel for\x3d"linkType:presentation" id\x3d"linkType:presentation-label"\x3e\r\n              ${i18n.presentationLabel}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"paddingLeading15" style\x3d"clear:both;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" class\x3d"paddingTop10" style\x3d"width:320px;"\x3e\r\n            \x3cdiv id\x3d"share-map-url" data-dojo-type\x3d"dijit.form.Textarea" style\x3d"width:270px;color:#000;" dir\x3d"ltr"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"socialNetworkLinks" style\x3d"display:none;" class\x3d"esriFloatLeading"\x3e\r\n            \x3cdiv class\x3d"esriItemLinks"\x3e\r\n              \x3c!-- use table because of RTL + IE --\x3e\r\n              \x3ctable\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd width\x3d"24"\x3e\r\n                      \x3cA id\x3d"facebookLink" href\x3d"JavaScript:void(0);" title\x3d"${i18n.shareFacebook}" alt\x3d"${i18n.shareFacebook}" target\x3d"_blank"\x3e\x3cspan class\x3d"facebookBadge dijitInline"\x3e\x3c/span\x3e\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cA id\x3d"facebookLink2" style\x3d"vertical-align:top;" title\x3d"${i18n.shareFacebook}" alt\x3d"${i18n.shareFacebook}" target\x3d"_blank"\x3e${i18n.facebook}\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd width\x3d"15"\x3e\x26nbsp;\r\n\r\n                    \x3c/td\x3e\r\n                    \x3ctd width\x3d"24"\x3e\r\n                      \x3cA id\x3d"twitterLink" href\x3d"JavaScript:void(0);" title\x3d"${i18n.shareTwitter}" alt\x3d"${i18n.shareTwitter}" target\x3d"_blank"\x3e\x3cspan class\x3d"twitterBadge dijitInline"\x3e\x3c/span\x3e\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cA id\x3d"twitterLink2" style\x3d"vertical-align:top;" title\x3d"${i18n.shareTwitter}" alt\x3d"${i18n.shareTwitter}" target\x3d"_blank"\x3e${i18n.twitter}\x3c/A\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-url-extent-div" class\x3d"paddingTop5" style\x3d"clear:both;"\x3e\r\n            \x3cinput id\x3d"share-map-url-extent" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox" /\x3e\r\n            \x3clabel for\x3d"share-map-url-extent"\x3e\r\n              ${i18n.shareCurrentExtent}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-advanced-box" class\x3d"paddingTop10" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"share-map-advanced-label" style\x3d""\x3e\r\n            \x3clabel style\x3d"font-weight:bold;"\x3e\r\n              ${i18n.embedMap}\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"paddingLeading15"\x3e\r\n            \x3cdiv id\x3d"share-map-embed-option" class\x3d"esriFloatLeading" class\x3d"paddingTop10"\x3e\r\n              \x3ccenter\x3e\r\n                \x3cbutton id\x3d"button-share-map-embed" class\x3d"jevent medium" data-dojo-type\x3d"dijit.form.Button" type\x3d"button"\x3e\r\n                  ${i18n.embedInWebsite}\r\n                \x3c/button\x3e\r\n              \x3c/center\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv id\x3d"share-map-makeApp-option" class\x3d"esriFloatLeading" class\x3d"paddingTop10"\x3e\r\n              \x3ccenter\x3e\r\n                \x3cbutton id\x3d"button-share-map-application" class\x3d"jevent medium" data-dojo-type\x3d"dijit.form.Button" type\x3d"button"\x3e\r\n                  ${i18n.makeWebApp}\r\n                \x3c/button\x3e\r\n              \x3c/center\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"share-map-embed" class\x3d"paddingTop10" style\x3d"display:none;clear:both;width:75%;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3clabel id\x3d"share-map-embed-label"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-dialog-close" class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- embed option --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackEmbed" class\x3d"share-map-stack-stack"\x3e\r\n        \x3cdiv class\x3d"section embed-type"\x3e\r\n          \x3cdiv for\x3d"share-map-embed-type" class\x3d"sectionLabel"\x3e${i18n.updates.whatEmbed}\x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-embed-type" class\x3d"lineHeight18"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:map" checked\x3d"checked"\r\n                  data-dojo-attach-event\x3d"onClick:onChooseEmbedMap"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n              \x3clabel for\x3d"embedType:map"\x3e${i18n.updates.embedMap}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:presentation"\r\n                  data-dojo-attach-event\x3d"onClick:onChooseEmbedPresentation"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n              \x3clabel for\x3d"embedType:presentation" id\x3d"embedType:presentation:label"\x3e${i18n.updates.embedPresentation}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3c!--\x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e--\x3e\r\n              \x3c!--\x3cinput type\x3d"radio" name\x3d"embedType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedType:scene"--\x3e\r\n                  \x3c!--data-dojo-attach-event\x3d"onClick:onChooseEmbedScene"/\x3e--\x3e\r\n            \x3c!--\x3c/div\x3e--\x3e\r\n            \x3c!--\x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e--\x3e\r\n              \x3c!--\x3clabel for\x3d"embedType:scene"\x3e${i18n.updates.embedScene}\x3c/label\x3e--\x3e\r\n            \x3c!--\x3c/div\x3e--\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"section"\x3e\r\n          \x3cdiv class\x3d"sectionLabel adjustedHeight"\x3e\r\n            \x3cdiv id\x3d"embed-type-label" class\x3d"inline valignTop"\x3e${i18n.updates.chooseEmbed}\x3c/div\x3e\r\n            \x3cdiv id\x3d"mapSize-help" class\x3d"inline"\x3e\x3c/div\x3e\x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-mapsize" class\x3d"lineHeight18"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n                \x3clabel for\x3d"mapSize:custom:width"\x3e${i18n.updates.width}\x26nbsp;\x3c/label\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3cdiv id\x3d"mapSize:custom:width" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" style\x3d"width:35px;" value\x3d"500"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n                \x3ctd\x3e\x3cspan\x3e\x26nbsp;${i18n.updates.by}\x26nbsp;\x3c/span\x3e\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3clabel for\x3d"mapSize:custom:height"\x3e${i18n.updates.height}\x26nbsp;\x3c/label\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv id\x3d"mapSize:custom:height" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" style\x3d"width:35px;" value\x3d"400"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1 padTopHalfEm"\x3e\r\n              \x3cinput type\x3d"checkbox" id\x3d"mapSize:responsive" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true"\x3e\r\n              \x3clabel for\x3d"mapSize:responsive"\x3e${i18n.updates.allowResponsive}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"section"\x3e\r\n          \x3cdiv for\x3d"share-map-embed-text" class\x3d"esriFloatLeading sectionLabel"\x3e${i18n.copyPaste}\x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"/\x3e\r\n          \x3c!--\x3cdiv id\x3d"share-map-embed-text" dir\x3d"ltr" data-dojo-type\x3d"dijit.form.Textarea" style\x3d"width:98%;height:18px;max-height:18px;"\x3e\x3c/div\x3e--\x3e\r\n          \x3cdiv id\x3d"share-map-embed-text"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"mapOptionsContainer"\x3e\r\n          \x3cdiv id\x3d"embedTabs" class\x3d"embedTabs"\x3e\r\n            \x3ca id\x3d"advOptionsTab" class\x3d"selected" href\x3d"JavaScript:void(0);"\x3e${i18n.updates.advancedOpt}\x3c/a\x3e\r\n            \x3ca id\x3d"addMarkerTab" href\x3d"JavaScript:void(0);"\x3e${i18n.updates.addMarkerSym}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv id\x3d"advancedOptionsTab" class\x3d"fixedHeightContainer"\x3e\r\n            \x3cdiv class\x3d"sectionLabel paddingTop5"\x3e${i18n.updates.chooseOptions}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading sectionCol"\x3e\r\n              \x3cdiv id\x3d"share-map-zoom"\x3e\r\n                \x3cinput id\x3d"share-map-embed-zoom" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-zoom" id\x3d"share-map-embed-zoom-label"\x3e\r\n                  ${i18n.updates.zoomControl}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-home" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-home" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-home" id\x3d"share-map-embed-home-label"\x3e\r\n                  ${i18n.updates.homeButton}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-basemap" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-basemap" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                    data-dojo-attach-event\x3d"onClick:onBasemapSelectorClicked"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-basemap" id\x3d"share-map-embed-basemap-label"\x3e\r\n                  ${i18n.updates.basemapSelector}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-basemap-options" class\x3d"paddingLeading15" style\x3d"display:none;"\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"basemapType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"basemapType:gallery" checked\x3d"checked"\r\n                      data-dojo-attach-event\x3d"onChange:onBasemapTypeChanged"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:105px;"\x3e\r\n                  \x3clabel for\x3d"basemapType:gallery"\x3e${i18n.updates.basemapGallery}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr style\x3d"clear:both;"/\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"basemapType" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"basemapType:toggle"\r\n                         data-dojo-attach-event\x3d"onChange:onBasemapTypeChanged"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading paddingTop10" style\x3d"width:105px;"\x3e\r\n                  \x3clabel for\x3d"basemapType:toggle"\x3e${i18n.updates.basemapToggle}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr style\x3d"clear:both"/\x3e\r\n                \x3cdiv id\x3d"share-map-second-basemap" class\x3d"paddingTop10" style\x3d"display:none;"\x3e\r\n                  \x3cspan\x3e${i18n.updates.chooseAltBasemap}\x3c/span\x3e\x3cbr/\x3e\r\n                  \x3cselect name\x3d"secondBasemap" id\x3d"basemap:secondBasemap" style\x3d"width:120px;"\r\n                          data-dojo-type\x3d"arcgisonline.sharing.dijit.ComboBox"\r\n                          data-dojo-attach-event\x3d"onChange:onSecondBasemapChange"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-largemap" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-largemap" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-largemap" id\x3d"share-map-embed-largemap-label"\x3e\r\n                  ${i18n.viewLargerMap}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-disablezoom" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-disablezoom" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-disablezoom" id\x3d"share-map-embed-disablezoom-label"\x3e\r\n                  ${i18n.updates.disableZoom}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading paddingLeading40 sectionCol"\x3e\r\n              \x3cdiv id\x3d"share-map-scale"\x3e\r\n                \x3cinput id\x3d"share-map-embed-scale" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-scale" id\x3d"share-map-embed-scale-label"\x3e\r\n                  ${i18n.updates.scaleBar}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-location" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-location" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-location" id\x3d"share-map-embed-location-label"\x3e\r\n                  ${i18n.updates.geocoder}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-location-restrict" class\x3d"paddingTop10 paddingLeading15" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"share-map-embed-location-restrict" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-location-restrict" id\x3d"share-map-embed-location-restrict-label"\x3e\r\n                  ${i18n.updates.currentExtent}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-description" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-description" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                       data-dojo-attach-event\x3d"onClick:onShareMapActivePanelCheck"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-description" id\x3d"share-map-embed-description-label"\x3e\r\n                  ${i18n.updates.mapDetails}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-legend" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"share-map-embed-legend" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox"\r\n                       data-dojo-attach-event\x3d"onClick:onShareMapActivePanelCheck"/\x3e\r\n                \x3clabel for\x3d"share-map-embed-legend" id\x3d"share-map-embed-legend-label"\x3e\r\n                  ${i18n.updates.legend}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-layer-toggle" class\x3d"paddingTop10 paddingLeading15" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"share-map-embed-layer-toggle" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" /\x3e\r\n                \x3clabel for\x3d"share-map-embed-layer-toggle" id\x3d"share-map-embed-layer-toggle-label"\x3e\r\n                  ${i18n.updates.layerToggle}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"preview-image" class\x3d"paddingTop10"\x3e\r\n                \x3cinput id\x3d"preview-image-embed" data-dojo-attach-point\x3d"_previewCheckbox" data-dojo-type\x3d"dijit.form.CheckBox" value\x3d"off" type\x3d"checkbox" disabled /\x3e\r\n                \x3clabel for\x3d"preview-image-embed" id\x3d"preview-image-embed-label" data-dojo-attach-point\x3d"_previewLabel" class\x3d"label-disabled option-loading"\x3e\r\n                  ${i18n.updates.previewImage}\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-active-panel" class\x3d"paddingTop10" style\x3d"display:none;"\x3e\r\n                \x3cspan\x3e${i18n.updates.choosePanel}\x3c/span\x3e\x3cbr/\x3e\r\n                \x3cselect name\x3d"activePanel" id\x3d"activePanel" style\x3d"width:120px;"\r\n                        data-dojo-type\x3d"arcgisonline.sharing.dijit.ComboBox"\r\n                        data-dojo-attach-event\x3d"onChange:onShareMapActivePanelChange"\x3e\r\n                  \x3coption value\x3d"details"\x3e${i18n.updates.mapDetails}\x3c/option\x3e\r\n                  \x3coption value\x3d"legend"\x3e${i18n.updates.legend}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n              \x3c!--\x3cdiv id\x3d"share-map-presentation" class\x3d"paddingTop5"\x3e--\x3e\r\n                \x3c!--\x3cinput id\x3d"share-map-embed-presentation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" value\x3d"off" type\x3d"checkbox" /\x3e--\x3e\r\n                \x3c!--\x3clabel for\x3d"share-map-embed-presentation"\x3e--\x3e\r\n                  \x3c!--${i18n.embedPresentation}--\x3e\r\n                \x3c!--\x3c/label\x3e--\x3e\r\n              \x3c!--\x3c/div\x3e--\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatTrailing paddingTrailing40"\x3e\r\n              \x3c!--for map preview--\x3e\r\n              \x3clabel for\x3d"mapPreview"\x3e${i18n.updates.mapPreview}\x3c/label\x3e\x3cbr/\x3e\r\n              \x3cdiv id\x3d"mapPreview" class\x3d"imageStack"\x3e\r\n                \x3cdiv id\x3d"mapPreview:basemap" class\x3d"imageLayer previewBasemap" style\x3d"z-index:50"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:panel" class\x3d"imageLayer previewPanel" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:details" class\x3d"imageLayer previewDetails" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:legend" class\x3d"imageLayer previewLegend" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:gallery" class\x3d"imageLayer previewGallery" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:toggle" class\x3d"imageLayer previewToggle" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:zoom" class\x3d"imageLayer previewZoom" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:zoomhome" class\x3d"imageLayer previewZoomHome" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:search" class\x3d"imageLayer previewSearch" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n                \x3cdiv id\x3d"mapPreview:scale" class\x3d"imageLayer previewScale" style\x3d"z-index:51;display:none;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.selectTheme}\x3c/div\x3e\r\n              \x3cdiv id\x3d"share-map-theme" class\x3d"lineHeight18"\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"embedTheme" checked\x3d"checked" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedTheme:light"\r\n                         data-dojo-attach-event\x3d"onChange:onThemeChange"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                  \x3cdiv class\x3d"themeSwatch light"\x3e\x26nbsp;\x3c/div\x3e\r\n                  \x3clabel for\x3d"embedTheme:light"\x3e${i18n.updates.lightTheme}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                  \x3cinput type\x3d"radio" name\x3d"embedTheme" data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"embedTheme:dark"\r\n                         data-dojo-attach-event\x3d"onChange:onThemeChange"/\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                  \x3cdiv class\x3d"themeSwatch darkTheme"\x3e\x26nbsp;\x3c/div\x3e\r\n                  \x3clabel for\x3d"embedTheme:dark"\x3e${i18n.updates.darkTheme}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cbr style\x3d"clear:both;"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv id\x3d"addMarkerSymbolTab" class\x3d"fixedHeightContainer" style\x3d"display:none;"\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.selectLocation}\x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"markerLocation" id\x3d"marker:search" checked\x3d"checked"\r\n                       data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-event\x3d"onChange:onMarkerLocationTypeChange"/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:95px;"\x3e\r\n                \x3clabel for\x3d"marker:search"\x3e${i18n.updates.locationSearch}\x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:20px;"\x3e\r\n                \x3cinput type\x3d"radio" name\x3d"markerLocation" id\x3d"marker:latlong" data-dojo-type\x3d"dijit.form.RadioButton"\r\n                       data-dojo-attach-event\x3d"onChange:onMarkerLocationTypeChange"/\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:115px;"\x3e\r\n                \x3clabel for\x3d"marker:latlong"\x3e${i18n.updates.locationLatLng}\x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cbr style\x3d"clear:both;"/\x3e\r\n              \x3cdiv id\x3d"marker:search:input" class\x3d"sectionNoBorder"\x3e\r\n                \x3cdiv id\x3d"marker:geocoder" style\x3d"position:relative;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"marker:latlong:input" class\x3d"sectionNoBorder" style\x3d"display:none;"\x3e\r\n                \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\x3clabel for\x3d"latitude:y"\x3e${i18n.updates.latitudeY}\x3c/label\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x3clabel\x3e${i18n.updates.longitudeX}\x3c/label\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd\x3e\x3cinput id\x3d"latitude:y" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\x3cinput id\x3d"longitude:x" class\x3d"paddedInput" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\x3c/td\x3e\r\n                    \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cbutton id\x3d"setLocation" type\x3d"button" class\x3d"calcite light small" data-dojo-type\x3d"dijit.form.Button"\r\n                              data-dojo-attach-event\x3d"onClick:onSetLocationClick"\x3e\r\n                        ${i18n.updates.setLocation}\r\n                      \x3c/button\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e\x3clabel for\x3d"marker-symbol-title"\x3e${i18n.updates.markerTitle}\x3c/label\x3e\x3c/div\x3e\r\n              \x3cinput type\x3d"text" id\x3d"marker-symbol-title" class\x3d"paddedInput" style\x3d"width:550px;" data-dojo-type\x3d"dijit.form.TextBox"\r\n                     data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onChange:onMarkerSymbolTitleChange,onKeyDown:onMarkerSymbolTitleKeyDown"/\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e${i18n.updates.markerDescription}\x3c/div\x3e\r\n              \x3cdiv id\x3d"marker-symbol-desc" data-dojo-type\x3d"dijit.form.Textarea"\r\n                   class\x3d"paddedInput"\r\n                   style\x3d"width:561px;height:40px;min-height:40px;max-height:40px;"\r\n                   data-dojo-attach-event\x3d"onChange:onMarkerSymbolDescChange"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"sectionNoBorder"\x3e\r\n              \x3cdiv class\x3d"sectionLabel"\x3e\x3clabel for\x3d"marker-symbol-url"\x3e${i18n.updates.markerUrl}\x3c/label\x3e\x3c/div\x3e\r\n              \x3cinput type\x3d"text" id\x3d"marker-symbol-url" class\x3d"paddedInput" style\x3d"width:550px;" data-dojo-type\x3d"dijit.form.TextBox"\r\n                     data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onChange:onMarkerSymbolUrlChange,onKeyDown:onMarkerSymbolUrlKeyDown"/\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!--\x3cdiv class\x3d"esriPositionRight0" style\x3d"position:absolute;bottom:5px;"\x3e--\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n          \x3cbutton id\x3d"share-map-embed-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapEmbedBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onEmbedClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option gallery  --\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationGallery" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n\r\n        \x3c!--\x3cdiv style\x3d"padding-bottom:15px;padding-top:0;"\x3e--\x3e\r\n          \x3c!--\x3clabel\x3e--\x3e\r\n            \x3c!--${i18n.selectTemplate}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3c!--\x3cdiv id\x3d"share-map-application-gallery-box" style\x3d"border:#333 1px solid; width:auto; min-height:325px; padding:0; overflow:hidden;"\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d"position:relative; width:565px;" id\x3d"templatesGallery" jsId\x3d"gallery" data-dojo-type\x3d"arcgisonline.sharing.dijit.TemplatesGrid" sortField\x3d"\'title\'" groupQuery\x3d"esriGeowConfig.templatesGroupQuery" galleryNodes\x3d"8"\x3e--\x3e\r\n          \x3c!--\x3c/div\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv id\x3d"gallery-grid"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-application-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapApplicationBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n            \x3c!--\x3cbutton id\x3d"share-map-application-next" class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"--\x3e\r\n                    \x3c!--data-dojo-attach-event\x3d"onClick:onShareMapApplicationNext"\x3e--\x3e\r\n                \x3c!--${i18n.next}--\x3e\r\n            \x3c!--\x3c/button\x3e--\x3e\r\n          \x3cbutton class\x3d"calcite cancel" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option publish  --\x3e\r\n      \x3cdiv id\x3d"share-map-application-publish" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationPublish" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cp class\x3d"configureApp"\x3e${i18n.savePublish}\x3c/p\x3e\r\n        \x3cp style\x3d"display:none;" class\x3d"appBuilder" data-dojo-attach-point\x3d"_stackApplicationPublishMsg"\x3e${i18n.appBuilderMsg}\x3c/p\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_itemProperties"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"share-map-same-level" style\x3d"margin-left:22.5%; margin-top:0.75em;"\x3e\r\n            \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit.form.CheckBox" data-dojo-attach-point\x3d"_shareSameLevel"\x3e\x3c/div\x3e\r\n            \x3clabel id\x3d"publish-webmap-sharing-label" for\x3d"publish-webmap-sharing"\x3e${i18n.shareSameLevel}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cspan id\x3d"publish-webmap-waiting" style\x3d"display:none;"\x3e${i18n.savingAndPublishing}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n          \x3cbutton id\x3d"share-map-application-publish-config-back" class\x3d"calcite default" type\x3d"button"\r\n                  data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onShareMapApplicationPublishConfigBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton id\x3d"publish-webmap-button" class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.savePublishBtn}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite cancel" type\x3d"button" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- configure application help --\x3e\r\n      \x3cdiv id\x3d"share-map-application-publish-help" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationPublishHelp" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cp\x3e\r\n          ${i18n.publishSuccess}\r\n        \x3c/p\x3e\r\n        \x3cp\x3e\r\n          \x3cb\x3e${i18n.shareApp}\x3c/b\x3e - ${i18n.shareInstructions}\r\n        \x3c/p\x3e\r\n        \x3cp\x3e\r\n          \x3cb\x3e${i18n.configureApp}\x3c/b\x3e - ${i18n.configureInstructions}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"esriItemLinks"\x3e\r\n          ${i18n.youCan} \x3ca id\x3d"_shareApplicationPublishAppUrl" href\x3d"JavaScript:void(0);"\x3e${i18n.goToItem}\x3c/a\x3e\r\n          ${i18n.toShare}\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"publish-webmap-view-item-button" class\x3d"jevent calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.viewItemButton}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- application option help  --\x3e\r\n      \x3cdiv id\x3d"share-map-application-help" data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_stackApplicationHelp" class\x3d"share-map-stack-stack"\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3clabel style\x3d"font-weight:bold; text-decoration:underline; "\x3e--\x3e\r\n            \x3c!--${i18n.makeWebApp}--\x3e\r\n          \x3c!--\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv style\x3d"padding-top:15px;"\x3e\r\n          \x3clabel\x3e\r\n            ${i18n.followSteps}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"padding-top:0;"\x3e\r\n          \x3cul\x3e\r\n            \x3cli\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.unzipFile}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.unzipFileInstructions}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n            \x3cli style\x3d"margin-top:10px;"\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.deployTheApp}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.copyAppToWeb}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n            \x3cli style\x3d"margin-top:10px;"\x3e\r\n              \x3cspan style\x3d"font-weight:bold;"\x3e${i18n.configureTheApp}\x3c/span\x3e\r\n              \x3cdiv\x3e\r\n                ${i18n.makeAppChanges}\r\n              \x3c/div\x3e\r\n            \x3c/li\x3e\r\n          \x3c/ul\x3e\r\n          \x3cdiv class\x3d"paddingTop10"\x3e\r\n            \x3cspan\x3e${i18n.yourMapId} \x3c/span\x3e\r\n            \x3cspan id\x3d"share-map-webmapId"\x3e${i18n.yourMapId} \x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"share-map-text-findId" class\x3d"paddingTop10"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriPositionRight15" style\x3d"position:absolute;bottom:5px;"\x3e\r\n          \x3cbutton id\x3d"share-map-application-help-back" class\x3d"calcite default" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\r\n              data-dojo-attach-event\x3d"onClick:onShareMapApplicationHelpBack"\x3e\r\n            ${i18n.back}\r\n          \x3c/button\x3e\r\n          \x3cbutton class\x3d"calcite primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button" data-dojo-attach-event\x3d"onClick:onClose"\x3e\r\n            ${i18n.done}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                baseClass: "esriShareMapDlg",
                content: arcgisonline.sharing.geow.Content,
                community: arcgisonline.sharing.geow.Community,
                createItemUtil: arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin,
                init: !1,
                webMapId: "",
                viewerUrl: null,
                embedMapUrl: null,
                basicViewerUrl: null,
                presentationUrl: null,
                hasBing: null,
                folderId: null,
                sharingInfo: null,
                size: "medium",
                webmapTitle: "",
                webMapOwner: "",
                gcsExtStr: "",
                shortenedUrl: null,
                _isPublishing: !1,
                previewImage: !1,
                defaultTextTitle: null,
                defaultTextTags: null,
                defaultTextSummary: null,
                waitHandler: null,
                publishWebmapViewItemButtonHandler: null,
                homeViewerPath: "/home/webmap/viewer.html",
                embedAppPath: "/apps/Embed/index.html",
                statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.ShareMapDlg); return this._instance } },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").saveWebMapDlg);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").shareMapDlg);
                    this.i18n.shareOptions = b.i18n.getLocalization("arcgisonline", "arcgisonline").shareOptions;
                    this.i18n.shareErrors = b.i18n.getLocalization("arcgisonline", "arcgisonline").addItemFrm.errors;
                    this.i18n.browseItemsDlg = b.i18n.getLocalization("arcgisonline", "arcgisonline").browseItemsDlg;
                    this.defaultTextTitle = this.i18n.enterMapTitle;
                    this.defaultTextTags = this.i18n.separateTags;
                    this.defaultTextSummary = this.i18n.enterSummary
                },
                postCreate: function() {
                    this.init || (b.byId("share-map-text-not-public-note").innerHTML = esri.substitute({ portalName: this._getPortalName() }, this.i18n.shareMapNotPublic), b.byId("share-map-text-findId").innerHTML = esri.substitute({ portalName: this._getPortalName() }, this.i18n.findId), this.loadConnections(), this.init = !0, this._stackContainer.selectChild(this._stackEmbed), b.byId("share-groups-check-label").innerHTML = this.i18n.shareGroupsLabel, b.byId("appBuilderTab").innerHTML = this.i18n.appBuilderTitle, b.byId("opDashboardTab").innerHTML =
                        this.i18n.opDashboardTitle, g.byId("share-map-dialog").closeText.title = this.i18n.close, g.byId("share-map-dialog").closeButtonNode.title = this.i18n.close, this._showGalleryTabs(!0), this._setupBasemapSelector(), this._setupMapPreview(), this._setupEmbedHelp(), this._setupItemPropertiesDlg(), this._setupCopyHTML())
                },
                _setupCopyHTML: function() {
                    this._copy = new arcgisonline.sharing.dijit.CopyToClipboard({ text: "", id: "copyToClipboard" }, b.byId("share-map-embed-text"));
                    var a = b.query(".js-copy-btn", this._copy.domNode).shift();
                    b.attr(a, "innerHTML", this.i18n.updates.copy);
                    b.on(a, "click", b.hitch(this, function() {
                        this._copiedData = !0;
                        arcgisonline.pages.utils.tooltips.oneTimeTooltip(this.i18n.updates.copied, a)
                    }));
                    b.connect(b.byId("copy-to-clipboard-" + this._copy.id), "onkeydown", this, "listenForCopy");
                    b.connect(b.byId("copy-to-clipboard-" + this._copy.id), "onclick", this, "toggleSelect");
                    document.queryCommandSupported("copy") || b.attr(a, "disabled", !0)
                },
                _setupBasemapSelector: function() {
                    this._topoTitle = "";
                    this._basemaps = [];
                    for (var a in esri.basemaps) esri.basemaps.hasOwnProperty(a) &&
                        ("topo" === a && (this._topoTitle = esri.basemaps[a].title), this._basemaps.push({ id: a, name: esri.basemaps[a].title }));
                    g.byId("basemap:secondBasemap").set("store", new b.store.Memory({ data: this._basemaps }));
                    g.byId("basemap:secondBasemap").set("value", this._topoTitle)
                },
                _setupEmbedHelp: function() {
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/css/images/info.png") }, b.byId("mapSize-help"));
                    this._embedHelpTooltip = new g.Tooltip({
                        label: '\x3cdiv style\x3d"max-width:300px;"\x3e' +
                            ("\x3cp\x3e" + this.i18n.updates.setDimensions + "\x3c/p\x3e\x3cp\x3e" + this.i18n.updates.commonSizes + "\x3c/p\x3e\x3cp\x3e" + this.i18n.updates.smallSize + "\x3cbr\x3e" + this.i18n.updates.mediumSize + "\x3cbr\x3e" + this.i18n.updates.largeSize + "\x3c/p\x3e") + "\x3c/div\x3e",
                        connectId: ["mapSize-help"],
                        id: "tooltip_mapSize-help",
                        showDelay: 200
                    })
                },
                _setupMapPreview: function() {
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_background.png") }, b.byId("mapPreview:basemap"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_left-panel.png") }, b.byId("mapPreview:panel"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_map-details-active.png") }, b.byId("mapPreview:details"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_legend-active.png") }, b.byId("mapPreview:legend"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_basemap-gallery.png") }, b.byId("mapPreview:gallery"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_basemap-toggle.png") }, b.byId("mapPreview:toggle"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_zoom.png") }, b.byId("mapPreview:zoom"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_zoom-and-home.png") }, b.byId("mapPreview:zoomhome"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_scale.png") }, b.byId("mapPreview:scale"));
                    b.create("img", { src: arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/dialog/css/images/preview_search-field.png") }, b.byId("mapPreview:search"))
                },
                _setupGeocoder: function() {
                    if (!this._geocoder) {
                        var a = arcgisonline.map.geocode.createSearchOptions();
                        a.map = null;
                        a.showInfoWindowOnSelect = !1;
                        this._geocoder = new esri.dijit.Search(a, b.create("div", { id: "embedSearch" }, b.byId("marker:geocoder")));
                        this._geocoder.startup();
                        this._geocoder.on("select-result", b.hitch(this, this.onSearchResult))
                    }
                },
                _setupItemPropertiesDlg: function() {
                    this._itemPropDlg || this.getUserItemTitles(b.hitch(this, function() {
                        this._itemPropDlg = new arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg({
                            typeInfo: "configapp",
                            existingItems: this.allItemNames,
                            showFolders: !0,
                            showFile: !1,
                            item: b.mixin({}, this._webAppItemCard)
                        }, b.create("div", {}, this._itemProperties));
                        this._itemPropDlg.startup();
                        this._webAppItemCard && (this._itemPropDlg.set("summary", this._webAppItemCard.snippet), this._itemPropDlg.set("title", this._webAppItemCard.title), this._itemPropDlg.set("categories", this._webAppItemCard.categories || []), this._itemPropDlg.set("tags", this._webAppItemCard.tags || []))
                    }))
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._lastPane =
                        this._configureSettings = this._opDashboardSetings = this._appBuilderSettings = this._folders = null;
                    this._embedHelpTooltip && this._embedHelpTooltip.destroy();
                    this._itemPropDlg && (this._itemPropDlg.destroy(), this._itemPropDlg = null)
                },
                getUserFolders: function(a) {
                    var c = this._user || (this._user = arcgisonline.sharing.util.getUser());
                    (null === c || this._folders) && a();
                    arcgisonline.sharing.geow.Folder.getFolders(b.hitch(this, function(d) {
                        var f = c.email;
                        if (b.cookie("ESRI_Content")) {
                            var e = arcgisonline.sharing.util.getCookie("ESRI_Content");
                            e.folderId && (f = e.folderId || c.email)
                        }
                        d = this._folders = d.folders;
                        e = [{ label: c.email, value: c.email }];
                        e = e.concat(b.map(d, b.hitch(this, function(a) { return { label: a.title, value: a.id } })));
                        this._selectedFolderId = f;
                        this.getUserItemTitles(a)
                    }), b.hitch(this, function(b) {
                        this.showError({ title: this.i18n.errorTitle, message: esri.substitute({ message: b.message }, this.i18n.searchFoldersFailed) });
                        a()
                    }))
                },
                getUserItemTitles: function(a) {
                    var c = arcgisonline.sharing.util.getUser();
                    null != c && (c = esriGeowConfig.restBaseUrl + "search?num\x3d100\x26q\x3d" +
                        encodeURIComponent('type:"Web Mapping Application" itemtype:text owner:"' + c.email + '"'), arcgisonline.sharing.util.getJson(c, b.hitch(this, function(c) {
                            this.allItemNames = b.map(c.results, b.hitch(this, function(a) { return a }));
                            a()
                        }), b.hitch(this, function(b) {
                            this.showError({ title: this.i18n.errorTitle, message: esri.substitute({ message: b.message }, this.i18n.searchMapsFailed) });
                            a()
                        })))
                },
                loadConnections: function() {
                    b.query(".jevent").connect("onclick", function(a) { a.preventDefault() });
                    b.query("#button-share-map-embed").connect("onclick",
                        b.hitch(this, function() { g.byId("button-share-map-embed").get("disabled") || (g.byId("share-map-dialog").set("title", this.i18n.embedInWebsite), this._stackContainer.selectChild(this._stackEmbed), this._copiedData = !1, this._setupPreviewImage()) }));
                    b.query("#button-share-map-application").connect("onclick", b.hitch(this, function() {
                        if (!g.byId("button-share-map-application").get("disabled")) {
                            g.byId("share-map-dialog").set("title", this.i18n.makeNewWebApp);
                            this._showGalleryTabs(!0);
                            this._changeTab();
                            var a = g.byId("templatesGallery");
                            a && a._groupDoesntExist && arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: this.i18n.notice, message: this.i18n.groupDoesntExist })
                        }
                    }));
                    b.connect(this._stackApplicationGallery, "onShow", b.hitch(this, function() {
                        this._browseItemsDlg || (this._browseItemsDlg = new arcgisonline.sharing.dijit.dialog.BrowseItemsDlg({
                            plugin: "arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer",
                            messageLeft: this.i18n.browseItemsDlg.instructionsLeft,
                            messageRight: this.i18n.browseItemsDlg.instructionsRight,
                            "class": "esriBrowseItemsDlg"
                        }, b.create("div", {}, b.byId("gallery-grid"))), this._browseItemsDlg.startup(), this._browseItemstopicHandle = b.topic.subscribe("/esri/browseitems/close", b.hitch(this, function(a, b) {
                            if ("create-app" === a) this.onShareMapApplicationNext();
                            else if ("preview-app" === a) this.onPreviewApp(b);
                            else "download-app" === a && arcgisonline.sharing.util.downloadWebMappingApp(b)
                        })))
                    }));
                    b.connect(this._stackAllOptions, "onShow", b.hitch(this, function() { this._showGalleryTabs(!1) }));
                    b.connect(this._stackApplicationPublish,
                        "onShow", b.hitch(this, function() {
                            if (!this._user) {
                                arcgisonline.map.storage.saveMapInCookie(null, !0);
                                var a = arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl);
                                window.location = a + "signin.html?returnUrl\x3d" + encodeURIComponent(window.location) + "%26showPublish\x26error\x3d403"
                            }
                        }));
                    b.connect(g.byId("publish-webmap-button"), "onClick", this, "publishWebMap");
                    b.connect(b.byId("configurableTab"), "onclick", b.hitch(this, "_changeTab"));
                    b.connect(b.byId("appBuilderTab"), "onclick", b.hitch(this, "_changeTab"));
                    b.connect(b.byId("opDashboardTab"), "onclick", b.hitch(this, "_changeTab"));
                    b.connect(b.byId("advOptionsTab"), "onclick", b.hitch(this, "_changeEmbedTab"));
                    b.connect(b.byId("addMarkerTab"), "onclick", b.hitch(this, "_changeEmbedTab"));
                    this.own(b.on(this._previewCheckbox, "change", function(a) {
                        this.previewImage = a;
                        this._resetEmbedParams()
                    }.bind(this)));
                    b.mixin(g.byId("share-map-dialog"), { onCancel: b.hitch(this, function() { this.hide() }) });
                    b.connect(b.byId("share-map-url"), "onkeypress", this, "doNothing");
                    b.connect(b.byId("linkType:presentation"),
                        "onclick", b.hitch(this, "updateLinkType", "presentation"));
                    b.connect(b.byId("linkType:map"), "onclick", b.hitch(this, "updateLinkType", "map"));
                    b.connect(b.byId("share-map-url-extent"), "onclick", b.hitch(this, "updateMapUrlExtent"));
                    b.connect(b.byId("share-map-embed-zoom"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-home"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-scale"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-legend"),
                        "onclick", b.hitch(this, "updateLegend"));
                    b.connect(b.byId("share-map-embed-layer-toggle"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-description"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-location"), "onclick", b.hitch(this, "updateLocation"));
                    b.connect(b.byId("share-map-embed-location-restrict"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-basemap"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-largemap"),
                        "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("share-map-embed-disablezoom"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("mapSize:responsive"), "onclick", b.hitch(this, "updateEmbedHTML"));
                    b.connect(b.byId("mapSize:custom:width"), "onkeyup", b.hitch(this, "updateMapSize", "custom"));
                    b.connect(b.byId("mapSize:custom:height"), "onkeyup", b.hitch(this, "updateMapSize", "custom"));
                    b.connect(b.byId("mapSize:responsive"), "click", b.hitch(this, "updateMapSize", "custom"));
                    b.subscribe("onShareUpdate",
                        b.hitch(this, function() {
                            this.disable(!1);
                            this.shortenedUrl = null;
                            this.checkUpdatedSharingStatus()
                        }));
                    arcgisonline.map.role.isAllowed("share_makeWebApp") && !1 !== arcgisonline.map.main.appAccess || b.style(b.byId("share-map-makeApp-option"), "display", "none");
                    b.subscribe("onClickEveryone", b.hitch(this, function(a) {
                        if (g.byId("share-everyone-check").get("checked") && this._isPrivateOrg) {
                            var b = {
                                title: this.i18n.share,
                                message: '\x3cp class\x3d"esriItemLinks"\x3e' + esri.substitute({
                                    url: '\x3ca href\x3d"' + (this.helpBase +
                                        this.helpMap["120000455"]) + '" target\x3d"_blank" \x3e' + this.i18n.shareHelpLinkText + "\x3c/a\x3e"
                                }, this.i18n.shareWithEveryoneMessage) + "\x3c/p\x3e"
                            };
                            this.showError(b)
                        }
                        this.shareWait(a)
                    }));
                    b.subscribe("onClickAccount", b.hitch(this, function(a) { this.shareWait(a) }));
                    b.subscribe("onClickGroup", b.hitch(this, function(a) { this.shareWait(a) }))
                },
                _setupPreviewImage: function() {
                    var a = arcgisonline.sharing.util.getUser();
                    !a || a && !a.accountId && !a.orgId || a && a.username !== this.item.owner && (a.orgId !== this.item.orgId || !a.privileges ||
                        -1 === a.privileges.indexOf("portal:admin:updateItems")) ? b.style(b.byId("preview-image"), "display", "none") : this._generateEmbedImage()
                },
                onPreviewApp: function(a) {
                    var b = void 0 !== esriGeowConfig.isMultiTenant && null !== esriGeowConfig.isMultiTenant && !1 === esriGeowConfig.isMultiTenant,
                        d = a.url,
                        d = 0 === d.indexOf("http") || 0 === d.indexOf("//") ? d : window.location.protocol + "//" + window.location.host + d;
                    this.currentUser && !this.currentUser.accountId ? d = b ? this._getPortalPreviewUrl(a, d) : d.replace("/hosted/", "/apps/") : b && (d = this._getPortalPreviewUrl(a,
                        d));
                    arcgisonline.map.mapUtil.previewTemplate(d, a.id)
                },
                downloadWebMappingApp: function(a) {
                    var c = "Mobile Application" !== a.type ? "WMA2Code" : "MobileApp2Code",
                        d = esriGeowConfig.restBaseUrl + "content/items/" + a.id + "/relatedItems",
                        c = a.relatedItems || arcgisonline.sharing.util.request({ url: d, content: { relationshipType: c } }).then(b.hitch(this, function(b) { a.relatedItems = b && b.relatedItems || []; return a.relatedItems }));
                    return b.when(c, b.hitch(this, function(a) {
                        var c = a || [],
                            d = b.filter(c, function(a) { return a && null !== a.url });
                        a = d && d.length ? d[0] : c && 0 < c.length ? c[0] : a;
                        if (a.id) var f = a.url || arcgisonline.sharing.util.getItemDataPath(a);
                        a.url ? window.open(f) : window.location = f;
                        g.byId("share-map-stack") && g.byId("share-map-stack").selectChild(g.byId("share-map-application-help"))
                    }), b.hitch(this, function(a) {}))
                },
                onBasemapSelectorClicked: function(a) {
                    g.byId("share-map-embed-basemap").get("checked") ? esri.show(b.byId("share-map-basemap-options")) : esri.hide(b.byId("share-map-basemap-options"));
                    this.updateMapSize(this.size)
                },
                onBasemapTypeChanged: function(a) {
                    g.byId("basemapType:gallery").get("checked") ?
                        esri.hide(b.byId("share-map-second-basemap")) : esri.show(b.byId("share-map-second-basemap"));
                    this.updateMapSize(this.size)
                },
                onSecondBasemapChange: function(a) { this.updateMapSize(this.size) },
                onThemeChange: function(a) { this.updateMapSize(this.size) },
                onShareMapActivePanelCheck: function(a) {
                    g.byId("share-map-embed-legend").get("checked") && g.byId("share-map-embed-description").get("checked") ? esri.show(b.byId("share-map-active-panel")) : esri.hide(b.byId("share-map-active-panel"));
                    this.updateMapSize(this.size)
                },
                onShareMapActivePanelChange: function(a) { this.updateMapSize(this.size) },
                onMarkerSymbolTitleChange: function(a) { this.updateMapSize(this.size) },
                onMarkerSymbolTitleKeyDown: function(a) { a.keyCode == b.keys.ENTER && (b.stopEvent(a), this.updateMapSize(this.size)) },
                onMarkerSymbolUrlChange: function(a) { this.updateMapSize(this.size) },
                onMarkerSymbolUrlKeyDown: function(a) { a.keyCode == b.keys.ENTER && (b.stopEvent(a), this.updateMapSize(this.size)) },
                onMarkerSymbolDescChange: function(a) { this.updateMapSize(this.size) },
                onMarkerLocationTypeChange: function(a) {
                    g.byId("marker:search").get("checked") ?
                        (esri.hide(b.byId("marker:latlong:input")), esri.show(b.byId("marker:search:input"))) : (esri.hide(b.byId("marker:search:input")), esri.show(b.byId("marker:latlong:input")));
                    this.updateMapSize(this.size)
                },
                onSearchResult: function(a) {
                    a.result && (a = a.result.feature.geometry, a = "polygon" === a.type ? a.getCentroid() : "polyline" === a.type ? a.getPoint(0, 0) : "multipoint" === a.type ? a.getPoint(0) : a, g.byId("latitude:y").set("value", b.number.format(Math.round(1E3 * a.y) / 1E3, this.numberPattern)), g.byId("longitude:x").set("value",
                        b.number.format(Math.round(1E3 * a.x) / 1E3, this.numberPattern)), g.byId("marker:latlong").set("checked", !0), this.updateMapSize(this.size), this._geocoder.clear())
                },
                onSetLocationClick: function(a) { this.updateMapSize(this.size) },
                onShareMapEmbedBack: function(a) {
                    a.preventDefault();
                    g.byId("share-map-dialog").set("title", this.i18n.share);
                    this._stackContainer.selectChild(this._stackAllOptions)
                },
                onShareMapApplicationBack: function(a) {
                    a.preventDefault();
                    g.byId("share-map-dialog").set("title", this.i18n.share);
                    this._stackContainer.selectChild(this._stackAllOptions)
                },
                onShareMapApplicationNext: function(a) {
                    a && a.preventDefault();
                    this._selectedTemplate = this._browseItemsDlg.get("selection");
                    this.content.getItemData(this._selectedTemplate.id, b.hitch(this, function(a) {
                        this._showGalleryTabs(!1);
                        this._selectedTemplate.data = a;
                        this._stackContainer.selectChild(this._stackApplicationPublish)
                    }))
                },
                onShareMapApplicationPublishConfigBack: function(a) {
                    a.preventDefault();
                    this._isPublishing || ("configurableTab" === this._selectedTab ? (this._stackContainer.back(), this._showGalleryTabs(!0)) :
                        this._stackContainer.selectChild(this._stackAllOptions))
                },
                onShareMapApplicationHelpBack: function(a) {
                    a.preventDefault();
                    this._stackContainer.selectChild(this._stackApplicationGallery)
                },
                disable: function(a) { this.currentUser && !this.currentUser.accountId && (b.forEach(g.registry.findWidgets(this._stackAllOptions.domNode), function(b) { b.set("disabled", a) }), b.query("input").forEach(function(c) { b.attr(c, "disabled", a) })) },
                shareWait: function(a) {
                    this.disable(!0);
                    this.waitHandler && clearTimeout(this.waitHandler);
                    this.waitHandler = setTimeout(b.hitch(this, function() {
                        this.waitHandler = null;
                        this.shareOptions.share(a)
                    }), 2E3)
                },
                checkUpdatedSharingStatus: function() {
                    if (!this.currentUser || this.webMapOwner == this.currentUser.email || this.isAdmin) this.shareOptions.isEveryoneChecked() ? this.sharingInfo = { access: "public" } : this.shareOptions.isAccountChecked() ? this.sharingInfo = { access: "org" } : this.shareOptions.isGroupChecked() ? this.sharingInfo = { access: "shared" } : this.sharingInfo = { access: "private" }, this._webAppItemCard.access = this.sharingInfo.access,
                        "private" == this.sharingInfo.access ? b.byId("share-map-text-public-note").innerHTML = this.i18n.mapPrivate : b.byId("share-map-text-public-note").innerHTML = this.i18n.mapShared + "\x3cbr/\x3e\x26nbsp;", this.updateDlgComponents(!0), b.publish("onShareStatusChange", [this.sharingInfo]), (this.currentUser && !this.currentUser.accountId && this.shareOptions.isEveryoneChecked() || this.currentUser && this.currentUser.accountId) && arcgisonline.sharing.utilShare.checkWebMapContent({
                            webMapId: this.webMapId,
                            webMapItemCard: this._webAppItemCard,
                            webMapConfig: arcgisonline.map.storage.buildWebMapText()
                        })
                },
                redirectToAppBuilder: function(a) {
                    a.folderId && "/" !== a.folderId && (a.folder = a.folderId);
                    var c = window.location.protocol + "//" + window.location.host + arcgisonline.sharing.util.getHomeAppContext() + "/apps/webappbuilder/index.html?",
                        d = { title: a.title, tags: a.tags, summary: a.snippet, folder: a.folder, sharewithwebmap: a.shareWithWebMap, webmap: this.webMapId };
                    esriGeowConfig.self.hasCategorySchema && a.categories && a.categories.length && b.mixin(d, { categories: b.json.stringify(a.categories) });
                    c += b.objectToQuery(d);
                    arcgisonline.map.main.goToPage("https:" === window.location.protocol ? arcgisonline.sharing.util.getSecureUrl(c) : arcgisonline.sharing.util.getHttpUrl(c))
                },
                publishWebMap: function(a) {
                    a.preventDefault();
                    var c = this._selectedTemplate;
                    a = this._selectedTab;
                    var d = this._itemPropDlg,
                        f = arcgisonline.sharing.util.getHomeAppContext(),
                        e = b.mixin(this._itemPropDlg.get("item"), { webMapId: this.webMapId, shareWithWebMap: !0 === g.byId("publish-webmap-sharing").get("checked") }),
                        h = b.hitch(this, function(a) {
                            this._itemPropDlg.set("readOnly",
                                a);
                            b.query(".share-map-application-publish-config-back").style("color", a ? "#999" : "#21759B");
                            g.byId("publish-webmap-button").set("disabled", a);
                            g.byId("publish-webmap-button").set("label", a ? this.i18n.savingAndPublishing : this.i18n.savePublishBtn)
                        }),
                        m = b.hitch(this, function(a) {
                            var c = new b.Deferred;
                            if (e.shareWithWebMap) {
                                var d = esriGeowConfig.restBaseUrl + "content/items/" + a.id + "/share",
                                    f = this.shareOptions.isEveryoneChecked(),
                                    g = this.shareOptions.isAccountChecked(),
                                    h = this.shareOptions.getSharedGroups(),
                                    h = b.map(h,
                                        "return item.id;"),
                                    f = { f: "json", everyone: f, org: g, groups: h.join(","), items: [a.id] };
                                arcgisonline.sharing.util.request({ url: d, content: f }, { usePost: !0 }).then(b.hitch(this, function() { c.resolve(a) }))
                            } else c.resolve(a);
                            return c
                        });
                    h(!0);
                    "appBuilderTab" === a ? d._validate().then(b.hitch(this, function(a) { this.redirectToAppBuilder(e) }), b.hitch(this, function(a) {
                        h(!1);
                        this.showError(a)
                    })) : "opDashboardTab" === a ? d.addItem().then(b.hitch(this, function(a) {
                        return m(a).then(b.hitch(this, function(a) {
                            arcgisonline.map.main.goToPage("../../apps/opsdashboard/index.html#/" +
                                a.id + "?mode\x3dedit")
                        }))
                    }), b.hitch(this, function(a) {
                        h(!1);
                        this.showError(a)
                    })) : d._validate().then(b.hitch(this, function(a) {
                        arcgisonline.sharing.util.isPortal() && c.url && 0 === c.url.indexOf("/") && c.url && -1 === c.url.indexOf(f) && (c.url = f + c.url);
                        this.createItemUtil.createTemplatedApplication(e, this._selectedTemplate, d._portal, this.shareOptions).then(b.hitch(this, function(a) { arcgisonline.map.main.goToPage(a.configureUrl) }), b.hitch(this, function(a) {
                            h(!1);
                            this.showError(a)
                        }))
                    }), b.hitch(this, function(a) {
                        h(!1);
                        this.showError(a)
                    }))
                },
                _changeEmbedTab: function(a) {
                    a = a && a.currentTarget && a.currentTarget.id || this._selectedEmbedTab || "advOptionsTab";
                    b.query(".selected", b.byId("embedTabs")).removeClass("selected");
                    b.query("#" + a, b.byId("embedTabs")).addClass("selected");
                    "advOptionsTab" === a ? (esri.hide(b.byId("addMarkerSymbolTab")), esri.show(b.byId("advancedOptionsTab"))) : (esri.hide(b.byId("advancedOptionsTab")), esri.show(b.byId("addMarkerSymbolTab")))
                },
                _changeTab: function(a) {
                    a = a && a.currentTarget && a.currentTarget.id ||
                        this._selectedTab || "configurableTab";
                    b.query(".selected", b.byId("galleryTabs")).removeClass("selected");
                    b.query("#" + a, b.byId("galleryTabs")).addClass("selected");
                    if ("appBuilderTab" === a || "opDashboardTab" === a) {
                        var c = this._getItemProperties();
                        "appBuilderTab" === this._selectedTab ? this._appBuilderSettings = b.mixin({}, c, { typeInfo: "configapp" }) : "opDashboardTab" === this._selectedTab ? this._opDashboardSetings = b.mixin({}, c, { typeInfo: "dashboard_map" }) : this._configureSettings = b.mixin({}, c, { typeInfo: "configapp" });
                        b.attr(this._stackApplicationPublishMsg, "innerHTML", "opDashboardTab" === a ? this.i18n.opDashboardMsg : this.i18n.appBuilderMsg);
                        this._setItemProperties("opDashboardTab" === a ? this._opDashboardSetings || b.mixin({}, c, { typeInfo: "dashboard_map" }) : this._appBuilderSettings || b.mixin({}, c, { typeInfo: "configapp" }));
                        this._lastPane = this._stackContainer.selectedChildWidget !== this._stackAllOptions ? this._stackContainer.selectedChildWidget : null;
                        this._stackContainer.selectChild(this._stackApplicationPublish);
                        this._selectedTab =
                            a;
                        g.byId("publish-webmap-button").set("label", "opDashboardTab" !== a ? this.i18n.getStartedBtn : this.i18n.savePublishBtn);
                        b.query(".configureApp").forEach(esri.hide);
                        b.query(".appBuilder").forEach(esri.show)
                    } else c = this._getItemProperties(), "appBuilderTab" === this._selectedTab ? this._appBuilderSettings = b.mixin({}, c, { typeInfo: "configapp" }) : "opDashboardTab" === this._selectedTab ? this._opDashboardSetings = b.mixin({}, c, { typeInfo: "dashboard_map" }) : this._configureSettings = b.mixin({}, c, { typeInfo: "configapp" }), this._setItemProperties(this._configureSettings ||
                        c), this._stackContainer.selectChild(this._stackApplicationGallery), this._selectedTab = a, g.byId("publish-webmap-button").set("label", this.i18n.savePublishBtn), b.query(".configureApp").forEach(esri.show), b.query(".appBuilder").forEach(esri.hide)
                },
                _showGalleryTabs: function(a) {
                    a ? (a = this._user || (this._user = arcgisonline.sharing.util.getUser())) && (a.accountId || a.orgId) && (esriGeowConfig.webAppBuilderEnabled ? (esri.show(b.byId("galleryTabs")), b.style("appBuilderTab", "display", "")) : esri.hide(b.byId("appBuilderTab")),
                        esriGeowConfig.showCreateDashboard ? (esri.show(b.byId("galleryTabs")), b.style("opDashboardTab", "display", "")) : esri.hide(b.byId("opDashboardTab"))) : (esri.hide(b.byId("galleryTabs")), esri.hide(b.byId("appBuilderTab")), esri.hide(b.byId("opDashboardTab")))
                },
                _getItemProperties: function(a) { return this._itemPropDlg ? b.mixin(this._itemPropDlg.get("item"), { sharing: g.byId("publish-webmap-sharing").get("checked") }) : {} },
                _getGroupNames: function() {
                    var a = [],
                        c = this.userGroups,
                        d = this.shareOptions.getSharedGroups() || [];
                    this.shareOptions.isEveryoneChecked() && a.push(this.i18n.shareOptions.everyonePortal);
                    this.shareOptions.isAccountChecked() && a.push(esriGeowConfig.self && esriGeowConfig.self.name);
                    b.forEach(d, function(d) { b.some(c, function(b) { if (b.id === d.id) return a.push(b.title), !0 }) });
                    return a
                },
                _setItemProperties: function(a) {
                    this._itemPropDlg && (this._itemPropDlg.set("title", a.title), this._itemPropDlg.set("summary", a.snippet), this._itemPropDlg.set("categories", a.categories || []), this._itemPropDlg.set("tags", a.tags || []), this._itemPropDlg.set("title", a.title), this._itemPropDlg.set("typeInfo", a.typeInfo || a.type), this._shareSameLevel.set("checked", a.sharing));
                    (a = this._getGroupNames()) && a.length ? (b.attr("publish-webmap-sharing-label", "innerHTML", this.i18n.shareSameLevel + " (" + this._getGroupNames().join(", ") + ")"), b.style("publish-webmap-sharing-label", "display", ""), g.byId("publish-webmap-sharing").set("checked", !0), b.style(g.byId("publish-webmap-sharing").domNode, "display", "")) : (b.style("publish-webmap-sharing-label",
                        "display", "none"), g.byId("publish-webmap-sharing").set("checked", !1), b.style(g.byId("publish-webmap-sharing").domNode, "display", "none"))
                },
                checkValue: function(a, c) {
                    var d = null;
                    if ("title" === a)
                        if (0 === c.length || c === this.defaultTextTitle) d = { title: this.i18n.errorTitle, message: this.i18n.error.provideTitle };
                        else if (-1 !== b.indexOf(this.allItemNames, c)) d = { title: this.i18n.errorTitle, message: esri.substitute({ type: this._webApp && this._webApp.type || "Web Mapping Application", title: c }, this.i18n.shareErrors.itemExists.message) };
                    else { if (-1 < c.indexOf("\x3c") || -1 < c.indexOf("\x3e")) d = { title: this.i18n.errorTitle, message: this.i18n.error.specialCharaters } } else if ("tags" === a) { if (0 === c.length || c === this.defaultTextTags) d = { title: this.i18n.errorTitle, message: this.i18n.error.provideTitle } } else if ("summary" === a && (0 === c.length || c === this.defaultTextSummary)) return " ";
                    if (!d) return c;
                    this.showError(d);
                    return null
                },
                showError: function(a) {
                    (this._dlg || (this._dlg = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance())).show({
                        title: a.title,
                        message: a.message
                    })
                },
                onFocus: function(a, c) { a.get("value") === c && (a.set("value", ""), b.style(a.domNode, "color", "#000000")) },
                onBlur: function(a, c) { "" === a.get("value") && (a.set("value", c), b.style(a.domNode, "color", "#999999")) },
                onChooseEmbedMap: function(a) {
                    b.attr(b.byId("embed-type-label"), "innerHTML", esri.substitute({ embedType: this.i18n.updates.embedTypeMap }, this.i18n.updates.chooseEmbed));
                    b.style(b.byId("mapOptionsContainer"), "visibility", "visible");
                    g.byId("embedType:map").set("checked", !0);
                    this.updateMapSize(this.size)
                },
                onChooseEmbedPresentation: function(a) {
                    b.attr(b.byId("embed-type-label"), "innerHTML", esri.substitute({ embedType: this.i18n.updates.embedTypePresentation }, this.i18n.updates.chooseEmbed));
                    b.style(b.byId("mapOptionsContainer"), "visibility", "hidden");
                    g.byId("embedType:presentation").set("checked", !0);
                    this.updateMapSize(this.size)
                },
                updateMapSize: function(a) {
                    this.size = a;
                    a = g.byId("mapSize:custom:width").get("value");
                    var c = g.byId("mapSize:custom:height").get("value");
                    isNaN(a) || isNaN(c) ? arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({
                        title: this.i18n.errorTitle,
                        message: this.i18n.invalidWidthHeight
                    }) : b.attr(b.byId("copy-to-clipboard-" + this._copy.id), "value", this.buildEmbedMapHTML(a, c))
                },
                updateLinkType: function(a) {
                    var c = !1;
                    if ("http:" == location.protocol && esriGeowConfig.bitlyUrl && 0 < esriGeowConfig.bitlyUrl.length || "https:" == location.protocol && esriGeowConfig.bitlyUrlSSL && 0 < esriGeowConfig.bitlyUrlSSL.length) c = !0;
                    this.linkType = a;
                    switch (a) {
                        case "presentation":
                            b.style(b.byId("share-map-url-extent-div"), "display", "none");
                            esriGeowConfig.showSocialMediaLinks && c ? (this.shortenedUrl =
                                null, this.useShortenedUrl(this.presentationUrl)) : esriGeowConfig.showSocialMediaLinks && arcgisonline.sharing.util.isPortal() && arcgisonline.sharing.util.canShowSocialMediaLinks() ? this.usePseudoShortenedUrl(this.presentationUrl) : g.byId("share-map-url").set("value", n.html.entities.decode(this.presentationUrl));
                            break;
                        case "map":
                            b.style(b.byId("share-map-url-extent-div"), "display", ""), esriGeowConfig.showSocialMediaLinks && c ? (this.shortenedUrl = null, this.useShortenedUrl(this.viewerUrl)) : esriGeowConfig.showSocialMediaLinks &&
                                arcgisonline.sharing.util.isPortal() && arcgisonline.sharing.util.canShowSocialMediaLinks() ? this.usePseudoShortenedUrl(this.viewerUrl) : g.byId("share-map-url").set("value", n.html.entities.decode(this.viewerUrl))
                    }
                },
                updateLocation: function() {
                    this.updateMapSize(this.size);
                    g.byId("share-map-embed-location").get("checked") ? b.style(b.byId("share-map-location-restrict"), "display", "") : b.style(b.byId("share-map-location-restrict"), "display", "none")
                },
                updateLegend: function() {
                    this.updateMapSize(this.size);
                    g.byId("share-map-embed-legend").get("checked") ?
                        b.style(b.byId("share-map-layer-toggle"), "display", "") : b.style(b.byId("share-map-layer-toggle"), "display", "none")
                },
                updateEmbedHTML: function() { this.updateMapSize(this.size) },
                updatePresentation: function() {
                    g.byId("embedType:presentation").get("checked") ? (b.style(b.byId("share-map-embed-zoom-label"), "color", "#999999"), b.style(b.byId("share-map-embed-home-label"), "color", "#999999"), b.style(b.byId("share-map-embed-scale-label"), "color", "#999999"), b.style(b.byId("share-map-embed-legend-label"), "color", "#999999"),
                        b.style(b.byId("share-map-embed-description-label"), "color", "#999999"), b.style(b.byId("share-map-embed-location-label"), "color", "#999999"), b.style(b.byId("share-map-embed-basemap-label"), "color", "#999999")) : (b.style(b.byId("share-map-embed-zoom-label"), "color", "#000000"), b.style(b.byId("share-map-embed-home-label"), "color", "#000000"), b.style(b.byId("share-map-embed-scale-label"), "color", "#000000"), b.style(b.byId("share-map-embed-legend-label"), "color", "#000000"), b.style(b.byId("share-map-embed-description-label"),
                        "color", "#000000"), b.style(b.byId("share-map-embed-location-label"), "color", "#000000"), b.style(b.byId("share-map-embed-basemap-label"), "color", "#000000"));
                    this.updateMapSize(this.size)
                },
                hide: function() {
                    g.byId("share-map-dialog").hide();
                    this._browseItemsDlg && (this._browseItemsDlg.destroy(), this._browseItemsDlg = null, this._browseItemstopicHandle.remove());
                    9 > b.isIE && this._stackContainer.selectChild(this._stackAllOptions)
                },
                clear: function() {
                    g.byId("share-map-dialog").set("title", this.i18n.share);
                    b.style(b.byId("share-map-make-public"),
                        "display", "none");
                    b.style(b.byId("share-map-not-public"), "display", "none");
                    b.style(b.byId("share-map-is-public"), "display", "block");
                    b.style(b.byId("share-map-premium"), "display", "none");
                    this._setupGeocoder();
                    g.byId("embedType:map").set("checked", !0);
                    b.attr(b.byId("embed-type-label"), "innerHTML", esri.substitute({ embedType: this.i18n.updates.embedTypeMap }, this.i18n.updates.chooseEmbed));
                    b.style(b.byId("mapOptionsContainer"), "visibility", "visible");
                    g.byId("share-map-embed-zoom").set("checked", !0);
                    g.byId("share-map-embed-home").set("checked", !1);
                    g.byId("share-map-embed-basemap").set("checked", !1);
                    g.byId("basemapType:gallery").set("checked", !0);
                    g.byId("share-map-embed-scale").set("checked", !0);
                    g.byId("share-map-embed-location").set("checked", !1);
                    g.byId("share-map-embed-location-restrict").set("checked", !0);
                    g.byId("share-map-embed-description").set("checked", !1);
                    g.byId("share-map-embed-legend").set("checked", !1);
                    g.byId("share-map-embed-layer-toggle").set("checked", !1);
                    g.byId("share-map-embed-disablezoom").set("checked", !0);
                    b.attr(b.byId("share-map-embed-location-restrict-label"),
                        "title", this.i18n.showLocationRestrict);
                    g.byId("basemap:secondBasemap").set("value", this._topoTitle);
                    this.onBasemapSelectorClicked();
                    this.onShareMapActivePanelCheck();
                    g.byId("embedTheme:light").set("checked", !0);
                    g.byId("marker-symbol-title").set("value", "");
                    g.byId("marker-symbol-desc").set("value", "");
                    g.byId("marker-symbol-url").set("value", "");
                    g.byId("marker-symbol-url").set("placeHolder", this.i18n.updates.exampleMarkerUrl);
                    g.byId("marker:search").set("checked", !0);
                    g.byId("latitude:y").set("value",
                        "");
                    g.byId("longitude:x").set("value", "");
                    b.byId("advOptionsTab") && b.byId("addMarkerTab") && (b.addClass(b.byId("advOptionsTab"), "selected"), b.removeClass(b.byId("addMarkerTab"), "selected"), esri.hide(b.byId("addMarkerSymbolTab")), esri.show(b.byId("advancedOptionsTab")));
                    b.style(b.byId("mapPreview:panel"), "display", "none");
                    b.style(b.byId("mapPreview:details"), "display", "none");
                    b.style(b.byId("mapPreview:legend"), "display", "none");
                    b.style(b.byId("mapPreview:gallery"), "display", "none");
                    b.style(b.byId("mapPreview:toggle"),
                        "display", "none");
                    b.style(b.byId("mapPreview:zoom"), "display", "");
                    b.style(b.byId("mapPreview:zoomhome"), "display", "none");
                    b.style(b.byId("mapPreview:search"), "display", "none");
                    b.style(b.byId("mapPreview:scale"), "display", "");
                    b.query(".share-map-application-publish-config-back").forEach(b.hitch(this, function(a) { b.style(a, "color", "#21759B") }));
                    g.byId("publish-webmap-button").set("disabled", !1);
                    g.byId("publish-webmap-button").set("label", this.i18n.savePublishBtn);
                    b.style(b.byId("publish-webmap-waiting"),
                        "display", "none");
                    this.shortenedUrl = null;
                    this._copiedData = !1
                },
                toggleSelect: function(a) {
                    a.preventDefault();
                    b.byId("copy-to-clipboard-" + this._copy.id).select();
                    this._copiedData = !0
                },
                doNothing: function(a) {
                    (!a.metaKey && !a.ctrlKey || "c" !== a.keyChar && "a" !== a.keyChar) && a.preventDefault()
                },
                listenForCopy: function(a) {!a.metaKey && !a.ctrlKey || "c" !== a.keyChar && 67 !== a.keyCode ? a.preventDefault() : this._copiedData = !0 },
                show: function(a, c, d, f, e, g, m, n) {
                    this.hasPresentation = g;
                    this.hasBing = e;
                    this.showPublish = m;
                    this.webMapId =
                        a;
                    this.folderId = d;
                    this.webmapTitle = f;
                    this.webMapOwner = c;
                    this._isPublishing = !1;
                    this.hasRequiresSubscriptionOrCredits = n;
                    arcgisonline.map.role.isAllowed("share_makeWebApp") && !1 !== arcgisonline.map.main.appAccess ? b.style(b.byId("share-map-makeApp-option"), "display", "") : b.style(b.byId("share-map-makeApp-option"), "display", "none");
                    b.byId("share-map-webmapId").innerHTML = this.webMapId;
                    var h = function(a, b) {
                            a = arcgisonline.map.main.extentToString(a[0]);
                            this.show2(a)
                        },
                        p = function(a, b) { this.show2("") },
                        w = arcgisonline.map.main.map.extent;
                    w.spatialReference._isWrappable() ? esri.geometry.normalizeCentralMeridian([w], null, b.hitch(this, function(a) {
                        if (a[0].rings) {
                            var c = (new esri.geometry.Polygon(w.spatialReference)).addRing(a[0].rings[0]).getExtent();
                            a = (new esri.geometry.Polygon(w.spatialReference)).addRing(a[0].rings[1]).getExtent();
                            w = c.getWidth() > a.getWidth() ? c : a
                        } else w = a[0];
                        arcgisonline.map.main.projectExtent(w, new esri.SpatialReference({ wkid: 4326 }), b.hitch(this, h), b.hitch(this, p))
                    })) : arcgisonline.map.main.projectExtent(w, new esri.SpatialReference({ wkid: 4326 }),
                        b.hitch(this, h), b.hitch(this, p))
                },
                show2: function(a) {
                    this._user = arcgisonline.sharing.util.getUser();
                    this._webAppItemCard = b.mixin({}, arcgisonline.map.save_open.webMapItemCard);
                    this.gcsExtStr = a;
                    this._webAppItemCard.owner || (this._webAppItemCard.owner = arcgisonline.map.save_open.webMapInfo.owner, this._webAppItemCard.id = arcgisonline.map.save_open.webMapInfo.id, this._webAppItemCard.title = arcgisonline.map.save_open.webMapInfo.title, this._webAppItemCard.thumbnail = arcgisonline.map.save_open.webMapInfo.thumbnail,
                        this._webAppItemCard.tags = arcgisonline.map.save_open.webMapInfo.tags, this._webAppItemCard.snippet = arcgisonline.map.save_open.webMapInfo.snippet);
                    g.byId("share-map-url-extent").get("checked") ? this.viewerUrl = esriGeowConfig.baseUrl + "webmap/viewer.html?webmap\x3d" + this.webMapId + "\x26amp;extent\x3d" + this.gcsExtStr : this.viewerUrl = esriGeowConfig.baseUrl + "webmap/viewer.html?webmap\x3d" + this.webMapId;
                    this.presentationUrl = window.location.protocol + "//" + window.location.host + arcgisonline.sharing.util.getHomeAppContext() +
                        "/apps/presentation/index.html?webmap\x3d" + this.webMapId;
                    this.embedMapUrl = window.location.protocol + "//" + window.location.host + arcgisonline.sharing.util.getHomeAppContext() + "/apps/Embed/index.html?webmap\x3d" + this.webMapId + "\x26extent\x3d" + a;
                    g.byId("mapSize:custom:width").set("value", "500");
                    g.byId("mapSize:custom:height").set("value", "400");
                    this.hasPresentation ? (b.style(b.byId("linkTypeDiv"), "display", "block"), b.byId("share-map-embed-label").innerHTML = this.i18n.sharePresentation, b.query("div.section.embed-type").style("display",
                        ""), b.style(g.byId("embedType:presentation").domNode.parentNode, "display", ""), b.style(b.byId("embedType:presentation:label").parentNode, "display", "")) : (b.style(b.byId("linkTypeDiv"), "display", "none"), b.byId("share-map-embed-label").innerHTML = this.i18n.shareMap, b.query("div.section.embed-type").style("display", "none"), b.style(g.byId("embedType:presentation").domNode.parentNode, "display", "none"), b.style(b.byId("embedType:presentation:label").parentNode, "display", "none"));
                    this.clear();
                    this._itemPropDlg &&
                        (this._itemPropDlg.set("summary", this._webAppItemCard.snippet), this._itemPropDlg.set("title", this._webAppItemCard.title), this._itemPropDlg.set("categories", this._webAppItemCard.categories || []), this._itemPropDlg.set("tags", this._webAppItemCard.tags || []));
                    this._stackContainer.selectChild(this.showPublish ? this._stackApplicationGallery : this._stackAllOptions);
                    g.byId("share-map-dialog").show();
                    if (null == this.sharingInfo) {
                        var c = function() {
                                this.community.getUserGroups(b.hitch(this, function(a, c) {
                                    this.userGroups =
                                        a.groups;
                                    b.hitch(this, d)()
                                }))
                            },
                            d = function() {
                                var a;
                                if (!this.currentUser || this.webMapOwner != this.currentUser.email && !this.isAdmin) a = function(a, c) {
                                    this.sharingInfo = { access: a.access };
                                    this.currentUser && 0 < this.userGroups.length && (this.shareOptions.showGroups([this.item], this.userGroups), b.byId("share-map-text-public-note").innerHTML = this.i18n.mapShared + "\x3cbr/\x3e\x26nbsp;");
                                    this.updateDlgComponents()
                                }, arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl + "content/items/" + this.webMapId, b.hitch(this,
                                    a));
                                else {
                                    a = function(a, c) {
                                        this.sharingInfo = a.sharing;
                                        "private" == this.sharingInfo.access ? b.byId("share-map-text-public-note").innerHTML = this.i18n.mapPrivate : b.byId("share-map-text-public-note").innerHTML = this.i18n.mapShared + "\x3cbr/\x3e\x26nbsp;";
                                        this.updateDlgComponents();
                                        var d = (a = esriGeowConfig.userRole) && esriGeowConfig.userRole.canUpdateOrgItems(),
                                            e = a && (esriGeowConfig.userRole.canShareItemToGroup() || esriGeowConfig.userRole.canShareItemToOrg() || esriGeowConfig.userRole.canShareItemToPublic()),
                                            f = function() {
                                                (this.isAdmin ||
                                                    d && e) && this.item.owner !== this.currentUser.email ? this.shareOptions.showAdmin([this.item], this.userGroups, this.itemUser, this.adminGroups) : this.currentUser && this.item.owner === this.currentUser.email ? this.shareOptions.show([this.item], this.userGroups, null) : this.currentUser && ("public" === this.item.access || "shared" === this.item.access || "org" === this.item.access && this.currentUser.accountId) ? (this.shareOptions.showGroups([this.item], this.userGroups), b.byId("share-map-text-public-note").innerHTML = this.i18n.mapShared +
                                                    "\x3cbr/\x3e\x26nbsp;") : this.shareOptions.show([this.item], this.userGroups, null);
                                                this.hasRequiresSubscriptionOrCredits && this.displayRequiresSubscriptionOrCredits()
                                            };
                                        this.userGroups ? b.hitch(this, f)() : this.isAdmin ? this.item.owner !== this.currentUser.email ? this.community.getUserGroupsByUser(this.itemUser.username, b.hitch(this, function(a, c) {
                                            this.adminGroups = a.groups;
                                            b.hitch(this, f)()
                                        })) : (this.adminGroups = this.userGroups, b.hitch(this, f)()) : b.hitch(this, f)()
                                    };
                                    var c = esriGeowConfig.restBaseUrl + "content/users/" +
                                        this._webAppItemCard.owner;
                                    this._webAppItemCard.ownerFolder && this._webAppItemCard.ownerFolder.length && "/" != this._webAppItemCard.ownerFolder ? c += "/" + this._webAppItemCard.ownerFolder : this.folderId && this.folderId.length && "/" != this.folderId && (c += "/" + this.folderId);
                                    c += "/items/" + this.webMapId;
                                    arcgisonline.sharing.util.getJson(c, b.hitch(this, a))
                                }
                            };
                        this.currentUser = arcgisonline.sharing.util.getUser();
                        (this.item = this._webAppItemCard) && this.item.ownerFolder && this.item.ownerFolder.length && "/" != this.item.ownerFolder &&
                            (this.item.folderId = this.item.ownerFolder);
                        esri.isDefined(this.folderId) && this.folderId.length && "/" != this.folderId && (this.item.folderId = this.folderId);
                        this.isAdmin = !1;
                        esriGeowConfig.userRole && (esriGeowConfig.userRole.isAdmin() || esriGeowConfig.userRole.isCustom() && esriGeowConfig.userRole.canUpdateOrgItems()) ? (this.isAdmin = !0, this.item.owner !== this.currentUser.email ? this.community.getProfile(this.item.owner, b.hitch(this, b.hitch(this, function(a, d) {
                            this.itemUser = a;
                            this.itemUser.orgId !== this.currentUser.accountId &&
                                (this.isAdmin = !1);
                            b.hitch(this, c)()
                        }))) : (this.itemUser = this.currentUser, b.hitch(this, c)())) : this.currentUser ? (this.itemUser = this.currentUser, b.hitch(this, c)()) : b.hitch(this, d)()
                    } else this.updateDlgComponents(), this.hasRequiresSubscriptionOrCredits && this.displayRequiresSubscriptionOrCredits()
                },
                onEmbedClose: function(a) {
                    if (this._copiedData) this.onClose();
                    else a = {
                        title: this.i18n.updates.discardTitle,
                        message: esri.substitute({ yesLabel: this.i18n.yesLabel, noLabel: this.i18n.cancel }, this.i18n.updates.haventCopied +
                            "\x3cp\x3e" + this.i18n.updates.returnToCopy + "\x3c/p\x3e"),
                        choiceOneTitle: this.i18n.yesLabel,
                        choiceTwoTitle: this.i18n.cancel,
                        choiceOneHandler: b.hitch(this, function() { this.onClose() })
                    }, arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show(a)
                },
                onClose: function(a) {
                    this._configureSettings = this._opDashboardSetings = this._appBuilderSettings = null;
                    this.hide()
                },
                updateDlgComponents: function(a) {
                    esriGeowConfig.showSocialMediaLinks && esriGeowConfig.bitlyUrl && 0 < esriGeowConfig.bitlyUrl.length ?
                        (a = g.byId("linkType:presentation").get("checked"), b.style(b.byId("share-map-url"), "width", "270px"), b.style(b.byId("share-map-url").parentNode, "width", "320px"), this.hasPresentation && "public" == this.sharingInfo.access ? (a || (this.shortenedUrl = null), g.byId("linkType:presentation").set("disabled", !1), b.style(b.byId("linkType:presentation-label"), "color", "#000000"), g.byId("linkType:presentation").set("checked", !0), b.style(b.byId("share-map-url-extent-div"), "display", "none"), this.useShortenedUrl(this.presentationUrl)) :
                            (this.hasPresentation && "public" != this.sharingInfo.access && (a && (this.shortenedUrl = null), g.byId("linkType:presentation").set("disabled", !1), b.style(b.byId("linkType:presentation-label"), "color", "#000000"), g.byId("linkType:map").set("checked", !0), b.style(b.byId("share-map-url-extent-div"), "display", "")), this.useShortenedUrl(this.viewerUrl))) : (b.style(b.byId("share-map-url"), "width", "450px"), b.style(b.byId("share-map-url").parentNode, "width", "470px"), this.hasPresentation && "public" == this.sharingInfo.access ?
                            (g.byId("linkType:presentation").set("disabled", !1), b.style(b.byId("linkType:presentation-label"), "color", "#000000"), g.byId("linkType:presentation").set("checked", !0), b.style(b.byId("share-map-url-extent-div"), "display", "none"), g.byId("share-map-url").set("value", n.html.entities.decode(this.presentationUrl)), esriGeowConfig.showSocialMediaLinks && arcgisonline.sharing.util.isPortal() && arcgisonline.sharing.util.canShowSocialMediaLinks() && this.usePseudoShortenedUrl(this.presentationUrl)) : (this.hasPresentation &&
                                "public" != this.sharingInfo.access && (g.byId("linkType:presentation").set("disabled", !0), b.style(b.byId("linkType:presentation-label"), "color", "#999999"), g.byId("linkType:map").set("checked", !0), b.style(b.byId("share-map-url-extent-div"), "display", "")), g.byId("share-map-url").set("value", n.html.entities.decode(this.viewerUrl)), esriGeowConfig.showSocialMediaLinks && arcgisonline.sharing.util.isPortal() && arcgisonline.sharing.util.canShowSocialMediaLinks() && this.usePseudoShortenedUrl(this.viewerUrl)), g.byId("share-map-url").focus(),
                            b.style(b.byId("socialNetworkLinks"), "display", "none"));
                    a = !0;
                    !esriGeowConfig.userRole || !esriGeowConfig.userRole.isCustom() || esriGeowConfig.userRole.canShareItemToOrg() || esriGeowConfig.userRole.canShareItemToGroup() || esriGeowConfig.userRole.canShareItemToPublic() && esriGeowConfig.self.canSharePublic || (a = !1);
                    g.byId("button-share-map-application").set("disabled", !1);
                    var c = arcgisonline.sharing.util.getUser();
                    "public" == this.sharingInfo.access ? (this.updateMapSize(this.size), b.style(b.byId("share-map-not-public"),
                            "display", "none"), (this.currentUser = arcgisonline.sharing.util.getUser()) && a && (this.userGroups && 0 < this.userGroups.length || this.webMapOwner == this.currentUser.email || this.isAdmin) ? (b.style(b.byId("share-map-make-public"), "display", "block"), b.style(b.byId("share-map-is-public"), "display", "none")) : (b.style(b.byId("share-map-make-public"), "display", "none"), b.style(b.byId("share-map-is-public"), "display", "block")), g.byId("button-share-map-embed").set("disabled", !1), arcgisonline.sharing.util.canShowSocialMediaLinks() &&
                        arcgisonline.map.role.isAllowed("share_socialMediaLinks") && b.style(b.byId("socialNetworkLinks"), "display", "block"), b.style(b.byId("share-map-embed"), "display", "none")) : "shared" == this.sharingInfo.access || "org" == this.sharingInfo.access ? (g.byId("button-share-map-embed").set("disabled", !0), c && (this.webMapOwner == c.email || this.isAdmin) && a ? (b.style(b.byId("share-map-not-public"), "display", "none"), b.style(b.byId("share-map-make-public"), "display", "block"), b.style(b.byId("share-map-is-public"), "display", "none"),
                        b.style(b.byId("share-map-embed"), "display", "block")) : (b.style(b.byId("share-map-not-public"), "display", "block"), b.style(b.byId("share-map-make-public"), "display", "none"), b.style(b.byId("share-map-is-public"), "display", "none")), arcgisonline.sharing.util.canShowSocialMediaLinks() && arcgisonline.map.role.isAllowed("share_socialMediaLinks") && b.style(b.byId("socialNetworkLinks"), "display", "block")) : (g.byId("button-share-map-embed").set("disabled", !0), c && (this.webMapOwner == c.email || this.isAdmin) && a ? (b.style(b.byId("share-map-not-public"),
                        "display", "none"), b.style(b.byId("share-map-make-public"), "display", "block"), b.style(b.byId("share-map-is-public"), "display", "none")) : (b.style(b.byId("share-map-not-public"), "display", "block"), b.style(b.byId("share-map-make-public"), "display", "none"), b.style(b.byId("share-map-is-public"), "display", "block")), b.style(b.byId("socialNetworkLinks"), "display", "none"), b.style(b.byId("share-map-embed"), "display", "none"));
                    esriGeowConfig.self && "private" === esriGeowConfig.self.access && (this._isPrivateOrg = !0);
                    this.isAdmin || arcgisonline.sharing.util.canSharePublic() || (b.style(b.byId("share-map-advanced-label"), "display", "none"), b.style(b.byId("share-map-embed-option"), "display", "none"), b.style(b.byId("share-map-embed"), "display", "none"));
                    this.helpBase = esriGeowConfig && esriGeowConfig.self.helpBase;
                    this.helpMap = esriGeowConfig && esriGeowConfig.self.helpMap && esriGeowConfig.self.helpMap.m
                },
                usePseudoShortenedUrl: function(a) {
                    this.shortenedUrl = a;
                    var c = arcgisonline.sharing.util.socialNetworkTitle(this.webmapTitle);
                    g.byId("share-map-url").set("value", a);
                    g.byId("share-map-url").focus();
                    arcgisonline.sharing.util.canSharePublic() ? (b.byId("facebookLink").href = "http://www.facebook.com/sharer.php?u\x3d" + a + "\x26t\x3d" + c, b.byId("facebookLink2").href = "http://www.facebook.com/sharer.php?u\x3d" + a + "\x26t\x3d" + c, b.byId("twitterLink").href = "http://twitter.com/intent/tweet?url\x3d" + a + "\x26text\x3d" + this.webmapTitle, b.byId("twitterLink2").href = "http://twitter.com/intent/tweet?url\x3d" + a + "\x26text\x3d" + this.webmapTitle) : b.style(b.byId("socialNetworkLinks"),
                        "display", "none")
                },
                useShortenedUrl: function(a) {
                    if (this.shortenedUrl) g.byId("share-map-url").set("value", this.shortenedUrl);
                    else {
                        var c = function(a) {
                                this.shortenedUrl = a;
                                var c = arcgisonline.sharing.util.socialNetworkTitle(this.webmapTitle);
                                g.byId("share-map-url").set("value", a);
                                g.byId("share-map-url").focus();
                                arcgisonline.sharing.util.canSharePublic() ? (b.byId("facebookLink").href = "http://www.facebook.com/sharer.php?u\x3d" + a + "\x26t\x3d" + c, b.byId("facebookLink2").href = "http://www.facebook.com/sharer.php?u\x3d" +
                                    a + "\x26t\x3d" + c, b.byId("twitterLink").href = "http://twitter.com/intent/tweet?url\x3d" + a + "\x26text\x3d" + this.webmapTitle, b.byId("twitterLink2").href = "http://twitter.com/intent/tweet?url\x3d" + a + "\x26text\x3d" + this.webmapTitle) : b.style(b.byId("socialNetworkLinks"), "display", "none")
                            },
                            d = function(c, d) {
                                b.style(b.byId("share-map-url"), "width", "450px");
                                g.byId("share-map-url").set("value", arcgisonline.sharing.util.unescapeHTML(a));
                                g.byId("share-map-url").focus();
                                b.style(b.byId("socialNetworkLinks"), "display",
                                    "none")
                            };
                        if (("public" == this.sharingInfo.access || "shared" == this.sharingInfo.access) && !arcgisonline.sharing.util.isPortal()) {
                            var f = a.indexOf("://"),
                                e = a.indexOf("/", f + 3);
                            a = a.substring(0, f + 3) + arcgisonline.map.main.selfCallResult.portalHostname + a.substring(e)
                        }
                        esriGeowConfig.bitlyUrl ? arcgisonline.sharing.util.shortenUrl(a, b.hitch(this, c), b.hitch(this, d)) : c(a)
                    }
                },
                updateMapUrlExtent: function() {
                    g.byId("share-map-url-extent").get("checked") ? this.viewerUrl = esriGeowConfig.baseUrl + "webmap/viewer.html?webmap\x3d" +
                        this.webMapId + "\x26amp;extent\x3d" + this.gcsExtStr : this.viewerUrl = esriGeowConfig.baseUrl + "webmap/viewer.html?webmap\x3d" + this.webMapId;
                    esriGeowConfig.showSocialMediaLinks && esriGeowConfig.bitlyUrl && 0 < esriGeowConfig.bitlyUrl.length ? (this.shortenedUrl = null, this.useShortenedUrl(this.viewerUrl)) : esriGeowConfig.showSocialMediaLinks && arcgisonline.sharing.util.isPortal() && arcgisonline.sharing.util.canShowSocialMediaLinks() ? this.usePseudoShortenedUrl(this.viewerUrl) : g.byId("share-map-url").set("value", n.html.entities.decode(this.viewerUrl))
                },
                buildEmbedMapHTML: function(a, c) {
                    this._copiedData = !1;
                    var d = '\x3ciframe width\x3d"' + a + '" height\x3d"' + c + '" frameborder\x3d"0" scrolling\x3d"no" marginheight\x3d"0" marginwidth\x3d"0" title\x3d"' + this.webmapTitle + '" src\x3d"',
                        f = g.byId("share-map-embed-zoom").get("checked"),
                        e = g.byId("share-map-embed-home").get("checked"),
                        h = g.byId("share-map-embed-basemap").get("checked"),
                        m = h ? b.attr(g.byId("basemapType:gallery"), "checked") : !1,
                        n = h ? b.attr(g.byId("basemapType:toggle"), "checked") : !1,
                        r = n ? g.byId("basemap:secondBasemap").get("value") :
                        null,
                        v = g.byId("share-map-embed-scale").get("checked"),
                        w = g.byId("share-map-embed-location").get("checked"),
                        t = g.byId("share-map-embed-location-restrict").get("checked"),
                        x = g.byId("share-map-embed-description").get("checked"),
                        B = g.byId("share-map-embed-legend").get("checked"),
                        E = g.byId("share-map-embed-layer-toggle").get("checked"),
                        G = x && B ? g.byId("activePanel").get("value") : null,
                        F = b.attr(g.byId("embedTheme:light"), "checked") ? "light" : "dark",
                        D = g.byId("longitude:x").get("value"),
                        A = g.byId("latitude:y").get("value"),
                        H = g.byId("marker-symbol-title").get("value"),
                        J = g.byId("marker-symbol-desc").get("value"),
                        L = g.byId("marker-symbol-url").get("value"),
                        M = b.attr(g.byId("embedType:presentation"), "checked"),
                        K = g.byId("share-map-embed-largemap").get("checked"),
                        P = g.byId("share-map-embed-disablezoom").get("checked"),
                        O = g.byId("mapSize:responsive").get("checked"),
                        R;
                    if (this.hasPresentation && M) d += this._getProtocolRelativeUrl(this.presentationUrl) + '"\x3e\x3c/iframe\x3e';
                    else {
                        R = this._getProtocolRelativeUrl(this.embedMapUrl);
                        this.hasBing &&
                            (R += "\x26bing\x3dtrue");
                        e && (R += "\x26home\x3dtrue", g.byId("share-map-embed-zoom").set("checked", !0), f = !0);
                        R = R + ("\x26zoom\x3d" + (f ? "true" : "false")) + ("\x26previewImage\x3d" + (this.previewImage ? "true" : "false"));
                        R = v ? R + "\x26scale\x3dtrue" : R + "\x26scale\x3dfalse";
                        w && (R = R + "\x26search\x3dtrue" + ("\x26searchextent\x3d" + (t ? "true" : "false")));
                        x && (R += "\x26details\x3dtrue");
                        B && (R += "\x26legend" + (E ? "layers\x3dtrue" : "\x3dtrue"));
                        x && B && (G = G === this.i18n.updates.mapDetails ? "details" : "legend", R += "\x26active_panel\x3d" + G);
                        if (h)
                            if (m) R += "\x26basemap_gallery\x3dtrue";
                            else if (n) {
                            for (h = 0; h < this._basemaps.length; h++)
                                if (r === this._basemaps[h].name) { r = this._basemaps[h].id; break }
                            R += "\x26basemap_toggle\x3dtrue\x26alt_basemap\x3d" + r
                        }
                        R = (P ? R + "\x26disable_scroll\x3dtrue" : R + "\x26disable_scroll\x3dfalse") + ("\x26theme\x3d" + F);
                        D && A && (r = "\x26marker\x3d" + b.number.parse(D) + ";" + b.number.parse(A) + ";;", J && 0 < J.length && (r += encodeURIComponent(J)), r += ";", L && 0 < L.length && (r += encodeURIComponent(L)), r += ";", H && 0 < H.length && (r += encodeURIComponent(H)),
                            R += r);
                        d += R + '"\x3e\x3c/iframe\x3e';
                        if (K) {
                            H = '\x3csmall\x3e\x3ca href\x3d"';
                            if (this.hasPresentation && M) H += this._getProtocolRelativeUrl(this.presentationUrl);
                            else {
                                var S; - 1 !== R.indexOf("\x26previewImage\x3dfalse") ? S = R.split("\x26previewImage\x3dfalse").join("") : -1 !== R.indexOf("\x26previewImage\x3dtrue") && (S = R.split("\x26previewImage\x3dtrue").join(""));
                                H += S
                            }
                            H += '" style\x3d"color:#0000FF;text-align:left" target\x3d"_blank"\x3e' + this.i18n.viewLargerMap + "\x3c/a\x3e\x3c/small\x3e\x3cbr\x3e";
                            d = H + d
                        }
                        O && (d = esri.substitute({
                            ratioPct: 0 <
                                c ? "" + Math.round(c / a * 100) + "%" : "80%",
                            embeddedFrame: d
                        }, '\x3cstyle\x3e.embed-container {position: relative; padding-bottom: ${ratioPct}; height: 0; max-width: 100%;} .embed-container iframe, .embed-container object, .embed-container iframe{position: absolute; top: 0; left: 0; width: 100%; height: 100%;} small{position: absolute; z-index: 40; bottom: 0; margin-bottom: -15px;}\x3c/style\x3e\x3cdiv class\x3d"embed-container"\x3e${embeddedFrame}\x3c/div\x3e'));
                        x || B ? esriGeowConfig.isRightToLeft ? b.addClass(b.byId("mapPreview:search"),
                            "withPanel") : (b.addClass(b.byId("mapPreview:zoom"), "withPanel"), b.addClass(b.byId("mapPreview:zoomhome"), "withPanel"), b.addClass(b.byId("mapPreview:scale"), "withPanel"), b.addClass(b.byId("mapPreview:gallery"), "withPanel"), b.addClass(b.byId("mapPreview:toggle"), "withPanel")) : esriGeowConfig.isRightToLeft ? b.removeClass(b.byId("mapPreview:search"), "withPanel") : (b.removeClass(b.byId("mapPreview:zoom"), "withPanel"), b.removeClass(b.byId("mapPreview:zoomhome"), "withPanel"), b.removeClass(b.byId("mapPreview:scale"),
                            "withPanel"), b.removeClass(b.byId("mapPreview:gallery"), "withPanel"), b.removeClass(b.byId("mapPreview:toggle"), "withPanel"));
                        b.removeClass(b.byId("mapPreview:gallery"), "withZoom");
                        b.removeClass(b.byId("mapPreview:gallery"), "withZoomHome");
                        e ? b.addClass(b.byId("mapPreview:gallery"), "withZoomHome") : f && b.addClass(b.byId("mapPreview:gallery"), "withZoom");
                        b.style(b.byId("mapPreview:panel"), "display", "none");
                        b.style(b.byId("mapPreview:details"), "display", "none");
                        b.style(b.byId("mapPreview:legend"), "display",
                            "none");
                        x && B ? "details" === G ? b.style(b.byId("mapPreview:details"), "display", "") : b.style(b.byId("mapPreview:legend"), "display", "") : (x || B) && b.style(b.byId("mapPreview:panel"), "display", "");
                        v ? b.style(b.byId("mapPreview:scale"), "display", "") : b.style(b.byId("mapPreview:scale"), "display", "none");
                        w ? b.style(b.byId("mapPreview:search"), "display", "") : b.style(b.byId("mapPreview:search"), "display", "none");
                        b.style(b.byId("mapPreview:zoomhome"), "display", "none");
                        b.style(b.byId("mapPreview:zoom"), "display", "none");
                        e ? b.style(b.byId("mapPreview:zoomhome"), "display", "") : f && b.style(b.byId("mapPreview:zoom"), "display", "");
                        b.style(b.byId("mapPreview:toggle"), "display", "none");
                        b.style(b.byId("mapPreview:gallery"), "display", "none");
                        m ? b.style(b.byId("mapPreview:gallery"), "display", "") : n && b.style(b.byId("mapPreview:toggle"), "display", "")
                    }
                    return d
                },
                displayRequiresSubscriptionOrCredits: function() {
                    if (!esri.isDefined(esriGeowConfig.isMultiTenant) || !1 !== esriGeowConfig.isMultiTenant) {
                        var a = arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance();
                        a.isLoaded() ? b.byId("share-map-premium-link").href = a.getHelpUrl("120001307") : b.connect(a, "onLoad", b.hitch(this, function() { b.byId("share-map-premium-link").href = a.getHelpUrl("120001307") }));
                        b.style(b.byId("share-map-premium"), "display", "block")
                    }
                },
                _getPortalName: function() { return esriGeowConfig.portalName || this.i18n.arcgisCom },
                _getPortalPreviewUrl: function(a, b) {
                    var c = arcgisonline.sharing.util.parseUrl(b);
                    "/" === a.url.substring(0, 1) && -1 < esriGeowConfig.baseUrl.indexOf(c.host) && (b = window.location.protocol +
                        "//" + window.location.host + arcgisonline.sharing.util.getHomeAppContext() + a.url);
                    return b = "https:" === window.location.protocol ? arcgisonline.sharing.util.getSecureUrl(b) : arcgisonline.sharing.util.getHttpUrl(b)
                },
                _getProtocolRelativeUrl: function(a) { var b = a && a.indexOf("://"); return b ? a.substring(b + 1) : a },
                _generateEmbedImage: function() {
                    var a = new esri.tasks.PrintTask(esriGeowConfig.self.helperServices.printTask.url, {}),
                        b = new esri.tasks.PrintTemplate;
                    b.exportOptions = { width: arcgisonline.map.main.map.width, height: arcgisonline.map.main.map.height };
                    b.format = "png32";
                    b.layout = "MAP_ONLY";
                    b.showAttribution = !1;
                    var d = new esri.tasks.PrintParameters;
                    d.map = arcgisonline.map.main.map;
                    d.spatialReference = arcgisonline.map.main.map.spatialReference;
                    d.template = b;
                    a.execute(d, this._processEmbedImage.bind(this), this._saveEmbedFailed.bind(this))
                },
                _processEmbedImage: function(a) {
                    this._saveEmbedImage(a.url, "addResources").then(this._saveEmbedSuccess.bind(this), function(b) {
                        400 === b.code ? this._saveEmbedImage(a.url, "updateResources").then(this._saveEmbedSuccess.bind(this),
                            this._saveEmbedFailed) : this._saveEmbedFailed(b)
                    }.bind(this))
                },
                _saveEmbedImage: function(a, b) { var c = this.item.folderId || this.item.ownerFolder; return esri.request({ url: esriGeowConfig.restBaseUrl + "content/users/" + this.item.owner + "/" + (c ? c + "/" : "") + "items/" + this.item.id + "/" + b, content: { filename: "preview-image.png", url: a, f: "json" } }, { usePost: !0 }) },
                _resetEmbedParams: function() {
                    var a = g.byId("mapSize:custom:width").get("value"),
                        c = g.byId("mapSize:custom:height").get("value");
                    b.attr(b.byId("copy-to-clipboard-" +
                        this._copy.id), "value", this.buildEmbedMapHTML(a, c))
                },
                _saveEmbedFailed: function(a) {
                    this._previewCheckbox.set("value", !1);
                    this._previewCheckbox.set("disabled", !0);
                    b.addClass(this._previewLabel, "label-disabled");
                    b.removeClass(this._previewLabel, "option-loading");
                    b.addClass(this._previewLabel, "option-failed")
                },
                _saveEmbedSuccess: function(a) {
                    this._previewCheckbox.set("disabled", !1);
                    b.removeClass(this._previewLabel, "label-disabled");
                    b.removeClass(this._previewLabel, "option-loading")
                }
            })
        })
}, "arcgisonline/sharing/dijit/TemplatesGrid": function() {
    define(["dojo",
        "dijit", "dojox", "dojo/require!arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/dijit/views,arcgisonline/sharing/util,dojo/mouse"
    ], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.TemplatesGrid");
        b.require("arcgisonline.sharing.geow.Content");
        b.require("arcgisonline.sharing.geow.Community");
        b.require("arcgisonline.sharing.dijit.Gallery");
        b.require("arcgisonline.sharing.dijit.views");
        b.require("arcgisonline.sharing.util");
        b.require("dojo.mouse");
        b.declare("arcgisonline.sharing.dijit.TemplatesGrid", [g._Widget, g._Templated], {
            _gallery: null,
            _galleryPane: null,
            _detailsPane: null,
            _detailsTextPane: null,
            _detailsIconPane: null,
            _detailsTimer: null,
            templatesGroupId: null,
            groupQuery: null,
            galleryNodes: 4,
            _views: arcgisonline.sharing.dijit.views,
            _util: arcgisonline.sharing.util,
            sortField: null,
            sortOrder: null,
            showThumbnail: !0,
            templateString: "\x3cdiv dojoAttachPoint\x3d'containerNode'\x3e\x3c/div\x3e",
            textMenus: [],
            i18n: null,
            onPublish: function() {},
            _getTemplates: function() {
                var a;
                a = ' AND type:"Web Mapping Application"';
                esriGeowConfig.self.user && !esriGeowConfig.self.user.accountId && (a += ' AND -typekeywords:"requiresOrganizationUser"');
                a = { q: "group:" + this.templatesGroupId + a, sortField: this.sortField, num: "50" };
                this.sortOrder && (a.sortOrder = this.sortOrder);
                arcgisonline.sharing.geow.Content.search(esriGeowConfig.restBaseUrl + "search", a, b.hitch(this, this._handleTemplatesResponse), b.hitch(this, this._handleTemplatesResponse))
            },
            refresh: function() { this._getTemplates() },
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").templatesGridWidget)
            },
            postCreate: function() {
                this._gallery = new arcgisonline.sharing.dijit.Gallery({ id: this.id + "_Gallery", nodesPerPage: this.galleryNodes, showNodeLabels: !0, showToolTip: !1, noResultsMessage: "\x3cp class\x3d'esriItemLinks'\x3e\x3cspan\x3e" + this.i18n.noItemsToDisplay + "\x3c/span\x3e\x3c/p\x3e" },
                    b.create("div", null, this.domNode));
                this._user = arcgisonline.sharing.util.getUser();
                var a = this;
                b.mixin(this._gallery, {
                    _buildNodeLayout: function(c, d) {
                        var f = b.create("div", { id: "galleryNode_" + c.id, "class": this.nodeClass, style: "position:relative;" });
                        b.addClass(f, d ? "large" : "small");
                        if (this.showNodeLabels) {
                            d = b.create("div", { "class": "galleryLabelContainer" }, f);
                            var e = c.title || "";
                            b.create("span", { innerHTML: e, alt: e, title: e }, d)
                        }
                        d = void 0 !== esriGeowConfig.isMultiTenant && null !== esriGeowConfig.isMultiTenant && !1 ===
                            esriGeowConfig.isMultiTenant;
                        var g = c.url,
                            g = 0 === g.indexOf("http") || 0 === g.indexOf("//") ? g : window.location.protocol + "//" + window.location.host + g;
                        a && a._user && a._user.accountId ? g = d ? a._getPortalPreviewUrl(c, g) : g.replace("/hosted/", "/apps/") : a && d && (g = a._getPortalPreviewUrl(c, g));
                        var m = c && -1 < b.indexOf(c.typeKeywords, "requiresOrganizationUser"),
                            n = a._user && "account_publisher" !== a._user.role && "account_admin" !== a._user.role;
                        arcgisonline.sharing.util.getGalleryMainLinkInfo(c);
                        d = b.create("a", { href: "JavaScript:void(0);" },
                            f);
                        b.create("img", { "class": this.thumbClass, src: c.thumbnail ? this._getThumbailUrl(c) : arcgisonline.sharing.util.relativeToExplicitUrl("images/transparent.gif") }, d);
                        b.create("br", null, f);
                        var e = b.create("div", { "class": "linksDiv" }, f),
                            e = b.create("div", { "class": "esriItemLinks" }, e),
                            r = b.create("div", { "class": "esriFloatLeading" }, e),
                            v = b.create("a", { style: "text-decoration: none;" }, r);
                        c && b.indexOf(c.typeKeywords, "requiresOrganizationUser") && b.create("span", { innerHTML: this.i18n.publish }, v);
                        b.create("div", { "class": "dijitReset dijitInline esriArrows" },
                            v);
                        r = b.hitch(this, function(d) {
                            var e = [],
                                f = d.relatedItems && 0 < d.relatedItems.length ? d.relatedItems : d,
                                h = b.filter(f, function(a) { return a && null !== a.url });
                            d = h && h.length ? h[0] : f && 0 < f.length ? f[0] : d;
                            (!m || m && !n) && e.push({ label: this.i18n.publish, onClick: b.hitch(a, "onPublish", { template: c }) });
                            d.id && (f = d.url || arcgisonline.sharing.util.getItemDataPath(d), e.push({ label: this.i18n.download, onClick: b.hitch(a, "onDownload", f, d.url ? !0 : !1) }));
                            e.push({
                                label: this.i18n.preview,
                                onClick: b.hitch(arcgisonline.map.mapUtil, "previewTemplate",
                                    g, c.id)
                            });
                            e = new arcgisonline.sharing.dijit.TextMenu({ triggerNode: v, labelNode: v, textMenuItems: e });
                            a.textMenus.push(e)
                        });
                        arcgisonline.sharing.geow.Content.getApplicationCode(c, r);
                        b.create("span", { innerHTML: "\x26nbsp;", style: "width:0;" }, e);
                        e = c.snippet || "";
                        145 < e.length && (e = e.substring(0, 140) + "...");
                        var e = b.create("div", { id: "tooltip" + c.id, className: "templatesGridTooltip", innerHTML: '\x3cp class\x3d"title ellipsis"\x3e' + c.title + "\x3c/p\x3e\x3cp\x3e" + e + "\x3c/p\x3e" }, f, "first"),
                            w = function(a) {
                                (a = b.byId(a)) &&
                                b.style(a, { opacity: 0, display: "none" })
                            },
                            t = function(c, d) {
                                c = b.byId(c);
                                esri.show(c);
                                var e = b.coords(c);
                                d = b.coords(b.byId(d).parentNode);
                                esriGeowConfig.isRightToLeft && e.x + e.l < d.x + d.l ? (b.style(c, "right", "auto"), b.style(c, "left", 10 > b.isIE ? "10px" : "0")) : e.w + e.x > d.w + d.x && (b.style(c, "left", "auto"), b.style(c, "right", 10 > b.isIE ? "10px" : "0"));
                                b.fadeIn({ node: c }).play();
                                b.forEach(a.textMenus, function(a) { a.hide() })
                            };
                        /ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase()) ?
                            b.connect(d, "onclick", function() {
                                var a = b.byId("tooltip" + c.id);
                                a && "block" === b.getStyle(a, "display") ? w("tooltip" + c.id) : t("tooltip" + c.id, "galleryNode_" + c.id);
                                b.query(".templatesGridTooltip").forEach(function(a) { a.id !== "tooltip" + c.id && w(a.id) })
                            }) : (b.connect(d, b.mouse.enter, function() {
                                b.query(".templatesGridTooltip").forEach(function(a) { w(a.id) });
                                t("tooltip" + c.id, "galleryNode_" + c.id)
                            }), b.connect(e, b.mouse.leave, function() { w("tooltip" + c.id) }));
                        return f
                    }
                });
                this._gallery.startup()
            },
            _getPortalPreviewUrl: function(a,
                b) { var c = arcgisonline.sharing.util.parseUrl(b); "/" === a.url.substring(0, 1) && -1 < esriGeowConfig.baseUrl.indexOf(c.host) && (b = window.location.protocol + "//" + window.location.host + arcgisonline.sharing.util.getHomeAppContext() + a.url); return b = "https:" === window.location.protocol ? arcgisonline.sharing.util.getSecureUrl(b) : arcgisonline.sharing.util.getHttpUrl(b) },
            onDownload: function(a, b, d) {
                d.preventDefault();
                b ? window.open(a) : window.location = a;
                g.byId("share-map-stack") && g.byId("share-map-stack").selectChild(g.byId("share-map-application-help"))
            },
            onAbout: function(a, b) {
                b.preventDefault();
                arcgisonline.map.storage.saveMapInCookie(null, !0);
                window.location = a
            },
            _setGroupQueryAttr: function(a) {
                (this.groupQuery = a) && 0 < this.groupQuery.length && arcgisonline.sharing.geow.Community.searchGroups(this.groupQuery, b.hitch(this, this._handleGetGroup), b.hitch(this, this._handleGetGroup))
            },
            _setGroupIdAttr: function(a) { null !== a && 0 !== a.length && (this.pageCount = 0, this.templatesGroupId = a, this._getTemplates()) },
            _handleTemplatesResponse: function(a, c) {
                for (var d = [], f = 0; f < a.results.length; f++) c =
                    a.results[f], c.url && d.push(c);
                b.attr(this._gallery, "items", d)
            },
            _handleGetGroup: function(a, b) {
                this._groupDoesntExist = !1;
                a && 1 == a.total ? (this.templatesGroupId = a.results[0].id, a.results[0].sortField && (this.sortField = a.results[0].sortField), a.results[0].sortOrder && (this.sortOrder = a.results[0].sortOrder), this._setGroupIdAttr(a.results[0].id)) : a && 1 < a.total || (this._groupDoesntExist = !0)
            },
            nextPage: function() { this._gallery.nextPage() },
            prevPage: function() { this._gallery.prevPage() }
        })
    })
}, "dijit/form/Textarea": function() {
    define(["dojo/_base/declare",
        "dojo/dom-style", "./_ExpandingTextAreaMixin", "./SimpleTextarea"
    ], function(b, g, n, a) {
        return b("dijit.form.Textarea", [a, n], {
            baseClass: "dijitTextBox dijitTextArea dijitExpandingTextArea",
            cols: "",
            buildRendering: function() {
                this.inherited(arguments);
                g.set(this.textbox, { overflowY: "hidden", overflowX: "auto", boxSizing: "border-box", MsBoxSizing: "border-box", WebkitBoxSizing: "border-box", MozBoxSizing: "border-box" })
            }
        })
    })
}, "dijit/form/_ExpandingTextAreaMixin": function() {
    define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),
        function(b, g, n, a, c, d, f) {
            n.add("textarea-needs-help-shrinking", function() {
                var a = d.body(),
                    b = g.create("textarea", { rows: "5", cols: "20", value: " ", style: { zoom: 1, fontSize: "12px", height: "96px", overflow: "hidden", visibility: "hidden", position: "absolute", border: "5px solid white", margin: "0", padding: "0", boxSizing: "border-box", MsBoxSizing: "border-box", WebkitBoxSizing: "border-box", MozBoxSizing: "border-box" } }, a, "last"),
                    c = b.scrollHeight >= b.clientHeight;
                a.removeChild(b);
                return c
            });
            return b("dijit.form._ExpandingTextAreaMixin",
                null, {
                    _setValueAttr: function() {
                        this.inherited(arguments);
                        this.resize()
                    },
                    postCreate: function() {
                        this.inherited(arguments);
                        var b = this.textbox;
                        b.style.overflowY = "hidden";
                        this.own(c(b, "focus, resize", a.hitch(this, "_resizeLater")))
                    },
                    startup: function() {
                        this.inherited(arguments);
                        this.own(f.on("resize", a.hitch(this, "_resizeLater")));
                        this._resizeLater()
                    },
                    _onInput: function(a) {
                        this.inherited(arguments);
                        this.resize()
                    },
                    _estimateHeight: function() {
                        var a = this.textbox;
                        a.rows = (a.value.match(/\n/g) || []).length + 1
                    },
                    _resizeLater: function() { this.defer("resize") },
                    resize: function() {
                        function a() {
                            var a = !1;
                            "" === b.value && (b.value = " ", a = !0);
                            var c = b.scrollHeight;
                            a && (b.value = "");
                            return c
                        }
                        var b = this.textbox;
                        "hidden" == b.style.overflowY && (b.scrollTop = 0);
                        if (!this.busyResizing) {
                            this.busyResizing = !0;
                            if (a() || b.offsetHeight) {
                                var c = a() + Math.max(b.offsetHeight - b.clientHeight, 0),
                                    d = c + "px";
                                d != b.style.height && (b.style.height = d, b.rows = 1);
                                if (n("textarea-needs-help-shrinking")) {
                                    var f = a(),
                                        g = b.style.minHeight,
                                        w = 4,
                                        t = b.scrollTop;
                                    b.style.minHeight = d;
                                    for (b.style.height = "auto"; 0 < c;) {
                                        b.style.minHeight =
                                            Math.max(c - w, 4) + "px";
                                        d = a();
                                        f -= d;
                                        c -= f;
                                        if (f < w) break;
                                        f = d;
                                        w <<= 1
                                    }
                                    b.style.height = c + "px";
                                    b.style.minHeight = g;
                                    b.scrollTop = t
                                }
                                b.style.overflowY = a() > b.clientHeight ? "auto" : "hidden";
                                "hidden" == b.style.overflowY && (b.scrollTop = 0)
                            } else this._estimateHeight();
                            this.busyResizing = !1
                        }
                    }
                })
        })
}, "arcgisonline/sharing/dijit/ShareOptions": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/form/Textarea,dijit/form/CheckBox,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/dialog/SimpleDlg,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Community,arcgisonline/sharing/geow/Content,arcgisonline/sharing/util,arcgisonline/pages/pageUtil,dojo/promise/all"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.ShareOptions");
            b.require("dijit.form.Textarea");
            b.require("dijit.form.CheckBox");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("arcgisonline.sharing.dijit.dialog.SimpleDlg");
            b.require("arcgisonline.sharing.geow.Account");
            b.require("arcgisonline.sharing.geow.Community");
            b.require("arcgisonline.sharing.geow.Content");
            b.require("arcgisonline.sharing.util");
            b.require("arcgisonline.pages.pageUtil");
            b.require("dojo.promise.all");
            b.declare("arcgisonline.sharing.dijit.ShareOptions", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv style\x3d"line-height:25px; padding-left:15px; padding-top:5px;" class\x3d"share-wrapper"\x3e\r\n  \x3cdiv id\x3d"share-loading"\x3e\r\n    \x3clabel\x3e${i18n.loadinglabel}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"share-everyone-check_div"\x3e\r\n    \x3cinput id\x3d"share-everyone-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"\x3e\r\n    \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"inline-block"\x3e\r\n      ${i18n.everyone}\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"share-account-check_div" style\x3d"display:none;"\x3e\r\n    \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"inline-block"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"share-groups-div" style\x3d"display:none;"\x3e\r\n    \x3cinput id\x3d"share-groups-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"\x3e\r\n    \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"inline-block"\x3e\r\n      ${i18n.theseGroups}\r\n    \x3c/label\x3e\r\n    \x3cdiv style\x3d"padding-left:20px; padding-top:5px;" class\x3d"share-groups-wrapper"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" data-dojo-props\x3d"gutters:false,design:\'headline\'" style\x3d"width:95%; height:115px;"\x3e\r\n        \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region:\'middle\',splitter:false"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                community: arcgisonline.sharing.geow.Community,
                util: arcgisonline.sharing.util,
                userGroups: null,
                sortField: null,
                user: null,
                items: null,
                itemsAreSharedToGroups: "",
                itemUser: null,
                organization: null,
                itemUsername: null,
                adminGroups: null,
                lowestAccess: 3,
                isMultiTenant: !0,
                shareConnect: null,
                shareType: "item",
                i18n: null,
                _checkboxImgUrl: null,
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline",
                        "arcgisonline").shareOptions);
                    this._checkboxImgUrl = this.util.relativeToExplicitUrl("images/checkbox.gif");
                    this._canShareWithEveryone = !0
                },
                postCreate: function() {
                    this.checkTenantType();
                    this.loadConnections()
                },
                checkTenantType: function() { this.isMultiTenant = void 0 === esriGeowConfig.isMultiTenant || !0 === esriGeowConfig.isMultiTenant },
                loadConnections: function() {
                    b.subscribe("shareOptionsSetup", function() { b.style(b.byId("share-loading"), "display", "none") });
                    b.subscribe("onClickEveryone", b.hitch(this, this.updateHelpMsg))
                },
                share: function(a) { "group" === this.shareType ? this.shareItemToGroups() : "admin" === this.shareType ? this.shareItemAsAdmin(a) : this.shareItem(a) },
                _setRoleFlags: function() {
                    this._roleCanShareToGroup = (this._isCustomRole = esriGeowConfig.userRole) && esriGeowConfig.userRole.canShareItemToGroup();
                    this._roleCanShareToOrg = this._isCustomRole && esriGeowConfig.userRole.canShareItemToOrg();
                    this._roleCanSharePublic = this._isCustomRole && esriGeowConfig.userRole.canShareItemToPublic();
                    this._roleCanShareOthersItemsToGroup = this._isCustomRole &&
                        esriGeowConfig.userRole.canShareOthersItemsToGroup();
                    this._roleCanShareOthersItemsToOrg = this._isCustomRole && esriGeowConfig.userRole.canShareOthersItemsToOrg();
                    this._roleCanShareOthersItemsToPublic = this._isCustomRole && esriGeowConfig.userRole.canShareOthersItemsToPublic();
                    this._orgUserCanSharePublicOrOverride = this.organization && (!0 === this.organization.canSharePublic && (!this._isCustomRole || this._roleCanSharePublic || this._roleCanShareOthersItemsToPublic) || esriGeowConfig.userRole.isAdmin())
                },
                checkForAccount: function(a) {
                    (this.user =
                        this.util.getUser()) && this.user.accountId && "" !== this.user.accountId && !this.organization ? arcgisonline.sharing.geow.Account.getSelf(b.hitch(this, function(c) {
                        !c || c.code || c.message ? b.style(b.byId("share-account-check_div"), "display", "none") : (this.organization = c, this._setRoleFlags(), b.byId("share-account-check-label").appendChild(document.createTextNode(this.organization.name)), this.isMultiTenant || b.attr(b.byId("share-everyone-check-label"), "innerHTML", this.i18n.everyonePortal), !this._isCustomRole || this._roleCanShareToOrg ||
                            this._roleCanShareOthersItemsToOrg || b.style(b.byId("share-account-check_div"), "display", "none"));
                        a && a()
                    })) : (b.style(b.byId("share-account-check_div"), "display", "none"), a && a())
                },
                clear: function() {
                    b.byId("share-groups-list").innerHTML = "";
                    g.byId("share-everyone-check").set("value", !1);
                    g.byId("share-account-check").set("value", !1);
                    g.byId("share-groups-check").set("value", !1);
                    b.style(b.byId("share-everyone-check_div"), "display", "none");
                    b.style(b.byId("share-account-check_div"), "display", "none");
                    b.disconnect(this.shareConnect);
                    this.shareType = "item"
                },
                filterOwnedGroups: function(a) { if (a) { for (var b = [], d, f = 0; f < a.length; f++) d = a[f], !d.userMembership || "owner" !== d.userMembership.memberType && "admin" !== d.userMembership.memberType || d.capabilities && d.capabilities.length || b.push(d); return b } return null },
                showGroups: function(a, c) {
                    this.items = a;
                    this.sortField = "title";
                    (this.userGroups = this.filterOwnedGroups(c)) && this.userGroups.sort(b.hitch(this, "_sortFunc"));
                    this.clear();
                    this.shareType = "group";
                    a = function(a, b) {
                        var c = [];
                        if (b.admin)
                            for (var d =
                                    0; d < b.admin.length; d++) c.push(b.admin[d].id);
                        a.sharing = { groups: c }
                    };
                    for (c = 0; c < this.items.length; c++) {
                        var d = this.items[c];
                        d.sharing = null;
                        this.util.getJson(esriGeowConfig.restBaseUrl + "content/items/" + d.id + "/groups", b.hitch(this, a, d))
                    }
                    setTimeout(b.hitch(this, "buildGroupList", 0), 100)
                },
                filterAdminGroups: function(a) {
                    if (a) {
                        for (var c = [], d = 0; d < this.userGroups.length; d++) c.push(this.userGroups[d].id);
                        for (var f = [], d = 0; d < a.length; d++) - 1 !== b.indexOf(c, a[d].id) || a[d].capabilities && a[d].capabilities.length || f.push(a[d]);
                        return f
                    }
                    return null
                },
                findLowestAccessLevel: function() { this.lowestAccess = 3; for (var a, b, d = 0; d < this.items.length; d++)(b = this.items[d].access) || (b = "private"), 1 === b.length && (b = b[0]), "public" === b ? a = 3 : "org" === b ? a = 2 : "shared" === b ? a = 1 : "private" === b && (a = 0), a < this.lowestAccess && (this.lowestAccess = a) },
                showAdmin: function(a, c, d, f) {
                    b.promise.all({ hasEditableLayer: this.hasEditableLayer(a), canShareWithEveryone: this.canShareWithEveryone(a), hasPremiumContent: this.hasPremiumContent(a) }).then(b.hitch(this, function(e) {
                        this._hasEditableLayer =
                            e.hasEditableLayer;
                        this._hasPremiumContent = e.hasPremiumContent;
                        this._canShareWithEveryone = e.canShareWithEveryone;
                        this.items = a;
                        this.itemUser = d;
                        this.sortField = "title";
                        this.userGroups = b.filter(c || [], "return (!item.capabilities || !item.capabilities.length);");
                        this.userGroups.sort(b.hitch(this, "_sortFunc"));
                        this.adminGroups = this.filterAdminGroups(f);
                        this.checkForAccount(b.hitch(this, function() {
                            this.clear();
                            this.findLowestAccessLevel();
                            this.shareType = "admin";
                            for (var a = function(a, b) { a.sharing = b.sharing },
                                    c = 0; c < this.items.length; c++) {
                                var d = this.items[c];
                                d.sharing = null;
                                var e = esriGeowConfig.restBaseUrl + "content/users/" + d.owner || (this.itemUser ? this.itemUser.username ? this.itemUser.username : this.itemUser.email : this.user.email);
                                if (esri.isDefined(d.folderId) && "/" !== d.folderId || esri.isDefined(d.ownerFolder) && "/" !== d.ownerFolder) e += "/" + (d.folderId || d.ownerFolder);
                                e += "/items/" + d.id;
                                this.util.getJson(e, b.hitch(this, a, d))
                            }
                            setTimeout(b.hitch(this, "buildAdminList", 0), 100)
                        }))
                    }))
                },
                filterViewOnlyGroups: function(a) {
                    if (a) {
                        for (var b = [], d, f = 0; f < a.length; f++) d = a[f], d.capabilities && d.capabilities.length || (!d.userMembership || "owner" !== d.userMembership.memberType && "admin" !== d.userMembership.memberType) && esri.isDefined(d.isViewOnly) && d.isViewOnly || b.push(d);
                        return b
                    }
                    return null
                },
                show: function(a, c, d) {
                    b.promise.all({ hasEditableLayer: this.hasEditableLayer(a), canShareWithEveryone: this.canShareWithEveryone(a), hasPremiumContent: this.hasPremiumContent(a) }).then(b.hitch(this, function(f) {
                        this._hasEditableLayer = f.hasEditableLayer;
                        this._canShareWithEveryone =
                            f.canShareWithEveryone;
                        this._hasPremiumContent = f.hasPremiumContent;
                        this.items = a;
                        d && null !== d && (this.itemUser = d);
                        this.userGroups = this.filterViewOnlyGroups(c);
                        this.sortField = "title";
                        esri.isDefined(this.userGroups) && this.userGroups.sort(b.hitch(this, "_sortFunc"));
                        this.checkForAccount(b.hitch(this, function() {
                            this.clear();
                            this.shareType = "item";
                            for (var a = 0; a < this.items.length; a++) {
                                var c = this.items[a];
                                c.sharing = null;
                                var d = this.util.getUser(),
                                    f = esriGeowConfig.restBaseUrl + "content/users/",
                                    f = this.itemUser &&
                                    null !== this.itemUser ? this.itemUser.username ? f + this.itemUser.username : f + this.itemUser.email : f + d.email;
                                if (esri.isDefined(c.folderId) && "/" !== c.folderId || esri.isDefined(c.ownerFolder) && "/" !== c.ownerFolder) f += "/" + (c.folderId || c.ownerFolder);
                                f += "/items/" + c.id;
                                this.util.getJson(f, b.hitch(this, function(a, b) { a.sharing = b.sharing }, c))
                            }
                            setTimeout(b.hitch(this, "buildList", 0), 100)
                        }))
                    }))
                },
                buildGroupList: function(a) {
                    var c, d;
                    for (c = 0; c < this.items.length; c++)
                        if (!this.items[c].sharing && 20 > a) {
                            a += 1;
                            setTimeout(b.hitch(this,
                                "buildGroupList", a), 100);
                            return
                        }!this._isCustomRole || this._roleCanShareToGroup || this._roleCanShareOthersItemsToGroup ? 0 < this.userGroups.length ? b.style(b.byId("share-groups-div"), "display", "block") : b.publish("doesNotOwnGroups") : b.style(b.byId("share-groups-div"), "display", "none");
                    this.itemsAreSharedToGroups = ",";
                    a = [];
                    for (c = 0; c < this.items.length; c++) {
                        var f = this.items[c];
                        if (f.sharing)
                            for (var e = 0; e < f.sharing.groups.length; e++) {
                                var h = f.sharing.groups[e];
                                if (-1 === this.itemsAreSharedToGroups.indexOf("," + h +
                                        ",")) this.itemsAreSharedToGroups += h + ",", d = [], d[0] = h, d[1] = 1, a[a.length] = d;
                                else
                                    for (d = 0; d < a.length; d++)
                                        if (a[d][0] === h) { a[d][1] += 1; break }
                            }
                    }
                    var f = "",
                        e = !1,
                        m, n;
                    for (c = 0; c < this.userGroups.length; c++) {
                        h = this.userGroups[c];
                        m = "";
                        n = this.items.length;
                        if (-1 < this.itemsAreSharedToGroups.indexOf("," + h.id + ","))
                            for (m = "checked", e = !0, d = 0; d < a.length; d++)
                                if (a[d][0] === h.id) { n = a[d][1]; break }
                        f = n < this.items.length ? f + ('\x3cdiv id\x3d"img_group_' + c + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cimg id\x3d\"img_group_" +
                            c + '" src\x3d"' + this._checkboxImgUrl + '" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e' + h.title + '\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_' + c + "_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + c + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'' + h.id +
                            "'\x3e" + h.title + "\x3c/label\x3e") : f + ('\x3cdiv id\x3d"group_' + c + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + c + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' + c + "'\x3e" + h.title + "\x3c/label\x3e");
                        h.isOpenData && !this.util.isPortal() &&
                            (f += " " + this.i18n.openData);
                        f += "\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"
                    }
                    b.connect(b.byId("share-groups-list"), "onclick", this, "checkGroup");
                    b.byId("share-groups-list").innerHTML = f;
                    e ? g.byId("share-groups-check").set("checked", !0) : g.byId("share-groups-check").set("checked", !1);
                    b.connect(g.byId("share-groups-check"), "onclick", this, "checkGroups");
                    b.publish("shareOptionsSetup")
                },
                buildAdminList: function(a) {
                    var c, d;
                    for (c = 0; c < this.items.length; c++)
                        if (!this.items[c].sharing && 20 > a) {
                            a += 1;
                            setTimeout(b.hitch(this,
                                "buildAdminList", a), 100);
                            return
                        }
                    if (this.userGroups && 0 < this.userGroups.length || this.adminGroups && 0 < this.adminGroups.length && 1 < this.lowestAccess) !this._isCustomRole || this._roleCanShareToGroup || this._roleCanShareOthersItemsToGroup ? b.style(b.byId("share-groups-div"), "display", "block") : b.style(b.byId("share-groups-div"), "display", "none");
                    this.itemsAreSharedToGroups = ",";
                    a = [];
                    for (c = 0; c < this.items.length; c++) {
                        var f = this.items[c];
                        if (f.sharing)
                            for (var e = 0; e < f.sharing.groups.length; e++) {
                                var h = f.sharing.groups[e];
                                if (-1 === this.itemsAreSharedToGroups.indexOf("," + h + ",")) this.itemsAreSharedToGroups += h + ",", d = [], d[0] = h, d[1] = 1, a[a.length] = d;
                                else
                                    for (d = 0; d < a.length; d++)
                                        if (a[d][0] === h) { a[d][1] += 1; break }
                            }
                    }
                    var e = "",
                        f = !1,
                        m, n;
                    for (c = 0; c < this.userGroups.length; c++) {
                        h = this.userGroups[c];
                        m = "";
                        n = this.items.length;
                        if (-1 < this.itemsAreSharedToGroups.indexOf("," + h.id + ","))
                            for (m = "checked", f = !0, d = 0; d < a.length; d++)
                                if (a[d][0] === h.id) { n = a[d][1]; break }
                        e = n < this.items.length ? e + ('\x3cdiv id\x3d"img_group_' + c + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cimg id\x3d\"img_group_" +
                            c + '" src\x3d"' + this._checkboxImgUrl + '" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e' + h.title + '\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_' + c + "_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + c + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' +
                            c + "'\x3e" + h.title + "\x3c/label\x3e") : e + ('\x3cdiv id\x3d"group_' + c + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + c + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' + c + "'\x3e" + h.title + "\x3c/label\x3e");
                        h.isOpenData && !this.util.isPortal() &&
                            (e += " " + this.i18n.openData);
                        e += "\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"
                    }
                    if (this.adminGroups && this.adminGroups.length && 1 < this.lowestAccess)
                        for (e += '\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e', d = 0; d < this.adminGroups.length; d++) {
                            h = this.adminGroups[d];
                            m = "";
                            n = this.items.length;
                            if (-1 < this.itemsAreSharedToGroups.indexOf("," + h.id + ",")) {
                                m = "checked";
                                for (var f = !0, r = 0; r < a.length; r++)
                                    if (a[r][0] === h.id) { n = a[r][1]; break }
                            }
                            e = n < this.items.length ? e + ('\x3cdiv id\x3d"img_group_' + (d + c) + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cimg id\x3d\"img_group_" +
                                (d + c) + '" src\x3d"' + this._checkboxImgUrl + '" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e' + h.title + '\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_' + (d + c) + "_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + (d + c) + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' +
                                c + "'\x3e" + h.title + "\x3c/label\x3e") : e + ('\x3cdiv id\x3d"group_' + (d + c) + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + (d + c) + '" ' + m + ' value\x3d"' + h.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' + c + "'\x3e" + h.title + "\x3c/label\x3e");
                            h.isOpenData && !this.util.isPortal() &&
                                (e += " " + this.i18n.openData);
                            e += "\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"
                        }
                    b.connect(b.byId("share-groups-list"), "onclick", this, "checkGroup");
                    b.byId("share-groups-list").innerHTML = e;
                    if (this.organization) {
                        for (c = a = 0; c < this.items.length; c++) this.items[c].sharing && "org" === this.items[c].sharing.access && a++;
                        !this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg ? (0 === a ? (g.byId("share-account-check").set("checked", !1), g.byId("share-account-check").set("readOnly", !1)) : a ===
                            this.items.length ? (g.byId("share-account-check").set("checked", !0), g.byId("share-account-check").set("readOnly", !1)) : (g.byId("share-account-check").set("checked", !0), g.byId("share-account-check").set("readOnly", !0)), b.style(b.byId("share-account-check_div"), "display", "block")) : (g.byId("share-account-check").set("readOnly", !0), b.style(b.byId("share-account-check_div"), "display", "none"))
                    }
                    if (!this._canShareWithEveryone || this.organization && !this._orgUserCanSharePublicOrOverride) g.byId("share-everyone-check").set("checked", !1), b.style(b.byId("share-everyone-check_div"), "display", "none");
                    else {
                        for (c = a = 0; c < this.items.length; c++) this.items[c].sharing && "public" === this.items[c].sharing.access && a++;
                        0 === a ? (g.byId("share-everyone-check").set("checked", !1), b.style(b.byId("share-everyone-check_div"), "display", "block"), g.byId("share-account-check").set("readOnly", !1)) : (g.byId("share-everyone-check").set("checked", !0), b.style(b.byId("share-everyone-check_div"), "display", "block"), this.organization && (!this._isCustomRole || this._roleCanShareToOrg ||
                            this._roleCanShareOthersItemsToOrg) && (g.byId("share-account-check").set("checked", !0), g.byId("share-account-check").set("readOnly", g.byId("share-everyone-check").get("checked"))), g.byId("share-account-check").set("readOnly", !0));
                        b.connect(g.byId("share-everyone-check"), "onClick", b.hitch(this, "clickEveryone"))
                    }
                    f ? g.byId("share-groups-check").set("checked", !0) : g.byId("share-groups-check").set("checked", !1);
                    b.connect(b.byId("share-groups-check"), "onclick", this, "checkGroups");
                    this.organization && (!this._isCustomRole ||
                        this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg) && b.connect(g.byId("share-account-check"), "onClick", b.hitch(this, "clickAccount"));
                    b.publish("shareOptionsSetup")
                },
                buildList: function(a) {
                    var c, d;
                    for (c = 0; c < this.items.length; c++)
                        if (!this.items[c].sharing && 20 > a) {
                            a += 1;
                            setTimeout(b.hitch(this, "buildList", a), 100);
                            return
                        }!this._isCustomRole || this._roleCanShareToGroup || this._roleCanShareOthersItemsToGroup ? this.userGroups && 0 < this.userGroups.length ? b.style(b.byId("share-groups-div"), "display", "block") :
                        b.publish("notMemberOfAnyGroups") : b.style(b.byId("share-groups-div"), "display", "none");
                    this.itemsAreSharedToGroups = ",";
                    a = [];
                    for (c = 0; c < this.items.length; c++) {
                        var f = this.items[c];
                        if (f.sharing)
                            for (var e = 0; e < f.sharing.groups.length; e++) {
                                var h = f.sharing.groups[e];
                                if (-1 === this.itemsAreSharedToGroups.indexOf("," + h + ",")) this.itemsAreSharedToGroups += h + ",", d = [], d[0] = h, d[1] = 1, a[a.length] = d;
                                else
                                    for (d = 0; d < a.length; d++)
                                        if (a[d][0] === h) { a[d][1] += 1; break }
                            }
                    }
                    e = "";
                    f = !1;
                    h = [];
                    for (c = 0; c < this.userGroups.length; c++) {
                        var m =
                            this.userGroups[c],
                            n = "",
                            r = this.items.length;
                        if (-1 < this.itemsAreSharedToGroups.indexOf("," + m.id + ","))
                            for (n = "checked", f = !0, d = 0; d < a.length; d++)
                                if (a[d][0] === m.id) { r = a[d][1]; break }
                        f && r < this.items.length && h.push(c);
                        e += '\x3cdiv id\x3d"group_' + c + "_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'top'\x3e\x3cinput id\x3d\"group_" + c + '" ' + n + ' value\x3d"' + m.id + '" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_' +
                            c + "'\x3e" + m.title + "\x3c/label\x3e";
                        m.isOpenData && !this.util.isPortal() && (e += " " + this.i18n.openData);
                        e += "\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"
                    }
                    b.connect(b.byId("share-groups-list"), "onclick", this, "checkGroup");
                    b.byId("share-groups-list").innerHTML = e;
                    h.forEach(function(a) { if (a = b.byId("share-groups-list").querySelector("#group_" + a)) a.indeterminate = !0 });
                    if (this.organization && esriGeowConfig.userRole && (!this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg)) {
                        for (c =
                            a = 0; c < this.items.length; c++) this.items[c].sharing && "org" === this.items[c].sharing.access && a++;
                        0 === a ? g.byId("share-account-check").set("checked", !1) : g.byId("share-account-check").set("checked", !0);
                        b.style(b.byId("share-account-check_div"), "display", "block")
                    }
                    for (c = a = 0; c < this.items.length; c++) this.items[c].sharing && "public" === this.items[c].sharing.access && a++;
                    !this._canShareWithEveryone || this.organization && !this._orgUserCanSharePublicOrOverride ? this.organization && !this.organization.canSharePublic ? a ? (g.byId("share-everyone-check").set("checked", !0), this.organization && esriGeowConfig.userRole && (!this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg) && (g.byId("share-account-check").set("checked", !0), b.style(b.byId("share-account-check_div"), "display", "block")), g.byId("share-account-check").set("readOnly", !0)) : (g.byId("share-everyone-check").set("checked", !1), b.style(b.byId("share-everyone-check_div"), "display", "none"), g.byId("share-account-check").set("readOnly", !1)) : (g.byId("share-everyone-check").set("checked", !1),
                        b.style(b.byId("share-everyone-check_div"), "display", "none"), a && (!this._canShareWithEveryone || this.organization && !this._orgUserCanSharePublicOrOverride) ? (g.byId("share-account-check").set("checked", !0), g.byId("share-account-check").set("readOnly", !0)) : g.byId("share-account-check").set("readOnly", !1)) : (0 === a ? (g.byId("share-everyone-check").set("checked", !1), b.style(b.byId("share-everyone-check_div"), "display", "block"), g.byId("share-account-check").set("readOnly", !1)) : (g.byId("share-everyone-check").set("checked", !0), b.style(b.byId("share-everyone-check_div"), "display", "block"), this.organization && esriGeowConfig.userRole && (!this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg) && (g.byId("share-account-check").set("checked", !0), b.style(b.byId("share-everyone-check_div"), "display", "block")), g.byId("share-account-check").set("readOnly", !0)), b.connect(g.byId("share-everyone-check"), "onClick", b.hitch(this, "clickEveryone")));
                    f ? g.byId("share-groups-check").set("checked", !0) : g.byId("share-groups-check").set("checked", !1);
                    b.connect(b.byId("share-groups-check"), "onclick", this, "checkGroups");
                    this.organization && (!this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg) && b.connect(g.byId("share-account-check"), "onClick", b.hitch(this, "clickAccount"));
                    b.publish("shareOptionsSetup");
                    this.updateHelpMsg()
                },
                shareItemToGroups: function() {
                    var a = g.byId("share-groups-check").get("checked"),
                        c = "",
                        d = "",
                        f = "",
                        e = "";
                    a ? this.userGroups && this.userGroups.length && b.forEach(this.userGroups, function(a, g) {
                        a = a.id;
                        b.byId("group_" +
                            g);
                        "block" === b.style(b.byId("group_" + g + "_div"), "display") && (b.byId("group_" + g).checked ? (c += f + a, f = ",") : (d += e + a, e = ","))
                    }) : (e = "", this.userGroups && this.userGroups.length && b.forEach(this.userGroups, function(a) {
                        d += e + a.id;
                        e = ","
                    }));
                    var h = function(c, d, e) {
                            arcgisonline.sharing.geow.Content.shareItemByID(c, { everyone: c && c.access && "public" === c.access, org: c && c.sharing && "org" === c.sharing.access, groups: d }, function(e) {
                                if (e && e.itemId && e.notSharedWith && e.notSharedWith.length) {
                                    var f = c.sharing && c.sharing.groups || [],
                                        g =
                                        d.split(","),
                                        h = b.filter(g || [], b.hitch(this, function(a) { return -1 === b.indexOf(f, a) }));
                                    0 !== h.length && b.every(e.notSharedWith || [], b.hitch(this, function(a) { return -1 < b.indexOf(h, a) })) && b.publish("onNotShareUpdate", e.notSharedWith)
                                }
                                b.publish("onShareUpdate", [a ? "shared" : "private"])
                            }, function(a) { b.publish("onShareUpdate", [a]) })
                        },
                        m = this.items[0];
                    0 < d.length ? arcgisonline.sharing.geow.Content.unshareItemByID(m, { everyone: m && m.access && "public" === m.access, org: m && m.sharing && "org" === m.sharing.access, groups: d }, b.hitch(this,
                        h, m, c)) : h(m, c);
                    b.publish("shareOptionsTeardown")
                },
                shareItemAsAdmin: function(a) {
                    var c = "",
                        d = "";
                    b.forEach(this.items, function(a) {
                        c += d + a.id;
                        d = ","
                    });
                    var f = a = !1;
                    b.byId("share-everyone-check_div") && "block" === b.style(b.byId("share-everyone-check_div"), "display") && (a = g.byId("share-everyone-check").get("checked"));
                    b.byId("share-account-check_div") && "block" === b.style(b.byId("share-account-check_div"), "display") && (f = g.byId("share-account-check").get("checked"));
                    var e = "",
                        h = "",
                        m = "",
                        n = "",
                        r = 0;
                    if (g.byId("share-groups-check").get("checked")) {
                        var v;
                        if (this.userGroups && this.userGroups.length)
                            for (r = 0; r < this.userGroups.length; r++) v = this.userGroups[r].id, "block" === b.style(b.byId("group_" + r + "_div"), "display") && (b.byId("group_" + r).checked ? (e += m + v, m = ",") : (h += n + v, n = ","));
                        if (this.adminGroups && this.adminGroups.length && 1 < this.lowestAccess)
                            for (var w = 0; w < this.adminGroups.length; w++) v = this.adminGroups[w].id, "block" === b.style(b.byId("group_" + (w + r) + "_div"), "display") && (b.byId("group_" + (w + r)).checked ? (e += m + v, m = ",") : (h += n + v, n = ","))
                    } else n = "", this.userGroups &&
                        this.userGroups.length && b.forEach(this.userGroups, function(a) {
                            h += n + a.id;
                            n = ","
                        }), this.adminGroups && this.adminGroups.length && 1 < this.lowestAccess && b.forEach(this.adminGroups, function(a) {
                            h += n + a.id;
                            n = ","
                        });
                    m = function(a, d, e, f) {
                        for (var g = a.length, h = function() {
                                g--;
                                0 === g && b.publish("onShareUpdate", [e ? "public" : f ? "org" : d ? "shared" : "private"])
                            }, m = function(a) { b.publish("onShareUpdate", [a]) }, n = { items: c, groups: d, everyone: e, account: f }, p = 0; p < a.length; p++) arcgisonline.sharing.geow.Content.shareItemByID(a[p], n, h, m)
                    };
                    if (0 < h.length)
                        for (v = { items: c, groups: h }, r = 0; r < this.items.length; r++) arcgisonline.sharing.geow.Content.unshareItemByID(this.items[r], v, b.hitch(this, m, this.items, e, a, f));
                    else m(this.items, e, a, f);
                    b.publish("shareOptionsTeardown")
                },
                shareItem: function(a) {
                    var c = "",
                        d = "";
                    b.forEach(this.items, function(a) {
                        c += d + a.id;
                        d = ","
                    });
                    a = -1;
                    var f = !1;
                    b.byId("share-everyone-check_div") && "block" === b.style(b.byId("share-everyone-check_div"), "display") && (a = g.byId("share-everyone-check").get("checked"));
                    b.byId("share-account-check_div") &&
                        "block" === b.style(b.byId("share-account-check_div"), "display") && (f = g.byId("share-account-check").get("checked"));
                    var e = "",
                        h = "",
                        m = "",
                        n = "";
                    g.byId("share-groups-check").get("checked") ? this.userGroups && this.userGroups.length && b.forEach(this.userGroups, function(a, c) {
                        a = a.id;
                        c = b.byId("group_" + c);
                        c.checked && !c.indeterminate ? (e += m + a, m = ",") : c.checked || (h += n + a, n = ",")
                    }) : (n = "", this.userGroups && this.userGroups.length && b.forEach(this.userGroups, function(a) {
                        h += n + a.id;
                        n = ","
                    }));
                    var r = function(a) {
                            b.publish("onShareUpdate", [a]);
                            a && a.length && a[0].error && "CONT_0046" === a[0].error.messageCode && (g.byId("share-groups-check").set("checked", !1), this.userGroups && this.userGroups.length && b.forEach(this.userGroups, function(a, c) { b.byId("group_" + c).checked = !1 }))
                        },
                        v = function(a, d, e, f) {
                            var g = function() { b.publish("onShareUpdate", [e ? "public" : f ? "org" : d ? "shared" : "private"]) },
                                h = { items: c, groups: d, account: f }; - 1 !== e && (h = b.mixin(h, { everyone: e }));
                            a && null !== a ? arcgisonline.sharing.geow.Content.shareItemsByUser(a.username ? a.username : a.email, h, g,
                                b.hitch(this, r)) : arcgisonline.sharing.geow.Content.shareItems(h, g, b.hitch(this, r))
                        };
                    if (0 < h.length) {
                        var w = { items: c, groups: h };
                        this.itemUser && null !== this.itemUser ? arcgisonline.sharing.geow.Content.unshareItemsByUser(this.itemUser.username ? this.itemUser.username : this.itemUser.email, w, b.hitch(this, v, this.itemUser, e, a, f), b.hitch(this, r)) : arcgisonline.sharing.geow.Content.unshareItems(w, b.hitch(this, v, this.itemUser, e, a, f), b.hitch(this, r))
                    } else b.hitch(this, v, this.itemUser, e, a, f)();
                    b.publish("shareOptionsTeardown")
                },
                checkGroup: function(a) {
                    var c = b.query(".share-groups-input-checkbox").some(function(a) { return a.checked }); - 1 < a.target.id.indexOf("group_") && g.byId("share-groups-check").set("checked", c);
                    b.publish("onClickGroup")
                },
                checkGroups: function(a) {
                    var c = a.target && a.target.checked;
                    a.target && b.query(".share-groups-input-checkbox").forEach(function(a) { a.checked = c });
                    b.publish("onClickGroup")
                },
                clickEveryone: function(a) {
                    !0 === g.byId("share-everyone-check").get("checked") ? (a = b.byId("share-account-check_div"), this.organization &&
                        a && "block" === b.style(a, "display") && (g.byId("share-account-check").set("checked", !0), g.byId("share-account-check").set("readOnly", !0))) : (this.organization && esriGeowConfig.userRole && (!this._isCustomRole || this._roleCanShareToOrg || this._roleCanShareOthersItemsToOrg) && (b.style(b.byId("share-account-check_div"), "display", "block"), g.byId("share-account-check").set("readOnly", !1)), g.byId("share-account-check").set("readOnly", !1), g.byId("share-account-check").set("checked", !0), g.byId("share-everyone-check").set("checked", !1));
                    b.publish("onClickEveryone")
                },
                clickAccount: function(a) {
                    !0 === g.byId("share-account-check").get("checked") ? (this._canShareWithEveryone && this._orgUserCanSharePublicOrOverride && ("none" === b.style(b.byId("share-everyone-check_div"), "display") && b.style(b.byId("share-everyone-check_div"), "display", "block"), g.byId("share-everyone-check").set("checked", !1)), g.byId("share-account-check").set("checked", !0)) : g.byId("share-account-check").set("checked", !1);
                    b.publish("onClickAccount")
                },
                isEveryoneChecked: function() {
                    var a =
                        b.byId("share-everyone-check_div"),
                        c = g.byId("share-everyone-check");
                    return a && "block" === b.style(a, "display") && !0 === c.get("checked")
                },
                isAccountChecked: function() {
                    var a = b.byId("share-account-check_div"),
                        c = g.byId("share-account-check");
                    return a && "block" === b.style(a, "display") && !0 === c.get("checked")
                },
                isGroupChecked: function() {
                    if (g.byId("share-groups-check").get("checked"))
                        for (var a = 0; a < this.userGroups.length; a++)
                            if ("block" === b.style(b.byId("group_" + a + "_div"), "display") && b.byId("group_" + a).checked) return !0;
                    return !1
                },
                getSharedGroups: function() { return b.filter(this.userGroups || [], function(a, c) { a = a.id; return "block" === b.style(b.byId("group_" + c + "_div"), "display") && b.byId("group_" + c).checked ? a : !1 }) },
                hasEditableLayer: function(a) {
                    var c = new b.Deferred;
                    if (a && 1 < a.length) c.resolve(!1);
                    else {
                        a = a[0] || {};
                        var d = a.isHostedService,
                            f = a.url,
                            e;
                        f && a.canUpdate && "Feature Service" === a.type && d ? this.util.request({ url: f + "/layers" }).then(function(a) {
                            e = a && a.layers && a.layers.length ? a.layers[0] : {};
                            c.resolve(e.capabilities && -1 < e.capabilities.indexOf("Editing") ||
                                !1)
                        }, function() { c.resolve(!1) }) : c.resolve(!1)
                    }
                    return c
                },
                canShareWithEveryone: function(a) {
                    var c = new b.Deferred;
                    a = a.every(function(a) { return esri.isDefined(a.canShareWithEveryone) && !a.canShareWithEveryone || !1 });
                    c.resolve(a ? !1 : !0);
                    return c
                },
                hasPremiumContent: function(a) {
                    var c = new b.Deferred;
                    a = a.some(function(a) { return a.isPremiumContent });
                    c.resolve(a ? !0 : !1);
                    return c
                },
                updateHelpMsg: function() {
                    var a = this.isEveryoneChecked(),
                        c = this._hasEditableLayer && a ? "removeClass" : "addClass",
                        a = this._hasPremiumContent &&
                        a ? "removeClass" : "addClass";
                    b.query(".js-sharing-help")[c]("hide");
                    b.query(".js-premium-help")[a]("hide")
                },
                _sortFunc: function(a, b) {
                    a = a[this.sortField].toLowerCase();
                    b = b[this.sortField].toLowerCase();
                    return null === a || null === b || a === b ? 0 : a < b ? -1 : 1
                }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/SimpleDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/form/Button,dijit/_Widget,dijit/_Templated"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.SimpleDlg");
        b.require("dijit.Dialog");
        b.require("dijit.form.Button");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.declare("arcgisonline.sharing.dijit.dialog.SimpleDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: '\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${title}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_content"\x3e${!content}\x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-1 esriFloatTrailing right"\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick: hide" class\x3d"primary" type\x3d"button"\x3e${i18n.ok}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common
            },
            show: function() { this.dialog.show() },
            hide: function() { this.dialog.hide() }
        })
    })
}, "arcgisonline/pages/utils/tooltips": function() {
    define("require exports tslib ../../esriGeowConfig dijit/Tooltip dojo/mouse dojo/on".split(" "), function(b, g, n, a, c, d, f) {
        a = n.__importDefault(a);
        c = n.__importDefault(c);
        d = n.__importDefault(d);
        f = n.__importDefault(f);
        return function() {
            function b() {}
            b.oneTimeTooltip =
                function(b, e) {
                    c.default.show(b, e, this.TOOLTIP_POSITIONS, a.default.isRightToLeft);
                    f.default.once(e, d.default.leave, function() { c.default.hide(e) })
                };
            b.oneTimeError = function(b, e) {
                c.default.show(b, e, ["below"], a.default.isRightToLeft);
                f.default.once(e, d.default.leave, function() { c.default.hide(e) });
                c.default._masterTT.domNode.classList.add("one-time-error-tooltip")
            };
            b.createTooltip = function(a, b, d, e) {
                return new c.default({
                    label: '\x3cdiv style\x3d"max-width:' + (null !== e && void 0 !== e ? e : 300) + 'px;"\x3e' + b + "\x3c/div\x3e",
                    connectId: [a],
                    id: "tooltip_" + a,
                    showDelay: null !== d && void 0 !== d ? d : 200
                })
            };
            b.createSelectorTooltip = function(a, b, d, e, f) { return new c.default({ label: '\x3cdiv style\x3d"max-width:' + (null !== f && void 0 !== f ? f : 300) + 'px;"\x3e' + d + "\x3c/div\x3e", connectId: [a], selector: b, id: "tooltip_" + a, showDelay: null !== e && void 0 !== e ? e : 200 }) };
            b.TOOLTIP_POSITIONS = ["after", "below", "above", "before"];
            return b
        }()
    })
}, "arcgisonline/sharing/dijit/dialog/BrowseItemsDlg": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/event dojo/dom-class dojo/dom-style dojo/dom-attr dojo/string dojo/on dojo/aspect dojo/dom dojo/dom-construct dojo/mouse dojo/topic dojo/query dojo/parser dijit/registry dijit/TooltipDialog dijit/popup dojo/promise/all dojo/Deferred dgrid/Grid dgrid/extensions/Pagination dgrid/OnDemandGrid dgrid/Selection dgrid/selector dgrid/Keyboard dgrid/util/mouse dgrid/util/touch put-selector/put dojo/store/Observable dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/arcgis/Portal esri/Evented esri/PluginTarget arcgisonline/sharing/util arcgisonline/sharing/geow/Account ./_AppTemplateFiltersMixin dojo/i18n!arcgisonline/nls/arcgisonline ../_RefreshMixin ../_Empty dojo/NodeList-dom".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q, T) {
            var Y = b(null, {
                idProperty: "id",
                constructor: function(a) { b.safeMixin(this, a) },
                get: function(a, b) { return X.PortalUtil.request(this.portalUrl + "content/items/" + a, b).then(function(a) { return new X.PortalItem(g.mixin(a, { portal: this.portal })) }) },
                getIdentity: function(a) { return a[this.idProperty] },
                query: function(a, b) {
                    a = g.isObject(a) ? a : { q: a };
                    b && (a = g.mixin(a, { num: b.count, start: (b.start || 0) + 1 }), b.sort && b.sort.length &&
                        (b = b.sort[0], a = g.mixin(a, { sortField: encodeURIComponent("created" === b.attribute ? "uploaded" : b.attribute), sortOrder: b.descending ? "desc" : "asc" })));
                    b = this.portal.queryItems(a, !0).then(function(a) { a.results.total = a.total; return a.results });
                    return X.PortalResult(b)
                }
            });
            return b("arcgisonline.sharing.dijit.dialog.BrowseItemsDlg", [U, V, C, y], {
                templateString: '\x3cdiv\x3e\x3cdiv class\x3d"top-bar clearfix"\x3e\x3cdiv  class\x3d"left instructions"\x3e\x3cspan class\x3d"messageLeft hide" data-dojo-attach-point\x3d"messageNodeLeft"\x3e\x3c/span\x3e\x3cspan class\x3d"messageRight hide" data-dojo-attach-point\x3d"messageNodeRight"\x3e\x3c/span\x3e\x3ca data-dojo-attach-point\x3d"helpLink" class\x3d"icon-ui-question icon-ui-flush margin-left-half hide" title\x3d"${i18n.common.learnMoreConfigurableApps}" href\x3d"#" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv id\x3d"${id}_search"class\x3d"searchBar right"\x3e\x3cinput tabIndex\x3d"0" placeholder\x3d"${i18n.search.searchTitle}" aria-label \x3d"${i18n.search.searchTitle}" class\x3d"esriSearchBox dijitTextBox" type\x3d"search"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"gallery"\x3e\x3cdiv class\x3d"gallery-left  quiet-scroll"\x3e\x3cul class\x3d"filters"\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv class\x3d"templates gallery-right"\x3e\x3cp id\x3d"${id}_filterTitle" class\x3d"filter-title hide" data-dojo-attach-point\x3d"filterDescription"\x3e\x3c/p\x3e\x3cdiv id\x3d"${id}_grid"class\x3d"dgrid-autoheight quiet-scroll"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loader-wrap"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv  data-dojo-attach-point\x3d"infoPanel" id\x3d"template-info-panel"\x3e\x3c/div\x3e\x3c/div\x3e',
                galleryTemplate: '\x3cdiv style\x3d\'opacity:1;\' class\x3d\'grid-item gallery-view\' tabIndex\x3d"0" aria-label\x3d"${item.title}"\x3e\x3cdiv class\x3d\'grid-item-thumbnail-wrap\'\x3e${item:_formatThumbnail}\x3cp class\x3d"template-overlay" style\x3d"display:none;"\x3e${i18n.browseItemsDlg.selectDetails}\x3c/p\x3e\x3c/div\x3e${item:_formatItemTitle}\x3c/div\x3e',
                infoPanelTemplate: '\x3cdiv class\x3d"template-info-wrapper"\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv class\x3d"thumbnail"\x3e\x3cimg src\x3d"${item:_formatInfoPanelImage}"\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d"quiet-scroll"\x3e${item.snippet}\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e\x3cbutton class\x3d"btn blue btn-main" id\x3d"on-next"\x3e${i18n.browseItemsDlg.configure}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
                baseClass: "esriBrowseItems",
                i18n: I,
                postCreate: function() {
                    this.inherited(arguments);
                    this._portalUser = (this._portal = esriGeowConfig.portal) && (this._portal.user || this._portal.getPortalUser());
                    u.getSelf(g.hitch(this, function(a) {
                        this._canSearchPublic = a.canSearchPublic;
                        this._currentFilter = g.mixin(this._currentFilter || {}, {
                            get: function(a) { return g.isArray(this[a]) && 1 < this[a].length ? "(" + this[a].join(" OR ") + ") " : this[a] ? this[a] + " " : "" },
                            toString: function() {
                                return {
                                    q: this.get("groups") + this.get("tags") + this.get("persistentTypekeywords") +
                                        this.get("typekeywords") + this.get("types") + (this.query || "") + (this.search || "") + ' -type:"Attachment"'
                                }
                            }
                        });
                        a.canSearchPublic = !0;
                        this._portal ? this.itemQuery && this._fetchData() : (this._portal = new X.Portal({ url: esriGeowConfig.restBaseUrl, self: a }), this._portal.on("load", g.hitch(this, function() { this.addPlugin(this.plugin).then(g.hitch(this, function() {})) })));
                        x(".templates", this.domNode).addClass("fade");
                        x(".dgrid-footer", this.domNode).addClass("hide")
                    }))
                },
                destroy: function() {
                    this.inherited(arguments);
                    this._grid &&
                        this._grid.destroy();
                    this._img_connect && (this._img_connect.remove(), this._img_connect_error.remove());
                    this._queryTimer && clearTimeout(this._queryTimer);
                    this._grid = this._portal = null
                },
                addPlugin: function(a) {
                    var b = new A;
                    a ? this.inherited(arguments).then(g.hitch(this, function(a) {
                        this.galleryTemplate = this.plugIn && this.plugIn.galleryTemplate || this.galleryTemplate;
                        (this.helpLinkUrl = this.plugIn && this.plugIn.helpLinkUrl || "") ? (e.set(this.helpLink, "href", this.helpLinkUrl), d.remove(this.helpLink, "hide")) : d.add(this.helpLink,
                            "hide");
                        this._fetchData().then(function() { b.resolve(a) })
                    })) : b.resolve(!0);
                    return b
                },
                _setItemQueryAttr: function(a) { this.itemQuery = a },
                _setPluginAttr: function(a) { this.plugin = a },
                _setMessageAttr: function(a) { this.set("messageRight", a) },
                _setMessageRightAttr: function(a) {
                    e.set(this.messageNodeRight, "innerHTML", a);
                    d.remove(this.messageNodeRight, "hide")
                },
                _setMessageLeftAttr: function(a) {
                    e.set(this.messageNodeLeft, "innerHTML", a);
                    d.remove(this.messageNodeLeft, "hide")
                },
                _setDisabledAttr: function(a) {
                    var b = E.findWidgets(this.domNode).concat(E.findWidgets(this._content));
                    n.forEach(b, function(b) { b.set("disabled", a) });
                    d[a ? "add" : "remove"](this._interval.domNode, "dijitTextBoxDisabled")
                },
                _setSortAttr: function(a) { this.sortAttribute = a },
                _setSortDescendingAttr: function(a) { this.sortDescending = a },
                _getSelectionAttr: function() {
                    var a = this._grid.selection,
                        b;
                    for (b in a) break;
                    return b && this._grid.row(b).data
                },
                _getInfoPanelTemplateAttr: function() { return this.plugIn && this.plugIn.infoPanelTemplate || this.infoPanelTemplate },
                _getGalleryTemplateAttr: function() {
                    return this.plugIn && this.plugIn.galleryTemplate ||
                        this.galleryTemplate
                },
                _validate: function() { return !!this.get("selection") },
                _clearQueryTimeout: function() {
                    clearTimeout(this._queryTimer);
                    this._queryTimer = null
                },
                _clearClosePanelTimeout: function() {
                    clearTimeout(this._panelClosing);
                    this._panelClosing = null;
                    n.forEach(this._panelClickHandles, "item.remove();");
                    v.empty("template-info-panel")
                },
                _createGrid: function() {
                    var a = b([H, J, M, P, Q]),
                        f = new W(new Y({ portal: this._portal })),
                        p = this._currentFilter,
                        u = g.hitch(this, function(a) {
                            a.snippet = a.snippet || "";
                            a.title = a.title ||
                                "";
                            var b = S("div");
                            a = h.substitute(this.get("galleryTemplate"), { item: a, i18n: I }, null, this);
                            v.place(a, b);
                            return b
                        });
                    this._grid = new a({ store: f, query: p.toString(), selectionMode: "single", pagingLinks: 2, rowsPerPage: this.plugIn && this.plugIn.rowsPerPage || 8, noDataMessage: h.substitute(T, { message: I.emptyStates.noContentAvailable, width: 256 }), showLoadingMessage: !1, renderRow: u, sort: [{ attribute: this.sortAttribute || "title", descending: this.sortDescending || !1 }] }, this.id + "_grid");
                    this._grid.startup();
                    this.own(m(this.domNode,
                        "click", g.hitch(this, function(a) { r.byId("close-panel") && r.byId("close-panel").click() })), this._grid.addKeyHandler(13, g.hitch(this, function(a) {
                        a = a.target;
                        this._grid.select(a);
                        a.click()
                    })), this._grid.addKeyHandler(32, g.hitch(this, function(a) {
                        a = a.target;
                        this._grid.select(a);
                        a.click()
                    })), this._grid.on(O.enterRow, g.hitch(this, function(a) {!1 === d.contains(this.domNode, "showing") && this._showOverlay(!0, a) })), this._grid.on(O.leaveRow, g.hitch(this, function(a) { this._showOverlay(!1, a) })), this._grid.on(".dgrid-row:click",
                        g.hitch(this, function(a) {
                            var b;
                            !1 === d.contains(this.domNode, "showing") && (a.preventDefault(), c.stop(a), this._clearClosePanelTimeout(), b = this.get("selection"), this._showOverlay(!1, a), v.place(h.substitute(this.get("infoPanelTemplate"), { item: b, i18n: I, previewButtonWidth: this._previewButtonWidth(b), hideDownload: this._hideDownload(b) }, function(a) { return esri.isDefined(a) ? a : "" }, this), this.infoPanel), d.add(this.domNode, "showing"), t.publish("/esri/browseitems/showInfoTemplate", !0), setTimeout(g.hitch(this, function() {
                                x("#template-info-panel *",
                                    this.domNode).forEach(function(a) { a.tabIndex = 0 });
                                var a = this.domNode.querySelector("#create-app");
                                a && a.focus()
                            }), 500), this._panelClickHandles = [x(".template-info-showing .thumbnail img", this.domNode).on("error", g.hitch(this, function(a) { e.set(a.target, "src", b.thumbnailUrl) })), x(".panel-actions .btn").on("click", g.hitch(this, function(a) {
                                a.preventDefault();
                                c.stop(a);
                                "close-panel" === a.target.id ? (d.remove(this.domNode, "showing"), x("#template-info-panel *", this.domNode).forEach(function(a) { a.tabIndex = -1 }),
                                    t.publish("/esri/browseitems/showInfoTemplate", !1), this._panelClosing = setTimeout(g.hitch(this, function() { n.forEach(void 0, "item.remove();") }, 250))) : t.publish("/esri/browseitems/close", a.target.id, this.get("selection"))
                            })), x("#template-info-panel").on("click", g.hitch(this, function(a) {
                                a.preventDefault();
                                c.stop(a)
                            }))])
                        })), this._grid.on("dgrid-refresh-complete", g.hitch(this, function(a) {
                        x(".templates", this.domNode).removeClass("fade");
                        x("#loader-wrap", this.domNode).addClass("hide");
                        x(".dgrid-footer", this.domNode)[this._grid._total <=
                            this._grid.rowsPerPage ? "addClass" : "removeClass"]("hide")
                    })), this._grid.on("refresh", g.hitch(this, function() {
                        this._img_connect && (this._img_connect.remove(), this._img_connect_error.remove(), this._img_connect_error = this._img_connect = null);
                        this._img_connect = x(".grid-item-thumb", this._grid.domNode).on("load", g.hitch(this, function(a) {
                            (a = this._grid.row(a)) && a.element && x(".grid-item", a.element).addClass("fadeIn").style("opacity", "1")
                        }));
                        this._img_connect_error = x(".grid-item-thumb", this._grid.domNode).on("error",
                            g.hitch(this, function(a) { e.set(a.target, "src", q.getStaticImagesUrl() + "/desktopapp.png") }))
                    })), m(r.byId(this.id + "_search"), "keyup, input", g.hitch(this, function(a) {
                        a.preventDefault();
                        this._clearQueryTimeout();
                        this._queryTimer = setTimeout(g.hitch(this, function() {
                            this._currentFilter.search = e.get(a.target, "value");
                            this._fetchItems(this._currentFilter).then(g.hitch(this, function() { this._clearQueryTimeout() }))
                        }), this.searchKeypressDelay || 450)
                    })), m(r.byId(this.id + "_search"), "search", g.hitch(this, function(a) {
                        this._queryTimer ||
                            (a.preventDefault(), this._currentFilter.search = e.get(a.target, "value"), this._fetchItems(this._currentFilter))
                    })))
                },
                _createFilters: function() {
                    if (this.plugIn && this.plugIn.filters) {
                        var a = this.plugIn.filters,
                            b = this.plugIn.filterStrings,
                            c, f = x(".filters", this.domNode)[0];
                        for (c in a) v.create("li", { "class": "all" === c ? "active" : "", innerHTML: "\x3ca id\x3d'" + c + "'  href\x3d'#'\x3e" + b[c].title + "\x3c/a\x3e" }, f);
                        this.own(m(f, "li a:click", g.hitch(this, function(c) {
                            c.preventDefault();
                            var h = c.target;
                            x(".active", f).removeClass("active");
                            d.add(h.parentNode, "active");
                            x(".templates", this.domNode).addClass("fade");
                            setTimeout(g.hitch(this, function() {
                                d["all" === h.id ? "add" : "remove"](this.filterDescription, "hide");
                                e.set(this.filterDescription, "innerHTML", this._portal.isPortal && b[h.id].descriptionPortal || b[h.id].description || "")
                            }), 225);
                            c = g.mixin({}, a[h.id] || {});
                            this._currentFilter.tags = n.map(c.tags || [], function(a) { return 'tags:"' + a + '"' });
                            this._currentFilter.typekeywords = [].concat(n.map(c.typekeywords || [], function(a) {
                                return 'typekeywords:"' +
                                    a + '"'
                            }));
                            this._fetchItems(this._currentFilter)
                        })));
                        d.add(this.domNode, "filters")
                    } else d.add(this.domNode, "nofilters" + (this.plugIn && this.plugIn.extraClasses ? " " + this.plugIn.extraClasses.join(" ") : ""))
                },
                _showOverlay: function(a, b) {
                    (b = this._grid.row(b)) && x(".template-overlay", b.element).style("display", a ? "" : "none")
                },
                _fetchData: function() {
                    if (this._portal) return this._user = this._portalUser || this._portal && this._portal.getPortalUser(), this.plugIn && this.plugIn.fetchData ? this.plugIn.fetchData() : this._fetchItems(this.itemQuery);
                    var a = new A;
                    a.resolve(!1);
                    return a
                },
                _fetchItems: function(a, b) {
                    var c = { sort: [{ attribute: this.sortAttribute || "title", descending: this.sortDescending || !1 }] },
                        d = new A;
                    x(".templates", this.domNode).addClass("fade");
                    x(".dgrid-footer", this.domNode).addClass("hide");
                    x("#loader-wrap", this.domNode).removeClass("hide");
                    setTimeout(g.hitch(this, function() {
                        this._currentFilter = g.mixin(this._currentFilter, a);
                        this._grid ? this._grid.set("query", this._currentFilter.toString(), c) : (this._createFilters(), this._createGrid());
                        d.resolve(this._grid)
                    }), 60);
                    return d
                },
                _formatThumbnail: function(a) {
                    var b = a.thumbnailUrl || q.getStaticImagesUrl() + "/desktopapp.png";
                    a.thumbnailUrl = b;
                    return "\x3cimg class\x3d'grid-item-thumb' width\x3d'187px' height\x3d'125px' alt\x3d'' src\x3d'" + b + "'\x3e"
                },
                _formatInfoPanelImage: function(a) { var b = a.screenshots && a.screenshots.length ? a.screenshots[0] : null; return b ? a.itemUrl + "/info/" + b : a.thumbnailUrl },
                _formatItemTitle: function(a) { return "\x3ch5\x3e" + (a.title || a.name || "\x3cNo Title\x3e") + "\x3c/h5\x3e" },
                _hideDownload: function(a) {
                    return a.typeKeywords &&
                        -1 < a.typeKeywords.indexOf("indoors") ? "hide" : ""
                },
                _previewButtonWidth: function(a) { return "hide" === this._hideDownload(a) ? "btn-wide" : "" }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/_AppTemplateFiltersMixin": function() {
    define(["dojo/_base/declare"], function() {
        return {
            rootNodes: {
                app: {
                    all: {},
                    narrate: { typekeywords: ["story"] },
                    collect: { typekeywords: ["collect"] },
                    compare: { typekeywords: ["compare"] },
                    "3dscene": { typekeywords: ["3Dscene"], tags: ["3Dscene"] },
                    analyze: { typekeywords: ["summarize"] },
                    imagery: { typekeywords: ["interpret"] },
                    present: { typekeywords: ["gallery"] },
                    social: { typekeywords: ["social"] },
                    local: { typekeywords: ["local"] },
                    route: { typekeywords: ["route"] },
                    showcase: { typekeywords: ["showcase"] }
                }
            }
        }
    })
}, "arcgisonline/sharing/dijit/_RefreshMixin": function() {
    define(["dojo/_base/declare", "dojo/_base/lang", "dojo/_base/Deferred", "dojo/on"], function(b, g, n, a) {
        function c(b) {
            "object" !== typeof b && (b = Error(b));
            b.grid = this;
            a.emit(this.domNode, "dgrid-error", { grid: this, error: b, cancelable: !0, bubbles: !0 })
        }
        return b(null, {
            _trackError: function(b) {
                var d;
                "string" === typeof b && (b = g.hitch(this, b));
                try { d = b() } catch (e) { c.call(this, e) }
                return n.when(d, g.hitch(this, function() { a.emit(this.domNode, "refresh", { cancelable: !0, bubbles: !0 }) }), g.hitch(this, c))
            }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/dom-class dojo/query dojo/Deferred ./_AppTemplateFiltersMixin arcgisonline/sharing/util dojo/i18n!arcgisonline/nls/arcgisonline".split(" "), function(b,
        g, n, a, c, d, f, e, h, m) {
        var p = b("arcgisonline.sharing.dijit.dialog.PluginConfigurableAppsViewer", null, {
            infoPanelTemplate: '\x3cdiv\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv class\x3d"thumbnail"\x3e\x3cimg src\x3d"${item:_formatInfoPanelImage}"\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d"quiet-scroll"\x3e${item.snippet}\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e\x3cbutton class\x3d"btn blue btn-main" id\x3d"create-app"\x3e${i18n.items.createApp}\x3c/button\x3e\x3cbutton class\x3d"btn btn-secondary ${previewButtonWidth}" id\x3d"preview-app"\x3e${i18n.templatesGridWidget.preview}\x3c/button\x3e\x3cbutton class\x3d"btn btn-secondary ${hideDownload}" id\x3d"download-app"\x3e${i18n.templatesGridWidget.download}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
            customGroupInfoPanelTemplate: '\x3cdiv\x3e\x3cdiv class\x3d"template-info-showing"\x3e\x3cdiv class\x3d"thumbnail"\x3e\x3cimg src\x3d"${item:_formatInfoPanelImage}"\x3e\x3c/div\x3e\x3ch4\x3e${item.title}\x3c/h4\x3e\x3cdiv class\x3d"template-info"\x3e\x3cp class\x3d"quiet-scroll"\x3e${item.snippet}\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-actions"\x3e\x3cbutton class\x3d"btn blue btn-main" id\x3d"create-app"\x3e${i18n.items.createApp}\x3c/button\x3e\x3cbutton class\x3d"btn btn-secondary btn-wide" id\x3d"preview-app"\x3e${i18n.templatesGridWidget.preview}\x3c/button\x3e\x3cbutton class\x3d"btn btn-cancel" id\x3d"close-panel"\x3e${i18n.common.close}\x3c/button\x3e\x3c/div\x3e\x3cdiv\x3e',
            filters: g.mixin({}, e.rootNodes.app),
            filterStrings: m.appTemplateFilters,
            rowsPerPage: 100,
            constructor: function(a) {
                g.mixin(this, a);
                this.helpLinkUrl = esriGeowConfig.self && esriGeowConfig.self.isPortal ? esriGeowConfig.self ? esriGeowConfig.self.helpBase + esriGeowConfig.self.helpMap.m["120001018"] : "" : esriGeowConfig.self ? esriGeowConfig.self.helpBase + esriGeowConfig.self.helpMap.m["120001055"] : "";
                delete this.filters.present;
                delete this.filters["3dscene"]
            },
            fetchData: function() {
                var a = [];
                this.parent._currentFilter.types = ['type:"Web Mapping Application"'];
                this._portal = this.parent._portal;
                this._user = this._portal.getPortalUser();
                return this.hasIndoors(this._portal).then(function(b) { this.hasIndoors = b; return this._fetchGroups().then(function(b) { n.forEach(b || [], function(b) { b && b.id && a.push('group:"' + b.id + '"') }); return this._fetchGroupItems(a) }.bind(this)) }.bind(this))
            },
            _fetchGroups: function() { var a = this._portal.templatesGroupQuery || null; return a && a.split("id:")[1] ? this._fetchOrgConfigurableApps() : this._fetchEsriConfigurableApps() },
            _fetchGroup: function(a, b) { this._groups = this._groups || []; return this._groups[a] || this._portal.queryGroups(b, !0).then(g.hitch(this, function(b) { b = b.total && b.results && b.results[0] || null; return (this._groups[a] = b) || {} })) },
            _fetchGroupItems: function(a) { return this.parent._fetchItems({ groups: a }) },
            _fetchEsriConfigurableApps: function() {
                var b = this.hasIndoors,
                    c = (this._user && this._user.culture || this._portal && this._portal.culture || dojoConfig.locale || "en").split("-")[0].toLowerCase(),
                    d = {
                        q: 'title:"Web Application Templates" AND owner:"esri_' +
                            ({ id: "ind", uk: "ukr" }[c] || c) + '"'
                    };
                this.parent._currentFilter.persistentTypekeywords = ['-typekeywords:"3Dscene"'];
                b || this.parent._currentFilter.persistentTypekeywords.push('-typekeywords:"indoors"');
                return a([this._fetchGroup("esriGallery_" + c, d)]).then(g.hitch(this, function(a) { return a || [] }))
            },
            _fetchOrgConfigurableApps: function() {
                var b = this.hasIndoors,
                    c = { q: this._portal.templatesGroupQuery || null };
                this.filters = null;
                this.rowsPerPage = 8;
                this.extraClasses = ["wide"];
                this.infoPanelTemplate = this.customGroupInfoPanelTemplate;
                this.parent._currentFilter.persistentTypekeywords = ['-typekeywords:"Web AppBuilder"'];
                b || this.parent._currentFilter.persistentTypekeywords.push('-typekeywords:"indoors"');
                return a([this._fetchGroup("customGallery", c)]).then(g.hitch(this, function(a) {
                    this.parent.sortDescending = a[0].sortOrder && "desc" === a[0].sortOrder || !1;
                    this.parent.sortAttribute = a[0].sortField || "asc";
                    return a && a.length ? [a[0]] : []
                }))
            },
            hasIndoors: function(a) {
                return this.fetchCapabilities(a).then(function(a) {
                    return a.some(function(a) {
                        return "indoors" ===
                            a.id
                    })
                })
            },
            fetchCapabilities: function(a) {
                var b = new f;
                h.request({ url: esriGeowConfig.restBaseUrl + "portals/self/subscriptionInfo" }).then(function(a) { b.resolve(a && a.orgCapabilities || []) });
                return b
            }
        });
        g.mixin(p, { add: function(a, b) { a.plugIn || (b = b || {}, b.parent = a, a.plugIn = new p(b)) }, remove: function(a) { a.plugIn && (a.plugIn.destroy(), delete a.plugIn) } });
        return p
    })
}, "arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg": function() {
    define("esri/lang dojo/_base/declare dojo/on dojo/dom-attr dojo/query dojo/dom dojo/dom-style dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/string dojo/number dojo/_base/window dojo/promise/all dojo/when dojo/Deferred dojo/_base/array dojo/cookie dojo/dom-class dojo/json dojox/form/Uploader dijit/registry dijit/form/TextBox dijit/form/RadioButton dijit/ConfirmDialog dijit/focus dgrid/OnDemandGrid dgrid/editor dojo/store/Observable dojo/store/Memory esri/dijit/Tags arcgisonline/sharing/dijit/dialog/_AddItemDlgMixin arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin dijit/form/SimpleTextarea dijit/form/Textarea dijit/form/Select dojo/topic esri/Evented esri/arcgis/Portal arcgisonline/pages/portal/PortalItem arcgisonline/esriGeowConfig arcgisonline/pages/pageUtil arcgisonline/pages/utils/categories arcgisonline/pages/utils/dom arcgisonline/pages/dijit/CategoryPicker arcgisonline/sharing/geow/Account arcgisonline/sharing/util arcgisonline/sharing/geow/Folder esri/geometry/Extent esri/SpatialReference ../../../map/core/sameSpatialReference ../../../map/core/projectExtent dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F, D, A, H, J, L, M, K, P, O, R, S, W, U, V, C, X, N, y, q, u, z, I, Q, T, Y, Z, aa, fa, da, ca, ha, ia, ja, ba, ea) {
            return g("arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg", [h, m, p, V, u], {
                baseClass: "esriItemPropertiesDlg",
                templateString: '\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\x3cdiv class\x3d"wabdiv"\x3e\x3clabel class\x3d"wab wablbl hide"\x3e\x3cinput class\x3d"wab hide" data-dojo-attach-point\x3d"wab2DRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d\'checked:true,name:"wabtype"\' value\x3d"2d" /\x3e${i18n.addItemFrm.2d}\x3c/label\x3e\x3clabel class\x3d"wab wablbl hide"\x3e\x3cinput class\x3d"wab hide" data-dojo-attach-point\x3d"wab3DRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d\'name:"wabtype"\' value\x3d"3d" /\x3e${i18n.addItemFrm.3d}\x3c/label\x3e\x3c/div\x3e\x3cp data-dojo-attach-point\x3d"_message" class\x3d"trailer-half"\x3e\x3c/p\x3e\x3cform id\x3d"_createForm" data-dojo-attach-point\x3d"_form" enctype\x3d"multipart/form-data" action\x3d"" method\x3d"POST"\x3e\x3clabel for\x3d"uploader" class\x3d"file"\x3e${i18n.addLayerFromFileDlg.fileLabel}\x3c/label\x3e\x3cdiv data-dojo-attach-point\x3d"_files" class\x3d"file" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-props\x3d\'label:"Browse", name:"file", showInput:"before"\'\x3e\x3c/div\x3e\x3cbr class\x3d"file" /\x3e\x3cdiv data-dojo-attach-point\x3d"_zip" class\x3d"zip esriLeadingMargin80 hide"\x3e\x3clabel for\x3d"archiveSelect"\x3e${i18n.addItemFrm.itemContents}\x3c/label\x3e\x3cselect data-dojo-attach-point\x3d"_zipContents" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:25%;"\x3e\x3coption value\x3d"shapefile" selected\x3e${i18n.addItemFrm.typeShapefile}\x3c/option\x3e\x3coption value\x3d"filegeodatabase"\x3e${i18n.addItemFrm.itemFileGeodatabase}\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e\x3clabel for\x3d"${id}-url" class\x3d"url hide trailer-0"\x3e${i18n.publishWizard.urlItemLbl}\x3c/label\x3e\x3cdiv id\x3d"${id}-url" class\x3d"required url trailer-half hide" data-dojo-attach-point\x3d"_url" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'disabled:true, name:"url", trim:true, placeHolder:"${i18n.addLayerFromUrlDlg.enterUrl}"\'\x3e\x3c/div\x3e\x3cbr class\x3d"url hide" /\x3e\x3clabel for\x3d"${id}-title" class\x3d"trailer-0"\x3e${i18n.publishWizard.titleLbl}\x3c/label\x3e\x3cdiv id\x3d"${id}-title" tabindex\x3d"0" class\x3d"required title trailer-half" data-dojo-attach-point\x3d"_title" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'name:"title", trim:true, placeHolder:"${i18n.publishWizard.titlePlaceHolder}"\'\x3e\x3c/div\x3e\x3cbr /\x3e\x3clabel for\x3d"${id}-tags" data-dojo-attach-point\x3d"_tagsDijitLbl" class\x3d"tagsLbl leader-0 trailer-0"\x3e${i18n.publishWizard.tagsLbl}\x3cspan class\x3d"screen-readers-only" id\x3d"tags-required"\x3e${i18n.publishWizard.tagsRequired}\x3c/span\x3e\x3c/label\x3e\x3cdiv id\x3d"${id}-tags" class\x3d"required trailer-half" data-dojo-attach-point\x3d"_tagsDijit" data-dojo-type\x3d"esri/dijit/Tags" data-dojo-props\x3d"name: \'tags\', required:true, width:\'100%\', minWidth:\'100%\', maxWidth:\'100%\'"\x3e\x3c/div\x3e\x3cbr /\x3e\x3clabel for\x3d"${id}-summary" class\x3d"trailer-0 leader-half"\x3e${i18n.publishWizard.summaryLbl}\x3c/label\x3e\x3ctextarea id\x3d"${id}-summary" tabindex\x3d"0" class\x3d"required snippet trailer-0" maxlength\x3d"250" data-dojo-attach-point\x3d"_summaryDijit" class\x3d"summaryTextBox dijitPlaceHolder" data-dojo-type\x3d"dijit/form/Textarea" data-dojo-props\x3d\'name:"snippet", trim:true, placeHolder:"${i18n.publishWizard.summaryPlaceHolder}", value: "${i18n.publishWizard.summaryPlaceHolder}"\'\x3e\x3c/textarea\x3e\x3cbr /\x3e\x3cdiv class\x3d"hide categories-container"\x3e\x3clabel class\x3d"trailer-0 leader-half" data-dojo-attach-point\x3d"_categoriesLbl" for\x3d"itemPropCategoryPicker"\x3e${i18n.addItemFrm.categories}${i18n.addItemFrm.colon}\x3c/label\x3e\n\x3cdiv class\x3d"categoriesPickerSection" data-dojo-attach-point\x3d"_categoriesContainer" id\x3d"itemPropCategoryPicker"\x3e\x3c/div\x3e\x3c/div\x3e\x3clabel for\x3d"${id}-folders" data-dojo-attach-point\x3d"_foldersDijitLbl" class\x3d"folderDropdown trailer-0 leader-half hide" style\x3d"clear:both;"\x3e\x3cspan class\x3d"saveFolderLbl"\x3e${i18n.publishWizard.saveFolderLbl}\x3c/span\x3e\x3cselect id\x3d"${id}-folders" tabindex\x3d"0"  class\x3d"folderDropdownSelect folderDropdown hide" data-dojo-attach-point\x3d"_folders" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:77%;" data-dojo-props\x3d\'maxHeight:"200"\'\x3e\x3c/select\x3e\x3c/label\x3e\x3c/form\x3e\x3c/div\x3e',
                onOk: function() {},
                onCancel: function() {},
                onLoad: function() {},
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this._errorDlg = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                    this.i18n = e.mixin({}, ea);
                    this._maxFileSize = 1E9;
                    this._analyzeTypes = { csv: 1 };
                    this._type = this.typeInfo;
                    var a = F("ESRI_Content");
                    this._selectedFolderId = (a ? A.parse(a) : {}).folderId || null;
                    this._portalUser = (this._portal = Q.portal) && (this._portal.portalUser || this._portal.user || this._portal.getPortalUser())
                },
                postCreate: function() {
                    this.inherited(arguments);
                    D.add(this._summaryDijit.domNode, "dijitPlaceHolder");
                    var b = this._files.displayInput;
                    D.add(b, "placeHolder");
                    a.set(b, "value", "Select File");
                    this._tagsDijit && this._tagsDijit._inputTextBox && this._tagsDijit._inputTextBox.set && this._tagsDijit._inputTextBox.set("aria-describedby", "tags-required");
                    this._tagsDijitLbl && this._tagsDijit._inputTextBox && a.set(this._tagsDijitLbl, "for", this._tagsDijit._inputTextBox.id);
                    fa.getSelf(e.hitch(this, function(a) {
                        this._loadConnections();
                        this._portal ? this._init() : (this._portal = new z.Portal({ url: Q.restBaseUrl, self: a }), this._connect = this._portal.on("load", e.hitch(this, function(a) {
                            this._connect.remove();
                            this._portalUser = this._portal.getPortalUser();
                            this._init()
                        })))
                    }))
                },
                _init: function() {
                    return x([da.loadUserTags(this._portalUser.username), this._getFolders()]).then(e.hitch(this, function(a) {
                        a && a[0] && this._tagsDijit.set("knownTags", a[0]);
                        this.item && this.item.type && !this.item.declaredClass && (this.item = new I(e.mixin(this.item, { portal: this._portal })));
                        this._tagsDijit.set("value", this.item && this.item.tags || "");
                        this._summaryDijit.set("value", ea.publishWizard.summaryPlaceHolder);
                        this._loadFolders(a[1] && a[1].folders || [], this._folders);
                        this._supportedType = !this.item || "Web Scene" !== this.item.type && "Web Map" !== this.item.type ? null : this.item.type;
                        this.set("showWAB", "wab" !== this._type || this._supportedType ? !1 : !0);
                        this._supportedType && this.wab2DRadio.set("checked", "Web Map" === this._supportedType);
                        this.onLoad()
                    }))
                },
                destroy: function() {
                    c(".dijit", this.contentNode).map(J.byNode).forEach(function(a) {
                        a.destroyRecursive ?
                            a.destroyRecursive() : a.destroy ? a.destroy() : a = null
                    });
                    this.inherited(arguments);
                    this._grid && (this._grid.destroy(), this._grid = null);
                    this._tagsDijit && (this._tagsDijit.destroyRecursive(), this._tagsDijit = null);
                    this._analyzedFile ? C.deleteItem(this._analyzedFile, this._portal).then(e.hitch(this, function(a) { this._tagsDijit = this._portalUser = this._portal = this._analyzedFile = null })) : this._tagsDijit = this._portalUser = this._portal = null;
                    this._errorDlg && (this._errorDlg._dialog && this._errorDlg._dialog.destroyRecursive(),
                        this._errorDlg.destroyRecursive(), this._errorDlg = null)
                },
                startup: function() {
                    this.inherited(arguments);
                    this._initializeCategoryPicker(this.categories || [])
                },
                _initializeCategoryPicker: function(a) {
                    if (Q.self.hasCategorySchema) {
                        var b = function(b) {
                            this._categories = new aa({ categories: a || [], schema: b }, r.create("div", null, this._categoriesContainer));
                            this._categories.startup();
                            Z.showNodes(c(".categories-container", this.domNode));
                            this._initializingCategoryPicker = !1
                        }.bind(this);
                        this.item && this.item.portal && this.item.portal.getCategories &&
                            this.item.portal.getCategories instanceof Function ? (this._initializingCategoryPicker = !0, this.item.portal.getCategories().then(b)) : (this._initializingCategoryPicker = !0, da.request({ url: Q.restBaseUrl + "portals/self/categorySchema" }).then(function(a) { b(a.categorySchema) }.bind(this)))
                    }
                },
                _getWebMapAuthoringInfo: function() { return { authoringApp: "WebMapViewer", authoringAppVersion: da.isPortal() ? "10.6" : "6.1", version: "2.11" } },
                addItem: function() {
                    var a = new E,
                        c, d;
                    this._validate().then(e.hitch(this, function() {
                        q.publish("/esri/disable", !0, ea.addItemFrm.addingItem);
                        if (this._analyzedFile) c = this._updateItem().then(e.hitch(this, function(a) { return a }));
                        else if ("webmap" === this._type) c = this._fetchBaseMap().then(e.hitch(this, function(a) { return d = a })).then(e.hitch(this, "_projectPortalExtent")).then(e.hitch(this, function(a) {
                            var b = this.get("item");
                            b.text = d ? A.stringify(d) : b.text;
                            b.extent = a;
                            return C.addItem(b, this.get("folder"), this._portal)
                        }));
                        else if ("dashboard_map" === this._type) {
                            var f = this.get("item");
                            f.text = v.substitute(f.text, { mapId: this.item.id });
                            c = C.addItem(f, this.get("folder"), this._portal)
                        } else c = C.addItem(this.showFile ? this.get("form") : this.get("item"), this.get("folder"), this._portal);
                        c.then(e.hitch(this, function(b) {
                            q.publish("/esri/disable", !1);
                            a.resolve(b)
                        }), e.hitch(this, function(c) {
                            q.publish("/esri/disable", !1);
                            c && 409 === c.code && (c = this.get("item"), c = { title: ea.addItemFrm.errors.error.title, message: b.substitute({ type: c.type, title: c.title }, ea.addItemFrm.errors.itemExists.message) });
                            a.reject(c)
                        }))
                    }), e.hitch(this, function(b) {
                        q.publish("/esri/disable", !1);
                        a.reject(b)
                    }));
                    return a
                },
                _fetchBaseMap: function() {
                    var a = this._portal && this._portal.defaultBasemap || null,
                        b = this._getWebMapAuthoringInfo(),
                        c, d, f, g, h = function() {
                            f = G.map(a.baseMapLayers || [], e.hitch(this, function(a, b) {
                                d = e.clone(a);
                                d = e.mixin(d, { opacity: 1, layerType: "ArcGISTiledMapServiceLayer", visibility: !0, id: "defaultBasemap_" + b });
                                g = 0 === b ? a.spatialReference || a.resourceInfo && a.resourceInfo.spatialReference : g;
                                delete d.resourceInfo;
                                return d
                            }));
                            return e.mixin({
                                operationalLayers: [],
                                spatialReference: g || this._portal &&
                                    this.portal.defaultExtent && this.portal.defaultExtent.spatialReference,
                                baseMap: e.mixin(a, { baseMapLayers: f })
                            }, b)
                        };
                    a && a.id ? c = z.PortalUtil.request(this._portal.portalUrl + "content/items/" + a.id + "/data").then(e.hitch(this, function(a) { return a }), e.hitch(this, function(a) { return h() })) : a ? (c = new E, c.resolve(h())) : (c = new E, c.resolve());
                    return c
                },
                _projectPortalExtent: function(a) {
                    var b = new E;
                    a = this._portal && this._portal.defaultExtent || null;
                    var c = new ha(a),
                        d = new ia({ wkid: 102100 });
                    a && c.spatialReference.wkid !== d.wkid ?
                        ba(c, d, e.hitch(this, function(a) { a[0] ? b.resolve(C.getPortalDefaultExtentAsGCS({ defaultExtent: a[0] })) : b.resolve(C.getPortalDefaultExtentAsGCS(this._portal)) })) : b.resolve(C.getPortalDefaultExtentAsGCS(this._portal));
                    return b
                },
                _extent2String: function(a, b) {
                    b = b || 4;
                    var c = w.round(a.xmin, b),
                        d = w.round(a.ymin, b),
                        e = w.round(a.xmax, b);
                    a = w.round(a.ymax, b);
                    return isNaN(c) || isNaN(d) || isNaN(e) || isNaN(a) ? "" : c + "," + d + "," + e + "," + a
                },
                _loadConnections: function() {
                    this.own(q.subscribe("/esri/disable", e.hitch(this, function(a) {
                            this.set("readOnly",
                                a)
                        })), c(".dijitTextArea", this.contentNode).on("focus", e.hitch(this, function(a) {
                            a = this._summaryDijit;
                            a.get("value") === ea.publishWizard.summaryPlaceHolder && (D.remove(a.domNode, "dijitPlaceHolder"), a.set("value", ""))
                        })), c(".dijitTextArea", this.contentNode).on("blur", e.hitch(this, function(a) { a = this._summaryDijit; "" === a.get("value") && (D.add(a.domNode, "dijitPlaceHolder"), a.set("value", ea.publishWizard.summaryPlaceHolder)) })), n(this._errorDlg, "hide", e.hitch(this, function() {
                            this._focusNode && setTimeout(e.hitch(this,
                                function() { P.focus(this._focusNode) }), 250)
                        })), n(this._tagsDijitLbl, "click", e.hitch(this, function(a) {
                            this._tagsDijit._inputTextBox.focus();
                            c(".select2-choices", this._tagsDijit.domNode).addClass("focus")
                        })), n(this._tagsDijit.domNode, "focusout", e.hitch(this, function(a) { c(".select2-choices", this._tagsDijit.domNode).removeClass("focus") })), n(this._tagsDijit.domNode, "focusin", e.hitch(this, function(a) {
                            this._tagsDijit._inputTextBox.focus();
                            c(".select2-choices", this._tagsDijit.domNode).addClass("focus")
                        })),
                        n(this._foldersDijitLbl, "click", e.hitch(this, function(a) { this._folders.focus() })))
                },
                _setTitleAttr: function(a) { return this._title.set("value", a || "") },
                _getTitleAttr: function() { return this._title.get("value") },
                _setShowFileAttr: function(a) { a || (c(".file", this.contentNode).style("display", "none"), c(".dijitUploader input", this.contentNode).attr("disabled", "disabled"), this._files.set("disabled", !0)) },
                _setShowUrlAttr: function(a) { a && (c(".url", this.contentNode).removeClass("hide"), this._url.set("disabled", !1)) },
                _setShowFoldersAttr: function(a) { c(".folderDropdown", this.domNode)[a ? "removeClass" : "addClass"]("hide") },
                _setFoldersAttr: function(a) {
                    this._userFolders = a;
                    this._folders.set("options", G.map(a, "return {label:item.title, value:item.id};"));
                    this._folders.set("value", this._selectedFolderId || "/")
                },
                _setShowWABAttr: function(a) { c(".wab", this.domNode)[a ? "removeClass" : "addClass"]("hide") },
                _setMessageAttr: { node: "_message", type: "innerHTML" },
                _setTypeAttr: function(b) { a.set(this._type, "value", b) },
                _setTypeInfoAttr: function(a) {
                    this._type =
                        a
                },
                _setTagsAttr: function(a) { this._tagsDijit.set("value", a || "") },
                _setCategoriesAttr: function(a) {
                    if (Q.self.hasCategorySchema)
                        if (!this._categories || this._initializingCategoryPicker) var b = setInterval(function() { this._categories && !this._initializingCategoryPicker && (clearInterval(b), this._categories.setCategories(a || [], !0)) }.bind(this), 50);
                        else this._categories.setCategories(a || [], !0)
                },
                _setSummaryAttr: function(a) {
                    D[a ? "remove" : "add"](this._summaryDijit.domNode, "dijitPlaceHolder");
                    this._summaryDijit.set("value",
                        a || ea.publishWizard.summaryPlaceHolder);
                    this._summaryDijit.resize()
                },
                _setBatchGeocodersAttr: function(a) {
                    this._geocoders.set("options", a);
                    this._geocoders.set("value", a[0].value, !1);
                    this._batchGeocoders = a;
                    this._selectedGeocoder = a[0]
                },
                _setFocusAttr: function(a) {
                    var b, d = J.byId(this.id + "-" + a);
                    d ? setTimeout(e.hitch(this, function() { d.focus() }), 250) : (b = c(a, this.domNode), setTimeout(e.hitch(this, function() { P.focus(b && b.length ? b[0] : this._title.domNode) }), 250))
                },
                _setDisabledAttr: function(a) { this._disable(a) },
                _setReadOnlyAttr: function(b) {
                    c(".dijit",
                        this.domNode).map(J.byNode).forEach(function(a) { a.set("readOnly", b) });
                    c(".dijitButtonContents", this._files.domNode).forEach(function(c) {
                        a.set(c, "readonly", b);
                        D[b ? "add" : "remove"](c, "dijitDisabled dijitTextBoxDisabled")
                    });
                    D[b ? "add" : "remove"](this._tagsDijit.domNode, "dijitDisabled dijitTextBoxDisabled");
                    c("input", this._tagsDijit.domNode).forEach(function(c) { a.set(c, "readonly", b) });
                    c("a", this.contentNode)[b ? "addClass" : "removeClass"]("disabledLink");
                    c(".dijitSelect .dijitButtonText", this.contentNode)[b ?
                        "addClass" : "removeClass"]("dijitTextBoxDisabled");
                    this._folders.set("disabled", b);
                    this._summaryDijit.set("disabled", b);
                    c(".dijitUploader input", this.contentNode).attr("readonly", "readonly")
                },
                _getFormAttr: function() {
                    var a = this._checkThumbnailURL(e.mixin({}, this.itemInfo[this._type])),
                        b = r.create("div", null, this._form),
                        a = e.mixin(a, { tags: this._tagsDijit.get("tags"), snippet: this._summaryDijit.get("value") !== ea.publishWizard.summaryPlaceHolder ? this._summaryDijit.get("value") : "" }),
                        a = this._adjustItemInfo(a),
                        c;
                    for (c in a) r.place(r.create("input", { name: c, type: "text", value: a[c], "class": "hide" }), b);
                    return d.byId("_createForm")
                },
                _getItemAttr: function() {
                    var a = this._checkThumbnailURL(e.mixin({}, this.itemInfo[this._type])),
                        a = e.mixin(a, { title: this._title.get("value"), tags: this._tagsDijit.get("tags"), snippet: this._summaryDijit.get("value") !== ea.publishWizard.summaryPlaceHolder ? this._summaryDijit.get("value") : "", folderId: this.get("folder"), wabType: "wab" === this._type ? this.get("WABType") : null }),
                        a = this._adjustItemInfo(a);
                    Q.self.hasCategorySchema && this._categories && (a.categories = this._categories.getCategories(!0));
                    this._supportedType && (a = e.mixin(a, { webmap: this.item.id }));
                    return a
                },
                _adjustItemInfo: function(a) {
                    var b = this._type,
                        c = a.text,
                        d = this._portal && this._portal.helperServices || [],
                        d = d.defaultElevationLayers ? e.clone(d.defaultElevationLayers) : [];
                    c && ("webscene" === b || "webscene_portal" === b) && d && d.length && (b = JSON.parse(c), d = d.map(function(a) {
                        a = e.mixin(a, {
                            title: a.title || a.name || "Elevation",
                            id: a.id || a.name || (new Date).getTime() +
                                ""
                        });
                        a.name && delete a.name;
                        return a
                    }), b.baseMap.elevationLayers = d, b.ground.layers = d, a.text = JSON.stringify(b));
                    return a
                },
                _getWABTypeAttr: function() { return this.wab2DRadio.get("checked") ? "HTML" : "HTML3D" },
                _getFolderAttr: function() {
                    var a = this._folders.get("value"),
                        a = this._portalUser ? "/" === a || a === this._portalUser.username ? null : a : "/" === a ? null : a;
                    return this.showFolders ? a : this._selectedFolderId
                },
                _getFolders: function() {
                    var a = new E;
                    this._portalUser.getFolders ? this._portalUser.getFolders().then(e.hitch(this,
                        function(b) { a.resolve({ folders: b }) }), e.hitch(this, function(b) { a.reject(b) })) : ca.getFolders(e.hitch(this, function(b) { a.resolve(b) }), e.hitch(this, function(b) { a.reject(b) }), !1);
                    return a
                },
                _getFileInfo: function(a) {
                    var b = new E,
                        c = /(?:\.([^.]+))?$/;
                    a = a && a.length && a[0] || {};
                    var d = a.name.replace(/^.*(\\|\/|:)/, ""),
                        c = d ? c.exec(d)[1].toLowerCase() : "",
                        f = d ? d.substring(0, d.lastIndexOf(".")) : "";
                    this._isValidFileType(c) || b.reject(ea.addItemFrm.errors.unknownType);
                    window && window.FileReader && a.size > this._maxFileSize &&
                        b.reject(ea.addItemFrm.errors.fileToLarge);
                    b.resolve(e.mixin(a, { title: f, fileType: c, origName: d }));
                    return b
                },
                _deleteAnalyzedFile: function() {
                    var a;
                    this._analyzedFile ? a = C.deleteItem(this._analyzedFile, this._portal).then(e.hitch(this, function() { this._analyzeResult = this._analyzedFile = null })) : (a = new E, a.resolve(!0));
                    return a
                },
                _toOptions: function(a, b) {
                    var c = [];
                    b && (a = e.mixin({}, ea.addItemFrm.notUsed, a));
                    for (var d in a) c.push({ label: a[d], value: d });
                    return c
                },
                _addFile: function() {
                    var a = this.get("form");
                    if (a) return a =
                        C.addItem(a, this.get("folder"), this._portal), a.then(e.hitch(this, function(a) { q.publish("/esri/disable", !1); return a }), e.hitch(this, function(a) {
                            q.publish("/esri/disable", !1);
                            this._showError(a)
                        }))
                },
                _updateItem: function() {
                    var a = this._analyzedFile,
                        b = this.get("item"),
                        c = !1,
                        d;
                    for (d in b) a[d] && a[d] === b[d] ? delete b[d] : c = !0;
                    c ? b = C.updateItem(e.mixin(b, { id: a.id, folderId: a.folderId }), this._portal).then(e.hitch(this, function(b) { return e.mixin(a, b) })) : (b = new E, b.resolve(a));
                    return b
                },
                _getPublishParameters: function(a) {
                    var b =
                        this._geocoder || "none";
                    a = this._getDefaultPublishParameters(a);
                    var c = this._analyzeResult && this._analyzeResult.publishParameters,
                        d = c && c.standardizedFieldNames,
                        f = this._grid && this._grid.store;
                    if (c)
                        if ("addressTypes" === b) {
                            var g = 0,
                                h = {},
                                m = d;
                            f.query(function(a) { "unknown" !== a.locationType && a.locationType in m && (h[a.locationType] = a.name, g++) });
                            if (1 > g) return { error: this.i18n.errors.noAddressFields };
                            a.publishParameters.locationType = "address";
                            a.publishParameters.addressFields = h
                        } else if ("locationTypes" === b) {
                        var n = { locationType: "coordinates", latitudeFieldName: null, longitudeFieldName: null },
                            m = e.mixin({}, this.i18n.addItemFrm[b]);
                        f.query(function(a) { "unknown" !== a.locationType && a.locationType in m && (n[a.locationType + "FieldName"] = a.name) });
                        if (!n.latitudeFieldName || !n.longitudeFieldName) return { error: this.i18n.errors.noLocationFields };
                        e.mixin(a, n)
                    } else a.publishParameters.locationType = "none";
                    return a
                },
                _getDefaultPublishParameters: function(a) {
                    var b = a.type.toLowerCase(),
                        c = { itemId: a.id, filetype: b },
                        d = this._analyzeResult &&
                        this._analyzeResult.publishParameters;
                    "tile package" === b && (c.filetype = "tilePackage", c.buildInitialCache = !0);
                    c.publishParameters = e.mixin(d || {}, { name: a.title.replace(/ /g, "_"), maxRecordCount: 2E3 });
                    d && (c.hasStaticData = !0, c.publishParameters.layerInfo = e.mixin(d.layerInfo || {}, { capabilities: "Query" }), c.publishParameters.persistErrorRecordsForReview = !0);
                    return c
                },
                _analyze: function() {
                    var a = {};
                    q.publish("/esri/disable", !0, "Uploading file...");
                    return this._addFile().then(e.hitch(this, function(b) {
                        q.publish("/esri/disable", !0, "Analyzing file...");
                        this._analyzedFile = b;
                        this._portal._isPortal || !this._selectedGeocoder.isWorldGeocodeServer ? a.geocodeServiceUrl = encodeURI(this._selectedGeocoder) : this._selectedGeocoder.isWorldGeocodeServer && (a.sourceCountry = this._analyzeResult ? this._countries.get("value").toLowerCase() : "", a.sourceCountryHint = this._analyzeResult ? "" : this._sourceCountry);
                        return C.analyzeItem(b, a, this._portal).then(e.hitch(this, function(a) {
                            this._analyzeResult = this._analyzedFile.analyzeResult = a;
                            this._createGrid(a);
                            D.remove(this.geocoding, "hide");
                            q.publish("/esri/disable", !1);
                            return this._analyzedFile
                        }))
                    }))
                },
                _validate: function() {
                    var a = new E,
                        b;
                    b = this._checkRequired(this.get("item"));
                    b = b.then(e.hitch(this, "_itemExists", this.get("item")));
                    b = b.then(e.hitch(this, function(b) { a.resolve(b) }), e.hitch(this, function(b) {
                        this._focusNode && P.focus(this._focusNode);
                        a.reject(b)
                    }));
                    return a
                },
                _isValidFileType: function(a) {
                    var b = !0;
                    this.showFile && this.validTypes ? (this.validTypes = this.validTypes instanceof Array ? this.validTypes : [this.validTypes], -1 === G.indexOf(this.validTypes, a) && (b = !1)) : this.itemInfo[type.toLowerCase()] || (b = !1);
                    return b
                },
                _checkThumbnailURL: function(a) { this.item && this.item.thumbnail && this.item.thumbnailUrl ? a.thumbnailUrl = this.item.thumbnailUrl : (a.thumbnailURL && (a.thumbnailURL = da.getStaticImagesUrl() + a.thumbnailURL), this._portal.isPortal && a.thumbnailURL && 0 !== a.thumbnailURL.indexOf("http") && (a.thumbnailURL = window.location.protocol + "//" + window.location.host + a.thumbnailURL)); return a },
                _isEmpty: function(a) {
                    return (this.trim ?
                        /^\s*$/ : /^$/).test(a)
                },
                _disable: function(a) {
                    this._folders.set("disabled", a);
                    this._summaryDijit.set("disabled", a);
                    !this.showFiles && a && c(".dijitUploader input", this.contentNode).attr("disabled", "disabled")
                },
                _loadFolders: function(a, b) {
                    var c = F("ESRI_Content"),
                        c = c ? A.parse(c) : {},
                        d = c.folderId || null;
                    this._selectedFolderId = c.folderId || null;
                    (!a || !a.length || a && a.length && a[0].title !== this._portalUser.username) && a.unshift({ title: this._portalUser.username, id: "/" });
                    b.options = G.map(a, "return {label:item.title, value:item.id};");
                    b.set("value", d || this._portalUser.username)
                },
                _loadCountries: function(a, b) {
                    var c = this._portal.getPortalUser(),
                        d = [],
                        c = (this._portal.region || c.region || portal.ipCntryCode || "world").toLowerCase(),
                        c = "wo" === c ? "world" : c,
                        e;
                    for (e in a) d.push({ label: a[e], value: e.toLowerCase() });
                    d = d.sort(function(a, b) { return a.label < b.label ? -1 : a.label > b.label ? 1 : 0 });
                    b.set("options", d);
                    b.set("value", c, !1);
                    this._sourceCountry = c
                },
                _checkRequired: function() {
                    var a = new E,
                        b, d;
                    c(".required", this.contentNode).map(J.byNode).every(e.hitch(this,
                        function(a) { return !D.contains(a.domNode, "hide") && this._isEmpty(a.get("value")) ? (d = a.domNode || a, this._focusNode = c("input", d)[0], b = e.mixin({}, ea.publishWizard.errors.error, ea.publishWizard.errors.required[a.get("name")]), !1) : !0 }));
                    b ? a.reject(b) : a.resolve(!0);
                    return a
                },
                _itemExists: function(a) {
                    var d = new E,
                        e = this._type in { mapserver: 1, featureserver: 1, sceneserver: 1, wfs: 1, vectortileserver: 1, imageserver: 1 },
                        f = "wfs" === this._type ? /[.@#%&*+=\-\\';,\/|\\":<>()\?]/g.test(a.title) : e ? /[.@#%&*+=\-\\';,\/|\\":<>\?]/g.test(a.title) :
                        /[<>]/g.test(a.title),
                        g = a.title.match(/^\d/) ? !0 : !1,
                        h = this.itemInfo[a.type.toLowerCase()] ? this.itemInfo[a.type.toLowerCase()].type : a.type;
                    this._itemExistsCheck(a).then(function(m) {
                        f || e && 120 < a.title.length ? (this._focusNode = c("input", this._title.domNode)[0], d.reject(e ? ea.addItemFrm.errors.invalidServiceTitle : ea.addItemFrm.errors.invalidItemTitle)) : "wfs" === this._type && g ? d.reject(ea.addItemFrm.errors.invalidCharactersStartsWithNumber) : m ? (this._focusNode = c("input", this._title.domNode)[0], m = b.substitute({
                            type: h,
                            title: a.title
                        }, ea.addItemFrm.errors.itemExists.message), d.reject({ title: ea.addItemFrm.errors.error.title, message: m })) : d.resolve(!1)
                    }.bind(this));
                    return d
                },
                _itemExistsCheck: function(a) {
                    var b = a.title,
                        c = this.get("folder"),
                        d = this.itemInfo[a.type.toLowerCase()] ? this.itemInfo[a.type.toLowerCase()].type : a.type,
                        e = this._portalUser.username,
                        f = new dojo.Deferred;
                    da.request({ url: Q.restBaseUrl + "search", content: { q: 'title:"' + b + '" AND type:"' + d + '" AND owner:"' + e + '" AND ownerfolder:"' + (c && "/" !== c ? c : "root") + '"', num: 1 } }).then(dojo.hitch(this,
                        function(b) { b && b.total ? f.resolve(this._isSameTitle(a, b.results.shift())) : f.resolve(!1) }));
                    return f
                },
                _isSameTitle: function(a, b) { return (a && a.title) === (b && b.title) },
                _showError: function(a) {
                    a.messageCode && "GWM_0011" === a.messageCode && (a = e.mixin(a, { message: ea.common.errors.spamContentItemCreate }));
                    a = e.mixin(e.mixin({}, ea.publishWizard.errors.error), a);
                    this._errorDlg.show(a);
                    this._disable(!1);
                    return !1
                }
            })
        })
}, "dojox/form/Uploader": function() {
    define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E, G, F) {
            return g("dojox.form.Uploader", [t, w, x, B, E], {
                uploadOnSelect: !1,
                tabIndex: 0,
                multiple: !1,
                label: G.label,
                url: "",
                name: "uploadedfile",
                flashFieldName: "",
                force: "",
                uploadType: "",
                showInput: "",
                focusedClass: "dijitButtonHover",
                _nameIndex: 0,
                templateString: F,
                baseClass: "dijitUploader " + w.prototype.baseClass,
                postMixInProperties: function() {
                    this._inputs = [];
                    this._cons = [];
                    this.force = this.force.toLowerCase();
                    this.supports("multiple") ? this.uploadType = "form" === this.force ? "form" :
                        "html5" : this.uploadType = "flash" === this.force ? "flash" : "iframe";
                    this.inherited(arguments)
                },
                buildRendering: function() {
                    this.inherited(arguments);
                    f.set(this.domNode, { overflow: "hidden", position: "relative" });
                    this._buildDisplay();
                    m.set(this.titleNode, "tabIndex", -1)
                },
                _buildDisplay: function() {
                    this.showInput && (this.displayInput = p.create("input", { "class": "dijitUploadDisplayInput", tabIndex: -1, autocomplete: "off", role: "presentation" }, this.containerNode, this.showInput), this._attachPoints.push("displayInput"), this.connect(this,
                        "onChange",
                        function(a) {
                            for (var b = 0, c, d = []; c = a[b++];) c && c.name && d.push(c.name);
                            this.displayInput.value = d.join(", ")
                        }), this.connect(this, "reset", function() { this.displayInput.value = "" }))
                },
                startup: function() { this._buildInitialized || (this._buildInitialized = !0, this._getButtonStyle(this.domNode), this._setButtonStyle(), this.inherited(arguments)) },
                onChange: function(a) {},
                onBegin: function(a) {},
                onProgress: function(a) {},
                onComplete: function(a) { this.reset() },
                onCancel: function() {},
                onAbort: function() {},
                onError: function(a) {},
                upload: function(a) {
                    a = a || {};
                    a.uploadType = this.uploadType;
                    this.inherited(arguments)
                },
                submit: function(a) {
                    a = a ? a.tagName ? a : this.getForm() : this.getForm();
                    a = r.toObject(a);
                    a.uploadType = this.uploadType;
                    this.upload(a)
                },
                reset: function() {
                    delete this._files;
                    this._disconnectButton();
                    a.forEach(this._inputs, p.destroy);
                    this._inputs = [];
                    this._nameIndex = 0;
                    this._createInput()
                },
                getFileList: function() {
                    var b = [];
                    this.supports("multiple") ? a.forEach(this._files, function(a, c) { b.push({ index: c, name: a.name, size: a.size, type: a.type }) },
                        this) : a.forEach(this._inputs, function(a, c) { a.value && b.push({ index: c, name: a.value.substring(a.value.lastIndexOf("\\") + 1), size: 0, type: a.value.substring(a.value.lastIndexOf(".") + 1) }) }, this);
                    return b
                },
                _getValueAttr: function() { return this.getFileList() },
                _setValueAttr: function(a) {},
                _setDisabledAttr: function(a) { this.disabled != a && this.inputNode && (this.inherited(arguments), f.set(this.inputNode, "display", a ? "none" : "")) },
                _getButtonStyle: function(a) { this.btnSize = { w: f.get(a, "width"), h: f.get(a, "height") } },
                _setButtonStyle: function() {
                    this.inputNodeFontSize =
                        Math.max(2, Math.max(Math.ceil(this.btnSize.w / 60), Math.ceil(this.btnSize.h / 15)));
                    this._createInput()
                },
                _getFileFieldName: function() { return this.supports("multiple") && this.multiple ? this.name + "s[]" : this.name + (this.multiple ? this._nameIndex : "") },
                _createInput: function() {
                    this._inputs.length && (f.set(this.inputNode, { top: "500px" }), this._disconnectButton(), this._nameIndex++);
                    var a = this._getFileFieldName();
                    this.focusNode = this.inputNode = p.create("input", { type: "file", name: a, "aria-labelledby": this.id + "_label" }, this.domNode,
                        "first");
                    this.supports("multiple") && this.multiple && m.set(this.inputNode, "multiple", !0);
                    this._inputs.push(this.inputNode);
                    f.set(this.inputNode, { position: "absolute", fontSize: this.inputNodeFontSize + "em", top: "-3px", right: "-3px", opacity: 0 });
                    this._connectButton()
                },
                _connectButton: function() {
                    this._cons.push(c.connect(this.inputNode, "change", this, function(a) {
                        this._files = this.inputNode.files;
                        this.onChange(this.getFileList(a));
                        !this.supports("multiple") && this.multiple && this._createInput()
                    })); - 1 < this.tabIndex &&
                        (this.inputNode.tabIndex = this.tabIndex, this._cons.push(c.connect(this.inputNode, "focus", this, function() { e.add(this.domNode, this.focusedClass) })), this._cons.push(c.connect(this.inputNode, "blur", this, function() { e.remove(this.domNode, this.focusedClass) })))
                },
                _disconnectButton: function() {
                    a.forEach(this._cons, c.disconnect);
                    this._cons.splice(0, this._cons.length)
                }
            })
        })
}, "dojox/form/uploader/_Base": function() {
    define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
        function(b, g, n, a, c, d, f, e, h, m) {
            c.add("FormData", function() { return !!window.FormData });
            c.add("xhr-sendAsBinary", function() { var a = window.XMLHttpRequest && new window.XMLHttpRequest; return a && !!a.sendAsBinary });
            c.add("file-multiple", function() { return !!{ "true": 1, "false": 1 }[a.get(document.createElement("input", { type: "file" }), "multiple")] });
            return d("dojox.form.uploader._Base", [e, h, m], {
                getForm: function() {
                    if (!this.form)
                        for (var a = this.domNode; a && a.tagName && a !== document.body;) {
                            if ("form" == a.tagName.toLowerCase()) {
                                this.form =
                                    a;
                                break
                            }
                            a = a.parentNode
                        }
                    return this.form
                },
                getUrl: function() {
                    this.uploadUrl && (this.url = this.uploadUrl);
                    if (this.url) return this.url;
                    this.getForm() && (this.url = this.form.action);
                    return this.url
                },
                connectForm: function() {
                    this.url = this.getUrl();
                    !this._fcon && this.getForm() && (this._fcon = !0, this.connect(this.form, "onsubmit", function(a) {
                        f.stop(a);
                        this.submit(this.form)
                    }))
                },
                supports: function(a) {
                    switch (a) {
                        case "multiple":
                            if ("flash" == this.force || "iframe" == this.force) break;
                            return c("file-multiple");
                        case "FormData":
                            return c(a);
                        case "sendAsBinary":
                            return c("xhr-sendAsBinary")
                    }
                    return !1
                },
                getMimeType: function() { return "application/octet-stream" },
                getFileType: function(a) { return a.substring(a.lastIndexOf(".") + 1).toUpperCase() },
                convertBytes: function(a) {
                    var b = Math.round(a / 1024 * 1E5) / 1E5,
                        c = Math.round(a / 1048576 * 1E5) / 1E5,
                        d = Math.round(a / 1073741824 * 1E5) / 1E5,
                        e = a;
                    1 < b && (e = b.toFixed(1) + " kb");
                    1 < c && (e = c.toFixed(1) + " mb");
                    1 < d && (e = d.toFixed(1) + " gb");
                    return { kb: b, mb: c, gb: d, bytes: a, value: e }
                }
            })
        })
}, "dojox/form/uploader/_HTML5": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo dojo/request dojo/has".split(" "),
        function(b, g, n, a, c, d) {
            return b("dojox.form.uploader._HTML5", [], {
                errMsg: "Error uploading files. Try checking permissions",
                uploadType: "html5",
                postMixInProperties: function() { this.inherited(arguments) },
                postCreate: function() {
                    this.connectForm();
                    this.inherited(arguments);
                    this.uploadOnSelect && this.connect(this, "onChange", function(a) { this.upload(a[0]) })
                },
                _drop: function(b) {
                    a.stopEvent(b);
                    this._files = b.dataTransfer.files;
                    this.onChange(this.getFileList())
                },
                upload: function(a) {
                    this.onBegin(this.getFileList());
                    this.uploadWithFormData(a)
                },
                addDropTarget: function(b, c) {
                    c || (this.connect(b, "dragenter", a.stopEvent), this.connect(b, "dragover", a.stopEvent), this.connect(b, "dragleave", a.stopEvent));
                    this.connect(b, "drop", "_drop")
                },
                uploadWithFormData: function(a) {
                    function b(a) { r._xhrProgress(a); "load" === a.type && (r.onComplete(v.response.data), v.response.xhr.removeEventListener("load", b, !1), v.response.xhr.upload.removeEventListener("progress", b, !1), v = null) }
                    if (this.getUrl()) {
                        var f = new FormData,
                            g = this._getFileFieldName();
                        n.forEach(this._files, function(a, b) { f.append(g, a) }, this);
                        if (a) { a.uploadType = this.uploadType; for (var p in a) f.append(p, a[p]) }
                        var r = this,
                            v = c(this.getUrl(), { method: "POST", data: f, handleAs: "json", uploadProgress: !0, headers: { Accept: "application/json" } }, !0);
                        v.promise.response.otherwise(function(a) { r.onError(a) });
                        d("native-xhr2") ? (v.response.xhr.addEventListener("load", b, !1), v.response.xhr.upload.addEventListener("progress", b, !1)) : v.promise.then(function(a) { r.onComplete(a) })
                    }
                },
                _xhrProgress: function(a) {
                    if (a.lengthComputable) {
                        var b = { bytesLoaded: a.loaded, bytesTotal: a.total, type: a.type, timeStamp: a.timeStamp };
                        "load" == a.type ? (b.percent = "100%", b.decimal = 1) : (b.decimal = a.loaded / a.total, b.percent = Math.ceil(a.loaded / a.total * 100) + "%");
                        this.onProgress(b)
                    }
                }
            })
        })
}, "dojox/form/uploader/_IFrame": function() {
    define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "), function(b, g, n, a, c, d, f) {
        return n("dojox.form.uploader._IFrame", [], {
            postMixInProperties: function() {
                this.inherited(arguments);
                "iframe" === this.uploadType && (this.uploadType = "iframe", this.upload = this.uploadIFrame)
            },
            uploadIFrame: function(a) {
                var b = {},
                    d;
                this.getForm();
                var e = this.getUrl(),
                    n = this;
                a = a || {};
                a.uploadType = this.uploadType;
                d = g.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e', this.domNode);
                c.forEach(this._inputs, function(a, c) { "" !== a.value && (d.appendChild(a), b[a.name] = a.value) }, this);
                if (a)
                    for (nm in a) void 0 === b[nm] && g.create("input", { name: nm, value: a[nm], type: "hidden" }, d);
                f.post(e, {
                    form: d,
                    handleAs: "json",
                    content: a
                }).then(function(a) {
                    g.destroy(d);
                    if (a.ERROR || a.error) n.onError(a);
                    else n.onComplete(a)
                }, function(a) {
                    g.destroy(d);
                    n.onError(a)
                })
            }
        })
    })
}, "dojox/form/uploader/_Flash": function() {
    define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "), function(b, g, n, a, c, d, f, e, h, m) {
        return c("dojox.form.uploader._Flash", [], {
            swfPath: d.uploaderPath || require.toUrl("dojox/form/resources/uploader.swf"),
            preventCache: !0,
            skipServerCheck: !0,
            serverTimeout: 2E3,
            isDebug: !1,
            devMode: !1,
            deferredUploading: 0,
            postMixInProperties: function() {
                "flash" === this.uploadType && (this._files = [], this._fileMap = {}, this._createInput = this._createFlashUploader, this.getFileList = this.getFlashFileList, this.reset = this.flashReset, this.upload = this.uploadFlash, this.fieldname = "flashUploadFiles");
                this.inherited(arguments)
            },
            onReady: function(a) {},
            onLoad: function(a) {},
            onFileChange: function(a) {},
            onFileProgress: function(a) {},
            getFlashFileList: function() { return this._files },
            flashReset: function() {
                this.flashMovie.reset();
                this._files = [];
                this._fileMap = {}
            },
            uploadFlash: function(a) {
                this.onBegin(this.getFileList());
                a = a || {};
                a.returnType = "F";
                a.uploadType = this.uploadType;
                this.flashMovie.doUpload(a)
            },
            _change: function(a) {
                this._files = this._files.concat(a);
                h.forEach(a, function(a) {
                    a.bytesLoaded = 0;
                    a.bytesTotal = a.size;
                    this._fileMap[a.name + "_" + a.size] = a
                }, this);
                this.onChange(this._files);
                this.onFileChange(a)
            },
            _complete: function(a) {
                this._getCustomEvent().type = "load";
                this.onComplete(a)
            },
            _progress: function(a) {
                this._fileMap[a.name + "_" + a.bytesTotal].bytesLoaded = a.bytesLoaded;
                var b = this._getCustomEvent();
                this.onFileProgress(a);
                this.onProgress(b)
            },
            _error: function(a) { this.onError(a) },
            _onFlashBlur: function(a) {},
            _getCustomEvent: function() {
                var a = { bytesLoaded: 0, bytesTotal: 0, type: "progress", timeStamp: (new Date).getTime() },
                    b;
                for (b in this._fileMap) a.bytesTotal += this._fileMap[b].bytesTotal, a.bytesLoaded += this._fileMap[b].bytesLoaded;
                a.decimal = a.bytesLoaded / a.bytesTotal;
                a.percent = Math.ceil(a.bytesLoaded /
                    a.bytesTotal * 100) + "%";
                return a
            },
            _connectFlash: function() {
                this._subs = [];
                this._cons = [];
                var b = e.hitch(this, function(a, b) { this._subs.push(f.subscribe(this.id + a, this, b)) });
                b("/filesSelected", "_change");
                b("/filesUploaded", "_complete");
                b("/filesProgress", "_progress");
                b("/filesError", "_error");
                b("/filesCanceled", "onCancel");
                b("/stageBlur", "_onFlashBlur");
                this.connect(this.domNode, "focus", function() {
                    this.flashMovie.focus();
                    this.flashMovie.doFocus()
                });
                0 <= this.tabIndex && a.set(this.domNode, "tabIndex", this.tabIndex)
            },
            _createFlashUploader: function() {
                var a = this.btnSize.w,
                    b = this.btnSize.h;
                if (a) {
                    var c = this.getUrl();
                    if (c && 0 > c.toLowerCase().indexOf("http") && 0 != c.indexOf("/")) {
                        var d = window.location.href.split("/");
                        d.pop();
                        d = d.join("/") + "/";
                        c = d + c
                    }
                    this.inputNode = n.create("div", { className: "dojoxFlashNode" }, this.domNode, "first");
                    g.set(this.inputNode, { position: "absolute", top: "-2px", width: a + "px", height: b + "px", opacity: 0 });
                    a = {
                        expressInstall: !0,
                        path: (this.swfPath.uri || this.swfPath) + (this.preventCache ? "?cb_" + (new Date).getTime() :
                            ""),
                        width: a,
                        height: b,
                        allowScriptAccess: "always",
                        allowNetworking: "all",
                        vars: { uploadDataFieldName: this.flashFieldName || this.name + "Flash", uploadUrl: c, uploadOnSelect: this.uploadOnSelect, deferredUploading: this.deferredUploading || 0, selectMultipleFiles: this.multiple, id: this.id, isDebug: this.isDebug, noReturnCheck: this.skipServerCheck, serverTimeout: this.serverTimeout },
                        params: { scale: "noscale", wmode: "opaque", allowScriptAccess: "always", allowNetworking: "all" }
                    };
                    this.flashObject = new m(a, this.inputNode);
                    this.flashObject.onError =
                        e.hitch(function(a) {});
                    this.flashObject.onReady = e.hitch(this, function() { this.onReady(this) });
                    this.flashObject.onLoad = e.hitch(this, function(a) {
                        this.flashMovie = a;
                        this.flashReady = !0;
                        this.onLoad(this)
                    });
                    this._connectFlash()
                } else setTimeout(dojo.hitch(this, function() {
                    this._getButtonStyle(this.domNode);
                    this._createFlashUploader()
                }), 200)
            }
        })
    })
}, "dojox/embed/Flash": function() {
    define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
        function(b, g, n, a, c, d, f, e, h) {
            function m(a) { a = b.delegate(w, a); if (!("path" in a)) return null; "id" in a || (a.id = "dojox-embed-flash-" + v++); return a }
            var p, r, v = 0,
                w = { expressInstall: !1, width: 320, height: 240, swLiveConnect: "true", allowScriptAccess: "sameDomain", allowNetworking: "all", style: null, redirect: null };
            c("ie") ? (p = function(a) {
                a = m(a);
                if (!a) return null;
                var b, c = a.path;
                if (a.vars) {
                    var d = [];
                    for (b in a.vars) d.push(encodeURIComponent(b) + "\x3d" + encodeURIComponent(a.vars[b]));
                    a.params.FlashVars = d.join("\x26");
                    delete a.vars
                }
                c =
                    '\x3cobject id\x3d"' + h.escape(String(a.id)) + '" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"' + h.escape(String(a.width)) + '" height\x3d"' + h.escape(String(a.height)) + '"' + (a.style ? ' style\x3d"' + h.escape(String(a.style)) + '"' : "") + '\x3e\x3cparam name\x3d"movie" value\x3d"' + h.escape(String(c)) + '" /\x3e';
                if (a.params)
                    for (b in a.params) c += '\x3cparam name\x3d"' + h.escape(b) + '" value\x3d"' + h.escape(String(a.params[b])) + '" /\x3e';
                return { id: a.id, markup: c + "\x3c/object\x3e" }
            }, r = function() {
                for (var a =
                        10, b = null; !b && 7 < a;) try { b = new ActiveXObject("ShockwaveFlash.ShockwaveFlash." + a--) } catch (E) {}
                return b ? (a = b.GetVariable("$version").split(" ")[1].split(","), { major: null != a[0] ? parseInt(a[0]) : 0, minor: null != a[1] ? parseInt(a[1]) : 0, rev: null != a[2] ? parseInt(a[2]) : 0 }) : { major: 0, minor: 0, rev: 0 }
            }(), g.addOnWindowUnload(function() {
                var b = function() {};
                a("object").reverse().style("display", "none").forEach(function(a) {
                    for (var c in a)
                        if ("FlashVars" != c && "function" == typeof a[c]) try { a[c] = b } catch (G) {}
                })
            })) : (p = function(a) {
                a =
                    m(a);
                if (!a) return null;
                var b, c = a.path;
                if (a.vars) {
                    var d = [];
                    for (b in a.vars) d.push(encodeURIComponent(b) + "\x3d" + encodeURIComponent(a.vars[b]));
                    a.params.flashVars = d.join("\x26");
                    delete a.vars
                }
                c = '\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"' + h.escape(String(c)) + '" id\x3d"' + h.escape(String(a.id)) + '" width\x3d"' + h.escape(String(a.width)) + '" height\x3d"' + h.escape(String(a.height)) + '"' + (a.style ? ' style\x3d"' + h.escape(String(a.style)) + '" ' : "") + 'pluginspage\x3d"' + window.location.protocol + '//www.adobe.com/go/getflashplayer" ';
                if (a.params)
                    for (b in a.params) c += " " + h.escape(b) + '\x3d"' + h.escape(String(a.params[b])) + '"';
                return { id: a.id, markup: c + " /\x3e" }
            }, r = function() { var a = navigator.plugins["Shockwave Flash"]; return a && a.description ? (a = a.description.replace(/([a-zA-Z]|\s)+/, "").replace(/(\s+r|\s+b[0-9]+)/, ".").split("."), { major: null != a[0] ? parseInt(a[0]) : 0, minor: null != a[1] ? parseInt(a[1]) : 0, rev: null != a[2] ? parseInt(a[2]) : 0 }) : { major: 0, minor: 0, rev: 0 } }());
            var t = function(a, c) {
                if (-1 < location.href.toLowerCase().indexOf("file://")) throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
                this.available = r.major;
                this.minimumVersion = a.minimumVersion || 9;
                this.domNode = this.movie = this.id = null;
                c && (c = d.byId(c));
                setTimeout(b.hitch(this, function() {
                        if (a.expressInstall || this.available && this.available >= this.minimumVersion)
                            if (a && c) this.init(a, c);
                            else this.onError("embed.Flash was not provided with the proper arguments.");
                        else if (this.available) this.onError("Flash version detected: " + this.available + " is out of date. Minimum required: " + this.minimumVersion);
                        else this.onError("Flash is not installed.")
                    }),
                    100)
            };
            b.extend(t, {
                onReady: function(a) {},
                onLoad: function(a) {},
                onError: function(a) {},
                _onload: function() {
                    clearInterval(this._poller);
                    delete this._poller;
                    delete this._pollCount;
                    delete this._pollMax;
                    this.onLoad(this.movie)
                },
                init: function(a, c) {
                    this.destroy();
                    c = d.byId(c || this.domNode);
                    if (!c) throw Error("dojox.embed.Flash: no domNode reference has been passed.");
                    var e = 0;
                    this._poller = null;
                    this._pollCount = 0;
                    this._pollMax = 15;
                    this.pollTime = 100;
                    t.initialized && (this.id = t.place(a, c), this.domNode = c, setTimeout(b.hitch(this,
                        function() {
                            this.movie = this.byId(this.id, a.doc);
                            this.onReady(this.movie);
                            this._poller = setInterval(b.hitch(this, function() {
                                try { e = this.movie.PercentLoaded() } catch (G) {}
                                if (100 == e) this._onload();
                                else if (0 == e && this._pollCount++ > this._pollMax) throw clearInterval(this._poller), Error("Building SWF failed.");
                            }), this.pollTime)
                        }), 1))
                },
                _destroy: function() {
                    try { this.domNode.removeChild(this.movie) } catch (x) {}
                    this.id = this.movie = this.domNode = null
                },
                destroy: function() {
                    if (this.movie) {
                        var a = b.delegate({
                                id: !0,
                                movie: !0,
                                domNode: !0,
                                onReady: !0,
                                onLoad: !0
                            }),
                            c;
                        for (c in this) a[c] || delete this[c];
                        this._poller ? f(this, "Load", this, "_destroy") : this._destroy()
                    }
                },
                byId: function(a, b) { b = b || document; return b.embeds[a] ? b.embeds[a] : b[a] ? b[a] : window[a] ? window[a] : document[a] ? document[a] : null }
            });
            b.mixin(t, {
                minSupported: 8,
                available: r.major,
                supported: r.major >= r.required,
                minimumRequired: r.required,
                version: r,
                initialized: !1,
                onInitialize: function() { t.initialized = !0 },
                __ie_markup__: function(a) { return p(a) },
                proxy: function(a, c) {
                    n.forEach(c instanceof Array ?
                        c : [c],
                        function(a) { this[a] = b.hitch(this, function() { return function() { return eval(this.movie.CallFunction('\x3cinvoke name\x3d"' + a + '" returntype\x3d"javascript"\x3e\x3carguments\x3e' + n.map(arguments, function(a) { return __flash__toXML(a) }).join("") + "\x3c/arguments\x3e\x3c/invoke\x3e")) }.apply(this, arguments || []) }) }, a)
                }
            });
            t.place = function(a, b) {
                a = p(a);
                b = d.byId(b);
                b || (b = e.doc.createElement("div"), b.id = a.id + "-container", e.body().appendChild(b));
                return a ? (b.innerHTML = a.markup, a.id) : null
            };
            t.onInitialize();
            b.setObject("dojox.embed.Flash", t);
            return t
        })
}, "dijit/ConfirmDialog": function() { define(["dojo/_base/declare", "./Dialog", "./_ConfirmDialogMixin"], function(b, g, n) { return b("dijit.ConfirmDialog", [g, n], {}) }) }, "dijit/_ConfirmDialogMixin": function() {
    define(["dojo/_base/declare", "./_WidgetsInTemplateMixin", "dojo/i18n!./nls/common", "dojo/text!./templates/actionBar.html", "./form/Button"], function(b, g, n, a) {
        return b("dijit._ConfirmDialogMixin", g, {
            actionBarTemplate: a,
            buttonOk: n.buttonOk,
            _setButtonOkAttr: {
                node: "okButton",
                attribute: "label"
            },
            buttonCancel: n.buttonCancel,
            _setButtonCancelAttr: { node: "cancelButton", attribute: "label" }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin": function() {
    define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/dom-form dojo/io-query dojo/json dojo/Deferred dojo/promise/all esri/lang arcgisonline/esriGeowConfig arcgisonline/pages/utils/categories arcgisonline/sharing/util esri/geometry/webMercatorUtils esri/geometry/Extent arcgisonline/sharing/dijit/Role arcgisonline/pages/statusUtil dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p, r, v, w, t, x, B, E) {
            return {
                addItem: function(a, b, d, h) {
                    var m = d && d.getPortalUser(),
                        n = b && "/" !== b ? b : "",
                        r = a instanceof FormData,
                        t = { url: (d && d.portalUrl) + "content/users/" + (h || m.username) + (n ? "/" + n : "") + "/addItem" };
                    b = a && ("FORM" === a.tagName || "FORM" === a.nodeName || r) ? "form" : "content";
                    var w, x, A, B = new e;
                    t[b] = a;
                    p.self.hasCategorySchema && t[b].categories && (r ? t[b].categories.value = f.stringify(t[b].categories) : t[b].categories = f.stringify(t[b].categories));
                    v.request(t, { usePost: !0 }).then(g.hitch(this,
                        function(b) {
                            if (r)
                                if (a.keys)
                                    for (A = a.keys(), w = {}; !(x = A.next()).done;) "file" !== x.value && (w[x.value] = a.get(x.value));
                                else w = b;
                            else w = t.form ? c.toObject(a) : a;
                            w.title = g.isArray(w.title) ? w.title[0] : w.title;
                            w = g.mixin(b, w, { folderId: n });
                            B.resolve(w)
                        }), function(a) { B.reject(a) });
                    return B
                },
                updateItem: function(a, b) {
                    var c = b && b.getPortalUser();
                    b = (b && b.portalUrl) + "content/users/" + (a.owner || c.username) + (a.folderId && "/" !== a.folderId ? "/" + a.folderId : "") + "/items/" + a.id + "/update";
                    var c = g.mixin({}, a),
                        d = new e;
                    delete c.owner;
                    p.self.hasCategorySchema && c.categories && (c.categories = f.stringify(c.categories));
                    v.request({ url: b, content: c }, { usePost: !0 }).then(g.hitch(this, function(b) { d.resolve(a) }), function(a) { d.reject(a) });
                    return d
                },
                setCategories: function(a, b) {!a.categories || b && 0 !== b.length || (b = a.categories); return r.setItemCategories([a.id], b) },
                addItemResource: function(a, b, c) {
                    var d = b && b.getPortalUser();
                    return v.request({
                        url: (b && b.portalUrl) + "content/users/" + (a.owner || d.username) + (a.folderId && "/" !== a.folderId ? "/" + a.folderId :
                            "") + "/items/" + a.id + "/addResources",
                        content: c
                    }, { usePost: !0 }).then(g.hitch(this, function(a) { return a }))
                },
                getCloudProviderItemResource: function(a) { return v.request({ url: p.restBaseUrl + "content/items/" + a.id + "/resources/cloudProvider.json" }).then(g.hitch(this, function(a) { return a })) },
                getPublishParametersForOverwrite: function(a, b) {
                    var c = new e;
                    this._fetchPublishParameters(a, b).then(g.hitch(this, function(d) {
                        this._fetchServiceInfo(a).then(g.hitch(this, function(e) {
                            var f = "";
                            "CSV" == b ? (f = g.mixin(g.mixin({}, e.layers &&
                                e.layers[0]), { fields: d.layerInfo.fields }), f = g.mixin(d, { layerInfo: f, name: d.name || a.title.replace(/ /g, "_") })) : f = "Microsoft Excel" == b ? this._generateExcelOverwritePublishParameters(d, e) : { name: a.title ? a.title.replace(/ /g, "_") : this.item.title.replace(/ /g, "_") };
                            f = e ? g.mixin(f, e) : f;
                            c.resolve(f)
                        }), g.hitch(this, function(a) { c.reject(a) }))
                    }), g.hitch(this, function(a) { c.reject(a) }));
                    return c
                },
                _fetchPublishParameters: function(a, b) {
                    a = p.restBaseUrl + "content/items/" + a.id + "/info/publishParameters.json";
                    !b || "CSV" !==
                        b && "Microsoft Excel" !== b ? (b = new e, b.resolve(!1)) : b = v.request({ url: a }).then(g.hitch(this, function(a) { return a }));
                    return b
                },
                _fetchServiceInfo: function(b) {
                    b = b.url;
                    var c = { addToken: (v.isHostedService(b) || v.isAgolService(b)) && !1 !== p.isMultiTenant },
                        d = new e,
                        f;
                    h([v.request({ url: b }, c), v.request({ url: b + "/layers" }, c)]).then(g.hitch(this, function(b) {
                        var c = {},
                            e = b && 1 < b.length && b[1],
                            h = e && e.layers,
                            e = e && e.tables;
                        h && h.length && (a.forEach(h, function(a) { delete a.fields }), c.layers = h);
                        e && e.length && (c.tables = e);
                        f = g.mixin(b[0],
                            c);
                        d.resolve(f)
                    }));
                    return d
                },
                _generateExcelOverwritePublishParameters: function(a, b) {
                    b.name = a.name;
                    b.sourceSR = a.sourceSR;
                    b.targetSR = a.targetSR;
                    for (var c = 0; c < b.tables.length; c++) "Review" != b.tables[c].name && (b.layers[b.layers.length] = b.tables[c]);
                    for (c = 0; c < b.layers.length; c++) b.layers[c].excelSheetId = a.layers[c].excelSheetId, b.layers[c].locationType = a.layers[c].locationType, b.layers[c].latitudeFieldName = a.layers[c].latitudeFieldName, b.layers[c].longitudeFieldName = a.layers[c].longitudeFieldName, b.layers[c].geocodeServiceUrl =
                        a.layers[c].geocodeServiceUrl, b.layers[c].sourceLocale = a.layers[c].sourceLocale, b.layers[c].sourceCountry = a.layers[c].sourceCountry, b.layers[c].standardizedFieldNames = a.layers[c].standardizedFieldNames, b.layers[c].addressFields = a.layers[c].addressFields;
                    return b
                },
                deleteItem: function(a, b) { a = (b && b.getPortalUser()).userContentUrl + (a.folderId && "/" !== a.folderId ? "/" + a.folderId : "") + "/items/" + a.id + "/delete"; return v.request({ url: a }, { usePost: !0 }) },
                publishItem: function(a, b, c) {
                    var d = (c && c.getPortalUser()).username;
                    c = (c && c.portalUrl) + "content/users/" + d + (a.folderId && "/" !== a.folderId ? "/" + a.folderId : "") + "/publish";
                    var m = new e;
                    b.publishParameters = f.stringify(b.publishParameters);
                    v.request({ url: c, content: b }, { usePost: !0 }).then(g.hitch(this, function(b) {
                        if (p.self.hasCategorySchema && a.categories) {
                            var c = [];
                            (b.services || []).forEach(function(b) { c.push(this.setCategories({ id: b.id, categories: a.categories })) }, this);
                            h(c).then(g.hitch(this, function() { m.resolve(g.mixin(a, { publishResult: b.services || [] })) }))
                        } else m.resolve(g.mixin(a, { publishResult: b.services || [] }))
                    }), function(a) { m.reject(a) });
                    return m
                },
                createService: function(a, b, c, d) {
                    var f = new e,
                        h, m = d && d.getPortalUser();
                    v.request({ url: (d && d.portalUrl) + "content/users/" + (a.owner || m.username) + "/createService", content: b }, { usePost: !0 }).then(function(a) { return h = a }).then(g.hitch(this, this.addToDefinition, c)).then(g.hitch(this, function(b) { f.resolve(g.mixin(a, { createResult: b || [] })) }), g.hitch(this, function(a) { this.deleteItem(g.mixin(h, { id: h.itemId }), d).then(function() { f.reject(a) }) }));
                    return f
                },
                addToDefinition: function(a, b) {
                    var c = new e;
                    if (a) {
                        var d = b.encodedServiceURL.replace("rest/services", "rest/admin/services");
                        v.request({ url: d + "/addToDefinition", content: { addToDefinition: a } }, { usePost: !0 }).then(g.hitch(this, function(a) { c.resolve(g.mixin(b, { addToDefinitionResult: a })) }), function(a) { c.reject(a) })
                    } else c.resolve(b);
                    return c
                },
                moveItem: function(a, b, c) {
                    var d = new e,
                        f = c && c.getPortalUser(),
                        f = a.owner || f.username;
                    c = (c && c.portalUrl) + "content/users/" + f + (a.folderId && "/" !== a.folderId ? "/" + a.folderId :
                        "") + "/items/" + a.id + "/move";
                    f = { folder: b && b !== f ? b : "/" };
                    (a.folderId || "/") !== f.folder ? v.request({ url: c, content: f }, { usePost: !0 }).then(g.hitch(this, function(c) { d.resolve(g.mixin(a, { folderId: b })) })) : d.resolve(a);
                    return d
                },
                serviceNameAvailable: function(a, b) {
                    var c = b && b.getPortalUser();
                    a = { name: a.title.replace(/ /g, "_"), type: a.type || "Feature Service" };
                    return v.request({ url: b.url + "portals/" + c.orgId + "/isServiceNameAvailable", content: a })
                },
                analyzeItem: function(a, b, c) {
                    b = g.mixin({ enableGlobalGeocoding: !0, sourceLocale: n.locale.split("-")[0] },
                        b || {});
                    a = g.mixin({}, { analyzeParameters: b, filetype: a.fileType || a.type && a.type.toLowerCase() || "", itemid: a.id });
                    c = c.url + "/content/features/analyze";
                    a.analyzeParameters = f.stringify(a.analyzeParameters);
                    return v.request({ url: c, content: a }, { usePost: !0 })
                },
                createTemplatedApplication: function(b, c, h, n) {
                    var r = b,
                        t = n && n.sharing ? n.sharing : {},
                        w = n && n.isEveryoneChecked ? n : null,
                        x = g.isArray(c.typeKeywords) ? -1 < a.indexOf(c.typeKeywords, "selfConfigured") : -1 < c.typeKeywords.indexOf("selfConfigured"),
                        A = g.isArray(c.typeKeywords) ?
                        -1 < a.indexOf(c.typeKeywords, "configurableApp") : -1 < c.typeKeywords.indexOf("configurableApp");
                    n = g.isArray(c.typeKeywords) ? -1 < a.indexOf(c.typeKeywords, "Web AppBuilder for ArcGIS") : -1 < c.typeKeywords.indexOf("Web AppBuilder for ArcGIS");
                    var B, D, G = g.hitch(this, function(b) {
                        var c = new e;
                        if (b.shareWithWebMap) {
                            var d = p.restBaseUrl + "content/items/" + b.id + "/share",
                                h = "public" === t.access || w && w.isEveryoneChecked() || !1,
                                m = "org" === t.access || w && w.isAccountChecked() || !1,
                                n = t.groups || w && w.getSharedGroups() || [],
                                n = a.map(n,
                                    "return item.id;"),
                                h = { f: "json", everyone: h, org: m, groups: n.join(","), items: [b.id] };
                            p.self.hasCategorySchema && h.categories && (h.categories = f.stringify(h.categories));
                            v.request({ url: d, content: h }, { usePost: !0 }).then(g.hitch(this, function() { c.resolve(b) }))
                        } else c.resolve(b);
                        return c
                    });
                    if (r && n) return b = new e, r.folderId && "/" !== r.folderId && (r.folder = r.folderId), n = window.location.protocol + "//" + window.location.host + v.getHomeAppContext() + "/apps/webappbuilder/index.html?", n += d.objectToQuery({
                        title: r.title,
                        tags: r.tags,
                        summary: r.description,
                        folder: r.folder,
                        categories: r.categories && r.categories.length ? f.stringify(r.categories) : void 0
                    }), b.resolve(g.mixin(r, { configureUrl: n })), b;
                    if (r) return n = v.parseUrl(c.url), delete b.typeKeywords, B = window.location.protocol + "//" + n.host + (n.port && "443" !== n.port && "80" !== n.port ? ":" + n.port : "") + n.path, B = "https:" === window.location.protocol ? v.getSecureUrl(B) : v.getHttpUrl(B), r = g.mixin({
                        type: "Web Mapping Application",
                        typeKeywords: "Web Map, Map, Online Map, Mapping Site, JavaScript, Ready To Use" +
                            (x ? " ,selfConfigured" : "") + (A ? ", configurableApp" : ""),
                        thumbnailURL: v.getStaticImagesUrl() + "/webapp.png",
                        url: B
                    }, r), r.text = f.stringify(g.mixin({}, { source: c.id, folderId: r.folderId, values: b.webSceneId ? { webscene: b.webSceneId } : b.webMapId ? { webmap: b.webMapId } : b.groupId ? { group: b.groupId } : {} })), this.addItem(r, r.folderId, h).then(g.hitch(this, function(a) {
                        return G(g.mixin(r, { id: a.id })).then(g.hitch(this, function(b) {
                            var d = b.url.indexOf("?"),
                                e = -1 !== d ? b.url.substr(d, b.url.length) : "",
                                e = e + (e && e.length ? "\x26" : "?"),
                                e =
                                e + ("appid\x3d" + a.id);
                            B = b.url.substr(0, -1 !== d ? d : b.url.length) + e;
                            return this.updateItem({ id: a.id, url: B, folderId: b.folderId }, h).then(g.hitch(this, function() {
                                return x ? (D = x ? B + "\x26edit\x3dtrue" : p.baseUrl + ("webmap/configureApp.html?appid\x3d" + a.id), D += a.folderId && "/" !== a.folderId ? "\x26folderid\x3d" + a.folderId : "", g.mixin(b, a, { configureUrl: D, url: B })) : A ? (D = window.location.protocol + "//" + window.location.host + v.getHomeAppContext() + "/apps/configure-template/index.html?appid\x3d" + a.id, g.mixin(b, a, {
                                    configureUrl: D,
                                    url: B
                                })) : v.request({ url: p.restBaseUrl + "content/items/" + c.id + "/data" }).then(g.hitch(this, function(c) { D = c && c.configurationSettings ? p.baseUrl + "webmap/configureApp.html?appid\x3d" + a.id + (a.folderId && "/" !== a.folderId ? "\x26folderid\x3d" + a.folderId : "") : p.baseUrl + "item.html?id\x3d" + a.id; return g.mixin(b, a, { configureUrl: D, url: B }) }))
                            }))
                        }))
                    }), g.hitch(this, function(a) {
                        a && 409 === a.code && (a = r, a = { title: E.addItemFrm.errors.error.title, message: m.substitute({ type: a.type, title: a.title }, E.addItemFrm.errors.itemExists.message) });
                        throw a;
                    }))
                },
                checkStatus: function(a, b, c, d) {
                    var e = (d && d.getPortalUser()).userContentUrl;
                    a ? v.request({ url: e + "/items/" + a.id + "/status", content: { jobId: a.jobId } }).then(g.hitch(this, function(e) {
                        e = e || { status: "failed" };
                        if ("completed" === e.status) return b.resolve(a);
                        if ("failed" === e.status || "" === e.status) return e = B.getStatusError(e), b.reject({ message: e });
                        c = (c || 500) + 250;
                        setTimeout(g.hitch(this, function() { this.checkStatus(a, b, c, d) }), c)
                    }), g.hitch(this, function(a) { b.reject(a) })) : b.reject()
                },
                _getBatchGeocodeServers: function(b) {
                    if (!this._batchGeocoderServers) {
                        var c =
                            b.getPortalUser(),
                            d = -1 < a.indexOf(c.privileges, "portal:user:createItem") && -1 < a.indexOf(c.privileges, "premium:user:geocode"),
                            e = /(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig,
                            f = /(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig,
                            g, h, m = [];
                        a.forEach(b.helperServices && b.helperServices.geocode || [], function(a) {
                            g = !!a.url.match(e);
                            h = !!a.url.match(f);
                            (g && !b.isPortal && d || h || a.batch) && m.push({
                                isWorldGeocodeServer: g || h,
                                isWorldGeocodeServerProxy: h,
                                label: a.name,
                                value: a.url,
                                url: a.url,
                                name: a.name
                            })
                        });
                        this._batchGeocoderServers = m
                    }
                    return this._batchGeocoderServers
                },
                getPortalDefaultExtentAsGCS: function(a) {
                    if (a = a.defaultExtent || null) {
                        a = w.webMercatorToGeographic(new t(a));
                        var b = a.spatialReference._getInfo();
                        if (b) {
                            if (a.xmin > a.xmax) {
                                var c = b.valid[1] - a.xmin,
                                    d = a.xmax - b.valid[0];
                                c > d ? a.xmax = b.valid[1] + d : a.xmin = b.valid[0] - c
                            }
                            return Math.round(1E4 * a.xmin) / 1E4 + "," + Math.round(1E4 * a.ymin) / 1E4 + "," + Math.round(1E4 * a.xmax) / 1E4 + "," + Math.round(1E4 * a.ymax) / 1E4
                        }
                    }
                    return null
                },
                itemExists: function(a, b, c) {
                    var d =
                        a.title;
                    c = c && "/" !== c ? c : "root";
                    var e = "Data Store" === a.type ? a.type.toLowerCase() : a.type;
                    b = { q: 'title:"' + d + '" AND type:"' + e + '" AND owner:"' + b + '" AND ownerfolder:"' + c + '"', num: 1 };
                    var f, g = new dojo.Deferred;
                    v.request({ url: p.restBaseUrl + "search", content: b }).then(function(b) {
                        b && b.total ? (f = b.results && b.results.shift(), a && a.id === f.id || d !== f.title ? g.resolve({ itemExists: !1 }) : (b = a.isFile ? m.substitute({ type: a.fileExtension, item: a.item, name: a.name || a.title, title: a.title }, E.addItemFrm.errors.itemExistsFile.message) :
                            m.substitute({ type: e, item: a.item, title: d }, E.addItemFrm.errors.itemExists.message), g.resolve({ itemExists: !0, message: b }))) : g.resolve({ itemExists: !1 })
                    }.bind(this));
                    return g
                },
                _getFederatedServers: function(a) { return v.request({ url: a.url + "portals/self/servers/" }) },
                _getHostedFederatedServers: function(b) {
                    var c = new e,
                        d;
                    this._getFederatedServers(b).then(g.hitch(this, function(b) {
                        p.federatedServers = b.servers;
                        d = a.filter(b.servers || [], g.hitch(this, function(a) { return a.isHosted }));
                        c.resolve(d && d.length && d[0] || null)
                    }));
                    return c
                },
                hasCreateLayer: function(b) {
                    var c = { managed: !0 },
                        d = b && (b.user || b.getPortalUser && b.getPortalUser()),
                        f = new x({ portalUser: d }),
                        h, m, n, p, r;
                    if (b.isPortal && d && (f.isBasedOnAdmin() || f.isBasedOnPublisher())) return this._getFederatedServers(b).then(g.hitch(this, function(b) {
                        (m = (h = a.filter(b.servers || [], g.hitch(this, function(a) { return a.isHosted }))) && h.length ? h[0] : null) ? (n = m.adminUrl + "/admin/data/findItems", r = v.request({ url: n, content: c }, { useProxy: !0 }).then(g.hitch(this, function(b) {
                            return (p = a.filter(b.items ||
                                b || [], g.hitch(this, function(a) { return a && a.provider && "arcgis data store" === a.provider.toLowerCase() }))) && p.length ? !0 : !1
                        }), g.hitch(this, function(a) { return !1 }))) : (r = new e, r.resolve(!1));
                        return r
                    }));
                    b = new e;
                    b.resolve(!0);
                    return b
                }
            }
        })
}, "arcgisonline/pages/statusUtil": function() {
    define("require exports tslib dojo/Deferred dojo/on dojo/json dojo/topic esri/lang esri/urlUtils ./pageUtil ./utils/arrays esri/tasks/Geoprocessor ../sharing/util dojo/i18n!../nls/arcgisonline".split(" "), function(b, g, n, a, c, d,
        f, e, h, m, p, r, v, w) {
        a = n.__importDefault(a);
        c = n.__importDefault(c);
        d = n.__importDefault(d);
        f = n.__importDefault(f);
        e = n.__importDefault(e);
        h = n.__importDefault(h);
        m = n.__importDefault(m);
        p = n.__importDefault(p);
        r = n.__importDefault(r);
        v = n.__importDefault(v);
        w = n.__importDefault(w);
        return function() {
            function b() {}
            b.checkStatus = function(b) {
                var c = new a.default,
                    d = this.getJobUrl(b),
                    e = this.getJobId(b);
                b.canUpdate && b.isHostedService && ("Feature Service" === b.type || (v.default.isPortal() || d && e) && "Image Service" === b.type ||
                    "Scene Service" === b.type || "Vector Tile Service" === b.type || v.default.isPortal() && "Map Service" === b.type) ? (b.set("status", "processing"), d && e ? this.checkJobStatus(b, 500) : e ? this.checkItemStatus(b, 500, c) : v.default.isPortal() || this.isVectorTileFromFeatures(b) ? b.set("status", "completed") : this.checkServiceStatus(b, 500, c)) : b.set("status", "completed");
                c.resolve(b);
                return c
            };
            b.isVectorTileFromFeatures = function(a) {
                var b;
                return "Vector Tile Service" === a.type && "Feature Service" === (null === (b = a.sourceData) || void 0 ===
                    b ? void 0 : b.type)
            };
            b.getJobId = function(a) {
                var b = h.default.urlToObject(document.URL),
                    c = a.properties || {};
                a.jobId = a.jobId || c.jobId || b && b.query && b.query.jobid || null;
                return a.jobId
            };
            b.getJobUrl = function(a) {
                var b = (a.properties && a.properties.jobUrl || "").split("/jobs/");
                a.jobUrl = b.shift();
                a.jobId = a.jobUrl ? b.shift() : null;
                return a.jobUrl
            };
            b.checkItemStatus = function(a, b, c) {
                var d = this;
                void 0 === b && (b = 500);
                v.default.request({ url: a.userItemUrl + "/status", content: { jobId: a.jobId } }).then(function(e) {
                    e = e || { status: "failed" };
                    "completed" === e.status ? a.set("status", "completed") : "failed" === e.status || 400 < e.code || "" === e.status ? (a.set("statusError", d.getStatusError(e)), a.set("status", "failed")) : (a.set("status", "processing"), b += 250, setTimeout(function() { return d.checkItemStatus(a, b, c) }, b))
                }, function(b) {
                    a.set("statusError", d.getStatusError(b));
                    a.set("status", "failed")
                })
            };
            b.checkServiceStatus = function(a, b, c) {
                var d = this;
                void 0 === b && (b = 500);
                var e = a.adminUrl + "/status",
                    f = {};
                if ("Scene Service" === a.type || "Vector Tile Service" === a.type) e =
                    a.adminUrl;
                a.adminServerToken && (f.token = a.adminServerToken);
                v.default.request({ url: e, content: f }).then(function(e) {
                    void 0 === e && (e = {});
                    var f, g;
                    e.status = (null === (f = e.realTimeState) || void 0 === f ? void 0 : f.toLowerCase()) || (null === (g = e.status) || void 0 === g ? void 0 : g.toLowerCase()) || (e.currentVersion && e.capabilities ? "started" : "failed");
                    if ("Scene Service" === a.type || "Vector Tile Service" === a.type) e.status = "PROCESSING" === e.cacheExecutionStatus || "SUBMITTED" === e.cacheExecutionStatus ? "processing" : "started";
                    "started" ===
                    e.status ? a.set("status", "completed") : "failed" === e.status || 400 < e.code || "" === e.status ? (a.set("statusError", d.getStatusError(e)), a.set("status", "failed")) : (a.set("status", "processing"), b += 250, setTimeout(function() { return d.checkServiceStatus(a, b, c) }, b))
                }, function(b) {
                    a.set("statusError", d.getStatusError(b));
                    a.set("status", "failed")
                })
            };
            b.checkJobStatus = function(a, b) {
                var d = this;
                void 0 === b && (b = 3E3);
                var e = (a.portal.getPortalUser() || {}).token,
                    f = a.jobId,
                    g = a.jobUrl,
                    h = a.properties,
                    m, n;
                h && "processing" === h.jobStatus ?
                    (a.set("status", "processing"), m = new r.default(g + (e ? "?token\x3d" + e : "")), c.default(m, "status-update", function(b) { "esriJobExecuting" !== b.jobInfo.jobStatus ? (a.set("status", "completed"), n && clearInterval(n)) : a.set("status", "processing") }), c.default(m, "error", function(b) {
                        var c, e;
                        b = b.error || b;
                        (null === (e = null === (c = b) || void 0 === c ? void 0 : c.message) || void 0 === e ? 0 : e.indexOf("not found.")) ? (a.set("status", "completed"), h && (h.jobId && delete h.jobId, h.jobUrl && delete h.jobUrl, h.jobStatus && delete h.jobStatus, h.jobType &&
                            delete h.jobType, a.set("properties", h))) : (a.set("statusError", d.getStatusError(b)), a.set("status", "failed"));
                        n && clearInterval(n)
                    }), n = setInterval(function() { return m.checkJobStatus(f) }, b)) : a.set("status", "completed")
            };
            b.checkSceneCachingJobStatus = function(a, b, c, d) {
                var e = this;
                void 0 === b && (b = 3E3);
                var g = v.default.isPortal(),
                    h = !(!a.portalUser || !a.portalUser.isOrgAdmin),
                    m = a.cachingJobUrl || a.properties && a.properties.cacheJobUrl,
                    n = g ? ["esriJobSucceeded", "esriJobFailed", "esriJobCancelled"] : ["Completed", "Failed"],
                    r = g ? "esriJobFailed" : "Failed",
                    t = g ? { useProxy: !0 } : {},
                    w = g ? "jobStatus" : "status",
                    x = g ? m : a.adminUrl + "/" + m,
                    B;
                g && h && (x = x.replace("/rest/", "/admin/").replace("/SceneCachingControllers/GPServer/", "/SceneCachingControllers.GPServer/"), w = "status");
                m ? B = setInterval(function() {
                    v.default.request({ url: x }, t).then(function(b) {
                        d && f.default.publish(d, b);
                        p.default.includes(n, b[w]) ? (b[w] === r && (a.set("status", "failed"), c && c.reject(b)), clearInterval(B), a.set("cachingJobUrl", void 0), a.set("status", "completed"), c && c.resolve(b)) :
                            a.set("status", "processing")
                    }, function(b) {
                        var d;
                        (null === (d = null === b || void 0 === b ? void 0 : b.message) || void 0 === d ? 0 : d.indexOf("not found.")) ? (a.set("cachingJobUrl", void 0), a.set("status", "completed"), c && c.resolve()) : (a.set("statusError", e.getStatusError(b)), a.set("status", "failed"), c && c.reject(b))
                    })
                }, b) : (a.set("cachingJobUrl", void 0), a.set("status", "completed"), c && c.resolve({}))
            };
            b.getStatusError = function(a) {
                var b = (null === a || void 0 === a ? void 0 : a.statusMessage) || w.default.addItemFrm.errors.publishError.message;
                return b ? m.default.isJson(b) ? d.default.parse(b) : b : a
            };
            b.checkAsyncJobStatus = function(b, c) {
                void 0 === c && (c = 500);
                var d = new a.default,
                    f, g = setInterval(function() {
                        v.default.request({ url: b }).then(function(a) {
                            a = a || { status: "Failed" };
                            f = a.status || a.jobStatus;
                            f = e.default.isDefined(f) ? f.toLowerCase() : f;
                            if (p.default.includes(["esrijobsucceeded", "completed"], f)) clearInterval(g), d.resolve(a);
                            else if (p.default.includes(["esrijobfailed", "failed"], f) || 400 < a.code) clearInterval(g), d.reject(a)
                        }, function(a) {
                            clearInterval(g);
                            d.reject(a)
                        })
                    }, c);
                return d
            };
            b.checkAsyncJobStatusWithVaryingInterval = function(b, c) {
                var d = new a.default,
                    f = 0,
                    g, h = function() {
                        setTimeout(function() {
                            f++;
                            v.default.request({ url: b }).then(function(a) {
                                a = a || { status: "Failed" };
                                g = a.status || a.jobStatus;
                                g = e.default.isDefined(g) ? g.toLowerCase() : g;
                                p.default.includes(["esrijobsucceeded", "completed"], g) ? d.resolve(a) : p.default.includes(["esrijobfailed", "failed"], g) || 400 < a.code ? d.reject(a) : h()
                            }, function(a) { return d.reject(a) })
                        }, c(f))
                    };
                h();
                return d
            };
            b.getEndTime = function(a) {
                var b =
                    v.default.isPortal();
                if (((null === a || void 0 === a ? 0 : a.startTime) || (null === a || void 0 === a ? 0 : a.submittedTime)) && ((null === a || void 0 === a ? 0 : a.totalTime) || (null === a || void 0 === a ? 0 : a.duration))) {
                    var c = (b ? a.submittedTime : a.startTime) || 0,
                        c = b ? c : 1E3 * c;
                    a = b ? e.default.isDefined(a.duration) ? a.duration : void 0 : e.default.isDefined(a.totalTime) ? 1E3 * a.totalTime : void 0;
                    return c + a
                }
                if (b && a.jobStatus && a.messages && (a = p.default.find(a.messages || [], function(a) { return "esriJobMessageTypeInformative" === a.type && 0 === a.description.indexOf("Succeeded at ") }))) try {
                    var c =
                        a.description.indexOf(" (Elapsed Time: "),
                        d = a.description.substring(14, c).trim();
                    return (new Date(d)).getTime()
                } catch (F) {}
            };
            return b
        }()
    })
}, "arcgisonline/map/core/sameSpatialReference": function() {
    define(["esri/lang", "arcgisonline/map/utils/contains"], function(b, g) {
        return function(n, a) {
            var c = [102113, 102100, 3857];
            return n && a && n.wkt == a.wkt && (n.wkid == a.wkid || b.isDefined(n.latestWkid) && n.latestWkid == a.wkid || b.isDefined(a.latestWkid) && n.wkid == a.latestWkid || b.isDefined(n.latestWkid) && n.latestWkid == a.latestWkid) ||
                n && a && n.wkid && a.wkid && g(c, n.wkid) && g(c, a.wkid) ? !0 : !1
        }
    })
}, "arcgisonline/sharing/dijit/CopyToClipboard": function() {
    define("dojo/_base/declare dojo/dom dojo/on dojo/_base/event dojo/query dijit/_TemplatedMixin dijit/_WidgetBase ../../pages/utils/icons dojo/text!./templates/CopyToClipboard.html dojo/i18n!../../nls/arcgisonline dojo/domReady!".split(" "), function(b, g, n, a, c, d, f, e, h, m) {
        return b("arcgisonline.sharing.dijit.CopyToClipboard", [f, d], {
            templateString: h,
            tooltipModifier: "",
            icons: e,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = dojo.i18n.getLocalization("arcgisonline", "arcgisonline");
                this.copySupported = document.queryCommandSupported("copy")
            },
            postCreate: function() { this.copySupported || (c(".js-copy-group").removeClass("input-group"), c(".js-copy-tooltip", this.domNode).addClass("hide")) },
            copy: function(a) {
                a = g.byId("copy-to-clipboard-" + this.id);
                var b = c(".js-copy-tooltip", this.domNode),
                    d = c(".js-copy-alert", this.domNode).shift();
                try {
                    a.select(), document.execCommand("copy"), a.blur(), b.attr("aria-label", m.common.copiedLbl),
                        d.innerHTML = m.common.copiedLbl
                } catch (w) {}
            },
            reset: function() {
                c(".js-copy-tooltip", this.domNode).attr("aria-label", m.tocPanel.copy);
                c(".js-copy-alert", this.domNode).shift().innerHTML = ""
            }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/TimeSettingsDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/DateTextBox,dijit/form/TimeTextBox,dijit/form/TextBox,dijit/form/CheckBox,dijit/form/RadioButton,dojox/form/RangeSlider,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/dialog/GeneralDlg"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.TimeSettingsDlg");
            b.require("dijit.Dialog");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dijit.form.DateTextBox");
            b.require("dijit.form.TimeTextBox");
            b.require("dijit.form.TextBox");
            b.require("dijit.form.CheckBox");
            b.require("dijit.form.RadioButton");
            b.require("dojox.form.RangeSlider");
            b.require("arcgisonline.sharing.dijit.HelpManager");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.declare("arcgisonline.sharing.dijit.dialog.TimeSettingsDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_timeSettingsDialog" id\x3d"timeSettingsDlg" dojoAttachEvent\x3d"onClick:_handleTimeSettingsDlgClick" title\x3d"${i18n.timeSettingsDlgTitle}" doLayout\x3d"false" execute\x3d""\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_timeSettingsMainDiv" class\x3d"timeSettingsForm"\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_timeSettingsSpeedDiv"\x3e\r\n        \x3cdiv style\x3d"padding-bottom:5px;"\x3e\x3clabel style\x3d"font-weight:bold;"\x3e${i18n.playbackSpeed}\x3c/label\x3e\x3c/div\x3e\r\n          \x3ctable style\x3d"padding-bottom:10px;" dir\x3d"ltr"\x3e\x3ctbody\x3e\x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" align\x3d"center"\x3e\r\n            \x3cdiv dojoType\x3d"dijit.form.HorizontalSlider" dojoAttachPoint\x3d"_tSpeedSlider" style\x3d"width: 600px; margin:3px; " showbuttons\x3d"false" value\x3d"1" minimum\x3d"0" maximum\x3d"4" discretevalues\x3d"1" intermediatechanges\x3d"true"\x3e\r\n              \x3cdiv dojoType\x3d"dijit.form.HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\x3ctr\x3e\r\n          \x3ctd valign\x3d"top" nowrap style\x3d"float:left;"\x3e\x3clabel\x3e${i18n.slower}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap style\x3d"float:right;"\x3e\x3clabel\x3e${i18n.faster}\x3c/label\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_tAdvancedLink" style\x3d"padding-top:15px;" class\x3d"esriItemLinks esriFloatLeading"\x3e\x3ca href\x3d"JavaScript:void(0);" dojoAttachEvent\x3d"onclick:_showAdvanced"\x3e${i18n.showAdvancedOptions}\x3c/A\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv dojoAttachPoint\x3d"_tSettingsAdvancedDiv" style\x3d"display:none;"\x3e\r\n\r\n        \x3cdiv style\x3d"padding-top:5px;padding-bottom:5px;"\x3e\x3clabel style\x3d"font-weight:bold;"\x3e${i18n.timeSpan}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"width:620px; position:relative"\x3e\r\n          \x3cdiv style\x3d"padding-bottom:10px;"\x3e\x3clabel\x3e${i18n.dragSliderMessage}\x3c/label\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c!-- hard code to LTR --\x3e\r\n          \x3ctable style\x3d"width:620px;" class\x3d"timeSettingsForm"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd valign\x3d"top"\x3e\r\n                  \x3clabel class\x3d"esriFloatLeading"\x3e${i18n.layers}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd valign\x3d"top"\x3e\r\n                  \x3clabel class\x3d"esriFloatLeading"\x3e${i18n.layerTimeLines}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr height\x3d"5"\x3e\r\n                \x3ctd height\x3d"5" colspan\x3d"2"\x3e\r\n                  \x3cdiv style\x3d"height:1px;border-top:#444444 1px solid;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd width\x3d"200" valign\x3d"top"\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"_tLayerNamesDiv" class\x3d"timeSettingsLayerNames"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"420" valign\x3d"top"\x3e\r\n                \t\x3cdiv style\x3d"position:absolute"\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"_tSettingsBkgrndDiv" class\x3d"timeSettingsBackground" style\x3d"position:absolute; z-index:0;"\x3e\x3c/div\x3e\r\n                  \x3cdiv dojoAttachPoint\x3d"_tSettingsLyrRange" class\x3d"timeSettingslayerRange" style\x3d"position:relative; z-index:10;"\x3e\x3c/div\x3e\r\n                  \x3cdiv id\x3d"timeSettingsSliderDiv" dojoAttachPoint\x3d"_tSettingsSlider" dojoType\x3d"dojox.form.HorizontalRangeSlider" style\x3d"width: 420px;" showbuttons\x3d"false" intermediatechanges\x3d"true" minimum\x3d"-788889600000" maximum\x3d"1230796800000" value\x3d"-788889600000,1230796800000"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr height\x3d"10"\x3e\r\n                \x3ctd colspan\x3d"4" height\x3d"10"\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n\t\t\t\t\t\x3cbr/\x3e\r\n\t\t\t\t\t\x3ctable style\x3d"width:620px;" id\x3d"timeSettingsDates"\x3e\r\n\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd width\x3d"200"\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd nowrap\x3e${i18n.startTime}\x26nbsp;\x26nbsp;\x26nbsp;\x3c/td\x3e\r\n                \x3ctd width\x3d"105"\x3e\r\n                  \x3cinput dojoAttachPoint\x3d"_startDate" style\x3d"width:110px;" type\x3d"text" value\x3d"2005-12-30" dojoType\x3d"dijit.form.DateTextBox" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"325"\x3e\r\n                  \x3cinput dojoAttachPoint\x3d"_startTime" style\x3d"width:90px;" type\x3d"text" value\x3d"T15:00:00" id\x3d"time-settings-start-time" dojoType\x3d"dijit.form.TimeTextBox" /\x3e\r\n                \x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\x3ctr height\x3d"3"\x3e\r\n                \x3ctd colspan\x3d"4" height\x3d"3"\x3e\x3c/td\x3e\r\n              \x3c/tr\x3e\x3ctr\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e${i18n.endTime}\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cinput dojoAttachPoint\x3d"_endDate" style\x3d"width:110px;" type\x3d"text" value\x3d"2005-12-30" dojoType\x3d"dijit.form.DateTextBox" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cinput dojoAttachPoint\x3d"_endTime" style\x3d"width:90px;" type\x3d"text" value\x3d"T15:00:00" id\x3d"time-settings-end-time" dojoType\x3d"dijit.form.TimeTextBox" /\x3e\r\n                \x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv style\x3d"padding-top:10px;padding-bottom:5px;"\x3e\x3clabel style\x3d"font-weight:bold;"\x3e${i18n.timeDisplay}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv\x3e\x3clabel\x3e${i18n.specifyData}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"padding-top:10px;padding-bottom:10px; line-height:18px;"\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"_tSettingsIntDiv" id\x3d"timeSettingsInterval"\x3e\r\n\r\n            \x3cdiv\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"interval" dojotype\x3d"dijit.form.RadioButton" id\x3d"interval:time" dojoAttachPoint\x3d"_stopsIntervalTime" checked\x3d"checked"/\x3e\r\n              \x3clabel for\x3d"interval:time"\x3e${i18n.lengthOfInterval}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin12"\x3e\r\n              \x3ctable cellpadding\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cspan\x3e${i18n.countLabel}\x26nbsp;\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput dojoAttachPoint\x3d"_tSettingsIntCount" style\x3d"width:30px;height:22px;vertical-align:middle;" type\x3d"text" value\x3d"1" maxLength\x3d"3" regExp\x3d"[0-9]+" intermediatechanges\x3d"true" dojoAttachEvent\x3d"onChange:_timeSettingsStopsTimeSpanUnitsCount_onChange" dojoType\x3d"dijit.form.ValidationTextBox" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd width\x3d"20"\x3e\r\n                    \x26nbsp;\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cspan\x3e${i18n.unitsLabel}\x26nbsp;\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput dojoAttachPoint\x3d"_tSettingsIntUnitSelect" style\x3d"width:90px;vertical-align:middle;" type\x3d"text" intermediatechanges\x3d"true" dojoAttachEvent\x3d"onChange:_timeSettingsStopsTimeSpanUnits_onChange" dojoType\x3d"arcgisonline.sharing.dijit.ComboBox" /\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"interval" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_stopsIntervalEqual" id\x3d"interval:equal" /\x3e\r\n              \x3clabel for\x3d"interval:equal"\x3e${i18n.dividedEqualSteps}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin12"\x3e\r\n              \x3ctable cellpadding\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cspan\x3e${i18n.countLabel}\x26nbsp;\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput dojoAttachPoint\x3d"_tSettingsIntCountEqual" style\x3d"width:30px;height:22px;vertical-align:middle;" type\x3d"text" value\x3d"5" maxLength\x3d"3" regExp\x3d"[0-9]+" intermediatechanges\x3d"true" dojoAttachEvent\x3d"onChange:_timeSettingsStopsTimeSpanEqual_onChange" dojoType\x3d"dijit.form.ValidationTextBox" /\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"padding-top:5px;"\x3e\r\n            \x3ctable cellpadding\x3d"5"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd valign\x3d"top"\x3e\r\n                    \x3cspan\x3e${i18n.asTimePasses}\x26nbsp;\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                 \x3cdiv\x3e\r\n                   \x3cinput type\x3d"radio" name\x3d"stops" dojotype\x3d"dijit.form.RadioButton" id\x3d"stops:interval"  dojoAttachPoint\x3d"_stopsIntervalInput" checked\x3d"checked"/\x3e\r\n                   \x3clabel for\x3d"stops:interval"\x3e${i18n.onlyDisplay}\x3c/label\x3e\r\n                 \x3c/div\x3e\r\n                 \x3cdiv\x3e\r\n                   \x3cinput type\x3d"radio" name\x3d"stops" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_stopsCumalativeInput" id\x3d"stops:cumulative" /\x3e\r\n                   \x3clabel for\x3d"stops:cumulative"\x3e${i18n.progressivelyDisplay}\x3c/label\x3e\r\n                 \x3c/div\x3e\r\n                 \x3c/td\x3e\r\n               \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd valign\x3d"top"\x3e\r\n                    \x3cspan\x3e${i18n.startPlaybackAt}\x26nbsp;\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv\x3e\r\n                      \x3cinput type\x3d"radio" name\x3d"startAt" dojotype\x3d"dijit.form.RadioButton" id\x3d"startAt:beginning"  dojoAttachPoint\x3d"_startAtBeginningInput" checked\x3d"checked"/\x3e\r\n                      \x3clabel for\x3d"startAt:beginning"\x3e${i18n.beginningOfTimeSpan}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv\x3e\r\n                      \x3cinput type\x3d"radio" name\x3d"startAt" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_startAtSavedInput" id\x3d"startAt:saved" /\x3e\r\n                      \x3clabel for\x3d"startAt:saved"\x3e${i18n.timePositionSaved}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n             \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv dojoAttachPoint\x3d"_tSettingsHelp" style\x3d"padding-top:15px; display:none;" class\x3d"esriItemLinks esriFloatLeading"\x3e\x3ca dojoAttachPoint\x3d"_helpLink" href\x3d"" target\x3d"_blank" title\x3d"${i18n.learnMore}"\x3e\x3cdiv class\x3d"questionMarkIcon"\x3e\x3c/div\x3e\x3c/A\x3e\x3c/div\x3e\r\n\r\n      \x3c/div\x3e\r\n\r\n      \x3c/br/\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton class\x3d"jevent primary" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleOkBtnClick"\x3e${i18n.ok}\x3c/button\x3e\r\n        \x3cbutton class\x3d"jevent cancel" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleCloseBtnClick"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv dojotype\x3d"dijit.TooltipDialog" dojoAttachPoint\x3d"_toolTipDialog" title\x3d"" style\x3d"display:none;width:400px;"\x3e\r\n      \x3c!--\x3cdiv style\x3d"float:right;"\x3e\x3cA id\x3d"time-settings-tooltip-close" href\x3d"JavaScript:void(0);" title\x3d"Close"\x3e\x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/A\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"esriItemLinks"\x3e\x3ca dojoAttachPoint\x3d"tSettingsTipStart"  href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriItemLinks"\x3e\x3ca  dojoAttachPoint\x3d"tSettingsTipEnd" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                init: !1,
                mapLayers: null,
                i18n: null,
                sliderHandler: null,
                startDateHandler: null,
                startTimeHandler: null,
                endDateHandler: null,
                endTimeHandler: null,
                _timeSettingsDialog: null,
                _timeSettingsMainDiv: null,
                _timeSettingsSpeedDiv: null,
                _tSpeedSlider: null,
                _tAdvancedLink: null,
                _tSettingsAdvancedDiv: null,
                _tLayerNamesDiv: null,
                _tSettingsBkgrndDiv: null,
                _tSettingsLyrRange: null,
                _tSettingsSlider: null,
                _startDate: null,
                _startTime: null,
                _endDate: null,
                _endTime: null,
                _tSettingsIntCount: null,
                _tSettingsIntCountEqual: null,
                _tSettingsIntUnitSelect: null,
                _stopsIntervalInput: null,
                _stopsCumalativeInput: null,
                _startAtBeginningInput: null,
                _startAtSavedInput: null,
                _tSettingsHelp: null,
                _toolTipDialog: null,
                tSettingsTipStart: null,
                tSettingsTipEnd: null,
                _helpLink: null,
                statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.TimeSettingsDlg); return this._instance } },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    b.mixin(this.i18n,
                        b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").viewer.time);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").timeSettingsDlg)
                },
                postCreate: function() { this.init || (this.init = !0) },
                placeHelpIcon: function() {
                    var a = b.create("a", {
                        className: "esriHelpIcon esriFloatTrailing",
                        title: this.i18n.learnMore,
                        href: esriGeowConfig.self ? esriGeowConfig.self.helpBase + esriGeowConfig.self.helpMap.m["120000473"] : "",
                        target: "_blank",
                        style: "margin: 0 10px;"
                    });
                    b.query(".dijitDialogTitle").forEach(b.hitch(this, function(c) { c.innerHTML === this.i18n.timeSettingsDlgTitle && b.place(a, c, "last") }))
                },
                _handleCloseBtnClick: function(a) {
                    a.preventDefault();
                    this.hide()
                },
                _handleOkBtnClick: function(a) {
                    a.preventDefault();
                    this.saveSettings()
                },
                _handleTimeSettingsDlgClick: function() { g.popup.close(this._toolTipDialog) },
                hide: function() {
                    g.popup.close(this._toolTipDialog);
                    this._timeSettingsDialog.hide()
                },
                show: function(a) {
                    this.mapLayers =
                        a;
                    b.style(this._tSettingsAdvancedDiv, "display", "none");
                    b.style(this._tAdvancedLink, "display", 10 > b.isIE ? "inline" : "");
                    this._tSpeedSlider.set("value", 5 - arcgisonline.map.time.timeSlider.thumbMovingRate / 1E3);
                    this._timeSettingsDialog.show()
                },
                _showAdvanced: function() {
                    b.style(this._tAdvancedLink, "display", "none");
                    b.style(this._tSettingsAdvancedDiv, "display", 10 > b.isIE ? "inline" : "");
                    this._timeSettingsDialog.domNode.style.maxHeight = document.documentElement.clientHeight - 40 + "px";
                    this._timeSettingsDialog._position();
                    b.connect(this._tSettingsIntCount.domNode, "onfocus", this, "onFocusInterval");
                    b.connect(this._tSettingsIntCountEqual.domNode, "onfocus", this, "onFocusInterval");
                    b.connect(this._tSettingsIntUnitSelect.domNode, "onfocus", this, "onFocusInterval");
                    b.connect(this._tSettingsSlider, "onChange", this, "adjustSliderBackground");
                    this._startDate.rangeMessage = this.i18n.startDateRangeMsg;
                    this._endDate.rangeMessage = this.i18n.endDateRangeMsg;
                    this._tSettingsIntCount.invalidMessage = this.i18n.invalidNumber;
                    this._tSettingsIntCountEqual.invalidMessage =
                        this.i18n.invalidNumber;
                    this.setupSliderConnection();
                    this.loadUnitsOption(this._tSettingsIntUnitSelect);
                    this._tLayerNamesDiv.innerHTML = "";
                    b.forEach(this.mapLayers, function(a) { null != a && null != a.layer && a.layer.visible && a.layer.timeInfo && a.layer.useMapTime && !a.layer.timeInfo.hasLiveData && (b.create("div", { innerHTML: a.title, "class": "timeSettingsLayerNames", title: a.title, style: "overflow: hidden; text-overflow: ellipsis; max-width: 190px;" }, this._tLayerNamesDiv), b.create("br", {}, this._tLayerNamesDiv)) }, this);
                    var a = arcgisonline.map.time.fullTimeExtent,
                        c = arcgisonline.map.time.timeSliderProperties;
                    c && c.startTime && c.endTime ? (this._tSettingsSlider.set("minimum", Math.min(c.startTime, a.startTime.getTime())), this._tSettingsSlider.set("maximum", Math.max(c.endTime, a.endTime.getTime())), this._tSettingsSlider.set("value", [c.startTime, c.endTime])) : c && c.startTime ? (this._tSettingsSlider.set("minimum", Math.min(c.startTime, a.startTime.getTime())), this._tSettingsSlider.set("maximum", a.endTime.getTime()), this._tSettingsSlider.set("value", [c.startTime, this._tSettingsSlider.maximum])) : c && c.endTime ? (this._tSettingsSlider.set("minimum", a.startTime.getTime()), this._tSettingsSlider.set("maximum", Math.max(c.endTime, a.endTime.getTime())), this._tSettingsSlider.set("value", [this._tSettingsSlider.minimum, c.endTime])) : (this._tSettingsSlider.set("minimum", a.startTime.getTime()), this._tSettingsSlider.set("maximum", a.endTime.getTime()), this._tSettingsSlider.set("value", [this._tSettingsSlider.minimum, this._tSettingsSlider.maximum]));
                    this.rebuildBars();
                    c && 1 == c.thumbCount ? this._stopsCumalativeInput.set("checked", !0) : this._stopsIntervalInput.set("checked", !0);
                    c && c.numberOfStops ? (this._tSettingsIntCountEqual.set("value", c.numberOfStops), this._stopsIntervalEqual.set("checked", !0)) : c && c.timeStopInterval && c.timeStopInterval.interval && c.timeStopInterval.units ? (this._tSettingsIntCount.set("value", c.timeStopInterval.interval), this.setEsriUnits(this._tSettingsIntUnitSelect, c.timeStopInterval.units)) : (this._tSettingsIntCount.set("value", arcgisonline.map.time.timeSliderDefaultInterval),
                        this.setEsriUnits(this._tSettingsIntUnitSelect, arcgisonline.map.time.timeSliderDefaultUnits));
                    c && c.currentTimeExtent ? this._startAtSavedInput.set("checked", !0) : this._startAtBeginningInput.set("checked", !0)
                },
                saveSettings: function() {
                    var a = this._tSpeedSlider.getValue(),
                        a = Math.round(1E3 * (5 - a));
                    arcgisonline.map.time.timeSlider.setThumbMovingRate(a);
                    if ("none" === b.style(this._tSettingsAdvancedDiv, "display")) arcgisonline.map.time.timeSliderProperties || (arcgisonline.map.time.timeSliderProperties = {
                        startTime: Math.round(arcgisonline.map.time.fullTimeExtent.startTime.getTime()),
                        endTime: Math.round(arcgisonline.map.time.fullTimeExtent.endTime.getTime()),
                        thumbCount: 2,
                        timeStopInterval: { interval: arcgisonline.map.time.timeSliderDefaultInterval, units: arcgisonline.map.time.timeSliderDefaultUnits }
                    }), arcgisonline.map.time.timeSliderProperties.thumbMovingRate = a;
                    else {
                        var c = this._tSettingsSlider.get("value"),
                            d = c[0],
                            c = c[1];
                        if (6E4 > c - d) {
                            a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                            a.show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.timeSpanSmall });
                            return
                        }
                        var f = null,
                            e = null,
                            h = 2,
                            m = this._tSettingsIntCount.get("value");
                        this._stopsIntervalEqual.get("checked") && (m = this._tSettingsIntCountEqual.get("value"));
                        m = m.replace(/^\s+|\s+$/g, "");
                        if (0 === m.length || isNaN(m) || 1 > parseInt(m)) {
                            a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                            a.show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.provideGreaterValue });
                            return
                        }
                        if (this._stopsCumalativeInput.get("checked")) h = 1, this._stopsIntervalEqual.get("checked") ? f = parseInt(m) : (e =
                            this.getEsriUnits(this._tSettingsIntUnitSelect), e = { interval: parseInt(m), units: e });
                        else if (this._stopsIntervalEqual.get("checked")) f = parseInt(m);
                        else {
                            e = this.getEsriUnits(this._tSettingsIntUnitSelect);
                            m = this._tSettingsIntCount.get("value");
                            if (0 == m.length || isNaN(m) || 1 > parseInt(m)) {
                                a = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                                a.show({ title: this.i18n.errorDlgTitle, message: this.i18n.error.provideGreaterValue });
                                return
                            }
                            e = { interval: parseInt(m), units: e }
                        }
                        arcgisonline.map.time.timeSliderProperties = { startTime: Math.round(d), endTime: Math.round(c), thumbCount: h, thumbMovingRate: a, numberOfStops: f, timeStopInterval: e }
                    }
                    this._startAtSavedInput.get("checked") && arcgisonline.map.time.timeSlider.thumbCount === arcgisonline.map.time.timeSliderProperties.thumbCount && (a = arcgisonline.map.time.timeSlider.thumbIndexes, d = arcgisonline.map.time.timeSlider.timeStops, arcgisonline.map.time.timeSliderProperties.currentTimeExtent = 1 === arcgisonline.map.time.timeSliderProperties.thumbCount ? [arcgisonline.map.time.timeSliderProperties.startTime,
                        Math.round(d[a[0]])
                    ] : [Math.round(d[a[0]]), Math.round(d[a[1]])]);
                    arcgisonline.map.main.markMapAsChangedIfOwner("timeSlider_saveSettings");
                    arcgisonline.map.time.recreateTimeSlider();
                    g.popup.close(this._toolTipDialog);
                    this._timeSettingsDialog.hide()
                },
                checkUpdateBars: function(a, b) {
                    var c = arcgisonline.map.time.fullTimeExtent,
                        f = this._tSettingsSlider.get("value"),
                        e = f[0],
                        f = f[1];
                    if (a < c.startTime || b > c.endTime) this._tSettingsSlider.set("minimum", Math.min(c.startTime.getTime(), a.getTime())), this._tSettingsSlider.set("maximum",
                        Math.max(c.endTime.getTime(), b.getTime())), this.rebuildBars();
                    else if (e < c.startTime.getTime() || f > c.endTime.getTime()) this._tSettingsSlider.set("minimum", c.startTime.getTime()), this._tSettingsSlider.set("maximum", c.endTime.getTime()), this.rebuildBars();
                    this.loadUnitsOption(this._tSettingsIntUnitSelect, a, b)
                },
                rebuildBars: function() {
                    var a = this._tSettingsSlider.get("maximum") - this._tSettingsSlider.get("minimum"),
                        c = parseInt(b.style(b.byId("timeSettingsSliderDiv"), "width")) - 2 - 16,
                        d = a / c;
                    this._tSettingsLyrRange.innerHTML =
                        "";
                    b.forEach(this.mapLayers, function(a) {
                        if (null != a && null != a.layer && a.layer.visible && a.layer.timeInfo && a.layer.useMapTime && !a.layer.timeInfo.hasLiveData) {
                            var c = Math.round((a.layer.timeInfo.timeExtent.startTime.getTime() - this._tSettingsSlider.get("minimum")) / d),
                                f = Math.round((a.layer.timeInfo.timeExtent.endTime - a.layer.timeInfo.timeExtent.startTime) / d),
                                m = b.create("div", { id: "bar_" + a.layer.id, "class": "time-settings-layer-bar" }, this._tSettingsLyrRange);
                            b.style(m, "width", f + "px");
                            esriGeowConfig.isRightToLeft ?
                                b.style(m, "margin", "0 " + c + "px 0 0") : b.style(m, "margin", "0 0 0 " + c + "px");
                            b.connect(m, "onclick", this, function(c) {
                                c.preventDefault();
                                this.tSettingsTipStart.innerHTML = this.i18n.setStartTime + " " + b.date.locale.format(a.layer.timeInfo.timeExtent.startTime, { formatLength: "medium" });
                                this.tSettingsTipEnd.innerHTML = this.i18n.setEndTime + " " + b.date.locale.format(a.layer.timeInfo.timeExtent.endTime, { formatLength: "medium" });
                                var d = this._tSettingsSlider.get("value"),
                                    e = d[0],
                                    f = d[1];
                                b.connect(this.tSettingsTipStart, "onclick",
                                    this,
                                    function(b) {
                                        this._tSettingsSlider.set("value", [a.layer.timeInfo.timeExtent.startTime.getTime(), f]);
                                        g.popup.close(this._toolTipDialog)
                                    });
                                b.connect(this.tSettingsTipEnd, "onclick", this, function(b) {
                                    this._tSettingsSlider.set("value", [e, a.layer.timeInfo.timeExtent.endTime.getTime()]);
                                    g.popup.close(this._toolTipDialog)
                                });
                                g.popup.open({ popup: this._toolTipDialog, around: m });
                                c || (c = window.event);
                                c.cancelBubble = !0;
                                c.stopPropagation && c.stopPropagation()
                            });
                            b.create("br", {}, this._tSettingsLyrRange)
                        }
                    }, this)
                },
                adjustSliderBackground: function(a) {
                    var c = b.coords(this._tSettingsLyrRange);
                    b.coords(this._tLayerNamesDiv);
                    var d = b.coords(this._tSettingsSlider.progressBar);
                    b.style(this._tSettingsBkgrndDiv, "top", "0px");
                    0 < d.x - c.x && b.style(this._tSettingsBkgrndDiv, "left", d.x - c.x + "px");
                    0 < d.w && b.style(this._tSettingsBkgrndDiv, "width", d.w + "px");
                    0 < d.y - c.y + 5 && b.style(this._tSettingsBkgrndDiv, "height", d.y - c.y + 5 + "px");
                    a || setTimeout(b.hitch(this, function() { this.adjustSliderBackground(!0) }), 500)
                },
                setupSliderConnection: function() {
                    this._tSettingsSliderHandler ||
                        (this._tSettingsSliderHandler = b.connect(this._tSettingsSlider, "onChange", this, "onSliderChange"))
                },
                destroySliderConnection: function() {
                    b.disconnect(this._tSettingsSliderHandler);
                    this._tSettingsSliderHandler = null
                },
                setupInputConnection: function() {
                    this.startDateHandler || (this.startDateHandler = b.connect(this._startDate, "onChange", this, "onInputChange"));
                    this.startTimeHandler || (this.startTimeHandler = b.connect(this._startTime, "onChange", this, "onInputChange"));
                    this.endDateHandler || (this.endDateHandler = b.connect(this._endDate,
                        "onChange", this, "onInputChange"));
                    this.endTimeHandler || (this.endTimeHandler = b.connect(this._endTime, "onChange", this, "onInputChange"))
                },
                destroyInputConnection: function() {
                    b.disconnect(this.startDateHandler);
                    this.startDateHandler = null;
                    b.disconnect(this.startTimeHandler);
                    this.startTimeHandler = null;
                    b.disconnect(this.endDateHandler);
                    this.endDateHandler = null;
                    b.disconnect(this.endTimeHandler);
                    this.endTimeHandler = null
                },
                onSliderChange: function(a) {
                    this.destroyInputConnection();
                    var c = Math.min(a[0], a[1]);
                    a = Math.max(a[0],
                        a[1]);
                    this.checkUpdateBars(new Date(c), new Date(a));
                    this._startDate.set("value", new Date(c));
                    this._startTime.set("value", new Date(c));
                    this._endDate.set("value", new Date(a));
                    this._endTime.set("value", new Date(a));
                    this._startDate.constraints.max = new Date(a);
                    this._endDate.constraints.min = new Date(c);
                    setTimeout(b.hitch(this, function() { this.setupInputConnection() }), 1E3)
                },
                onInputChange: function() {
                    this.destroySliderConnection();
                    var a = null,
                        c = null;
                    if (this._startDate.isValid()) {
                        var d = new Date(this._startDate.get("value")),
                            a = new Date(this._startTime.get("value")),
                            a = new Date(d.getFullYear(), d.getMonth(), d.getDate(), a.getHours(), a.getMinutes(), 0, 0);
                        this._endDate.constraints.min = d;
                        this._endDate.validate(!1)
                    }
                    this._endDate.isValid() && (d = new Date(this._endDate.get("value")), c = new Date(this._endTime.get("value")), c = new Date(d.getFullYear(), d.getMonth(), d.getDate(), c.getHours(), c.getMinutes(), 0, 0), this._startDate.constraints.max = d, this._startDate.validate(!1));
                    this._startDate.isValid() && (d = new Date(this._startDate.get("value")),
                        a = new Date(this._startTime.get("value")), a = new Date(d.getFullYear(), d.getMonth(), d.getDate(), a.getHours(), a.getMinutes(), 0, 0), this._endDate.constraints.min = d);
                    a && c && (this.checkUpdateBars(a, c), this._tSettingsSlider.set("value", [a.getTime(), c.getTime()]));
                    setTimeout(b.hitch(this, function() { this.setupSliderConnection() }), 1E3)
                },
                onFocusInterval: function() { this._stopsIntervalInput.set("checked", !0) },
                onFocusCumulative: function() { this._stopsCumalativeInput.set("checked", !0) },
                _timeSettingsStopsTimeSpanUnits_onChange: function() {
                    this._stopsIntervalTime.set("checked", !0)
                },
                _timeSettingsStopsTimeSpanUnitsCount_onChange: function() { this._stopsIntervalTime.set("checked", !0) },
                _timeSettingsStopsTimeSpanEqual_onChange: function() { this._stopsIntervalEqual.set("checked", !0) },
                getEsriUnits: function(a) {
                    var b;
                    switch (a.get("value")) {
                        case this.i18n.century:
                            b = "esriTimeUnitsCenturies";
                            break;
                        case this.i18n.decade:
                            b = "esriTimeUnitsDecades";
                            break;
                        case this.i18n.year:
                            b = "esriTimeUnitsYears";
                            break;
                        case this.i18n.month:
                            b = "esriTimeUnitsMonths";
                            break;
                        case this.i18n.week:
                            b = "esriTimeUnitsWeeks";
                            break;
                        case this.i18n.day:
                            b = "esriTimeUnitsDays";
                            break;
                        case this.i18n.hour:
                            b = "esriTimeUnitsHours";
                            break;
                        case this.i18n.minute:
                            b = "esriTimeUnitsMinutes";
                            break;
                        case this.i18n.second:
                            b = "esriTimeUnitsSeconds"
                    }
                    return b
                },
                setEsriUnits: function(a, b) {
                    switch (b) {
                        case "esriTimeUnitsCenturies":
                            a.set("value", this.i18n.century);
                            break;
                        case "esriTimeUnitsDecades":
                            a.set("value", this.i18n.decade);
                            break;
                        case "esriTimeUnitsYears":
                            a.set("value", this.i18n.year);
                            break;
                        case "esriTimeUnitsMonths":
                            a.set("value", this.i18n.month);
                            break;
                        case "esriTimeUnitsWeeks":
                            a.set("value", this.i18n.week);
                            break;
                        case "esriTimeUnitsDays":
                            a.set("value", this.i18n.day);
                            break;
                        case "esriTimeUnitsHours":
                            a.set("value", this.i18n.hour);
                            break;
                        case "esriTimeUnitsMinutes":
                            a.set("value", this.i18n.minute);
                            break;
                        case "esriTimeUnitsSeconds":
                            a.set("value", this.i18n.second);
                            break;
                        default:
                            a.set("value", this.i18n.minute)
                    }
                },
                loadUnitsOption: function(a, c, d) {
                    var f = new b.data.ItemFileWriteStore({ data: { identifier: "name", items: [] } });
                    c && d || (d = arcgisonline.map.time.fullTimeExtent,
                        c = d.startTime, d = d.endTime);
                    100 < d.getFullYear() - c.getFullYear() ? (f.newItem({ name: this.i18n.century }), f.newItem({ name: this.i18n.decade }), f.newItem({ name: this.i18n.year })) : 10 <= d.getFullYear() - c.getFullYear() ? (f.newItem({ name: this.i18n.decade }), f.newItem({ name: this.i18n.year }), f.newItem({ name: this.i18n.month })) : 314496E5 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.year }), f.newItem({ name: this.i18n.month }), f.newItem({ name: this.i18n.week })) : 24192E5 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.month }),
                            f.newItem({ name: this.i18n.week }), f.newItem({ name: this.i18n.day }), 79488E5 > d.getTime() - c.getTime() && f.newItem({ name: this.i18n.hour })) : 6048E5 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.week }), f.newItem({ name: this.i18n.day }), f.newItem({ name: this.i18n.hour })) : 864E5 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.day }), f.newItem({ name: this.i18n.hour }), f.newItem({ name: this.i18n.minute })) : 36E5 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.hour }), f.newItem({ name: this.i18n.minute }), f.newItem({ name: this.i18n.second })) :
                        6E4 < d.getTime() - c.getTime() ? (f.newItem({ name: this.i18n.minute }), f.newItem({ name: this.i18n.second })) : 1E3 < d.getTime() - c.getTime() && f.newItem({ name: this.i18n.second });
                    a.set("store", f)
                },
                logDate: function(a, b) {}
            })
        })
}, "dojox/form/RangeSlider": function() {
    define(["dojo/_base/kernel", "./_RangeSliderMixin", "./HorizontalRangeSlider", "./VerticalRangeSlider"], function(b, g) {
        b.deprecated("Call require() for HorizontalRangeSlider / VerticalRangeSlider, explicitly rather than 'dojox.form.RangeSlider' itself", "", "2.0");
        return g
    })
}, "dojox/form/VerticalRangeSlider": function() { define(["dojo/_base/declare", "dojox/form/_RangeSliderMixin", "dojo/text!./resources/VerticalRangeSlider.html", "dijit/form/VerticalSlider"], function(b, g, n, a) { return b("dojox.form.VerticalRangeSlider", [a, g], { templateString: n }) }) }, "dijit/form/VerticalSlider": function() {
    define(["dojo/_base/declare", "./HorizontalSlider", "dojo/text!./templates/VerticalSlider.html"], function(b, g, n) {
        return b("dijit.form.VerticalSlider", g, {
            templateString: n,
            _mousePixelCoord: "pageY",
            _pixelCount: "h",
            _startingPixelCoord: "y",
            _handleOffsetCoord: "top",
            _progressPixelSize: "height",
            _descending: !0,
            _isReversed: function() { return this._descending }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/MapSettingsDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/i18n!arcgisonline/nls/arcgisonline", "dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dojo/i18n,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/main"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.MapSettingsDlg");
        b.require("dijit._Widget");
        b.require("dijit._Templated");
        b.require("dijit.form.Button");
        b.require("dojo.i18n");
        b.requireLocalization("arcgisonline", "arcgisonline");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.require("arcgisonline.map.main");
        b.declare("arcgisonline.sharing.dijit.dialog.MapSettingsDlg", [g._Widget, g._Templated], {
            widgetsInTemplate: !0,
            templateString: b.cache("arcgisonline.sharing.dijit.dialog", "templates/MapSettingsDlg.html", '\x3cdiv dojoAttachPoint\x3d"containerNode" dojoType\x3d"dijit.layout.BorderContainer" class\x3d"esriItemLinks" gutters\x3d"false" design\x3d"headline" region\x3d"center"\x3e\r\n  \x3cdiv dojoType\x3d"dijit.layout.ContentPane"  region\x3d"center"\x3e\r\n    \x3cdiv\x3e\r\n      ${i18n.howMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 8px;"\x3e\r\n      ${i18n.showTimeLabel}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin1" style\x3d"margin-top: 15px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cinput type\x3d"radio" name\x3d"pffsetType" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_mapSettingsOffsetCurrent" checked\x3d"checked" dojoAttachEvent\x3d"onClick:_onOffsetTypeChange"/\x3e\r\n        \x3clabel for\x3d"linePlacement:above"\x3e\r\n          ${i18n.currentTime}\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"margin-top: 10px;"\x3e\r\n        \x3cdiv\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"pffsetType" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_mapSettingsOffsetFixed" dojoAttachEvent\x3d"onClick:_onOffsetTypeChange" /\x3e\r\n          \x3clabel for\x3d"linePlacement:on"\x3e\r\n            ${i18n.fixedTime}\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin107" style\x3d"margin-top: 7px;"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n              \x3cspan\x3e${i18n.timeZoneLabel}\x3c/span\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3cspan\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3cspan\x3e${i18n.utc}\x3c/span\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3cspan\x3e\x26nbsp;\x3c/span\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3cselect dojoType\x3d"dijit.form.ComboBox" dojoAttachPoint\x3d"_mapSettingsOffset" dojoAttachEvent\x3d"onChange:_onChangeUTCOffset" style\x3d"width:80px;"\x3e\x3c/select\x3e\r\n              \x3c!--\x3cinput dojoAttachPoint\x3d"_mapSettingsOffset" dojoAttachEvent\x3d"onChange:_onChangeUTCOffset" intermediateChanges\x3d"false" dojoType\x3d"dijit.form.NumberSpinner" value\x3d"5" smallDelta\x3d"1" constraints\x3d"{min:2,max:100,places:0}" style\x3d"width:40px; margin: 0 5px;"/\x3e--\x3e\r\n            \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"margin-top: 20px;"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n      \x3cspan dojoAttachPoint\x3d"_mapSettingsCurrentOffset"\x3e\x3c/span\x3e\r\n    \x3c/td\x3e\x3ctd\x3e\r\n      \x3cspan\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e\r\n    \x3c/td\x3e\x3ctd\x3e\r\n      \x3cA href\x3d"Javascript:void(0);" dojoAttachPoint\x3d"_mapSettingsLeanMore"\x3e\r\n        ${i18n.learnMore}\r\n      \x3c/A\x3e\r\n    \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d"dijit.layout.ContentPane"  region\x3d"bottom" class\x3d"esriFloatTrailing" style\x3d"margin:10px 0;"\x3e\r\n    \x3cbutton type\x3d"button" data-dojo-attach-point\x3d"_okBtn" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_onOK" class\x3d"calcite primary"\x3e${i18n.ok}\x3c/button\x3e\r\n    \x3cbutton type\x3d"button" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_onCancel" class\x3d"calcite cancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'),
            isLayoutContainer: !0,
            baseClass: "esriAGOMapSettingsDialog",
            disableChangeEvents: !0,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").MapSettingsDlg)
            },
            startup: function() {
                this.inherited(arguments);
                this._loadConnections()
            },
            _loadConnections: function() { this._dlgConnect = b.connect(this.dialog, "hide", b.hitch(this, function() { this.destroy() })) },
            start: function() {
                this._setUpComboBox();
                var a, c, d = -1 * ((new Date).getTimezoneOffset() / 60),
                    f = this._mapSettingsOffset.get("store").data;
                for (c = 0; c < f.length; c++) { var e = f[c]; if (e.id === d) { a = e; break } }
                this._mapSettingsCurrentOffset.innerHTML = a ? b.string.substitute(this.i18n.yourOffset, { offset: a.name.replace(/ /g, "") }) : "";
                if (esri.isDefined(arcgisonline.map.main.map.utcOffset)) {
                    var g, d = arcgisonline.map.main.map.utcOffset / 60;
                    for (c = 0; c < f.length; c++)
                        if (e = f[c], e.id === d) { g = e; break }
                    g ? this._mapSettingsOffset.set("value", g.name) : this._mapSettingsOffset.set("value",
                        "---");
                    this._mapSettingsOffsetFixed.set("checked", !0)
                } else a ? this._mapSettingsOffset.set("value", a.name) : this._mapSettingsOffset.set("value", "0:00"), this._mapSettingsOffsetCurrent.set("checked", !0);
                setTimeout(b.hitch(this, function() { this.disableChangeEvents = !1 }), 2E3)
            },
            _onOK: function() {
                if (this._mapSettingsOffsetFixed.get("checked")) {
                    var a = this._mapSettingsOffset.get("item");
                    arcgisonline.map.main.map.utcOffset = 60 * a.id;
                    b.publish("onUTCOffsetChange")
                } else delete arcgisonline.map.main.map.utcOffset;
                b.style(this.dialog.domNode,
                    "display", "none");
                this.dialog && this.dialog.hide()
            },
            _onCancel: function() {
                b.style(this.dialog.domNode, "display", "none");
                this.dialog && this.dialog.hide()
            },
            destroy: function() {
                b.disconnect(this.addExprHandler);
                b.disconnect(this.addSetHandler);
                b.unsubscribe(this.exprChangeHandler);
                b.unsubscribe(this.ineractiveExprChangeHandler);
                this.inherited(arguments)
            },
            _onChangeUTCOffset: function() { this.disableChangeEvents || this._mapSettingsOffsetFixed.set("checked", !0) },
            _onOffsetTypeChange: function() {},
            _setUpComboBox: function() {
                var a =
                    new b.store.Memory({
                        data: [{ name: "-12:00", id: -12 }, { name: "-11:30", id: -11.5 }, { name: "-11:00", id: -11 }, { name: "-10:30", id: -10.5 }, { name: "-10:00", id: -10 }, { name: "- 9:30", id: -9.5 }, { name: "- 9:00", id: -9 }, { name: "- 8:30", id: -8.5 }, { name: "- 8:00", id: -8 }, { name: "- 7:30", id: -7.5 }, { name: "- 7:00", id: -7 }, { name: "- 6:30", id: -6.5 }, { name: "- 6:00", id: -6 }, { name: "- 5:30", id: -5.5 }, { name: "- 5:00", id: -5 }, { name: "- 4:30", id: -4.5 }, { name: "- 4:00", id: -4 }, { name: "- 3:30", id: -3.5 }, { name: "- 3:00", id: -3 }, { name: "- 2:30", id: -2.5 }, {
                            name: "- 2:00",
                            id: -2
                        }, { name: "- 1:30", id: -1.5 }, { name: "- 1:00", id: -1 }, { name: "- 0:30", id: -.5 }, { name: "  0:00", id: "0" }, { name: "+ 0:30", id: .5 }, { name: "+ 1:00", id: 1 }, { name: "+ 1:30", id: 1.5 }, { name: "+ 2:00", id: 2 }, { name: "+ 2:30", id: 2.5 }, { name: "+ 3:00", id: 3 }, { name: "+ 3:30", id: 3.5 }, { name: "+ 4:00", id: 4 }, { name: "+ 4:30", id: 4.5 }, { name: "+ 5:00", id: 5 }, { name: "+ 5:30", id: 5.5 }, { name: "+ 6:00", id: 6 }, { name: "+ 6:30", id: 6.5 }, { name: "+ 7:00", id: 7 }, { name: "+ 7:30", id: 7.5 }, { name: "+ 8:00", id: 8 }, { name: "+ 8:30", id: 8.5 }, { name: "+ 9:00", id: 9 }, {
                            name: "+ 9:30",
                            id: 9.5
                        }, { name: "+10:00", id: 10 }, { name: "+10:30", id: 10.5 }, { name: "+11:00", id: 11 }, { name: "+11:30", id: 11.5 }, { name: "+12:00", id: 12 }]
                    });
                this._mapSettingsOffset.set("store", a);
                this._mapSettingsOffset.set("searchAttr", "name");
                this._mapSettingsOffset.set("labelAttr", "name");
                this._mapSettingsOffset.set("labelType", "text");
                this._mapSettingsOffset.set("value", "0:00")
            }
        })
    })
}, "arcgisonline/sharing/dijit/dialog/MdSliderSettingsDlg": function() {
    define(["dojo", "dijit", "dojox", "dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/Select,dijit/Tooltip,dojox/form/HorizontalRangeSlider,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/dialog/GeneralDlg"],
        function(b, g, n) {
            b.provide("arcgisonline.sharing.dijit.dialog.MdSliderSettingsDlg");
            b.require("dijit.Dialog");
            b.require("dijit._Widget");
            b.require("dijit._Templated");
            b.require("dijit.form.Select");
            b.require("dijit.Tooltip");
            b.require("dojox.form.HorizontalRangeSlider");
            b.require("arcgisonline.sharing.dijit.HelpManager");
            b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
            b.declare("arcgisonline.sharing.dijit.dialog.MdSliderSettingsDlg", [g._Widget, g._Templated], {
                widgetsInTemplate: !0,
                templateString: '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_mdSliderSettingsDialog" title\x3d"${i18n.mdSliderSettingsDlgTitle}" doLayout\x3d"false" execute\x3d"" style\x3d"width: 630px;"\x3e\r\n    \x3ctable style\x3d"width: 600px;"\x3e\r\n      \x3ccolgroup\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e        \r\n      \x3c/colgroup\x3e\r\n      \x3ctbody style\x3d"width: 100%;"\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\x3clabel\x3e${i18n.dimension}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd\x3e\x3cdiv style\x3d"width: 100%;" dojoType\x3d"dijit.form.Select" dojoAttachPoint\x3d"_dimensionSelect" dojoAttachEvent\x3d"onChange: _handleDimensionChange"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3ctd\x3e\x3clabel\x3e\r\n            \x3cdiv style\x3d"margin-left: 5px;" dojoType\x3d"dijit.form.CheckBox" checked\x3d"checked" dojoAttachPoint\x3d"_reverseAnimationCheckBox"\x3e\x3c/div\x3e\r\n            ${i18n.reverseAnimation}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd style\x3d"height: 16px;"\x3e\r\n            \x3clabel\x3e\r\n              \x3cdiv dojoType\x3d"dijit.form.CheckBox" checked\x3d"checked" dojoAttachPoint\x3d"_useRangeCheckBox" dojoAttachEvent\x3d"onChange: _handleUseRangeChange"\x3e\x3c/div\x3e\r\n            ${i18n.useDimensionRange}\x3c/label\x3e\r\n            \x3cdiv class\x3d"esriMdSliderHasRangesInfo" id\x3d"mdSliderDlgHasRangesInfo" dojoAttachPoint \x3d"_mdSliderDlgHasRangesInfo"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit.Tooltip" data-dojo-props\x3d"connectId:\'mdSliderDlgHasRangesInfo\',position:[\'after\']"\x3e\r\n                 \x3cdiv\x3e\r\n                   ${i18n.hasRangesInfoText1}\x3cbr/\x3e\r\n                   ${i18n.hasRangesInfoText2}\r\n                 \x3c/div\x3e\r\n               \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4" style\x3d"padding-top: 10px;"\x3e\r\n            \x3clabel style\x3d"font-weight: bold;"\x3e${i18n.playbackSpeed}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4"\x3e\r\n            \x3cdiv dojoType\x3d"dijit.form.HorizontalSlider" dojoAttachEvent\x3d"onChange: _onPlaybackSpeedChange" dojoAttachPoint\x3d"_mdSpeedSlider" style\x3d"width: 600px; margin:3px; " showbuttons\x3d"false" value\x3d"1" minimum\x3d"0" maximum\x3d"4" discretevalues\x3d"1" intermediatechanges\x3d"true"\x3e\r\n              \x3cdiv dojoType\x3d"dijit.form.HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\x3c/div\x3e\r\n              \x3col data-dojo-type\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height:1em;font-size:75%;color:gray;"\x3e\r\n                \x3cli\x3e${i18n.slower}\x3c/li\x3e\r\n                \x3cli\x3e${i18n.faster}\x3c/li\x3e\r\n              \x3c/ol\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4"\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_mdAdvancedLink" style\x3d"padding-top:15px;" class\x3d"esriItemLinks esriFloatLeading"\x3e\x3ca href\x3d"JavaScript:void(0);" dojoAttachEvent\x3d"onclick:_showAdvanced"\x3e${i18n.showAdvancedOptions}\x3c/a\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"advancedSettingsTable" style\x3d"width: 600px; display: none;"\x3e\r\n      \x3ctable\x3e\r\n      \x3ccolgroup\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e        \r\n      \x3c/colgroup\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4" style\x3d"padding-top: 10px;"\x3e\r\n            \x3clabel style\x3d"font-weight: bold;"\x3e${i18n.dimensionRange}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4" style\x3d"padding-top: 7px;"\x3e\r\n            \x3clabel\x3e\r\n              \x3cdiv dojoType\x3d"dijit.form.CheckBox" dojoAttachEvent\x3d"onChange: _disableDimRangeControls" dojoAttachPoint\x3d"_useDimSlices" checked\x3d"checked"\x3e\x3c/div\x3e\r\n            ${i18n.useDimensionSlices}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n      \x3ctable dojoAttachPoint \x3d "_dimensionRangeControls" style\x3d"width: 100%; display: table;"\x3e\r\n        \x3ccolgroup\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e\r\n        \x3ccol style\x3d"width:25%"\x3e        \r\n      \x3c/colgroup\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4" style\x3d"padding-bottom: 7px;"\x3e\r\n            \x3clabel \x3e${i18n.dimensionRangeDesc}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"1"\x3e\r\n            \x3clabel\x3e${i18n.layers}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel\x3e${i18n.layerDimensionRanges}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr height\x3d"5"\x3e\r\n          \x3ctd height\x3d"5" colspan\x3d"4"\x3e\r\n            \x3cdiv style\x3d"height:1px;border-top:#444444 1px solid;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3cdiv dojoAttachPoint\x3d"_mdLayerNamesDiv" class\x3d"mdSliderSettingsLayerNames"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" colspan\x3d"3"\x3e\r\n            \x3cdiv style\x3d"position: relative;" valign\x3d"top"\x3e\r\n              \x3cdiv dojoAttachPoint\x3d"_mdSettingsBkgrndDiv" class\x3d"mdSettingsBackground" style\x3d"position:absolute; z-index:0;"\x3e\x3c/div\x3e\r\n              \x3cdiv dojoAttachPoint\x3d"_mdSettingsLyrRangeDiv" class\x3d"mdSettingsLayerRange" style\x3d"position:relative; z-index:10;" \x3e\x3c/div\x3e\r\n              \x3cdiv style\x3d"width:100%;"\x3e\r\n              \x3cdiv id\x3d"mdSettingsSliderDiv" style\x3d"margin-right:8px;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr style\x3d"height: 10px"\x3e\r\n         \x3ctd colspan\x3d"4" style\x3d"height: 10px"\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\x3c/td\x3e\r\n          \x3ctd colspan\x3d"1"\x3e\x3clabel\x3e${i18n.start}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd colspan\x3d"1"\x3e\x3cdiv style\x3d"width: 100%; height: 22px; padding: 2px; box-sizing: border-box; margin-top: 7px;" dojoType\x3d"dijit.form.NumberTextBox" dojoAttachPoint\x3d"_dimRangeStart" constraints\x3d"{places: 10}"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3ctd\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\x3c/td\x3e\r\n          \x3ctd colspan\x3d"1"\x3e\x3clabel\x3e${i18n.end}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd colspan\x3d"1"\x3e\x3cdiv style\x3d"width: 100%; height: 22px; padding: 2px; box-sizing: border-box;" dojoType\x3d"dijit.form.NumberTextBox" dojoAttachPoint\x3d"_dimRangeEnd" constraints\x3d"{places: 10}"\x3e\x3c/div\x3e\x3c/td\x3e\r\n          \x3ctd\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4" style\x3d"padding-top: 10px;"\x3e\r\n            \x3clabel style\x3d"font-weight: bold;"\x3e${i18n.interval}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4"\x3e\r\n            \x3clabel\x3e${i18n.intervalDesc}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"4"\x3e\r\n            \x3clabel\x3e${i18n.displayData}\x3c/label\x3e \r\n            \x3cdiv style\x3d"height: 22px; width: 100px; padding: 2px; box-sizing: border-box;" dojoType\x3d"dijit.form.NumberTextBox" dojoAttachPoint\x3d"_dimInterval"\x3e\x3c/div\x3e\r\n            \x3clabel  dojoAttachPoint\x3d"_unitLabel" style\x3d"font-weight: 700"\x3e${i18n.unknownUnit}\x3c/label\x3e\r\n            \x3clabel\x3e${i18n.intervals}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_mdSettingsHelp" style\x3d"padding-top:15px; display:none;" class\x3d"esriItemLinks esriFloatLeading"\x3e\x3ca dojoAttachPoint\x3d"_helpLink" href\x3d"" target\x3d"_blank" title\x3d"${i18n.learnMore}"\x3e\x3cdiv class\x3d"questionMarkIcon"\x3e\x3c/div\x3e\x3c/A\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n      \x3cbutton class\x3d"jevent primary" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleOkBtnClick"\x3e${i18n.ok}\x3c/button\x3e\r\n      \x3cbutton class\x3d"jevent cancel" dojoType\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleCloseBtnClick"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e  \r\n    \r\n    \x3cdiv dojotype\x3d"dijit.TooltipDialog" dojoAttachPoint\x3d"_tooltipDialog" title\x3d"" style\x3d"display:none;width:400px;"\x3e\r\n      \x3c!--\x3cdiv style\x3d"float:right;"\x3e\x3cA id\x3d"time-settings-tooltip-close" href\x3d"JavaScript:void(0);" title\x3d"Close"\x3e\x3cimg src\x3d"images/close.gif" border\x3d"0"/\x3e\x3c/A\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"esriItemLinks"\x3e\x3ca dojoAttachPoint\x3d"mdSettingsTipStart"  href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriItemLinks"\x3e\x3ca  dojoAttachPoint\x3d"mdSettingsTipEnd" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
                statics: { _instance: null, getInstance: function() { null == this._instance && (this._instance = new arcgisonline.sharing.dijit.dialog.MdSliderSettingsDlg); return this._instance } },
                postMixInProperties: function() {
                    this.inherited(arguments);
                    this.i18n = b.i18n.getLocalization("arcgisonline", "arcgisonline").common;
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").generalDlg);
                    b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").MdSliderSettingsDlg)
                },
                show: function(a) {
                    this._loadConnectionsPart1();
                    this._showAdvanced(!1);
                    this._disableShowAdvanced();
                    this._mdSliderSettingsDialog.show()
                },
                _disableShowAdvanced: function() { arcgisonline.map.multiDimensions.mdSlider.hasUnitConflict() ? b.style(this._mdAdvancedLink, "display", "none") : b.style(this._mdAdvancedLink, "display", "block") },
                _showAdvanced: function(a) {
                    "undefined" == typeof a || a ? (b.style(this.advancedSettingsTable, "display", "block"), b.style(this._mdAdvancedLink, "display", "none"), this._loadConnectionsPart2(), this.adjustSliderBackground()) : (b.style(this.advancedSettingsTable,
                        "display", "none"), b.style(this._mdAdvancedLink, "display", "block"));
                    this._mdSliderSettingsDialog._position()
                },
                _onPlaybackSpeedChange: function(a) {},
                _handleOkBtnClick: function() {
                    this._saveSettings();
                    this._mdSliderSettingsDialog.hide()
                },
                _handleCloseBtnClick: function() { this._mdSliderSettingsDialog.hide() },
                _loadConnectionsPart1: function() {
                    this._loadDimensions();
                    this._loadSliderSpeed();
                    this._loadUseRanges();
                    this._loadAnimationDirection()
                },
                _loadConnectionsPart2: function() {
                    this._loadUseMapDimensionValues();
                    this._createDimensionRangeSlider();
                    this._disableDimRangeControls(this._useDimSlices.checked);
                    this._rebuildBars()
                },
                _loadDimensions: function() {
                    this._dimensionStore = new b.data.ObjectStore({ objectStore: new b.store.Memory({ data: arcgisonline.map.multiDimensions.getNumericDimensions() }) });
                    this._dimensionSelect.set("store", this._dimensionStore);
                    this._dimensionSelect.set("value", arcgisonline.map.multiDimensions.mdSlider.dimension)
                },
                _loadUseMapDimensionValues: function() {
                    this._useDimSlices.set("checked", arcgisonline.map.multiDimensions.mdSlider.useLayersDimSlices);
                    this._disableDimRangeControls(this._useDimSlices.checked)
                },
                _loadUseRanges: function() {
                    var a = arcgisonline.map.multiDimensions.mdSlider._snap ? "inline-block" : "none";
                    this._useRangeCheckBox.set("checked", arcgisonline.map.multiDimensions.mdSlider.useRanges);
                    b.setStyle(this._mdSliderDlgHasRangesInfo, "display", a)
                },
                _loadSliderSpeed: function() { this._mdSpeedSlider.set("value", 5 - arcgisonline.map.multiDimensions.mdSlider.thumbMovingRate / 1E3) },
                _loadAnimationDirection: function() {
                    this._reverseAnimationCheckBox.set("checked", !arcgisonline.map.multiDimensions.mdSlider.playDirectionAscending)
                },
                _validateUserRange: function(a) { if (!a) return !1; var b = arcgisonline.map.multiDimensions.mdSlider.getFullDimensionRange(this._dimensionSelect.value); return b && b.length && 1 < b.length && !(a[0] >= b[0] && a[0] <= b[1] && a[1] >= b[0] && a[1] <= b[1]) ? !1 : !0 },
                _saveSettings: function() {
                    var a = this._mdSpeedSlider.getValue(),
                        a = Math.round(1E3 * (5 - a)),
                        c = !esri.isDefined(this._dimInterval.value) || isNaN(this._dimInterval.value) || 0 == this._dimInterval.value ? null : this._dimInterval.value;
                    arcgisonline.map.multiDimensions.mdSlider.setThumbMovingRate(a);
                    var d;
                    arcgisonline.map.multiDimensions.mdSlider.getFullDimensionRange(this._dimensionSelect.value);
                    if (!this._useDimSlices.checked && c) {
                        d = [this._dimRangeStart.value, this._dimRangeEnd.value];
                        this._validateUserRange(d) && this._useDimSlices.set("checked", !1);
                        c > d[1] - d[0] && (c = d[1] - d[0]);
                        var f = arcgisonline.map.multiDimensions.createDimensionValues(this._dimensionRangeSlider.value, c);
                        f && f.length || this._useDimSlices.set("checked", !0)
                    } else c || this._useDimSlices.set("checked", !0);
                    arcgisonline.map.multiDimensions.mdSliderProperties = { thumbMovingRate: a, dimension: this._dimensionSelect.value, dimensionRange: d, useRanges: this._useRangeCheckBox.checked, dimensionInterval: c, nLabels: 10, playDirectionAscending: !this._reverseAnimationCheckBox.checked, useLayersDimSlices: this._useDimSlices.checked };
                    arcgisonline.map.multiDimensions.mdSlider.useLayersDimSlices = this._useDimSlices.checked;
                    arcgisonline.map.multiDimensions.mdSlider.useDefaults = !1;
                    this._dimensionSelect.value != arcgisonline.map.multiDimensions.mdSlider.dimension &&
                        b.forEach(arcgisonline.map.main.mapLayers, function(a) { a && a.layer && a.multidimensionalInfo && (arcgisonline.map.multiDimensions.addActiveDimension(a.layer, this._dimensionSelect.value), arcgisonline.map.multiDimensions.removeActiveDimension(a.layer)) }, this);
                    arcgisonline.map.multiDimensions.mdSlider.useRanges = this._useRangeCheckBox.checked;
                    arcgisonline.map.multiDimensions.mdSlider.playDirectionAscending = !this._reverseAnimationCheckBox.checked;
                    arcgisonline.map.multiDimensions.mdSlider.set("dimension", {
                        dimension: this._dimensionSelect.value,
                        dimensionValues: f
                    });
                    arcgisonline.map.multiDimensions.removeHandles();
                    arcgisonline.map.multiDimensions.setupHandles()
                },
                _createDimensionRangeSlider: function() {
                    var a = this,
                        c;
                    if (this._dimensionRangeSlider) {
                        this._dimensionRangeSlider.destroy(!0);
                        this._dimensionRangeSlider = null;
                        for (var d = b.byId("mdSettingsSliderDiv"); d.firstChild;) d.removeChild(d.firstChild)
                    }
                    var d = this._getMapDimensionExtent(this._dimensionSelect.value),
                        f = this._useDimSlices.checked;
                    this._dimensionSelect.value == arcgisonline.map.multiDimensions.mdSlider.dimension ?
                        (c = arcgisonline.map.multiDimensions.mdSlider.dimensionValues, c = [c[0], c[c.length - 1]]) : c = d;
                    d && 2 == d.length && (this._dimensionRangeSlider = new n.form.HorizontalRangeSlider({
                            minimum: d[0],
                            maximum: d[1],
                            value: c,
                            style: "margin-right: 8px; width: 100%;",
                            showButtons: !1,
                            disabled: f,
                            onChange: function(b) {
                                b = a._correctDimensionLimits(b);
                                a._dimRangeStart.set("value", b[0]);
                                a._dimRangeEnd.set("value", b[1]);
                                a.adjustSliderBackground()
                            }
                        }, "mdSettingsSliderDiv"), this._dimensionRangeSlider.set("value", c), this._dimRangeStart.set("constraints", { min: d[0], max: d[1], pattern: "#0.####" }), this._dimRangeEnd.set("constraints", { min: d[0], max: d[1], pattern: "#0.####" }), this._dimRangeStart.set("value", c[0]), this._dimRangeEnd.set("value", c[1]), arcgisonline.map.multiDimensions.mdSliderProperties.dimensionInterval ? this._dimInterval.set("value", arcgisonline.map.multiDimensions.mdSliderProperties.dimensionInterval) : this._dimInterval.set("value", 1), this._unit = arcgisonline.map.multiDimensions.mdSlider.getUnit(), this._unitLabel.innerHTML = this._unit ? this._unit :
                        this.i18n.unknownUnit, this.startValueChangeConnect = b.connect(this._dimRangeStart, "onChange", this, "setDimRangeValue"), this.startValueChangeConnect = b.connect(this._dimRangeEnd, "onChange", this, "setDimRangeValue"))
                },
                _correctDimensionLimits: function(a) {
                    var c = this._dimensionRangeSlider.minimum,
                        d = this._dimensionRangeSlider.maximum;
                    b.forEach(a, function(b, e) {
                        b <= c && (a[e] = c);
                        b >= d && (a[e] = d)
                    });
                    return a
                },
                setDimRangeValue: function() {
                    var a = [this._dimRangeStart.value, this._dimRangeEnd.value];
                    this._dimensionRangeSlider &&
                        this._dimensionRangeSlider.valueNode && this._validateUserRange(a) && this._dimensionRangeSlider.set("value", [this._dimRangeStart.value, this._dimRangeEnd.value])
                },
                _disableDimRangeControls: function(a) {
                    var c = arcgisonline.map.multiDimensions.mdSlider.getFullDimensionRange(this._dimensionSelect.value),
                        d = (a = "undefined" == typeof a ? !0 : a) ? "#969696" : "#464646";
                    this._dimensionRangeSlider && this._dimensionRangeSlider.valueNode && c && (a && (this._dimensionRangeSlider.set("value", c), this._dimInterval.set("value", 1)), this._dimensionRangeSlider.set("disabled",
                        a), this._dimRangeStart.set("disabled", a), this._dimRangeEnd.set("disabled", a), this._dimInterval.set("disabled", a), b.style(this._dimensionRangeControls, "color", d))
                },
                _rebuildBars: function() {
                    var a = arcgisonline.map.multiDimensions.mdSlider.getFullDimensionRange(),
                        c = parseInt(b.style(b.byId("mdSettingsSliderDiv"), "width")) - 2 - 16,
                        d = a / Math.abs(c),
                        f = this._dimensionSelect.value;
                    this._mdSettingsLyrRangeDiv.innerHTML = "";
                    this._mdLayerNamesDiv.innerHTML = "";
                    b.forEach(arcgisonline.map.main.mapLayers, function(a) {
                        if (null !=
                            a && null != a.layer && this._isImageServiceLayer(a.layer) && this._hasDimension(a.layer, f)) {
                            var c = a.title;
                            21 < c.length && (c = c.substring(0, 18) + "...");
                            b.create("span", { innerHTML: c, "class": "timeSettingsLayerNames" }, this._mdLayerNamesDiv);
                            b.create("br", {}, this._mdLayerNamesDiv);
                            var e = this._getDimensionExtent(a.layer, f),
                                c = Math.round((e[0] - this._dimensionRangeSlider.get("minimum")) / d),
                                n = Math.round((e[1] - e[0]) / d),
                                r = b.create("div", { id: "mdBar_" + a.layer.id, "class": "multidimensions-settings-layer-bar" }, this._mdSettingsLyrRangeDiv);
                            0 <= n && isNaN(n) && b.style(r, "width", n + "px");
                            esriGeowConfig.isRightToLeft ? b.style(r, "margin", "0 " + c + "px 0 0") : b.style(r, "margin", "0 0 0 " + c + "px");
                            b.create("br", {}, this._mdSettingsLyrRangeDiv);
                            b.connect(r, "onclick", this, function(a) {
                                a.preventDefault();
                                this.mdSettingsTipStart.innerHTML = this.i18n.setStartValue + " " + e[0];
                                this.mdSettingsTipEnd.innerHTML = this.i18n.setEndValue + " " + e[1];
                                b.connect(this.mdSettingsTipStart, "onclick", this, function(a) {
                                    this._dimRangeStart.set("value", e[0]);
                                    g.popup.close(this._tooltipDialog)
                                });
                                b.connect(this.mdSettingsTipEnd, "onclick", this, function(a) {
                                    this._dimRangeEnd.set("value", e[1]);
                                    g.popup.close(this._tooltipDialog)
                                });
                                g.popup.open({ popup: this._tooltipDialog, around: r });
                                a || (a = window.event);
                                a.cancelBubble = !0;
                                a.stopPropagation && a.stopPropagation()
                            })
                        }
                    }, this)
                },
                _isImageServiceLayer: function(a) { return a instanceof esri.layers.ArcGISImageServiceLayer || a instanceof esri.layers.ArcGISImageServiceVectorLayer },
                _hasDimension: function(a, c) {
                    if (!a || !c) return !1;
                    var d = !1;
                    a.multidimensionalInfo && a.visible &&
                        a.useMapDimensionValue && b.forEach(a.multidimensionalInfo.variables, function(a) { b.some(a.dimensions, function(a) { return a.name === c }) && (d = !0) });
                    return d
                },
                _getDimensionExtent: function(a, c) {
                    var d = [];
                    b.forEach(a.multidimensionalInfo.variables, function(a) { b.some(a.dimensions, function(a) { if (a.name === c) { if ("undefined" == typeof d[0] || d[0] > a.extent[0]) d[0] = a.extent[0]; if ("undefined" == typeof d[1] || d[1] < a.extent[1]) d[1] = a.extent[1]; return !0 } }) });
                    return d
                },
                _handleDimensionChange: function(a) {
                    this._handleUseRangeChange(this._useRangeCheckBox.checked);
                    this._dimensionRangeSlider && (a = arcgisonline.map.multiDimensions.getUnit(a), this._createDimensionRangeSlider(), this._rebuildBars(), this._unitLabel.innerHTML = a ? a : this.i18n.unknownUnit)
                },
                _getMapDimensionExtent: function(a) {
                    var c = [],
                        d;
                    b.forEach(arcgisonline.map.main.mapLayers, function(b) { if (this._hasDimension(b.layer, a)) { d = this._getDimensionExtent(b.layer, a); if ("undefined" == typeof c[0] || c[0] > d[0]) c[0] = d[0]; if ("undefined" == typeof c[1] || c[1] < d[1]) c[1] = d[1] } }, this);
                    return c
                },
                adjustSliderBackground: function(a) {
                    if (this._dimensionRangeSlider) {
                        var c =
                            b.coords(this._mdSettingsLyrRangeDiv),
                            d = b.coords(this._dimensionRangeSlider.progressBar);
                        b.style(this._mdSettingsBkgrndDiv, "top", "0px");
                        b.style(this._mdSettingsBkgrndDiv, "left", d.x - c.x + "px");
                        0 < d.w ? b.style(this._mdSettingsBkgrndDiv, "width", d.w + "px") : b.style(this._mdSettingsBkgrndDiv, "width", "1px");
                        0 < d.y - c.y + 5 && b.style(this._mdSettingsBkgrndDiv, "height", d.y - c.y + 5 + "px");
                        a || setTimeout(b.hitch(this, function() { this.adjustSliderBackground(!0) }), 500)
                    }
                },
                _handleUseRangeChange: function(a) {
                    if (a) b.style(this._mdSliderDlgHasRangesInfo,
                        "display", "none");
                    else {
                        var c = !0,
                            d = this._dimensionSelect.value;
                        b.forEach(arcgisonline.map.main.mapLayers, function(a) { a.multidimensionalInfo && b.forEach(a.multidimensionalInfo.variables, function(a) { b.forEach(a.dimensions, function(a) { a.name != d || a.hasRanges || (c = !1) }, this) }, this) }, this);
                        c ? b.style(this._mdSliderDlgHasRangesInfo, "display", "inline-block") : b.style(this._mdSliderDlgHasRangesInfo, "display", "none")
                    }
                }
            })
        })
}, "arcgisonline/sharing/dijit/dialog/CsvLocationDlg": function() {
    define(["dojo", "dijit", "dojox",
        "dojo/i18n!arcgisonline/nls/arcgisonline", "dojo/require!dijit/form/Form,dojox/form/Manager,dijit/form/Button,dijit/form/Select,dojox/validate/regexp,dojox/widget/Standby,dojo/i18n,esri/symbols/SimpleMarkerSymbol,esri/renderers/SimpleRenderer,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/_CsvLocationDlgMixin,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/main,arcgisonline/sharing/dijit/HelpManager"
    ], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog.CsvLocationDlg");
        b.require("dijit.form.Form");
        b.require("dojox.form.Manager");
        b.require("dijit.form.Button");
        b.require("dijit.form.Select");
        b.require("dojox.validate.regexp");
        b.require("dojox.widget.Standby");
        b.require("dojo.i18n");
        b.requireLocalization("arcgisonline", "arcgisonline");
        b.require("esri.symbols.SimpleMarkerSymbol");
        b.require("esri.renderers.SimpleRenderer");
        b.require("arcgisonline.sharing.util");
        b.require("arcgisonline.sharing.dijit.dialog._CsvLocationDlgMixin");
        b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
        b.require("arcgisonline.map.main");
        b.require("arcgisonline.sharing.dijit.HelpManager");
        b.declare("arcgisonline.sharing.dijit.dialog.CsvLocationDlg", [g.form.Form, g._WidgetsInTemplateMixin, n.form.manager._Mixin, n.form.manager._NodeMixin, n.form.manager._EnableMixin, n.form.manager._ValueMixin, n.form.manager._DisplayMixin, n.form.manager._ClassMixin, arcgisonline.sharing.dijit.dialog._CsvLocationDlgMixin], {
            templateString: b.cache("arcgisonline.sharing.dijit.dialog", "templates/CsvLocationDlg.html", '\x3cform data-dojo-attach-point\x3d"containerNode" enctype\x3d"multipart/form-data" action\x3d"" method\x3d"POST"  data-dojo-attach-event\x3d"onsubmit:onSubmit"\x3e\r\n\x3cdiv data-dojo-attach-point\x3d"formNode" class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n  \x3cp class\x3d"csv" id\x3d"locateDiv"\x3e\r\n    \x3cdiv style\x3d"margin-bottom:10px;"\x3e${i18n.locateUsing}\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"margin-left: 5px; margin-right:5px;" nowrap\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"geocode:latLong" name\x3d"geocode"  value\x3d"locationTypes" checked /\x3e\r\n        \x3clabel for\x3d"geocode:latLong"\x3e${i18n.coordinates}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"margin-left: 5px; margin-right:5px;" nowrap\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"geocode:addr" name\x3d"geocode" value\x3d"addressTypes" /\x3e\r\n        \x3clabel for\x3d"geocode:addr"\x3e${i18n.address}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" nowrap style\x3d"margin-left: 5px; margin-right:5px; margin-bottom:10px;"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit.form.RadioButton" id\x3d"geocode:table" name\x3d"geocode" value\x3d"none" /\x3e\r\n        \x3clabel for\x3d"geocode:table"\x3e${i18n.table}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/p\x3e\r\n  \x3cdiv style\x3d"margin-bottom:1.0em; clear:both;"\x3e\r\n    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd nowrap\x3e\r\n          \x3cdiv class\x3d"csv multigeocode"\x3e\r\n            \x3clabel for\x3d"geocoderSelect"\x3e${i18n.selectGeocoder}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"csv multigeocode"\x3e\r\n            \x3cselect id\x3d"geocoderSelect" data-dojo-attach-point\x3d"_geocoderSelect" data-dojo-type\x3d"dijit.form.Select" style\x3d"width:275px;" data-dojo-props\x3d"maxHeight:200" name\x3d"geocodeSelect"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd nowrap\x3e\r\n          \x3cdiv class\x3d"csv geocode"\x3e\r\n            \x3clabel for\x3d"geocodeAddress"\x3e${i18n.inLabel}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"csv geocode"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_countryCodes" data-dojo-type\x3d"dijit.form.Select" style\x3d"width:275px;" data-dojo-props\x3d"maxHeight:200" id\x3d"geocodeAddress" name\x3d"geocodeAddress"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- we hard code styles here so it will work in IE9-7 --\x3e\r\n  \x3cdiv class\x3d"csv review" style\x3d"margin: 1.0em 0 1.0em 0; clear:both;"\x3e${i18n.review}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"gridNodeAddr" class\x3d"grid" style\x3d"width:448px;height:150px"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"gridNodeLatLong" class\x3d"grid" style\x3d"display:none;width:448px;height:150px"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"geocodingMsg"\x3e\x3cspan class\x3d"csv"\x3e${i18n.geocodingMsg}\x3c/span\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3cbr /\x3e\r\n\x3cdiv class\x3d"submitButtons dijitDialogPaneActionBar"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"spinnerNode" style\x3d"display:none"\x3e${i18n.pleaseWait}\x3c/span\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"_okBtn" data-dojo-type\x3d"dijit.form.Button" name\x3d"addLayer" class\x3d"primary" type\x3d"submit"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"_cancelBtn" data-dojo-type\x3d"dijit.form.Button" name\x3d"cancel" class\x3d"cancel" type\x3d"button" data-dojo-observer\x3d"onCancel"\x3e\r\n\x3c/div\x3e\r\n\x3c/form\x3e'),
            baseClass: "esriAGOCsvLocationForm",
            _requestParams: { f: "json" },
            publishParameters: {},
            helpLink: null,
            postMixInProperties: function() {
                this.inherited(arguments);
                this.i18n = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").common);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").addItemFrm);
                this.i18n = b.mixin(this.i18n, b.i18n.getLocalization("arcgisonline", "arcgisonline").CsvLocationDlg);
                this.countryCodes = b.mixin({}, b.i18n.getLocalization("arcgisonline", "arcgisonline").countryCodes)
            },
            startup: function() {
                this.inherited(arguments);
                this._loadConnections();
                this._util = arcgisonline.sharing.util;
                this._errorDlg = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
                this._user = b.mixin(this._util.getUser(), this.overrideUser || {});
                this._isLoggedIn = this._util.getUser() ? !0 : !1;
                this._contentUri = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/") + "content";
                this._geocodeServiceUrl = this._agoGeocodeServiceUrl =
                    "arcgis.com/arcgis/rest/services/world/geocodeserver";
                this._geocodeServers = (this._helperServices = esriGeowConfig.self && esriGeowConfig.self.helperServices) && this._helperServices.geocode;
                this._isPortal = arcgisonline.sharing.util.isPortal();
                this._roleCanCreateItem = (this._hasRole = esriGeowConfig.userRole) && esriGeowConfig.userRole.canCreateItem();
                this._roleCanPublishFeatures = this._hasRole && this._roleCanCreateItem && esriGeowConfig.userRole.canPublishFeatures();
                this._roleCanPublishTiles = this._hasRole && this._roleCanCreateItem &&
                    esriGeowConfig.userRole.canPublishTiles();
                this._roleCanUseGeocode = this._hasRole && esriGeowConfig.userRole.canUseGeocode();
                this._geocodeServers = !this._user || this._user && !this._user.orgId ? this._util.filterBatchGeocoders(this._geocodeServers) : this._util.filterBatchGeocoders(this._geocodeServers, !this._roleCanUseGeocode);
                if (esriGeowConfig.userRole && !esriGeowConfig.userRole.canUseGeocode()) {
                    var a = -1;
                    if (this._geocodeServers && this._geocodeServers.length)
                        for (var c = 0; c < this._geocodeServers.length; c++) {
                            var d =
                                arcgisonline.sharing.util.isEsriWorldGeocoder(this._geocodeServers[c]),
                                a = c;
                            if (d) break
                        }
                    d && this._geocodeServers.splice(a, 1)
                }
                this._geocodeServers && this._geocodeServers.length && (this._setGeocoder(this._geocodeServers[0].url), this._setGeocoderOptions(), 2 > this._geocodeServers.length && b.query(".multigeocode").style("display", "none"));
                esri.config.defaults.io.proxyUrl = esriGeowConfig.proxyServer;
                this._requestParams.token = this._user.token;
                this._isLoggedIn && (this._getItemCards(), this._fetchCountryCodes())
            },
            _setGeocoderOptions: function() {
                for (var a = [], b = 0; b < this._geocodeServers.length; b++) a.push({ label: this._geocodeServers[b].name, value: this._geocodeServers[b].url });
                this._geocoderSelect.set("options", a);
                this._geocoderSelect.set("value", this._geocodeServers[0].name, !1)
            },
            _setGeocoder: function(a) {
                var b = this._findGeocoder(a);
                this._geocodeServiceUrl = a;
                this._isAgoWorldGeocodeServer = this._util.isEsriWorldGeocoderNoProxy(b);
                this._isServiceProxyAgoWorldGeocodeServer = this._util.isEsriWorldGeocoderThroughProxy(b);
                this._isWorldGeocodeServer = this._isAgoWorldGeocodeServer ||
                    this._isServiceProxyAgoWorldGeocodeServer
            },
            _findGeocoder: function(a) { var b = this._geocodeServers.filter(function(b) { return b.url === a }); return b && b.length ? b.shift() : null },
            _getItemCards: function() {
                for (var a = [], c = [], d = 0; d < this._geocodeServers.length; d++) this._geocodeServers[d].itemId && (c.push(this._geocodeServers[d].itemId), 10 === c.length || d === this._geocodeServers.length - 1) && (c = esriGeowConfig.restBaseUrl + "content/itemlist?ids\x3d" + c.toString(), a.push(arcgisonline.sharing.util.getJson(c)), c = []);
                c.length &&
                    (c = esriGeowConfig.restBaseUrl + "content/itemlist?ids\x3d" + c.toString(), a.push(arcgisonline.sharing.util.getJson(c)));
                if (a.length) {
                    var f = [];
                    (new b.DeferredList(a)).addCallback(b.hitch(this, function(a) {
                        b.forEach(a, function(a) { f = f.concat(a[1].items) });
                        for (a = 0; a < this._geocodeServers.length; a++)
                            if (this._geocodeServers[a].itemId)
                                for (var c = 0; c < f.length; c++)
                                    if (this._geocodeServers[a].itemId === f[c].id) { this._geocodeServers[a].proxyFilter = f[c].proxyFilter; break }
                        this._fetchCountryCodes()
                    }))
                }
            },
            enable: function(a,
                b) {
                this.inherited(arguments);
                esri.hide(this.spinnerNode)
            },
            disable: function(a, c) {
                this.inherited(arguments);
                b.attr(this.spinnerNode, "innerHTML", c || this.i18n.pleaseWait);
                b.style(this.spinnerNode, "display", "inline-block")
            },
            onCancel: function() { this.dialog && this.dialog.hide() },
            onSubmit: function(a) {
                a.preventDefault();
                this._getFeatureCollection()
            },
            start: function(a, c, d, f, e) {
                this.data = a;
                this.fileName = c;
                this.url = d;
                this.fullRecordCount = f;
                !esriGeowConfig.userRole || esriGeowConfig.userRole.canUseGeocode() || this._geocodeServers &&
                    this._geocodeServers.length ? this._loadCSV(e) : (arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: b.string.substitute(esri.i18nBundle.viewer.fileImport.geocodingNotAllowed, { fileName: this.fileName }) }), this.dialog.hide())
            },
            _createGrid: function(a) {
                a = b.map(a, b.hitch(this, function(a) {
                    if ("MGRS" === this.publishParameters.coordinateFieldType && a.name === this.publishParameters.coordinateFieldName) return b.mixin(a, { locationType: "MGRS" });
                    if ("USNG" === this.publishParameters.coordinateFieldType && a.name === this.publishParameters.coordinateFieldName) return b.mixin(a, { locationType: "USNG" });
                    for (var c in this.publishParameters.addressFields)
                        if (this.publishParameters.addressFields[c] === a.name) return b.mixin(a, { locationType: c });
                    return b.mixin(a, { locationType: "unknown" })
                }));
                "addressTypes" === this._getRadioButtonValue("geocode") ? this._useAddrGrid() : this._useLatLongGrid();
                this.enable();
                this.dialog && 9 > b.isIE && b.style(this.dialog.domNode, "height",
                    "420px")
            },
            _getRadioButtonValue: function(a) { var c; return 9 >= b.isIE ? (b.some(this.formWidgets[a].widget || [], function(a) { return a.get("checked") ? (c = a, !0) : !1 }), c ? c.get("value") : "") : this.elementValue(a) },
            _useAddrGrid: function() {
                var a = this._isLoggedIn && (!this._isPortal && this._isWorldGeocodeServer || this._isPortal && this._isServiceProxyAgoWorldGeocodeServer);
                b.query(".geocode").style("display", a ? 9 > b.isIE ? "block" : "" : "none");
                b.style(this.gridNodeAddr, "display", "block");
                b.style(this.gridNodeLatLong, "display",
                    "none");
                this.url ? b.style(this.geocodingMsg, "display", "block") : b.style(this.geocodingMsg, "display", "none");
                var a = b.clone(this.publishParameters.layerInfo && this.publishParameters.layerInfo.fields),
                    c = this.gridInfoAddr,
                    d = [];
                b.forEach(c, function(a) {
                    a.name = this.i18n[a.name] || a.name;
                    if (a.select) {
                        var c = b.mixin({}, b.mixin(b.clone(this.i18n.notUsed), this.publishParameters.standardizedFieldNames || this.i18n[a.select]));
                        a = b.mixin(a, this._toSelectOptions(c));
                        d = a.values
                    }
                }, this);
                b.forEach(a, function(a) {
                    a.locationType &&
                        -1 == b.indexOf(d, a.locationType) && (a.locationType = "unknown")
                });
                this._mStoreAddr = new b.store.Memory({ data: a, idProperty: "name" });
                this._oStoreAddr = new b.data.ObjectStore({ objectStore: this._mStoreAddr });
                this._gridAddr ? (this._gridAddr.set("structure", c), this._gridAddr.setStore(this._oStoreAddr)) : (this._gridAddr = new n.grid.DataGrid({ id: "_csv_grid_Addr", selectionMode: "none", singleClickEdit: !0 }, b.create("div", null, this.gridNodeAddr)), this._gridAddr.set("structure", c), this._gridAddr.setStore(this._oStoreAddr),
                    this._gridAddr.startup(), this._gridConnects.push(b.connect(this._oStoreAddr, "onSet", b.hitch(this, function(a, b, c, d) { "locationType" === b && this._mStoreAddr.query({ locationType: d }).forEach(function(b) { b.name !== a.name && (b = this._mStoreAddr.get(b.name), b.locationType = "unknown", this._mStoreAddr.put(b)) }, this) }))), this._gridConnects.push(b.connect(this._gridAddr, "onApplyCellEdit", b.hitch(this, function(a, c, d) {
                        if ("locationType" === d && a === this.publishParameters.standardizedFieldNames.Postal) {
                            var e = this._gridAddr.getItem(c);
                            e.__isTypeUpdatedByUser || (e.type = "esriFieldTypeString", e.__isTypeUpdatedByUser = !0, this._mStoreAddr.put(e), b.some(this.publishParameters.layerInfo.fields || [], b.hitch(this, function(a) { return a.name === e.name ? (a.type = e.type, !0) : !1 })))
                        }
                    }))));
                this._mStore = this._mStoreAddr;
                this._oStore = this._oStoreAddr;
                this._grid = this._gridAddr
            },
            _fetchCountryCodes: function(a) {
                var c = [],
                    d = esriGeowConfig.self || {},
                    d = (d.user || {}).region || d.region || d.ipCntryCode || "",
                    f;
                a && (f = a.split(","));
                for (var e in this.countryCodes)(!f || f &&
                    -1 < b.indexOf(f, e) || f && 1 < f.length && "WORLD" === e) && this.countryCodes.hasOwnProperty(e) && c.push({ label: this.countryCodes[e], value: e.toLowerCase() });
                c = c.sort(function(a, b) { return a.label < b.label ? -1 : a.label > b.label ? 1 : 0 });
                this._countryCodes.set("options", c);
                this._countryCodes.set("value", this.countryCodes[d] ? d.toLowerCase() : "world", !1)
            },
            _useLatLongGrid: function() {
                b.query(".geocode").style("display", "none");
                b.style(this.gridNodeAddr, "display", "none");
                b.style(this.geocodingMsg, "display", "none");
                b.style(this.gridNodeLatLong,
                    "display", "block");
                9 >= b.isIE && (b.style(this.gridNodeLatLong, "width", "448px"), b.style(this.gridNodeLatLong, "height", "150px"));
                if (!this._gridLatLong) {
                    var a = b.clone(this.publishParameters.layerInfo && this.publishParameters.layerInfo.fields),
                        c = this.gridInfoLatLong,
                        d = [];
                    b.forEach(c, function(a) {
                        a.name = this.i18n[a.name] || a.name;
                        if (a.select) {
                            var c = b.mixin({}, this.i18n[a.select]);
                            a = b.mixin(a, this._toSelectOptions(c));
                            d = a.values
                        }
                    }, this);
                    b.forEach(a, function(a) {
                        a.locationType && -1 == b.indexOf(d, a.locationType) &&
                            (a.locationType = "unknown")
                    });
                    this._mStoreLatLong = new b.store.Memory({ data: a, idProperty: "name" });
                    this._oStoreLatLong = new b.data.ObjectStore({ objectStore: this._mStoreLatLong });
                    this._gridLatLong = new n.grid.DataGrid({ id: "_csv_grid_latLong", selectionMode: "none", singleClickEdit: !0 }, b.create("div", null, this.gridNodeLatLong));
                    this._gridLatLong.set("structure", c);
                    this._gridLatLong.setStore(this._oStoreLatLong);
                    this._gridLatLong.startup();
                    this._gridConnects.push(b.connect(this._oStoreLatLong, "onSet", b.hitch(this,
                        function(a, b, c, d) { "locationType" === b && this._mStoreLatLong.query({ locationType: d }).forEach(function(b) { b.name !== a.name && (b = this._mStoreLatLong.get(b.name), b.locationType = "unknown", this._mStoreLatLong.put(b)) }, this) })))
                }
                this._mStore = this._mStoreLatLong;
                this._oStore = this._oStoreLatLong;
                this._grid = this._gridLatLong
            },
            deleteGrid: function() {
                this._gridAddr && (delete this._mStoreAddr, delete this._oStoreAddr, this._gridAddr.destroy(), delete this._gridAddr);
                this._gridLatLong && (delete this._mStoreLatLong, delete this._oStoreLatLong,
                    this._gridLatLong.destroy(), delete this._gridLatLong);
                this._mStore = this._mStoreAddr = this._mStoreLatLong = this._oStore = this._oStoreAddr = this._oStoreLatLong = this._grid = this._gridAddr = this._gridLatLong = null
            },
            _loadCSV: function(a) {
                a && (this.publishParameters = a.publishParameters || {}, this._isWorldGeocodeServer && this._isPortal && !this._isServiceProxyAgoWorldGeocodeServer ? (this.elementValue("geocode", "locationTypes"), b.style(b.byId("locateDiv"), "display", "none")) : (this._isWorldGeocodeServer && (this._countryCodes.set("value",
                    a.publishParameters.sourceCountry || "world", !1), b.query(".dijitSelectLabel", this._countryCodes.domNode).style("maxWidth", "245px")), this.elementValue("geocode", "address" === this.publishParameters.locationType || "none" === this.publishParameters.locationType && this.publishParameters.standardizedFieldNames ? "addressTypes" : "locationTypes"), "address" !== this.publishParameters.locationType && b.query(".multigeocode").style("display", "none")), this._analyzed = "addressTypes" === this.elementValue("geocode"), this._createGrid(this.publishParameters.layerInfo &&
                    this.publishParameters.layerInfo.fields || []))
            },
            _getFeatureCollection: function() { var a = this._getRadioButtonValue("geocode"); "addressTypes" === a ? this._callGenerate(a) : this._readLocal(a) },
            _callGenerate: function(a) {
                this.disable(null, this.i18n.updating);
                var c = b.mixin({}, this.publishParameters.standardizedFieldNames || this.i18n[a]);
                this._gridAddr && this._gridAddr.edit.apply();
                this.publishParameters.locationType = "address";
                var d = 0,
                    f = {};
                this._mStore.query(function(a) {
                    "unknown" !== a.locationType && a.locationType in
                        c && (f[a.locationType] = a.name, d++)
                });
                if (1 > d) return this._showError(this.i18n.errors.noAddressFields);
                this.publishParameters.addressFields = f;
                this.publishParameters.targetSR = arcgisonline.map.main.map.spatialReference.toJson();
                a = this.data;
                var e, g;
                if (this._user.accountId && 4E3 < this.fullRecordCount) {
                    g = e = 0;
                    if (-1 === a.indexOf("\n"))
                        for (; - 1 < e && 4E3 >= g;) g++, e = a.indexOf("\r", e + 1);
                    else
                        for (; - 1 < e && 4E3 >= g;) g++, e = a.indexOf("\n", e + 1);
                    a = a.substring(0, e)
                } else if (!this._user.accountId && 250 < this.fullRecordCount) {
                    g = e = 0;
                    if (-1 === a.indexOf("\n"))
                        for (; - 1 < e && 250 >= g;) g++, e = a.indexOf("\r", e + 1);
                    else
                        for (; - 1 < e && 250 >= g;) g++, e = a.indexOf("\n", e + 1);
                    a = a.substring(0, e)
                }
                this.publishParameters.maxRecordCount = 4E3;
                e = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/");
                e += "content/features/generate";
                (g = arcgisonline.sharing.util.getToken()) && (e += "?token\x3d" + g);
                return this._request(e, { filetype: "csv", text: a, publishParameters: b.json.stringify(this.publishParameters) }, { usePost: !0 }).then(b.hitch(this,
                    "_addLayer"), b.hitch(this, function(a) { arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: esri.i18nBundle.CsvLocationDlg.error.general + (a && a.message ? " (" + a.message + ")" : "") }) }))
            },
            _callGenerateCSV: function() {
                this.disable(null, this.i18n.updating);
                this.publishParameters.locationType = "coordinates";
                this.publishParameters.columnDelimiter = ",";
                this._mStore.query(b.hitch(this, function(a) {
                    "MGRS" === a.locationType ? (this.publishParameters.coordinateFieldName =
                        a.name, this.publishParameters.coordinateFieldType = "MGRS") : "USNG" === a.locationType && (this.publishParameters.coordinateFieldName = a.name, this.publishParameters.coordinateFieldType = "USNG")
                }));
                this.publishParameters.targetSR = arcgisonline.map.main.map.spatialReference.toJson();
                var a = this.data,
                    c, d;
                if (this._user.accountId && 1E3 < this.fullRecordCount) {
                    d = c = 0;
                    if (-1 === a.indexOf("\n"))
                        for (; - 1 < c && 1E3 >= d;) d++, c = a.indexOf("\r", c + 1);
                    else
                        for (; - 1 < c && 1E3 >= d;) d++, c = a.indexOf("\n", c + 1);
                    a = a.substring(0, c)
                } else if (!this._user.accountId &&
                    250 < this.fullRecordCount) {
                    d = c = 0;
                    if (-1 === a.indexOf("\n"))
                        for (; - 1 < c && 250 >= d;) d++, c = a.indexOf("\r", c + 1);
                    else
                        for (; - 1 < c && 250 >= d;) d++, c = a.indexOf("\n", c + 1);
                    a = a.substring(0, c)
                }
                this.publishParameters.maxRecordCount = 4E3;
                c = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/");
                c += "content/features/generate";
                (d = arcgisonline.sharing.util.getToken()) && (c += "?token\x3d" + d);
                return this._request(c, { filetype: "csv", text: a, publishParameters: b.json.stringify(this.publishParameters) }, { usePost: !0 }).then(b.hitch(this, "_addLayer"), b.hitch(this, function(a) { arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: esri.i18nBundle.CsvLocationDlg.error.general + (a && a.message ? " (" + a.message + ")" : "") }) }))
            },
            _addLayer: function(a) {
                var c;
                if (a.geocodeResults && 0 === a.geocodeResults.accepted) c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({
                    title: esri.i18nBundle.common.errorTitle,
                    message: esri.i18nBundle.viewer.fileImport.noRecords
                });
                else if (a.geocodeResults && 0 < a.geocodeResults.rejected && (c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({ title: esri.i18nBundle.viewer.fileImport.warningTitle, message: b.string.substitute(esri.i18nBundle.viewer.fileImport.invalidAddresses, { count: a.geocodeResults.rejected }) })), 8 >= b.isIE && (c = a.featureCollection.layers[0].layerDefinition.drawingInfo.renderer.symbol) && c.url && -1 == c.url.indexOf("http") && (c.url = arcgisonline.sharing.util.getRedSphereUrl()),
                    a.featureCollection.layers[0].featureSet.features.length) {
                    a.featureCollection.layers[0].layerDefinition.capabilities = "Query";
                    c = this.fileName ? this.fileName.substring(0, this.fileName.indexOf(".")) : "CSV";
                    0 === c.length && this.fileName && (c = this.fileName);
                    var d = arcgisonline.map.featColl.addFeatureLayers(a, c);
                    arcgisonline.map.main.checkSuggestedScaleRangeAndZoom(d).then(function() {
                        "rendererStack" == arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftAboutPanel();
                        arcgisonline.map.leftPanel.openLeftRendererPanel(d.id, -1, !0, !0, !0)
                    }, function() {
                        "rendererStack" == arcgisonline.map.leftPanel.getLeftContentPanelStack() && arcgisonline.map.leftPanel.openLeftAboutPanel();
                        arcgisonline.map.leftPanel.openLeftRendererPanel(d.id, -1, !0, !0, !0)
                    });
                    c = d.layer;
                    var f = esri.styles.basic.getSchemes({ theme: "default", basemap: "topo", geometryType: c.geometryType }).primaryScheme,
                        e = new esri.symbols.SimpleMarkerSymbol;
                    e.setColor(f.color);
                    e.size = f.size;
                    e.outline.setColor(f.outline.color);
                    e.outline.width = f.outline.width;
                    f = new esri.renderers.SimpleRenderer(e);
                    c.setRenderer(f);
                    a = arcgisonline.map.featColl.generateDefaultPopupInfo(a.featureCollection.layers[0]);
                    d.popupInfo = a;
                    d.layer.setInfoTemplate(new esri.dijit.PopupTemplate(a));
                    arcgisonline.map.popup.setupPopupHandler();
                    d.columnDelimiter = this.publishParameters.columnDelimiter;
                    arcgisonline.map.main.markMapAsChanged("CsvLocationDlg");
                    if (!this._user.accountId && 250 < this.fullRecordCount || this._user.accountId && 4E3 < this.fullRecordCount) a = b.string.substitute(esri.i18nBundle.CsvLocationDlg.messageAddr, {
                        count1: this._user.accountId ?
                            4E3 : 250,
                        count2: this._user.accountId ? 4E3 : 250
                    }), this.helpLink && (a += " \x3cspan class\x3d'esriItemLinks' style\x3d'outline:none;'\x3e\x3cA tabindex\x3d'-1' href\x3d'" + this.helpLink + "' target\x3d'_blank'\x3e" + esri.i18nBundle.CsvLocationDlg.learnMore + "\x3c/A\x3e\x3c/span\x3e"), c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(), c.show({ title: esri.i18nBundle.generalDlg.errorDlgTitle, message: a })
                } else c = arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
                    c.show({ title: esri.i18nBundle.common.errorTitle, message: esri.i18nBundle.viewer.fileImport.noRecords });
                this.dialog.hide()
            },
            _readLocal: function(a) {
                this.disable(null, this.i18n.updating);
                var c = b.mixin({}, this.i18n[a]),
                    d = { latitudeFieldName: null, longitudeFieldName: null };
                this._grid.edit.apply();
                this._mStore.query(function(a) { "unknown" !== a.locationType && a.locationType in c && (d[a.locationType + "FieldName"] = a.alias || a.name) });
                if ("locationTypes" === this.elementValue("geocode")) {
                    if (d.MGRSFieldName || d.USNGFieldName) {
                        this._callGenerateCSV();
                        this.dialog.hide();
                        return
                    }
                    if (!d.latitudeFieldName || !d.longitudeFieldName) return this._showError(this.i18n.errors.noLocationFields);
                    arcgisonline.map.fileImport.processCsvData(this.data, this.fileName, this.url, d.latitudeFieldName, d.longitudeFieldName, this.publishParameters.columnDelimiter)
                } else arcgisonline.map.fileImport.processCsvData(this.data, this.fileName, this.url, d.latitudeFieldName, d.longitudeFieldName, this.publishParameters.columnDelimiter, !0);
                this.dialog.hide()
            },
            _request: function(a, c, d, f, e) {
                c =
                    b.mixin(b.mixin({}, this._requestParams), c || {});
                d && !1 === d.addToken && delete c.token;
                return esri.request({ url: a, content: c, callbackParamName: "callback", timeout: d && d.timeout || 0 }, d).then(b.hitch(this, function(a) { return a ? a.error ? this._showError(a.error) : a : this._showError() }), b.hitch(this, function(a) { e ? e(a) : this._showError(b.mixin({}, { code: "timeout" === a.dojoType ? 408 : a.code, message: a.message, details: a.details })); throw a; }))
            },
            _toSelectOptions: function(a, b) {
                var c = [],
                    f = [],
                    e;
                for (e in a) a.hasOwnProperty(e) && (c.push(a[e]),
                    f.push(e));
                return { formatter: function(c) { return a[c] || b }, options: c, values: f }
            },
            _loadConnections: function() {
                this._dlgConnect = b.connect(this.dialog, "hide", b.hitch(this, function() {
                    this.deleteGrid();
                    g.byId("geocode:latLong").destroy();
                    g.byId("geocode:addr").destroy();
                    g.byId("geocode:table").destroy();
                    b.forEach([this._dlgConnect].concat(this._gridConnects), b.disconnect);
                    this.destroy()
                }));
                var a = arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance(),
                    c = setInterval(b.hitch(this, function() {
                        a.isLoaded() &&
                            (clearInterval(c), this.helpLink = a.getHelpUrl("120000902"))
                    }), 200);
                this._gridConnects = [];
                this._gridConnects.push(b.connect(b.byId("geocode:latLong"), "onclick", b.hitch(this, function() { this._onTypeChange() })));
                this._gridConnects.push(b.connect(b.byId("geocode:addr"), "onclick", b.hitch(this, function() { this._onTypeChange() })));
                this._gridConnects.push(b.connect(b.byId("geocode:table"), "onclick", b.hitch(this, function() { this._onTypeChange() })));
                this._gridConnects.push(b.connect(this._countryCodes, "onChange",
                    b.hitch(this, "_onCountryChange")));
                this._gridConnects.push(b.connect(this._geocoderSelect, "onChange", b.hitch(this, "_onGeocoderChange")));
                this._okBtn.set("label", this.i18n.addLayer);
                this._cancelBtn.set("label", this.i18n.cancel)
            },
            _onTypeChange: function() {
                var a = this.elementValue("geocode");
                if ("none" === a) this._grid.layout.setColumnVisibility(1, !1), b.query(".review").style("display", "none"), b.query(".multigeocode").style("display", "none"), b.query(".geocode").style("display", "none"), b.style(this.geocodingMsg,
                    "display", "block");
                else if (this._grid.layout.setColumnVisibility(1, !0), b.query(".review").style("display", ""), "addressTypes" === a) {
                    this._analyzed ? this._useAddrGrid() : this._onCountryChange(this._countryCodes.get("value"));
                    1 < this._geocodeServers.length && b.query(".multigeocode").style("display", "");
                    var c = this._geocoderSelect.get("value");
                    b.forEach(this._geocodeServers, function(a) { a.url === c && (a = a.proxyFilter && JSON.parse(a.proxyFilter), this._fetchCountryCodes(a && a.sourceCountry)) }, this)
                } else this._useLatLongGrid(),
                    b.query(".multigeocode").style("display", "none")
            },
            _onGeocoderChange: function(a) {
                b.query(".dijitSelectLabel", this._geocoderSelect.domNode).style("maxWidth", "245px");
                this._setGeocoder(a);
                this._analyzed = !1;
                this._onTypeChange()
            },
            _onCountryChange: function(a) {
                b.query(".dijitSelectLabel", this._countryCodes.domNode).style("maxWidth", "245px");
                var c = esriGeowConfig.restBaseUrl + (esriGeowConfig.restBaseUrl.lastIndexOf("/") === esriGeowConfig.restBaseUrl.length - 1 ? "" : "/"),
                    d = { enableGlobalGeocoding: !0, sourceLocale: b.locale.split("-")[0] };
                2 < d.sourceLocale.length && (d.sourceLocale = d.sourceLocale.substring(0, 2));
                d.geocodeServiceUrl = encodeURI(this._geocodeServiceUrl);
                this.data && (d.locationType = "addressTypes" === this._getRadioButtonValue("geocode") ? "address" : "coordinates");
                this._isWorldGeocodeServer && (d.sourceCountry = a.toLowerCase(), d.sourceCountryHint = "");
                c += "content/features/analyze";
                (a = arcgisonline.sharing.util.getToken()) && (c += "?token\x3d" + a);
                return esri.request({
                    url: c,
                    content: {
                        filetype: "csv",
                        text: this.data,
                        analyzeParameters: b.json.stringify(d),
                        f: "json"
                    },
                    callbackParamName: "callback"
                }, { usePost: !0 }).then(b.hitch(this, function(a) {
                    "coordinates" === d.locationType && a.publishParameters && "none" === a.publishParameters.locationType && (a.publishParameters.locationType = "coordinates");
                    this._analyzed = !0;
                    this._isWorldGeocodeServer && (a.publishParameters.sourceCountry = a.publishParameters.sourceCountry || "world");
                    this._loadCSV(a)
                }), b.hitch(this, function(a) { this._showError(a) }))
            },
            _showError: function(a) {
                a = a.error || a || {};
                a.details = a.details && a.details.length ? b.filter(a.details,
                    "return item !\x3d\x3d null") : null;
                a.details && a.details.length && (a.details = a.details.join("\x3cbr\x3e"), a.message = a.message ? a.message + "\x3cbr\x3e" + a.details : a.details);
                a = b.mixin(b.mixin({}, this.i18n.error), a);
                this._errorDlg.show(a);
                this.enable();
                return !1
            }
        })
    })
}, "dojox/form/Manager": function() {
    define("dijit/_Widget dijit/_AttachMixin dijit/_WidgetsInTemplateMixin ./manager/_Mixin ./manager/_NodeMixin ./manager/_FormMixin ./manager/_ValueMixin ./manager/_EnableMixin ./manager/_DisplayMixin ./manager/_ClassMixin dojo/_base/declare".split(" "),
        function(b, g, n, a, c, d, f, e, h, m, p) {
            return p("dojox.form.Manager", [b, n, g, a, c, d, f, e, h, m], {
                searchContainerNode: !0,
                buildRendering: function() {
                    this.containerNode || (this.containerNode = this.srcNodeRef);
                    this.inherited(arguments)
                }
            })
        })
}, "dojox/form/manager/_Mixin": function() {
    define("dojo/_base/window dojo/_base/lang dojo/_base/array dojo/on dojo/dom-attr dojo/dom-class dijit/_base/manager dijit/_Widget dijit/form/_FormWidget dijit/form/Button dijit/form/CheckBox dojo/_base/declare".split(" "), function(b, g, n, a,
        c, d, f, e, h, m, p, r) {
        b = g.getObject("dojox.form.manager", !0);
        var v = b.actionAdapter = function(a) { return function(b, c, d) { g.isArray(c) ? n.forEach(c, function(c) { a.call(this, b, c, d) }, this) : a.apply(this, arguments) } };
        b.inspectorAdapter = function(a) { return function(b, c, d) { return a.call(this, b, g.isArray(c) ? c[0] : c, d) } };
        var w = { domNode: 1, containerNode: 1, srcNodeRef: 1, bgIframe: 1 },
            t = b._keys = function(a) {
                var b = [],
                    c;
                for (c in a) a.hasOwnProperty(c) && b.push(c);
                return b
            },
            x = function(a) {
                var b = a.get("name");
                if (b && a.isInstanceOf(h))
                    if (b in
                        this.formWidgets) {
                        var c = this.formWidgets[b].widget;
                        g.isArray(c) ? c.push(a) : this.formWidgets[b].widget = [c, a]
                    } else this.formWidgets[b] = { widget: a, connections: [] };
                else b = null;
                return b
            },
            B = function(a) {
                var b = {};
                v(function(a, c) {
                    (a = c.get("data-dojo-observer") || c.get("observer")) && "string" == typeof a && n.forEach(a.split(","), function(a) {
                        (a = g.trim(a)) && g.isFunction(this[a]) && (b[a] = 1)
                    }, this)
                }).call(this, null, this.formWidgets[a].widget);
                return t(b)
            },
            E = function(b, d) {
                var e = this.formWidgets[b],
                    f = e.widget,
                    h = e.connections;
                h.length && (n.forEach(h, function(a) { a.remove() }), h = e.connections = []);
                if (g.isArray(f)) n.forEach(f, function(e) { n.forEach(d, function(d) { h.push(a(e, "change", g.hitch(this, function(a) { if (this.watching && c.get(e.focusNode, "checked")) this[d](e.get("value"), b, e, a) }))) }, this) }, this);
                else {
                    var p = f.isInstanceOf(m) ? "click" : "change";
                    n.forEach(d, function(c) { h.push(a(f, p, g.hitch(this, function(a) { if (this.watching) this[c](f.get("value"), b, f, a) }))) }, this)
                }
            };
        r = r("dojox.form.manager._Mixin", null, {
            watching: !0,
            startup: function() {
                this._started ||
                    (this.formWidgets = {}, this.formNodes = {}, this.registerWidgetDescendants(this), this.inherited(arguments))
            },
            destroy: function() {
                for (var a in this.formWidgets) n.forEach(this.formWidgets[a].connections, function(a) { a.remove() });
                this.formWidgets = {};
                this.inherited(arguments)
            },
            registerWidget: function(a) {
                "string" == typeof a ? a = f.byId(a) : a.tagName && a.cloneNode && (a = f.byNode(a));
                (a = x.call(this, a)) && E.call(this, a, B.call(this, a));
                return this
            },
            unregisterWidget: function(a) {
                a in this.formWidgets && (n.forEach(this.formWidgets[a].connections,
                    function(a) { a.remove() }), delete this.formWidgets[a]);
                return this
            },
            registerWidgetDescendants: function(a) {
                "string" == typeof a ? a = f.byId(a) : a.tagName && a.cloneNode && (a = f.byNode(a));
                var b = n.map(a.getDescendants(), x, this);
                n.forEach(b, function(a) { a && E.call(this, a, B.call(this, a)) }, this);
                return this.registerNodeDescendants ? this.registerNodeDescendants(a.domNode) : this
            },
            unregisterWidgetDescendants: function(a) {
                "string" == typeof a ? a = f.byId(a) : a.tagName && a.cloneNode && (a = f.byNode(a));
                n.forEach(n.map(a.getDescendants(),
                    function(a) { return a instanceof h && a.get("name") || null }), function(a) { a && this.unregisterWidget(a) }, this);
                return this.unregisterNodeDescendants ? this.unregisterNodeDescendants(a.domNode) : this
            },
            formWidgetValue: function(a, b) {
                var d = 2 == arguments.length && void 0 !== b,
                    e;
                "string" == typeof a && (a = this.formWidgets[a]) && (a = a.widget);
                if (!a) return null;
                if (g.isArray(a)) {
                    if (d) return n.forEach(a, function(a) { a.set("checked", !1, !this.watching) }, this), n.forEach(a, function(a) { a.set("checked", a.value === b, !this.watching) }, this),
                        this;
                    n.some(a, function(a) { return c.get(a.focusNode, "checked") ? (e = a, !0) : !1 });
                    return e ? e.get("value") : ""
                }
                return a.isInstanceOf && a.isInstanceOf(p) ? d ? (a.set("value", !!b, !this.watching), this) : !!a.get("value") : d ? (a.set("value", b, !this.watching), this) : a.get("value")
            },
            formPointValue: function(a, b) { a && "string" == typeof a && (a = this[a]); return a && a.tagName && a.cloneNode && d.contains(a, "dojoFormValue") ? 2 == arguments.length && void 0 !== b ? (a.innerHTML = b, this) : a.innerHTML : null },
            inspectFormWidgets: function(a, b, c) {
                var d,
                    e = {};
                if (b)
                    if (g.isArray(b)) n.forEach(b, function(b) { b in this.formWidgets && (e[b] = a.call(this, b, this.formWidgets[b].widget, c)) }, this);
                    else
                        for (d in b) d in this.formWidgets && (e[d] = a.call(this, d, this.formWidgets[d].widget, b[d]));
                else
                    for (d in this.formWidgets) e[d] = a.call(this, d, this.formWidgets[d].widget, c);
                return e
            },
            inspectAttachedPoints: function(a, b, c) {
                var d, e, f = {};
                if (b)
                    if (g.isArray(b)) n.forEach(b, function(b) {
                        (e = this[b]) && e.tagName && e.cloneNode && (f[b] = a.call(this, b, e, c))
                    }, this);
                    else
                        for (d in b)(e = this[d]) &&
                            e.tagName && e.cloneNode && (f[d] = a.call(this, d, e, b[d]));
                else
                    for (d in this) d in w || (e = this[d]) && e.tagName && e.cloneNode && (f[d] = a.call(this, d, e, c));
                return f
            },
            inspect: function(a, b, c) {
                var d = this.inspectFormWidgets(function(b, c, d) { return g.isArray(c) ? a.call(this, b, n.map(c, function(a) { return a.domNode }), d) : a.call(this, b, c.domNode, d) }, b, c);
                this.inspectFormNodes && g.mixin(d, this.inspectFormNodes(a, b, c));
                return g.mixin(d, this.inspectAttachedPoints(a, b, c))
            }
        });
        g.extend(e, { observer: "" });
        return r
    })
}, "dojox/form/manager/_NodeMixin": function() {
    define("dojo/_base/lang dojo/_base/array dojo/on dojo/dom dojo/dom-attr dojo/query ./_Mixin dijit/form/_FormWidget dijit/_base/manager dojo/_base/declare".split(" "),
        function(b, g, n, a, c, d, f, e, h, m) {
            f = b.getObject("dojox.form.manager", !0);
            var p = f.actionAdapter,
                r = f._keys,
                v = f.changeEvent = function(a) {
                    var b = "click";
                    switch (a.tagName.toLowerCase()) {
                        case "textarea":
                            b = "keyup";
                            break;
                        case "select":
                            b = "change";
                            break;
                        case "input":
                            switch (a.type.toLowerCase()) {
                                case "text":
                                case "password":
                                    b = "keyup"
                            }
                    }
                    return b
                },
                w = function(a, d) {
                    var f = c.get(a, "name");
                    d = d || this.domNode;
                    if (!f || f in this.formWidgets) f = null;
                    else {
                        for (var g = a; g && g !== d; g = g.parentNode)
                            if (c.get(g, "widgetId") && h.byNode(g).isInstanceOf(e)) return null;
                            "input" == a.tagName.toLowerCase() && "radio" == a.type.toLowerCase() ? (d = (d = this.formNodes[f]) && d.node) && b.isArray(d) ? d.push(a) : this.formNodes[f] = { node: [a], connections: [] } : this.formNodes[f] = { node: a, connections: [] }
                    }
                    return f
                },
                t = function(a) {
                    var d = {};
                    p(function(a, e) {
                        (a = c.get(e, "data-dojo-observer") || c.get(e, "observer")) && "string" == typeof a && g.forEach(a.split(","), function(a) {
                            (a = b.trim(a)) && b.isFunction(this[a]) && (d[a] = 1)
                        }, this)
                    }).call(this, null, this.formNodes[a].node);
                    return r(d)
                },
                x = function(a, c) {
                    var d = this.formNodes[a],
                        e = d.connections;
                    e.length && (g.forEach(e, function(a) { a.remove() }), e = d.connections = []);
                    p(function(d, f) {
                        var h = v(f);
                        g.forEach(c, function(c) { e.push(n(f, h, b.hitch(this, function(b) { if (this.watching) this[c](this.formNodeValue(a), a, f, b) }))) }, this)
                    }).call(this, null, d.node)
                };
            return m("dojox.form.manager._NodeMixin", null, {
                destroy: function() {
                    for (var a in this.formNodes) g.forEach(this.formNodes[a].connections, function(a) { a.remove() });
                    this.formNodes = {};
                    this.inherited(arguments)
                },
                registerNode: function(b) {
                    "string" ==
                    typeof b && (b = a.byId(b));
                    (b = w.call(this, b)) && x.call(this, b, t.call(this, b));
                    return this
                },
                unregisterNode: function(a) { a in this.formNodes && (g.forEach(this.formNodes[a].connections, function(a) { a.remove() }), delete this.formNodes[a]); return this },
                registerNodeDescendants: function(b) {
                    "string" == typeof b && (b = a.byId(b));
                    d("input, select, textarea, button", b).map(function(a) { return w.call(this, a, b) }, this).forEach(function(a) { a && x.call(this, a, t.call(this, a)) }, this);
                    return this
                },
                unregisterNodeDescendants: function(b) {
                    "string" ==
                    typeof b && (b = a.byId(b));
                    d("input, select, textarea, button", b).map(function(a) { return c.get(b, "name") || null }).forEach(function(a) { a && this.unregisterNode(a) }, this);
                    return this
                },
                formNodeValue: function(a, c) {
                    var e = 2 == arguments.length && void 0 !== c,
                        f;
                    "string" == typeof a && (a = this.formNodes[a]) && (a = a.node);
                    if (!a) return null;
                    if (b.isArray(a)) {
                        if (e) return g.forEach(a, function(a) { a.checked = "" }), g.forEach(a, function(a) { a.checked = a.value === c ? "checked" : "" }), this;
                        g.some(a, function(a) { return a.checked ? (f = a, !0) : !1 });
                        return f ? f.value : ""
                    }
                    switch (a.tagName.toLowerCase()) {
                        case "select":
                            if (a.multiple) {
                                if (e) {
                                    if (b.isArray(c)) {
                                        var h = {};
                                        g.forEach(c, function(a) { h[a] = 1 });
                                        d("\x3e option", a).forEach(function(a) { a.selected = a.value in h });
                                        return this
                                    }
                                    d("\x3e option", a).forEach(function(a) { a.selected = a.value === c });
                                    return this
                                }
                                f = d("\x3e option", a).filter(function(a) { return a.selected }).map(function(a) { return a.value });
                                return 1 == f.length ? f[0] : f
                            }
                            return e ? (d("\x3e option", a).forEach(function(a) { a.selected = a.value === c }), this) : a.value ||
                                "";
                        case "button":
                            return e ? (a.innerHTML = "" + c, this) : a.innerHTML;
                        case "input":
                            if ("checkbox" == a.type.toLowerCase()) return e ? (a.checked = c ? "checked" : "", this) : !!a.checked
                    }
                    return e ? (a.value = "" + c, this) : a.value
                },
                inspectFormNodes: function(a, c, d) {
                    var e, f = {};
                    if (c)
                        if (b.isArray(c)) g.forEach(c, function(b) { b in this.formNodes && (f[b] = a.call(this, b, this.formNodes[b].node, d)) }, this);
                        else
                            for (e in c) e in this.formNodes && (f[e] = a.call(this, e, this.formNodes[e].node, c[e]));
                    else
                        for (e in this.formNodes) f[e] = a.call(this, e,
                            this.formNodes[e].node, d);
                    return f
                }
            })
        })
}, "dojox/form/manager/_FormMixin": function() {
    define("dojo/_base/lang dojo/_base/kernel dojo/_base/event dojo/window ./_Mixin dojo/_base/declare".split(" "), function(b, g, n, a, c, d) {
        var f = b.getObject("dojox.form.manager", !0).actionAdapter;
        return d("dojox.form.manager._FormMixin", null, {
            name: "",
            action: "",
            method: "",
            encType: "",
            "accept-charset": "",
            accept: "",
            target: "",
            startup: function() {
                if (this.isForm = "form" == this.domNode.tagName.toLowerCase()) this.connect(this.domNode,
                    "onreset", "_onReset"), this.connect(this.domNode, "onsubmit", "_onSubmit");
                this.inherited(arguments)
            },
            _onReset: function(a) {
                var b = { returnValue: !0, preventDefault: function() { this.returnValue = !1 }, stopPropagation: function() {}, currentTarget: a.currentTarget, target: a.target };
                !1 !== this.onReset(b) && b.returnValue && this.reset();
                n.stop(a);
                return !1
            },
            onReset: function() { return !0 },
            reset: function() {
                this.inspectFormWidgets(f(function(a, b) { b.reset && b.reset() }));
                this.isForm && this.domNode.reset();
                return this
            },
            _onSubmit: function(a) {
                !1 ===
                    this.onSubmit(a) && n.stop(a)
            },
            onSubmit: function() { return this.isValid() },
            submit: function() { this.isForm && !1 !== this.onSubmit() && this.domNode.submit() },
            isValid: function() {
                for (var a in this.formWidgets) {
                    var b = !1;
                    f(function(a, c) { c.get("disabled") || !c.isValid || c.isValid() || (b = !0) }).call(this, null, this.formWidgets[a].widget);
                    if (b) return !1
                }
                return !0
            },
            validate: function() {
                var b = !0,
                    c = this.formWidgets,
                    d = !1,
                    g;
                for (g in c) f(function(c, e) {
                    e._hasBeenBlurred = !0;
                    c = e.disabled || !e.validate || e.validate();
                    c || d || (a.scrollIntoView(e.containerNode ||
                        e.domNode), e.focus(), d = !0);
                    b = b && c
                }).call(this, null, c[g].widget);
                return b
            }
        })
    })
}, "dojox/form/manager/_ValueMixin": function() {
    define(["dojo/_base/lang", "dojo/_base/kernel", "dojo/_base/declare"], function(b, g, n) {
        return n("dojox.form.manager._ValueMixin", null, {
            elementValue: function(a, b) { return a in this.formWidgets ? this.formWidgetValue(a, b) : this.formNodes && a in this.formNodes ? this.formNodeValue(a, b) : this.formPointValue(a, b) },
            gatherFormValues: function(a) {
                var c = this.inspectFormWidgets(function(a) { return this.formWidgetValue(a) },
                    a);
                this.inspectFormNodes && b.mixin(c, this.inspectFormNodes(function(a) { return this.formNodeValue(a) }, a));
                b.mixin(c, this.inspectAttachedPoints(function(a) { return this.formPointValue(a) }, a));
                return c
            },
            setFormValues: function(a) { a && (this.inspectFormWidgets(function(a, b, f) { this.formWidgetValue(a, f) }, a), this.inspectFormNodes && this.inspectFormNodes(function(a, b, f) { this.formNodeValue(a, f) }, a), this.inspectAttachedPoints(function(a, b, f) { this.formPointValue(a, f) }, a)); return this }
        })
    })
}, "dojox/form/manager/_EnableMixin": function() {
    define(["dojo/_base/lang",
        "dojo/_base/kernel", "dojo/dom-attr", "./_Mixin", "dojo/_base/declare"
    ], function(b, g, n, a, c) {
        g = b.getObject("dojox.form.manager", !0);
        var d = g.actionAdapter,
            f = g.inspectorAdapter;
        return c("dojox.form.manager._EnableMixin", null, {
            gatherEnableState: function(a) {
                var c = this.inspectFormWidgets(f(function(a, b) { return !b.get("disabled") }), a);
                this.inspectFormNodes && b.mixin(c, this.inspectFormNodes(f(function(a, b) { return !n.get(b, "disabled") }), a));
                return c
            },
            enable: function(a, b) {
                if (2 > arguments.length || void 0 === b) b = !0;
                this.inspectFormWidgets(d(function(a,
                    b, c) { b.set("disabled", !c) }), a, b);
                this.inspectFormNodes && this.inspectFormNodes(d(function(a, b, c) { n.set(b, "disabled", !c) }), a, b);
                return this
            },
            disable: function(a) {
                var b = this.gatherEnableState();
                this.enable(a, !1);
                return b
            }
        })
    })
}, "dojox/form/manager/_DisplayMixin": function() {
    define(["dojo/_base/kernel", "dojo/dom-style", "dojo/_base/declare"], function(b, g, n) {
        return n("dojox.form.manager._DisplayMixin", null, {
            gatherDisplayState: function(a) {
                return this.inspectAttachedPoints(function(a, b) {
                    return "none" != g.get(b,
                        "display")
                }, a)
            },
            show: function(a, b) {
                2 > arguments.length && (b = !0);
                this.inspectAttachedPoints(function(a, b, c) { g.set(b, "display", c ? "" : "none") }, a, b);
                return this
            },
            hide: function(a) { return this.show(a, !1) }
        })
    })
}, "dojox/form/manager/_ClassMixin": function() {
    define(["dojo/_base/lang", "dojo/_base/kernel", "dojo/dom-class", "./_Mixin", "dojo/_base/declare"], function(b, g, n, a, c) {
        b = b.getObject("dojox.form.manager", !0);
        var d = b.actionAdapter,
            f = b.inspectorAdapter;
        return c("dojox.form.manager._ClassMixin", null, {
            gatherClassState: function(a,
                b) { return this.inspect(f(function(b, c) { return n.contains(c, a) }), b) },
            addClass: function(a, b) { this.inspect(d(function(b, c) { n.add(c, a) }), b); return this },
            removeClass: function(a, b) { this.inspect(d(function(b, c) { n.remove(c, a) }), b); return this }
        })
    })
}, "dojox/validate/regexp": function() {
    define(["dojo/_base/lang", "dojo/regexp", "dojox/main"], function(b, g, n) {
        var a = b.getObject("validate.regexp", !0, n);
        return a = n.validate.regexp = {
            ipAddress: function(a) {
                a = "object" == typeof a ? a : {};
                "boolean" != typeof a.allowDottedDecimal &&
                    (a.allowDottedDecimal = !0);
                "boolean" != typeof a.allowDottedHex && (a.allowDottedHex = !0);
                "boolean" != typeof a.allowDottedOctal && (a.allowDottedOctal = !0);
                "boolean" != typeof a.allowDecimal && (a.allowDecimal = !0);
                "boolean" != typeof a.allowHex && (a.allowHex = !0);
                "boolean" != typeof a.allowIPv6 && (a.allowIPv6 = !0);
                "boolean" != typeof a.allowHybrid && (a.allowHybrid = !0);
                var b = [];
                a.allowDottedDecimal && b.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");
                a.allowDottedHex && b.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");
                a.allowDottedOctal && b.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");
                a.allowDecimal && b.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
                a.allowHex && b.push("0[xX]0*[\\da-fA-F]{1,8}");
                a.allowIPv6 && b.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");
                a.allowHybrid && b.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");
                a = "";
                0 < b.length && (a = "(" + b.join("|") + ")");
                return a
            },
            host: function(b) {
                b = "object" == typeof b ? b : {};
                "boolean" != typeof b.allowIP && (b.allowIP = !0);
                "boolean" != typeof b.allowLocal && (b.allowLocal = !1);
                "boolean" != typeof b.allowPort && (b.allowPort = !0);
                "boolean" != typeof b.allowNamed && (b.allowNamed = !1);
                var c = b.allowPort ? "(\\:\\d+)?" : "",
                    f = "((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";
                b.allowIP && (f += "|" + a.ipAddress(b));
                b.allowLocal && (f += "|localhost");
                b.allowNamed && (f += "|^[^-][a-zA-Z0-9_-]*");
                return "(" + f + ")" + c
            },
            url: function(b) { b = "object" == typeof b ? b : {}; "scheme" in b || (b.scheme = [!0, !1]); return g.buildGroupRE(b.scheme, function(a) { return a ? "(https?|ftps?)\\://" : "" }) + a.host(b) + "(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?" },
            emailAddress: function(b) {
                b = "object" == typeof b ? b : {};
                "boolean" != typeof b.allowCruft && (b.allowCruft = !1);
                b.allowPort = !1;
                var c = "([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@" + a.host(b);
                b.allowCruft && (c = "\x3c?(mailto\\:)?" + c + "\x3e?");
                return c
            },
            emailAddressList: function(b) { b = "object" == typeof b ? b : {}; "string" != typeof b.listSeparator && (b.listSeparator = "\\s;,"); var c = a.emailAddress(b); return "(" + c + "\\s*[" + b.listSeparator + "]\\s*)*" + c + "\\s*[" + b.listSeparator + "]?\\s*" },
            numberFormat: function(a) { a = "object" == typeof a ? a : {}; "undefined" == typeof a.format && (a.format = "###-###-####"); return g.buildGroupRE(a.format, function(a) { return g.escapeString(a, "?").replace(/\?/g, "\\d?").replace(/#/g, "\\d") }) },
            ca: { postalCode: function() { return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])" }, province: function() { return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)" } },
            us: {
                state: function(a) {
                    a = "object" == typeof a ? a : {};
                    "boolean" != typeof a.allowTerritories && (a.allowTerritories = !0);
                    "boolean" != typeof a.allowMilitary && (a.allowMilitary = !0);
                    var b = "AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";
                    a.allowTerritories && (b += "|AS|FM|GU|MH|MP|PW|PR|VI");
                    a.allowMilitary && (b += "|AA|AE|AP");
                    return "(" + b + ")"
                }
            }
        }
    })
}, "arcgisonline/sharing/dijit/dialog/_CsvLocationDlgMixin": function() {
    define(["dojo", "dijit", "dojox"], function(b, g, n) {
        b.provide("arcgisonline.sharing.dijit.dialog._CsvLocationDlgMixin");
        b.declare("arcgisonline.sharing.dijit.dialog._CsvLocationDlgMixin", null, {
            gridInfoAddr: [{ width: "210px", field: "name", name: "fieldName" }, { width: "205px", field: "locationType", name: "addressFields", select: "addressTypes", editable: "true", type: n.grid.cells.Select }],
            gridInfoLatLong: [{
                width: "210px",
                field: "name",
                name: "fieldName"
            }, { width: "205px", field: "locationType", name: "addressFields", select: "locationTypes", editable: "true", type: n.grid.cells.Select }]
        })
    })
}, "url:dijit/templates/ProgressBar.html": '\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html": "\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/AttributeInspector.html": '\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Menu.html": '\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n', "url:esri/dijit/templates/Measurement.html": "\x3cdiv class\x3d\"esriMeasurement\"\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' class\x3d'esriMeasurementButtonContainer'\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_areaButton' iconClass\x3d'areaIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_areaButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_distanceButton' iconClass\x3d'distanceIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_distanceButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_locationButton' iconClass\x3d'locationIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_locationButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d\"esriMeasurementSeparator\"\x3e|\x3c/div\x3e\r\n    \x3cbutton dojoType\x3d'dijit.form.DropDownButton' baseClass\x3d'esriToggleButton' dojoAttachPoint\x3d'_unitDropDown' label\x3d'unit' value\x3d'unit' style\x3d'visibility:hidden;'\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultLabel' class\x3d'resultLabel esriMeasurementResultLabel'\x3e\x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValueContainer' align\x3d'leading' class\x3d\"esriMeasurementResultValue\"\x3e\r\n    \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValue' class\x3d'result'\x3e\x26nbsp;\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultTable' align\x3d'leading' class\x3d\"resultTable esriMeasurementTableContainer\" style\x3d\"display:none;\"\x3e\r\n    \x3ctable class\x3d\"esriMeasurementResultTable\"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableHeader\" colspan\x3d\"2\"\x3e${_NLS_Lat}\x3c/td\x3e\x3ctd class\x3d\"esriMeasurementTableHeader\"\x3e${_NLS_Lon}\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d\"esriMeasurementTableRow\" dojoAttachPoint\x3d\"_mouseRow\"\x3e\r\n        \x3ctd dojoAttachPoint\x3d\"mouseCell\"\x3e\x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"mouseLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"mouseLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\r\n        \x3ctd dojoAttachPoint\x3d\"pinCell\"\x3e\x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"markerLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"markerLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/Bookmarks.html": '\x3cdiv class\x3d"${_css.esriBookmarks}"\x3e\r\n  \x3cdiv class\x3d"${_css.esriBookmarkList}" dojoAttachPoint\x3d"bookmarkDomNode"\x3e\r\n      \x3cdiv class\x3d"${_css.esriBookmarkTable}" dojoAttachPoint\x3d"bookmarkTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:arcgisonline/sharing/dijit/templates/ComboBox.html": '\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"combobox" aria-haspopup\x3d"true"\r\n     data-dojo-attach-point\x3d"_popupStateNode"\x3e\r\n  \x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n       data-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\x3e\r\n    \x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1"\r\n           readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true" ${_buttonInputDisabled}/\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\x3e\r\n    \x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text"\r\n           tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"/\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\x3e\r\n    \x3cinput class\x3d\'dijitReset dijitInputInner\' readonly\x3d"readonly" ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n           data-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/CategoryPicker/templates/CategoryPicker.html": '\x3cdiv class\x3d"leader-half"\x3e\r\n  \x3cdiv\r\n    class\x3d"js-add-category-error alert alert-red font-size--3 padding-leader-quarter padding-trailer-quarter trailer-quarter"\r\n  \x3e\r\n    ${i18n.contentCategories.addCategoryError}\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"category-picker"\x3e\r\n    \x3cdiv class\x3d"font-size--1 category-picker__chip-wrap js-category-chip-wrap" data-dojo-attach-point\x3d"_chipWrap"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"dropdown js-add-category-dropdown leader-half trailer-half category-picker__dropdown"\x3e\r\n      \x3cspan class\x3d"font-size--1 category-picker__dropdown-btn"\x3e\r\n        \x3cbutton\r\n          class\x3d"btn-link btn-link-off-black font-size--1 js-add-category-dropdown-button"\r\n          tabindex\x3d"0"\r\n          aria-haspopup\x3d"true"\r\n          aria-expanded\x3d"false"\r\n          type\x3d"button"\r\n        \x3e\r\n          \x3cspan class\x3d"text-green"\x3e${!icons.inline.plus-f.16}\x3c/span\r\n          \x3e${i18n.contentCategories.addCategory}${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n      \x3c/span\x3e\r\n      \x3cdiv class\x3d"dropdown-menu leader-quarter category-picker__dropdown-menu"\x3e\r\n        \x3cdiv class\x3d"category-picker-search-wrap"\x3e\r\n          \x3cinput\r\n            type\x3d"text"\r\n            class\x3d"add-category-input js-add-category-input leader-0"\r\n            placeholder\x3d"${i18n.contentCategories.filterCategories}"\r\n            aria-label\x3d"${i18n.contentCategories.addCategoryToItem}"\r\n          /\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv\r\n          class\x3d"js-add-category-dropdown-menu category-picker-dropdown-nav padding-leader-half padding-trailer-half padding-left-half padding-right-half filter-tree--always-open"\r\n          role\x3d"menu"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CategoryPicker/templates/Category.html": '\x3cli class\x3d"js-category-picker-item filter-tree-item category-picker--add-category-dropdown ${isActive}" data-category-name\x3d"${title}" data-category-path\x3d"${path}" role\x3d"treeitem"\x3e\r\n  \x3cspan class\x3d"category-picker--add-category-dropdown-icon"\x3e${icons.check.16}\x3c/span\x3e\r\n  \x3ca href\x3d"#" class\x3d"filter-tree-link category-picker--add-category-dropdown-link js-add-category-dropdown-link ${isSelected}" data-category-name\x3d"${title}" data-category-path\x3d"${path}"\x3e${title}\x3c/a\x3e\r\n  ${children}\r\n\x3c/li\x3e\r\n',
"url:arcgisonline/pages/dijit/CategoryPicker/templates/CategoryGroup.html": '\x3cul class\x3d"filter-tree" role\x3d"${role}"\x3e${categories}\x3c/ul\x3e', "url:arcgisonline/pages/dijit/CategoryPicker/templates/CategoryChip.html": '\x3cspan class\x3d"label filter-label js-category-chip" data-category-name\x3d"${category}"\x3e\r\n  ${category:formatCategoryChip}\r\n  \x3cbutton class\x3d"js-category-chip-remove btn-link filter-label-remove margin-left-quarter right" aria-label\x3d"${removeText}" data-category-name\x3d"${category}"\x3e${icons.x.16}\x3c/button\x3e\r\n\x3c/span\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScaleMenu.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.section}"\x3e\r\n    \x3cdiv class\x3d"${css.header}"\x3e${labels.current}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_currentScaleLabel" class\x3d"${css.item} ${css.current}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_scaleInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${css.input}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recommendedScaleSection"\x3e\r\n    \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_scaleListHeader"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3col data-dojo-attach-point\x3d"dap_recommendedScales" class\x3d"${css.list}"\x3e\r\n        \x3cli data-dojo-attach-point\x3d"dap_mapScaleItem" class\x3d"${css.item} ${css.selectable}"\x3e\x3c/li\x3e\r\n        \x3c!--additional list items added dynamically--\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScalePreview.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.header}"\x3e${labels.preview}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dap_scalePreviewThumbnail" class\x3d"${css.thumbnail}"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n', "url:dojox/form/resources/HorizontalRangeSlider.html": '\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/ExpressionEditor.html": '\x3cdiv class\x3d"modal"\x3e\r\n  \x3cdiv class\x3d"modal-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_expressionEditorLoading" class\x3d"throb-loading" style\x3d"border:none;height:100%;"\x3e\x3c/div\x3e\r\n    \x3ciframe data-dojo-attach-point\x3d"_expressionEditor" scrolling\x3d"auto" style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n', "url:esri/dijit/templates/SingleFilter.html": '\x3cdiv class\x3d"esriSingleFilterForm singleFilter" id\x3d"${id}.singleFilter"\x3e\r\n  \x3cdiv\x3e\r\n    \x3ctable id\x3d"${id}.exprTable" class\x3d"rowTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column1"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column2"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column3"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column4"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column5"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column6"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column7"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3ca id\x3d"${id}.deleteExpression" href\x3d"JavaScript:void(0);" style\x3d"margin:0 5px;display:none;" class\x3d"esriAGOFilterRemoveIcon" title\x3d"${i18n.deleteExpression}"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_interactiveFilterRow"\x3e\r\n          \x3ctd colspan\x3d"8"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"interactiveFilter"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3cinput dojoAttachPoint\x3d"interactiveCheck" type\x3d"checkbox" class\x3d"promptCheckBox" title\x3d"${i18n.promptMsg}"/\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3clabel class\x3d"labels" for\x3d"promptCheckBox"\x3e\r\n                              \x26nbsp;\x26nbsp;${i18n.askForValues}\r\n                            \x3c/label\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cspan dojoAttachPoint\x3d"interactiveArrow" style\x3d"color:#cbcbcb;cursor:pointer;" class\x3d"showHidePromptDiv"\x3e\x26nbsp;\x26#9660;\x3c/span\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr dojoAttachPoint\x3d"interactiveSpace" style\x3d"display:none"\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.prompt}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"promptText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.hint}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"hintText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"promptDiv" style\x3d"display:none;padding:10px 0px;"\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtPrompt"\x3e\r\n      ${i18n.prompt}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtPrompt" type\x3d"text"/\x3e\r\n    \x3cbr/\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtHint"\x3e\r\n      ${i18n.hint}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtHint" type\x3d"text" /\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/TabContainer.html": '\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n', "url:dijit/layout/templates/_TabButton.html": '\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html": '\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html": '\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/Select.html": '\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/TableAddFieldDlg.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.container}" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" data-dojo-props\x3d"title:\'${i18n.addFieldTitle}\'"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_addForm"\x3e\r\n       \x3ctable class\x3d"${_css.table}" data-dojo-attach-point\x3d"_addTable" style\x3d"border-collapse:collapse;border-spacing:5px;" cellpadding\x3d"5px" cellspacing\x3d"5px"\x3e\r\n         \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${i18n.nameLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n              \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:true" data-dojo-attach-point\x3d"_nameInput" value\x3d""\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${i18n.aliasLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_aliasInput" value\x3d""\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n           \x3ctr\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel\x3e${i18n.typeLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cselect class\x3d"${_css.typeSelect} ${_css.leadingMargin1} ${_css.longInput} ${_css.longLabel}" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_typeSelect" data-dojo-attach-event\x3d"onChange:_handleTypeChange" data-dojo-props\x3d"value:\'esriFieldTypeString\'"\x3e\r\n                \x3coption value\x3d"esriFieldTypeDate"\x3e${i18n.dateLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeDouble"\x3e${i18n.doubleLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeInteger"\x3e${i18n.integerLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeString"\x3e${i18n.stringLabel}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n            \x3ctr data-dojo-attach-point\x3d"_lengthRow"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel"\x3e${i18n.lengthLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_lengthInput" data-dojo-props\x3d"value:256" /\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.defaultLabelContainer}"\x3e\x3clabel data-dojo-attach-point\x3d"_defaultLabel"\x3e${i18n.defaultValueLabel}\x3c/label\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.optionLabelContainer} defaultValOptional" id\x3d"defaultValOptional"\x3e\x3clabel data-dojo-attach-point\x3d"_optionLabel"\x3e${i18n.optional}\x3c/label\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_defaultStrInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-props\x3d"constraints:{places:0}" data-dojo-attach-point\x3d"_defaultNumInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDblInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/DateTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDateInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/TimeTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultTimeInput" /\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \r\n            \x3ctr id\x3d"nullableRow" class\x3d"nullable-row"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel"\x3e${i18n.nullableLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.leadingMargin1}"\x3e\r\n                  \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_nullable" checked /\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n         \x3c/table\x3e\r\n         \x3cdiv class\x3d"${_css.buttonContainer} ${_css.trailing}"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.button}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e${i18n.addNewField}\x3c/div\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.closeButton}" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-attach-event\x3d"onClick:_handleCancelButtonClick"\x3e${i18n.cancel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/ExpressionEditor.html": '\x3cdiv class\x3d"modal"\x3e\r\n  \x3cdiv class\x3d"modal-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_expressionEditorLoading" class\x3d"throb-loading" style\x3d"border:none;height:100%;"\x3e\x3c/div\x3e\r\n    \x3ciframe data-dojo-attach-point\x3d"_expressionEditor" scrolling\x3d"auto" style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n', "url:esri/dijit/templates/CalculateField.html": '\x3cdiv class\x3d"${_css.base}"\x3e\r\n  \x3cdiv class\x3d"esriFloatLeading esriCalcHelp" data-dojo-attach-point\x3d"_helpNode"\x3e\r\n    \x3ca href\x3d"#" data-dojo-attach-point\x3d"_helpurlNode" target\x3d\'_help\' class\x3d""\x3e${i18n.learnMore}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_headerPane" style\x3d"width:99%;margin-top:0.5em; margin-bottom: 0.5em;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_header" class\x3d"${_css.titleLabel}"\x3e\r\n       \x3cdiv class\x3d"esriAlignLeading"\x3e${i18n.expBuilderTitle}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.titleDividerLine}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e  \r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_expressionForm" style\x3d"height:100%;width:99%;"\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_selCalcFieldDiv" style\x3d"width:100%;padding-bottom:0.5em;"\x3e\r\n      \x3cdiv\x3e\x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.selectCalField}\x3c/label\x3e\x3c/div\x3e\r\n      \x3cselect class\x3d"esriLeadingMargin1 ${_css.selectField}" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_selCalcField"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"width:100%;padding-bottom:0.5em;" class\x3d"esriFloatLeading"\x3e\r\n      \x3clabel class\x3d"esriLeadingMargin1" data-dojo-attach-point\x3d"_calcFieldLabel"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cinput class\x3d"esriFloatLeading esriLeadingMargin1 ${_css.expressionBox}" dir\x3d"ltr" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-attach-point\x3d"_exprBox" data-dojo-props\x3d"rows:${expressionBoxRows} ,cols:${expressionBoxCols},required:true,intermediateChanges:true"\x3e\x3c/input\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading ${_css.actionBtnContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"width:70%;padding-bottom:0.5em;" dir\x3d"ltr" data-dojo-attach-point\x3d"_operatorCtr"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.remove}\',iconClass:\'${_css.clearIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleRemoveBtnClick" data-dojo-attach-point\x3d"_removeBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.validate}\',iconClass:\'${_css.validateIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleValidationBtnClick" data-dojo-attach-point\x3d"_validateBtn"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.fieldFunctionContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading ${_css.fieldContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.fieldLabelDiv}"\x3e\x3clabel class\x3d"esriLeadingMargin1 ${_css.titleLabel}"\x3e${i18n.fields}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"${_css.fieldTypeContainer}"\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_strRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"StrType"/\x3e\r\n            ${i18n.stringLabel}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_numRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"NumType"/\x3e \r\n            ${i18n.numeric}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_dateRadioBtn"  data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"DateType"/\x3e\r\n            ${i18n.dateLabel}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriLeadingMargin1 ${_css.fieldListContainer}" dir\x3d"ltr" data-dojo-attach-point\x3d"_attributeListCtr"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing ${_css.functionContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.functionLabelDiv}"\x3e\r\n          \x3clabel class\x3d"${_css.titleLabel}"\x3e${i18n.functions}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_helpersListCtr" dir\x3d"ltr" class\x3d"${_css.functionListContainer}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin05 ${_css.formWarning} esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"clear:both;display:none;"\x3e\r\n      \x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esri-icon-close" title\x3d\'${i18n.close}\' data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\r\n      \x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_bodyNode" style\x3d"width:100%;height:100%;"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.actionDividerLine}"\x3e\x3c/div\x3e\r\n    \x3cdiv  class\x3d"esriFloatTrailing esriTrailingMargin2 esriCalcFieldActionCtr" data-dojo-attach-point\x3d"_buttonCtr"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button"  class\x3d"${_css.addButton}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e\r\n        ${calculateLabel}\r\n      \x3c/div\x3e\r\n       \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriLeadingMargin05 ${_css.closeButton}" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_handleCloseButtonClick"\x3e\r\n        ${i18n.close}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_arcadeExpressionEditorDlg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dijitDialogUnderlayWrapper" data-dojo-attach-point\x3d"_underlay" style\x3d"position:absolute;z-index:949;display:none;top:0px;left:0px;width:100%;height:100%;"\x3e\r\n    \x3cdiv class\x3d"dijitDialogUnderlay" tabindex\x3d"-1" style\x3d"width:100%;height:100%"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.loadingIcon}" style\x3d"height:100%;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e  \r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/TableCalcFieldDlg.html": '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" data-dojo-attach-event\x3d"onHide:_handleDialogClose"\x3e\r\n    \x3cdiv style\x3d"width:40em;height:30em;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_expressionForm"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:arcgisonline/pages/dijit/CalculateWithOptionsDlg/templates/CalculateWithOptionsDlg.html": '\x3cdiv class\x3d"${baseClass} calculateWithOptions-wrapper"\x3e\r\n  \x3cp class\x3d"trailer-half font-size--1 text-darker-gray"\x3e${i18n.calculateSQLArcadeDlg.whatLanguage}\x3c/p\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options block-group block-group-2-up trailer-half"\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.arcade}\r\n        \x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart2}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-arcade-button"\x3e${i18n.calculateSQLArcadeDlg.arcade}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"panel panel-arcade-disabled js-panel-arcade-disabled modifier-class hide"\x3e\r\n        \x3cp class\x3d"trailer-0 text-darker-gray"\x3e${i18n.calculateSQLArcadeDlg.arcadeDisabledInfo}\r\n          \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"_arcadeDisabledHelpUrl"\x3e${i18n.addItemFrm.learnMore}\x3c/a\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart2}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart3}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-sql-button"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options__footer"\x3e\r\n\r\n    \x3ca target\x3d"_blank"\r\n      data-dojo-attach-point\x3d"_docUrl"\r\n      class\x3d"font-size--1"\x3e${i18n.addItemFrm.learnMore}\r\n      ${!icons.inline-end.launch.16}\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ArcadeCalculatorDlg/templates/ArcadeCalculatorDlg.html": '\x3cdiv class\x3d"${baseClass} arcadeCalculator-wrapper"\x3e\r\n  \x3cdiv class\x3d"js-arcade-calculatorDlg arcade-calculator-modal"\x3e\r\n    \x3cdiv class\x3d"arcade-calculator-modal-content"\x3e\r\n      \x3ciframe\r\n        data-dojo-attach-point\x3d"expressionEditor"\r\n        style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\r\n      \x3e\x3c/iframe\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-arcade-statusDlg arcade-status hide"\x3e\r\n    \x3csection class\x3d"arcade-status__section font-size--1 padding-leader-2"\x3e\r\n      \x3ch5 class\x3d"padding-leader-half trailer-half"\x3e${i18n.arcadeCalculatorDlg.calculatingRecords}\x3c/h5\x3e\r\n      \x3cdiv class\x3d"progress-bar arcade-status__progress-bar"\x3e\r\n        \x3cdiv\r\n          class\x3d"progress-bar-fill progress-bar-fill--blue"\r\n          data-dojo-attach-point\x3d"progressBar"\r\n          style\x3d"width: 0%"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"progress-bar__counts font-size--3 leading-quarter trailer-half hide js-progress-bar-counts"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"completedRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e /\r\n        \x3cspan data-dojo-attach-point\x3d"totalRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/section\x3e\r\n    \x3cdiv class\x3d"js-show-error arcade-status__section--centered leader-1 hide"\x3e\r\n      \x3cdiv class\x3d"arcade-status__error trailer-1"\x3e\r\n        \x3ch4\r\n          class\x3d"font-size--1 arcade-status-error__heading trailer-0"\r\n          data-dojo-attach-point\x3d"reviewErrorHeading"\r\n        \x3e\x3c/h4\x3e\r\n        \x3cdiv class\x3d"arcade-status-error__body"\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5\r\n              class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\r\n              data-dojo-attach-point\x3d"reviewErrorFid"\r\n            \x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorFidValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5 class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"arcade-status__message font-size-0"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewExplainText}\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"arcade-status__footer"\x3e\r\n      \x3cbutton class\x3d"btn calcite blue js-review-button arcade-review-button hide"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewButton}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn calcite btn-clear js-cancel-button arcade-cancel-button"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"loader loader-arcadeCalculator throb-loading is-active hide padding-leader-3 padding-trailer-3"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text throb-loading-text"\x3e${i18n.arcadeCalculatorDlg.defaultLoading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/FeatureAttachments/templates/FeatureAttachments.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.contentContainer}"\x3e\r\n    \x3cdiv class\x3d"${_css.tabContainer}" data-dojo-attach-point\x3d "_tabContainer" data-dojo-type\x3d"dijit/layout/TabContainer"\x3e\r\n      \x3cdiv class\x3d"${_css.viewPane}" data-dojo-attach-point\x3d "_viewPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.view}" data-dojo-props\x3d"selected:true"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.addPane}" data-dojo-attach-point\x3d "_addPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.add}" data-dojo-props\x3d"disabled:true"\x3e\r\n        \x3cdiv class\x3d"${_css.addPaneContent}" data-dojo-attach-point\x3d "_addPaneContent"\x3e\r\n          \x3cinput class\x3d"${_css.dragDrop}" type\x3d"file" name\x3d"ft_attachment_input" size\x3d"40" data-dojo-attach-point\x3d"_fileInput"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.menuContainer}"\x3e\r\n      \x3cbutton class\x3d\'${_css.formButton} ${_css.uploadButton} ${_css.hidden}\' data-dojo-attach-point\x3d"_uploadButton" data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"disabled:true"\x3e${_i18nStrings.upload}\x3c/button\x3e\r\n      \x3cdiv class\x3d"${_css.feedbackNode}" data-dojo-attach-point\x3d "_feedbackNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.loadingIndicator} ${_css.hidden}" data-dojo-attach-point\x3d"_loadingIndicator"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/Grid.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.menu}" data-dojo-attach-point\x3d "_gridHeaderNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'top\'"\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.loadingIndicator} ${css.hidden}" data-dojo-attach-point\x3d "_gridLoadingIndicatorNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.menuOptions}" data-dojo-attach-point\x3d "_menuNode" \x3e\r\n        \x3cdiv data-dojo-attach-point\x3d "_gridMenuNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.title}" data-dojo-attach-point\x3d "_gridTitleNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_gridContentPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/FeatureTable.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_leadingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'leading\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_centerPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_trailingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'trailing\'"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/DisplaySelectedConfirmationDlg.html": '\x3cdiv\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${_i18nStrings.viewer.displaySelectedTableImagesDlg.title}"\x3e\r\n\r\n        \x3cdiv\x3e${_i18nStrings.viewer.displaySelectedTableImagesDlg.message}\x3c/div\x3e\r\n        \x3cdiv\x3e\r\n            \x3cdiv class\x3d"esriFloatTrailing" style\x3d"margin-top: 1em;"\x3e\r\n                \x3cbutton class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_handleOKButtonClick"\x3e${_i18nStrings.common.ok}\x3c/button\x3e\r\n                \x3cbutton class\x3d"jevent cancel" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:hide"\x3e${_i18nStrings.common.cancel}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/Overlay/templates/Overlay.html": '\x3cdiv class\x3d"overlay-background js-overlay-background" data-dojo-attach-point\x3d"_backgroundScrim" id\x3d"${id}"\x3e\r\n  \x3cdiv\r\n    class\x3d"overlay overlay--${background} ${class} js-overlay"\r\n    role\x3d"dialog"\r\n    aria-labelledby\x3d"overlay-title"\r\n    data-dojo-attach-point\x3d"_overlay"\r\n    aria-describedby\x3d"overlay-content-${uid}"\r\n  \x3e\r\n    \x3cdiv\r\n      class\x3d"js-overlay-loader overlay-loader-container overlay-white fullscreen"\r\n      data-dojo-attach-point\x3d"_overlayLoader"\r\n    \x3e\r\n      \x3cdiv class\x3d"loader is-active"\x3e\r\n        \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"loader-text overlay-loader-text" data-dojo-attach-point\x3d"_overlayLoaderText"\x3e\r\n          ${!loadingText}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"overlay-title-bar flex js-overlay-title-bar" data-dojo-attach-point\x3d"_overlayTitleBar"\x3e\r\n      \x3cdiv class\x3d"flex overlay-mobile__title font-size-2"\x3e\r\n        \x3cdiv class\x3d"overlay-mobile__back-arrow" data-dojo-attach-point\x3d"_backArrow"\x3e${!icons.arrow-left.24}\x3c/div\x3e\r\n        \x3cdiv class\x3d"overlay-mobile__title-text" data-dojo-attach-point\x3d"mobileTitle"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3ch3 id\x3d"overlay-title" class\x3d"overlay-title flex-1"\x3e${title}\x3c/h3\x3e\r\n      \x3cdiv\x3e\r\n        \x3cbutton\r\n          class\x3d"btn-link btn-link-off-black font-size-2 margin-right-half flex-0 overlay-help hide"\r\n          data-dojo-attach-point\x3d"_helpBtn"\r\n          aria-label\x3d"help"\r\n        \x3e\r\n          ${!icons.question.32}\x3c/button\r\n        \x3e\x3cbutton\r\n          class\x3d"btn-link btn-link-off-black font-size-2 flex-0 overlay-close"\r\n          data-dojo-attach-point\x3d"closeBtn"\r\n          aria-label\x3d"close"\r\n        \x3e\r\n          ${!icons.x.32}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-overlay-control-bar"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"overlay-control-bar-filters js-overlay-control-bar-filters"\x3e\x3c/div\x3e\r\n    \x3cdiv\r\n      class\x3d"overlay-content js-overlay-content"\r\n      data-dojo-attach-point\x3d"_overlayContentWrapper"\r\n      id\x3d"overlay-content-${uid}"\r\n    \x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"overlay-action-bar ${showActionBar:hide}" data-dojo-attach-point\x3d"_overlayActionBar"\x3e\r\n      \x3cnav class\x3d"right"\x3e\r\n        \x3cbutton class\x3d"btn js-overlay-primary" data-dojo-attach-point\x3d"_primaryBtn"\x3e${primaryBtnText}\x3c/button\x3e\r\n        \x3cbutton class\x3d"btn btn-clear calcite-web-btn-clear js-overlay-cancel" data-dojo-attach-point\x3d"_cancelBtn"\x3e\r\n          ${i18n.common.cancel}\r\n        \x3c/button\x3e\r\n      \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-folder-loader folder-loader loader loader-centered overlay-white"\x3e\r\n      \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/GeneralOverlay.html": '\r\n\x3cdiv class\x3d"flex general-overlay"\x3e\r\n  \x3ciframe class\x3d"js-iframe flex-1 general-overlay__iframe"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n\r\n\r\n\r\n\r\n\r\n', "url:arcgisonline/pages/dijit/Overlay/templates/OverlayConfirm.html": '\x3cdiv class\x3d"position-relative full-height overlay-confirm"\x3e\r\n    \x3cdiv class\x3d"overlay-confirm-mask"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"overlay-confirm-pane ${cssClasses} position-relative"\x3e\r\n      \x3cbutton class\x3d"btn btn-link btn-link-darker-gray overlay-confirm-close-btn" data-dojo-attach-point\x3d"_closeBtn"\x3e${!icons.x.24}\x3c/button\x3e\r\n      \x3cdiv class\x3d"flex flex-align-center"\x3e\r\n        \x3cdiv class\x3d"overlay-confirm__icon margin-right-1" data-dojo-attach-point\x3d"icon"\x3e\x3c/div\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv class\x3d"avenir-demi font-size-1" data-dojo-attach-point\x3d"_title"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"font-size--1" data-dojo-attach-point\x3d"_description"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"leader-half flex overlay-confirm-buttons" data-dojo-attach-point\x3d"_buttons"\x3e\r\n        \x3cbutton class\x3d"btn btn-clear js-cancel-btn"\x3e\x3c/button\x3e\r\n        \x3cbutton class\x3d"btn margin-left-half overlay-confirm__confirm-btn js-confirm-btn"\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide leader-1 padding-leader-1 overlay-confirm-actions" data-dojo-attach-point\x3d"_actions"\x3e\r\n        \x3cbutton class\x3d"btn-link trailer-half display-block js-action-one"\x3e\x3c/button\x3e\r\n        \x3cbutton class\x3d"btn-link js-action-two"\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n',
"url:esri/dijit/templates/MosaicRule.html": '\x3cdiv data-dojo-attach-point\x3d"_mosaicRuleContainer" class\x3d"mosaicRuleContainer"\x3e\r\n  \x3ctable class\x3d"mosaicRuleTable"\x3e\r\n    \x3ccol class\x3d"mosaicRuleColumn1" /\x3e\r\n    \x3ccol class\x3d"mosaicRuleColumn2" /\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_mosaicRuleLabel"\x3e${_i18n.widgets.mosaicRule.mosaicMethodLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"_mosaicRule" id\x3d"MosaicMethod" class\x3d"mosaicRuleSelectbox"\x3e\r\n          \x3coption\x3e\x26lt;MosaicDefault\x26gt;\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3" class\x3d"mosaicParams"\x3e\r\n      \x3cdiv class\x3d"mosaicParams"\x3e\r\n        \x3ctable class\x3d"mosaicParamsTable" cellpadding\x3d"0" cellspacing\x3d"0" border\x3d"0"\x3e\r\n          \x3ctr data-dojo-attach-point\x3d"_orderFieldBlock"\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel\x3e${_i18n.widgets.mosaicRule.orderFieldLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_orderField" class\x3d"mosaicRuleAttributeSelectbox"\x3e\r\n                \x3coption\x3e\x26lt;MosaicDefault\x26gt;\x3c/option\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr data-dojo-attach-point\x3d"_orderValueTextBlock"\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel\x3e${_i18n.widgets.mosaicRule.orderValueLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cinput type\x3d"text" value\x3d"0" data-dojo-attach-point\x3d"_orderValueText" class\x3d"mosaicRuleOrderValueTextbox" /\x3e\r\n              \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_orderValueDate" data-dojo-type\x3d"dijit/form/DateTextBox" class\x3d"mosaicRuleOrderValueDate" /\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr data-dojo-attach-point\x3d"_lockRasterBlock"\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel\x3e${_i18n.widgets.mosaicRule.lockRasterIdLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_lockRaster" class\x3d"mosaicRuleLockRasterTextbox" /\x3e\r\n              \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-attach-point\x3d"_lockRasterIdSelect"\r\n                iconclass\x3d"mosaicRuleThreedotsIcon" class\x3d"mosaicRuleDropdownIcon" showlabel\x3d\'false\'\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"_lockRasterTooltip"\x3e\r\n                  \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" class\x3d"mosaicRuleLayerlistTooltip"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_layerList"\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                  \x3ccenter\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_aoi" type\x3d"button" value\x3d"${_i18n.widgets.mosaicRule.refreshLockRasterIdsLabel}"\x3e\x3c/input\x3e\x3c/center\x3e\r\n                  \x3c/br\x3e\r\n                  \x3clabel data-dojo-attach-point\x3d"_lockRasterMsg" /\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr data-dojo-attach-point\x3d"_descendingBlock"\x3e\r\n            \x3ctd colspan\x3d"2"\x3e\r\n              \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"_descending" name\x3d"descending"/\x3e\r\n              \x3clabel class\x3d"mosaicRuleDescendingLabel" for\x3d"descending"\x3e${_i18n.widgets.mosaicRule.descendingLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3"\x3e\r\n        \x3cp/\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr data-dojo-attach-point\x3d"_mosaicOperatorLabelBlock"\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel\x3e${_i18n.widgets.mosaicRule.mosaicOperatorLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr data-dojo-attach-point\x3d"_mosaicOperatorBlock"\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"_mosaicOperator" class\x3d"mosaicRuleSelectbox"\x3e\r\n          \x3coption\x3e\x26lt;MosaicDefault\x26gt;\x3c/option\x3e\r\n          \x3coption\x3eFirst\x3c/option\x3e\r\n          \x3coption\x3eBlend\x3c/option\x3e\r\n          \x3coption\x3eLast\x3c/option\x3e\r\n          \x3coption\x3eMin\x3c/option\x3e\r\n          \x3coption\x3eMax\x3c/option\x3e\r\n          \x3coption\x3eMean\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_whereLabel" for\x3d"where"\x3e\r\n          ${_i18n.widgets.mosaicRule.queryLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cinput type\x3d"text" value\x3d"\x3cwhere\x3e" class\x3d"mosaicRuleQueryTextbox" data-dojo-attach-point\x3d"_where" /\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" iconclass\x3d"mosaicRuleQueryIcon" showlabel\x3d\'false\'\r\n          data-dojo-attach-point\x3d"_queryBlock"\x3e\r\n          \x3cspan\x3eQuery\x3c/span\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"_queryTooltip"\x3e\r\n            \x3ctable class\x3d"mosaicRuleQueryTable"\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3clabel\x3e${_i18n.widgets.mosaicRule.queryFieldLabel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"_queryOrderField" class\x3d"mosaicRuleSelectbox"\x3e\r\n                    \x3coption\x3e\x26lt;None\x26gt;\x3c/option\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3clabel\x3e${_i18n.widgets.mosaicRule.queryOperatorLabel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"_queryOperator" class\x3d"mosaicRuleSelectbox"\x3e\r\n                    \x3coption\x3e\x26lt;None\x26gt;\x3c/option\x3e\r\n                    \x3coption\x3e\x3d\x3c/option\x3e\r\n                    \x3coption\x3e\x26lt;\x26gt;\x3c/option\x3e\r\n                    \x3coption\x3e\x26gt;\x3c/option\x3e\r\n                    \x3coption\x3e\x26gt;\x3d\x3c/option\x3e\r\n                    \x3coption\x3e\x26lt;\x3c/option\x3e\r\n                    \x3coption\x3e\x26lt;\x3d\x3c/option\x3e\r\n                    \x3coption\x3eLIKE\x3c/option\x3e\r\n                    \x3coption\x3eAND\x3c/option\x3e\r\n                    \x3coption\x3eOR\x3c/option\x3e\r\n                    \x3coption\x3eNOT\x3c/option\x3e\r\n                    \x3coption\x3eIS\x3c/option\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3clabel\x3e${_i18n.widgets.mosaicRule.queryValueLabel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_queryValue" class\x3d"mosaicRuleTextbox" /\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cinput type\x3d"button" data-dojo-attach-point\x3d"_apply" value\x3d"APPLY" size\x3d"15" class\x3d"mosaicRuleApplyButton" /\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/RenderingRule.html": '\x3cdiv data-dojo-attach-point\x3d"_renderingRuleContainer" class\x3d"esriRenderingRuleContainer"\x3e\r\n  \x3ctable class\x3d"esriRenderingRuleTable"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ccol class\x3d"esriRenderingRuleCol1"/\x3e\r\n      \x3ccol class\x3d"esriRenderingRuleCol2"/\x3e\r\n      \x3ccol class\x3d"esriRenderingRuleCol3"/\x3e\r\n      \x3ccol class\x3d"esriRenderingRuleCol4"/\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel class\x3d"esriRenderingRuleHeadingLabel" data-dojo-attach-point\x3d"rendererLabel"\x3e${_i18n.widgets.renderingRule.rendererLabelTitle}\x3c/label\x3e\r\n          \x3ca class\x3d"esriRenderingRuleWarningIcon" data-dojo-attach-point\x3d"vectorWarningIcon"\x3e\x3c/a\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"rasterFunctionBlock"\x3e\r\n        \x3ctd colspan\x3d"3" data-dojo-attach-point\x3d"rasterFunctionRow"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"rasterFunctionList" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n            class\x3d"esriRenderingRuleRasterFunctionList dijitSelect"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cspan tabindex\x3d"0" id\x3d"rftAddition" class\x3d"esri-icon-plus-circled" data-dojo-attach-point\x3d"addRasterFunction" data-dojo-attach-event\x3d\'onClick: _addCustomRasterFunction\'\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3" data-dojo-attach-point\x3d"messageBlock"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"customRFTMessage" class\x3d"esriRenderingRuleLoadingMsg"\x3e${_i18n.applyRFxTemplateTool.loadingMessage}\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"bandIdsLabelBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel class\x3d"esriRenderingRuleHeadingLabel" data-dojo-attach-point\x3d"bandIdsLabel"\x3e${_i18n.widgets.renderingRule.bandCombinationLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"bandIdsBlock"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"bandIdsRedList" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n            class\x3d"esriRenderingRuleBandIdsRedList dijitSelect" data-dojo-attach-event\x3d"onChange: _updateStretchStatsGrid"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"bandIdsGreenList" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n            class\x3d"esriRenderingRuleBandIdsGreenList dijitSelect" data-dojo-attach-event\x3d"onChange: _updateStretchStatsGrid"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"bandIdsBlueList" data-dojo-type\x3d"dijit/form/FilteringSelect"\r\n            class\x3d"esriRenderingRuleBandIdsBlueList dijitSelect" data-dojo-attach-event\x3d"onChange: _updateStretchStatsGrid"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"bandIdsMsgBlock"\x3e\r\n        \x3ctd/\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"msgLabel" class\x3d"esriRenderingRuleMsgLabel"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel class\x3d"esriRenderingRuleEnhancementHeadingLabel" data-dojo-attach-point\x3d"imageEnhancementLabel"\x3e${_i18n.widgets.renderingRule.imageEnhancementLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"symbologyTypeBlock"\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"symbologyTypeLabelRow" class\x3d"esriRenderingRuleVisible"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel class\x3d"esriRenderingRuleSymbologyTypeLabel"\x3e${_i18n.widgets.renderingRule.symbologyTypeLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"symbologyTypeSelectRow" class\x3d"esriRenderingRuleVisible"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"symbologyTypeSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"labelAttr: \'label\'"\r\n            class\x3d"esriRnderingRuleSymbologyTypeSelect" data-dojo-attach-event\x3d"onChange: _onSymbologyTypeChange"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"stretchBlock"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"stretchDescLabel"\x3e${_i18n.widgets.renderingRule.stretchDescLabel}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"stretchMethodLabel"\x3e${_i18n.widgets.renderingRule.stretchMethodLabel}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"stretchMethodList" style\x3d"width:100%;" data-dojo-type\x3d"dijit/form/Select" class\x3d"esriRenderingRuleStretchMethodList"\x3e\r\n          \x3c/select\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"stretchMethodNoneDescBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"stretchMethodNoneDesc"\x3e${_i18n.widgets.renderingRule.stretchMethodNoneDesc}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"stretchMethodMinMaxDescBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"stretchMethodMinMaxDesc"\x3e${_i18n.widgets.renderingRule.stretchMethodMinMaxDesc}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"numStdDevBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"numStdDevLabel"\x3e${_i18n.widgets.renderingRule.numStdDevLabelTitle}\x3c/label\x3e\r\n          \x3cinput type\x3d"text" value\x3d"2.0" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"numStdDevText" class\x3d"esriRenderingRuleFixedInput"\x3e\r\n          \x3c/input\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"numStdDevLabel"\x3e${_i18n.widgets.renderingRule.numStdDevEndLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd/\x3e\r\n        \x3ctd/\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"minMaxPercentDescBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"numStdDescLabel"\x3e${_i18n.widgets.renderingRule.minMaxDescLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"maxPercentBlock"\x3e\r\n        \x3ctd\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"maxPercentLabel"\x3e${_i18n.widgets.renderingRule.maxPercentLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" value\x3d"2.0" data-dojo-attach-point\x3d"maxPercentText" class\x3d"esriRenderingRuleFixedInput"\x3e\r\n          \x3c/input\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"percentLabel"\x3e${_i18n.widgets.renderingRule.percentLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"minPercentBlock"\x3e\r\n        \x3ctd\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"minPercentLabel"\x3e${_i18n.widgets.renderingRule.minPercentLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" type\x3d"text" value\x3d"2.0" data-dojo-attach-point\x3d"minPercentText" class\x3d"esriRenderingRuleFixedInput"\x3e\r\n          \x3c/input\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"percentLabel"\x3e${_i18n.widgets.renderingRule.percentLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"gammaBlock"\x3e\r\n        \x3ctd\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"gammaLabel"\x3e${_i18n.widgets.renderingRule.gammaLabelTitle}\x3c/label\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd colspan\x3d"2"\x3e\r\n          \x3cdiv id\x3d"gammaSliderID" data-dojo-attach-point\x3d"gammaSlider" class\x3d"esriRenderingRuleGammaSlider" data-dojo-type\x3d"dijit.form.HorizontalSlider" showbuttons\x3d"true" value\x3d"0.0" minimum\x3d"-1" maximum\x3d"1" intermediatechanges\x3d"true"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" labels\x3d"${_i18n.widgets.renderingRule.minGammaLabel}, ${_i18n.widgets.renderingRule.maxGammaLabel}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"draBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3cinput type\x3d"checkbox" value\x3d"true" data-dojo-attach-point\x3d"draCheckbox" class\x3d"esriRenderingRuleDraCheckbox" data-dojo-attach-event\x3d"onChange: _onDRAChange"\x3e\r\n          \x3c/input\x3e\r\n          \x3clabel class\x3d"esriRenderingRuleDraLabel" data-dojo-attach-point\x3d"draLabel"\x3e${_i18n.widgets.renderingRule.draLabelTitle}\x3c/label\x3e\r\n        \x3ctd/\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"stretchStatsBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\x3cdiv data-dojo-attach-point\x3d"stretchStatsGrid"\x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"classifyBlock"\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"classifyFieldBlock"\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"classifyFieldLabel"\x3e${_i18n.widgets.renderingRule.fieldLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"classifyFieldSelect" class\x3d"esriRenderingRuleClassifySelect"\r\n            data-dojo-props\x3d"labelAttr: \'alias\'" data-dojo-attach-event\x3d"onChange: _onClassifyFieldChange"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"classifyMethodBlock"\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"classifyMethodLabel"\x3e${_i18n.widgets.renderingRule.methodLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-point\x3d"classifyMethodSelect" class\x3d"esriRenderingRuleClassifyMethodSelect"\r\n            data-dojo-props\x3d"labelAttr: \'label\', labelType: \'html\'" data-dojo-attach-event\x3d"onChange: _onClassifyMethodChange"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"classifyNClassesBlock"\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"classifyNClassesLabel"\x3e${_i18n.widgets.renderingRule.nClassesLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"classifyNClassesInput" class\x3d"esriRenderingRuleClassifyClassSelect" data-dojo-attach-event\x3d"onChange: _updateClassifyGrid"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"classifyIntervalsBlock"\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"classifyIntervalLabel"\x3e${_i18n.widgets.renderingRule.intervalLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"classifyIntervalInput" class\x3d"esriRenderingRuleClassifyIntervalSelect"\r\n            data-dojo-attach-event\x3d"onChange: _updateClassifyGrid"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"uniqueValuesBlock"\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"uniqueValuesFieldBlock"\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"uniqueValuesFieldLabel"\x3e${_i18n.widgets.renderingRule.fieldLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"uniqueValuesFieldSelect"\r\n            class\x3d"esriRenderingRuleUniqueValuesSelect" data-dojo-props\x3d"labelAttr: \'alias\'" data-dojo-attach-event\x3d"onChange: _updateUniqueValuesGrid"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n      \x3ctbody data-dojo-attach-point\x3d"shadedReliefBlock"\x3e\r\n        \x3ctr class\x3d"shadedReliefHillShadeTypeBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"shadedReliefHillshadeTypeLabel"\x3e${_i18n.widgets.renderingRule.hillshadeTypeLabel}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefHillShadeTypeBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel class\x3d"esriRenderingRuleHillshadeType"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"hillshadeType" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_traditionalRadio"\r\n              data-dojo-attach-event\x3d"onChange: _onHillShadeTypeChange" checked\x3d"true"\x3e\r\n              ${_i18n.widgets.renderingRule.traditionalLabel}\r\n            \x3c/label\x3e\r\n            \x3clabel class\x3d"esriRenderingRuleHillshadeType"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"hillshadeType" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_multidirectionalRadio"\x3e\r\n              ${_i18n.widgets.renderingRule.multidirectionalLabel}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefAzimuthBlock"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\x3clabel data-dojo-attach-point\x3d"shadedReliefAzimuthLabel"\x3e\r\n            ${_i18n.widgets.renderingRule.azimuthLabel}\x3c/label\x3e\r\n            \x3cinput class\x3d"esriRenderingRuleSliderValue" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n             data-dojo-attach-point\x3d"azimuthValueInput" data-dojo-attach-event\x3d"onChange: _onAzimuthValueChange, onKeyDown: _onAzimuthKeyDown"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefAzimuthBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cdiv id\x3d"azimuthSliderID" data-dojo-attach-point\x3d"shadedReliefAzimuthSlider" class\x3d"esriRenderingRuleGammaSlider" data-dojo-type\x3d"dijit.form.HorizontalSlider" showbuttons\x3d"true" minimum\x3d"0" maximum\x3d"360" intermediatechanges\x3d"true"\x3e\r\n              \x3cdiv data-dojo-type\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" labels\x3d"0, 360" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefAltitudeBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\x3clabel data-dojo-attach-point\x3d"shadedReliefAltitudeLabel"\x3e\r\n            ${_i18n.widgets.renderingRule.altitudeLabel}\x3c/label\x3e\r\n            \x3cinput class\x3d"esriRenderingRuleSliderValue" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n              data-dojo-attach-point\x3d"altitudeValueInput" data-dojo-attach-event\x3d"onChange: _onAltitudeValueChange, onKeyDown: _onAltitudeKeyDown"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefAltitudeBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cdiv id\x3d"altitudeSliderID" data-dojo-attach-point\x3d"shadedReliefAltitudeSlider" class\x3d"esriRenderingRuleGammaSlider" data-dojo-type\x3d"dijit.form.HorizontalSlider" showbuttons\x3d"true" minimum\x3d"0" maximum\x3d"90" intermediatechanges\x3d"true"\x3e\r\n              \x3cdiv data-dojo-type\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" labels\x3d"0, 90" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"shadedReliefScalingLabel"\x3e${_i18n.widgets.renderingRule.scaling}\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3clabel class\x3d"esriRenderingRuleHillshadeType"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"scaling" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_noneRadio"\r\n              data-dojo-attach-event\x3d"onChange: _onScalingChange" checked\x3d"true"\x3e\r\n              ${_i18n.widgets.renderingRule.none}\r\n            \x3c/label\x3e\r\n            \x3clabel class\x3d"esriRenderingRuleHillshadeType"\x3e\r\n              \x3cinput type\x3d"radio" name\x3d"scaling" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_adjustedRadio"\x3e\r\n              ${_i18n.widgets.renderingRule.adjusted}\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3ctr data-dojo-attach-point\x3d"shadedReliefZFactorBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\x3clabel data-dojo-attach-point\x3d"shadedReliefZFactorLabel"\x3e\r\n          ${_i18n.widgets.renderingRule.zFactor}\x3c/label\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"zFactorInput" class\x3d"esriRenderingRuleClassifyClassSelect"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3ctr class\x3d"shadedReliefPixelSizePowerBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\x3clabel data-dojo-attach-point\x3d"shadedReliefPixelSizePowerLabel"\x3e\r\n          ${_i18n.widgets.renderingRule.pixelSizePower}\x3c/label\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefPixelSizePowerBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"pixelSizePowerInput" class\x3d"esriRenderingRuleClassifyClassSelect"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3ctr class\x3d"shadedReliefPixelSizeFactorBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\x3clabel data-dojo-attach-point\x3d"shadedReliefPixelSizeFactorLabel"\x3e\r\n          ${_i18n.widgets.renderingRule.pixelSizeFactor}\x3c/label\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"shadedReliefPixelSizeFactorBlock"\x3e\r\n          \x3ctd colspan\x3d"3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"pixelSizeFactorInput" class\x3d"esriRenderingRuleClassifyClassSelect"\x3e\x3c/input\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n      \x3c/tbody\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"colorRampLabelBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3cdiv class\x3d"esriRenderingRuleColorRampHeading"\x3e${_i18n.widgets.renderingRule.colorRampTitle}\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"colorRampBlock"\x3e\r\n        \x3ctd colspan\x3d"3" \x3e\r\n          \x3cselect data-dojo-attach-point\x3d"colorRampSelect" data-dojo-type\x3d"esri/dijit/ColorRampSelector" class\x3d"esriRenderingRuleColorRampList dijitSelect"\r\n          data-dojo-props\x3d"dropDownPosition: [\'below\', \'above\'], maxHeight: 200" data-dojo-attach-event\x3d"onChange: _onColorRampChange"\x3e\x3c/select\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"classifyGridBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"classifyLoadingMsg" class\x3d"esriRenderingRuleLoadingMsg"\x3e${_i18n.widgets.renderingRule.classifyLoadingMsg}\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"classifyGrid"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"uniqueValuesGridBlock"\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"uniqueValuesLoadingMsg" class\x3d"esriRenderingRuleLoadingMsg"\x3e${_i18n.widgets.renderingRule.uniqueValuesLoadingMsg}\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"uniqueValuesGrid"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd colspan\x3d"3"\x3e\r\n          \x3ccenter\x3e\x3cinput type\x3d"button" data-dojo-attach-point\x3d"_apply" value\x3d"APPLY" size\x3d"15" class\x3d"esriRenderingRuleApplyButton" /\x3e\x3c/center\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n   \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"_vectorTooltipDlg"\r\n    class\x3d"esriRenderingRuleVectorTooltip" style\x3d"display: none;"\x3e\r\n      \x3cp\x3e${_i18n.widgets.renderingRule.createVectorLayerDesc}\x3c/p\x3e\r\n      \x3cdiv class\x3d\'dijitDialogPaneActionBar\'\x3e\r\n        \x3cbutton data-dojo-type\x3d\'dijit/form/Button\' data-dojo-attach-event\x3d\'onClick: _createVectorLayer\' class\x3d"calcite blue"\x3e${_i18n.common.yesLabel}\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d\'dijit/form/Button\' data-dojo-attach-event\x3d\'onClick: _hideVectorWarning\' class\x3d"calcite transparent"\x3e${_i18n.common.noLabel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html": '\x3cdiv class\x3d"${css.container}" aria-label\x3d"${labels.widgetLabel}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header" tabindex\x3d"0"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch"\r\n            class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cspan aria-hidden\x3d"true" role\x3d"presentation"\r\n          class\x3d"${css.collapseIcon} ${css.downArrowIcon}"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.colorControls}" data-dojo-attach-point\x3d"dap_colorControls"\r\n       id\x3d"${id}-color-controls" tabindex\x3d"-1"\x3e\r\n    \x3cdiv class\x3d"${css.middle}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer"\r\n           class\x3d"${css.palette} ${css.container}" tabindex\x3d"0"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette"\r\n             class\x3d"${css.palette}" role\x3d"grid"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette"\r\n             class\x3d"${css.palette}" role\x3d"grid"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n        \x3cinput type\x3d"text" aria-label\x3d"${labels.selectedColor}" data-dojo-type\x3d"dijit/form/TextBox"\r\n               data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}" /\x3e\r\n        \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button"\r\n               data-dojo-type\x3d"dijit/form/ToggleButton"\r\n               data-dojo-attach-point\x3d"dap_paletteToggle"\r\n               label\x3d"${labels.more}" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n      \x3cdiv class\x3d"${css.section} ${css.displayNone}"\r\n           data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}" id\x3d"${id}-suggested-colors-label"\x3e${labels.suggested}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.suggested} ${css.palette}"\r\n             aria-labelledby\x3d"${id}-suggested-colors-label"\r\n             data-dojo-attach-point\x3d"dap_suggestedColorPaletteContainer"\r\n             tabindex\x3d"0" role\x3d"grid"\x3e\r\n          \x3cdiv class\x3d"${css.suggested} ${css.swatchRow}"\r\n               data-dojo-attach-point\x3d"dap_suggestedColorPalette"\r\n               role\x3d"row"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}"\r\n           data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}" id\x3d"${id}-recent-colors-label"\x3e${labels.recent}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.recent} ${css.palette}" aria-labelledby\x3d"${id}-recent-colors-label"\r\n             data-dojo-attach-point\x3d"dap_recentColorPaletteContainer"\r\n             tabindex\x3d"0" role\x3d"grid"\x3e\r\n          \x3cdiv class\x3d"${css.recent} ${css.swatchRow}"\r\n               data-dojo-attach-point\x3d"dap_recentColorPalette"\r\n               role\x3d"row"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}"\r\n           data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel"\r\n             class\x3d"${css.label}"\x3e${labels.transparency}\r\n      \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.transparencySlider}"\r\n             data-dojo-attach-point\x3d"dap_transparencySlider"\r\n             data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n             data-dojo-props\x3d"minimum: 0, maximum: 100, discreteValues: 100, labels: ${_transparencyLabels}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/MultidimensionalFilter.html": '\x3cdiv data-dojo-attach-point\x3d"_multidimensionalFilterContainer" class\x3d"esriMultidimensionalFilterContainer"\x3e\r\n    \x3ctable class\x3d"esriMultidimensionalFilterTable"\x3e\r\n        \x3ctbody\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n        \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3"\x3e\r\n                \x3clabel class\x3d"esriMultidimensionalFilterHeadingLabel" data-dojo-attach-point\x3d"VariableFilterLabel"\x3e${_i18n.widgets.multidimensionalFilter.variableFilter}\r\n                \x3c/label\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3" data-dojo-attach-point\x3d"VariableListRow"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"variableList" data-dojo-type\x3d"dijit/form/FilteringSelect" class\x3d"esriMultidimensionalFilterVariableList dijitSelect"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3" class\x3d"esriMultidimensionalFilterDimensionHeadingLabelTd"\x3e\r\n                \x3clabel class\x3d"esriMultidimensionalFilterDimensionHeadingLabel" data-dojo-attach-point\x3d"VariableFilterLabel"\x3e${_i18n.widgets.multidimensionalFilter.filterByDimensionalValues}\r\n                \x3c/label\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n        \x3cdiv class\x3d"esriMultidimensionalFilterDimensionFilterGrid" data-dojo-attach-point\x3d"dimensionFilterGrid"\x3e\r\n        \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick: _onClickApplyMultidimensionalFilter" data-dojo-attach-point\x3d"applyButton"\x3e${_i18n.widgets.multidimensionalFilter.applyLabelTitle}\r\n      \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/NumericDimensionItem.html": '\x3ctable class\x3d"esriMultidimensionalFilterItemTable"\x3e\r\n  \x3ctbody\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n  \x3ctr\x3e\r\n    \x3ctd colspan\x3d"2"\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"dimensionCheckbox" name\x3d"dimensionCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onDimensionCheckboxChange" checked/\x3e \x3clabel for\x3d"${dimension}" class\x3d"esriMultidimensionalFilterDimensionText" data-dojo-attach-point\x3d"dimensionAlias"\x3e${dimensionAlias}\x3c/label\x3e \r\n      \x3cspan data-dojo-attach-point\x3d"dimensionUnit"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}${id}Info"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}${id}Info\',position:[\'after\']"\x3e\r\n          \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n            \x3cb\x3e${dimensionAlias}\x3c/b\x3e \r\n            \x3cspan data-dojo-attach-point\x3d"tooltipUnit"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipNumberFromValueText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipFromValue"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipNumberToValueText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipToValue"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipCountText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipValueCount"\x3e\x3c/span\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"disabledDimText" class\x3d"esriMultidimensionalFilterTooltipDisabledDimensionText"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/td\x3e\r\n    \x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"rangeSpan"\x3e\x3cinput data-dojo-attach-point\x3d"rangeCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onRangeCheckboxChange"/\x3e \x3clabel for\x3d"${dimension}RangeCheckbox" class\x3d"rangeText"\x3e${_i18n.widgets.multidimensionalFilter.rangeText}\x3c/label\x3e\r\n        \x3cdiv class\x3d"esriMultidimensionalFilterRangeInfoDiv" id\x3d"${dimension}${id}hasRangesInfo" data-dojo-attach-point\x3d"hasRangesInfo"\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}${id}hasRangesInfo\',position:[\'after\']"\x3e\r\n            \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n              ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText1}\x3cbr/\x3e\r\n              ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText2}\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n  \x3ctr data-dojo-attach-point\x3d"minRow"\x3e\r\n    \x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"minValueText"\x3e${_i18n.widgets.multidimensionalFilter.sliceNumberText}\x3c/span\x3e\x3c/td\x3e\r\n    \x3ctd colspan\x3d"2"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"minNumberSelector"\x3e\x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n  \x3ctr data-dojo-attach-point\x3d"maxRow" class\x3d"esriDomHide"\x3e\r\n    \x3ctd\x3e${toText}\x3c/td\x3e\r\n    \x3ctd colspan\x3d"2"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"maxNumberSelector"\x3e\x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n\x3c/tbody\x3e\r\n\x3c/table\x3e',
"url:esri/dijit/templates/TimeDimensionItem.html": '\x3ctable class\x3d"esriMultidimensionalFilterItemTable"\x3e\r\n  \x3ctbody\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol1"/\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol2"/\x3e\r\n  \x3ccol class\x3d"esriMultidimensionalFilterCol3"/\x3e\r\n  \x3ctr\x3e\r\n    \x3ctd colspan\x3d"2"\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"dimensionCheckbox" name\x3d"dimensionCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onDimensionCheckboxChange" checked/\x3e \x3clabel for\x3d"${dimension}" class\x3d"esriMultidimensionalFilterDimensionText" data-dojo-attach-point\x3d"dimensionAlias"\x3e${dimensionAlias}\x3c/label\x3e \r\n      \x3cspan data-dojo-attach-point\x3d"dimensionUnit"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"esriMultidimensionalFilterInfoDiv" id\x3d"${dimension}${id}Info"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}${id}Info\',position:[\'after\']"\x3e\r\n          \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n            \x3cb\x3e${dimensionAlias}\x3c/b\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"tooltipUnit"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipDateFromValueText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipFromValue"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipDateToValueText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipToValue"\x3e\x3c/span\x3e\r\n            \x3cbr/\x3e   \x3cspan class\x3d"esriMultidimensionalFilterTooltipLeftText"\x3e${_i18n.widgets.multidimensionalFilter.tooltipCountText}\x3c/span\x3e \x3cspan data-dojo-attach-point\x3d"tooltipValueCount"\x3e\x3c/span\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"disabledDimText" class\x3d"esriMultidimensionalFilterTooltipDisabledDimensionText"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/td\x3e\r\n    \x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"rangeSpan"\x3e\x3cinput data-dojo-attach-point\x3d"rangeCheckbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onChange:_onRangeCheckboxChange"/\x3e \x3clabel for\x3d"${dimension}RangeCheckbox" class\x3d"rangeText"\x3e${_i18n.widgets.multidimensionalFilter.rangeText}\x3c/label\x3e\r\n        \x3cdiv class\x3d"esriMultidimensionalFilterRangeInfoDiv" id\x3d"${dimension}${id}hasRangesInfo" data-dojo-attach-point\x3d"hasRangesInfo"\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/Tooltip" data-dojo-props\x3d"connectId:\'${dimension}${id}hasRangesInfo\',position:[\'after\']"\x3e\r\n            \x3cdiv class\x3d"esriMultidimensionalFilterInfoTooltip"\x3e\r\n              ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText1}\x3cbr/\x3e\r\n              ${_i18n.widgets.multidimensionalFilter.hasRangesInfoText2}\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n  \x3ctr data-dojo-attach-point\x3d"minRow"\x3e\r\n    \x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"minDateText"\x3e${_i18n.widgets.multidimensionalFilter.sliceTimeText}\x3c/span\x3e\x3c/td\x3e\r\n    \x3ctd colspan\x3d"2"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"minDateSelector"\x3e\x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n  \x3ctr data-dojo-attach-point\x3d"maxRow" class\x3d"esriDomHide"\x3e\r\n    \x3ctd\x3e${toText}\x3c/td\x3e\r\n    \x3ctd  colspan\x3d"2"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"maxDateSelector"\x3e\x3c/span\x3e\r\n    \x3c/td\x3e\r\n  \x3c/tr\x3e\r\n\x3c/tbody\x3e\r\n\x3c/table\x3e',
"url:esri/dijit/templates/PagedDateTimeWidget.html": '\x3cdiv\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsStartButton\', showLabel: false" data-dojo-attach-point\x3d"StartBtn" data-dojo-attach-event\x3d"onClick:_onStartBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.startDateButtonTooltip}\x3c/button\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsPrevButton\', showLabel: false" data-dojo-attach-point\x3d"PreviousBtn" data-dojo-attach-event\x3d"onClick:_onPreviousBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.previousButtonTooltip}\x3c/button\x3e\r\n  \x3cdiv class\x3d"esriMultidimensionalFilterSelectorDiv"\x3e\x3cspan data-dojo-attach-point\x3d"DateSelector"\x3e\x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"TimeSelector"\x3e\x3c/span\x3e\x3c/div\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsNextButton\', showLabel: false" data-dojo-attach-point\x3d"NextBtn" data-dojo-attach-event\x3d"onClick:_onNextBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.nextButtonTooltip}\x3c/button\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsEndButton\', showLabel: false" data-dojo-attach-point\x3d"EndBtn" data-dojo-attach-event\x3d"onClick:_onEndBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.endDateButtonTooltip}\x3c/button\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/PagedNumberWidget.html": '\x3cdiv\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsStartButton\', showLabel: false" data-dojo-attach-point\x3d"StartBtn" data-dojo-attach-event\x3d"onClick:_onStartBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.startNumberButtonTooltip}\x3c/button\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsPrevButton\', showLabel: false" data-dojo-attach-point\x3d"PreviousBtn" data-dojo-attach-event\x3d"onClick:_onPreviousBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.previousButtonTooltip}\x3c/button\x3e\r\n  \x3cdiv class\x3d"esriMultidimensionalFilterSelectorDiv"\x3e\x3cspan data-dojo-attach-point\x3d"NumberSelector"\x3e\x3c/span\x3e\x3c/div\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsNextButton\', showLabel: false" data-dojo-attach-point\x3d"NextBtn" data-dojo-attach-event\x3d"onClick:_onNextBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.nextButtonTooltip}\x3c/button\x3e\r\n  \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'tsButton tsEndButton\', showLabel: false" data-dojo-attach-point\x3d"EndBtn" data-dojo-attach-event\x3d"onClick:_onEndBtnClick" type\x3d"button"\x3e${_i18n.widgets.multidimensionalFilter.endNumberButtonTooltip}\x3c/button\x3e\r\n\x3c/div\x3e',
"url:dojox/widget/Calendar/Calendar.html": '\x3cdiv class\x3d"dojoxCalendar"\x3e\r\n    \x3cdiv tabindex\x3d"0" class\x3d"dojoxCalendarContainer" style\x3d"visibility: visible;" dojoAttachPoint\x3d"container"\x3e\r\n\t\t\x3cdiv style\x3d"display:none"\x3e\r\n\t\t\t\x3cdiv dojoAttachPoint\x3d"previousYearLabelNode"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv dojoAttachPoint\x3d"nextYearLabelNode"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv dojoAttachPoint\x3d"monthLabelSpacer"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n        \x3cdiv class\x3d"dojoxCalendarHeader"\x3e\r\n            \x3cdiv\x3e\r\n                \x3cdiv class\x3d"dojoxCalendarDecrease" dojoAttachPoint\x3d"decrementMonth"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d""\x3e\r\n                \x3cdiv class\x3d"dojoxCalendarIncrease" dojoAttachPoint\x3d"incrementMonth"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"dojoxCalendarTitle" dojoAttachPoint\x3d"header" dojoAttachEvent\x3d"onclick: onHeaderClick"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dojoxCalendarBody" dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d""\x3e\r\n            \x3cdiv class\x3d"dojoxCalendarFooter" dojoAttachPoint\x3d"footer"\x3e                        \r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/Calendar/CalendarYear.html": '\x3cdiv class\x3d"dojoxCalendarYearLabels" style\x3d"left: 0px;" dojoAttachPoint\x3d"yearContainer"\x3e\r\n    \x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" style\x3d"margin: auto;" dojoAttachEvent\x3d"onclick: onClick"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr class\x3d"dojoxCalendarYearGroupTemplate"\x3e\r\n                \x3ctd class\x3d"dojoxCalendarNextMonth dojoxCalendarYearTemplate"\x3e\r\n                    \x3cdiv class\x3d"dojoxCalendarYearLabel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/Calendar/CalendarMonthYear.html": '\x3cdiv class\x3d"dojoxCal-MY-labels" style\x3d"left: 0px;"\t\r\n\tdojoAttachPoint\x3d"myContainer" dojoAttachEvent\x3d"onclick: onClick"\x3e\r\n\t\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" style\x3d"margin: auto;"\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\x3ctr class\x3d"dojoxCal-MY-G-Template"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd class\x3d"dojoxCal-MY-M-Template"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxCalendarMonthLabel"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd class\x3d"dojoxCal-MY-M-Template"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxCalendarMonthLabel"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd class\x3d"dojoxCal-MY-Y-Template"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxCalendarYearLabel"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd class\x3d"dojoxCal-MY-Y-Template"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxCalendarYearLabel"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t \x3c/tr\x3e\r\n\t\t\t\t\t\t \x3ctr class\x3d"dojoxCal-MY-btns"\x3e\r\n\t\t\t\t\t\t \t \x3ctd class\x3d"dojoxCal-MY-btns" colspan\x3d"4"\x3e\r\n\t\t\t\t\t\t \t\t \x3cspan class\x3d"dijitReset dijitInline dijitButtonNode ok-btn" dojoAttachEvent\x3d"onclick: onOk" dojoAttachPoint\x3d"okBtn"\x3e\r\n\t\t\t\t\t\t \t \t \t \x3cbutton\tclass\x3d"dijitReset dijitStretch dijitButtonContents"\x3eOK\x3c/button\x3e\r\n\t\t\t\t\t\t\t\t \x3c/span\x3e\r\n\t\t\t\t\t\t\t\t \x3cspan class\x3d"dijitReset dijitInline dijitButtonNode cancel-btn" dojoAttachEvent\x3d"onclick: onCancel" dojoAttachPoint\x3d"cancelBtn"\x3e\r\n\t\t\t\t\t\t \t \t\t \x3cbutton\tclass\x3d"dijitReset dijitStretch dijitButtonContents"\x3eCancel\x3c/button\x3e\r\n\t\t\t\t\t\t\t\t \x3c/span\x3e\r\n\t\t\t\t\t\t \t \x3c/td\x3e\r\n\t\t\t\t\t\t \x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/Calendar/CalendarMonth.html": '\x3cdiv class\x3d"dojoxCalendarMonthLabels" style\x3d"left: 0px;"  \r\n\tdojoAttachPoint\x3d"monthContainer" dojoAttachEvent\x3d"onclick: onClick"\x3e\r\n    \x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" style\x3d"margin: auto;"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr class\x3d"dojoxCalendarMonthGroupTemplate"\x3e\r\n                \x3ctd class\x3d"dojoxCalendarMonthTemplate"\x3e\r\n                    \x3cdiv class\x3d"dojoxCalendarMonthLabel"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n             \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/Calendar/CalendarDay.html": '\x3cdiv class\x3d"dijitCalendarDayLabels" style\x3d"left: 0px;" dojoAttachPoint\x3d"dayContainer"\x3e\r\n\t\x3cdiv dojoAttachPoint\x3d"header"\x3e\r\n\t\t\x3cdiv dojoAttachPoint\x3d"monthAndYearHeader"\x3e\r\n\t\t\t\x3cspan dojoAttachPoint\x3d"monthLabelNode" class\x3d"dojoxCalendarMonthLabelNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan dojoAttachPoint\x3d"headerComma" class\x3d"dojoxCalendarComma"\x3e,\x3c/span\x3e\r\n\t\t\t\x3cspan dojoAttachPoint\x3d"yearLabelNode" class\x3d"dojoxCalendarDayYearLabel"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" style\x3d"margin: auto;"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"dijitCalendarDayLabelTemplate"\x3e\x3cdiv class\x3d"dijitCalendarDayLabel"\x3e\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody dojoAttachEvent\x3d"onclick: _onDayClick"\x3e\r\n\t\t\t\x3ctr class\x3d"dijitCalendarWeekTemplate"\x3e\r\n\t\t\t\t\x3ctd class\x3d"dojoxCalendarNextMonth dijitCalendarDateTemplate"\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"dijitCalendarDateLabel"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/ImageFilter/templates/ImageFilter.html": '\x3cdiv class\x3d"esriImageFilterSliderHorizontal"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"esriImageFilterCardsDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"layerInfo" class\x3d"esriImageFilterSliderInfo"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TitlePane" data-dojo-attach-point\x3d"attributeCard" class\x3d"esriImageFilterCards" toggleable\x3d"false"\r\n            data-dojo-props\x3d"title: \'${_i18n.attributeCard}\'"\x3e\r\n            \x3ctable class\x3d"esriImageFilterSliderTableHorizontal" data-dojo-attach-point\x3d"ifSliderTable"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cimg class\x3d"loadingImageFilter" data-dojo-attach-point\x3d"_loadingImageFilter" src\x3d"../js/jsapi/esri/dijit/images/loading-throb.gif"\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd class\x3d"esriImageFilterFieldSelectBox"\x3e\r\n                        \x3cdiv class\x3d"esriImageFilterSettingsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"fieldSelect" data-dojo-props\x3d"labelAttr: \'alias\'"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd class\x3d"esriImageFilterSliderSelectIcons"\x3e\r\n                        \x3cspan data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'esriImageFilterIcons esriImageFilterSettings\'" data-dojo-attach-event\x3d"onClick: _openSettings"\r\n                            title\x3d"${_i18n.settingsButton}" data-dojo-attach-point\x3d"settingsButton" class\x3d"esriImageFilterButton"\x3e\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cdiv class\x3d"esriImageFilterfieldInfo" data-dojo-attach-point\x3d"_fieldInfo"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd colspan\x3d"2" class\x3d"esriImageFilterSliderCellHorizontal" data-dojo-attach-point\x3d"_ifSliderCell"\x3e\x3c/td\x3e\r\n                    \x3ctd class\x3d"esriImageFilterDefineRange"\x3e\r\n                        \x3cspan data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'esriImageFilterIcons esriImageFilterSingleButton\'"\r\n                            data-dojo-attach-event\x3d"onClick: _setUseRangesAttr" title\x3d"${_i18n.singleValue}" data-dojo-attach-point\x3d"defineRangeButton"\r\n                            class\x3d"esriImageFilterButton"\x3e\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TitlePane" data-dojo-attach-point\x3d"resultTitle" class\x3d"esriImageFilterResultCard" toggleable\x3d"false"\r\n        data-dojo-props\x3d"title: \'${_i18n.resultTiltle}\'"\x3e\r\n        \x3ctable class\x3d"esriImageFilterResultTable"\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"selectRasterInfo" class\x3d"esriImageFilterSelectRasterInfo"\x3e \x3c/div\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd colspan\x3d"2" class\x3d"esriImageFilterResultPanelOptions"\x3e\r\n                    \x3cspan data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'esriImageFilterIcons esriImageFilterZoomToButton\'"\r\n                        data-dojo-attach-event\x3d"onClick: _setMapExtent" title\x3d"${_i18n.extentLink}" data-dojo-attach-point\x3d"zoomTo"\r\n                        class\x3d"esriImageFilterButton"\x3e\x3c/span\x3e\r\n\r\n                    \x3cspan data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'esriImageFilterIcons esriImageFilterDscSortIcon\'" data-dojo-attach-event\x3d"onClick: _sortRasters"\r\n                        title\x3d"${_i18n.sortDsc}" data-dojo-attach-point\x3d"sortRasters" class\x3d"esriImageFilterButton"\x3e\x3c/span\x3e\r\n\r\n                    \x3cspan class\x3d"esriImageFilterButton"\x3e\r\n                        \x3cdiv data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-event\x3d"onClick: _handleSelectAll" data-dojo-attach-point\x3d"selectAllRasters"\r\n                            title\x3d"${_i18n.selectAll}" class\x3d"esriImageFilterSelectAllButton"\x3e \x3c/div\x3e\r\n                    \x3c/span\x3e\r\n\r\n                    \x3cspan data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'esriImageFilterIcons esriImageFilterFieldOptions\'"\r\n                        data-dojo-attach-event\x3d"onClick: _openShowFields" title\x3d"${_i18n.resultSettingToolTip}" data-dojo-attach-point\x3d"showFieldsButton"\r\n                        class\x3d"esriImageFilterButton"\x3e\x3c/span\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd colspan\x3d"3"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"esriImageFilterImageGridDiv"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"rasterListDiv"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"esriImageFilterAddToMapDiv" class\x3d"esriImageFilterAddToMap"\x3e\r\n            \x3cbutton class\x3d"calcite blue" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-point\x3d"_addToMapButton" data-dojo-attach-event\x3d"onClick: _addToMap"\x3e${_i18n.addToMap}\r\n            \x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/ImageFilter/templates/ImageFilterSettingsDialog.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"esriImageFilterSettingsDialog" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${_i18n.formatFields}"\x3e\r\n    \x3ctable class\x3d"esriImageFilterSettingsContainerTable"\x3e\r\n      \x3ctr\x3e \r\n        \x3ctd\x3e\r\n          \x3cfieldset class\x3d"esriImageFilterFieldFormat"\x3e\r\n\r\n            \x3cdiv class\x3d"format formatNumber"\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_formatNumberSelect" class\x3d"esriImageFilterFieldFormatSelect formatNumber formatter format" data-dojo-type\x3d"dijit.form.Select"\x3e\r\n                \x3coption value\x3d\'0\' selected\x3d"selected"\x3e0 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'1\'\x3e1 ${_i18n.decimalPlace}\x3c/option\x3e\r\n                \x3coption value\x3d\'2\'\x3e2 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'3\'\x3e3 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'4\'\x3e4 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'5\'\x3e5 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'6\'\x3e6 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'7\'\x3e7 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n                \x3coption value\x3d\'8\'\x3e8 ${_i18n.decimalPlaces}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n              \x3cbr /\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"formatNumber formatter formatInteger format"\x3e\r\n              \x3clabel class\x3d"checkbox"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"_formatNumberCheck" data-dojo-type\x3d"dijit.form.CheckBox" /\x3e\x26nbsp;${_i18n.separator}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriImageFilterFormatDate format"\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_formatDateSelect" class\x3d"esriImageFilterFieldFormatSelect formatter" data-dojo-type\x3d"dijit.form.Select"\x3e\r\n                \x3coption value\x3d"shortDate" selected\x3d"selected"\x3e12/21/1997\x3c/option\x3e\r\n                \x3coption value\x3d"shortDateLE" selected\x3d"selected"\x3e21/12/1997\x3c/option\x3e\r\n                \x3coption value\x3d"longMonthDayYear"\x3eDecember 21, 1997\x3c/option\x3e\r\n                \x3coption value\x3d"dayShortMonthYear"\x3e21 Dec 1997\x3c/option\x3e\r\n                \x3coption value\x3d"longDate"\x3eSunday, December 21, 1997\x3c/option\x3e\r\n                \x3coption value\x3d"longMonthYear"\x3eDecember 1997\x3c/option\x3e\r\n                \x3coption value\x3d"shortMonthYear"\x3eDec 1997\x3c/option\x3e\r\n                \x3coption value\x3d"year"\x3e1997\x3c/option\x3e\r\n              \x3c/select\x3e\r\n              \x3cdiv class\x3d"formatTime hide"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"timeCheckboxLbl" class\x3d"timeCheckbox disabled"\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"_formatTimeCheck" data-dojo-type\x3d"dijit.form.CheckBox" /\x3e\x26nbsp;${_i18n.showTime}\x3c/label\x3e\r\n                \x3cbr /\x3e\r\n                \x3cselect data-dojo-attach-point\x3d"_formatTimeSelect" class\x3d"esriImageFilterFieldFormatSelect formatter hide" data-dojo-type\x3d"dijit.form.Select"\x3e\r\n                  \x3coption value\x3d"ShortTime" selected\x3d"selected"\x3e6:00 PM\x3c/option\x3e\r\n                  \x3coption value\x3d"LongTime"\x3e6:00:00 PM\x3c/option\x3e\r\n                  \x3coption value\x3d"ShortTime24"\x3e18:00\x3c/option\x3e\r\n                  \x3coption value\x3d"LongTime24"\x3e18:00:00\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/fieldset\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv class\x3d"esriImageFilterConfirm"\x3e\r\n      \x3cbutton class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_handleOKButtonClick"\x3e${_i18n.ok}\x3c/button\x3e\r\n      \x3cbutton class\x3d"jevent cancel" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:hide"\x3e${_i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/map/dijit/templates/Clustering.html": '\x3cdiv dojoType\x3d"dijit.layout.BorderContainer" region\x3d"top"\x3e\r\n  \r\n  \x3cdiv id\x3d"clusteringContentHeader" class\x3d"panel panel_left" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"display:none;"\x3e\r\n    \x3cdiv id\x3d"clusteringHeaderButtons" class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n      \x3ca href\x3d"JavaScript:void(0);" dojoAttachPoint\x3d"_closeBtn" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"clusteringContentTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n      ${i18n.clusteringPanelTitle}\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_clusteringLayerName" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; border-bottom: #aeaeae thin solid; height:1px;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3cdiv id\x3d"clusteringContentPane" dojoType\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-x:hidden;overflow-y:auto;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.layout.ContentPane" region\x3d"center" id\x3d"clusteringPane" style\x3d"overflow-y:auto;"\x3e\r\n      \x3cdiv style\x3d"padding: 10px 0;"\x3e\r\n        \x3cinput dojoAttachPoint\x3d"_clusteringCheck" dojotype\x3d"dijit.form.CheckBox"  dojoAttachEvent\x3d"onChange:_onChangeClusteringCheck" value\x3d"on" type\x3d"checkbox" /\x3e\r\n        \x3clabel\x3e\r\n          ${i18n.enableClustering}\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"clusteringOptions" class\x3d"esriLeadingMargin1"\x3e\r\n      \x3cdiv style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv id\x3d"clusteringSliderDiv" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"clusteringSliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding: 6px 5px 20px; white-space:nowrap;"\x3e\r\n            \x3cdiv id\x3d"clusteringSlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both;padding-top:10px;"\x3e\r\n        \x3cdiv id\x3d"clusteringPopupDiv" style\x3d"clear:both;"\x3e\r\n          \x3cspan class\x3d"esriItemLinks"\x3e\r\n            \x3ca dojoAttachPoint\x3d"_clusteringPopupLink" href\x3d"JavaScript:void(0);" dojoAttachEvent\x3d"onClick:_onClickPopup"\x3e\x3c/a\x3e\r\n          \x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"tooManyFeaturesDiv" style\x3d"clear:both;padding-top:30px;display:none;"\x3e\r\n        \x3cspan\x3e\r\n          ${i18n.tooManyFeaturesMsg}\r\n        \x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv id\x3d"clusteringContentBottom" dojoType\x3d"dijit.layout.BorderContainer" region\x3d"bottom" gutters\x3d"false" design\x3d"headline" style\x3d"height:80px;padding:0; margin:0px;"\x3e\r\n\r\n    \x3cdiv id\x3d"clusteringContentButtons" dojoType\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"padding:9px 5px 1px 5px;margin-top:5px;"\x3e\r\n      \x3cdiv id\x3d"clusteringContentButtonsCenter" align\x3d"center"\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" class\x3d"calcite blue" type\x3d"button" dojoAttachEvent\x3d"onClick:_onOK" dojoAttachPoint\x3d"_okButton"\x3e\r\n          \x3cspan\x3e${i18n.ok}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" class\x3d"calcite transparent" type\x3d"button" dojoAttachEvent\x3d"onClick:_onCancel"\x3e\r\n          \x3cspan\x3e${i18n.cancel}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv id\x3d"clusteringContentFooter" dojoType\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"padding: 0 5px 0 5px; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"clusteringSiteFooter" dojotype\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/TemplatePicker.html": '\x3cdiv class\x3d"templatePicker"\x3e\r\n\r\n  \x3ctable dojoType\x3d"dojox.grid.DataGrid" noDataMessage\x3d"${emptyMessage}" selectionMode\x3d"none" autoHeight\x3d"${_rows}" autoWidth\x3d"${_autoWidth}"\r\n         query\x3d"{ query: \'*\' }" dojoAttachPoint\x3d"grid" class\x3d"grid"\x3e\r\n  \x3c/table\x3e\r\n  \r\n\x3c/div\x3e', "url:esri/dijit/SymbolStyler/templates/MarkerSymbolPicker.html": '\x3cdiv\x3e\r\n  \x3cdiv id\x3d"${id}_typeInput" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"dap_markerCategoryInput" class\x3d"${css.typeInput}"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.container}" data-dojo-attach-point\x3d"dap_symbolViewport"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_templatePicker"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/SymbolStyler/templates/SymbolStyler.html": '\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"${css.symbolPreviewContainer}"\x3e\r\n    \x3cdiv class\x3d"${css.symbolPreview}" data-dojo-attach-point\x3d"dap_symbolPreview"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/StackController" class\x3d"${css.tabBar}" data-dojo-props\x3d"containerId:\'${id}_stackContainer\'" data-dojo-attach-point\x3d"dap_stackController"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/StackContainer" id\x3d"${id}_stackContainer" data-dojo-attach-point\x3d"dap_stackContainer" data-dojo-props\x3d"doLayout: false" class\x3d"${css.content}"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.shape}" data-dojo-attach-point\x3d"dap_shapeContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_symbolPicker"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_useImageContent"\x3e\r\n        \x3cdiv class\x3d"${css.link}" data-dojo-attach-point\x3d"dap_addImage" tabindex\x3d"0"\x3e${labels.useImage}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_shapeImageUrlContainer" class\x3d"${css.shapeImageUrlContainer}"\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_shapeImageUrlInput" class\x3d"${css.urlInput} dijitInline"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"dap_loadShapeImageUrl" class\x3d"dijitInline ${css.addIcon}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"dap_shapeImageUrlErrorDisplay" class\x3d"${css.errorDisplay}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_shapeSizeLabel" class\x3d"${css.label}"\x3e${labels.symbolSize}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.symbolSizeInput} ${css.inlineInput}" data-dojo-attach-point\x3d"dap_symbolSizeOptions"\x3e\r\n        \x3cdiv data-dojo-type\x3d"esri/dijit/HorizontalSlider" data-dojo-attach-point\x3d"dap_shapeSizeSlider"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/NumberSpinner"  data-dojo-attach-point\x3d"dap_shapeSizeTextBox"\x3e\x3c/div\x3e\r\n        \x3cspan class\x3d"${css.text}"\x3e${labels.px}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.fill}" data-dojo-attach-point\x3d"dap_fillContainer"\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/dijit/ColorPicker" data-dojo-attach-point\x3d"dap_fillColorPicker" data-dojo-props\x3d"showSuggestedColors: true"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/dijit/SymbolStyler/ColorRampPicker" data-dojo-attach-point\x3d"dap_fillColorRampPicker" class\x3d"${css.hidden}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.outline}" data-dojo-attach-point\x3d"dap_outlineContainer"\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/dijit/ColorPicker" data-dojo-attach-point\x3d"dap_outlineColorPicker" data-dojo-props\x3d"showSuggestedColors: true"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/dijit/SymbolStyler/ColorRampPicker" data-dojo-attach-point\x3d"dap_outlineColorRampPicker" class\x3d"${css.hidden}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_lineWidthLabel" class\x3d"${css.label}"\x3e${labels.lineWidth}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.lineWidthInput} ${css.inlineInput}" data-dojo-attach-point\x3d"dap_lineWidthOptions"\x3e\r\n        \x3cdiv data-dojo-type\x3d"esri/dijit/HorizontalSlider" data-dojo-attach-point\x3d"dap_lineWidthSlider"\x3e\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"dap_lineWidthTextBox"\x3e\x3c!--values added dynamically--\x3e\x3c/select\x3e\r\n        \x3cspan class\x3d"${css.text}"\x3e${labels.px}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.label}" data-dojo-attach-point\x3d"dap_linePatternSelectLabel"\x3e${labels.pattern}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_linePatternSelect"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.label}" data-dojo-attach-point\x3d"dap_arrowPatternSelectLabel"\x3e${labels.arrow}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_arrowPatternSelect"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/SymbolStyler/templates/ColorRampPicker.html": '\x3cdiv\x3e\r\n  \x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.container}"\x3e\r\n    \x3cdiv class\x3d"${css.preview} ${css.item}"\r\n         data-dojo-attach-point\x3d"dap_previewRamp"\x3e\x3c/div\x3e\r\n    \x3cinput class\x3d"${css.flipper}" type\x3d"button" data-dojo-attach-point\x3d"dap_colorFlipper" /\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.container}"\x3e\r\n    \x3cdiv class\x3d"${css.viewport}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_colorRampPicker"\r\n           class\x3d"${css.list}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.container} ${css.transparencySection}" data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel" class\x3d"${css.label}"\x3e${labels.transparency}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_transparencySlider"\r\n         data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n         data-dojo-props\x3d"intermediateChanges: true, minimum: 0, maximum: 1, discreteValues: 100, labels: ${_transparencyLabels}"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:arcgisonline/map/dijit/renderer/templates/SymbolStylerDlg.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv id\x3d"symbolStylerDiv"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriFloatTrailing" style\x3d"margin:10px 0;"\x3e\r\n    \x3cbutton type\x3d"button" data-dojo-attach-point\x3d"_okBtn" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_onOK" class\x3d"calcite primary"\x3e${i18n.ok}\x3c/button\x3e\r\n    \x3cbutton type\x3d"button" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_onCancel" class\x3d"calcite cancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/RendererSlider/templates/RendererSlider.html": '\x3cdiv class\x3d"${_css.container}" data-dojo-attach-point\x3d"_containerNode"\x3e\r\n  \x3cdiv class\x3d"${_css.topLabelNode} ${_css.topLabelNodeHover}" data-dojo-attach-point\x3d"_topNode"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"_topNodeSpan"\x3e\x3c/span\x3e \r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${_css.slidernode}" data-dojo-attach-point\x3d"_sliderNode"\x3e\r\n    \x3cdiv class\x3d"${_css.sliderarea}" data-dojo-attach-point\x3d"_sliderArea"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.sliderarearight}" data-dojo-attach-point\x3d"_sliderAreaRight"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${_css.bottomLabelNode} ${_css.bottomLabelNodeHover}" data-dojo-attach-point\x3d"_botNode"\x3e\r\n    \x3cspan  data-dojo-attach-point\x3d"_bottomNodeSpan"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/OpacitySlider/templates/OpacitySlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:arcgisonline/map/dijit/renderer/templates/AttributeTransparency.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%; padding:5px;"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" id\x3d"AttributeTransparencyContent" region\x3d"center" style\x3d"overflow-y:auto;padding:2px;"\x3e\r\n    \x3cdiv id\x3d"AttributeTransparencyMsg" style\x3d"padding-bottom:10px;"\x3e${i18n.attributeTransparencyMsg}\x3c/div\x3e\r\n    \x3cdiv id\x3d"AttributeTransparencyFields"\x3e\r\n      \x3ctable style\x3d"width:100%;"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv\x3e\r\n                \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                ${i18n.field}\x26nbsp;\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"_rendererAttributeTransparencyAttribute" data-dojo-attach-event\x3d"onChange:_onChangeAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                    \x3c/select\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencEditExpression" class\x3d"editRendererIcon" style\x3d"margin: 0 5px;"\x3e\x3c/div\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr id\x3d"AttributeTransparencyDividedBy" class\x3d"AttributeTransparencyToggle"\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv\x3e\r\n                \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                ${i18n.dividedBy}\x26nbsp;\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"_rendererAttributeTransparencyDividedByAttribute" data-dojo-attach-event\x3d"onChange:_onChangeDividedByAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                    \x3c/select\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyDividedByFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3ctable style\x3d"width:100%;height:291px;" class\x3d"AttributeTransparencyToggle"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd height\x3d"221" width\x3d"100%"\x3e\r\n            \x3cdiv id\x3d"rendererAttributeTransparencySliderDiv"\x3e\r\n              \x3cdiv id\x3d"rendererAttributeTransparencySlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD" style\x3d"text-align:center; vertical-align:top; padding-top:20px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyZoomTitle" data-dojo-attach-event\x3d"onClick:_onClickZoom" class\x3d"rightIcons" style\x3d"padding-top: 15px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyZoomIcon" class\x3d"zoomIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyZoomLabel" class\x3d"toolsLabel" style\x3d"overflow: hidden;text-overflow: ellipsis;max-width: 100px;"\x3e${i18n.zoomIn}\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_estimatedValuesMsg" class\x3d"small estimateMsg" style\x3d"display: none;"\x3e\r\n      ${i18n.estimatedValuesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_zeroFeaturesMsg" class\x3d"small zeroFeaturesMsg" style\x3d"display: none;"\x3e\r\n      ${i18n.zeroFeaturesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyLegend" style\x3d"clear:both;margin-top:10px;" class\x3d"AttributeTransparencyToggle"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererAttributeTransparencyLegendCheck" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyLegendText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.showInLegend}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyTransparency" style\x3d"clear:both;margin-top:10px;" class\x3d"AttributeTransparencyToggle"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeTransparencyTransparencyTitle" class\x3d"sectionTitle" \x3e\r\n        ${i18n.transparencyRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; padding: 10px 10px 0 10px;"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd nowrap\x3e\r\n                \x3cspan\x3e${i18n.highValues}\x3c/span\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"_rendererAttributeTransparencyMin" data-dojo-attach-event\x3d"onChange:_onChangeMin" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"30" smallDelta\x3d"5" constraints\x3d"{min:0,max:100,places:0}" style\x3d"width:40px; margin: 0 2px;" /\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cspan\x3e%\x3c/span\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd nowrap\x3e\r\n                \x3cspan\x3e${i18n.lowValues}\x3c/span\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"_rendererAttributeTransparencyMax" data-dojo-attach-event\x3d"onChange:_onChangeMax" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"70" smallDelta\x3d"5" constraints\x3d"{min:0,max:100,places:0}" style\x3d"width:40px; margin: 0 2px;" /\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cspan\x3e%\x3c/span\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"padding-top:10px;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onOK"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_cancelButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/UniqueValues.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv id\x3d"renderer-unique-main" class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"padding:7px;"\x3e\r\n    \x3cdiv id\x3d"rendererUniqueHeader" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"top"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererUniqueTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueLayer" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\x3c!--border-bottom: #333 thin solid;--\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_rendererUniqueTop" region\x3d"center" style\x3d"padding:10px 0;overflow-y:auto;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueField" class\x3d"esriFloatLeading strong" style\x3d"margin-top: 2px;"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererUniqueChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y:auto;"\x3e\r\n      \x3cdiv id\x3d"uniqueValuesGriText" style\x3d"margin-bottom: 3px;"\x3e\r\n        \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"uniqueValuesGridDiv" style\x3d"clear:both;"\x3e\r\n        \x3cdiv id\x3d"uniqueValuesGrid"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_estimatedValuesMsg" class\x3d"small estimateMsg"\x3e\r\n        ${i18n.estimatedValuesMsg}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-unique-bottom" class\x3d"panel panel_left esriTrailingMargin09px" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y: auto; padding:7px; margin-top:5px;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotation" class\x3d"esriFloatLeading" style\x3d"clear:both;"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_rendererUniqueRotationTitle"\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererUniqueRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotationText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotationContent" class\x3d"esriFloatLeading esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererUniqueRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererUniqueRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseUnique"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererUniqueRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseUnique"/\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                ${i18n.arithmetic}\r\n              \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:15px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueTransparency" style\x3d"clear:both;position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 5px 10px 0 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererUniqueHasAttributeTransparency" \x3e\r\n          ${i18n.overallTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rendererUniqueTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"rendererUniqueTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding:6px 0 20px;"\x3e\r\n            \x3cdiv id\x3d"rendererUniqueTransparencySlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererUniqueHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n          ${i18n.perFeaturesTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererUniqueHasAttributeTransparency esriLeadingPadding1"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererUniqueAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n          \x3cA data-dojo-attach-point\x3d"_rendererUniqueAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererUniqueAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueScale" style\x3d"clear:both; padding-top:20px;position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueScaleTitle"  class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererUniqueScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererUniqueScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererUniqueContentClose" style\x3d"margin-top:10px"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererUniqueFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererUniqueFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/ColorInfoSlider/templates/ColorInfoSlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:esri/dijit/ClassedColorSlider/templates/ClassedColorSlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/map/dijit/renderer/templates/Color.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%; padding:5px;"\x3e\r\n  \x3cdiv id\x3d"rendererColorTop" data-dojo-type\x3d"dijit.layout.ContentPane" class\x3d"panel panel_left" region\x3d"top" style\x3d"padding:2px;"\x3e\r\n    \x3cdiv id\x3d"rendererColorHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererColorTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorLayer" class\x3d"panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin: 2px 0 20px 0; padding:10px 0;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-color-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-y:auto;padding:2px;"\x3e\r\n    \x3ctable\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr id\x3d"rendererAgeColorTopFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd rowspan\x3d"2" style\x3d"width: 20px;vertical-align: middle;" align\x3d"right" valign\x3d"top"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererAgeColorSwitch" data-dojo-attach-event\x3d"onClick:_onClickSwitch" class\x3d"switchAttributeIcon esriFloatTrailing rendererClickable" style\x3d"margin: 0 8px 0 0; cursor: pointer;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv style\x3d"height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.from}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeColorTopField" style\x3d"height:20px;margin-top:5px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeColorMiddleFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd id\x3d"rendererAgeColorSwitch2" rowspan\x3d"2" align\x3d"right" valign\x3d"top" style\x3d"width: 20px; vertical-align: middle; display:none;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererAgeColorSwitch2" data-dojo-attach-event\x3d"onClick:_onClickSwitch2" class\x3d"switchAttributeIcon esriFloatTrailing rendererClickable" style\x3d"margin: 0 8px 0 0; cursor: pointer;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3cdiv id\x3d"rendererAgeColorMiddleFieldsFromLabel" style\x3d"display:none;height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.from}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv  id\x3d"rendererAgeColorMiddleFieldsToLabel"style\x3d"display:none;height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.to}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeColorFieldsSelect" style\x3d"display:none;"\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_rendererAgeColorFieldSelect" data-dojo-attach-event\x3d"onChange:_onChangeFieldSelect" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n              \x3c/select\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv id\x3d"rendererAgeColorFieldsFixedDateTime" style\x3d"display:none; margin-top:2px;"\x3e\r\n              \x3cdiv id\x3d"rendererAgeColorFieldsFixedDate" class\x3d"esriFloatLeading esriTrailingMargin025"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_rendererAgeColorFixedDate" data-dojo-attach-event\x3d"onChange:_onChangeFixedDate" style\x3d"width:110px;" type\x3d"text" value\x3d"2005-12-30" dojoType\x3d"dijit.form.DateTextBox" /\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"rendererAgeColorFieldsFixedTime" class\x3d"esriFloatLeading" style\x3d"display:none;"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_rendererAgeColorFixedTime" data-dojo-attach-event\x3d"onChange:_onChangeFixedTime" style\x3d"width:90px;" type\x3d"text" value\x3d"T15:00:00" dojoType\x3d"dijit.form.TimeTextBox" /\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeColorBottomFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv style\x3d"height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.to}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeColorBottomField" style\x3d"height:20px;margin-top:5px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeColorUnits" style\x3d"display:none;"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n              ${i18n.units}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererAgeColorUnits" data-dojo-attach-event\x3d"onChange:_onChangeUnits" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n              \x3coption value\x3d"seconds"\x3e${i18n.seconds}\x3c/option\x3e\r\n              \x3coption value\x3d"minutes"\x3e${i18n.minutes}\x3c/option\x3e\r\n              \x3coption value\x3d"hours"\x3e${i18n.hours}\x3c/option\x3e\r\n              \x3coption value\x3d"days"\x3e${i18n.days}\x3c/option\x3e\r\n              \x3coption value\x3d"months"\x3e${i18n.months}\x3c/option\x3e\r\n              \x3coption value\x3d"years"\x3e${i18n.years}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererColorDividedBy"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n              ${i18n.dividedBy}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererColorDividedBySelect"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"_rendererColorDividedByAttribute" data-dojo-attach-event\x3d"onChange:_onChangeDividedByAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererColorDividedByFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererColorTheme"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n              ${i18n.theme}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererColorThemeSelect"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorTheme" data-dojo-type\x3d"dijit.form.FilteringSelect" id\x3d"rendererColorThemeDropdown" data-dojo-attach-event\x3d"onChange:_onChangeColorTheme" class\x3d"dijitComboBoxNonEditable" sortByLabel\x3d"false"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd height\x3d"271"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorSliderDiv"\x3e\r\n              \x3cdiv id\x3d"rendererColorSlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorGridDiv" style\x3d"padding-top: 10px;"\x3e\r\n              \x3cdiv style\x3d"margin-bottom: 3px;"\x3e\r\n                \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererColorGridContainer" class\x3d"rendererColorGridContainer" style\x3d"overflow-y: auto;overflow-x: none;"\x3e\r\n                \x3cdiv id\x3d"rendererColorGrid"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD" style\x3d"text-align:center; vertical-align:top; padding-top:20px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorSymbolsTitle" data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererColorSymbols" class\x3d"symbolIconClassed"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorInvertTitle" data-dojo-attach-event\x3d"onClick:_onClickInvert" class\x3d"rightIcons" style\x3d"padding-top: 15px; display:none;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererColorInvertIcon" class\x3d"invertIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererColorInvertLabel" class\x3d"toolsLabel"\x3e${i18n.invert}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorLegendClassesTitle" data-dojo-attach-event\x3d"onClick:_onClickLegendClasses" class\x3d"rightIcons" style\x3d"padding-top: 15px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererColorLegendClassesIcon" class\x3d"legendClassesIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererColorLegendClassesText" class\x3d"toolsLabel"\x3e${i18n.legend}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorPolygonsTitle" data-dojo-attach-event\x3d"onClick:_onClickPolygons" class\x3d"rightIcons" style\x3d"padding-top: 15px; display:none;"\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererColorPolygonSymbol" style\x3d"padding:5px 0;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.polygons}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererColorZoomTitle" data-dojo-attach-event\x3d"onClick:_onClickZoom" class\x3d"rightIcons" style\x3d"padding-top: 15px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererColorZoomIcon" class\x3d"zoomIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererColorZoomLabel" class\x3d"toolsLabel"\x3e${i18n.zoomIn}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_estimatedValuesMsg" class\x3d"small estimateMsg"\x3e\r\n      ${i18n.estimatedValuesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_zeroFeaturesMsg" class\x3d"small zeroFeaturesMsg"\x3e\r\n      ${i18n.zeroFeaturesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassify" class\x3d"rendererColorClassify" style\x3d"clear:both;margin-top:20px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyCheckDiv"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_rendererColorClassifyCheck" data-dojo-attach-event\x3d"onChange:_onChangeClassify" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.classifyData}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyMethodPart1"\x3e\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyMethods" data-dojo-type\x3d"dijit.form.FilteringSelect" id\x3d"rendererColorClassifyMethodDropdown" data-dojo-attach-event\x3d"onChange:_onChangeClassifyMethod" class\x3d"dijitComboBoxNonEditable" sortByLabel\x3d"false"\x3e\r\n          \x3c/div\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyMethodPart2"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyClassesTitle" style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3ctable\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyClassesPart1"\x3e\x3c/span\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"_rendererColorClassifyClasses" data-dojo-attach-event\x3d"onChange:_onChangeClassifyClasses" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"4" smallDelta\x3d"1" constraints\x3d"{min:1,max:10,places:0}" style\x3d"width:40px; margin: 0 5px;"/\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd nowrap\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyClassesPart2"\x3e\x3c/span\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererColorClassifyStdDevIntervalTitle" style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyStdDevIntervalPart1"\x3e\x3c/span\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"_rendererColorClassifyStdDevInterval" data-dojo-attach-event\x3d"onChange:_onChangeClassifyStdDevInterval" data-dojo-type\x3d"dijit.form.Select" style\x3d"width:50px;"\x3e\r\n          \x3c/select\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorClassifyStdDevIntervalPart2"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"rendererColorPrecision" style\x3d"margin-top: 3px;"\x3e\r\n          \x3ctable\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_rendererColorPrecisionLabel"\x3e${i18n.roundClasses}\x3c/span\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"_rendererColorPrecision" data-dojo-attach-event\x3d"onChange:_onChangeColorPrecision" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false" style\x3d"margin: 0 10px;"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorOtherCheckMsg" \x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererColorOtherCheck" data-dojo-attach-event\x3d"onChange:_onChangeOther" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorOtherTxt" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.drawOthers}\r\n          \x3c/span\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorOther" class\x3d"esriLeadingMargin107" style\x3d"clear:both;"\x3e\r\n        \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorOtherSymbolText"\x3e\r\n            ${i18n.symbolLabel}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorOtherSymbol" style\x3d"padding: 0 5px;"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotation" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererColorRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotationText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotationContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererColorRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererColorRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseColor"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererColorRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseColor"/\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                ${i18n.arithmetic}\r\n              \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererColorRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererColorLegend" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererColorLegendCheck" data-dojo-attach-event\x3d"onChange:_onChangeLegend" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererColorLegendText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.showInLegend}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:15px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererColorTransparency" style\x3d"position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 5px 10px 20px 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererColorTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererColorHasAttributeTransparency" \x3e\r\n          ${i18n.overallTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rendererColorTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"rendererColorTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding: 6px 0 20px;"\x3e\r\n            \x3cdiv id\x3d"rendererColorTransparencySlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererColorTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererColorHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n          ${i18n.perFeaturesTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererColorHasAttributeTransparency esriLeadingPadding1"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n          \x3cA data-dojo-attach-point\x3d"_rendererColorAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererColorAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererColorScale" style\x3d"clear:both; position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorScaleTitle" class\x3d"esriFloatLeading sectionTitle"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererColorScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererColorScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom"\x3e\r\n\t\t\x3cdiv id\x3d"rendererColorContentClose" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" \x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"rendererColorFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"rendererColorFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/SizeInfoSlider/templates/SizeInfoSlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:esri/dijit/ClassedSizeSlider/templates/ClassedSizeSlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/map/dijit/renderer/templates/Size.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%; padding:5px;"\x3e\r\n  \x3cdiv id\x3d"rendererSizeTop" data-dojo-type\x3d"dijit.layout.ContentPane" class\x3d"panel panel_left" region\x3d"top" style\x3d"padding:2px;"\x3e\r\n    \x3cdiv id\x3d"rendererSizeHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererSizeTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeLayer" class\x3d"panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin: 2px 0 20px 0; padding:10px 0;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererSizeChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-size-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-y:auto;padding:2px;"\x3e\r\n    \x3ctable\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr id\x3d"rendererAgeSizeTopFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd rowspan\x3d"2" style\x3d"width: 20px;vertical-align: middle;" align\x3d"right" valign\x3d"top"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererAgeSizeSwitch" data-dojo-attach-event\x3d"onClick:_onClickSwitch" class\x3d"switchAttributeIcon esriFloatTrailing rendererClickable" style\x3d"margin: 0 8px 0 0; cursor: pointer;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv style\x3d"height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.from}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeSizeTopField" style\x3d"height:20px;margin-top:5px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeSizeMiddleFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd id\x3d"rendererAgeSizeSwitch2" rowspan\x3d"2" align\x3d"right" valign\x3d"top" style\x3d"width: 20px; vertical-align: middle; display:none;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererAgeSizeSwitch2" data-dojo-attach-event\x3d"onClick:_onClickSwitch2" class\x3d"switchAttributeIcon esriFloatTrailing rendererClickable" style\x3d"margin: 0 8px 0 0; cursor: pointer;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3cdiv id\x3d"rendererAgeSizeMiddleFieldsFromLabel" style\x3d"display:none;height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.from}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv  id\x3d"rendererAgeSizeMiddleFieldsToLabel"style\x3d"display:none;height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.to}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeSizeFieldsSelect" style\x3d"display:none;"\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_rendererAgeSizeFieldSelect" data-dojo-attach-event\x3d"onChange:_onChangeFieldSelect" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n              \x3c/select\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv id\x3d"rendererAgeSizeFieldsFixedDateTime" style\x3d"display:none; margin-top:2px;"\x3e\r\n              \x3cdiv id\x3d"rendererAgeSizeFieldsFixedDate" class\x3d"esriFloatLeading esriTrailingMargin025"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_rendererAgeSizeFixedDate" data-dojo-attach-event\x3d"onChange:_onChangeFixedDate" style\x3d"width:110px;" type\x3d"text" value\x3d"2005-12-30" dojoType\x3d"dijit.form.DateTextBox" /\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv id\x3d"rendererAgeSizeFieldsFixedTime" class\x3d"esriFloatLeading" style\x3d"display:none;"\x3e\r\n                \x3cinput dojoAttachPoint\x3d"_rendererAgeSizeFixedTime" data-dojo-attach-event\x3d"onChange:_onChangeFixedTime" style\x3d"width:90px;" type\x3d"text" value\x3d"T15:00:00" dojoType\x3d"dijit.form.TimeTextBox" /\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeSizeBottomFieldsSection" style\x3d"display:none;"\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv style\x3d"height:20px;margin-top:5px;"\x3e\r\n              \x3clabel class\x3d"firstColumnLabelAge" style\x3d"white-space: nowrap;"\x3e\r\n              ${i18n.to}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv id\x3d"rendererAgeSizeBottomField" style\x3d"height:20px;margin-top:5px;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererAgeSizeUnits" style\x3d"display:none;"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n              ${i18n.units}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererAgeSizeUnits" data-dojo-attach-event\x3d"onChange:_onChangeUnits" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n              \x3coption value\x3d"seconds"\x3e${i18n.seconds}\x3c/option\x3e\r\n              \x3coption value\x3d"minutes"\x3e${i18n.minutes}\x3c/option\x3e\r\n              \x3coption value\x3d"hours"\x3e${i18n.hours}\x3c/option\x3e\r\n              \x3coption value\x3d"days"\x3e${i18n.days}\x3c/option\x3e\r\n              \x3coption value\x3d"months"\x3e${i18n.months}\x3c/option\x3e\r\n              \x3coption value\x3d"years"\x3e${i18n.years}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererSizeDividedBy"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n              ${i18n.dividedBy}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererSizeDividedBySelect"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererSizeDividedByAttribute" data-dojo-attach-event\x3d"onChange:_onChangeDividedByAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeDividedByFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd height\x3d"271"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSliderDiv"\x3e\r\n              \x3cdiv id\x3d"rendererSizeSlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeGridDiv" style\x3d"padding-top: 10px;"\x3e\r\n              \x3cdiv style\x3d"margin-bottom: 3px;"\x3e\r\n                \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererSizeGridContainer" class\x3d"rendererSizeGridContainer" style\x3d"overflow-y: auto;overflow-x: none;"\x3e\r\n                \x3cdiv id\x3d"rendererSizeGrid"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD" style\x3d"text-align:center; vertical-align:top; padding-top:20px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSymbolsTitle" data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSymbol" style\x3d"padding:5px 0;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeInvertTitle" data-dojo-attach-event\x3d"onClick:_onClickInvert" class\x3d"rightIcons" style\x3d"padding-top: 20px; display:none;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererSizeInvertIcon" class\x3d"invertIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererSizeInvertLabel" class\x3d"toolsLabel"\x3e${i18n.invert}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeLegendClassesTitle" data-dojo-attach-event\x3d"onClick:_onClickLegendClasses" class\x3d"rightIcons" style\x3d"padding-top: 20px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererSizeLegendClassesIcon" class\x3d"legendClassesIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererSizeLegendClassesText" class\x3d"toolsLabel"\x3e${i18n.legend}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizePolygonsTitle" data-dojo-attach-event\x3d"onClick:_onClickPolygons" class\x3d"rightIcons" style\x3d"padding-top: 15px;"\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererSizePolygonSymbol" style\x3d"padding:5px 0;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.polygons}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSizeZoomTitle" data-dojo-attach-event\x3d"onClick:_onClickZoom" class\x3d"rightIcons" style\x3d"padding-top: 20px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererSizeZoomIcon" class\x3d"zoomIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererSizeZoomLabel" class\x3d"toolsLabel"\x3e${i18n.zoomIn}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_estimatedValuesMsg" class\x3d"small estimateMsg"\x3e\r\n      ${i18n.estimatedValuesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_zeroFeaturesMsg" class\x3d"small zeroFeaturesMsg"\x3e\r\n      ${i18n.zeroFeaturesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSymbolSize" class\x3d"rendererSizeSymbolSize" style\x3d"margin-top:20px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSymbolSizeTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.size}\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeSuggest" data-dojo-attach-event\x3d"onClick:_onClickSizeSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      --\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 5px 10px 17px 10px;"\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading sizingTypes" style\x3d"clear:both;margin-top:5px;"\x3e\r\n          \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSizeAutomaticRadio" data-dojo-attach-event\x3d"onChange:_onChangeSizing" name\x3d"sizing"/\x3e\r\n          ${i18n.automaticSizing}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading sizingTypes" style\x3d"clear:both; margin:7px 0 3px 0;"\x3e\r\n          \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSizeManualRadio" data-dojo-attach-event\x3d"onChange:_onChangeSizing" name\x3d"sizing"/\x3e\r\n          ${i18n.manualSizing}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;padding-top:5px;position:relative;" class\x3d"esriItemLinks sizingTypes2"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading esriTrailingMargin1" style\x3d"white-space: nowrap;"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"padding-bottom:3px;"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_rendererSizeMinPart1"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_rendererSizeMin" data-dojo-attach-event\x3d"onChange:_onChangeMin" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"4" smallDelta\x3d"1" constraints\x3d"{min:1,max:120,places:0}" style\x3d"width:40px; margin: 0 2px;" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd nowrap\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_rendererSizeMinPart2"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"white-space: nowrap;"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_rendererSizeMaxPart1"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_rendererSizeMax" data-dojo-attach-event\x3d"onChange:_onChangeMax" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"4" smallDelta\x3d"1" constraints\x3d"{min:1,max:120,places:0}" style\x3d"width:40px; margin: 0 2px;" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd nowrap\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_rendererSizeMaxPart2"\x3e\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassify" class\x3d"rendererSizeClassify" style\x3d"padding-top:3px; clear:both;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyCheckDiv"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_rendererSizeClassifyCheck" data-dojo-attach-event\x3d"onChange:_onChangeClassify" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyText"\x3e\r\n            \x26nbsp;${i18n.classifyData}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyContent" class\x3d"esriLeadingMargin107" style\x3d"margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyMethodPart1"\x3e\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyMethods" data-dojo-type\x3d"dijit.form.FilteringSelect" id\x3d"rendererSizeClassifyMethodDropdown" data-dojo-attach-event\x3d"onChange:_onChangeClassifyMethod" class\x3d"dijitComboBoxNonEditable" sortByLabel\x3d"false"\x3e\r\n          \x3c/div\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyMethodPart2"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyClassesTitle" style\x3d"margin-top:3px;"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyClassesPart1"\x3e\x3c/span\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererSizeClassifyClasses" data-dojo-attach-event\x3d"onChange:_onChangeClassifyClasses" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"4" smallDelta\x3d"1" constraints\x3d"{min:1,max:10,places:0}" style\x3d"width:40px; margin: 0 5px;" /\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyClassesPart2"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSizeClassifyStdDevIntervalTitle" style\x3d"margin-top:3px;"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyStdDevIntervalPart1"\x3e\x3c/span\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"_rendererSizeClassifyStdDevInterval" data-dojo-attach-event\x3d"onChange:_onChangeClassifyStdDevInterval" data-dojo-type\x3d"dijit.form.Select" style\x3d"width:50px;"\x3e\r\n          \x3c/select\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeClassifyStdDevIntervalPart2"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"rendererSizePrecision" style\x3d"margin-top: 3px;"\x3e\r\n          \x3ctable\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd nowrap\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_rendererSizePrecisionLabel"\x3e${i18n.roundClasses}\x3c/span\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"_rendererSizePrecision" data-dojo-attach-event\x3d"onChange:_onChangeSizePrecision" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false" style\x3d"margin: 0 10px;"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top:5px;clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeOtherCheckMsg" \x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererSizeOtherCheck" data-dojo-attach-event\x3d"onChange:_onChangeOther" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x26nbsp;\x3cspan data-dojo-attach-point\x3d"_rendererSizeOtherTxt"\x3e\r\n            ${i18n.drawOthers}\r\n          \x3c/span\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeOther" class\x3d"esriLeadingMargin107"\x3e\r\n        \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeOtherSymbolText"\x3e\r\n            ${i18n.symbolLabel}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeOtherSymbol" style\x3d"padding: 0 5px;"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotation" style\x3d"margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererSizeRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotationText" style\x3d"padding: 0;"\x3e\r\n            \x26nbsp;${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotationContent" class\x3d"esriLeadingMargin107" style\x3d"margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererSizeRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSizeRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseSize"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSizeRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseSize"/\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                ${i18n.arithmetic}\r\n              \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererSizeRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeLegend" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererSizeLegendCheck" data-dojo-attach-event\x3d"onChange:_onChangeLegend" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSizeLegendText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.showInLegend}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:15px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeTransparency" style\x3d"position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 5px 10px 20px 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSizeTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererSizeHasAttributeTransparency" \x3e\r\n          ${i18n.overallTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rendererSizeTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"rendererSizeTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding: 6px 0 20px;"\x3e\r\n            \x3cdiv id\x3d"rendererSizeTransparencySlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSizeTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererSizeHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n          ${i18n.perFeaturesTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererSizeHasAttributeTransparency esriLeadingPadding1"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n          \x3cA data-dojo-attach-point\x3d"_rendererSizeAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSizeAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSizeScale" style\x3d"clear:both;position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeScaleTitle" class\x3d"esriFloatLeading sectionTitle"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSizeScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererSizeScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom"\x3e\r\n\t\t\x3cdiv id\x3d"rendererSizeContentClose" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" \x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"rendererSizeFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"rendererSizeFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/Predominance.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv id\x3d"renderer-predominance-main" class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"padding:7px;"\x3e\r\n    \x3cdiv id\x3d"rendererPredominanceHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererPredominanceTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceLayer" class\x3d"panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_rendererPredominanceTop" region\x3d"center" style\x3d"padding:10px 0;overflow-y:auto;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererPredominanceChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y:auto;"\x3e\r\n      \x3cdiv id\x3d"predominanceGridText" style\x3d"margin-bottom: 3px;"\x3e\r\n        \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"predominanceGridDiv"\x3e\r\n        \x3cdiv id\x3d"predominanceGrid"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-predominance-bottom" class\x3d"panel panel_left esriTrailingMargin09px" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y: auto; padding:7px; margin-top:5px; margin-bottom:-5px;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotation" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererPredominanceRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotationText"\x3e\r\n            \x26nbsp;${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotationContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererPredominanceRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                \x3c/select\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererPredominanceRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwisePredominance"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererPredominanceRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwisePredominance"/\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                ${i18n.arithmetic}\r\n              \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:20px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceTransparency"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 16px 10px 30px 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererPredominanceHasAttributeTransparency" \x3e\r\n          ${i18n.overallTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rendererPredominanceTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"rendererPredominanceTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding:6px 0 20px;"\x3e\r\n            \x3cdiv id\x3d"rendererPredominanceTransparencySlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererPredominanceHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n          ${i18n.perFeaturesTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererPredominanceHasAttributeTransparency esriLeadingPadding1"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererPredominanceAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n          \x3cA data-dojo-attach-point\x3d"_rendererPredominanceAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererPredominanceAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceScale" style\x3d"clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceScaleTitle" class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererPredominanceScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererPredominanceScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\t\x3cdiv id\x3d"rendererPredominanceContentClose" style\x3d"margin-top:10px"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererPredominanceFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererPredominanceFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/Relationship.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv id\x3d"renderer-relationship-top" class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"padding:7px;"\x3e\r\n    \x3cdiv id\x3d"rendererRelationshipHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererRelationshipTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipLayer" class\x3d"panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_rendererRelationshipTop" region\x3d"center" style\x3d"padding:10px 0;overflow-y:auto;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererRelationshipChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-relationship-scrollContent" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-y: auto;"\x3e\r\n    \x3cdiv id\x3d"renderer-relationship-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow:none;padding:2px;"\x3e\r\n      \x3ctable\x3e\r\n        \x3ctbody\x3e\r\n        \x3ctr id\x3d"rendererRelationshipFocus"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                ${i18n.focus}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererRelationshipFocusSelect"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererRelationshipFocus" id\x3d"rendererRelationshipFocusDropdown" data-dojo-attach-event\x3d"onChange:_onChangeRelationshipFocus" data-dojo-type\x3d"dijit.form.FilteringSelect" maxHeight\x3d"250" sortByLabel\x3d"false"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD esriLeadingPadding1" rowspan\x3d"3" style\x3d"text-align:center; vertical-align:top;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipSymbolsTitle" data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipSymbol" style\x3d"padding:5px 0;" class\x3d"symbolIconClassed"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipLegendClassesTitle" data-dojo-attach-event\x3d"onClick:_onClickLegendClasses" class\x3d"rightIcons" style\x3d"padding-top: 20px;"\x3e\r\n              \x3cdiv class\x3d"legendClassesIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.legend}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipPolygonsTitle" data-dojo-attach-event\x3d"onClick:_onClickPolygons" class\x3d"rightIcons" style\x3d"padding-top: 15px; display:none;"\x3e\r\n              \x3cdiv\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipPolygonSymbol" style\x3d"padding:5px 0;"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.polygons}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererRelationshipGridsize"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                ${i18n.gridSize}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererRelationshipGridsizeSelect"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererRelationshipGridsize" id\x3d"rendererRelationshipGridsizeDropdown" data-dojo-attach-event\x3d"onChange:_onChangeRelationshipGridsize" data-dojo-type\x3d"dijit.form.FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr id\x3d"rendererRelationshipMethod"\x3e\r\n          \x3ctd colspan\x3d"2" nowrap\x3e\r\n            \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n              \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                ${i18n.classificationMethod}\x26nbsp;\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd id\x3d"rendererRelationshipMethodSelect"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_rendererRelationshipClassifyMethods" id\x3d"rendererRelationshipClassifyMethodDropdown" data-dojo-attach-event\x3d"onChange:_onChangeRelationshipClassifyMethod" data-dojo-type\x3d"dijit.form.FilteringSelect" maxHeight\x3d"180" sortByLabel\x3d"false"\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n\r\n\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y:auto;"\x3e\r\n\r\n        \x3ctable style\x3d"margin-top:15px;"\x3e\r\n          \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipField1LabelCheck" data-dojo-attach-event\x3d"onClick:_onToggleField1" class\x3d"subSectionClosed" style\x3d"margin-top:2px;cursor:pointer;"\x3e\x3c/span\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipField1Label" data-dojo-attach-event\x3d"onClick:_onToggleField1" class\x3d"fieldDetails" style\x3d"vertical-align: top;"\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipField1" class\x3d"esriLeadingMargin1" style\x3d"display:none;"\x3e\r\n                \x3ctable\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd colspan\x3d"2" nowrap\x3e\r\n                      \x3cdiv class\x3d"firstColumnDiv2"\x3e\r\n                        \x3clabel class\x3d"firstColumnLabel2"\x3e\r\n                          ${i18n.dividedBy}\x26nbsp;\r\n                        \x3c/label\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd data-dojo-attach-point\x3d"_rendererRelationshipDividedByField1Select"\x3e\r\n                      \x3cselect data-dojo-attach-point\x3d"_rendererRelationshipDividedByField1Attribute" data-dojo-attach-event\x3d"onChange:_onChangeDividedByAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                      \x3c/select\x3e\r\n                    \x3c/td\x3e\x3ctd\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipDividedByField1Description" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n                \x3ctable\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd height\x3d"271"\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipSliderField1Div"\x3e\r\n                        \x3cdiv id\x3d"rendererRelationshipSliderField1"\x3e\r\n                        \x3c/div\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n\r\n              \x3cdiv\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipField2LabelCheck" data-dojo-attach-event\x3d"onClick:_onToggleField2" class\x3d"subSectionClosed" style\x3d"margin-top:2px;cursor:pointer;"\x3e\x3c/span\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipField2Label" data-dojo-attach-event\x3d"onClick:_onToggleField2" class\x3d"fieldDetails" style\x3d"vertical-align: top;"\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipField2" class\x3d"esriLeadingMargin1" style\x3d"display:none;"\x3e\r\n                \x3ctable\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd colspan\x3d"2" nowrap\x3e\r\n                      \x3cdiv class\x3d"firstColumnDiv"\x3e\r\n                        \x3clabel class\x3d"firstColumnLabel"\x3e\r\n                          ${i18n.dividedBy}\x26nbsp;\r\n                        \x3c/label\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd data-dojo-attach-point\x3d"_rendererRelationshipDividedByField2Select"\x3e\r\n                      \x3cselect data-dojo-attach-point\x3d"_rendererRelationshipDividedByField2Attribute" data-dojo-attach-event\x3d"onChange:_onChangeDividedByAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                      \x3c/select\x3e\r\n                    \x3c/td\x3e\x3ctd\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipDividedByField2Description" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n                \x3ctable\x3e\r\n                  \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd height\x3d"271"\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipSliderField2Div"\x3e\r\n                        \x3cdiv id\x3d"rendererRelationshipSliderField2"\x3e\r\n                        \x3c/div\x3e\r\n                      \x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                  \x3c/tbody\x3e\r\n                \x3c/table\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"renderer-relationship-legend-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow:none;padding:2px; display:none;"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow:none;"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipGridDiv"\x3e\r\n                \x3cdiv style\x3d"margin-bottom: 3px; white-space: normal;"\x3e\r\n                  \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipGridContainer" class\x3d"rendererRelationshipGridContainer" style\x3d"overflow: none;"\x3e\r\n                  \x3cdiv id\x3d"relationshipGrid"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd nowrap class\x3d"toolsColumnTD" rowspan\x3d"3" style\x3d"text-align:center; vertical-align:top;"\x3e\r\n              \x3cdiv data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cdiv style\x3d"padding:5px 0;" class\x3d"symbolIconClassed"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                  \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipLegendClassesTitle2" data-dojo-attach-event\x3d"onClick:_onClickLegendClasses" class\x3d"rightIcons" style\x3d"padding-top: 20px;"\x3e\r\n                \x3cdiv class\x3d"legendClassesIcon active"\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                  \x3cspan class\x3d"toolsLabel"\x3e${i18n.classes}\x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipPolygonsTitle2" data-dojo-attach-event\x3d"onClick:_onClickPolygons" class\x3d"rightIcons" style\x3d"padding-top: 15px; display:none;"\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipPolygonSymbol2" style\x3d"padding:5px 0;"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv\x3e\r\n                  \x3cspan class\x3d"toolsLabel"\x3e${i18n.polygons}\x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"renderer-relationship-bottom" class\x3d"panel panel_left esriTrailingMargin09px" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"overflow-y: auto; padding:7px; margin-bottom:-5px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipOtherDiv" style\x3d"clear:both;margin-top:5px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipOtherCheckMsg" \x3e\r\n          \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_rendererRelationshipOtherCheck" data-dojo-attach-event\x3d"onChange:_onChangeOther" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipOtherTxt" style\x3d"padding: 0 5px;"\x3e\r\n              ${i18n.drawOthers}\r\n            \x3c/span\x3e\r\n          \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipOther" class\x3d"esriLeadingMargin107" style\x3d"clear:both;"\x3e\r\n          \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipOtherSymbolText"\x3e\r\n              ${i18n.symbolLabel}\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipOtherSymbol" style\x3d"padding: 0 5px;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotation" style\x3d"clear:both;margin-top:5px;"\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_rendererRelationshipRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotationText"\x3e\r\n              \x26nbsp;${i18n.rotationMsg}\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotationContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n            \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererRelationshipRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n            \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererRelationshipRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseRelationship"/\x3e\r\n                  \x3c/td\x3e\x3ctd\x3e\r\n                    ${i18n.geographic}\r\n                  \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                    \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                  \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererRelationshipRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseRelationship"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.arithmetic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"height:20px;clear:both;"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipTransparency" style\x3d"position:relative;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n          ${i18n.transparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 16px 10px 30px 10px;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererRelationshipHasAttributeTransparency" \x3e\r\n            ${i18n.overallTransparency}\r\n          \x3c/div\x3e\r\n          \x3cdiv id\x3d"rendererRelationshipTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n            \x3cdiv id\x3d"rendererRelationshipTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding:6px 0 20px;"\x3e\r\n              \x3cdiv id\x3d"rendererRelationshipTransparencySlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererRelationshipHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n            ${i18n.perFeaturesTransparency}\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererRelationshipHasAttributeTransparency esriLeadingPadding1"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n            \x3cA data-dojo-attach-point\x3d"_rendererRelationshipAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"_rendererRelationshipAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipScale" style\x3d"clear:both;position:relative;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipScaleTitle" class\x3d"esriFloatLeading sectionTitle" style\x3d"position: relative;"\x3e\r\n          ${i18n.visibleRange}\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererRelationshipScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n          \x26nbsp;${i18n.suggest}\x26nbsp;\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n          \x3cdiv id\x3d"rendererRelationshipScaleSlider"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererRelationshipContentClose" style\x3d"margin-top:10px"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererRelationshipFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererRelationshipFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/GalleryListItem.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv class\x3d"rendererType" data-dojo-attach-point\x3d"_root"\x3e\r\n    \x3cdiv class\x3d"rendererTypeField" data-dojo-attach-point\x3d"_field" style\x3d"display: none;"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"rendererTypeThumbOuter"\x3e\r\n      \x3cdiv class\x3d"renderer_${type} ${timeline} rendererTypeThumb" style\x3d"cursor: pointer;" data-dojo-attach-event\x3d"onClick:_onThumbClick" data-dojo-attach-point\x3d"_thumb"\x3e\r\n        \x3cdiv class\x3d"rendererTitle" data-dojo-attach-point\x3d"_title"\x3e\r\n          \x3cdiv class\x3d"rendererTitleText" data-dojo-attach-point\x3d"_titleText"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"rendererCheck" data-dojo-attach-point\x3d"_check"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"rendererSelect" data-dojo-attach-point\x3d"_select"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_selectButton" data-dojo-attach-event\x3d"onClick:_onSelect"\x3e\x3cspan\x3e${i18n.select}\x3c/span\x3e\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"rendererSelect rendererSelectCopyStyle" data-dojo-attach-point\x3d"_selectCopyStyle" style\x3d"display:none;"\x3e\r\n          \x3cdiv id\x3d"rendererSelectCopyStyleDiv"\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_selectCopyStyleLink" data-dojo-attach-event\x3d"onClick:_onSelectCopyStyle"\x3e\x3cspan\x3e${i18n.layer}\x3c/span\x3e\x3c/button\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue dropdown-btn" data-dojo-attach-point\x3d"_selectCopyStyleButton" data-dojo-attach-event\x3d"onClick:_onSelectCopyStyle"\x3e\x3cspan\x3e\x26nbsp;\x3c/span\x3e\x3c/button\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_selectCopyStyleDropDown" class\x3d"dropdown-menu rendererCopyStyleDropDownMenu" style\x3d"display:none;"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"rendererOptions" data-dojo-attach-point\x3d"_options"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_optionsButton" data-dojo-attach-event\x3d"onClick:_onOptions"\x3e\x3cspan\x3e${i18n.options}\x3c/span\x3e\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e \r\n\x3c/div\x3e',
"url:arcgisonline/map/dijit/renderer/templates/GalleryList.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_galleryList"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:arcgisonline/map/dijit/renderer/templates/MultiAttributes.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"padding:7px;margin-bottom:-5px;"\x3e\r\n    \x3cdiv id\x3d"rendererMultiAttributesHeader" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"top"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onClose" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererMultiAttributesLayer" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" id\x3d"rendererMultiAttributesPane" style\x3d"padding-top:10px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererTitle1"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"margin:5px 0 5px 0; clear:both;"\x3e    \r\n        \x3cdiv class\x3d"esriFloatLeading"\x3e    \r\n          \x3cdiv class\x3d"esriFloatLeading subTitle"\x3e${i18n.layerHasMultipleStyles}\x3c/div\x3e\r\n        \x3c/div\x3e    \r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererTypes" class\x3d"esriFloatLeading rendererTypes" style\x3d"clear: both; overflow-y:auto;"\x3e  \r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererTypesList"\x3e  \r\n          \x3c/div\x3e    \r\n        \x3c/div\x3e    \r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererMultiAttributesContentClose"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.done}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_cancelButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererMultiAttributesFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererMultiAttributesFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/Simple.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv id\x3d"renderer-simple-main" class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"padding:7px;"\x3e\r\n    \x3cdiv id\x3d"rendererSimpleHeader" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"top"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererSimpleTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleLayer" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_rendererSimpleTop" region\x3d"center" style\x3d"padding:10px 0;overflow-y:auto;"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading strong" style\x3d"margin-top: 2px;"\x3e\r\n        ${i18n.location}\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererSimpleChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-simple-bottom" class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"padding:2px 7px 7px 7px; margin-bottom:-5px; overflow-y:auto;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleSymbolTitle"\x3e\r\n      \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleSymbol" class\x3d"esriFloatLeading" style\x3d"padding:5px"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"middle"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"_rendererSimpleSymbolText" class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleStream" class\x3d"esriFloatLeading" style\x3d"margin-bottom:15px;"\x3e\r\n      \x3cdiv\x3e\r\n        ${i18n.streamMsg}\r\n      \x3c/div\x3e\r\n      \x3ctable style\x3d"padding-top:10px;" data-dojo-attach-point\x3d"rendererStreamPreviousMsg"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd style\x3d"padding-top:2px;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"rendererStreamPreviousCheck" data-dojo-attach-event\x3d"onChange:_onChangeStreamPrevious" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cspan id\x3d"rendererStreamMsgPart1" class\x3d"esriLeadingMargin05"\x3e\r\n              \x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"rendererStreamMaxTrackPts" data-dojo-attach-event\x3d"onChange:_onChangeStreamMaxTrackPts" intermediateChanges\x3d"true" data-dojo-type\x3d"dijit.form.NumberSpinner" value\x3d"5" smallDelta\x3d"1" constraints\x3d"{min:2,max:100,places:0}" style\x3d"width:40px; margin: 0 5px;"/\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd nowrap\x3e\r\n              \x3cspan id\x3d"rendererStreamMsgPart2"\x3e\r\n              \x3c/span\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n      \x3cdiv class\x3d"esriLeadingMargin108"\x3e\r\n        \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n          ${i18n.symbolLabel}\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_streamSymbolImage" id\x3d"panelStreamSymbolImage" class\x3d"esriFloatLeading" style\x3d"padding:5px"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"rendererStreamConnectObservationsMsg" style\x3d"clear:both; margin-top:5px"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"rendererStreamConnectCheck" data-dojo-attach-event\x3d"onChange:_onChangeStreamConnect" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox" /\x3e\r\n          \x3cspan class\x3d"esriLeadingMargin05"\x3e\r\n            ${i18n.connectObservations}\r\n          \x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriLeadingMargin108" style\x3d"clear:both;"\x3e\r\n          \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n            ${i18n.symbolLabel}\r\n          \x3c/td\x3e\x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_streamLineSymbolImage" id\x3d"panelStreamLineSymbolImage" class\x3d"esriFloatLeading" style\x3d"padding:5px"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotation" style\x3d"clear:both; margin-top: 10px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererSimpleRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotationText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotationContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;display:none;"\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd\x3e\r\n                  \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererSimpleRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                  \x3c/select\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSimpleRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseSimple"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererSimpleRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseSimple"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.arithmetic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:15px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleTransparency" style\x3d"clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 5px 10px 0 10px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleTransparencyOverallTitle" class\x3d"esriFloatLeading sectionSubTitle rendererSimpleHasAttributeTransparency" \x3e\r\n          ${i18n.overallTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rendererSimpleTransparencySliderDiv" class\x3d"esriLeadingPadding1" style\x3d"clear:both;"\x3e\r\n          \x3cdiv id\x3d"rendererSimpleTransparencySliderInnerDiv" class\x3d"esriFloatLeading" style\x3d"padding: 6px 0 20px;"\x3e\r\n            \x3cdiv id\x3d"rendererSimpleTransparencySlider"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleTransparencyPerFeatureTitle" class\x3d"esriFloatLeading sectionSubTitle rendererSimpleHasAttributeTransparency" style\x3d"clear:both;"\x3e\r\n          ${i18n.perFeaturesTransparency}\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:3px;" class\x3d"esriItemLinks rendererSimpleHasAttributeTransparency esriLeadingPadding1"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSimpleAttributeTransparencyLabel_part1" class\x3d"esriLeadingMargin025"\x3e\x3c/span\x3e\r\n          \x3cA data-dojo-attach-point\x3d"_rendererSimpleAttributeTransparencyLabel_part2" data-dojo-attach-event\x3d"onClick:_onClickAttributeTransparency" href\x3d"JavaScript:void(0);"\x3e\x3c/A\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererSimpleAttributeTransparencyLabel_part3"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleScale" style\x3d"padding:20px 0 10px 0;clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleScaleTitle" class\x3d"esriFloatLeading sectionTitle"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererSimpleScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_rendererSimpleSpacer"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererSimpleContentClose"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererSimpleFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererSimpleFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/HeatmapSlider/templates/HeatmapSlider.html": '\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_titleNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_sliderNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_scaleNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:arcgisonline/map/dijit/renderer/templates/HeatMap.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%; padding:5px;"\x3e\r\n  \x3cdiv id\x3d"rendererHeatMapTop" data-dojo-type\x3d"dijit.layout.ContentPane" class\x3d"panel panel_left" region\x3d"top" style\x3d"padding:2px;"\x3e\r\n    \x3cdiv id\x3d"rendererHeatMapHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererHeatMapTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapLayer" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"_rendererHeatMapTop" region\x3d"center" style\x3d"padding:10px 0;overflow-y:auto;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererHeatMapChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-heatmap-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-y:auto;padding:2px;"\x3e\r\n    \x3ctable style\x3d"width:100%;margin-bottom:10px;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd height\x3d"200"\x3e\r\n            \x3cdiv id\x3d"rendererHeatMapSliderDiv"\x3e\r\n              \x3cdiv id\x3d"rendererHeatMapSlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD" style\x3d"text-align:center; vertical-align:top; padding-top:20px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapSymbolsTitle" data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapSymbols" class\x3d"symbolIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapInfluence" class\x3d"esriFloatLeading" style\x3d"clear:both;margin-top:20px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapInfluenceTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.areaOfInfluence}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererHeatMapInfluenceSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:20px;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapTransparency" class\x3d"esriFloatLeading"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 16px 10px 30px 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererHeatMapTransparencySlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapScale" style\x3d"clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapScaleTitle"  class\x3d"esriFloatLeading sectionTitle"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererHeatMapScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererHeatMapScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom"\x3e\r\n\t\t\x3cdiv id\x3d"rendererHeatMapContentClose" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" \x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"rendererHeatMapFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"rendererHeatMapFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/map/dijit/renderer/templates/Ratio.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%; padding:5px;"\x3e\r\n  \x3cdiv id\x3d"rendererRatioTop" data-dojo-type\x3d"dijit.layout.ContentPane" class\x3d"panel panel_left" region\x3d"top" style\x3d"padding:2px;"\x3e\r\n    \x3cdiv id\x3d"rendererRatioHeader"\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onCancel" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererRatioTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioLayer" class\x3d"panel_title" style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"margin: 2px 0 20px 0; padding:10px 0;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioField" class\x3d"esriFloatLeading strong"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioAttribute" class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" data-dojo-attach-point\x3d"_rendererRatioChangeButton" class\x3d"calcite tiny" data-dojo-attach-event\x3d"onClick:_onChangeField"\x3e\x3cspan\x3e${i18n.change}\x3c/span\x3e\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"renderer-ratio-content" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"overflow-y:auto;padding:2px;"\x3e\r\n    \x3ctable style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd height\x3d"271"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioSliderDiv"\x3e\r\n              \x3cdiv id\x3d"rendererRatioSlider"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioGridDiv" style\x3d"padding-top: 10px;"\x3e\r\n              \x3cdiv style\x3d"margin-bottom: 3px;"\x3e\r\n                \x3cspan class\x3d"small clickToEditMsg"\x3e${i18n.clickToEdit}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioGridContainer" class\x3d"rendererRatioGridContainer" style\x3d"overflow-y: auto;overflow-x: none;"\x3e\r\n                \x3cdiv id\x3d"rendererRatioGrid"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd nowrap class\x3d"toolsColumnTD" style\x3d"text-align:center; vertical-align:top; padding-top:20px;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioSymbolsTitle" data-dojo-attach-event\x3d"onClick:_onClickSymbols" class\x3d"rightIcons"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioSymbols" class\x3d"symbolIconClassed"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan class\x3d"toolsLabel"\x3e${i18n.symbols}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioInvertTitle" data-dojo-attach-event\x3d"onClick:_onClickInvert" class\x3d"rightIcons" style\x3d"padding-top: 10px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioInvertIcon" class\x3d"invertIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRatioInvertLabel" class\x3d"toolsLabel"\x3e${i18n.invert}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioStyleTitle" data-dojo-attach-event\x3d"onClick:_onClickStyle" class\x3d"rightIcons" style\x3d"padding-top: 12px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioStyleIcon" class\x3d"styleIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRatioStyleLabel" class\x3d"toolsLabel"\x3e${i18n.labels}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioCenterTitle" data-dojo-attach-event\x3d"onClick:_onClickCenter" class\x3d"rightIcons" style\x3d"padding-top: 12px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioCenterIcon" class\x3d"centerIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRatioCenterLabel" class\x3d"toolsLabel"\x3e${i18n.centerAt}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererRatioZoomTitle" data-dojo-attach-event\x3d"onClick:_onClickZoom" class\x3d"rightIcons" style\x3d"padding-top: 12px;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioZoomIcon" class\x3d"zoomIcon"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv style\x3d"padding-top: 5px;"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_rendererRatioZoomLabel" class\x3d"toolsLabel"\x3e${i18n.zoomIn}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_estimatedValuesMsg" class\x3d"small estimateMsg"\x3e\r\n      ${i18n.estimatedValuesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_zeroFeaturesMsg" class\x3d"small zeroFeaturesMsg"\x3e\r\n      ${i18n.zeroFeaturesMsg}\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioOtherCheckMsg" \x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererRatioOtherCheck" data-dojo-attach-event\x3d"onChange:_onChangeOther" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_rendererRatioOtherTxt" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.drawOthers}\r\n          \x3c/span\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioOther" class\x3d"esriLeadingMargin107" style\x3d"clear:both;"\x3e\r\n        \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRatioOtherSymbolText"\x3e\r\n            ${i18n.symbolLabel}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRatioOtherSymbol" style\x3d"padding: 0 5px;"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotation" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererRatioRotationCheck" data-dojo-attach-event\x3d"onChange:_onChangeRotation" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"false" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotationText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.rotationMsg}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotationContent" class\x3d"esriLeadingMargin107" style\x3d"clear:both;margin-top:3px;"\x3e\r\n        \x3cdiv style\x3d"margin-top:3px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererRatioRotationAttribute" data-dojo-attach-event\x3d"onChange:_onChangeRotationAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                \x3c/select\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotationEditExpression" class\x3d"editRendererIcon rendererClickable" style\x3d"margin: 0 10px 0 10px;"\x3e\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotationFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"clear:both;margin-top:10px;"\x3e\r\n          \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                  \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererRatioRotationClockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:true" name\x3d"clockwiseRatio"/\x3e\r\n                \x3c/td\x3e\x3ctd\x3e\r\n                  ${i18n.geographic}\r\n                \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                  \x3cdiv class\x3d"rotateRight rotate"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotateRightSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n              \x3cdiv style\x3d"width:40px;"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\x3ctd\x3e\r\n              \x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"vertical-align:top;"\x3e\r\n                \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-attach-point\x3d"_rendererRatioRotationCounterclockwiseRadio" data-dojo-attach-event\x3d"onChange:_onChangeRotationDirection" data-dojo-props\x3d"checked:false" name\x3d"clockwiseRatio"/\x3e\r\n              \x3c/td\x3e\x3ctd\x3e\r\n                ${i18n.arithmetic}\r\n              \x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"rotateLeft rotate"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererRatioRotateLeftSymbol" class\x3d"rotateImg"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n            \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererRatioLegend" style\x3d"clear:both;margin-top:5px;"\x3e\r\n      \x3cdiv\x3e\r\n        \x3ctable cellspacing\x3d"0"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_rendererRatioLegendCheck" data-dojo-attach-event\x3d"onChange:_onChangeLegend" data-dojo-type\x3d"dijit.form.CheckBox" checked\x3d"true" type\x3d"checkbox"/\x3e\r\n        \x3c/td\x3e\x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererRatioLegendText" style\x3d"padding: 0 5px;"\x3e\r\n            ${i18n.showInLegend}\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"height:15px;clear:both;"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererRatioTransparency" style\x3d"position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioTransparencyTitle" class\x3d"esriFloatLeading sectionTitle" \x3e\r\n        ${i18n.transparency}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both; padding: 16px 10px 30px 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererRatioTransparencySlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_rendererRatioScale" style\x3d"clear:both;position:relative;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioScaleTitle" class\x3d"esriFloatLeading sectionTitle"\x3e\r\n        ${i18n.visibleRange}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererRatioScaleSuggest" data-dojo-attach-event\x3d"onClick:_onClickScaleSuggest" class\x3d"esriFloatTrailing suggestLabel"\x3e\r\n        \x26nbsp;${i18n.suggest}\x26nbsp;\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" style\x3d"clear:both;padding: 10px;"\x3e\r\n        \x3cdiv id\x3d"rendererRatioScaleSlider"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom"\x3e\r\n\t\t\x3cdiv id\x3d"rendererRatioContentClose" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" \x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.ok}\x3c/span\x3e\x3c/button\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-attach-point\x3d"_doneChangingButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"rendererRatioFooterDiv" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0; display:none;"\x3e\r\n      \x3cdiv class\x3d"footer" id\x3d"rendererRatioFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/map/dijit/renderer/templates/Gallery.html": '\x3cdiv data-dojo-type\x3d"dijit.layout.BorderContainer" region\x3d"top" style\x3d"height:100%;"\x3e\r\n  \x3cdiv class\x3d"panel panel_left" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" style\x3d"padding:7px;margin-bottom:-5px;"\x3e\r\n    \x3cdiv id\x3d"rendererHeader" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"top" style\x3d"display:none;"\x3e\r\n      \x3cdiv id\x3d"rendererContentButtons" class\x3d"esriFloatTrailing" style\x3d"display:inline;"\x3e\r\n        \x3ca href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_onClose" title\x3d"${i18n.close}" class\x3d"panel panel_close panel_collapse"\x3e\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rendererTitle" class\x3d"esriFloatLeading panel_title"\x3e\r\n        ${i18n.rendererPanelTitle}\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_rendererGalleryLayer" class\x3d"esriFloatLeading panel_title" style\x3d"clear:both;display:none;"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both; height:1px;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"center" id\x3d"rendererGalleryPane" style\x3d"clear:both; padding-top:10px; overflow-y:auto;"\x3e\r\n      \x3cdiv style\x3d"clear:both;"\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading firstIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriFloatLeading title"\x3e${i18n.chooseAttribute}\x3c/div\x3e\r\n        \x3ctable class\x3d"esriFloatLeading" cellspacing\x3d"0" cellpadding\x3d"0" style\x3d"clear:both;"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd style\x3d"width: 3.5em;" align\x3d"right" valign\x3d"top"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererSwitchAttribute12" class\x3d"switchAttributeIcon esriFloatTrailing rendererClickable" style\x3d"margin: 23px 10px 0 10px; display:none;"\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv style\x3d"clear:both;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput" data-dojo-attach-point\x3d"_rendererAttribute" data-dojo-attach-event\x3d"onChange:_onChangeAttribute" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                         \x3cdiv data-dojo-attach-point\x3d"_rendererEditExpression" class\x3d"editRendererIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                         \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv2" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute2" data-dojo-attach-event\x3d"onChange:_onChangeAttribute2" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererEditExpression2" class\x3d"editRendererIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription2" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute2" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv3" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute3" data-dojo-attach-event\x3d"onChange:_onChangeAttribute3" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererEditExpression3" class\x3d"editRendererIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription3" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute3" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv4" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute4" data-dojo-attach-event\x3d"onChange:_onChangeAttribute4" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription4" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute4" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv5" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                      \x3ctr\x3e\r\n                        \x3ctd\x3e\r\n                          \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute5" data-dojo-attach-event\x3d"onChange:_onChangeAttribute5" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                          \x3c/select\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription5" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\x3ctd\x3e\r\n                          \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute5" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                        \x3c/td\x3e\r\n                      \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv6" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e\r\n                        \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute6" data-dojo-attach-event\x3d"onChange:_onChangeAttribute6" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription6" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute6" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv7" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e\r\n                        \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute7" data-dojo-attach-event\x3d"onChange:_onChangeAttribute7" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription7" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute7" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv8" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e\r\n                        \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute8" data-dojo-attach-event\x3d"onChange:_onChangeAttribute8" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription8" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute8" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv9" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e\r\n                        \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute9" data-dojo-attach-event\x3d"onChange:_onChangeAttribute9" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription9" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute9" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAttributeDiv10" style\x3d"clear:both; padding-top:8px;display:none;"\x3e\r\n                  \x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n                    \x3ctbody\x3e\r\n                    \x3ctr\x3e\r\n                      \x3ctd\x3e\r\n                        \x3cselect class\x3d"rendererInput esriFloatLeading" data-dojo-attach-point\x3d"_rendererAttribute10" data-dojo-attach-event\x3d"onChange:_onChangeAttribute10" data-dojo-type\x3d"dijit.form.Select" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\r\n                        \x3c/select\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererFieldDescription10" class\x3d"fieldDescriptionIcon esriLeadingMargin05" style\x3d"margin-top: 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_rendererRemoveAttribute10" class\x3d"removeAttributeIcon rendererClickable" style\x3d"margin: 4px 5px 0 5px;"\x3e\x3c/div\x3e\r\n                      \x3c/td\x3e\r\n                    \x3c/tr\x3e\r\n                    \x3c/tbody\x3e\r\n                  \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_rendererAddAttribute" class\x3d"rendererClickable" style\x3d"clear:both; padding-top:10px; display:none;"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"_rendererAddAttributeText" class\x3d"esriFloatLeading"\x3e${i18n.addAttribute}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3cdiv style\x3d"padding-top:15px; clear:both; position:relative;"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading secondIcon"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n            \x3cdiv class\x3d"title"\x3e${i18n.selectDrawingStyle}\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_rendererDefaultStyle" class\x3d"rendererClickable" style\x3d"display:none;"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_rendererDefaultStyleText" class\x3d"esriFloatLeading" style\x3d"margin: 0 10px;"\x3e${i18n.defaultStyle}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_rendererTypes" class\x3d"esriFloatLeading rendererTypes" style\x3d"clear: both; overflow-y:auto;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_rendererTypesList"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererGalleryContentClose"\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite blue" data-dojo-attach-point\x3d"_doneButton" data-dojo-attach-event\x3d"onClick:_onDone"\x3e\x3cspan\x3e${i18n.done}\x3c/span\x3e\x3c/button\x3e\r\n    \x3cbutton data-dojo-type\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite transparent" id\x3d"rendererContent-close" data-dojo-attach-point\x3d"_cancelButton" data-dojo-attach-event\x3d"onClick:_onCancel"\x3e\x3cspan\x3e${i18n.cancel}\x3c/span\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv id\x3d"rendererContentFooter" data-dojo-type\x3d"dijit.layout.ContentPane" region\x3d"bottom" style\x3d"height:40px; padding: 0 5px 0 5px; display:none;"\x3e\r\n    \x3cdiv class\x3d"footer" id\x3d"rendererFooter" data-dojo-type\x3d"arcgisonline.sharing.dijit.SiteFooterMap" style\x3d"white-space:normal;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ColorPalette.html": '\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n', "url:esri/dijit/templates/FontAlignment.html": '\x3cdiv class\x3d"esriFontAlignment"\x3e\r\n  \x3cdiv class\x3d"top"\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"baseline,right" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"bot-right"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"baseline,center" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"bot-mid"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"baseline,left" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"bot-left"\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"mid"\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"middle,right" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"mid-right"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"middle,center" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"mid-mid"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"middle,left" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"mid-left"\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"bot"\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"top,right" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"top-right"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"top,center" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"top-mid"\x3e\x3c/button\x3e\r\n    \x3cbutton class\x3d"icon" value\x3d"top,left" data-dojo-attach-event\x3d"onClick:changeValue"\x3e\x3cdiv class\x3d"top-left"\x3e\x3c/div\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/VectorFieldRenderer.html": '\x3cdiv data-dojo-attach-point\x3d"_vectorFieldRendererContainer" class\x3d"esriVFRContainer"\x3e\r\n  \x3ctable class\x3d"esriVFRTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel class\x3d"esriVFRSymbolTitle"\x3e${_i18n.widgets.vectorFieldRenderer.symbolTypeLabelTitle}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3ctable class\x3d"esriVFRTypeBlock"\x3e\r\n\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e\r\n              \x3cdiv class\x3d"esriVFRTypeList" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-point\x3d"rendererTypeSelect" data-dojo-attach-event\x3d"onChange: _selectRendererStyle"\x3e\x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd class\x3d"esriVFRColorPickerCell"\x3e\r\n              \x3cdiv class\x3d"esriVFRColorButton" data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-attach-point\x3d"colorPickerButton"\x3e\r\n                \x3cspan\x3e\x3c/span\x3e\r\n                \x3cdiv data-dojo-type\x3d"esri/dijit/ColorPicker" data-dojo-attach-point\x3d"symbolColorPicker" class\x3d"esriVFRColorPicker"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.dataTypeLabelTile}\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"flowAngleSelect" class\x3d"esriVFRFlowAngleList" data-dojo-attach-event\x3d"onChange: _setPropertiesChanged"\x3e\r\n          \x3coption value\x3d"FLOW_FROM" selected\x3d"selected"\x3e${_i18n.widgets.vectorFieldRenderer.angleFromAlias}\x3c/option\x3e\r\n          \x3coption value\x3d"FLOW_TO"\x3e${_i18n.widgets.vectorFieldRenderer.angleToAlias}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.symbolDensityLabelTitle}\x3c/label\x3e\r\n        \x3clabel class\x3d"esriVFRBold" data-dojo-attach-point\x3d"symbolDensitySliderValueLabel"\x3e\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2" class\x3d"esriVFRTileSizeSlider"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"symbolDensitySliderDiv"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.symbolSizeLabelTitle}\x3c/label\x3e\r\n        \x3clabel class\x3d"esriVFRBold" data-dojo-attach-point\x3d"symbolSizeSliderValueLabel"\x3e\x3c/label\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2" class\x3d"esriVFRSymbolSizeSlider"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"symbolSizeSliderDiv"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"open: false" data-dojo-attach-point\x3d"advancedSettingsPane"\x3e\r\n          \x3ctable class\x3d"esriVFRAdvSettingsTable"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol class\x3d"esriAdvSettingsCol1" /\x3e\r\n              \x3ccol class\x3d"esriAdvSettingsCol2" /\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd colspan\x3d"2"\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.unitLabelTitle}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.inputUnitLabelTitle}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" class\x3d"esriVFRUnitsList" data-dojo-attach-point\x3d"inputDataUnitSelect" data-dojo-attach-event\x3d"onChange: _onInputUnitChange"\x3e\r\n                  \x3coption value\x3d"NO_UNIT"\x3e\x3c/option\x3e\r\n                  \x3coption value\x3d"esriMetersPerSecond"\x3e${_i18n.widgets.vectorFieldRenderer.esriMetersPerSecond}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriKilometersPerHour"\x3e${_i18n.widgets.vectorFieldRenderer.esriKilometersPerHour}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriKnots"\x3e${_i18n.widgets.vectorFieldRenderer.esriKnots}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFeetPerSecond"\x3e${_i18n.widgets.vectorFieldRenderer.esriFeetPerSecond}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriMilesPerHour"\x3e${_i18n.widgets.vectorFieldRenderer.esriMilesPerHour}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.outputUnitLabelTitle}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" class\x3d"esriVFRUnitsList" disabled\x3d"disabled" data-dojo-attach-point\x3d"outputDataUnitSelect" data-dojo-attach-event\x3d"onChange: _onOutputUnitChange"\x3e\r\n                  \x3coption value\x3d"NO_UNIT"\x3e\x3c/option\x3e\r\n                  \x3coption value\x3d"esriMetersPerSecond"\x3e${_i18n.widgets.vectorFieldRenderer.esriMetersPerSecond}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriKilometersPerHour"\x3e${_i18n.widgets.vectorFieldRenderer.esriKilometersPerHour}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriKnots"\x3e${_i18n.widgets.vectorFieldRenderer.esriKnots}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriFeetPerSecond"\x3e${_i18n.widgets.vectorFieldRenderer.esriFeetPerSecond}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriMilesPerHour"\x3e${_i18n.widgets.vectorFieldRenderer.esriMilesPerHour}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr class\x3d"esriVFRDataRangeLabelRow"\x3e\r\n              \x3ctd colspan\x3d"2"\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.dataValueRangeLabelTitle}\x3c/label\x3e\x3clabel data-dojo-attach-point\x3d"dataValueRangeUnit"\x3e.\x3c/label\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr class\x3d"esriVFRMinValueRow"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.minAlias}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"esriVFRMinMagInput" data-dojo-attach-point\x3d"minMagnitudeInput" data-dojo-attach-event\x3d"onChange: _setPropertiesChanged"/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${_i18n.widgets.vectorFieldRenderer.maxAlias}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"esriVFRMaxMagInput" data-dojo-attach-point\x3d"maxMagnitudeInput" data-dojo-attach-event\x3d"onChange: _setPropertiesChanged"/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"2" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick: _onClickApplyVectorFieldRenderer" data-dojo-attach-point\x3d"applyButton"\x3e${_i18n.widgets.vectorFieldRenderer.applyLabelTitle}\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/TitlePane.html": '\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onTitleClick, onkeydown:_onTitleKey"\r\n\t\t\tclass\x3d"dijitTitlePaneTitle" data-dojo-attach-point\x3d"titleBarNode" id\x3d"${id}_titleBarNode"\x3e\r\n\t\t\x3cdiv class\x3d"dijitTitlePaneTitleFocus" data-dojo-attach-point\x3d"focusNode"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"arrowNode" class\x3d"dijitInline dijitArrowNode" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"arrowNodeInner" class\x3d"dijitArrowNodeInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitTitlePaneTextNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTitlePaneContentOuter" data-dojo-attach-point\x3d"hideNode" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitReset" data-dojo-attach-point\x3d"wipeNode" role\x3d"presentation"\x3e\r\n\t\t\t\x3cdiv class\x3d"dijitTitlePaneContentInner" data-dojo-attach-point\x3d"containerNode" role\x3d"region" id\x3d"${id}_pane" aria-labelledby\x3d"${id}_titleBarNode"\x3e\r\n\t\t\t\t\x3c!-- nested divs because wipeIn()/wipeOut() doesn\'t work right on node w/padding etc.  Put padding on inner div. --\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/Error.html": '\x3cdiv id\x3d"main-section"\x3e\r\n\t\x3cspan id\x3d"error-message"\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n', "url:arcgisonline/sharing/dijit/templates/RasterFunctionEditor.html": "\x3cdiv class\x3d\"esriRFxEditorContainer\"\x3e\r\n  \x3cdiv class\x3d'close-btn'\x3e \r\n  \x3csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'15' height\x3d'15' viewBox\x3d'0 0 32 32' class\x3d'svg-icon'\x3e \r\n    \x3cpath d\x3d'M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z'/\x3e \r\n  \x3c/svg\x3e \r\n  \x3c/div\x3e \r\n  \x3cdiv data-dojo-attach-point\x3d'passiveOverlay' class\x3d'passive-overlay'\x3e\x3c/div\x3e \r\n  \x3ciframe data-dojo-attach-point\x3d'_iframe'\x3e \r\n  \x3c/iframe\x3e \r\n\x3c/div\x3e\r\n",
"url:dijit/templates/InlineEditBox.html": '\x3cspan data-dojo-attach-point\x3d"editNode" role\x3d"presentation" class\x3d"dijitReset dijitInline dijitOffScreen"\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"editorPlaceholder"\x3e\x3c/span\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"buttonContainer"\r\n\t\t\x3e\x3cbutton data-dojo-type\x3d"./form/Button" data-dojo-props\x3d"label: \'${buttonSave}\', \'class\': \'saveButton\'"\r\n\t\t\tdata-dojo-attach-point\x3d"saveButton" data-dojo-attach-event\x3d"onClick:save"\x3e\x3c/button\r\n\t\t\x3e\x3cbutton data-dojo-type\x3d"./form/Button"  data-dojo-props\x3d"label: \'${buttonCancel}\', \'class\': \'cancelButton\'"\r\n\t\t\tdata-dojo-attach-point\x3d"cancelButton" data-dojo-attach-event\x3d"onClick:cancel"\x3e\x3c/button\r\n\t\x3e\x3c/span\r\n\x3e\x3c/span\x3e\r\n',
"url:esri/dijit/Search/templates/Search.html": '\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/templates/DefineExtent.html": '\x3cdiv\x3e\r\n  \x3cspan\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin05 extent-search backward-compatible-extent-search inline-block" data-dojo-attach-point\x3d"_extentSearchContainer"\x3e\x3c/div\x3e\r\n    \x3cbutton class\x3d"calcite secondary btn btn-blue small right" id\x3d"extent-dlg-draw-button" data-dojo-attach-point\x3d"_buttonSetExtent"\x3e\r\n      ${i18n.drawExtent}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cdiv id\x3d"extent-map-container" style\x3d"width:500px; max-width: 100%; height:340px; border:1px solid #000;"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"inline-block leader-half"\x3e\r\n    \x3clabel class\x3d"extent-label inline-block" for\x3d"extent-left"\x3e${i18n.leftLabel}\x3c/label\x3e\r\n    \x3cinput class\x3d"extent-input inline-block" id\x3d"extent-left" data-dojo-attach-point\x3d"_extentLeft"\r\n           data-dojo-type\x3d"dijit/form/TextBox"\r\n           data-dojo-props\x3d"trim:true, required:true"\x3e\r\n\r\n    \x3cspan class\x3d"extent-spacer"\x3e\x26nbsp;\x3c/span\x3e\r\n\r\n    \x3clabel class\x3d"extent-label inline-block" for\x3d"extent-right"\x3e${i18n.rightLabel}\x3c/label\x3e\r\n    \x3cinput class\x3d"extent-input" id\x3d"extent-right" data-dojo-attach-point\x3d"_extentRight" data-dojo-type\x3d"dijit/form/TextBox"\r\n           data-dojo-props\x3d"trim:true, required:true"\x3e\r\n  \x3c/div\x3e\r\n  \x3cbr\x3e\r\n  \x3cdiv class\x3d"inline-block"\x3e\r\n    \x3clabel class\x3d"extent-label inline-block" for\x3d"extent-top"\x3e${i18n.topLabel}\x3c/label\x3e\r\n    \x3cinput class\x3d"extent-input" id\x3d"extent-top" data-dojo-attach-point\x3d"_extentTop" data-dojo-type\x3d"dijit/form/TextBox"\r\n           data-dojo-props\x3d"trim:true, required:true"\x3e\r\n\r\n    \x3cspan class\x3d"extent-spacer"\x3e\x26nbsp;\x3c/span\x3e\r\n\r\n    \x3clabel class\x3d"extent-label inline-block" for\x3d"extent-bottom"\x3e${i18n.bottomLabel}\x3c/label\x3e\r\n    \x3cinput class\x3d"extent-input" id\x3d"extent-bottom" data-dojo-attach-point\x3d"_extentBottom" data-dojo-type\x3d"dijit/form/TextBox"\r\n           data-dojo-props\x3d"trim:true, required:true"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/ExtentDlg.html": '\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" class\x3d"extent-dialog" data-dojo-attach-point\x3d"_extentDialog" title\x3d"${i18n.extentDlgTitle}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_extentContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"right esriFloatTrailing margin-right-1 extent-ltr-margin-right-0"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" type\x3d"button" data-dojo-type\x3d"dijit/form/Button" class\x3d"cancel"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_okBtn" data-dojo-type\x3d"dijit/form/Button" class\x3d"primary"\x3e\r\n        ${i18n.ok}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/form/resources/Uploader.html": '\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:dijit/templates/actionBar.html": "\x3cdiv class\x3d'dijitDialogPaneActionBar' data-dojo-attach-point\x3d\"actionBarNode\"\x3e\r\n\t\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' data-dojo-attach-point\x3d\"okButton\"\x3e\x3c/button\x3e\r\n\t\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'button'\r\n\t\t\tdata-dojo-attach-point\x3d\"cancelButton\" data-dojo-attach-event\x3d'click:onCancel'\x3e\x3c/button\x3e\r\n\x3c/div\x3e\r\n", "url:arcgisonline/sharing/dijit/templates/CopyToClipboard.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"input-group js-copy-group"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"copyInput" class\x3d"input-group-input copy-to-clipboard-input" readonly type\x3d"text" value\x3d"${text}" id\x3d"copy-to-clipboard-${id}"\x3e\r\n    \x3cspan class\x3d"js-copy-tooltip input-group-button tooltip ${tooltipModifier}" aria-label\x3d"${i18n.tocPanel.copy}"\x3e\r\n      \x3cbutton aria-label\x3d"${i18n.itemProperties.copyToClipboard}"\r\n              class\x3d"js-copy-btn btn btn-clear"\r\n              data-dojo-attach-event\x3d"click: copy, mouseleave: reset"\x3e${!icons.copy-to-clipboard.16}\x3c/button\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cp role\x3d"alert" aria-live\x3d"polite" class\x3d"js-copy-alert screen-readers-only"\x3e\x3c/p\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/form/resources/VerticalRangeSlider.html": '\x3ctable class\x3d"dijitReset dijitSlider dijitSliderV dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconV" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton" dojoAttachEvent\x3d"onclick: increment"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper" dojoAttachEvent\x3d"onclick:_onClkIncBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"leftDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV" style\x3d"text-align:center;height:100%;"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" style\x3d"height:100%;"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3ccenter role\x3d"presentation" style\x3d"position:relative;height:100%;" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;" role\x3d"slider"\r\n\t\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onHandleClick"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onBarClick"\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;" role\x3d"slider"\r\n\t\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onmousedown:_onHandleClickMax"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,rightDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV" style\x3d"text-align:center;height:100%;"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper" dojoAttachEvent\x3d"onclick:_onClkDecBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconV" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton" dojoAttachEvent\x3d"onclick: decrement"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/VerticalSlider.html": '\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderV" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconV" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"leftDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationL dijitSliderDecorationV"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderDecorationC" style\x3d"height:100%;"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3ccenter class\x3d"dijitReset dijitSliderBarContainerV" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c!--#5629--\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableV" style\x3d"vertical-align:top;"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleV" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,rightDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationR dijitSliderDecorationV"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3ccenter\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\x3e\x3c/center\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconV" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"*now": function(b) { b(['dojo/i18n!*preload*arcgisonline/nls/mapmain*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]']) }, "*noref": 1
}
});
define("arcgisonline/mapmain", ["dojo", "dijit", "dojox", "dojo/require!esri/utils,esri/dijit/AttributeInspector,esri/dijit/Measurement,esri/dijit/Bookmarks,esri/dijit/Legend,esri/tasks/PrintTask,esri/arcgis/utils,arcgisonline/telemetry,arcgisonline/map/geocode,arcgisonline/map/save_open,arcgisonline/map/storage,arcgisonline/map/embedded,arcgisonline/map/copy,arcgisonline/map/dynLayer,arcgisonline/map/edit,arcgisonline/map/editTracking,arcgisonline/map/featColl,arcgisonline/map/fileImport,arcgisonline/map/geoRSS,arcgisonline/map/geocodeReview,arcgisonline/map/itemData,arcgisonline/map/labels,arcgisonline/map/stream,arcgisonline/map/thumbnail,arcgisonline/map/table,arcgisonline/map/time,arcgisonline/map/multiDimensions,arcgisonline/map/kml,arcgisonline/map/layer,arcgisonline/map/leftPanel,arcgisonline/map/print,arcgisonline/map/mapNotes,arcgisonline/map/classBreaks,arcgisonline/map/popup,arcgisonline/map/role,arcgisonline/map/symbol,arcgisonline/map/vectorTile,arcgisonline/map/webTile,arcgisonline/map/wfs,arcgisonline/map/wms,arcgisonline/map/dijit/LeftPanel,arcgisonline/sharing/util,arcgisonline/sharing/utilShare,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Folder,arcgisonline/sharing/geow/Search,arcgisonline/sharing/dijit/Error,arcgisonline/sharing/dijit/DropDownButton,arcgisonline/sharing/dijit/BasemapGalleryGrid,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/ProfilePopup,arcgisonline/sharing/dijit/RasterFunctionEditor,arcgisonline/sharing/dijit/SiteHeader,arcgisonline/sharing/dijit/SiteFooterMap,arcgisonline/sharing/dijit/dialog/AddLayerFromFileDlg,arcgisonline/sharing/dijit/dialog/AddLayerFromUrlDlg,arcgisonline/sharing/dijit/dialog/BrowseLayersDlg,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/FieldsDlg,arcgisonline/sharing/dijit/dialog/FilterDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/MapNotesDlg,arcgisonline/sharing/dijit/dialog/OpenMapDlg,arcgisonline/sharing/dijit/dialog/OpenPresentationDlg,arcgisonline/sharing/dijit/dialog/QueryLayerDlg,arcgisonline/sharing/dijit/dialog/ShareMapDlg,arcgisonline/sharing/dijit/dialog/TimeSettingsDlg,arcgisonline/sharing/dijit/dialog/MapSettingsDlg,arcgisonline/sharing/dijit/dialog/MdSliderSettingsDlg,arcgisonline/sharing/dijit/dialog/CsvLocationDlg,arcgisonline/sharing/dijit/dialog/WaitingDlg,arcgisonline/sharing/dijit/views,arcgisonline/pages/utils/notebook,dojo/cookie,dijit/Tooltip,dgrid/OnDemandGrid,dgrid/Selection,dojox/html/entities"], function(b,
    g, n) {
    b.provide("arcgisonline.mapmain");
    b.require("esri.utils");
    b.require("esri.dijit.AttributeInspector");
    b.require("esri.dijit.Measurement");
    b.require("esri.dijit.Bookmarks");
    b.require("esri.dijit.Legend");
    b.require("esri.tasks.PrintTask");
    b.require("esri.arcgis.utils");
    b.require("arcgisonline.telemetry");
    b.require("arcgisonline.map.geocode");
    b.require("arcgisonline.map.save_open");
    b.require("arcgisonline.map.storage");
    b.require("arcgisonline.map.embedded");
    b.require("arcgisonline.map.copy");
    b.require("arcgisonline.map.dynLayer");
    b.require("arcgisonline.map.edit");
    b.require("arcgisonline.map.editTracking");
    b.require("arcgisonline.map.featColl");
    b.require("arcgisonline.map.fileImport");
    b.require("arcgisonline.map.geoRSS");
    b.require("arcgisonline.map.geocodeReview");
    b.require("arcgisonline.map.itemData");
    b.require("arcgisonline.map.labels");
    b.require("arcgisonline.map.stream");
    b.require("arcgisonline.map.thumbnail");
    b.require("arcgisonline.map.table");
    b.require("arcgisonline.map.time");
    b.require("arcgisonline.map.multiDimensions");
    b.require("arcgisonline.map.kml");
    b.require("arcgisonline.map.layer");
    b.require("arcgisonline.map.leftPanel");
    b.require("arcgisonline.map.print");
    b.require("arcgisonline.map.mapNotes");
    b.require("arcgisonline.map.classBreaks");
    b.require("arcgisonline.map.popup");
    b.require("arcgisonline.map.role");
    b.require("arcgisonline.map.symbol");
    b.require("arcgisonline.map.vectorTile");
    b.require("arcgisonline.map.webTile");
    b.require("arcgisonline.map.wfs");
    b.require("arcgisonline.map.wms");
    b.require("arcgisonline.map.dijit.LeftPanel");
    b.require("arcgisonline.sharing.util");
    b.require("arcgisonline.sharing.utilShare");
    b.require("arcgisonline.sharing.geow.Account");
    b.require("arcgisonline.sharing.geow.Geow");
    b.require("arcgisonline.sharing.geow.Folder");
    b.require("arcgisonline.sharing.geow.Search");
    b.require("arcgisonline.sharing.dijit.Error");
    b.require("arcgisonline.sharing.dijit.DropDownButton");
    b.require("arcgisonline.sharing.dijit.BasemapGalleryGrid");
    b.require("arcgisonline.sharing.dijit.HelpManager");
    b.require("arcgisonline.sharing.dijit.ProfilePopup");
    b.require("arcgisonline.sharing.dijit.RasterFunctionEditor");
    b.require("arcgisonline.sharing.dijit.SiteHeader");
    b.require("arcgisonline.sharing.dijit.SiteFooterMap");
    b.require("arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg");
    b.require("arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg");
    b.require("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg");
    b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");
    b.require("arcgisonline.sharing.dijit.dialog.FieldsDlg");
    b.require("arcgisonline.sharing.dijit.dialog.FilterDlg");
    b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
    b.require("arcgisonline.sharing.dijit.dialog.MapNotesDlg");
    b.require("arcgisonline.sharing.dijit.dialog.OpenMapDlg");
    b.require("arcgisonline.sharing.dijit.dialog.OpenPresentationDlg");
    b.require("arcgisonline.sharing.dijit.dialog.QueryLayerDlg");
    b.require("arcgisonline.sharing.dijit.dialog.ShareMapDlg");
    b.require("arcgisonline.sharing.dijit.dialog.TimeSettingsDlg");
    b.require("arcgisonline.sharing.dijit.dialog.MapSettingsDlg");
    b.require("arcgisonline.sharing.dijit.dialog.MdSliderSettingsDlg");
    b.require("arcgisonline.sharing.dijit.dialog.CsvLocationDlg");
    b.require("arcgisonline.sharing.dijit.dialog.WaitingDlg");
    b.require("arcgisonline.sharing.dijit.views");
    b.require("arcgisonline.pages.utils.notebook");
    b.require("dojo.cookie");
    b.require("dijit.Tooltip");
    b.require("dgrid.OnDemandGrid");
    b.require("dgrid.Selection");
    b.require("dojox.html.entities")
});